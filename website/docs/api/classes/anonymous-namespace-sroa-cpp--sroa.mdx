---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/classes/anonymous-namespace-sroa-cpp-/sroa
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - class
toc_max_heading_level: 3

---

import CodeBlock from '@theme/CodeBlock'

import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'
import SectionUser from '@xpack/docusaurus-plugin-doxygen/components/SectionUser'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `SROA` Class Reference

<DoxygenPage pluginConfig={pluginConfig}>

An optimization pass providing Scalar Replacement of Aggregates. <a href="#details">More...</a>

## Declaration

<CodeBlock>class anonymous_namespace{SROA.cpp}::SROA</CodeBlock>

## Friends Index

<MembersIndex>

<MembersIndexItem
  type="class"
  name={<><a href="#a79522441dc59c0a101a4e208abdf855a">AllocaSliceRewriter</a></>}>
</MembersIndexItem>

</MembersIndex>

## Public Constructors Index

<MembersIndex>

<MembersIndexItem
  name={<><a href="#afc5246d29111911b196d9a1c69aa812c">SROA</a> (LLVMContext &#42;C, DomTreeUpdater &#42;DTU, AssumptionCache &#42;AC, SROAOptions PreserveCFG&#95;)</>}>
</MembersIndexItem>

</MembersIndex>

## Public Member Functions Index

<MembersIndex>

<MembersIndexItem
  type={<>std::pair&lt; bool, bool &gt;</>}
  name={<><a href="#a8317779540f30fe6a5dda2359f023675">runSROA</a> (Function &amp;F)</>}>
Main run method used by both the <a href="/docs/api/classes/llvm/sroapass">SROAPass</a> and by the legacy pass. <a href="#a8317779540f30fe6a5dda2359f023675">More...</a>
</MembersIndexItem>

</MembersIndex>

## Private Member Functions Index

<MembersIndex>

<MembersIndexItem
  type="void"
  name={<><a href="#af4a4af2e04be471234631eed6ab8c168">clobberUse</a> (Use &amp;U)</>}>
Clobber a use with poison, deleting the used value if it becomes dead. <a href="#af4a4af2e04be471234631eed6ab8c168">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a408e9739b91e3bbe158e8e21fc66b1b1">deleteDeadInstructions</a> (SmallPtrSetImpl&lt; AllocaInst &#42; &gt; &amp;DeletedAllocas)</>}>
Delete the dead instructions accumulated in this run. <a href="#a408e9739b91e3bbe158e8e21fc66b1b1">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aacab3841a3ef28ce5d8eff4d06d0d081">presplitLoadsAndStores</a> (AllocaInst &amp;AI, AllocaSlices &amp;AS)</>}>
Pre-split loads and stores to simplify rewriting. <a href="#aacab3841a3ef28ce5d8eff4d06d0d081">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#ad580cb5b1c27faec5ac5818bd4b0370a">promoteAllocas</a> (Function &amp;F)</>}>
Promote the allocas, using the best available technique. <a href="#ad580cb5b1c27faec5ac5818bd4b0370a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aca72f24d9848af8803ebfd85c4a2a9e9">propagateStoredValuesToLoads</a> (AllocaInst &amp;AI, AllocaSlices &amp;AS)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;</>}
  name={<><a href="#ae7365e0ad8b217267d8d669c030ba017">rewritePartition</a> (AllocaInst &amp;AI, AllocaSlices &amp;AS, Partition &amp;P)</>}>
Rewrite an alloca partition&#39;s users. <a href="#ae7365e0ad8b217267d8d669c030ba017">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<>std::pair&lt; bool, bool &gt;</>}
  name={<><a href="#ab7bd34f2cdc4fee8bd2dc6c96903aa82">runOnAlloca</a> (AllocaInst &amp;AI)</>}>
Analyze an alloca for <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/sroa">SROA</a>. <a href="#ab7bd34f2cdc4fee8bd2dc6c96903aa82">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a71221c0b1a573a3bb9f5033cc8e5ab0d">splitAlloca</a> (AllocaInst &amp;AI, AllocaSlices &amp;AS)</>}>
Walks the slices of an alloca and form partitions based on them, rewriting each of their uses. <a href="#a71221c0b1a573a3bb9f5033cc8e5ab0d">More...</a>
</MembersIndexItem>

</MembersIndex>

## Private Member Attributes Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a></>}
  name={<><a href="#af6caf54d2b4c70b9dbd28541e685c21b">AC</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a></>}
  name={<><a href="#aab5db29f7fde580ba52164284ecb94ef">C</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; <a href="/docs/api/classes/llvm/weakvh">WeakVH</a>, 8 &gt;</>}
  name={<><a href="#a730c9770522327bebf0f87bef1ab71b6">DeadInsts</a></>}>
A collection of instructions to delete. <a href="#a730c9770522327bebf0f87bef1ab71b6">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/domtreeupdater">DomTreeUpdater</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a></>}
  name={<><a href="#aee619933430dce87db6d46cac853c3ad">DTU</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector</a>&lt; <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;, 16 &gt;</>}
  name={<><a href="#a1aae3849009fdcd89acb4c5bd60f7a64">PostPromotionWorklist</a></>}>
Post-promotion worklist. <a href="#a1aae3849009fdcd89acb4c5bd60f7a64">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> bool</>}
  name={<><a href="#a004ffa57ff51b76e8e11099a5854e618">PreserveCFG</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/setvector">SetVector</a>&lt; <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;, <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42; &gt;, <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet</a>&lt; <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;, 16 &gt;, 16 &gt;</>}
  name={<><a href="#a38a5d453f1c9b0e5b1f56a1470a838b1">PromotableAllocas</a></>}>
A collection of alloca instructions we can directly promote. <a href="#a38a5d453f1c9b0e5b1f56a1470a838b1">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/structs/llvm/smallmapvector">SmallMapVector</a>&lt; <a href="/docs/api/classes/llvm/selectinst">SelectInst</a> &#42;, <a href="/docs/api/namespaces/anonymous-sroa-cpp-/#a0bd6174f8bb3840fa3e80f8c870023fd">RewriteableMemOps</a>, 8 &gt;</>}
  name={<><a href="#a105c431155e6b5c340f3630c981fae3e">SelectsToRewrite</a></>}>
A worklist of select instructions to rewrite prior to promoting allocas. <a href="#a105c431155e6b5c340f3630c981fae3e">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector</a>&lt; <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;, 8 &gt;</>}
  name={<><a href="#a864c9ba1b56309fefc0eda114e71aa10">SpeculatablePHIs</a></>}>
A worklist of PHIs to speculate prior to promoting allocas. <a href="#a864c9ba1b56309fefc0eda114e71aa10">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector</a>&lt; <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;, 16 &gt;</>}
  name={<><a href="#a9bb8b741e320d9f12e63e955c1367430">Worklist</a></>}>
Worklist of alloca instructions to simplify. <a href="#a9bb8b741e320d9f12e63e955c1367430">More...</a>
</MembersIndexItem>

</MembersIndex>

## Private Static Functions Index

<MembersIndex>

<MembersIndexItem
  type={<>std::optional&lt; <a href="/docs/api/namespaces/anonymous-sroa-cpp-/#a0bd6174f8bb3840fa3e80f8c870023fd">RewriteableMemOps</a> &gt;</>}
  name={<><a href="#a1d9e8c850d077a5426394ffbcb4224c7">isSafeSelectToSpeculate</a> (SelectInst &amp;SI, bool PreserveCFG)</>}>
Select instructions that use an alloca and are subsequently loaded can be rewritten to load both input pointers and then select between the result, allowing the load of the alloca to be promoted. <a href="#a1d9e8c850d077a5426394ffbcb4224c7">More...</a>
</MembersIndexItem>

</MembersIndex>

## Description {#details}

An optimization pass providing Scalar Replacement of Aggregates.

This pass takes allocations which can be completely analyzed (that is, they don&#39;t escape) and tries to turn them into scalar SSA values. There are a few steps to this process.

1) It takes allocations of aggregates and analyzes the ways in which they are used to try to split them into smaller allocations, ideally of a single scalar data type. It will split up memcpy and memset accesses as necessary and try to isolate individual scalar accesses. 2) It will transform accesses into forms which are suitable for SSA value promotion. This can be replacing a memset with a scalar store of an integer value, or it can involve speculating operations on a PHI or select to be a PHI or select of the results. 3) Finally, this will try to detect a pattern of accesses which map cleanly onto insert and extract operations on a vector value, and convert them to this form. By doing so, it will enable promotion of vector aggregates to SSA vector values.

Definition at line 171 of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.

<SectionDefinition>

## Friends

### AllocaSliceRewriter {#a79522441dc59c0a101a4e208abdf855a}

<MemberDefinition
  prototype={<>friend class <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/allocaslicerewriter">AllocaSliceRewriter</a></>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00246">246</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Public Constructors

### SROA() {#afc5246d29111911b196d9a1c69aa812c}

<MemberDefinition
  prototype={<>anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::SROA (<a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &#42; C, <a href="/docs/api/classes/llvm/domtreeupdater">DomTreeUpdater</a> &#42; DTU, <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &#42; AC, <a href="/docs/api/namespaces/llvm/#af4e437674a39417056e3028415053139">SROAOptions</a> PreserveCFG_)</>}
  labels = {["inline"]}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00237">237</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Public Member Functions

### runSROA() {#a8317779540f30fe6a5dda2359f023675}

<MemberDefinition
  prototype={<>std::pair&lt; bool, bool &gt; SROA::runSROA (<a href="/docs/api/classes/llvm/function">Function</a> &amp; F)</>}>
Main run method used by both the <a href="/docs/api/classes/llvm/sroapass">SROAPass</a> and by the legacy pass.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00243">243</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Member Functions

### clobberUse() {#af4a4af2e04be471234631eed6ab8c168}

<MemberDefinition
  prototype={<>void SROA::clobberUse (<a href="/docs/api/classes/llvm/use">Use</a> &amp; U)</>}>
Clobber a use with poison, deleting the used value if it becomes dead.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00253">253</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### deleteDeadInstructions() {#a408e9739b91e3bbe158e8e21fc66b1b1}

<MemberDefinition
  prototype={<>bool SROA::deleteDeadInstructions (<a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl</a>&lt; <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42; &gt; &amp; DeletedAllocas)</>}>
Delete the dead instructions accumulated in this run.

Recursively deletes the dead instructions we&#39;ve accumulated. This is done at the very end to maximize locality of the recursive delete and to minimize the problems of invalidated instruction pointers as such pointers are used heavily in the intermediate stages of the algorithm.

We also record the alloca instructions deleted here so that they aren&#39;t subsequently handed to mem2reg to promote.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00254">254</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### presplitLoadsAndStores() {#aacab3841a3ef28ce5d8eff4d06d0d081}

<MemberDefinition
  prototype={<>bool SROA::presplitLoadsAndStores (<a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &amp; AI, <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/allocaslices">AllocaSlices</a> &amp; AS)</>}>
Pre-split loads and stores to simplify rewriting.

We want to break up the splittable load+store pairs as much as possible. This is important to do as a preprocessing step, as once we start rewriting the accesses to partitions of the alloca we lose the necessary information to correctly split apart paired loads and stores which both point into this alloca. The case to consider is something like the following:

a = alloca &#91;12 x i8&#93; gep1 = getelementptr i8, ptr a, i32 0 gep2 = getelementptr i8, ptr a, i32 4 gep3 = getelementptr i8, ptr a, i32 8 store float 0.0, ptr gep1 store float 1.0, ptr gep2 v = load i64, ptr gep1 store i64 v, ptr gep2 f1 = load float, ptr gep2 f2 = load float, ptr gep3

Here we want to form 3 partitions of the alloca, each 4 bytes large, and promote everything so we recover the 2 SSA values that should have been there all along.


<SectionUser title="Returns">
true if any changes are made.
</SectionUser>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00248">248</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### promoteAllocas() {#ad580cb5b1c27faec5ac5818bd4b0370a}

<MemberDefinition
  prototype={<>bool SROA::promoteAllocas (<a href="/docs/api/classes/llvm/function">Function</a> &amp; F)</>}>
Promote the allocas, using the best available technique.

This attempts to promote whatever allocas have been identified as viable in the PromotableAllocas list. If that list is empty, there is nothing to do. This function returns whether any promotion occurred.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00255">255</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### propagateStoredValuesToLoads() {#aca72f24d9848af8803ebfd85c4a2a9e9}

<MemberDefinition
  prototype={<>bool SROA::propagateStoredValuesToLoads (<a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &amp; AI, <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/allocaslices">AllocaSlices</a> &amp; AS)</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00251">251</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### rewritePartition() {#ae7365e0ad8b217267d8d669c030ba017}

<MemberDefinition
  prototype={<>AllocaInst &#42; SROA::rewritePartition (<a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &amp; AI, <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/allocaslices">AllocaSlices</a> &amp; AS, <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/partition">Partition</a> &amp; P)</>}>
Rewrite an alloca partition&#39;s users.

This routine drives both of the rewriting goals of the <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/sroa">SROA</a> pass. It tries to rewrite uses of an alloca partition to be conducive for SSA value promotion. If the partition needs a new, more refined alloca, this will build that new alloca, preserving as much type information as possible, and rewrite the uses of the old alloca to point at the new one and have the appropriate new offsets. It also evaluates how successful the rewrite was at enabling promotion and if it was successful queues the alloca to be promoted.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00249">249</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### runOnAlloca() {#ab7bd34f2cdc4fee8bd2dc6c96903aa82}

<MemberDefinition
  prototype={<>std::pair&lt; bool, bool &gt; SROA::runOnAlloca (<a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &amp; AI)</>}>
Analyze an alloca for <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/sroa">SROA</a>.

This analyzes the alloca to ensure we can reason about it, builds the slices of the alloca, and then hands it off to be split and rewritten as needed.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00252">252</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### splitAlloca() {#a71221c0b1a573a3bb9f5033cc8e5ab0d}

<MemberDefinition
  prototype={<>bool SROA::splitAlloca (<a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &amp; AI, <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/allocaslices">AllocaSlices</a> &amp; AS)</>}>
Walks the slices of an alloca and form partitions based on them, rewriting each of their uses.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00250">250</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Member Attributes

### AC {#af6caf54d2b4c70b9dbd28541e685c21b}

<MemberDefinition
  prototype={<>AssumptionCache&#42; const anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::AC</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00174">174</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### C {#aab5db29f7fde580ba52164284ecb94ef}

<MemberDefinition
  prototype={<>LLVMContext&#42; const anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::C</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00172">172</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### DeadInsts {#a730c9770522327bebf0f87bef1ab71b6}

<MemberDefinition
  prototype={<>SmallVector&lt;WeakVH, 8&gt; anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::DeadInsts</>}>
A collection of instructions to delete.

We try to batch deletions to simplify code and make things a bit more efficient. We also make sure there is no dangling pointers.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00189">189</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### DTU {#aee619933430dce87db6d46cac853c3ad}

<MemberDefinition
  prototype={<>DomTreeUpdater&#42; const anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::DTU</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00173">173</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### PostPromotionWorklist {#a1aae3849009fdcd89acb4c5bd60f7a64}

<MemberDefinition
  prototype={<>SmallSetVector&lt;AllocaInst &#42;, 16&gt; anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::PostPromotionWorklist</>}>
Post-promotion worklist.

Sometimes we discover an alloca which has a high probability of becoming viable for <a href="/docs/api/classes/anonymous-namespace-sroa-cpp-/sroa">SROA</a> after a round of promotion takes place. In those cases, the alloca is enqueued here for re-processing.

Note that we have to be very careful to clear allocas out of this list in the event they are deleted.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00199">199</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### PreserveCFG {#a004ffa57ff51b76e8e11099a5854e618}

<MemberDefinition
  prototype={<>const bool anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::PreserveCFG</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00175">175</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### PromotableAllocas {#a38a5d453f1c9b0e5b1f56a1470a838b1}

<MemberDefinition
  prototype={<>SetVector&lt;AllocaInst &#42;, SmallVector&lt;AllocaInst &#42;&gt;, SmallPtrSet&lt;AllocaInst &#42;, 16&gt;, 16&gt; anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::PromotableAllocas</>}>
A collection of alloca instructions we can directly promote.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00204">204</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### SelectsToRewrite {#a105c431155e6b5c340f3630c981fae3e}

<MemberDefinition
  prototype={<>SmallMapVector&lt;SelectInst &#42;, RewriteableMemOps, 8&gt; anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::SelectsToRewrite</>}>
A worklist of select instructions to rewrite prior to promoting allocas.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00215">215</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### SpeculatablePHIs {#a864c9ba1b56309fefc0eda114e71aa10}

<MemberDefinition
  prototype={<>SmallSetVector&lt;PHINode &#42;, 8&gt; anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::SpeculatablePHIs</>}>
A worklist of PHIs to speculate prior to promoting allocas.

All of these PHIs have been checked for the safety of speculation and by being speculated will allow promoting allocas currently in the promotable queue.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00211">211</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

### Worklist {#a9bb8b741e320d9f12e63e955c1367430}

<MemberDefinition
  prototype={<>SmallSetVector&lt;AllocaInst &#42;, 16&gt; anonymous&#95;namespace&#123;SROA.cpp&#125;::SROA::Worklist</>}>
Worklist of alloca instructions to simplify.

Each alloca in the function is added to this. Each new alloca formed gets added to it as well to recursively simplify unless that alloca can be directly promoted. Finally, each time we rewrite a use of an alloca other the one being actively rewritten, we add it back onto the list if not already present to ensure it is re-visited.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00184">184</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Static Functions

### isSafeSelectToSpeculate() {#a1d9e8c850d077a5426394ffbcb4224c7}

<MemberDefinition
  prototype={<>std::optional&lt; RewriteableMemOps &gt; SROA::isSafeSelectToSpeculate (<a href="/docs/api/classes/llvm/selectinst">SelectInst</a> &amp; SI, bool PreserveCFG)</>}
  labels = {["static"]}>
Select instructions that use an alloca and are subsequently loaded can be rewritten to load both input pointers and then select between the result, allowing the load of the alloca to be promoted.

From this: P2 = select i1 cond, ptr Alloca, ptr Other V = load &lt;type&gt;, ptr P2 to: V1 = load &lt;type&gt;, ptr Alloca -&gt; will be mem2reg&#39;d V2 = load &lt;type&gt;, ptr Other V = select i1 cond, &lt;type&gt; V1, &lt;type&gt; V2

We can do this to a select if its only uses are loads and if either the operand to the select can be loaded unconditionally, or if we are allowed to perform CFG modifications. If found an intervening bitcast with a single use of the load, allow the promotion.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp/#l00234">234</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<hr/>

The documentation for this class was generated from the following file:

<ul>
<li><a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/sroa-cpp">SROA.cpp</a></li>
</ul>

</DoxygenPage>
