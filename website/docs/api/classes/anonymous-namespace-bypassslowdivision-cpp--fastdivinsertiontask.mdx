---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/classes/anonymous-namespace-bypassslowdivision-cpp-/fastdivinsertiontask
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - class
toc_max_heading_level: 3

---

import CodeBlock from '@theme/CodeBlock'

import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `FastDivInsertionTask` Class Reference

<DoxygenPage pluginConfig={pluginConfig}>



## Declaration

<CodeBlock>class anonymous_namespace{BypassSlowDivision.cpp}::FastDivInsertionTask</CodeBlock>

## Public Constructors Index

<MembersIndex>

<MembersIndexItem
  name={<><a href="#ab953cd204338514e8d564c615763d13f">FastDivInsertionTask</a> (Instruction &#42;I, const BypassWidthsTy &amp;BypassWidths)</>}>
</MembersIndexItem>

</MembersIndex>

## Public Member Functions Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">Value</a> &#42;</>}
  name={<><a href="#af373b68c535969d897e55c3857997583">getReplacement</a> (DivCacheTy &amp;Cache)</>}>
Reuses previously-computed dividend or remainder from the current BB if operands and operation are identical. <a href="#af373b68c535969d897e55c3857997583">More...</a>
</MembersIndexItem>

</MembersIndex>

## Private Member Functions Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/structs/anonymous-namespace-bypassslowdivision-cpp-/quotrempair">QuotRemPair</a></>}
  name={<><a href="#a0dd8d4ba03c7b55182b1b9fa5ae5d053">createDivRemPhiNodes</a> (QuotRemWithBB &amp;LHS, QuotRemWithBB &amp;RHS, BasicBlock &#42;PhiBB)</>}>
Creates Phi nodes for result of Div and Rem. <a href="#a0dd8d4ba03c7b55182b1b9fa5ae5d053">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/structs/anonymous-namespace-bypassslowdivision-cpp-/quotremwithbb">QuotRemWithBB</a></>}
  name={<><a href="#a86c5ad21a2d56d1af3c5f2b39331c02b">createFastBB</a> (BasicBlock &#42;Successor)</>}>
Add new basic block for fast div and rem operations and put it before SuccessorBB. <a href="#a86c5ad21a2d56d1af3c5f2b39331c02b">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/structs/anonymous-namespace-bypassslowdivision-cpp-/quotremwithbb">QuotRemWithBB</a></>}
  name={<><a href="#a379a96da7f1b4be0b9f5e081210fba5d">createSlowBB</a> (BasicBlock &#42;Successor)</>}>
Add new basic block for slow div and rem operations and put it before SuccessorBB. <a href="#a379a96da7f1b4be0b9f5e081210fba5d">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/type">Type</a> &#42;</>}
  name={<><a href="#a90797c748af6eee89837b818f74a9ab2">getSlowType</a> ()</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/namespaces/anonymous-bypassslowdivision-cpp-/#a36d0c5907e0a6a90e175f343a59b1206">ValueRange</a></>}
  name={<><a href="#a24ac2d7697cecde67c9ef8b576559f19">getValueRange</a> (Value &#42;Op, VisitedSetTy &amp;Visited)</>}>
Check if an integer value fits into our bypass type. <a href="#a24ac2d7697cecde67c9ef8b576559f19">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<>std::optional&lt; <a href="/docs/api/structs/anonymous-namespace-bypassslowdivision-cpp-/quotrempair">QuotRemPair</a> &gt;</>}
  name={<><a href="#af95a5c370fd009c032a7b9e7d474d2df">insertFastDivAndRem</a> ()</>}>
Substitutes the div/rem instruction with code that checks the value of the operands and uses a shorter-faster div/rem instruction when possible. <a href="#af95a5c370fd009c032a7b9e7d474d2df">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">Value</a> &#42;</>}
  name={<><a href="#af0d64e9189eea24fe6f912a3eb090d26">insertOperandRuntimeCheck</a> (Value &#42;Op1, Value &#42;Op2)</>}>
Creates a runtime check to test whether both the divisor and dividend fit into BypassType. <a href="#af0d64e9189eea24fe6f912a3eb090d26">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#ab3997bfeb71ab5591fd057a579b2f890">isDivisionOp</a> ()</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a1cab8ec021a9c3c9f9245468005b59e1">isHashLikeValue</a> (Value &#42;V, VisitedSetTy &amp;Visited)</>}>
Check if a value looks like a hash. <a href="#a1cab8ec021a9c3c9f9245468005b59e1">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aed199058015f21db56caa286f64a1f70">isSignedOp</a> ()</>}>
</MembersIndexItem>

</MembersIndex>

## Private Member Attributes Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/integertype">IntegerType</a> &#42;</>}
  name={<><a href="#a67b61296e3c5c023a62678de9122ed22">BypassType</a> = nullptr</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a068deab70166725d76545344d2d34b2e">IsValidTask</a> = false</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;</>}
  name={<><a href="#a01b0d7b04704d6876e0a2871f3d0d0fa">MainBB</a> = nullptr</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;</>}
  name={<><a href="#abe37de33f2bc8d341b4c00d42136e819">SlowDivOrRem</a> = nullptr</>}>
</MembersIndexItem>

</MembersIndex>


Definition at line 74 of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.

<SectionDefinition>

## Public Constructors

### FastDivInsertionTask() {#ab953cd204338514e8d564c615763d13f}

<MemberDefinition
  prototype={<>FastDivInsertionTask::FastDivInsertionTask (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; I, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/namespaces/anonymous-bypassslowdivision-cpp-/#af59a5e0e43be3e24b0a48311ea4f3b0d">BypassWidthsTy</a> &amp; BypassWidths)</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00102">102</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Public Member Functions

### getReplacement() {#af373b68c535969d897e55c3857997583}

<MemberDefinition
  prototype={<>Value &#42; FastDivInsertionTask::getReplacement (<a href="/docs/api/namespaces/anonymous-bypassslowdivision-cpp-/#ab0c88d4f81519e479e544b0173e59466">DivCacheTy</a> &amp; Cache)</>}>
Reuses previously-computed dividend or remainder from the current BB if operands and operation are identical.

Otherwise calls insertFastDivAndRem to perform the optimization and caches the resulting dividend and remainder. If no replacement can be generated, nullptr is returned.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00104">104</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Member Functions

### createDivRemPhiNodes() {#a0dd8d4ba03c7b55182b1b9fa5ae5d053}

<MemberDefinition
  prototype={<>QuotRemPair FastDivInsertionTask::createDivRemPhiNodes (<a href="/docs/api/structs/anonymous-namespace-bypassslowdivision-cpp-/quotremwithbb">QuotRemWithBB</a> &amp; LHS, <a href="/docs/api/structs/anonymous-namespace-bypassslowdivision-cpp-/quotremwithbb">QuotRemWithBB</a> &amp; RHS, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; PhiBB)</>}>
Creates Phi nodes for result of Div and Rem.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00084">84</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### createFastBB() {#a86c5ad21a2d56d1af3c5f2b39331c02b}

<MemberDefinition
  prototype={<>QuotRemWithBB FastDivInsertionTask::createFastBB (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; Successor)</>}>
Add new basic block for fast div and rem operations and put it before SuccessorBB.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00083">83</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### createSlowBB() {#a379a96da7f1b4be0b9f5e081210fba5d}

<MemberDefinition
  prototype={<>QuotRemWithBB FastDivInsertionTask::createSlowBB (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; Successor)</>}>
Add new basic block for slow div and rem operations and put it before SuccessorBB.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00082">82</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### getSlowType() {#a90797c748af6eee89837b818f74a9ab2}

<MemberDefinition
  prototype={<>Type &#42; anonymous&#95;namespace&#123;BypassSlowDivision.cpp&#125;::FastDivInsertionTask::getSlowType ()</>}
  labels = {["inline"]}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00099">99</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### getValueRange() {#a24ac2d7697cecde67c9ef8b576559f19}

<MemberDefinition
  prototype={<>ValueRange FastDivInsertionTask::getValueRange (<a href="/docs/api/classes/llvm/value">Value</a> &#42; Op, <a href="/docs/api/namespaces/anonymous-bypassslowdivision-cpp-/#ad9ba66f337464ca75cd451c4c7a1cbbe">VisitedSetTy</a> &amp; Visited)</>}>
Check if an integer value fits into our bypass type.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00081">81</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### insertFastDivAndRem() {#af95a5c370fd009c032a7b9e7d474d2df}

<MemberDefinition
  prototype={<>std::optional&lt; QuotRemPair &gt; FastDivInsertionTask::insertFastDivAndRem ()</>}>
Substitutes the div/rem instruction with code that checks the value of the operands and uses a shorter-faster div/rem instruction when possible.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00087">87</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### insertOperandRuntimeCheck() {#af0d64e9189eea24fe6f912a3eb090d26}

<MemberDefinition
  prototype={<>Value &#42; FastDivInsertionTask::insertOperandRuntimeCheck (<a href="/docs/api/classes/llvm/value">Value</a> &#42; Op1, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Op2)</>}>
Creates a runtime check to test whether both the divisor and dividend fit into BypassType.

The check is inserted at the end of MainBB. True return value means that the operands fit. Either of the operands may be NULL if it doesn&#39;t need a runtime check.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00086">86</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### isDivisionOp() {#ab3997bfeb71ab5591fd057a579b2f890}

<MemberDefinition
  prototype={<>bool anonymous&#95;namespace&#123;BypassSlowDivision.cpp&#125;::FastDivInsertionTask::isDivisionOp ()</>}
  labels = {["inline"]}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00094">94</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### isHashLikeValue() {#a1cab8ec021a9c3c9f9245468005b59e1}

<MemberDefinition
  prototype={<>bool FastDivInsertionTask::isHashLikeValue (<a href="/docs/api/classes/llvm/value">Value</a> &#42; V, <a href="/docs/api/namespaces/anonymous-bypassslowdivision-cpp-/#ad9ba66f337464ca75cd451c4c7a1cbbe">VisitedSetTy</a> &amp; Visited)</>}>
Check if a value looks like a hash.

The routine is expected to detect values computed using the most common hash algorithms. Typically, hash computations end with one of the following instructions:

1) MUL with a constant wider than BypassType 2) XOR instruction

And even if we are wrong and the value is not a hash, it is still quite unlikely that such values will fit into BypassType.

To detect string hash algorithms like FNV we have to look through PHI-nodes. It is implemented as a depth-first search for values that look neither long nor hash-like.

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00080">80</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### isSignedOp() {#aed199058015f21db56caa286f64a1f70}

<MemberDefinition
  prototype={<>bool anonymous&#95;namespace&#123;BypassSlowDivision.cpp&#125;::FastDivInsertionTask::isSignedOp ()</>}
  labels = {["inline"]}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00089">89</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Member Attributes

### BypassType {#a67b61296e3c5c023a62678de9122ed22}

<MemberDefinition
  prototype={<>IntegerType&#42; anonymous&#95;namespace&#123;BypassSlowDivision.cpp&#125;::FastDivInsertionTask::BypassType = nullptr</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00077">77</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### IsValidTask {#a068deab70166725d76545344d2d34b2e}

<MemberDefinition
  prototype={<>bool anonymous&#95;namespace&#123;BypassSlowDivision.cpp&#125;::FastDivInsertionTask::IsValidTask = false</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00075">75</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### MainBB {#a01b0d7b04704d6876e0a2871f3d0d0fa}

<MemberDefinition
  prototype={<>BasicBlock&#42; anonymous&#95;namespace&#123;BypassSlowDivision.cpp&#125;::FastDivInsertionTask::MainBB = nullptr</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00078">78</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

### SlowDivOrRem {#abe37de33f2bc8d341b4c00d42136e819}

<MemberDefinition
  prototype={<>Instruction&#42; anonymous&#95;namespace&#123;BypassSlowDivision.cpp&#125;::FastDivInsertionTask::SlowDivOrRem = nullptr</>}>

Definition at line <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp/#l00076">76</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<hr/>

The documentation for this class was generated from the following file:

<ul>
<li><a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/bypassslowdivision-cpp">BypassSlowDivision.cpp</a></li>
</ul>

</DoxygenPage>
