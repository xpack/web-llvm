---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - class
toc_max_heading_level: 3

---

import Link from '@docusaurus/Link'
import CodeBlock from '@theme/CodeBlock'

import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import EnumerationList from '@xpack/docusaurus-plugin-doxygen/components/EnumerationList'
import EnumerationListItem from '@xpack/docusaurus-plugin-doxygen/components/EnumerationListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `JoinVals` Class Reference

<DoxygenPage pluginConfig={pluginConfig}>

Track information about values in a single virtual register about to be joined. <a href="#details">More...</a>

## Declaration

<CodeBlock>class anonymous_namespace{RegisterCoalescer.cpp}::JoinVals</CodeBlock>

## Enumerations Index

<MembersIndex>

<MembersIndexItem
  type="enum"
  name={<>:  &#123; <a href="#a7caa969b35ea838dd4137cd213b8909c">...</a> &#125;</>}>
Conflict resolution for overlapping values. <a href="#a7caa969b35ea838dd4137cd213b8909c">More...</a>
</MembersIndexItem>

</MembersIndex>

## Public Constructors Index

<MembersIndex>

<MembersIndexItem
  name={<><a href="#a5bdb429abc9cabb96a3c3df03e53e2ea">JoinVals</a> (LiveRange &amp;LR, Register Reg, unsigned SubIdx, LaneBitmask LaneMask, SmallVectorImpl&lt; VNInfo &#42; &gt; &amp;newVNInfo, const CoalescerPair &amp;cp, LiveIntervals &#42;lis, const TargetRegisterInfo &#42;TRI, bool SubRangeJoin, bool TrackSubRegLiveness)</>}>
</MembersIndexItem>

</MembersIndex>

## Public Member Functions Index

<MembersIndex>

<MembersIndexItem
  type="void"
  name={<><a href="#a1659a196eabbdd653b9a5d529ccfcb6e">eraseInstrs</a> (SmallPtrSetImpl&lt; MachineInstr &#42; &gt; &amp;ErasedInstrs, SmallVectorImpl&lt; Register &gt; &amp;ShrinkRegs, LiveInterval &#42;LI=nullptr)</>}>
Erase any machine instructions that have been coalesced away. <a href="#a1659a196eabbdd653b9a5d529ccfcb6e">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> int &#42;</>}
  name={<><a href="#a6e401cb75317feb575c5ab9f844c1da2">getAssignments</a> () const</>}>
Get the value assignments suitable for passing to LiveInterval::join. <a href="#a6e401cb75317feb575c5ab9f844c1da2">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="#a7caa969b35ea838dd4137cd213b8909c">ConflictResolution</a></>}
  name={<><a href="#a2073d38573fd65fc21a3b6a205a025d4">getResolution</a> (unsigned Num) const</>}>
Get the conflict resolution for a value number. <a href="#a2073d38573fd65fc21a3b6a205a025d4">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a5a8768b37f48763192c2530de53f97b0">mapValues</a> (JoinVals &amp;Other)</>}>
Analyze defs in LR and compute a value mapping in NewVNInfo. <a href="#a5a8768b37f48763192c2530de53f97b0">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a1b3c2e77ef89dfcb6bc2129edc827264">pruneMainSegments</a> (LiveInterval &amp;LI, bool &amp;ShrinkMainRange)</>}>
Pruning values in subranges can lead to removing segments in these subranges started by IMPLICIT&#95;DEFs. <a href="#a1b3c2e77ef89dfcb6bc2129edc827264">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a3730642a8860945b6ca5ca954a238592">pruneSubRegValues</a> (LiveInterval &amp;LI, LaneBitmask &amp;ShrinkMask)</>}>
Removes subranges starting at copies that get removed. <a href="#a3730642a8860945b6ca5ca954a238592">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#aa3fe888e13e687c808085c0cfba933c3">pruneValues</a> (JoinVals &amp;Other, SmallVectorImpl&lt; SlotIndex &gt; &amp;EndPoints, bool changeInstrs)</>}>
Prune the live range of values in Other.LR where they would conflict with CR&#95;Replace values in LR. <a href="#aa3fe888e13e687c808085c0cfba933c3">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a8546f9a7fa0a18cfe46dc20582dcbed2">removeImplicitDefs</a> ()</>}>
Remove liverange defs at places where implicit defs will be removed. <a href="#a8546f9a7fa0a18cfe46dc20582dcbed2">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#add7c3bdd8428904f63f53569807b8df6">resolveConflicts</a> (JoinVals &amp;Other)</>}>
Try to resolve conflicts that require all values to be mapped. <a href="#add7c3bdd8428904f63f53569807b8df6">More...</a>
</MembersIndexItem>

</MembersIndex>

## Private Member Functions Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="#a7caa969b35ea838dd4137cd213b8909c">ConflictResolution</a></>}
  name={<><a href="#a9f38448e774565f2509e150d077720bc">analyzeValue</a> (unsigned ValNo, JoinVals &amp;Other)</>}>
Analyze ValNo in this live range, and set all fields of Vals&#91;ValNo&#93;. <a href="#a9f38448e774565f2509e150d077720bc">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#ae30a0b4535b2f92da284051c9ec5f9ae">computeAssignment</a> (unsigned ValNo, JoinVals &amp;Other)</>}>
Compute the value assignment for ValNo in RI. <a href="#ae30a0b4535b2f92da284051c9ec5f9ae">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a></>}
  name={<><a href="#a3b601b590cadfef81704df7fedb69624">computeWriteLanes</a> (const MachineInstr &#42;DefMI, bool &amp;Redef) const</>}>
Compute the bitmask of lanes actually written by DefMI. <a href="#a3b601b590cadfef81704df7fedb69624">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<>std::pair&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;, <a href="/docs/api/classes/llvm/register">Register</a> &gt;</>}
  name={<><a href="#a52db6b6bd97b58d14370627d4df18c10">followCopyChain</a> (const VNInfo &#42;VNI) const</>}>
Find the ultimate value that VNI was copied from. <a href="#a52db6b6bd97b58d14370627d4df18c10">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#afcd0b50c56e4d0c0fc61d306d86e9739">isPrunedValue</a> (unsigned ValNo, JoinVals &amp;Other)</>}>
Determine if ValNo is a copy of a value number in LR or Other.LR that will be pruned: <a href="#afcd0b50c56e4d0c0fc61d306d86e9739">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a2ca697afdb307e5d8509a65dd7419330">taintExtent</a> (unsigned ValNo, LaneBitmask TaintedLanes, JoinVals &amp;Other, SmallVectorImpl&lt; std::pair&lt; SlotIndex, LaneBitmask &gt; &gt; &amp;TaintExtent)</>}>
Assuming ValNo is going to clobber some valid lanes in Other.LR, compute the extent of the tainted lanes in the block. <a href="#a2ca697afdb307e5d8509a65dd7419330">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aed477e65dbeca025bf7fe2569c6ae56a">usesLanes</a> (const MachineInstr &amp;MI, Register, unsigned, LaneBitmask) const</>}>
Return true if MI uses any of the given Lanes from Reg. <a href="#aed477e65dbeca025bf7fe2569c6ae56a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a7f909c08212c6a23345731f266a416b6">valuesIdentical</a> (VNInfo &#42;Value0, VNInfo &#42;Value1, const JoinVals &amp;Other) const</>}>
</MembersIndexItem>

</MembersIndex>

## Private Member Attributes Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; int, 8 &gt;</>}
  name={<><a href="#a51ac22cac123d277c544dc93ecca618d">Assignments</a></>}>
<a href="/docs/api/classes/llvm/value">Value</a> number assignments. <a href="#a51ac22cac123d277c544dc93ecca618d">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;</>}
  name={<><a href="#aa2acb84b6d047282d222a27ee05d0a73">CP</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/slotindexes">SlotIndexes</a> &#42;</>}
  name={<><a href="#a7e72f48daa6146407f9cec4837acfbf8">Indexes</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a></>}
  name={<><a href="#a8cae4b22a19d4de03a2bd5a3f9f17867">LaneMask</a></>}>
The LaneMask that this liverange will occupy the coalesced register. <a href="#a8cae4b22a19d4de03a2bd5a3f9f17867">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/liveintervals">LiveIntervals</a> &#42;</>}
  name={<><a href="#aaa0132b120c5860a4450968879f28b91">LIS</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;</>}
  name={<><a href="#a87036fce73f22c86c223b4bd7760cb6b">LR</a></>}>
Live range we work on. <a href="#a87036fce73f22c86c223b4bd7760cb6b">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42; &gt; &amp;</>}
  name={<><a href="#adca2cec60f0ea667907cbcb02676b5c5">NewVNInfo</a></>}>
Values that will be present in the final live range. <a href="#adca2cec60f0ea667907cbcb02676b5c5">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/register">Register</a></>}
  name={<><a href="#ad6bf2b256fbb6a03d7a2f05a6ad0a1f4">Reg</a></>}>
(Main) register we work on. <a href="#ad6bf2b256fbb6a03d7a2f05a6ad0a1f4">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> unsigned</>}
  name={<><a href="#a00b16137289c18d9b40835d65fcb0ccb">SubIdx</a></>}>
Reg (and therefore the values in this liverange) will end up as subregister SubIdx in the coalesced register. <a href="#a00b16137289c18d9b40835d65fcb0ccb">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> bool</>}
  name={<><a href="#a8d3cea41a4b61ccea063ee5a717b8867">SubRangeJoin</a></>}>
This is true when joining sub register ranges, false when joining main ranges. <a href="#a8d3cea41a4b61ccea063ee5a717b8867">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> bool</>}
  name={<><a href="#a5cc9c5a4fe37b635831c4b622b5ae350">TrackSubRegLiveness</a></>}>
Whether the current <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> tracks subregister liveness. <a href="#a5cc9c5a4fe37b635831c4b622b5ae350">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &#42;</>}
  name={<><a href="#aa624e808af5f76a7545541a1702b6a0d">TRI</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; Val, 8 &gt;</>}
  name={<><a href="#acd0156cc106a925e972fa89e2f4c5e66">Vals</a></>}>
One entry per value number in LI. <a href="#acd0156cc106a925e972fa89e2f4c5e66">More...</a>
</MembersIndexItem>

</MembersIndex>

## Description {#details}

Track information about values in a single virtual register about to be joined.

Objects of this class are always created in pairs - one for each side of the <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> (or one for each lane of a side of the coalescer pair)

Definition at line 2458 of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.

<SectionDefinition>

## Enumerations

### enum  {#a7caa969b35ea838dd4137cd213b8909c}

<MemberDefinition
  prototype={<>enum anonymous_namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::ConflictResolution </>}>
Conflict resolution for overlapping values.

<EnumerationList title="Enumeration values">

<Link id="a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73" />
<EnumerationListItem name="CR_Keep">
No overlap, simply keep this value
</EnumerationListItem>

<Link id="a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d" />
<EnumerationListItem name="CR_Erase">
Merge this value into OtherVNI and erase the defining instruction
</EnumerationListItem>

<Link id="a7caa969b35ea838dd4137cd213b8909ca58561957307c3721aad71b897e448647" />
<EnumerationListItem name="CR_Merge">
Merge this value into OtherVNI but keep the defining instruction
</EnumerationListItem>

<Link id="a7caa969b35ea838dd4137cd213b8909ca191f458a9d415a178a901a75baa4bd0e" />
<EnumerationListItem name="CR_Replace">
Keep this value, and have it replace OtherVNI where possible
</EnumerationListItem>

<Link id="a7caa969b35ea838dd4137cd213b8909cabd7e0ab4ddda4ab7abfdc4077f6d8a50" />
<EnumerationListItem name="CR_Unresolved">
Unresolved conflict. Visit later when all values have been mapped
</EnumerationListItem>

<Link id="a7caa969b35ea838dd4137cd213b8909cadf133404fe2559cd68f16253fac30869" />
<EnumerationListItem name="CR_Impossible">
Unresolvable conflict. Abort the join
</EnumerationListItem>

</EnumerationList>

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02495">2495</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Public Constructors

### JoinVals() {#a5bdb429abc9cabb96a3c3df03e53e2ea}

<MemberDefinition
  prototype={<>anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::JoinVals (<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp; LR, <a href="/docs/api/classes/llvm/register">Register</a> Reg, unsigned SubIdx, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> LaneMask, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42; &gt; &amp; newVNInfo, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp; cp, <a href="/docs/api/classes/llvm/liveintervals">LiveIntervals</a> &#42; lis, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &#42; TRI, bool SubRangeJoin, bool TrackSubRegLiveness)</>}
  labels = {["inline"]}>

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02643">2643</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Public Member Functions

### eraseInstrs() {#a1659a196eabbdd653b9a5d529ccfcb6e}

<MemberDefinition
  prototype={<>void JoinVals::eraseInstrs (<a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl</a>&lt; <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42; &gt; &amp; ErasedInstrs, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/register">Register</a> &gt; &amp; ShrinkRegs, <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &#42; LI=nullptr)</>}>
Erase any machine instructions that have been coalesced away.

Add erased instructions to ErasedInstrs. Add foreign virtual registers to ShrinkRegs if their live range ended at the erased instrs.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02685">2685</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### getAssignments() {#a6e401cb75317feb575c5ab9f844c1da2}

<MemberDefinition
  prototype={<>const int &#42; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::getAssignments () const</>}
  labels = {["inline"]}>
Get the value assignments suitable for passing to LiveInterval::join.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02693">2693</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### getResolution() {#a2073d38573fd65fc21a3b6a205a025d4}

<MemberDefinition
  prototype={<>ConflictResolution anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::getResolution (unsigned Num) const</>}
  labels = {["inline"]}>
Get the conflict resolution for a value number.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02696">2696</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### mapValues() {#a5a8768b37f48763192c2530de53f97b0}

<MemberDefinition
  prototype={<>bool JoinVals::mapValues (<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp; Other)</>}>
Analyze defs in LR and compute a value mapping in NewVNInfo.

Returns false if any conflicts were impossible to resolve.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02655">2655</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### pruneMainSegments() {#a1b3c2e77ef89dfcb6bc2129edc827264}

<MemberDefinition
  prototype={<>void JoinVals::pruneMainSegments (<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp; LI, bool &amp; ShrinkMainRange)</>}>
Pruning values in subranges can lead to removing segments in these subranges started by IMPLICIT&#95;DEFs.

The corresponding segments in the main range also need to be removed. This function will mark the corresponding values in the main range as pruned, so that eraseInstrs can do the final cleanup. The parameter <code>LI</code> must be the interval whose main range is the live range LR.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02679">2679</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### pruneSubRegValues() {#a3730642a8860945b6ca5ca954a238592}

<MemberDefinition
  prototype={<>void JoinVals::pruneSubRegValues (<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp; LI, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> &amp; ShrinkMask)</>}>
Removes subranges starting at copies that get removed.

Consider the following situation when coalescing the copy between %31 and %45 at 800.

This sometimes happens when undefined subranges are copied around. These ranges contain no useful information and can be removed.

(The vertical lines represent live range segments.) 

<CodeBlock>
                         Main range         Subrange 0004 (sub2)
                         %31    %45           %31    %45
</CodeBlock> 544 %45 = COPY %28 + + | v1 | v1 560B bb.1: + + 624 = %45.sub2 | v2 | v2 800 %31 = COPY %45 + + + + | v0 | v0 816 %31.sub1 = ... + | 880 %30 = COPY %31 | v1 + 928 %45 = COPY %30 | + + | | v0 | v0 &lt;–+ 992B ; backedge -&gt; bb.1 | + + | 1040 = %31.sub0 + | This value must remain live-out!

Assuming that %31 is coalesced into %45, the copy at 928 becomes redundant, since it copies the value from %45 back into it. The conflict resolution for the main range determines that %45.v0 is to be erased, which is ok since %31.v1 is identical to it. The problem happens with the subrange for sub2: it has to be live on exit from the block, but since 928 was actually a point of definition of %45.sub2, %45.sub2 was not live immediately prior to that definition. As a result, when 928 was erased, the value v0 for %45.sub2 was pruned in pruneSubRegValues. Consequently, an IMPLICIT&#95;DEF was inserted as a &quot;backedge&quot; definition for %45.sub2, providing an incorrect value to the use at 624.

Since the main-range values %31.v1 and %45.v0 were proved to be identical, the corresponding values in subranges must also be the same. A redundant copy is removed because it&#39;s not needed, and not because it copied an undefined value, so any liveness that originated from that copy cannot disappear. When pruning a value that started at the removed copy, the corresponding identical value must be extended to replace it.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02670">2670</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### pruneValues() {#aa3fe888e13e687c808085c0cfba933c3}

<MemberDefinition
  prototype={<>void JoinVals::pruneValues (<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp; Other, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> &gt; &amp; EndPoints, bool changeInstrs)</>}>
Prune the live range of values in Other.LR where they would conflict with CR&#95;Replace values in LR.

Collect end points for restoring the live range after joining.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02664">2664</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### removeImplicitDefs() {#a8546f9a7fa0a18cfe46dc20582dcbed2}

<MemberDefinition
  prototype="void JoinVals::removeImplicitDefs ()">
Remove liverange defs at places where implicit defs will be removed.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02690">2690</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### resolveConflicts() {#add7c3bdd8428904f63f53569807b8df6}

<MemberDefinition
  prototype={<>bool JoinVals::resolveConflicts (<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp; Other)</>}>
Try to resolve conflicts that require all values to be mapped.

Returns false if any conflicts were impossible to resolve.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02659">2659</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Member Functions

### analyzeValue() {#a9f38448e774565f2509e150d077720bc}

<MemberDefinition
  prototype={<>JoinVals::ConflictResolution JoinVals::analyzeValue (unsigned ValNo, <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp; Other)</>}>
Analyze ValNo in this live range, and set all fields of Vals&#91;ValNo&#93;.

Return a conflict resolution when possible, but leave the hard cases as CR&#95;Unresolved. Recursively calls computeAssignment() on this and Other, guaranteeing that both OtherVNI and RedefVNI have been analyzed and mapped before returning. The recursion always goes upwards in the dominator tree, making loops impossible.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02604">2604</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### computeAssignment() {#ae30a0b4535b2f92da284051c9ec5f9ae}

<MemberDefinition
  prototype={<>void JoinVals::computeAssignment (unsigned ValNo, <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp; Other)</>}>
Compute the value assignment for ValNo in RI.

This may be called recursively by analyzeValue(), but never for a ValNo on the stack.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02609">2609</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### computeWriteLanes() {#a3b601b590cadfef81704df7fedb69624}

<MemberDefinition
  prototype={<>LaneBitmask JoinVals::computeWriteLanes (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42; DefMI, bool &amp; Redef) const</>}>
Compute the bitmask of lanes actually written by DefMI.

Set Redef if there are any partial register definitions that depend on the previous value of the register.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02589">2589</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### followCopyChain() {#a52db6b6bd97b58d14370627d4df18c10}

<MemberDefinition
  prototype={<>std::pair&lt; const VNInfo &#42;, Register &gt; JoinVals::followCopyChain (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42; VNI) const</>}>
Find the ultimate value that VNI was copied from.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02592">2592</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### isPrunedValue() {#afcd0b50c56e4d0c0fc61d306d86e9739}

<MemberDefinition
  prototype={<>bool JoinVals::isPrunedValue (unsigned ValNo, <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp; Other)</>}>
Determine if ValNo is a copy of a value number in LR or Other.LR that will be pruned:

dst = COPY src src = COPY dst &lt;– This value to be pruned. dst = COPY src &lt;– This value is a copy of a pruned value.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02640">2640</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### taintExtent() {#a2ca697afdb307e5d8509a65dd7419330}

<MemberDefinition
  prototype={<>bool JoinVals::taintExtent (unsigned ValNo, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> TaintedLanes, <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp; Other, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; std::pair&lt; <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a>, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> &gt; &gt; &amp; TaintExtent)</>}>
Assuming ValNo is going to clobber some valid lanes in Other.LR, compute the extent of the tainted lanes in the block.

Multiple values in Other.LR can be affected since partial redefinitions can preserve previously tainted lanes.

1 dst = VLOAD &lt;– Define all lanes in dst 2 src = FOO &lt;– ValNo to be joined with dst:ssub0 3 dst:ssub1 = BAR &lt;– Partial redef doesn&#39;t clear taint in ssub0 4 dst:ssub0 = COPY src &lt;– Conflict resolved, ssub0 wasn&#39;t read

For each ValNo in Other that is affected, add an (EndIndex, TaintedLanes) entry to TaintedVals.

Returns false if the tainted lanes extend beyond the basic block.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02627">2627</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### usesLanes() {#aed477e65dbeca025bf7fe2569c6ae56a}

<MemberDefinition
  prototype={<>bool JoinVals::usesLanes (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp; MI, <a href="/docs/api/classes/llvm/register">Register</a> Reg, unsigned SubIdx, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> Lanes) const</>}>
Return true if MI uses any of the given Lanes from Reg.

This does not include partial redefinitions of Reg.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02632">2632</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### valuesIdentical() {#a7f909c08212c6a23345731f266a416b6}

<MemberDefinition
  prototype={<>bool JoinVals::valuesIdentical (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42; Value0, <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42; Value1, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp; Other) const</>}>

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02594">2594</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Member Attributes

### Assignments {#a51ac22cac123d277c544dc93ecca618d}

<MemberDefinition
  prototype={<>SmallVector&lt;int, 8&gt; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::Assignments</>}>
<a href="/docs/api/classes/llvm/value">Value</a> number assignments.

Maps value numbers in LI to entries in NewVNInfo. This is suitable for passing to LiveInterval::join().

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02491">2491</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### CP {#aa2acb84b6d047282d222a27ee05d0a73}

<MemberDefinition
  prototype={<>const CoalescerPair&amp; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::CP</>}>

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02484">2484</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### Indexes {#a7e72f48daa6146407f9cec4837acfbf8}

<MemberDefinition
  prototype={<>SlotIndexes&#42; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::Indexes</>}>

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02486">2486</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### LaneMask {#a8cae4b22a19d4de03a2bd5a3f9f17867}

<MemberDefinition
  prototype={<>const LaneBitmask anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::LaneMask</>}>
The LaneMask that this liverange will occupy the coalesced register.

May be smaller than the lanemask produced by SubIdx when merging subranges.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02472">2472</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### LIS {#aaa0132b120c5860a4450968879f28b91}

<MemberDefinition
  prototype={<>LiveIntervals&#42; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::LIS</>}>

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02485">2485</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### LR {#a87036fce73f22c86c223b4bd7760cb6b}

<MemberDefinition
  prototype={<>LiveRange&amp; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::LR</>}>
Live range we work on.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02460">2460</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### NewVNInfo {#adca2cec60f0ea667907cbcb02676b5c5}

<MemberDefinition
  prototype={<>SmallVectorImpl&lt;VNInfo &#42;&gt;&amp; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::NewVNInfo</>}>
Values that will be present in the final live range.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02482">2482</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### Reg {#ad6bf2b256fbb6a03d7a2f05a6ad0a1f4}

<MemberDefinition
  prototype={<>const Register anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::Reg</>}>
(Main) register we work on.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02463">2463</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### SubIdx {#a00b16137289c18d9b40835d65fcb0ccb}

<MemberDefinition
  prototype={<>const unsigned anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::SubIdx</>}>
Reg (and therefore the values in this liverange) will end up as subregister SubIdx in the coalesced register.

Either CP.DstIdx or CP.SrcIdx.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02468">2468</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### SubRangeJoin {#a8d3cea41a4b61ccea063ee5a717b8867}

<MemberDefinition
  prototype={<>const bool anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::SubRangeJoin</>}>
This is true when joining sub register ranges, false when joining main ranges.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02476">2476</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### TrackSubRegLiveness {#a5cc9c5a4fe37b635831c4b622b5ae350}

<MemberDefinition
  prototype={<>const bool anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::TrackSubRegLiveness</>}>
Whether the current <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> tracks subregister liveness.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02479">2479</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### TRI {#aa624e808af5f76a7545541a1702b6a0d}

<MemberDefinition
  prototype={<>const TargetRegisterInfo&#42; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::TRI</>}>

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02487">2487</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### Vals {#acd0156cc106a925e972fa89e2f4c5e66}

<MemberDefinition
  prototype={<>SmallVector&lt;Val, 8&gt; anonymous&#95;namespace&#123;RegisterCoalescer.cpp&#125;::JoinVals::Vals</>}>
One entry per value number in LI.

Definition at line <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp/#l02584">2584</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<hr/>

The documentation for this class was generated from the following file:

<ul>
<li><a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a></li>
</ul>

</DoxygenPage>
