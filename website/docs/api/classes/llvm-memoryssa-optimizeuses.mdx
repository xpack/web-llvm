---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/classes/llvm/memoryssa/optimizeuses
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - class
toc_max_heading_level: 3

---

import CodeBlock from '@theme/CodeBlock'

import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `OptimizeUses` Class Reference

<DoxygenPage pluginConfig={pluginConfig}>

This class is a batch walker of all <a href="/docs/api/classes/llvm/memoryuse">MemoryUse</a>&#39;s in the program, and points their defining access at the thing that actually clobbers them. <a href="#details">More...</a>

## Declaration

<CodeBlock>class llvm::MemorySSA::OptimizeUses</CodeBlock>

## Public Constructors Index

<MembersIndex>

<MembersIndexItem
  name={<><a href="#ad7fb8e8bcc5cf17ad15225ab3cb9e401">OptimizeUses</a> (MemorySSA &#42;MSSA, CachingWalker &#42;Walker, BatchAAResults &#42;BAA, DominatorTree &#42;DT)</>}>
</MembersIndexItem>

</MembersIndex>

## Public Member Functions Index

<MembersIndex>

<MembersIndexItem
  type="void"
  name={<><a href="#a195658a43b30378309ff4e62455dc137">optimizeUses</a> ()</>}>
Optimize uses to point to their actual clobbering definitions. <a href="#a195658a43b30378309ff4e62455dc137">More...</a>
</MembersIndexItem>

</MembersIndex>

## Private Member Functions Index

<MembersIndex>

<MembersIndexItem
  type="void"
  name={<><a href="#acb4afff4441502cbce3571ec00d0ada3">optimizeUsesInBlock</a> (const BasicBlock &#42;, unsigned long &amp;, unsigned long &amp;, SmallVectorImpl&lt; MemoryAccess &#42; &gt; &amp;, DenseMap&lt; MemoryLocOrCall, MemlocStackInfo &gt; &amp;)</>}>
Optimize the uses in a given block This is basically the SSA renaming algorithm, with one caveat: We are able to use a single stack for all MemoryUses. <a href="#acb4afff4441502cbce3571ec00d0ada3">More...</a>
</MembersIndexItem>

</MembersIndex>

## Private Member Attributes Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/batchaaresults">BatchAAResults</a> &#42;</>}
  name={<><a href="#a78bb9b4cc2902c24215ca19f8e7f7a28">AA</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &#42;</>}
  name={<><a href="#a6778484e11a1d033766e2638b9c29644">DT</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/memoryssa">MemorySSA</a> &#42;</>}
  name={<><a href="#a47d5cc88db69afde5daaa2773e47a9fe">MSSA</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/memoryssa/cachingwalker">CachingWalker</a> &#42;</>}
  name={<><a href="#ab52d2db73fe03289efbca3f0414b8bda">Walker</a></>}>
</MembersIndexItem>

</MembersIndex>

## Description {#details}

This class is a batch walker of all <a href="/docs/api/classes/llvm/memoryuse">MemoryUse</a>&#39;s in the program, and points their defining access at the thing that actually clobbers them.

Because it is a batch walker that touches everything, it does not operate like the other walkers. This walker is basically performing a top-down SSA renaming pass, where the version stack is used as the cache. This enables it to be significantly more time and memory efficient than using the regular walker, which is walking bottom-up.

Definition at line 1304 of file <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a>.

<SectionDefinition>

## Public Constructors

### OptimizeUses() {#ad7fb8e8bcc5cf17ad15225ab3cb9e401}

<MemberDefinition
  prototype={<>llvm::MemorySSA::OptimizeUses::OptimizeUses (<a href="/docs/api/classes/llvm/memoryssa">MemorySSA</a> &#42; MSSA, <a href="/docs/api/classes/llvm/memoryssa/cachingwalker">CachingWalker</a> &#42; Walker, <a href="/docs/api/classes/llvm/batchaaresults">BatchAAResults</a> &#42; BAA, <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &#42; DT)</>}
  labels = {["inline"]}>

Definition at line <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp/#l01306">1306</a> of file <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Public Member Functions

### optimizeUses() {#a195658a43b30378309ff4e62455dc137}

<MemberDefinition
  prototype="void MemorySSA::OptimizeUses::optimizeUses ()">
Optimize uses to point to their actual clobbering definitions.

Definition at line <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp/#l01310">1310</a> of file <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Member Functions

### optimizeUsesInBlock() {#acb4afff4441502cbce3571ec00d0ada3}

<MemberDefinition
  prototype={<>void MemorySSA::OptimizeUses::optimizeUsesInBlock (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; BB, unsigned long &amp; StackEpoch, unsigned long &amp; PopEpoch, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/memoryaccess">MemoryAccess</a> &#42; &gt; &amp; VersionStack, <a href="/docs/api/classes/llvm/densemap">DenseMap</a>&lt; MemoryLocOrCall, MemlocStackInfo &gt; &amp; LocStackInfo)</>}>
Optimize the uses in a given block This is basically the SSA renaming algorithm, with one caveat: We are able to use a single stack for all MemoryUses.

This is because the set of <em>possible</em> reaching MemoryDefs is the same for every <a href="/docs/api/classes/llvm/memoryuse">MemoryUse</a>. The <em>actual</em> clobbering <a href="/docs/api/classes/llvm/memorydef">MemoryDef</a> is just going to be some position in that stack of possible ones.

We track the stack positions that each <a href="/docs/api/classes/llvm/memorylocation">MemoryLocation</a> needs to check, and last ended at. This is because we only want to check the things that changed since last time. The same <a href="/docs/api/classes/llvm/memorylocation">MemoryLocation</a> should get clobbered by the same store (getModRefInfo does not use invariantness or things like this, and if they start, we can modify MemoryLocOrCall to include relevant data)

Definition at line <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp/#l01330">1330</a> of file <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Private Member Attributes

### AA {#a78bb9b4cc2902c24215ca19f8e7f7a28}

<MemberDefinition
  prototype={<>BatchAAResults&#42; llvm::MemorySSA::OptimizeUses::AA</>}>

Definition at line <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp/#l01336">1336</a> of file <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a>.
</MemberDefinition>

### DT {#a6778484e11a1d033766e2638b9c29644}

<MemberDefinition
  prototype={<>DominatorTree&#42; llvm::MemorySSA::OptimizeUses::DT</>}>

Definition at line <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp/#l01337">1337</a> of file <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a>.
</MemberDefinition>

### MSSA {#a47d5cc88db69afde5daaa2773e47a9fe}

<MemberDefinition
  prototype={<>MemorySSA&#42; llvm::MemorySSA::OptimizeUses::MSSA</>}>

Definition at line <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp/#l01334">1334</a> of file <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a>.
</MemberDefinition>

### Walker {#ab52d2db73fe03289efbca3f0414b8bda}

<MemberDefinition
  prototype={<>CachingWalker&#42; llvm::MemorySSA::OptimizeUses::Walker</>}>

Definition at line <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp/#l01335">1335</a> of file <a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<hr/>

The documentation for this class was generated from the following file:

<ul>
<li><a href="/docs/api/files/lib/lib/analysis/memoryssa-cpp">MemorySSA.cpp</a></li>
</ul>

</DoxygenPage>
