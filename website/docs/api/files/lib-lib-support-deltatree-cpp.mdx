---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/files/lib/lib/support/deltatree-cpp
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - file

---

import Link from '@docusaurus/Link'

import CodeLine from '@xpack/docusaurus-plugin-doxygen/components/CodeLine'
import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import IncludesList from '@xpack/docusaurus-plugin-doxygen/components/IncludesList'
import IncludesListItem from '@xpack/docusaurus-plugin-doxygen/components/IncludesListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import ProgramListing from '@xpack/docusaurus-plugin-doxygen/components/ProgramListing'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `DeltaTree.cpp` File Reference

<DoxygenPage pluginConfig={pluginConfig}>



## Included Headers

<IncludesList>
<IncludesListItem
  filePath="llvm/ADT/DeltaTree.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/deltatree-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Casting.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/casting-h"
  isLocal="true" />
<IncludesListItem
  filePath="cassert"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cstring"
  permalink=""
  isLocal="false" />
</IncludesList>

## Namespaces Index

<MembersIndex>

<MembersIndexItem
  type="namespace"
  name={<><a href="/docs/api/namespaces/anonymous-deltatree-cpp-">anonymous&#123;DeltaTree.cpp&#125;</a></>}>
The <a href="/docs/api/classes/llvm/deltatree">DeltaTree</a> class is a multiway search tree (BTree) structure with some fancy features. <a href="/docs/api/namespaces/anonymous-deltatree-cpp-/#details">More...</a>
</MembersIndexItem>

</MembersIndex>

## Classes Index

<MembersIndex>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a></>}>
<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> - As code in the original input buffer is added and deleted, <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> records are used to keep track of how the input SourceLocation object is mapped into the output buffer. <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode">DeltaTreeNode</a></>}>
<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode">DeltaTreeNode</a> - The common part of all nodes. <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult">InsertResult</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode">DeltaTreeInteriorNode</a></>}>
<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode">DeltaTreeInteriorNode</a> - When isLeaf = false, a node has child pointers. <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#details">More...</a>
</MembersIndexItem>

</MembersIndex>

## Functions Index

<MembersIndex>

<MembersIndexItem
  type={<>DeltaTreeNode &#42;</>}
  name={<><a href="#ab590661425ca60ca82edfdb4cf22233d">getRoot</a> (void &#42;Root)</>}>
</MembersIndexItem>

</MembersIndex>


<SectionDefinition>

## Functions

### getRoot() {#ab590661425ca60ca82edfdb4cf22233d}

<MemberDefinition
  prototype={<>static DeltaTreeNode &#42; getRoot (void &#42; Root)</>}
  labels = {["static"]}>

Definition at line <a href="#l00386">386</a> of file <a href="/docs/api/files/lib/lib/support/deltatree-cpp">DeltaTree.cpp</a>.
</MemberDefinition>

</SectionDefinition>

## File Listing

The file content with the documentation metadata removed is:

<ProgramListing>

<Link id="l00001" /><CodeLine lineNumber="1"><span class="doxyHighlightComment">//===- DeltaTree.cpp - B-Tree for Rewrite Delta tracking ------------------===//</span></CodeLine>
<Link id="l00002" /><CodeLine lineNumber="2"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00003" /><CodeLine lineNumber="3"><span class="doxyHighlightComment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></CodeLine>
<Link id="l00004" /><CodeLine lineNumber="4"><span class="doxyHighlightComment">// See https://llvm.org/LICENSE.txt for license information.</span></CodeLine>
<Link id="l00005" /><CodeLine lineNumber="5"><span class="doxyHighlightComment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></CodeLine>
<Link id="l00006" /><CodeLine lineNumber="6"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00007" /><CodeLine lineNumber="7"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00008" /><CodeLine lineNumber="8"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00009" /><CodeLine lineNumber="9"><span class="doxyHighlightComment">// This file implements the DeltaTree and related classes.</span></CodeLine>
<Link id="l00010" /><CodeLine lineNumber="10"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00011" /><CodeLine lineNumber="11"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00012" /><CodeLine lineNumber="12"></CodeLine>
<Link id="l00013" /><CodeLine lineNumber="13"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/deltatree-h">llvm/ADT/DeltaTree.h</a>&quot;</span></CodeLine>
<Link id="l00014" /><CodeLine lineNumber="14"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/casting-h">llvm/Support/Casting.h</a>&quot;</span></CodeLine>
<Link id="l00015" /><CodeLine lineNumber="15"><span class="doxyHighlightPreprocessor">#include &lt;cassert&gt;</span></CodeLine>
<Link id="l00016" /><CodeLine lineNumber="16"><span class="doxyHighlightPreprocessor">#include &lt;cstring&gt;</span></CodeLine>
<Link id="l00017" /><CodeLine lineNumber="17"></CodeLine>
<Link id="l00018" /><CodeLine lineNumber="18"><span class="doxyHighlightKeyword">using namespace </span><span class="doxyHighlight"><a href="/docs/api/namespaces/llvm">llvm</a>;</span></CodeLine>
<Link id="l00019" /><CodeLine lineNumber="19"></CodeLine>
<Link id="l00020" /><CodeLine lineNumber="20"><span class="doxyHighlightComment">/// The DeltaTree class is a multiway search tree (BTree) structure with some</span></CodeLine>
<Link id="l00021" /><CodeLine lineNumber="21"><span class="doxyHighlightComment">/// fancy features.  B-Trees are generally more memory and cache efficient</span></CodeLine>
<Link id="l00022" /><CodeLine lineNumber="22"><span class="doxyHighlightComment">/// than binary trees, because they store multiple keys/values in each node.</span></CodeLine>
<Link id="l00023" /><CodeLine lineNumber="23"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00024" /><CodeLine lineNumber="24"><span class="doxyHighlightComment">/// DeltaTree implements a key/value mapping from FileIndex to Delta, allowing</span></CodeLine>
<Link id="l00025" /><CodeLine lineNumber="25"><span class="doxyHighlightComment">/// fast lookup by FileIndex.  However, an added (important) bonus is that it</span></CodeLine>
<Link id="l00026" /><CodeLine lineNumber="26"><span class="doxyHighlightComment">/// can also efficiently tell us the full accumulated delta for a specific</span></CodeLine>
<Link id="l00027" /><CodeLine lineNumber="27"><span class="doxyHighlightComment">/// file offset as well, without traversing the whole tree.</span></CodeLine>
<Link id="l00028" /><CodeLine lineNumber="28"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00029" /><CodeLine lineNumber="29"><span class="doxyHighlightComment">/// The nodes of the tree are made up of instances of two classes:</span></CodeLine>
<Link id="l00030" /><CodeLine lineNumber="30"><span class="doxyHighlightComment">/// DeltaTreeNode and DeltaTreeInteriorNode.  The later subclasses the</span></CodeLine>
<Link id="l00031" /><CodeLine lineNumber="31"><span class="doxyHighlightComment">/// former and adds children pointers.  Each node knows the full delta of all</span></CodeLine>
<Link id="l00032" /><CodeLine lineNumber="32"><span class="doxyHighlightComment">/// entries (recursively) contained inside of it, which allows us to get the</span></CodeLine>
<Link id="l00033" /><CodeLine lineNumber="33"><span class="doxyHighlightComment">/// full delta implied by a whole subtree in constant time.</span></CodeLine>
<Link id="l00034" /><CodeLine lineNumber="34"></CodeLine>
<Link id="l00035" /><CodeLine lineNumber="35" lineLink="/docs/api/namespaces/anonymous-deltatree-cpp-"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00036" /><CodeLine lineNumber="36"></CodeLine>
<Link id="l00037" /><CodeLine lineNumber="37"><span class="doxyHighlightComment">/// SourceDelta - As code in the original input buffer is added and deleted,</span></CodeLine>
<Link id="l00038" /><CodeLine lineNumber="38"><span class="doxyHighlightComment">/// SourceDelta records are used to keep track of how the input SourceLocation</span></CodeLine>
<Link id="l00039" /><CodeLine lineNumber="39"><span class="doxyHighlightComment">/// object is mapped into the output buffer.</span></CodeLine>
<Link id="l00040" /><CodeLine lineNumber="40" lineLink="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> &#123;</span></CodeLine>
<Link id="l00041" /><CodeLine lineNumber="41" lineLink="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a645fac4dad15bc20be3537887a7fa953"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a645fac4dad15bc20be3537887a7fa953">FileLoc</a>;</span></CodeLine>
<Link id="l00042" /><CodeLine lineNumber="42" lineLink="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#ab1aa86bc36b4f16f872619d117cee52e"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#ab1aa86bc36b4f16f872619d117cee52e">Delta</a>;</span></CodeLine>
<Link id="l00043" /><CodeLine lineNumber="43"></CodeLine>
<Link id="l00044" /><CodeLine lineNumber="44" lineLink="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a10b1c635492d34dbd3411ac6eaef817f"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a10b1c635492d34dbd3411ac6eaef817f">get</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>, </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>) &#123;</span></CodeLine>
<Link id="l00045" /><CodeLine lineNumber="45"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#ab1aa86bc36b4f16f872619d117cee52e">Delta</a>;</span></CodeLine>
<Link id="l00046" /><CodeLine lineNumber="46"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#ab1aa86bc36b4f16f872619d117cee52e">Delta</a>.FileLoc = <a href="/docs/api/namespaces/llvm/loc">Loc</a>;</span></CodeLine>
<Link id="l00047" /><CodeLine lineNumber="47"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#ab1aa86bc36b4f16f872619d117cee52e">Delta</a>.Delta = <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>;</span></CodeLine>
<Link id="l00048" /><CodeLine lineNumber="48"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#ab1aa86bc36b4f16f872619d117cee52e">Delta</a>;</span></CodeLine>
<Link id="l00049" /><CodeLine lineNumber="49"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00050" /><CodeLine lineNumber="50"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00051" /><CodeLine lineNumber="51"></CodeLine>
<Link id="l00052" /><CodeLine lineNumber="52"><span class="doxyHighlightComment">/// DeltaTreeNode - The common part of all nodes.</span></CodeLine>
<Link id="l00053" /><CodeLine lineNumber="53"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00054" /><CodeLine lineNumber="54" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a> &#123;</span></CodeLine>
<Link id="l00055" /><CodeLine lineNumber="55"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00056" /><CodeLine lineNumber="56" lineLink="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult">InsertResult</a> &#123;</span></CodeLine>
<Link id="l00057" /><CodeLine lineNumber="57" lineLink="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#a64320c81b6091fcc9048f477497bc861"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a> &#42;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#a64320c81b6091fcc9048f477497bc861">LHS</a>, &#42;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#aa76a311e6fb01173127727b7e15eec49">RHS</a>;</span></CodeLine>
<Link id="l00058" /><CodeLine lineNumber="58" lineLink="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#ae7e2b997187957076bda6b4f2f355204"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#ae7e2b997187957076bda6b4f2f355204">Split</a>;</span></CodeLine>
<Link id="l00059" /><CodeLine lineNumber="59"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00060" /><CodeLine lineNumber="60"></CodeLine>
<Link id="l00061" /><CodeLine lineNumber="61"><span class="doxyHighlightKeyword">private</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00062" /><CodeLine lineNumber="62" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a214f196cfb002cb214c446017df4eaa6"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">friend</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a214f196cfb002cb214c446017df4eaa6">DeltaTreeInteriorNode</a>;</span></CodeLine>
<Link id="l00063" /><CodeLine lineNumber="63"></CodeLine>
<Link id="l00064" /><CodeLine lineNumber="64"><span class="doxyHighlightComment">  /// WidthFactor - This controls the number of K/V slots held in the BTree:</span></CodeLine>
<Link id="l00065" /><CodeLine lineNumber="65"><span class="doxyHighlightComment">  /// how wide it is.  Each level of the BTree is guaranteed to have at least</span></CodeLine>
<Link id="l00066" /><CodeLine lineNumber="66"><span class="doxyHighlightComment">  /// WidthFactor-1 K/V pairs (except the root) and may have at most</span></CodeLine>
<Link id="l00067" /><CodeLine lineNumber="67"><span class="doxyHighlightComment">  /// 2&#42;WidthFactor-1 K/V pairs.</span></CodeLine>
<Link id="l00068" /><CodeLine lineNumber="68"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">enum</span><span class="doxyHighlight"> &#123; WidthFactor = 8 &#125;;</span></CodeLine>
<Link id="l00069" /><CodeLine lineNumber="69"></CodeLine>
<Link id="l00070" /><CodeLine lineNumber="70"><span class="doxyHighlightComment">  /// Values - This tracks the SourceDelta&#39;s currently in this node.</span></CodeLine>
<Link id="l00071" /><CodeLine lineNumber="71"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> Values&#91;2 &#42; WidthFactor - 1&#93;;</span></CodeLine>
<Link id="l00072" /><CodeLine lineNumber="72"></CodeLine>
<Link id="l00073" /><CodeLine lineNumber="73"><span class="doxyHighlightComment">  /// NumValuesUsed - This tracks the number of values this node currently</span></CodeLine>
<Link id="l00074" /><CodeLine lineNumber="74"><span class="doxyHighlightComment">  /// holds.</span></CodeLine>
<Link id="l00075" /><CodeLine lineNumber="75"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> NumValuesUsed = 0;</span></CodeLine>
<Link id="l00076" /><CodeLine lineNumber="76"></CodeLine>
<Link id="l00077" /><CodeLine lineNumber="77"><span class="doxyHighlightComment">  /// IsLeaf - This is true if this is a leaf of the btree.  If false, this is</span></CodeLine>
<Link id="l00078" /><CodeLine lineNumber="78"><span class="doxyHighlightComment">  /// an interior node, and is actually an instance of DeltaTreeInteriorNode.</span></CodeLine>
<Link id="l00079" /><CodeLine lineNumber="79"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsLeaf;</span></CodeLine>
<Link id="l00080" /><CodeLine lineNumber="80"></CodeLine>
<Link id="l00081" /><CodeLine lineNumber="81"><span class="doxyHighlightComment">  /// FullDelta - This is the full delta of all the values in this node and</span></CodeLine>
<Link id="l00082" /><CodeLine lineNumber="82"><span class="doxyHighlightComment">  /// all children nodes.</span></CodeLine>
<Link id="l00083" /><CodeLine lineNumber="83"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> FullDelta = 0;</span></CodeLine>
<Link id="l00084" /><CodeLine lineNumber="84"></CodeLine>
<Link id="l00085" /><CodeLine lineNumber="85"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00086" /><CodeLine lineNumber="86" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a>(</span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a5c3a4d52017fd2315e4e155e22ca4151">isLeaf</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">) : IsLeaf(<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a5c3a4d52017fd2315e4e155e22ca4151">isLeaf</a>) &#123;&#125;</span></CodeLine>
<Link id="l00087" /><CodeLine lineNumber="87"></CodeLine>
<Link id="l00088" /><CodeLine lineNumber="88" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a5c3a4d52017fd2315e4e155e22ca4151"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a5c3a4d52017fd2315e4e155e22ca4151">isLeaf</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> IsLeaf; &#125;</span></CodeLine>
<Link id="l00089" /><CodeLine lineNumber="89" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a3418845f80bce5764a81fc769cb0f2da"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a3418845f80bce5764a81fc769cb0f2da">getFullDelta</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> FullDelta; &#125;</span></CodeLine>
<Link id="l00090" /><CodeLine lineNumber="90" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a4ec965054fc8939e804b7afb1eec2147"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a4ec965054fc8939e804b7afb1eec2147">isFull</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> NumValuesUsed == 2 &#42; WidthFactor - 1; &#125;</span></CodeLine>
<Link id="l00091" /><CodeLine lineNumber="91"></CodeLine>
<Link id="l00092" /><CodeLine lineNumber="92" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#af8651e474075cd4133edfffba3e08e6c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#af8651e474075cd4133edfffba3e08e6c">getNumValuesUsed</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> NumValuesUsed; &#125;</span></CodeLine>
<Link id="l00093" /><CodeLine lineNumber="93"></CodeLine>
<Link id="l00094" /><CodeLine lineNumber="94" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ac7e1b9e22a417698fa120f554ae9e48c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> &amp;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ac7e1b9e22a417698fa120f554ae9e48c">getValue</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00095" /><CodeLine lineNumber="95"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(i &lt; NumValuesUsed &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Invalid value #&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00096" /><CodeLine lineNumber="96"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Values&#91;i&#93;;</span></CodeLine>
<Link id="l00097" /><CodeLine lineNumber="97"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00098" /><CodeLine lineNumber="98"></CodeLine>
<Link id="l00099" /><CodeLine lineNumber="99" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a27a756995c91d8eb05fe8d1fc37cc72a"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> &amp;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a27a756995c91d8eb05fe8d1fc37cc72a">getValue</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i) &#123;</span></CodeLine>
<Link id="l00100" /><CodeLine lineNumber="100"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(i &lt; NumValuesUsed &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Invalid value #&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00101" /><CodeLine lineNumber="101"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Values&#91;i&#93;;</span></CodeLine>
<Link id="l00102" /><CodeLine lineNumber="102"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00103" /><CodeLine lineNumber="103"></CodeLine>
<Link id="l00104" /><CodeLine lineNumber="104"><span class="doxyHighlightComment">  /// DoInsertion - Do an insertion of the specified FileIndex/Delta pair into</span></CodeLine>
<Link id="l00105" /><CodeLine lineNumber="105"><span class="doxyHighlightComment">  /// this node.  If insertion is easy, do it and return false.  Otherwise,</span></CodeLine>
<Link id="l00106" /><CodeLine lineNumber="106"><span class="doxyHighlightComment">  /// split the node, populate InsertRes with info about the split, and return</span></CodeLine>
<Link id="l00107" /><CodeLine lineNumber="107"><span class="doxyHighlightComment">  /// true.</span></CodeLine>
<Link id="l00108" /><CodeLine lineNumber="108"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ad744e6529f224d58855be55473bb3d8e">DoInsertion</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> FileIndex, </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> Delta, InsertResult &#42;InsertRes);</span></CodeLine>
<Link id="l00109" /><CodeLine lineNumber="109"></CodeLine>
<Link id="l00110" /><CodeLine lineNumber="110"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a355b36c9c52d94268ba6f5564f084e2d">DoSplit</a>(InsertResult &amp;InsertRes);</span></CodeLine>
<Link id="l00111" /><CodeLine lineNumber="111"></CodeLine>
<Link id="l00112" /><CodeLine lineNumber="112"><span class="doxyHighlightComment">  /// RecomputeFullDeltaLocally - Recompute the FullDelta field by doing a</span></CodeLine>
<Link id="l00113" /><CodeLine lineNumber="113"><span class="doxyHighlightComment">  /// local walk over our contained deltas.</span></CodeLine>
<Link id="l00114" /><CodeLine lineNumber="114"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a0f769afe7a45a8ad6c1d8908b957e401">RecomputeFullDeltaLocally</a>();</span></CodeLine>
<Link id="l00115" /><CodeLine lineNumber="115"></CodeLine>
<Link id="l00116" /><CodeLine lineNumber="116"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a63db0172e9f7379f64ef90254ec30906">Destroy</a>();</span></CodeLine>
<Link id="l00117" /><CodeLine lineNumber="117"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00118" /><CodeLine lineNumber="118"></CodeLine>
<Link id="l00119" /><CodeLine lineNumber="119"><span class="doxyHighlightComment">/// DeltaTreeInteriorNode - When isLeaf = false, a node has child pointers.</span></CodeLine>
<Link id="l00120" /><CodeLine lineNumber="120"><span class="doxyHighlightComment">/// This class tracks them.</span></CodeLine>
<Link id="l00121" /><CodeLine lineNumber="121" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a62df3d1042541face25e40398844a0c7">DeltaTreeInteriorNode</a> : </span><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1">DeltaTreeNode</a> &#123;</span></CodeLine>
<Link id="l00122" /><CodeLine lineNumber="122" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">friend</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1">DeltaTreeNode</a>;</span></CodeLine>
<Link id="l00123" /><CodeLine lineNumber="123"></CodeLine>
<Link id="l00124" /><CodeLine lineNumber="124"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1">DeltaTreeNode</a> &#42;Children&#91;2 &#42; WidthFactor&#93;;</span></CodeLine>
<Link id="l00125" /><CodeLine lineNumber="125"></CodeLine>
<Link id="l00126" /><CodeLine lineNumber="126"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a62df3d1042541face25e40398844a0c7">~DeltaTreeInteriorNode</a>() &#123;</span></CodeLine>
<Link id="l00127" /><CodeLine lineNumber="127"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = NumValuesUsed + 1; i != e; ++i)</span></CodeLine>
<Link id="l00128" /><CodeLine lineNumber="128"><span class="doxyHighlight">      Children&#91;i&#93;-&gt;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a63db0172e9f7379f64ef90254ec30906">Destroy</a>();</span></CodeLine>
<Link id="l00129" /><CodeLine lineNumber="129"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00130" /><CodeLine lineNumber="130"></CodeLine>
<Link id="l00131" /><CodeLine lineNumber="131"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00132" /><CodeLine lineNumber="132" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a62df3d1042541face25e40398844a0c7"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a62df3d1042541face25e40398844a0c7">DeltaTreeInteriorNode</a>() : <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1">DeltaTreeNode</a>(<a href="/docs/api/namespaces/false">false</a> </span><span class="doxyHighlightComment">/&#42;nonleaf&#42;/</span><span class="doxyHighlight">) &#123;&#125;</span></CodeLine>
<Link id="l00133" /><CodeLine lineNumber="133"></CodeLine>
<Link id="l00134" /><CodeLine lineNumber="134" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#ae2b126b1962c92377b948a1edcbdc223"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#ae2b126b1962c92377b948a1edcbdc223">DeltaTreeInteriorNode</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult">InsertResult</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/legalizer-cpp/#a05ab4853f7153e537774d02580e761ec">IR</a>)</span></CodeLine>
<Link id="l00135" /><CodeLine lineNumber="135"><span class="doxyHighlight">      : <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1">DeltaTreeNode</a>(<a href="/docs/api/namespaces/false">false</a> </span><span class="doxyHighlightComment">/&#42;nonleaf&#42;/</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l00136" /><CodeLine lineNumber="136"><span class="doxyHighlight">    Children&#91;0&#93; = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/legalizer-cpp/#a05ab4853f7153e537774d02580e761ec">IR</a>.LHS;</span></CodeLine>
<Link id="l00137" /><CodeLine lineNumber="137"><span class="doxyHighlight">    Children&#91;1&#93; = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/legalizer-cpp/#a05ab4853f7153e537774d02580e761ec">IR</a>.RHS;</span></CodeLine>
<Link id="l00138" /><CodeLine lineNumber="138"><span class="doxyHighlight">    Values&#91;0&#93; = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/legalizer-cpp/#a05ab4853f7153e537774d02580e761ec">IR</a>.Split;</span></CodeLine>
<Link id="l00139" /><CodeLine lineNumber="139"><span class="doxyHighlight">    FullDelta =</span></CodeLine>
<Link id="l00140" /><CodeLine lineNumber="140"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/legalizer-cpp/#a05ab4853f7153e537774d02580e761ec">IR</a>.LHS-&gt;getFullDelta() + <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/legalizer-cpp/#a05ab4853f7153e537774d02580e761ec">IR</a>.RHS-&gt;getFullDelta() + <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/legalizer-cpp/#a05ab4853f7153e537774d02580e761ec">IR</a>.Split.Delta;</span></CodeLine>
<Link id="l00141" /><CodeLine lineNumber="141"><span class="doxyHighlight">    NumValuesUsed = 1;</span></CodeLine>
<Link id="l00142" /><CodeLine lineNumber="142"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00143" /><CodeLine lineNumber="143"></CodeLine>
<Link id="l00144" /><CodeLine lineNumber="144" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a5de7896e63d6f1613086627cba6e6632"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1">DeltaTreeNode</a> &#42;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a5de7896e63d6f1613086627cba6e6632">getChild</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00145" /><CodeLine lineNumber="145"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(i &lt; <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#af8651e474075cd4133edfffba3e08e6c">getNumValuesUsed</a>() + 1 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Invalid child&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00146" /><CodeLine lineNumber="146"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Children&#91;i&#93;;</span></CodeLine>
<Link id="l00147" /><CodeLine lineNumber="147"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00148" /><CodeLine lineNumber="148"></CodeLine>
<Link id="l00149" /><CodeLine lineNumber="149" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#ab48435416fb7f6cfdc4250e01b18431d"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1">DeltaTreeNode</a> &#42;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#ab48435416fb7f6cfdc4250e01b18431d">getChild</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i) &#123;</span></CodeLine>
<Link id="l00150" /><CodeLine lineNumber="150"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(i &lt; <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#af8651e474075cd4133edfffba3e08e6c">getNumValuesUsed</a>() + 1 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Invalid child&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00151" /><CodeLine lineNumber="151"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Children&#91;i&#93;;</span></CodeLine>
<Link id="l00152" /><CodeLine lineNumber="152"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00153" /><CodeLine lineNumber="153"></CodeLine>
<Link id="l00154" /><CodeLine lineNumber="154" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a749735f86ee752ef7a27de0196c434ae"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a749735f86ee752ef7a27de0196c434ae">classof</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a1bfaca6eddd5227b30b58ff7b83981d1">DeltaTreeNode</a> &#42;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;isLeaf(); &#125;</span></CodeLine>
<Link id="l00155" /><CodeLine lineNumber="155"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00156" /><CodeLine lineNumber="156"></CodeLine>
<Link id="l00157" /><CodeLine lineNumber="157"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// namespace</span></CodeLine>
<Link id="l00158" /><CodeLine lineNumber="158"></CodeLine>
<Link id="l00159" /><CodeLine lineNumber="159"><span class="doxyHighlightComment">/// Destroy - A &#39;virtual&#39; destructor.</span></CodeLine>
<Link id="l00160" /><CodeLine lineNumber="160" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a63db0172e9f7379f64ef90254ec30906"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a63db0172e9f7379f64ef90254ec30906">DeltaTreeNode::Destroy</a>() &#123;</span></CodeLine>
<Link id="l00161" /><CodeLine lineNumber="161"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a5c3a4d52017fd2315e4e155e22ca4151">isLeaf</a>())</span></CodeLine>
<Link id="l00162" /><CodeLine lineNumber="162"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">delete</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00163" /><CodeLine lineNumber="163"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00164" /><CodeLine lineNumber="164"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">delete</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DeltaTreeInteriorNode&gt;</a>(</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00165" /><CodeLine lineNumber="165"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00166" /><CodeLine lineNumber="166"></CodeLine>
<Link id="l00167" /><CodeLine lineNumber="167"><span class="doxyHighlightComment">/// RecomputeFullDeltaLocally - Recompute the FullDelta field by doing a</span></CodeLine>
<Link id="l00168" /><CodeLine lineNumber="168"><span class="doxyHighlightComment">/// local walk over our contained deltas.</span></CodeLine>
<Link id="l00169" /><CodeLine lineNumber="169" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a0f769afe7a45a8ad6c1d8908b957e401"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a0f769afe7a45a8ad6c1d8908b957e401">DeltaTreeNode::RecomputeFullDeltaLocally</a>() &#123;</span></CodeLine>
<Link id="l00170" /><CodeLine lineNumber="170"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> NewFullDelta = 0;</span></CodeLine>
<Link id="l00171" /><CodeLine lineNumber="171"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#af8651e474075cd4133edfffba3e08e6c">getNumValuesUsed</a>(); i != e; ++i)</span></CodeLine>
<Link id="l00172" /><CodeLine lineNumber="172"><span class="doxyHighlight">    NewFullDelta += Values&#91;i&#93;.Delta;</span></CodeLine>
<Link id="l00173" /><CodeLine lineNumber="173"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;IN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;DeltaTreeInteriorNode&gt;</a>(</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">))</span></CodeLine>
<Link id="l00174" /><CodeLine lineNumber="174"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#af8651e474075cd4133edfffba3e08e6c">getNumValuesUsed</a>() + 1; i != e; ++i)</span></CodeLine>
<Link id="l00175" /><CodeLine lineNumber="175"><span class="doxyHighlight">      NewFullDelta += IN-&gt;getChild(i)-&gt;getFullDelta();</span></CodeLine>
<Link id="l00176" /><CodeLine lineNumber="176"><span class="doxyHighlight">  FullDelta = NewFullDelta;</span></CodeLine>
<Link id="l00177" /><CodeLine lineNumber="177"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00178" /><CodeLine lineNumber="178"></CodeLine>
<Link id="l00179" /><CodeLine lineNumber="179"><span class="doxyHighlightComment">/// DoInsertion - Do an insertion of the specified FileIndex/Delta pair into</span></CodeLine>
<Link id="l00180" /><CodeLine lineNumber="180"><span class="doxyHighlightComment">/// this node.  If insertion is easy, do it and return false.  Otherwise,</span></CodeLine>
<Link id="l00181" /><CodeLine lineNumber="181"><span class="doxyHighlightComment">/// split the node, populate InsertRes with info about the split, and return</span></CodeLine>
<Link id="l00182" /><CodeLine lineNumber="182"><span class="doxyHighlightComment">/// true.</span></CodeLine>
<Link id="l00183" /><CodeLine lineNumber="183" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ad744e6529f224d58855be55473bb3d8e"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ad744e6529f224d58855be55473bb3d8e">DeltaTreeNode::DoInsertion</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> FileIndex, </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> Delta,</span></CodeLine>
<Link id="l00184" /><CodeLine lineNumber="184"><span class="doxyHighlight">                                <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult">InsertResult</a> &#42;InsertRes) &#123;</span></CodeLine>
<Link id="l00185" /><CodeLine lineNumber="185"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Maintain full delta for this node.</span></CodeLine>
<Link id="l00186" /><CodeLine lineNumber="186"><span class="doxyHighlight">  FullDelta += Delta;</span></CodeLine>
<Link id="l00187" /><CodeLine lineNumber="187"></CodeLine>
<Link id="l00188" /><CodeLine lineNumber="188"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Find the insertion point, the first delta whose index is &gt;= FileIndex.</span></CodeLine>
<Link id="l00189" /><CodeLine lineNumber="189"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#af8651e474075cd4133edfffba3e08e6c">getNumValuesUsed</a>();</span></CodeLine>
<Link id="l00190" /><CodeLine lineNumber="190"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (i != e &amp;&amp; FileIndex &gt; <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ac7e1b9e22a417698fa120f554ae9e48c">getValue</a>(i).FileLoc)</span></CodeLine>
<Link id="l00191" /><CodeLine lineNumber="191"><span class="doxyHighlight">    ++i;</span></CodeLine>
<Link id="l00192" /><CodeLine lineNumber="192"></CodeLine>
<Link id="l00193" /><CodeLine lineNumber="193"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we found an a record for exactly this file index, just merge this</span></CodeLine>
<Link id="l00194" /><CodeLine lineNumber="194"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value into the pre-existing record and finish early.</span></CodeLine>
<Link id="l00195" /><CodeLine lineNumber="195"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i != e &amp;&amp; <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ac7e1b9e22a417698fa120f554ae9e48c">getValue</a>(i).FileLoc == FileIndex) &#123;</span></CodeLine>
<Link id="l00196" /><CodeLine lineNumber="196"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// NOTE: Delta could drop to zero here.  This means that the delta entry is</span></CodeLine>
<Link id="l00197" /><CodeLine lineNumber="197"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// useless and could be removed.  Supporting erases is more complex than</span></CodeLine>
<Link id="l00198" /><CodeLine lineNumber="198"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// leaving an entry with Delta=0, so we just leave an entry with Delta=0 in</span></CodeLine>
<Link id="l00199" /><CodeLine lineNumber="199"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the tree.</span></CodeLine>
<Link id="l00200" /><CodeLine lineNumber="200"><span class="doxyHighlight">    Values&#91;i&#93;.Delta += Delta;</span></CodeLine>
<Link id="l00201" /><CodeLine lineNumber="201"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00202" /><CodeLine lineNumber="202"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00203" /><CodeLine lineNumber="203"></CodeLine>
<Link id="l00204" /><CodeLine lineNumber="204"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Otherwise, we found an insertion point, and we know that the value at the</span></CodeLine>
<Link id="l00205" /><CodeLine lineNumber="205"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// specified index is &gt; FileIndex.  Handle the leaf case first.</span></CodeLine>
<Link id="l00206" /><CodeLine lineNumber="206"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a5c3a4d52017fd2315e4e155e22ca4151">isLeaf</a>()) &#123;</span></CodeLine>
<Link id="l00207" /><CodeLine lineNumber="207"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a4ec965054fc8939e804b7afb1eec2147">isFull</a>()) &#123;</span></CodeLine>
<Link id="l00208" /><CodeLine lineNumber="208"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// For an insertion into a non-full leaf node, just insert the value in</span></CodeLine>
<Link id="l00209" /><CodeLine lineNumber="209"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// its sorted position.  This requires moving later values over.</span></CodeLine>
<Link id="l00210" /><CodeLine lineNumber="210"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i != e)</span></CodeLine>
<Link id="l00211" /><CodeLine lineNumber="211"><span class="doxyHighlight">        memmove(&amp;Values&#91;i + 1&#93;, &amp;Values&#91;i&#93;, </span><span class="doxyHighlightKeyword">sizeof</span><span class="doxyHighlight">(Values&#91;0&#93;) &#42; (e - i));</span></CodeLine>
<Link id="l00212" /><CodeLine lineNumber="212"><span class="doxyHighlight">      Values&#91;i&#93; = <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a10b1c635492d34dbd3411ac6eaef817f">SourceDelta::get</a>(FileIndex, Delta);</span></CodeLine>
<Link id="l00213" /><CodeLine lineNumber="213"><span class="doxyHighlight">      ++NumValuesUsed;</span></CodeLine>
<Link id="l00214" /><CodeLine lineNumber="214"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00215" /><CodeLine lineNumber="215"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00216" /><CodeLine lineNumber="216"></CodeLine>
<Link id="l00217" /><CodeLine lineNumber="217"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Otherwise, if this is leaf is full, split the node at its median, insert</span></CodeLine>
<Link id="l00218" /><CodeLine lineNumber="218"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the value into one of the children, and return the result.</span></CodeLine>
<Link id="l00219" /><CodeLine lineNumber="219"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InsertRes &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;No result location specified&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00220" /><CodeLine lineNumber="220"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a355b36c9c52d94268ba6f5564f084e2d">DoSplit</a>(&#42;InsertRes);</span></CodeLine>
<Link id="l00221" /><CodeLine lineNumber="221"></CodeLine>
<Link id="l00222" /><CodeLine lineNumber="222"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#ae7e2b997187957076bda6b4f2f355204">Split</a>.<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a645fac4dad15bc20be3537887a7fa953">FileLoc</a> &gt; FileIndex)</span></CodeLine>
<Link id="l00223" /><CodeLine lineNumber="223"><span class="doxyHighlight">      InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#a64320c81b6091fcc9048f477497bc861">LHS</a>-&gt;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ad744e6529f224d58855be55473bb3d8e">DoInsertion</a>(FileIndex, Delta, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> </span><span class="doxyHighlightComment">/&#42;can&#39;t fail&#42;/</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00224" /><CodeLine lineNumber="224"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00225" /><CodeLine lineNumber="225"><span class="doxyHighlight">      InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#aa76a311e6fb01173127727b7e15eec49">RHS</a>-&gt;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ad744e6529f224d58855be55473bb3d8e">DoInsertion</a>(FileIndex, Delta, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> </span><span class="doxyHighlightComment">/&#42;can&#39;t fail&#42;/</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00226" /><CodeLine lineNumber="226"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00227" /><CodeLine lineNumber="227"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00228" /><CodeLine lineNumber="228"></CodeLine>
<Link id="l00229" /><CodeLine lineNumber="229"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Otherwise, this is an interior node.  Send the request down the tree.</span></CodeLine>
<Link id="l00230" /><CodeLine lineNumber="230"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;IN = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DeltaTreeInteriorNode&gt;</a>(</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00231" /><CodeLine lineNumber="231"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IN-&gt;Children&#91;i&#93;-&gt;DoInsertion(FileIndex, Delta, InsertRes))</span></CodeLine>
<Link id="l00232" /><CodeLine lineNumber="232"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">; </span><span class="doxyHighlightComment">// If there was space in the child, just return.</span></CodeLine>
<Link id="l00233" /><CodeLine lineNumber="233"></CodeLine>
<Link id="l00234" /><CodeLine lineNumber="234"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Okay, this split the subtree, producing a new value and two children to</span></CodeLine>
<Link id="l00235" /><CodeLine lineNumber="235"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// insert here.  If this node is non-full, we can just insert it directly.</span></CodeLine>
<Link id="l00236" /><CodeLine lineNumber="236"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a4ec965054fc8939e804b7afb1eec2147">isFull</a>()) &#123;</span></CodeLine>
<Link id="l00237" /><CodeLine lineNumber="237"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Now that we have two nodes and a new element, insert the perclated value</span></CodeLine>
<Link id="l00238" /><CodeLine lineNumber="238"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// into ourself by moving all the later values/children down, then inserting</span></CodeLine>
<Link id="l00239" /><CodeLine lineNumber="239"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the new one.</span></CodeLine>
<Link id="l00240" /><CodeLine lineNumber="240"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i != e)</span></CodeLine>
<Link id="l00241" /><CodeLine lineNumber="241"><span class="doxyHighlight">      memmove(&amp;IN-&gt;Children&#91;i + 2&#93;, &amp;IN-&gt;Children&#91;i + 1&#93;,</span></CodeLine>
<Link id="l00242" /><CodeLine lineNumber="242"><span class="doxyHighlight">              (e - i) &#42; </span><span class="doxyHighlightKeyword">sizeof</span><span class="doxyHighlight">(IN-&gt;Children&#91;0&#93;));</span></CodeLine>
<Link id="l00243" /><CodeLine lineNumber="243"><span class="doxyHighlight">    IN-&gt;Children&#91;i&#93; = InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#a64320c81b6091fcc9048f477497bc861">LHS</a>;</span></CodeLine>
<Link id="l00244" /><CodeLine lineNumber="244"><span class="doxyHighlight">    IN-&gt;Children&#91;i + 1&#93; = InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#aa76a311e6fb01173127727b7e15eec49">RHS</a>;</span></CodeLine>
<Link id="l00245" /><CodeLine lineNumber="245"></CodeLine>
<Link id="l00246" /><CodeLine lineNumber="246"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (e != i)</span></CodeLine>
<Link id="l00247" /><CodeLine lineNumber="247"><span class="doxyHighlight">      memmove(&amp;Values&#91;i + 1&#93;, &amp;Values&#91;i&#93;, (e - i) &#42; </span><span class="doxyHighlightKeyword">sizeof</span><span class="doxyHighlight">(Values&#91;0&#93;));</span></CodeLine>
<Link id="l00248" /><CodeLine lineNumber="248"><span class="doxyHighlight">    Values&#91;i&#93; = InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#ae7e2b997187957076bda6b4f2f355204">Split</a>;</span></CodeLine>
<Link id="l00249" /><CodeLine lineNumber="249"><span class="doxyHighlight">    ++NumValuesUsed;</span></CodeLine>
<Link id="l00250" /><CodeLine lineNumber="250"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00251" /><CodeLine lineNumber="251"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00252" /><CodeLine lineNumber="252"></CodeLine>
<Link id="l00253" /><CodeLine lineNumber="253"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Finally, if this interior node was full and a node is percolated up, split</span></CodeLine>
<Link id="l00254" /><CodeLine lineNumber="254"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ourself and return that up the chain.  Start by saving all our info to</span></CodeLine>
<Link id="l00255" /><CodeLine lineNumber="255"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// avoid having the split clobber it.</span></CodeLine>
<Link id="l00256" /><CodeLine lineNumber="256"><span class="doxyHighlight">  IN-&gt;Children&#91;i&#93; = InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#a64320c81b6091fcc9048f477497bc861">LHS</a>;</span></CodeLine>
<Link id="l00257" /><CodeLine lineNumber="257"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a> &#42;SubRHS = InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#aa76a311e6fb01173127727b7e15eec49">RHS</a>;</span></CodeLine>
<Link id="l00258" /><CodeLine lineNumber="258"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta">SourceDelta</a> SubSplit = InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#ae7e2b997187957076bda6b4f2f355204">Split</a>;</span></CodeLine>
<Link id="l00259" /><CodeLine lineNumber="259"></CodeLine>
<Link id="l00260" /><CodeLine lineNumber="260"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Do the split.</span></CodeLine>
<Link id="l00261" /><CodeLine lineNumber="261"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a355b36c9c52d94268ba6f5564f084e2d">DoSplit</a>(&#42;InsertRes);</span></CodeLine>
<Link id="l00262" /><CodeLine lineNumber="262"></CodeLine>
<Link id="l00263" /><CodeLine lineNumber="263"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Figure out where to insert SubRHS/NewSplit.</span></CodeLine>
<Link id="l00264" /><CodeLine lineNumber="264"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a214f196cfb002cb214c446017df4eaa6">DeltaTreeInteriorNode</a> &#42;InsertSide;</span></CodeLine>
<Link id="l00265" /><CodeLine lineNumber="265"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubSplit.<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a645fac4dad15bc20be3537887a7fa953">FileLoc</a> &lt; InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#ae7e2b997187957076bda6b4f2f355204">Split</a>.<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a645fac4dad15bc20be3537887a7fa953">FileLoc</a>)</span></CodeLine>
<Link id="l00266" /><CodeLine lineNumber="266"><span class="doxyHighlight">    InsertSide = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DeltaTreeInteriorNode&gt;</a>(InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#a64320c81b6091fcc9048f477497bc861">LHS</a>);</span></CodeLine>
<Link id="l00267" /><CodeLine lineNumber="267"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00268" /><CodeLine lineNumber="268"><span class="doxyHighlight">    InsertSide = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DeltaTreeInteriorNode&gt;</a>(InsertRes-&gt;<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#aa76a311e6fb01173127727b7e15eec49">RHS</a>);</span></CodeLine>
<Link id="l00269" /><CodeLine lineNumber="269"></CodeLine>
<Link id="l00270" /><CodeLine lineNumber="270"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We now have a non-empty interior node &#39;InsertSide&#39; to insert</span></CodeLine>
<Link id="l00271" /><CodeLine lineNumber="271"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// SubRHS/SubSplit into.  Find out where to insert SubSplit.</span></CodeLine>
<Link id="l00272" /><CodeLine lineNumber="272"></CodeLine>
<Link id="l00273" /><CodeLine lineNumber="273"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Find the insertion point, the first delta whose index is &gt;SubSplit.FileLoc.</span></CodeLine>
<Link id="l00274" /><CodeLine lineNumber="274"><span class="doxyHighlight">  i = 0;</span></CodeLine>
<Link id="l00275" /><CodeLine lineNumber="275"><span class="doxyHighlight">  e = InsertSide-&gt;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#af8651e474075cd4133edfffba3e08e6c">getNumValuesUsed</a>();</span></CodeLine>
<Link id="l00276" /><CodeLine lineNumber="276"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (i != e &amp;&amp; SubSplit.<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a645fac4dad15bc20be3537887a7fa953">FileLoc</a> &gt; InsertSide-&gt;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#ac7e1b9e22a417698fa120f554ae9e48c">getValue</a>(i).<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#a645fac4dad15bc20be3537887a7fa953">FileLoc</a>)</span></CodeLine>
<Link id="l00277" /><CodeLine lineNumber="277"><span class="doxyHighlight">    ++i;</span></CodeLine>
<Link id="l00278" /><CodeLine lineNumber="278"></CodeLine>
<Link id="l00279" /><CodeLine lineNumber="279"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now we know that i is the place to insert the split value into.  Insert it</span></CodeLine>
<Link id="l00280" /><CodeLine lineNumber="280"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// and the child right after it.</span></CodeLine>
<Link id="l00281" /><CodeLine lineNumber="281"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i != e)</span></CodeLine>
<Link id="l00282" /><CodeLine lineNumber="282"><span class="doxyHighlight">    memmove(&amp;InsertSide-&gt;Children&#91;i + 2&#93;, &amp;InsertSide-&gt;Children&#91;i + 1&#93;,</span></CodeLine>
<Link id="l00283" /><CodeLine lineNumber="283"><span class="doxyHighlight">            (e - i) &#42; </span><span class="doxyHighlightKeyword">sizeof</span><span class="doxyHighlight">(IN-&gt;Children&#91;0&#93;));</span></CodeLine>
<Link id="l00284" /><CodeLine lineNumber="284"><span class="doxyHighlight">  InsertSide-&gt;Children&#91;i + 1&#93; = SubRHS;</span></CodeLine>
<Link id="l00285" /><CodeLine lineNumber="285"></CodeLine>
<Link id="l00286" /><CodeLine lineNumber="286"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (e != i)</span></CodeLine>
<Link id="l00287" /><CodeLine lineNumber="287"><span class="doxyHighlight">    memmove(&amp;InsertSide-&gt;Values&#91;i + 1&#93;, &amp;InsertSide-&gt;Values&#91;i&#93;,</span></CodeLine>
<Link id="l00288" /><CodeLine lineNumber="288"><span class="doxyHighlight">            (e - i) &#42; </span><span class="doxyHighlightKeyword">sizeof</span><span class="doxyHighlight">(Values&#91;0&#93;));</span></CodeLine>
<Link id="l00289" /><CodeLine lineNumber="289"><span class="doxyHighlight">  InsertSide-&gt;Values&#91;i&#93; = SubSplit;</span></CodeLine>
<Link id="l00290" /><CodeLine lineNumber="290"><span class="doxyHighlight">  ++InsertSide-&gt;NumValuesUsed;</span></CodeLine>
<Link id="l00291" /><CodeLine lineNumber="291"><span class="doxyHighlight">  InsertSide-&gt;FullDelta += SubSplit.<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/sourcedelta/#ab1aa86bc36b4f16f872619d117cee52e">Delta</a> + SubRHS-&gt;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a3418845f80bce5764a81fc769cb0f2da">getFullDelta</a>();</span></CodeLine>
<Link id="l00292" /><CodeLine lineNumber="292"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00293" /><CodeLine lineNumber="293"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00294" /><CodeLine lineNumber="294"></CodeLine>
<Link id="l00295" /><CodeLine lineNumber="295"><span class="doxyHighlightComment">/// DoSplit - Split the currently full node (which has 2&#42;WidthFactor-1 values)</span></CodeLine>
<Link id="l00296" /><CodeLine lineNumber="296"><span class="doxyHighlightComment">/// into two subtrees each with &quot;WidthFactor-1&quot; values and a pivot value.</span></CodeLine>
<Link id="l00297" /><CodeLine lineNumber="297"><span class="doxyHighlightComment">/// Return the pieces in InsertRes.</span></CodeLine>
<Link id="l00298" /><CodeLine lineNumber="298" lineLink="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a355b36c9c52d94268ba6f5564f084e2d"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a355b36c9c52d94268ba6f5564f084e2d">DeltaTreeNode::DoSplit</a>(<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult">InsertResult</a> &amp;InsertRes) &#123;</span></CodeLine>
<Link id="l00299" /><CodeLine lineNumber="299"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a4ec965054fc8939e804b7afb1eec2147">isFull</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Why split a non-full node?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00300" /><CodeLine lineNumber="300"></CodeLine>
<Link id="l00301" /><CodeLine lineNumber="301"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Since this node is full, it contains 2&#42;WidthFactor-1 values.  We move</span></CodeLine>
<Link id="l00302" /><CodeLine lineNumber="302"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the first &#39;WidthFactor-1&#39; values to the LHS child (which we leave in this</span></CodeLine>
<Link id="l00303" /><CodeLine lineNumber="303"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// node), propagate one value up, and move the last &#39;WidthFactor-1&#39; values</span></CodeLine>
<Link id="l00304" /><CodeLine lineNumber="304"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// into the RHS child.</span></CodeLine>
<Link id="l00305" /><CodeLine lineNumber="305"></CodeLine>
<Link id="l00306" /><CodeLine lineNumber="306"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Create the new child node.</span></CodeLine>
<Link id="l00307" /><CodeLine lineNumber="307"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a> &#42;NewNode;</span></CodeLine>
<Link id="l00308" /><CodeLine lineNumber="308"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;IN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;DeltaTreeInteriorNode&gt;</a>(</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">)) &#123;</span></CodeLine>
<Link id="l00309" /><CodeLine lineNumber="309"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this is an interior node, also move over &#39;WidthFactor&#39; children</span></CodeLine>
<Link id="l00310" /><CodeLine lineNumber="310"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// into the new node.</span></CodeLine>
<Link id="l00311" /><CodeLine lineNumber="311"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a214f196cfb002cb214c446017df4eaa6">DeltaTreeInteriorNode</a> &#42;New = </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreeinteriornode/#a62df3d1042541face25e40398844a0c7">DeltaTreeInteriorNode</a>();</span></CodeLine>
<Link id="l00312" /><CodeLine lineNumber="312"><span class="doxyHighlight">    memcpy(&amp;New-&gt;Children&#91;0&#93;, &amp;IN-&gt;Children&#91;WidthFactor&#93;,</span></CodeLine>
<Link id="l00313" /><CodeLine lineNumber="313"><span class="doxyHighlight">           WidthFactor &#42; </span><span class="doxyHighlightKeyword">sizeof</span><span class="doxyHighlight">(IN-&gt;Children&#91;0&#93;));</span></CodeLine>
<Link id="l00314" /><CodeLine lineNumber="314"><span class="doxyHighlight">    NewNode = New;</span></CodeLine>
<Link id="l00315" /><CodeLine lineNumber="315"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00316" /><CodeLine lineNumber="316"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Just create the new leaf node.</span></CodeLine>
<Link id="l00317" /><CodeLine lineNumber="317"><span class="doxyHighlight">    NewNode = </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a>();</span></CodeLine>
<Link id="l00318" /><CodeLine lineNumber="318"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00319" /><CodeLine lineNumber="319"></CodeLine>
<Link id="l00320" /><CodeLine lineNumber="320"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Move over the last &#39;WidthFactor-1&#39; values from here to NewNode.</span></CodeLine>
<Link id="l00321" /><CodeLine lineNumber="321"><span class="doxyHighlight">  memcpy(&amp;NewNode-&gt;Values&#91;0&#93;, &amp;Values&#91;WidthFactor&#93;,</span></CodeLine>
<Link id="l00322" /><CodeLine lineNumber="322"><span class="doxyHighlight">         (WidthFactor - 1) &#42; </span><span class="doxyHighlightKeyword">sizeof</span><span class="doxyHighlight">(Values&#91;0&#93;));</span></CodeLine>
<Link id="l00323" /><CodeLine lineNumber="323"></CodeLine>
<Link id="l00324" /><CodeLine lineNumber="324"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Decrease the number of values in the two nodes.</span></CodeLine>
<Link id="l00325" /><CodeLine lineNumber="325"><span class="doxyHighlight">  NewNode-&gt;NumValuesUsed = NumValuesUsed = WidthFactor - 1;</span></CodeLine>
<Link id="l00326" /><CodeLine lineNumber="326"></CodeLine>
<Link id="l00327" /><CodeLine lineNumber="327"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Recompute the two nodes&#39; full delta.</span></CodeLine>
<Link id="l00328" /><CodeLine lineNumber="328"><span class="doxyHighlight">  NewNode-&gt;<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a0f769afe7a45a8ad6c1d8908b957e401">RecomputeFullDeltaLocally</a>();</span></CodeLine>
<Link id="l00329" /><CodeLine lineNumber="329"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a0f769afe7a45a8ad6c1d8908b957e401">RecomputeFullDeltaLocally</a>();</span></CodeLine>
<Link id="l00330" /><CodeLine lineNumber="330"></CodeLine>
<Link id="l00331" /><CodeLine lineNumber="331"><span class="doxyHighlight">  InsertRes.<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#a64320c81b6091fcc9048f477497bc861">LHS</a> = </span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00332" /><CodeLine lineNumber="332"><span class="doxyHighlight">  InsertRes.<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#aa76a311e6fb01173127727b7e15eec49">RHS</a> = NewNode;</span></CodeLine>
<Link id="l00333" /><CodeLine lineNumber="333"><span class="doxyHighlight">  InsertRes.<a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult/#ae7e2b997187957076bda6b4f2f355204">Split</a> = Values&#91;WidthFactor - 1&#93;;</span></CodeLine>
<Link id="l00334" /><CodeLine lineNumber="334"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00335" /><CodeLine lineNumber="335"></CodeLine>
<Link id="l00336" /><CodeLine lineNumber="336"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00337" /><CodeLine lineNumber="337"><span class="doxyHighlightComment">//                        DeltaTree Implementation</span></CodeLine>
<Link id="l00338" /><CodeLine lineNumber="338"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00339" /><CodeLine lineNumber="339"></CodeLine>
<Link id="l00340" /><CodeLine lineNumber="340"><span class="doxyHighlightComment">// #define VERIFY&#95;TREE</span></CodeLine>
<Link id="l00341" /><CodeLine lineNumber="341"></CodeLine>
<Link id="l00342" /><CodeLine lineNumber="342"><span class="doxyHighlightPreprocessor">#ifdef VERIFY&#95;TREE</span></CodeLine>
<Link id="l00343" /><CodeLine lineNumber="343"><span class="doxyHighlightComment">/// VerifyTree - Walk the btree performing assertions on various properties to</span></CodeLine>
<Link id="l00344" /><CodeLine lineNumber="344"><span class="doxyHighlightComment">/// verify consistency.  This is useful for debugging new changes to the tree.</span></CodeLine>
<Link id="l00345" /><CodeLine lineNumber="345"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> VerifyTree(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode">DeltaTreeNode</a> &#42;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>) &#123;</span></CodeLine>
<Link id="l00346" /><CodeLine lineNumber="346"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;IN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;DeltaTreeInteriorNode&gt;</a>(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>);</span></CodeLine>
<Link id="l00347" /><CodeLine lineNumber="347"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IN == 0) &#123;</span></CodeLine>
<Link id="l00348" /><CodeLine lineNumber="348"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Verify leaves, just ensure that FullDelta matches up and the elements</span></CodeLine>
<Link id="l00349" /><CodeLine lineNumber="349"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// are in proper order.</span></CodeLine>
<Link id="l00350" /><CodeLine lineNumber="350"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> FullDelta = 0;</span></CodeLine>
<Link id="l00351" /><CodeLine lineNumber="351"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getNumValuesUsed(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l00352" /><CodeLine lineNumber="352"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i)</span></CodeLine>
<Link id="l00353" /><CodeLine lineNumber="353"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getValue(i - 1).FileLoc &lt; <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getValue(i).FileLoc);</span></CodeLine>
<Link id="l00354" /><CodeLine lineNumber="354"><span class="doxyHighlight">      FullDelta += <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getValue(i).Delta;</span></CodeLine>
<Link id="l00355" /><CodeLine lineNumber="355"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00356" /><CodeLine lineNumber="356"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FullDelta == <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getFullDelta());</span></CodeLine>
<Link id="l00357" /><CodeLine lineNumber="357"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00358" /><CodeLine lineNumber="358"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00359" /><CodeLine lineNumber="359"></CodeLine>
<Link id="l00360" /><CodeLine lineNumber="360"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Verify interior nodes: Ensure that FullDelta matches up and the</span></CodeLine>
<Link id="l00361" /><CodeLine lineNumber="361"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// elements are in proper order and the children are in proper order.</span></CodeLine>
<Link id="l00362" /><CodeLine lineNumber="362"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> FullDelta = 0;</span></CodeLine>
<Link id="l00363" /><CodeLine lineNumber="363"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = IN-&gt;getNumValuesUsed(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l00364" /><CodeLine lineNumber="364"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> SourceDelta &amp;IVal = <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getValue(i);</span></CodeLine>
<Link id="l00365" /><CodeLine lineNumber="365"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a> &#42;IChild = IN-&gt;getChild(i);</span></CodeLine>
<Link id="l00366" /><CodeLine lineNumber="366"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i)</span></CodeLine>
<Link id="l00367" /><CodeLine lineNumber="367"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IN-&gt;getValue(i - 1).FileLoc &lt; IVal.FileLoc);</span></CodeLine>
<Link id="l00368" /><CodeLine lineNumber="368"><span class="doxyHighlight">    FullDelta += IVal.Delta;</span></CodeLine>
<Link id="l00369" /><CodeLine lineNumber="369"><span class="doxyHighlight">    FullDelta += IChild-&gt;getFullDelta();</span></CodeLine>
<Link id="l00370" /><CodeLine lineNumber="370"></CodeLine>
<Link id="l00371" /><CodeLine lineNumber="371"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The largest value in child #i should be smaller than FileLoc.</span></CodeLine>
<Link id="l00372" /><CodeLine lineNumber="372"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IChild-&gt;getValue(IChild-&gt;getNumValuesUsed() - 1).FileLoc &lt;</span></CodeLine>
<Link id="l00373" /><CodeLine lineNumber="373"><span class="doxyHighlight">           IVal.FileLoc);</span></CodeLine>
<Link id="l00374" /><CodeLine lineNumber="374"></CodeLine>
<Link id="l00375" /><CodeLine lineNumber="375"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The smallest value in child #i+1 should be larger than FileLoc.</span></CodeLine>
<Link id="l00376" /><CodeLine lineNumber="376"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IN-&gt;getChild(i + 1)-&gt;getValue(0).FileLoc &gt; IVal.FileLoc);</span></CodeLine>
<Link id="l00377" /><CodeLine lineNumber="377"><span class="doxyHighlight">    VerifyTree(IChild);</span></CodeLine>
<Link id="l00378" /><CodeLine lineNumber="378"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00379" /><CodeLine lineNumber="379"></CodeLine>
<Link id="l00380" /><CodeLine lineNumber="380"><span class="doxyHighlight">  FullDelta += IN-&gt;getChild(IN-&gt;getNumValuesUsed())-&gt;getFullDelta();</span></CodeLine>
<Link id="l00381" /><CodeLine lineNumber="381"></CodeLine>
<Link id="l00382" /><CodeLine lineNumber="382"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FullDelta == <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;getFullDelta());</span></CodeLine>
<Link id="l00383" /><CodeLine lineNumber="383"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00384" /><CodeLine lineNumber="384"><span class="doxyHighlightPreprocessor">#endif </span><span class="doxyHighlightComment">// VERIFY&#95;TREE</span></CodeLine>
<Link id="l00385" /><CodeLine lineNumber="385"></CodeLine>
<Link id="l00386" /><CodeLine lineNumber="386" lineLink="#ab590661425ca60ca82edfdb4cf22233d"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a> &#42;<a href="#ab590661425ca60ca82edfdb4cf22233d">getRoot</a>(</span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> &#42;Root) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-deltatree-cpp-/deltatreenode/#a9e297565b80638f97e409c2f6d579332">DeltaTreeNode</a> &#42;)Root; &#125;</span></CodeLine>
<Link id="l00387" /><CodeLine lineNumber="387"></CodeLine>
<Link id="l00388" /><CodeLine lineNumber="388" lineLink="/docs/api/classes/llvm/deltatree/#a93581c8e7d30de46117cc3e07a0af01d"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/deltatree/#a93581c8e7d30de46117cc3e07a0af01d">DeltaTree::DeltaTree</a>() &#123; Root = </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> DeltaTreeNode(); &#125;</span></CodeLine>
<Link id="l00389" /><CodeLine lineNumber="389"></CodeLine>
<Link id="l00390" /><CodeLine lineNumber="390" lineLink="/docs/api/classes/llvm/deltatree/#a71158ee3b58ca404fbbe5c7e96d30c4b"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/deltatree/#a93581c8e7d30de46117cc3e07a0af01d">DeltaTree::DeltaTree</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/deltatree/#a93581c8e7d30de46117cc3e07a0af01d">DeltaTree</a> &amp;RHS) &#123;</span></CodeLine>
<Link id="l00391" /><CodeLine lineNumber="391"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Currently we only support copying when the RHS is empty.</span></CodeLine>
<Link id="l00392" /><CodeLine lineNumber="392"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#ab590661425ca60ca82edfdb4cf22233d">getRoot</a>(RHS.Root)-&gt;getNumValuesUsed() == 0 &amp;&amp;</span></CodeLine>
<Link id="l00393" /><CodeLine lineNumber="393"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Can only copy empty tree&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00394" /><CodeLine lineNumber="394"><span class="doxyHighlight">  Root = </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> DeltaTreeNode();</span></CodeLine>
<Link id="l00395" /><CodeLine lineNumber="395"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00396" /><CodeLine lineNumber="396"></CodeLine>
<Link id="l00397" /><CodeLine lineNumber="397" lineLink="/docs/api/classes/llvm/deltatree/#abf2c383983f61525048221dc5218c8a0"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/deltatree/#abf2c383983f61525048221dc5218c8a0">DeltaTree::~DeltaTree</a>() &#123; <a href="#ab590661425ca60ca82edfdb4cf22233d">getRoot</a>(Root)-&gt;Destroy(); &#125;</span></CodeLine>
<Link id="l00398" /><CodeLine lineNumber="398"></CodeLine>
<Link id="l00399" /><CodeLine lineNumber="399"><span class="doxyHighlightComment">/// getDeltaAt - Return the accumulated delta at the specified file offset.</span></CodeLine>
<Link id="l00400" /><CodeLine lineNumber="400"><span class="doxyHighlightComment">/// This includes all insertions or delections that occurred &#42;before&#42; the</span></CodeLine>
<Link id="l00401" /><CodeLine lineNumber="401"><span class="doxyHighlightComment">/// specified file index.</span></CodeLine>
<Link id="l00402" /><CodeLine lineNumber="402" lineLink="/docs/api/classes/llvm/deltatree/#a9d2add1ca152069aa7cd796d3e7c552e"><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/deltatree/#a9d2add1ca152069aa7cd796d3e7c552e">DeltaTree::getDeltaAt</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> FileIndex)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00403" /><CodeLine lineNumber="403"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DeltaTreeNode &#42;<a href="/docs/api/classes/node">Node</a> = <a href="#ab590661425ca60ca82edfdb4cf22233d">getRoot</a>(Root);</span></CodeLine>
<Link id="l00404" /><CodeLine lineNumber="404"></CodeLine>
<Link id="l00405" /><CodeLine lineNumber="405"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> Result = 0;</span></CodeLine>
<Link id="l00406" /><CodeLine lineNumber="406"></CodeLine>
<Link id="l00407" /><CodeLine lineNumber="407"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Walk down the tree.</span></CodeLine>
<Link id="l00408" /><CodeLine lineNumber="408"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l00409" /><CodeLine lineNumber="409"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// For all nodes, include any local deltas before the specified file</span></CodeLine>
<Link id="l00410" /><CodeLine lineNumber="410"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// index by summing them up directly.  Keep track of how many were</span></CodeLine>
<Link id="l00411" /><CodeLine lineNumber="411"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// included.</span></CodeLine>
<Link id="l00412" /><CodeLine lineNumber="412"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumValsGreater = 0;</span></CodeLine>
<Link id="l00413" /><CodeLine lineNumber="413"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> e = <a href="/docs/api/classes/node">Node</a>-&gt;getNumValuesUsed(); NumValsGreater != e;</span></CodeLine>
<Link id="l00414" /><CodeLine lineNumber="414"><span class="doxyHighlight">         ++NumValsGreater) &#123;</span></CodeLine>
<Link id="l00415" /><CodeLine lineNumber="415"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> SourceDelta &amp;Val = <a href="/docs/api/classes/node">Node</a>-&gt;getValue(NumValsGreater);</span></CodeLine>
<Link id="l00416" /><CodeLine lineNumber="416"></CodeLine>
<Link id="l00417" /><CodeLine lineNumber="417"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Val.FileLoc &gt;= FileIndex)</span></CodeLine>
<Link id="l00418" /><CodeLine lineNumber="418"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00419" /><CodeLine lineNumber="419"><span class="doxyHighlight">      Result += Val.Delta;</span></CodeLine>
<Link id="l00420" /><CodeLine lineNumber="420"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00421" /><CodeLine lineNumber="421"></CodeLine>
<Link id="l00422" /><CodeLine lineNumber="422"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we have an interior node, include information about children and</span></CodeLine>
<Link id="l00423" /><CodeLine lineNumber="423"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// recurse.  Otherwise, if we have a leaf, we&#39;re done.</span></CodeLine>
<Link id="l00424" /><CodeLine lineNumber="424"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;IN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;DeltaTreeInteriorNode&gt;</a>(<a href="/docs/api/classes/node">Node</a>);</span></CodeLine>
<Link id="l00425" /><CodeLine lineNumber="425"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IN)</span></CodeLine>
<Link id="l00426" /><CodeLine lineNumber="426"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Result;</span></CodeLine>
<Link id="l00427" /><CodeLine lineNumber="427"></CodeLine>
<Link id="l00428" /><CodeLine lineNumber="428"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Include any children to the left of the values we skipped, all of</span></CodeLine>
<Link id="l00429" /><CodeLine lineNumber="429"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// their deltas should be included as well.</span></CodeLine>
<Link id="l00430" /><CodeLine lineNumber="430"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0; i != NumValsGreater; ++i)</span></CodeLine>
<Link id="l00431" /><CodeLine lineNumber="431"><span class="doxyHighlight">      Result += IN-&gt;getChild(i)-&gt;getFullDelta();</span></CodeLine>
<Link id="l00432" /><CodeLine lineNumber="432"></CodeLine>
<Link id="l00433" /><CodeLine lineNumber="433"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we found exactly the value we were looking for, break off the</span></CodeLine>
<Link id="l00434" /><CodeLine lineNumber="434"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// search early.  There is no need to search the RHS of the value for</span></CodeLine>
<Link id="l00435" /><CodeLine lineNumber="435"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// partial results.</span></CodeLine>
<Link id="l00436" /><CodeLine lineNumber="436"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NumValsGreater != <a href="/docs/api/classes/node">Node</a>-&gt;getNumValuesUsed() &amp;&amp;</span></CodeLine>
<Link id="l00437" /><CodeLine lineNumber="437"><span class="doxyHighlight">        <a href="/docs/api/classes/node">Node</a>-&gt;getValue(NumValsGreater).FileLoc == FileIndex)</span></CodeLine>
<Link id="l00438" /><CodeLine lineNumber="438"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Result + IN-&gt;getChild(NumValsGreater)-&gt;getFullDelta();</span></CodeLine>
<Link id="l00439" /><CodeLine lineNumber="439"></CodeLine>
<Link id="l00440" /><CodeLine lineNumber="440"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Otherwise, traverse down the tree.  The selected subtree may be</span></CodeLine>
<Link id="l00441" /><CodeLine lineNumber="441"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// partially included in the range.</span></CodeLine>
<Link id="l00442" /><CodeLine lineNumber="442"><span class="doxyHighlight">    <a href="/docs/api/classes/node">Node</a> = IN-&gt;getChild(NumValsGreater);</span></CodeLine>
<Link id="l00443" /><CodeLine lineNumber="443"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00444" /><CodeLine lineNumber="444"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// NOT REACHED.</span></CodeLine>
<Link id="l00445" /><CodeLine lineNumber="445"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00446" /><CodeLine lineNumber="446"></CodeLine>
<Link id="l00447" /><CodeLine lineNumber="447"><span class="doxyHighlightComment">/// AddDelta - When a change is made that shifts around the text buffer,</span></CodeLine>
<Link id="l00448" /><CodeLine lineNumber="448"><span class="doxyHighlightComment">/// this method is used to record that info.  It inserts a delta of &#39;Delta&#39;</span></CodeLine>
<Link id="l00449" /><CodeLine lineNumber="449"><span class="doxyHighlightComment">/// into the current DeltaTree at offset FileIndex.</span></CodeLine>
<Link id="l00450" /><CodeLine lineNumber="450" lineLink="/docs/api/classes/llvm/deltatree/#a65b2200df7c029fc766e3486c6629ae5"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/deltatree/#a65b2200df7c029fc766e3486c6629ae5">DeltaTree::AddDelta</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> FileIndex, </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> Delta) &#123;</span></CodeLine>
<Link id="l00451" /><CodeLine lineNumber="451"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Delta &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Adding a noop?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00452" /><CodeLine lineNumber="452"><span class="doxyHighlight">  DeltaTreeNode &#42;MyRoot = <a href="#ab590661425ca60ca82edfdb4cf22233d">getRoot</a>(Root);</span></CodeLine>
<Link id="l00453" /><CodeLine lineNumber="453"></CodeLine>
<Link id="l00454" /><CodeLine lineNumber="454"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-deltatree-cpp-/deltatreenode/insertresult">DeltaTreeNode::InsertResult</a> InsertRes;</span></CodeLine>
<Link id="l00455" /><CodeLine lineNumber="455"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MyRoot-&gt;DoInsertion(FileIndex, Delta, &amp;InsertRes)) &#123;</span></CodeLine>
<Link id="l00456" /><CodeLine lineNumber="456"><span class="doxyHighlight">    Root = </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> DeltaTreeInteriorNode(InsertRes);</span></CodeLine>
<Link id="l00457" /><CodeLine lineNumber="457"><span class="doxyHighlightPreprocessor">#ifdef VERIFY&#95;TREE</span></CodeLine>
<Link id="l00458" /><CodeLine lineNumber="458"><span class="doxyHighlight">    MyRoot = Root;</span></CodeLine>
<Link id="l00459" /><CodeLine lineNumber="459"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l00460" /><CodeLine lineNumber="460"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00461" /><CodeLine lineNumber="461"></CodeLine>
<Link id="l00462" /><CodeLine lineNumber="462"><span class="doxyHighlightPreprocessor">#ifdef VERIFY&#95;TREE</span></CodeLine>
<Link id="l00463" /><CodeLine lineNumber="463"><span class="doxyHighlight">  VerifyTree(MyRoot);</span></CodeLine>
<Link id="l00464" /><CodeLine lineNumber="464"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l00465" /><CodeLine lineNumber="465"><span class="doxyHighlight">&#125;</span></CodeLine>

</ProgramListing>


</DoxygenPage>
