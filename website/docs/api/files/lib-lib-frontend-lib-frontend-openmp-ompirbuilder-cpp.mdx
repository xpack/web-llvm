---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - file

---

import Link from '@docusaurus/Link'

import CodeLine from '@xpack/docusaurus-plugin-doxygen/components/CodeLine'
import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import Highlight from '@xpack/docusaurus-plugin-doxygen/components/Highlight'
import IncludesList from '@xpack/docusaurus-plugin-doxygen/components/IncludesList'
import IncludesListItem from '@xpack/docusaurus-plugin-doxygen/components/IncludesListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import ProgramListing from '@xpack/docusaurus-plugin-doxygen/components/ProgramListing'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `OMPIRBuilder.cpp` File Reference

<DoxygenPage pluginConfig={pluginConfig}>

This file implements the <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> class, which is used as a convenient way to create LLVM instructions for OpenMP directives. <a href="#details">More...</a>

## Included Headers

<IncludesList>
<IncludesListItem
  filePath="llvm/Frontend/OpenMP/OMPIRBuilder.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/frontend/include/llvm/frontend/openmp/ompirbuilder-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallBitVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallbitvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/StringExtras.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/stringextras-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/StringRef.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/stringref-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/AssumptionCache.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/assumptioncache-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/CodeMetrics.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/codemetrics-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/LoopInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/loopinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/OptimizationRemarkEmitter.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/optimizationremarkemitter-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ScalarEvolution.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolution-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/TargetLibraryInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/targetlibraryinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Bitcode/BitcodeReader.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/bitcode/bitcodereader-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Frontend/Offloading/Utility.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/frontend/include/llvm/frontend/offloading/utility-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Frontend/OpenMP/OMPGridValues.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/frontend/include/llvm/frontend/openmp/ompgridvalues-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Attributes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/attributes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/BasicBlock.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/basicblock-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/CFG.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/cfg-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/CallingConv.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/callingconv-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Constant.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/constant-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Constants.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/constants-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DIBuilder.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/dibuilder-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DebugInfoMetadata.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/debuginfometadata-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DerivedTypes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/derivedtypes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Function.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/function-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/GlobalVariable.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/globalvariable-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/IRBuilder.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/irbuilder-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/LLVMContext.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/llvmcontext-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/MDBuilder.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/mdbuilder-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Metadata.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/metadata-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/PassInstrumentation.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/passinstrumentation-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/PassManager.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/passmanager-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/ReplaceConstant.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/replaceconstant-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Value.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/value-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/MC/TargetRegistry.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/mc/targetregistry-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/CommandLine.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/ErrorHandling.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/FileSystem.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/filesystem-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Target/TargetMachine.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/target/targetmachine-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Target/TargetOptions.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/target/targetoptions-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/BasicBlockUtils.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/basicblockutils-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/Cloning.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/cloning-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/CodeExtractor.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/codeextractor-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/LoopPeel.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/looppeel-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/UnrollLoop.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/unrollloop-h"
  isLocal="true" />
<IncludesListItem
  filePath="cstdint"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="optional"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="llvm/Frontend/OpenMP/OMPKinds.def"
  permalink=""
  isLocal="true" />
</IncludesList>

## Namespaces Index

<MembersIndex>

<MembersIndexItem
  type="namespace"
  name={<><a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-">anonymous&#123;OMPIRBuilder.cpp&#125;</a></>}>
</MembersIndexItem>

</MembersIndex>

## Functions Index

<MembersIndex>

<MembersIndexItem
  type="void"
  name={<><a href="#ac36177cea684b1e36fdbc92d692f69d0">addBasicBlockMetadata</a> (BasicBlock &#42;BB, ArrayRef&lt; Metadata &#42; &gt; Properties)</>}>
Attach metadata <code>Properties</code> to the basic block described by <code>BB</code>. <a href="#ac36177cea684b1e36fdbc92d692f69d0">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#adf813540e363817b85e9eecef51269b5">addLoopMetadata</a> (CanonicalLoopInfo &#42;Loop, ArrayRef&lt; Metadata &#42; &gt; Properties)</>}>
Attach loop metadata <code>Properties</code> to the loop described by <code><a href="/docs/api/classes/llvm/loop">Loop</a></code>. <a href="#adf813540e363817b85e9eecef51269b5">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a545cc7eb4f94d0957ba9960a69b10a90">addSimdMetadata</a> (BasicBlock &#42;Block, MDNode &#42;AccessGroup, LoopInfo &amp;LI)</>}>
Attach llvm.access.group metadata to the memref instructions of <code>Block</code>. <a href="#a545cc7eb4f94d0957ba9960a69b10a90">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a75e12544ba3cf3438ac62e2065e4941d">checkReductionInfos</a> (ArrayRef&lt; OpenMPIRBuilder::ReductionInfo &gt; ReductionInfos, bool IsGPU)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<>int32&#95;t</>}
  name={<><a href="#a946282957319b8c23ab9f169abb504c4">computeHeuristicUnrollFactor</a> (CanonicalLoopInfo &#42;CLI)</>}>
Heuristically determine the best-performant unroll factor for <code>CLI</code>. <a href="#a946282957319b8c23ab9f169abb504c4">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a></>}
  name={<><a href="#a554000c782275642b783964853720bee">computeOpenMPScheduleType</a> (ScheduleKind ClauseKind, bool HasChunks, bool HasSimdModifier, bool HasMonotonicModifier, bool HasNonmonotonicModifier, bool HasOrderedClause)</>}>
Determine the schedule type using schedule and ordering clause arguments. <a href="#a554000c782275642b783964853720bee">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">Value</a> &#42;</>}
  name={<><a href="#a35409dbaffc2cf38fefec12e3cf9094d">createFakeIntVal</a> (IRBuilderBase &amp;Builder, OpenMPIRBuilder::InsertPointTy OuterAllocaIP, llvm::SmallVectorImpl&lt; Instruction &#42; &gt; &amp;ToBeDeleted, OpenMPIRBuilder::InsertPointTy InnerAllocaIP, const Twine &amp;Name=&quot;&quot;, bool AsPtr=true)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/expected">Expected</a>&lt; <a href="/docs/api/classes/llvm/function">Function</a> &#42; &gt;</>}
  name={<><a href="#a3ea33750ee7de55492a5083c347e2ddb">createOutlinedFunction</a> (OpenMPIRBuilder &amp;OMPBuilder, IRBuilderBase &amp;Builder, const OpenMPIRBuilder::TargetKernelDefaultAttrs &amp;DefaultAttrs, StringRef FuncName, SmallVectorImpl&lt; Value &#42; &gt; &amp;Inputs, OpenMPIRBuilder::TargetBodyGenCallbackTy &amp;CBFunc, OpenMPIRBuilder::TargetGenArgAccessorsCallbackTy &amp;ArgAccessorFuncCB)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#acae95016bcdeb105bcbcaaa872893f5f">createTargetLoopWorkshareCall</a> (OpenMPIRBuilder &#42;OMPBuilder, WorksharingLoopType LoopType, BasicBlock &#42;InsertBlock, Value &#42;Ident, Value &#42;LoopBodyArg, Type &#42;ParallelTaskPtr, Value &#42;TripCount, Function &amp;LoopBodyFn)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<>std::unique&#95;ptr&lt; <a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a> &gt;</>}
  name={<><a href="#abfc7ebfffc7baaf23279854fec1412ac">createTargetMachine</a> (Function &#42;F, CodeGenOptLevel OptLevel)</>}>
Create the <a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a> object to query the backend for optimization preferences. <a href="#abfc7ebfffc7baaf23279854fec1412ac">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;</>}
  name={<><a href="#a91b7eb2a05d10c788413bec7977f3474">emitImplicitCast</a> (IRBuilder&lt;&gt; &amp;Builder, llvm::Value &#42;XRead, llvm::Value &#42;V)</>}>
Emit an implicit cast to convert <code>XRead</code> to type of variable <code>V</code>. <a href="#a91b7eb2a05d10c788413bec7977f3474">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a9acb4faf91112542d5ecf41230e9b64a">emitTargetCall</a> (OpenMPIRBuilder &amp;OMPBuilder, IRBuilderBase &amp;Builder, OpenMPIRBuilder::InsertPointTy AllocaIP, const OpenMPIRBuilder::TargetKernelDefaultAttrs &amp;DefaultAttrs, const OpenMPIRBuilder::TargetKernelRuntimeAttrs &amp;RuntimeAttrs, Value &#42;IfCond, Function &#42;OutlinedFn, Constant &#42;OutlinedFnID, SmallVectorImpl&lt; Value &#42; &gt; &amp;Args, OpenMPIRBuilder::GenMapInfoCallbackTy GenMapInfoCB, SmallVector&lt; llvm::OpenMPIRBuilder::DependData &gt; Dependencies=&#123;&#125;, bool HasNoWait=false)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/error">Error</a></>}
  name={<><a href="#aa33db5ef74d376fb331f9549fb3cd9b3">emitTargetOutlinedFunction</a> (OpenMPIRBuilder &amp;OMPBuilder, IRBuilderBase &amp;Builder, bool IsOffloadEntry, TargetRegionEntryInfo &amp;EntryInfo, const OpenMPIRBuilder::TargetKernelDefaultAttrs &amp;DefaultAttrs, Function &#42;&amp;OutlinedFn, Constant &#42;&amp;OutlinedFnID, SmallVectorImpl&lt; Value &#42; &gt; &amp;Inputs, OpenMPIRBuilder::TargetBodyGenCallbackTy &amp;CBFunc, OpenMPIRBuilder::TargetGenArgAccessorsCallbackTy &amp;ArgAccessorFuncCB)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/function">Function</a> &#42;</>}
  name={<><a href="#a3fb4884285f5bcb9a37d9378d1e33cd5">emitTargetTaskProxyFunction</a> (OpenMPIRBuilder &amp;OMPBuilder, IRBuilderBase &amp;Builder, CallInst &#42;StaleCI)</>}>
Create an entry point for a target task with the following. <a href="#a3fb4884285f5bcb9a37d9378d1e33cd5">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">Value</a> &#42;</>}
  name={<><a href="#a9702d30c99a5459e9565631adf1fdf1b">emitTaskDependencies</a> (OpenMPIRBuilder &amp;OMPBuilder, const SmallVectorImpl&lt; OpenMPIRBuilder::DependData &gt; &amp;Dependencies)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/function">Function</a> &#42;</>}
  name={<><a href="#a669fae0a15d7219ef3ca3f3b16e3f5a0">getFreshReductionFunc</a> (Module &amp;M)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/structs/llvm/omp/gv">omp::GV</a> &amp;</>}
  name={<><a href="#ad52342fdd467389643191fdac7abcd40">getGridValue</a> (const Triple &amp;T, Function &#42;Kernel)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a></>}
  name={<><a href="#ab5fa59567e3acc860411770354a1603a">getInsertPointAfterInstr</a> (Instruction &#42;I)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></>}
  name={<><a href="#a3d17252beff7921e40622170990c89ab">getKmpcForDynamicFiniForType</a> (Type &#42;Ty, Module &amp;M, OpenMPIRBuilder &amp;OMPBuilder)</>}>
Returns an LLVM function to call for finalizing the dynamic loop using depending on <code>type</code>. <a href="#a3d17252beff7921e40622170990c89ab">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></>}
  name={<><a href="#a7a68322ba864bccb8736e42fbc915a8a">getKmpcForDynamicInitForType</a> (Type &#42;Ty, Module &amp;M, OpenMPIRBuilder &amp;OMPBuilder)</>}>
Returns an LLVM function to call for initializing loop bounds using OpenMP dynamic scheduling depending on <code>type</code>. <a href="#a7a68322ba864bccb8736e42fbc915a8a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></>}
  name={<><a href="#a74bf2240e1da04168d57a7534c9613f7">getKmpcForDynamicNextForType</a> (Type &#42;Ty, Module &amp;M, OpenMPIRBuilder &amp;OMPBuilder)</>}>
Returns an LLVM function to call for updating the next loop using OpenMP dynamic scheduling depending on <code>type</code>. <a href="#a74bf2240e1da04168d57a7534c9613f7">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></>}
  name={<><a href="#ac04904b32ea7f45e108b8752b1a940e7">getKmpcForStaticInitForType</a> (Type &#42;Ty, Module &amp;M, OpenMPIRBuilder &amp;OMPBuilder)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></>}
  name={<><a href="#aca27639a720491c7c7ea13c2bbe8c162">getKmpcForStaticLoopForType</a> (Type &#42;Ty, OpenMPIRBuilder &#42;OMPBuilder, WorksharingLoopType LoopType)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42;</>}
  name={<><a href="#a749d7f5580e6a5b6214d911bad2a0b36">getNVPTXMDNode</a> (Function &amp;Kernel, StringRef Name)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a></>}
  name={<><a href="#a065b0b31e5ca4c10b1cef45581efb8dc">getOpenMPBaseScheduleType</a> (llvm::omp::ScheduleKind ClauseKind, bool HasChunks, bool HasSimdModifier)</>}>
Determine which scheduling algorithm to use, determined from schedule clause arguments. <a href="#a065b0b31e5ca4c10b1cef45581efb8dc">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a></>}
  name={<><a href="#a4b64de5bc0d090cc76ddb989acabf0f3">getOpenMPMonotonicityScheduleType</a> (OMPScheduleType ScheduleType, bool HasSimdModifier, bool HasMonotonic, bool HasNonmonotonic, bool HasOrderedClause)</>}>
Adds monotonicity modifier flags to schedule type. <a href="#a4b64de5bc0d090cc76ddb989acabf0f3">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a></>}
  name={<><a href="#a4a87dd5af95eb64807ad77405e4f4654">getOpenMPOrderingScheduleType</a> (OMPScheduleType BaseScheduleType, bool HasOrderedClause)</>}>
Adds ordering modifier flags to schedule type. <a href="#a4a87dd5af95eb64807ad77405e4f4654">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#afffa0ff2e1527ab545cef33be915c656">hostParallelCallback</a> (OpenMPIRBuilder &#42;OMPIRBuilder, Function &amp;OutlinedFn, Function &#42;OuterFn, Value &#42;Ident, Value &#42;IfCondition, Instruction &#42;PrivTID, AllocaInst &#42;PrivTIDAddr, const SmallVector&lt; Instruction &#42;, 4 &gt; &amp;ToBeDeleted)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a756b28f370cd5a39bc0ee3e5333b9c9b">isConflictIP</a> (IRBuilder&lt;&gt;::InsertPoint IP1, IRBuilder&lt;&gt;::InsertPoint IP2)</>}>
Return whether IP1 and IP2 are ambiguous, i.e. <a href="#a756b28f370cd5a39bc0ee3e5333b9c9b">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a596dcc3bb2ae8b7561e94095584e0f1e">isValidWorkshareLoopScheduleType</a> (OMPScheduleType SchedType)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a6e4c46869d9d198562f7b8628814e407">raiseUserConstantDataAllocasToEntryBlock</a> (IRBuilderBase &amp;Builder, Function &#42;Function)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#abdcdbfc178873f5055fbcf98bad92f53">redirectAllPredecessorsTo</a> (BasicBlock &#42;OldTarget, BasicBlock &#42;NewTarget, DebugLoc DL)</>}>
Redirect all edges that branch to <code>OldTarget</code> to <code>NewTarget</code>. <a href="#abdcdbfc178873f5055fbcf98bad92f53">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a> (BasicBlock &#42;Source, BasicBlock &#42;Target, DebugLoc DL)</>}>
Make <code>Source</code> branch to <code><a href="/docs/api/classes/llvm/target">Target</a></code>. <a href="#a3057c2b7e1e25de160497b1ef3985c2a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#af0ce60c4a958016f62ce78f1eda423af">removeUnusedBlocksFromParent</a> (ArrayRef&lt; BasicBlock &#42; &gt; BBs)</>}>
Determine which blocks in <code>BBs</code> are reachable from outside and remove the ones that are not reachable from the function. <a href="#af0ce60c4a958016f62ce78f1eda423af">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#af7668ce8080668a4f0ceac24e70c9f00">targetParallelCallback</a> (OpenMPIRBuilder &#42;OMPIRBuilder, Function &amp;OutlinedFn, Function &#42;OuterFn, BasicBlock &#42;OuterAllocaBB, Value &#42;Ident, Value &#42;IfCondition, Value &#42;NumThreads, Instruction &#42;PrivTID, AllocaInst &#42;PrivTIDAddr, Value &#42;ThreadID, const SmallVector&lt; Instruction &#42;, 4 &gt; &amp;ToBeDeleted)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a457f42a32df73079ac4526c572a2d7fd">updateNVPTXMetadata</a> (Function &amp;Kernel, StringRef Name, int32&#95;t Value, bool Min)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#aa2a5199bf39360e25f40b93cd5f9468a">workshareLoopTargetCallback</a> (OpenMPIRBuilder &#42;OMPIRBuilder, CanonicalLoopInfo &#42;CLI, Value &#42;Ident, Function &amp;OutlinedFn, Type &#42;ParallelTaskPtr, const SmallVector&lt; Instruction &#42;, 4 &gt; &amp;ToBeDeleted, WorksharingLoopType LoopType)</>}>
</MembersIndexItem>

</MembersIndex>

## Variables Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#ac7b0d6b394df409e7550fb21aa7d9e5c">OptimisticAttributes</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; double &gt;</>}
  name={<><a href="#a87dfce8f7ae9d7942d55ac782438dbf8">UnrollThresholdFactor</a></>}>
</MembersIndexItem>

</MembersIndex>

## Defines Index

<MembersIndex>

<MembersIndexItem
  type="#define"
  name={<><a href="#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>&nbsp;&nbsp;&nbsp;&quot;openmp-<a href="/docs/api/files/lib/lib/ir/safepointirverifier-cpp/#a3d3459f5796b9b9f0253f71d5620e958">ir</a>-builder&quot;</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#aafa57f1c2700b16129c83badeb165f9c">OMP&#95;ARRAY&#95;TYPE</a>&nbsp;&nbsp;&nbsp;  VarName##Ty = ArrayType::get(ElemTy, ArraySize);                             \\
  VarName##PtrTy = PointerType::getUnqual(Ctx);</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#a7a441e887365f90092c254b19e7bcfef">OMP&#95;ATTRS&#95;SET</a>&nbsp;&nbsp;&nbsp;AttributeSet VarName = AttrSet;</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#a6f431cf29bc502bb66b702e9d36dea91">OMP&#95;CANCEL&#95;KIND</a>&nbsp;&nbsp;&nbsp;  case DirectiveEnum:                                                          \\
    CancelKind = Builder.getInt32(Value);                                      \\
    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/asmprinter/ehstreamer-cpp/#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a>;</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#ad08bb874382ad7ded92c133a57714c49">OMP&#95;FUNCTION&#95;TYPE</a>&nbsp;&nbsp;&nbsp;  VarName = FunctionType::get(ReturnType, &#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;, IsVarArg);            \\
  VarName##<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = PointerType::getUnqual(Ctx);</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#a02ddde535a0ac37557b1a1907c8de422">OMP&#95;RTL</a>&nbsp;&nbsp;&nbsp;  case Enum:                                                                   \\
    FnTy = FunctionType::get(ReturnType, ArrayRef&lt;Type &#42;&gt;&#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;,        \\
                             IsVarArg);                                        \\
    Fn = <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/evaluator-cpp/#a92efb02157b6836e1232c577d34678d6">M.getFunction</a>(Str);                                                   \\
    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/asmprinter/ehstreamer-cpp/#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a>;</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#a8e0948ab2a7acb4aa9997fd1a5b8fbb7">OMP&#95;RTL</a>&nbsp;&nbsp;&nbsp;  case Enum:                                                                   \\
    Fn = Function::Create(FnTy, GlobalValue::ExternalLinkage, Str, M);         \\
    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/asmprinter/ehstreamer-cpp/#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a>;</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#afef4eeef2878c8a4a7ca0f8dd522141f">OMP&#95;RTL&#95;ATTRS</a>&nbsp;&nbsp;&nbsp;  case Enum:                                                                   \\
    FnAttrs = FnAttrs.addAttributes(Ctx, FnAttrSet);                           \\
    addAttrSet(RetAttrs, RetAttrSet, /&#42;Param&#42;/ false);                         \\
    <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a4cfc8b177e8521a4b496ae2edff6244f">for</a> (size&#95;t ArgNo = 0; ArgNo &lt; <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmreflect-cpp/#ac934769d93af95250952646a3829df4c">ArgAttrSets.size</a>(); ++ArgNo)                \\
      addAttrSet(ArgAttrs&#91;ArgNo&#93;, ArgAttrSets&#91;ArgNo&#93;);                         \\
    Fn.setAttributes(AttributeList::get(Ctx, FnAttrs, RetAttrs, ArgAttrs));    \\
    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/asmprinter/ehstreamer-cpp/#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a>;</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#aab9e6bf3a40b4ccf0272542c0ce58d16">OMP&#95;STRUCT&#95;TYPE</a>&nbsp;&nbsp;&nbsp;  T = StructType::getTypeByName(Ctx, <a href="/docs/api/files/lib/lib/object/machouniversalwriter-cpp/#a26ecfcee41769620d62e904e7f142499">StructName</a>);                              \\
  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#acdfbcf188e2d4a80837e89de2ccdffab">if</a> (!T)                                                                      \\
    T = StructType::create(Ctx, &#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;, <a href="/docs/api/files/lib/lib/object/machouniversalwriter-cpp/#a26ecfcee41769620d62e904e7f142499">StructName</a>, Packed);            \\
  VarName = T;                                                                 \\
  VarName##<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = PointerType::getUnqual(Ctx);</>}>
</MembersIndexItem>

<MembersIndexItem
  type="#define"
  name={<><a href="#afd21bf6bbf67e4d7213a29ade471a8ee">OMP&#95;TYPE</a>&nbsp;&nbsp;&nbsp;VarName = InitValue;</>}>
</MembersIndexItem>

</MembersIndex>

## Description {#details}

This file implements the <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> class, which is used as a convenient way to create LLVM instructions for OpenMP directives.

<SectionDefinition>

## Functions

### addBasicBlockMetadata() {#ac36177cea684b1e36fdbc92d692f69d0}

<MemberDefinition
  prototype={<>static void addBasicBlockMetadata (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; BB, <a href="/docs/api/classes/llvm/arrayref">ArrayRef</a>&lt; <a href="/docs/api/classes/llvm/metadata">Metadata</a> &#42; &gt; Properties)</>}
  labels = {["static"]}>
Attach metadata <code>Properties</code> to the basic block described by <code>BB</code>.

If the basic block already has metadata, the basic block properties are appended.

Definition at line <a href="#l05207">5207</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### addLoopMetadata() {#adf813540e363817b85e9eecef51269b5}

<MemberDefinition
  prototype={<>static void addLoopMetadata (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42; Loop, <a href="/docs/api/classes/llvm/arrayref">ArrayRef</a>&lt; <a href="/docs/api/classes/llvm/metadata">Metadata</a> &#42; &gt; Properties)</>}
  labels = {["static"]}>
Attach loop metadata <code>Properties</code> to the loop described by <code><a href="/docs/api/classes/llvm/loop">Loop</a></code>.

If the loop already has metadata, the loop properties are appended.

Definition at line <a href="#l05231">5231</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### addSimdMetadata() {#a545cc7eb4f94d0957ba9960a69b10a90}

<MemberDefinition
  prototype={<>static void addSimdMetadata (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; Block, <a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42; AccessGroup, <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp; LI)</>}
  labels = {["static"]}>
Attach llvm.access.group metadata to the memref instructions of <code>Block</code>.

Definition at line <a href="#l05242">5242</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### checkReductionInfos() {#a75e12544ba3cf3438ac62e2065e4941d}

<MemberDefinition
  prototype={<>static void checkReductionInfos (<a href="/docs/api/classes/llvm/arrayref">ArrayRef</a>&lt; OpenMPIRBuilder::ReductionInfo &gt; ReductionInfos, bool IsGPU)</>}
  labels = {["static"]}>

Definition at line <a href="#l03515">3515</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### computeHeuristicUnrollFactor() {#a946282957319b8c23ab9f169abb504c4}

<MemberDefinition
  prototype={<>static int32&#95;t computeHeuristicUnrollFactor (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42; CLI)</>}
  labels = {["static"]}>
Heuristically determine the best-performant unroll factor for <code>CLI</code>.

This depends on the target processor. We are re-using the same heuristics as the <a href="/docs/api/classes/llvm/loopunrollpass">LoopUnrollPass</a>.

Definition at line <a href="#l05484">5484</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### computeOpenMPScheduleType() {#a554000c782275642b783964853720bee}

<MemberDefinition
  prototype="static OMPScheduleType computeOpenMPScheduleType (ScheduleKind ClauseKind, bool HasChunks, bool HasSimdModifier, bool HasMonotonicModifier, bool HasNonmonotonicModifier, bool HasOrderedClause)"
  labels = {["static"]}>
Determine the schedule type using schedule and ordering clause arguments.

Definition at line <a href="#l00252">252</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### createFakeIntVal() {#a35409dbaffc2cf38fefec12e3cf9094d}

<MemberDefinition
  prototype={<>Value &#42; createFakeIntVal (<a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp; Builder, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OuterAllocaIP, <a href="/docs/api/classes/llvm/smallvectorimpl">llvm::SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; &gt; &amp; ToBeDeleted, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> InnerAllocaIP, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp; Name=&quot;&quot;, bool AsPtr=<a href="/docs/api/files/lib/lib/analysis/basicaliasanalysis-cpp/#af6d5cafbdfc5313e65d990120021a3ec">true</a>)</>}>

Definition at line <a href="#l00391">391</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### createOutlinedFunction() {#a3ea33750ee7de55492a5083c347e2ddb}

<MemberDefinition
  prototype={<>static Expected&lt; Function &#42; &gt; createOutlinedFunction (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder, <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp; Builder, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> OpenMPIRBuilder::TargetKernelDefaultAttrs &amp; DefaultAttrs, <a href="/docs/api/classes/llvm/stringref">StringRef</a> FuncName, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/value">Value</a> &#42; &gt; &amp; Inputs, OpenMPIRBuilder::TargetBodyGenCallbackTy &amp; CBFunc, OpenMPIRBuilder::TargetGenArgAccessorsCallbackTy &amp; ArgAccessorFuncCB)</>}
  labels = {["static"]}>

Definition at line <a href="#l06807">6807</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### createTargetLoopWorkshareCall() {#acae95016bcdeb105bcbcaaa872893f5f}

<MemberDefinition
  prototype={<>static void createTargetLoopWorkshareCall (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42; OMPBuilder, <a href="/docs/api/namespaces/llvm/omp/#ab6fb146c332fd3f3d677ee65081fe669">WorksharingLoopType</a> LoopType, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; InsertBlock, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Ident, <a href="/docs/api/classes/llvm/value">Value</a> &#42; LoopBodyArg, <a href="/docs/api/classes/llvm/type">Type</a> &#42; ParallelTaskPtr, <a href="/docs/api/classes/llvm/value">Value</a> &#42; TripCount, <a href="/docs/api/classes/llvm/function">Function</a> &amp; LoopBodyFn)</>}
  labels = {["static"]}>

Definition at line <a href="#l04433">4433</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### createTargetMachine() {#abfc7ebfffc7baaf23279854fec1412ac}

<MemberDefinition
  prototype={<>static std::unique&#95;ptr&lt; TargetMachine &gt; createTargetMachine (<a href="/docs/api/classes/llvm/function">Function</a> &#42; F, <a href="/docs/api/namespaces/llvm/#a8ec1bf8d7b792ca9fac56f8514db18d2">CodeGenOptLevel</a> OptLevel)</>}
  labels = {["static"]}>
Create the <a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a> object to query the backend for optimization preferences.

Ideally, this would be passed from the front-end to the OpenMPBuilder, but e.g. Clang does not pass it to its CodeGen layer and creates it only when needed for the LLVM pass pipline. We use some default options to avoid having to pass too many settings from the frontend that probably do not matter.

Currently, <a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a> is only used sometimes by the unrollLoopPartial method. If we are going to use <a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a> for more purposes, especially those that are sensitive to <a href="/docs/api/classes/llvm/targetoptions">TargetOptions</a>, RelocModel and <a href="/docs/api/namespaces/llvm/codemodel">CodeModel</a>, it might become be worth requiring front-ends to pass on their <a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a>, or at least cache it between methods. Note that while fontends such as Clang have just a single main <a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a> per translation unit, &quot;target-cpu&quot; and &quot;target-features&quot; that determine the <a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a> are per-function and can be overrided using <b>attribute</b>((target(&quot;OPTIONS&quot;))).

Definition at line <a href="#l05463">5463</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### emitImplicitCast() {#a91b7eb2a05d10c788413bec7977f3474}

<MemberDefinition
  prototype={<>static llvm::Value &#42; emitImplicitCast (<a href="/docs/api/classes/llvm/irbuilder">IRBuilder</a>&lt;&gt; &amp; Builder, <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42; XRead, <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42; V)</>}
  labels = {["static"]}>
Emit an implicit cast to convert <code>XRead</code> to type of variable <code>V</code>.

Definition at line <a href="#l00268">268</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### emitTargetCall() {#a9acb4faf91112542d5ecf41230e9b64a}

<MemberDefinition
  prototype={<>static void emitTargetCall (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder, <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp; Builder, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> AllocaIP, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> OpenMPIRBuilder::TargetKernelDefaultAttrs &amp; DefaultAttrs, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> OpenMPIRBuilder::TargetKernelRuntimeAttrs &amp; RuntimeAttrs, <a href="/docs/api/classes/llvm/value">Value</a> &#42; IfCond, <a href="/docs/api/classes/llvm/function">Function</a> &#42; OutlinedFn, <a href="/docs/api/classes/llvm/constant">Constant</a> &#42; OutlinedFnID, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/value">Value</a> &#42; &gt; &amp; Args, OpenMPIRBuilder::GenMapInfoCallbackTy GenMapInfoCB, <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; <a href="/docs/api/structs/llvm/openmpirbuilder/dependdata">llvm::OpenMPIRBuilder::DependData</a> &gt; Dependencies=&#123;&#125;, bool HasNoWait=false)</>}
  labels = {["static"]}>

Definition at line <a href="#l07404">7404</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### emitTargetOutlinedFunction() {#aa33db5ef74d376fb331f9549fb3cd9b3}

<MemberDefinition
  prototype={<>static Error emitTargetOutlinedFunction (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder, <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp; Builder, bool IsOffloadEntry, <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp; EntryInfo, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> OpenMPIRBuilder::TargetKernelDefaultAttrs &amp; DefaultAttrs, <a href="/docs/api/classes/llvm/function">Function</a> &#42;&amp; OutlinedFn, <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;&amp; OutlinedFnID, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/value">Value</a> &#42; &gt; &amp; Inputs, OpenMPIRBuilder::TargetBodyGenCallbackTy &amp; CBFunc, OpenMPIRBuilder::TargetGenArgAccessorsCallbackTy &amp; ArgAccessorFuncCB)</>}
  labels = {["static"]}>

Definition at line <a href="#l07092">7092</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### emitTargetTaskProxyFunction() {#a3fb4884285f5bcb9a37d9378d1e33cd5}

<MemberDefinition
  prototype={<>static Function &#42; emitTargetTaskProxyFunction (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder, <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp; Builder, <a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42; StaleCI)</>}
  labels = {["static"]}>
Create an entry point for a target task with the following.

It&#39;ll have the following signature void .omp&#95;target&#95;task&#95;proxy&#95;func(i32 thread.id, ptr task) This function is called from emitTargetTask once the code to launch the target kernel has been outlined already.

Definition at line <a href="#l07012">7012</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### emitTaskDependencies() {#a9702d30c99a5459e9565631adf1fdf1b}

<MemberDefinition
  prototype={<>static Value &#42; emitTaskDependencies (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/structs/llvm/openmpirbuilder/dependdata">OpenMPIRBuilder::DependData</a> &gt; &amp; Dependencies)</>}
  labels = {["static"]}>

Definition at line <a href="#l01814">1814</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getFreshReductionFunc() {#a669fae0a15d7219ef3ca3f3b16e3f5a0}

<MemberDefinition
  prototype={<>static Function &#42; getFreshReductionFunc (<a href="/docs/api/classes/llvm/module">Module</a> &amp; M)</>}
  labels = {["static"]}>

Definition at line <a href="#l03721">3721</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getGridValue() {#ad52342fdd467389643191fdac7abcd40}

<MemberDefinition
  prototype={<>static const omp::GV &amp; getGridValue (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/triple">Triple</a> &amp; T, <a href="/docs/api/classes/llvm/function">Function</a> &#42; Kernel)</>}
  labels = {["static"]}>

Definition at line <a href="#l00152">152</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getInsertPointAfterInstr() {#ab5fa59567e3acc860411770354a1603a}

<MemberDefinition
  prototype={<>static OpenMPIRBuilder::InsertPointTy getInsertPointAfterInstr (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; I)</>}
  labels = {["static"]}>

Definition at line <a href="#l02348">2348</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getKmpcForDynamicFiniForType() {#a3d17252beff7921e40622170990c89ab}

<MemberDefinition
  prototype={<>static FunctionCallee getKmpcForDynamicFiniForType (<a href="/docs/api/classes/llvm/type">Type</a> &#42; Ty, <a href="/docs/api/classes/llvm/module">Module</a> &amp; M, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder)</>}
  labels = {["static"]}>
Returns an LLVM function to call for finalizing the dynamic loop using depending on <code>type</code>.

Only i32 and i64 are supported by the runtime. Always interpret integers as unsigned similarly to <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a>.

Definition at line <a href="#l04711">4711</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getKmpcForDynamicInitForType() {#a7a68322ba864bccb8736e42fbc915a8a}

<MemberDefinition
  prototype={<>static FunctionCallee getKmpcForDynamicInitForType (<a href="/docs/api/classes/llvm/type">Type</a> &#42; Ty, <a href="/docs/api/classes/llvm/module">Module</a> &amp; M, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder)</>}
  labels = {["static"]}>
Returns an LLVM function to call for initializing loop bounds using OpenMP dynamic scheduling depending on <code>type</code>.

Only i32 and i64 are supported by the runtime. Always interpret integers as unsigned similarly to <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a>.

Definition at line <a href="#l04680">4680</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getKmpcForDynamicNextForType() {#a74bf2240e1da04168d57a7534c9613f7}

<MemberDefinition
  prototype={<>static FunctionCallee getKmpcForDynamicNextForType (<a href="/docs/api/classes/llvm/type">Type</a> &#42; Ty, <a href="/docs/api/classes/llvm/module">Module</a> &amp; M, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder)</>}
  labels = {["static"]}>
Returns an LLVM function to call for updating the next loop using OpenMP dynamic scheduling depending on <code>type</code>.

Only i32 and i64 are supported by the runtime. Always interpret integers as unsigned similarly to <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a>.

Definition at line <a href="#l04696">4696</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getKmpcForStaticInitForType() {#ac04904b32ea7f45e108b8752b1a940e7}

<MemberDefinition
  prototype={<>static FunctionCallee getKmpcForStaticInitForType (<a href="/docs/api/classes/llvm/type">Type</a> &#42; Ty, <a href="/docs/api/classes/llvm/module">Module</a> &amp; M, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp; OMPBuilder)</>}
  labels = {["static"]}>

Definition at line <a href="#l04130">4130</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getKmpcForStaticLoopForType() {#aca27639a720491c7c7ea13c2bbe8c162}

<MemberDefinition
  prototype={<>static FunctionCallee getKmpcForStaticLoopForType (<a href="/docs/api/classes/llvm/type">Type</a> &#42; Ty, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42; OMPBuilder, <a href="/docs/api/namespaces/llvm/omp/#ab6fb146c332fd3f3d677ee65081fe669">WorksharingLoopType</a> LoopType)</>}
  labels = {["static"]}>

Definition at line <a href="#l04395">4395</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getNVPTXMDNode() {#a749d7f5580e6a5b6214d911bad2a0b36}

<MemberDefinition
  prototype={<>static MDNode &#42; getNVPTXMDNode (<a href="/docs/api/classes/llvm/function">Function</a> &amp; Kernel, <a href="/docs/api/classes/llvm/stringref">StringRef</a> Name)</>}
  labels = {["static"]}>

Definition at line <a href="#l06363">6363</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getOpenMPBaseScheduleType() {#a065b0b31e5ca4c10b1cef45581efb8dc}

<MemberDefinition
  prototype="static OMPScheduleType getOpenMPBaseScheduleType (llvm::omp::ScheduleKind ClauseKind, bool HasChunks, bool HasSimdModifier)"
  labels = {["static"]}>
Determine which scheduling algorithm to use, determined from schedule clause arguments.

Definition at line <a href="#l00168">168</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getOpenMPMonotonicityScheduleType() {#a4b64de5bc0d090cc76ddb989acabf0f3}

<MemberDefinition
  prototype={<>static OMPScheduleType getOpenMPMonotonicityScheduleType (<a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> ScheduleType, bool HasSimdModifier, bool HasMonotonic, bool HasNonmonotonic, bool HasOrderedClause)</>}
  labels = {["static"]}>
Adds monotonicity modifier flags to schedule type.

Definition at line <a href="#l00216">216</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### getOpenMPOrderingScheduleType() {#a4a87dd5af95eb64807ad77405e4f4654}

<MemberDefinition
  prototype={<>static OMPScheduleType getOpenMPOrderingScheduleType (<a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> BaseScheduleType, bool HasOrderedClause)</>}
  labels = {["static"]}>
Adds ordering modifier flags to schedule type.

Definition at line <a href="#l00192">192</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### hostParallelCallback() {#afffa0ff2e1527ab545cef33be915c656}

<MemberDefinition
  prototype={<>static void hostParallelCallback (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42; OMPIRBuilder, <a href="/docs/api/classes/llvm/function">Function</a> &amp; OutlinedFn, <a href="/docs/api/classes/llvm/function">Function</a> &#42; OuterFn, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Ident, <a href="/docs/api/classes/llvm/value">Value</a> &#42; IfCondition, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; PrivTID, <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42; PrivTIDAddr, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;, 4 &gt; &amp; ToBeDeleted)</>}
  labels = {["static"]}>

Definition at line <a href="#l01344">1344</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### isConflictIP() {#a756b28f370cd5a39bc0ee3e5333b9c9b}

<MemberDefinition
  prototype={<>static bool isConflictIP (<a href="/docs/api/classes/llvm/irbuilder">IRBuilder</a>&lt;&gt;<a href="/docs/api/classes/llvm/irbuilder">::InsertPoint</a> IP1, <a href="/docs/api/classes/llvm/irbuilder">IRBuilder</a>&lt;&gt;<a href="/docs/api/classes/llvm/irbuilder">::InsertPoint</a> IP2)</>}
  labels = {["static"]}>
Return whether IP1 and IP2 are ambiguous, i.e.

that inserting instructions at position IP1 may change the meaning of IP2 or vice-versa. This is because an <a href="/docs/api/classes/llvm/irbuilder">InsertPoint</a> stores the instruction before something is inserted. For instance, if both point to the same instruction, two IRBuilders alternating creating instruction will cause the instructions to be interleaved.

Definition at line <a href="#l00086">86</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### isValidWorkshareLoopScheduleType() {#a596dcc3bb2ae8b7561e94095584e0f1e}

<MemberDefinition
  prototype={<>static bool isValidWorkshareLoopScheduleType (<a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> SchedType)</>}
  labels = {["static"]}>

Definition at line <a href="#l00093">93</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### raiseUserConstantDataAllocasToEntryBlock() {#a6e4c46869d9d198562f7b8628814e407}

<MemberDefinition
  prototype={<>static void raiseUserConstantDataAllocasToEntryBlock (<a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp; Builder, <a href="/docs/api/classes/llvm/function">Function</a> &#42; Function)</>}
  labels = {["static"]}>

Definition at line <a href="#l00678">678</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### redirectAllPredecessorsTo() {#abdcdbfc178873f5055fbcf98bad92f53}

<MemberDefinition
  prototype={<>static void redirectAllPredecessorsTo (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; OldTarget, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; NewTarget, <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> DL)</>}
  labels = {["static"]}>
Redirect all edges that branch to <code>OldTarget</code> to <code>NewTarget</code>.

That is, after this <code>OldTarget</code> will be orphaned.

Definition at line <a href="#l04856">4856</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### redirectTo() {#a3057c2b7e1e25de160497b1ef3985c2a}

<MemberDefinition
  prototype={<>static void redirectTo (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; Source, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; Target, <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> DL)</>}
  labels = {["static"]}>
Make <code>Source</code> branch to <code><a href="/docs/api/classes/llvm/target">Target</a></code>.

Handles two situations:
<ul>
<li><code>Source</code> already has an unconditional branch.</li>
<li><code>Source</code> is a degenerate block (no terminator because the BB is the current head of the IR construction).</li>
</ul>

Definition at line <a href="#l00300">300</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### removeUnusedBlocksFromParent() {#af0ce60c4a958016f62ce78f1eda423af}

<MemberDefinition
  prototype={<>static void removeUnusedBlocksFromParent (<a href="/docs/api/classes/llvm/arrayref">ArrayRef</a>&lt; <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; &gt; BBs)</>}
  labels = {["static"]}>
Determine which blocks in <code>BBs</code> are reachable from outside and remove the ones that are not reachable from the function.

Definition at line <a href="#l04864">4864</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### targetParallelCallback() {#af7668ce8080668a4f0ceac24e70c9f00}

<MemberDefinition
  prototype={<>static void targetParallelCallback (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42; OMPIRBuilder, <a href="/docs/api/classes/llvm/function">Function</a> &amp; OutlinedFn, <a href="/docs/api/classes/llvm/function">Function</a> &#42; OuterFn, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42; OuterAllocaBB, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Ident, <a href="/docs/api/classes/llvm/value">Value</a> &#42; IfCondition, <a href="/docs/api/classes/llvm/value">Value</a> &#42; NumThreads, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; PrivTID, <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42; PrivTIDAddr, <a href="/docs/api/classes/llvm/value">Value</a> &#42; ThreadID, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;, 4 &gt; &amp; ToBeDeleted)</>}
  labels = {["static"]}>

Definition at line <a href="#l01255">1255</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### updateNVPTXMetadata() {#a457f42a32df73079ac4526c572a2d7fd}

<MemberDefinition
  prototype={<>static void updateNVPTXMetadata (<a href="/docs/api/classes/llvm/function">Function</a> &amp; Kernel, <a href="/docs/api/classes/llvm/stringref">StringRef</a> Name, int32&#95;t Value, bool Min)</>}
  labels = {["static"]}>

Definition at line <a href="#l06380">6380</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### workshareLoopTargetCallback() {#aa2a5199bf39360e25f40b93cd5f9468a}

<MemberDefinition
  prototype={<>static void workshareLoopTargetCallback (<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42; OMPIRBuilder, <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42; CLI, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Ident, <a href="/docs/api/classes/llvm/function">Function</a> &amp; OutlinedFn, <a href="/docs/api/classes/llvm/type">Type</a> &#42; ParallelTaskPtr, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;, 4 &gt; &amp; ToBeDeleted, <a href="/docs/api/namespaces/llvm/omp/#ab6fb146c332fd3f3d677ee65081fe669">WorksharingLoopType</a> LoopType)</>}
  labels = {["static"]}>

Definition at line <a href="#l04468">4468</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Variables

### OptimisticAttributes {#ac7b0d6b394df409e7550fb21aa7d9e5c}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; OptimisticAttributes(&quot;openmp-ir-builder-optimistic-attributes&quot;, cl::Hidden, cl::desc(&quot;Use optimistic attributes describing &quot; &quot;&#39;as-if&#39; properties of runtime calls.&quot;), cl::init(false))</>}
  labels = {["static"]}>

Definition at line <a href="#l00069">69</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### UnrollThresholdFactor {#a87dfce8f7ae9d7942d55ac782438dbf8}

<MemberDefinition
  prototype={<>cl::opt&lt; double &gt; UnrollThresholdFactor(&quot;openmp-ir-builder-unroll-threshold-factor&quot;, cl::Hidden, cl::desc(&quot;Factor for the unroll threshold to account for code &quot; &quot;simplifications still taking place&quot;), cl::init(1.5))</>}
  labels = {["static"]}>

Definition at line <a href="#l00074">74</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Defines

### DEBUG&#95;TYPE {#ad78e062f62e0d6e453941fb4ca843e4d}

<MemberDefinition
  prototype={<>#define DEBUG&#95;TYPE&nbsp;&nbsp;&nbsp;&quot;openmp-<a href="/docs/api/files/lib/lib/ir/safepointirverifier-cpp/#a3d3459f5796b9b9f0253f71d5620e958">ir</a>-builder&quot;</>}>

Definition at line <a href="#l00063">63</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;ARRAY&#95;TYPE {#aafa57f1c2700b16129c83badeb165f9c}

<MemberDefinition
  prototype={<>#define OMP&#95;ARRAY&#95;TYPE&nbsp;&nbsp;&nbsp;  VarName##Ty = ArrayType::get(ElemTy, ArraySize);                             \\
  VarName##PtrTy = PointerType::getUnqual(Ctx);</>}>

Definition at line <a href="#l09184">9184</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;ATTRS&#95;SET {#a7a441e887365f90092c254b19e7bcfef}

<MemberDefinition
  prototype={<>#define OMP&#95;ATTRS&#95;SET&nbsp;&nbsp;&nbsp;AttributeSet VarName = AttrSet;</>}>

Definition at line <a href="#l00592">592</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;CANCEL&#95;KIND {#a6f431cf29bc502bb66b702e9d36dea91}

<MemberDefinition
  prototype={<>#define OMP&#95;CANCEL&#95;KIND&nbsp;&nbsp;&nbsp;  case DirectiveEnum:                                                          \\
    CancelKind = Builder.getInt32(Value);                                      \\
    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/asmprinter/ehstreamer-cpp/#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a>;</>}>

Definition at line <a href="#l01076">1076</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;FUNCTION&#95;TYPE {#ad08bb874382ad7ded92c133a57714c49}

<MemberDefinition
  prototype={<>#define OMP&#95;FUNCTION&#95;TYPE&nbsp;&nbsp;&nbsp;  VarName = FunctionType::get(ReturnType, &#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;, IsVarArg);            \\
  VarName##<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = PointerType::getUnqual(Ctx);</>}>

Definition at line <a href="#l09187">9187</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;RTL {#a02ddde535a0ac37557b1a1907c8de422}

<MemberDefinition
  prototype={<>#define OMP&#95;RTL&nbsp;&nbsp;&nbsp;  case Enum:                                                                   \\
    FnTy = FunctionType::get(ReturnType, ArrayRef&lt;Type &#42;&gt;&#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;,        \\
                             IsVarArg);                                        \\
    Fn = <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/evaluator-cpp/#a92efb02157b6836e1232c577d34678d6">M.getFunction</a>(Str);                                                   \\
    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/asmprinter/ehstreamer-cpp/#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a>;</>}>

Definition at line <a href="#l00619">619</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;RTL {#a8e0948ab2a7acb4aa9997fd1a5b8fbb7}

<MemberDefinition
  prototype={<>#define OMP&#95;RTL&nbsp;&nbsp;&nbsp;  case Enum:                                                                   \\
    Fn = Function::Create(FnTy, GlobalValue::ExternalLinkage, Str, M);         \\
    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/asmprinter/ehstreamer-cpp/#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a>;</>}>

Definition at line <a href="#l00631">631</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;RTL&#95;ATTRS {#afef4eeef2878c8a4a7ca0f8dd522141f}

<MemberDefinition
  prototype={<>#define OMP&#95;RTL&#95;ATTRS&nbsp;&nbsp;&nbsp;  case Enum:                                                                   \\
    FnAttrs = FnAttrs.addAttributes(Ctx, FnAttrSet);                           \\
    addAttrSet(RetAttrs, RetAttrSet, /&#42;Param&#42;/ false);                         \\
    <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a4cfc8b177e8521a4b496ae2edff6244f">for</a> (size&#95;t ArgNo = 0; ArgNo &lt; <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmreflect-cpp/#ac934769d93af95250952646a3829df4c">ArgAttrSets.size</a>(); ++ArgNo)                \\
      addAttrSet(ArgAttrs&#91;ArgNo&#93;, ArgAttrSets&#91;ArgNo&#93;);                         \\
    Fn.setAttributes(AttributeList::get(Ctx, FnAttrs, RetAttrs, ArgAttrs));    \\
    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/asmprinter/ehstreamer-cpp/#a91cf6fbebedd86150a36e5ac3d5d3bfc">break</a>;</>}>

Definition at line <a href="#l00597">597</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;STRUCT&#95;TYPE {#aab9e6bf3a40b4ccf0272542c0ce58d16}

<MemberDefinition
  prototype={<>#define OMP&#95;STRUCT&#95;TYPE&nbsp;&nbsp;&nbsp;  T = StructType::getTypeByName(Ctx, <a href="/docs/api/files/lib/lib/object/machouniversalwriter-cpp/#a26ecfcee41769620d62e904e7f142499">StructName</a>);                              \\
  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#acdfbcf188e2d4a80837e89de2ccdffab">if</a> (!T)                                                                      \\
    T = StructType::create(Ctx, &#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;, <a href="/docs/api/files/lib/lib/object/machouniversalwriter-cpp/#a26ecfcee41769620d62e904e7f142499">StructName</a>, Packed);            \\
  VarName = T;                                                                 \\
  VarName##<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = PointerType::getUnqual(Ctx);</>}>

Definition at line <a href="#l09190">9190</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

### OMP&#95;TYPE {#afd21bf6bbf67e4d7213a29ade471a8ee}

<MemberDefinition
  prototype={<>#define OMP&#95;TYPE&nbsp;&nbsp;&nbsp;VarName = InitValue;</>}>

Definition at line <a href="#l09183">9183</a> of file <a href="/docs/api/files/lib/lib/frontend/lib/frontend/openmp/ompirbuilder-cpp">OMPIRBuilder.cpp</a>.
</MemberDefinition>

</SectionDefinition>

## File Listing

The file content with the documentation metadata removed is:

<ProgramListing>

<Link id="l00001" /><CodeLine lineNumber="1"><Highlight kind="comment">//===- OpenMPIRBuilder.cpp - Builder for LLVM-IR for OpenMP directives ----===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00002" /><CodeLine lineNumber="2"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00003" /><CodeLine lineNumber="3"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00004" /><CodeLine lineNumber="4"><Highlight kind="normal"></Highlight><Highlight kind="comment">// See https://llvm.org/LICENSE.txt for license information.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00005" /><CodeLine lineNumber="5"><Highlight kind="normal"></Highlight><Highlight kind="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00006" /><CodeLine lineNumber="6"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00007" /><CodeLine lineNumber="7"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00008" /><CodeLine lineNumber="8"><Highlight kind="comment">/// \\file</Highlight></CodeLine>
<Link id="l00009" /><CodeLine lineNumber="9"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l00010" /><CodeLine lineNumber="10"><Highlight kind="comment">/// This file implements the OpenMPIRBuilder class, which is used as a</Highlight></CodeLine>
<Link id="l00011" /><CodeLine lineNumber="11"><Highlight kind="comment">/// convenient way to create LLVM instructions for OpenMP directives.</Highlight></CodeLine>
<Link id="l00012" /><CodeLine lineNumber="12"><Highlight kind="comment">///</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00013" /><CodeLine lineNumber="13"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00014" /><CodeLine lineNumber="14"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00015" /><CodeLine lineNumber="15"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/frontend/include/llvm/frontend/openmp/ompirbuilder-h">llvm/Frontend/OpenMP/OMPIRBuilder.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00016" /><CodeLine lineNumber="16"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallbitvector-h">llvm/ADT/SmallBitVector.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00017" /><CodeLine lineNumber="17"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallset-h">llvm/ADT/SmallSet.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00018" /><CodeLine lineNumber="18"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/stringextras-h">llvm/ADT/StringExtras.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00019" /><CodeLine lineNumber="19"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/stringref-h">llvm/ADT/StringRef.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00020" /><CodeLine lineNumber="20"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/assumptioncache-h">llvm/Analysis/AssumptionCache.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00021" /><CodeLine lineNumber="21"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/codemetrics-h">llvm/Analysis/CodeMetrics.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00022" /><CodeLine lineNumber="22"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/loopinfo-h">llvm/Analysis/LoopInfo.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00023" /><CodeLine lineNumber="23"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/optimizationremarkemitter-h">llvm/Analysis/OptimizationRemarkEmitter.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00024" /><CodeLine lineNumber="24"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolution-h">llvm/Analysis/ScalarEvolution.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00025" /><CodeLine lineNumber="25"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/targetlibraryinfo-h">llvm/Analysis/TargetLibraryInfo.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00026" /><CodeLine lineNumber="26"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/bitcode/bitcodereader-h">llvm/Bitcode/BitcodeReader.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00027" /><CodeLine lineNumber="27"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/frontend/include/llvm/frontend/offloading/utility-h">llvm/Frontend/Offloading/Utility.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00028" /><CodeLine lineNumber="28"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/frontend/include/llvm/frontend/openmp/ompgridvalues-h">llvm/Frontend/OpenMP/OMPGridValues.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00029" /><CodeLine lineNumber="29"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/attributes-h">llvm/IR/Attributes.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00030" /><CodeLine lineNumber="30"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/basicblock-h">llvm/IR/BasicBlock.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00031" /><CodeLine lineNumber="31"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/cfg-h">llvm/IR/CFG.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00032" /><CodeLine lineNumber="32"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/callingconv-h">llvm/IR/CallingConv.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00033" /><CodeLine lineNumber="33"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/constant-h">llvm/IR/Constant.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00034" /><CodeLine lineNumber="34"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/constants-h">llvm/IR/Constants.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00035" /><CodeLine lineNumber="35"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/dibuilder-h">llvm/IR/DIBuilder.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00036" /><CodeLine lineNumber="36"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/debuginfometadata-h">llvm/IR/DebugInfoMetadata.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00037" /><CodeLine lineNumber="37"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/derivedtypes-h">llvm/IR/DerivedTypes.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00038" /><CodeLine lineNumber="38"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/function-h">llvm/IR/Function.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00039" /><CodeLine lineNumber="39"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/globalvariable-h">llvm/IR/GlobalVariable.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00040" /><CodeLine lineNumber="40"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/irbuilder-h">llvm/IR/IRBuilder.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00041" /><CodeLine lineNumber="41"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/llvmcontext-h">llvm/IR/LLVMContext.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00042" /><CodeLine lineNumber="42"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/mdbuilder-h">llvm/IR/MDBuilder.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00043" /><CodeLine lineNumber="43"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/metadata-h">llvm/IR/Metadata.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00044" /><CodeLine lineNumber="44"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/passinstrumentation-h">llvm/IR/PassInstrumentation.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00045" /><CodeLine lineNumber="45"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/passmanager-h">llvm/IR/PassManager.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00046" /><CodeLine lineNumber="46"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/replaceconstant-h">llvm/IR/ReplaceConstant.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00047" /><CodeLine lineNumber="47"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/value-h">llvm/IR/Value.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00048" /><CodeLine lineNumber="48"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/mc/targetregistry-h">llvm/MC/TargetRegistry.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00049" /><CodeLine lineNumber="49"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h">llvm/Support/CommandLine.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00050" /><CodeLine lineNumber="50"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h">llvm/Support/ErrorHandling.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00051" /><CodeLine lineNumber="51"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/filesystem-h">llvm/Support/FileSystem.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00052" /><CodeLine lineNumber="52"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/target/targetmachine-h">llvm/Target/TargetMachine.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00053" /><CodeLine lineNumber="53"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/target/targetoptions-h">llvm/Target/TargetOptions.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00054" /><CodeLine lineNumber="54"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/basicblockutils-h">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00055" /><CodeLine lineNumber="55"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/cloning-h">llvm/Transforms/Utils/Cloning.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00056" /><CodeLine lineNumber="56"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/codeextractor-h">llvm/Transforms/Utils/CodeExtractor.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00057" /><CodeLine lineNumber="57"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/looppeel-h">llvm/Transforms/Utils/LoopPeel.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00058" /><CodeLine lineNumber="58"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/unrollloop-h">llvm/Transforms/Utils/UnrollLoop.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00059" /><CodeLine lineNumber="59"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00060" /><CodeLine lineNumber="60"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;cstdint&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00061" /><CodeLine lineNumber="61"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;optional&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00062" /><CodeLine lineNumber="62"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00063" /><CodeLine lineNumber="63" lineLink="#ad78e062f62e0d6e453941fb4ca843e4d"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define DEBUG&#95;TYPE &quot;openmp-ir-builder&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00064" /><CodeLine lineNumber="64"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00065" /><CodeLine lineNumber="65"><Highlight kind="normal"></Highlight><Highlight kind="keyword">using namespace </Highlight><Highlight kind="normal"><a href="/docs/api/namespaces/llvm">llvm</a>;</Highlight></CodeLine>
<Link id="l00066" /><CodeLine lineNumber="66"><Highlight kind="normal"></Highlight><Highlight kind="keyword">using namespace </Highlight><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/omp">omp</a>;</Highlight></CodeLine>
<Link id="l00067" /><CodeLine lineNumber="67"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00068" /><CodeLine lineNumber="68"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a></Highlight></CodeLine>
<Link id="l00069" /><CodeLine lineNumber="69" lineLink="#ac7b0d6b394df409e7550fb21aa7d9e5c"><Highlight kind="normal">    <a href="#ac7b0d6b394df409e7550fb21aa7d9e5c">OptimisticAttributes</a>(</Highlight><Highlight kind="stringliteral">&quot;openmp-ir-builder-optimistic-attributes&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</Highlight></CodeLine>
<Link id="l00070" /><CodeLine lineNumber="70"><Highlight kind="normal">                         <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Use optimistic attributes describing &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00071" /><CodeLine lineNumber="71"><Highlight kind="normal">                                  </Highlight><Highlight kind="stringliteral">&quot;&#39;as-if&#39; properties of runtime calls.&quot;</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00072" /><CodeLine lineNumber="72"><Highlight kind="normal">                         <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00073" /><CodeLine lineNumber="73"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00074" /><CodeLine lineNumber="74" lineLink="#a87dfce8f7ae9d7942d55ac782438dbf8"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;double&gt;</a> <a href="#a87dfce8f7ae9d7942d55ac782438dbf8">UnrollThresholdFactor</a>(</Highlight></CodeLine>
<Link id="l00075" /><CodeLine lineNumber="75"><Highlight kind="normal">    </Highlight><Highlight kind="stringliteral">&quot;openmp-ir-builder-unroll-threshold-factor&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</Highlight></CodeLine>
<Link id="l00076" /><CodeLine lineNumber="76"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Factor for the unroll threshold to account for code &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00077" /><CodeLine lineNumber="77"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;simplifications still taking place&quot;</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00078" /><CodeLine lineNumber="78"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(1.5));</Highlight></CodeLine>
<Link id="l00079" /><CodeLine lineNumber="79"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00080" /><CodeLine lineNumber="80"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00081" /><CodeLine lineNumber="81"><Highlight kind="comment">/// Return whether IP1 and IP2 are ambiguous, i.e. that inserting instructions</Highlight></CodeLine>
<Link id="l00082" /><CodeLine lineNumber="82"><Highlight kind="comment">/// at position IP1 may change the meaning of IP2 or vice-versa. This is because</Highlight></CodeLine>
<Link id="l00083" /><CodeLine lineNumber="83"><Highlight kind="comment">/// an InsertPoint stores the instruction before something is inserted. For</Highlight></CodeLine>
<Link id="l00084" /><CodeLine lineNumber="84"><Highlight kind="comment">/// instance, if both point to the same instruction, two IRBuilders alternating</Highlight></CodeLine>
<Link id="l00085" /><CodeLine lineNumber="85"><Highlight kind="comment">/// creating instruction will cause the instructions to be interleaved.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00086" /><CodeLine lineNumber="86" lineLink="#a756b28f370cd5a39bc0ee3e5333b9c9b"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a756b28f370cd5a39bc0ee3e5333b9c9b">isConflictIP</a>(<a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;::InsertPoint</a> IP1,</Highlight></CodeLine>
<Link id="l00087" /><CodeLine lineNumber="87"><Highlight kind="normal">                         <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;::InsertPoint</a> IP2) &#123;</Highlight></CodeLine>
<Link id="l00088" /><CodeLine lineNumber="88"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IP1.isSet() || !IP2.isSet())</Highlight></CodeLine>
<Link id="l00089" /><CodeLine lineNumber="89"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00090" /><CodeLine lineNumber="90"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IP1.getBlock() == IP2.getBlock() &amp;&amp; IP1.getPoint() == IP2.getPoint();</Highlight></CodeLine>
<Link id="l00091" /><CodeLine lineNumber="91"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00092" /><CodeLine lineNumber="92"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00093" /><CodeLine lineNumber="93" lineLink="#a596dcc3bb2ae8b7561e94095584e0f1e"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a596dcc3bb2ae8b7561e94095584e0f1e">isValidWorkshareLoopScheduleType</a>(<a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> SchedType) &#123;</Highlight></CodeLine>
<Link id="l00094" /><CodeLine lineNumber="94"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Valid ordered/unordered and base algorithm combinations.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00095" /><CodeLine lineNumber="95"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (SchedType &amp; ~OMPScheduleType::MonotonicityMask) &#123;</Highlight></CodeLine>
<Link id="l00096" /><CodeLine lineNumber="96"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedStaticChunked:</Highlight></CodeLine>
<Link id="l00097" /><CodeLine lineNumber="97"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedStatic:</Highlight></CodeLine>
<Link id="l00098" /><CodeLine lineNumber="98"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedDynamicChunked:</Highlight></CodeLine>
<Link id="l00099" /><CodeLine lineNumber="99"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedGuidedChunked:</Highlight></CodeLine>
<Link id="l00100" /><CodeLine lineNumber="100"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedRuntime:</Highlight></CodeLine>
<Link id="l00101" /><CodeLine lineNumber="101"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedAuto:</Highlight></CodeLine>
<Link id="l00102" /><CodeLine lineNumber="102"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedTrapezoidal:</Highlight></CodeLine>
<Link id="l00103" /><CodeLine lineNumber="103"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedGreedy:</Highlight></CodeLine>
<Link id="l00104" /><CodeLine lineNumber="104"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedBalanced:</Highlight></CodeLine>
<Link id="l00105" /><CodeLine lineNumber="105"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedGuidedIterativeChunked:</Highlight></CodeLine>
<Link id="l00106" /><CodeLine lineNumber="106"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedGuidedAnalyticalChunked:</Highlight></CodeLine>
<Link id="l00107" /><CodeLine lineNumber="107"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedSteal:</Highlight></CodeLine>
<Link id="l00108" /><CodeLine lineNumber="108"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedStaticBalancedChunked:</Highlight></CodeLine>
<Link id="l00109" /><CodeLine lineNumber="109"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedGuidedSimd:</Highlight></CodeLine>
<Link id="l00110" /><CodeLine lineNumber="110"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::UnorderedRuntimeSimd:</Highlight></CodeLine>
<Link id="l00111" /><CodeLine lineNumber="111"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::OrderedStaticChunked:</Highlight></CodeLine>
<Link id="l00112" /><CodeLine lineNumber="112"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::OrderedStatic:</Highlight></CodeLine>
<Link id="l00113" /><CodeLine lineNumber="113"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::OrderedDynamicChunked:</Highlight></CodeLine>
<Link id="l00114" /><CodeLine lineNumber="114"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::OrderedGuidedChunked:</Highlight></CodeLine>
<Link id="l00115" /><CodeLine lineNumber="115"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::OrderedRuntime:</Highlight></CodeLine>
<Link id="l00116" /><CodeLine lineNumber="116"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::OrderedAuto:</Highlight></CodeLine>
<Link id="l00117" /><CodeLine lineNumber="117"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::OrderdTrapezoidal:</Highlight></CodeLine>
<Link id="l00118" /><CodeLine lineNumber="118"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedStaticChunked:</Highlight></CodeLine>
<Link id="l00119" /><CodeLine lineNumber="119"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedStatic:</Highlight></CodeLine>
<Link id="l00120" /><CodeLine lineNumber="120"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedDynamicChunked:</Highlight></CodeLine>
<Link id="l00121" /><CodeLine lineNumber="121"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedGuidedChunked:</Highlight></CodeLine>
<Link id="l00122" /><CodeLine lineNumber="122"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedRuntime:</Highlight></CodeLine>
<Link id="l00123" /><CodeLine lineNumber="123"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedAuto:</Highlight></CodeLine>
<Link id="l00124" /><CodeLine lineNumber="124"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedTrapezoidal:</Highlight></CodeLine>
<Link id="l00125" /><CodeLine lineNumber="125"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedGreedy:</Highlight></CodeLine>
<Link id="l00126" /><CodeLine lineNumber="126"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedBalanced:</Highlight></CodeLine>
<Link id="l00127" /><CodeLine lineNumber="127"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedGuidedIterativeChunked:</Highlight></CodeLine>
<Link id="l00128" /><CodeLine lineNumber="128"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedGuidedAnalyticalChunked:</Highlight></CodeLine>
<Link id="l00129" /><CodeLine lineNumber="129"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeUnorderedSteal:</Highlight></CodeLine>
<Link id="l00130" /><CodeLine lineNumber="130"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeOrderedStaticChunked:</Highlight></CodeLine>
<Link id="l00131" /><CodeLine lineNumber="131"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeOrderedStatic:</Highlight></CodeLine>
<Link id="l00132" /><CodeLine lineNumber="132"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeOrderedDynamicChunked:</Highlight></CodeLine>
<Link id="l00133" /><CodeLine lineNumber="133"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeOrderedGuidedChunked:</Highlight></CodeLine>
<Link id="l00134" /><CodeLine lineNumber="134"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeOrderedRuntime:</Highlight></CodeLine>
<Link id="l00135" /><CodeLine lineNumber="135"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeOrderedAuto:</Highlight></CodeLine>
<Link id="l00136" /><CodeLine lineNumber="136"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::NomergeOrderedTrapezoidal:</Highlight></CodeLine>
<Link id="l00137" /><CodeLine lineNumber="137"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00138" /><CodeLine lineNumber="138"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l00139" /><CodeLine lineNumber="139"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00140" /><CodeLine lineNumber="140"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00141" /><CodeLine lineNumber="141"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00142" /><CodeLine lineNumber="142"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Must not set both monotonicity modifiers at the same time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00143" /><CodeLine lineNumber="143"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> MonotonicityFlags =</Highlight></CodeLine>
<Link id="l00144" /><CodeLine lineNumber="144"><Highlight kind="normal">      SchedType &amp; OMPScheduleType::MonotonicityMask;</Highlight></CodeLine>
<Link id="l00145" /><CodeLine lineNumber="145"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (MonotonicityFlags == OMPScheduleType::MonotonicityMask)</Highlight></CodeLine>
<Link id="l00146" /><CodeLine lineNumber="146"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00147" /><CodeLine lineNumber="147"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00148" /><CodeLine lineNumber="148"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00149" /><CodeLine lineNumber="149"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00150" /><CodeLine lineNumber="150"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00151" /><CodeLine lineNumber="151"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00152" /><CodeLine lineNumber="152" lineLink="#ad52342fdd467389643191fdac7abcd40"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/omp/gv">omp::GV</a> &amp;<a href="#ad52342fdd467389643191fdac7abcd40">getGridValue</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/triple">Triple</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>) &#123;</Highlight></CodeLine>
<Link id="l00153" /><CodeLine lineNumber="153"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isAMDGPU()) &#123;</Highlight></CodeLine>
<Link id="l00154" /><CodeLine lineNumber="154"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/stringref">StringRef</a> Features =</Highlight></CodeLine>
<Link id="l00155" /><CodeLine lineNumber="155"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>-&gt;getFnAttribute(</Highlight><Highlight kind="stringliteral">&quot;target-features&quot;</Highlight><Highlight kind="normal">).getValueAsString();</Highlight></CodeLine>
<Link id="l00156" /><CodeLine lineNumber="156"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Features.<a href="/docs/api/classes/llvm/stringref/#ac2c31b7b3c778d12aa176f9253511f37">count</a>(</Highlight><Highlight kind="stringliteral">&quot;+wavefrontsize64&quot;</Highlight><Highlight kind="normal">))</Highlight></CodeLine>
<Link id="l00157" /><CodeLine lineNumber="157"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/omp/#a54d82933792ec7eef3f24eb847c6acd9">omp::getAMDGPUGridValues&lt;64&gt;</a>();</Highlight></CodeLine>
<Link id="l00158" /><CodeLine lineNumber="158"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/omp/#a54d82933792ec7eef3f24eb847c6acd9">omp::getAMDGPUGridValues&lt;32&gt;</a>();</Highlight></CodeLine>
<Link id="l00159" /><CodeLine lineNumber="159"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00160" /><CodeLine lineNumber="160"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isNVPTX())</Highlight></CodeLine>
<Link id="l00161" /><CodeLine lineNumber="161"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/omp/#a82196e4d5e3224c1cdd60f16e40af476">omp::NVPTXGridValues</a>;</Highlight></CodeLine>
<Link id="l00162" /><CodeLine lineNumber="162"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;No grid value available for this architecture!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00163" /><CodeLine lineNumber="163"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00164" /><CodeLine lineNumber="164"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00165" /><CodeLine lineNumber="165"><Highlight kind="comment">/// Determine which scheduling algorithm to use, determined from schedule clause</Highlight></CodeLine>
<Link id="l00166" /><CodeLine lineNumber="166"><Highlight kind="comment">/// arguments.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00167" /><CodeLine lineNumber="167"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a></Highlight></CodeLine>
<Link id="l00168" /><CodeLine lineNumber="168" lineLink="#a065b0b31e5ca4c10b1cef45581efb8dc"><Highlight kind="normal"><a href="#a065b0b31e5ca4c10b1cef45581efb8dc">getOpenMPBaseScheduleType</a>(llvm::omp::ScheduleKind ClauseKind, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasChunks,</Highlight></CodeLine>
<Link id="l00169" /><CodeLine lineNumber="169"><Highlight kind="normal">                          </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasSimdModifier) &#123;</Highlight></CodeLine>
<Link id="l00170" /><CodeLine lineNumber="170"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Currently, the default schedule it static.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00171" /><CodeLine lineNumber="171"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (ClauseKind) &#123;</Highlight></CodeLine>
<Link id="l00172" /><CodeLine lineNumber="172"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMP&#95;SCHEDULE&#95;Default:</Highlight></CodeLine>
<Link id="l00173" /><CodeLine lineNumber="173"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMP&#95;SCHEDULE&#95;Static:</Highlight></CodeLine>
<Link id="l00174" /><CodeLine lineNumber="174"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> HasChunks ? OMPScheduleType::BaseStaticChunked</Highlight></CodeLine>
<Link id="l00175" /><CodeLine lineNumber="175"><Highlight kind="normal">                     : OMPScheduleType::BaseStatic;</Highlight></CodeLine>
<Link id="l00176" /><CodeLine lineNumber="176"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMP&#95;SCHEDULE&#95;Dynamic:</Highlight></CodeLine>
<Link id="l00177" /><CodeLine lineNumber="177"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPScheduleType::BaseDynamicChunked;</Highlight></CodeLine>
<Link id="l00178" /><CodeLine lineNumber="178"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMP&#95;SCHEDULE&#95;Guided:</Highlight></CodeLine>
<Link id="l00179" /><CodeLine lineNumber="179"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> HasSimdModifier ? OMPScheduleType::BaseGuidedSimd</Highlight></CodeLine>
<Link id="l00180" /><CodeLine lineNumber="180"><Highlight kind="normal">                           : OMPScheduleType::BaseGuidedChunked;</Highlight></CodeLine>
<Link id="l00181" /><CodeLine lineNumber="181"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMP&#95;SCHEDULE&#95;Auto:</Highlight></CodeLine>
<Link id="l00182" /><CodeLine lineNumber="182"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7a377f624764cdf5386a71e8efa9a1033d">llvm::omp::OMPScheduleType::BaseAuto</a>;</Highlight></CodeLine>
<Link id="l00183" /><CodeLine lineNumber="183"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMP&#95;SCHEDULE&#95;Runtime:</Highlight></CodeLine>
<Link id="l00184" /><CodeLine lineNumber="184"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> HasSimdModifier ? OMPScheduleType::BaseRuntimeSimd</Highlight></CodeLine>
<Link id="l00185" /><CodeLine lineNumber="185"><Highlight kind="normal">                           : OMPScheduleType::BaseRuntime;</Highlight></CodeLine>
<Link id="l00186" /><CodeLine lineNumber="186"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00187" /><CodeLine lineNumber="187"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;unhandled schedule clause argument&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00188" /><CodeLine lineNumber="188"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00189" /><CodeLine lineNumber="189"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00190" /><CodeLine lineNumber="190"><Highlight kind="comment">/// Adds ordering modifier flags to schedule type.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00191" /><CodeLine lineNumber="191"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a></Highlight></CodeLine>
<Link id="l00192" /><CodeLine lineNumber="192" lineLink="#a4a87dd5af95eb64807ad77405e4f4654"><Highlight kind="normal"><a href="#a4a87dd5af95eb64807ad77405e4f4654">getOpenMPOrderingScheduleType</a>(<a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> BaseScheduleType,</Highlight></CodeLine>
<Link id="l00193" /><CodeLine lineNumber="193"><Highlight kind="normal">                              </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasOrderedClause) &#123;</Highlight></CodeLine>
<Link id="l00194" /><CodeLine lineNumber="194"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((BaseScheduleType &amp; OMPScheduleType::ModifierMask) ==</Highlight></CodeLine>
<Link id="l00195" /><CodeLine lineNumber="195"><Highlight kind="normal">             OMPScheduleType::None &amp;&amp;</Highlight></CodeLine>
<Link id="l00196" /><CodeLine lineNumber="196"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Must not have ordering nor monotonicity flags already set&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00197" /><CodeLine lineNumber="197"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00198" /><CodeLine lineNumber="198"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> OrderingModifier = HasOrderedClause</Highlight></CodeLine>
<Link id="l00199" /><CodeLine lineNumber="199"><Highlight kind="normal">                                         ? OMPScheduleType::ModifierOrdered</Highlight></CodeLine>
<Link id="l00200" /><CodeLine lineNumber="200"><Highlight kind="normal">                                         : OMPScheduleType::ModifierUnordered;</Highlight></CodeLine>
<Link id="l00201" /><CodeLine lineNumber="201"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> OrderingScheduleType = BaseScheduleType | OrderingModifier;</Highlight></CodeLine>
<Link id="l00202" /><CodeLine lineNumber="202"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00203" /><CodeLine lineNumber="203"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Unsupported combinations</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00204" /><CodeLine lineNumber="204"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OrderingScheduleType ==</Highlight></CodeLine>
<Link id="l00205" /><CodeLine lineNumber="205"><Highlight kind="normal">      (OMPScheduleType::BaseGuidedSimd | OMPScheduleType::ModifierOrdered))</Highlight></CodeLine>
<Link id="l00206" /><CodeLine lineNumber="206"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPScheduleType::OrderedGuidedChunked;</Highlight></CodeLine>
<Link id="l00207" /><CodeLine lineNumber="207"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OrderingScheduleType == (OMPScheduleType::BaseRuntimeSimd |</Highlight></CodeLine>
<Link id="l00208" /><CodeLine lineNumber="208"><Highlight kind="normal">                                    OMPScheduleType::ModifierOrdered))</Highlight></CodeLine>
<Link id="l00209" /><CodeLine lineNumber="209"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPScheduleType::OrderedRuntime;</Highlight></CodeLine>
<Link id="l00210" /><CodeLine lineNumber="210"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00211" /><CodeLine lineNumber="211"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OrderingScheduleType;</Highlight></CodeLine>
<Link id="l00212" /><CodeLine lineNumber="212"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00213" /><CodeLine lineNumber="213"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00214" /><CodeLine lineNumber="214"><Highlight kind="comment">/// Adds monotonicity modifier flags to schedule type.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00215" /><CodeLine lineNumber="215"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a></Highlight></CodeLine>
<Link id="l00216" /><CodeLine lineNumber="216" lineLink="#a4b64de5bc0d090cc76ddb989acabf0f3"><Highlight kind="normal"><a href="#a4b64de5bc0d090cc76ddb989acabf0f3">getOpenMPMonotonicityScheduleType</a>(<a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> ScheduleType,</Highlight></CodeLine>
<Link id="l00217" /><CodeLine lineNumber="217"><Highlight kind="normal">                                  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasSimdModifier, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasMonotonic,</Highlight></CodeLine>
<Link id="l00218" /><CodeLine lineNumber="218"><Highlight kind="normal">                                  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasNonmonotonic, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasOrderedClause) &#123;</Highlight></CodeLine>
<Link id="l00219" /><CodeLine lineNumber="219"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((ScheduleType &amp; OMPScheduleType::MonotonicityMask) ==</Highlight></CodeLine>
<Link id="l00220" /><CodeLine lineNumber="220"><Highlight kind="normal">             OMPScheduleType::None &amp;&amp;</Highlight></CodeLine>
<Link id="l00221" /><CodeLine lineNumber="221"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Must not have monotonicity flags already set&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00222" /><CodeLine lineNumber="222"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!HasMonotonic || !HasNonmonotonic) &amp;&amp;</Highlight></CodeLine>
<Link id="l00223" /><CodeLine lineNumber="223"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Monotonic and Nonmonotonic are contradicting each other&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00224" /><CodeLine lineNumber="224"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00225" /><CodeLine lineNumber="225"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasMonotonic) &#123;</Highlight></CodeLine>
<Link id="l00226" /><CodeLine lineNumber="226"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ScheduleType | OMPScheduleType::ModifierMonotonic;</Highlight></CodeLine>
<Link id="l00227" /><CodeLine lineNumber="227"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasNonmonotonic) &#123;</Highlight></CodeLine>
<Link id="l00228" /><CodeLine lineNumber="228"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ScheduleType | OMPScheduleType::ModifierNonmonotonic;</Highlight></CodeLine>
<Link id="l00229" /><CodeLine lineNumber="229"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00230" /><CodeLine lineNumber="230"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// OpenMP 5.1, 2.11.4 Worksharing-Loop Construct, Description.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00231" /><CodeLine lineNumber="231"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If the static schedule kind is specified or if the ordered clause is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00232" /><CodeLine lineNumber="232"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// specified, and if the nonmonotonic modifier is not specified, the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00233" /><CodeLine lineNumber="233"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// effect is as if the monotonic modifier is specified. Otherwise, unless</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00234" /><CodeLine lineNumber="234"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the monotonic modifier is specified, the effect is as if the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00235" /><CodeLine lineNumber="235"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// nonmonotonic modifier is specified.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00236" /><CodeLine lineNumber="236"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> BaseScheduleType =</Highlight></CodeLine>
<Link id="l00237" /><CodeLine lineNumber="237"><Highlight kind="normal">        ScheduleType &amp; <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">~OMPScheduleType</a><a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7a4aabfa64277fa15805937e3812fa1161">::ModifierMask</a>;</Highlight></CodeLine>
<Link id="l00238" /><CodeLine lineNumber="238"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((BaseScheduleType == OMPScheduleType::BaseStatic) ||</Highlight></CodeLine>
<Link id="l00239" /><CodeLine lineNumber="239"><Highlight kind="normal">        (BaseScheduleType == OMPScheduleType::BaseStaticChunked) ||</Highlight></CodeLine>
<Link id="l00240" /><CodeLine lineNumber="240"><Highlight kind="normal">        HasOrderedClause) &#123;</Highlight></CodeLine>
<Link id="l00241" /><CodeLine lineNumber="241"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// The monotonic is used by default in openmp runtime library, so no need</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00242" /><CodeLine lineNumber="242"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// to set it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00243" /><CodeLine lineNumber="243"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ScheduleType;</Highlight></CodeLine>
<Link id="l00244" /><CodeLine lineNumber="244"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00245" /><CodeLine lineNumber="245"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ScheduleType | OMPScheduleType::ModifierNonmonotonic;</Highlight></CodeLine>
<Link id="l00246" /><CodeLine lineNumber="246"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00247" /><CodeLine lineNumber="247"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00248" /><CodeLine lineNumber="248"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00249" /><CodeLine lineNumber="249"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00250" /><CodeLine lineNumber="250"><Highlight kind="comment">/// Determine the schedule type using schedule and ordering clause arguments.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00251" /><CodeLine lineNumber="251"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a></Highlight></CodeLine>
<Link id="l00252" /><CodeLine lineNumber="252" lineLink="#a554000c782275642b783964853720bee"><Highlight kind="normal"><a href="#a554000c782275642b783964853720bee">computeOpenMPScheduleType</a>(ScheduleKind ClauseKind, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasChunks,</Highlight></CodeLine>
<Link id="l00253" /><CodeLine lineNumber="253"><Highlight kind="normal">                          </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasSimdModifier, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasMonotonicModifier,</Highlight></CodeLine>
<Link id="l00254" /><CodeLine lineNumber="254"><Highlight kind="normal">                          </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasNonmonotonicModifier, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasOrderedClause) &#123;</Highlight></CodeLine>
<Link id="l00255" /><CodeLine lineNumber="255"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> BaseSchedule =</Highlight></CodeLine>
<Link id="l00256" /><CodeLine lineNumber="256"><Highlight kind="normal">      <a href="#a065b0b31e5ca4c10b1cef45581efb8dc">getOpenMPBaseScheduleType</a>(ClauseKind, HasChunks, HasSimdModifier);</Highlight></CodeLine>
<Link id="l00257" /><CodeLine lineNumber="257"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> OrderedSchedule =</Highlight></CodeLine>
<Link id="l00258" /><CodeLine lineNumber="258"><Highlight kind="normal">      <a href="#a4a87dd5af95eb64807ad77405e4f4654">getOpenMPOrderingScheduleType</a>(BaseSchedule, HasOrderedClause);</Highlight></CodeLine>
<Link id="l00259" /><CodeLine lineNumber="259"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> Result = <a href="#a4b64de5bc0d090cc76ddb989acabf0f3">getOpenMPMonotonicityScheduleType</a>(</Highlight></CodeLine>
<Link id="l00260" /><CodeLine lineNumber="260"><Highlight kind="normal">      OrderedSchedule, HasSimdModifier, HasMonotonicModifier,</Highlight></CodeLine>
<Link id="l00261" /><CodeLine lineNumber="261"><Highlight kind="normal">      HasNonmonotonicModifier, HasOrderedClause);</Highlight></CodeLine>
<Link id="l00262" /><CodeLine lineNumber="262"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00263" /><CodeLine lineNumber="263"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a596dcc3bb2ae8b7561e94095584e0f1e">isValidWorkshareLoopScheduleType</a>(Result));</Highlight></CodeLine>
<Link id="l00264" /><CodeLine lineNumber="264"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Result;</Highlight></CodeLine>
<Link id="l00265" /><CodeLine lineNumber="265"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00266" /><CodeLine lineNumber="266"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00267" /><CodeLine lineNumber="267"><Highlight kind="comment">/// Emit an implicit cast to convert \\p XRead to type of variable \\p V</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00268" /><CodeLine lineNumber="268" lineLink="#a91b7eb2a05d10c788413bec7977f3474"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;<a href="#a91b7eb2a05d10c788413bec7977f3474">emitImplicitCast</a>(<a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> &amp;Builder, <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;XRead,</Highlight></CodeLine>
<Link id="l00269" /><CodeLine lineNumber="269"><Highlight kind="normal">                                     <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;V) &#123;</Highlight></CodeLine>
<Link id="l00270" /><CodeLine lineNumber="270"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Add this functionality to the &#96;AtomicInfo&#96; interface</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00271" /><CodeLine lineNumber="271"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">llvm::Type</a> &#42;XReadType = XRead-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l00272" /><CodeLine lineNumber="272"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">llvm::Type</a> &#42;VType = V-&gt;getType();</Highlight></CodeLine>
<Link id="l00273" /><CodeLine lineNumber="273"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/allocainst">llvm::AllocaInst</a> &#42;vAlloca = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;llvm::AllocaInst&gt;</a>(V))</Highlight></CodeLine>
<Link id="l00274" /><CodeLine lineNumber="274"><Highlight kind="normal">    VType = vAlloca-&gt;getAllocatedType();</Highlight></CodeLine>
<Link id="l00275" /><CodeLine lineNumber="275"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00276" /><CodeLine lineNumber="276"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (XReadType-&gt;<a href="/docs/api/classes/llvm/type/#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>() &amp;&amp; VType-&gt;<a href="/docs/api/classes/llvm/type/#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>())</Highlight></CodeLine>
<Link id="l00277" /><CodeLine lineNumber="277"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// No need to extract or convert. A direct</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00278" /><CodeLine lineNumber="278"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// &#96;store&#96; will suffice.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00279" /><CodeLine lineNumber="279"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> XRead;</Highlight></CodeLine>
<Link id="l00280" /><CodeLine lineNumber="280"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00281" /><CodeLine lineNumber="281"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (XReadType-&gt;<a href="/docs/api/classes/llvm/type/#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>())</Highlight></CodeLine>
<Link id="l00282" /><CodeLine lineNumber="282"><Highlight kind="normal">    XRead = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a41cf66866b0b0e5a10038bfb77477419">CreateExtractValue</a>(XRead, </Highlight><Highlight kind="comment">/&#42;Idxs=&#42;/</Highlight><Highlight kind="normal">0);</Highlight></CodeLine>
<Link id="l00283" /><CodeLine lineNumber="283"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (VType-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp; XReadType-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>())</Highlight></CodeLine>
<Link id="l00284" /><CodeLine lineNumber="284"><Highlight kind="normal">    XRead = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#afd0b5a07710757874fa84076969537b0">CreateFPToSI</a>(XRead, VType);</Highlight></CodeLine>
<Link id="l00285" /><CodeLine lineNumber="285"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (VType-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>() &amp;&amp; XReadType-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</Highlight></CodeLine>
<Link id="l00286" /><CodeLine lineNumber="286"><Highlight kind="normal">    XRead = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a2e19b7738daed96724457c786521e5e1">CreateSIToFP</a>(XRead, VType);</Highlight></CodeLine>
<Link id="l00287" /><CodeLine lineNumber="287"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (VType-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp; XReadType-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>())</Highlight></CodeLine>
<Link id="l00288" /><CodeLine lineNumber="288"><Highlight kind="normal">    XRead = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac79ca3c2d2d74cf33684397a91846564">CreateIntCast</a>(XRead, VType, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00289" /><CodeLine lineNumber="289"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (VType-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>() &amp;&amp; XReadType-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>())</Highlight></CodeLine>
<Link id="l00290" /><CodeLine lineNumber="290"><Highlight kind="normal">    XRead = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a85da0abb1e43779210427c14a9bd9311">CreateFPCast</a>(XRead, VType);</Highlight></CodeLine>
<Link id="l00291" /><CodeLine lineNumber="291"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> XRead;</Highlight></CodeLine>
<Link id="l00292" /><CodeLine lineNumber="292"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00293" /><CodeLine lineNumber="293"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00294" /><CodeLine lineNumber="294"><Highlight kind="comment">/// Make \\p Source branch to \\p Target.</Highlight></CodeLine>
<Link id="l00295" /><CodeLine lineNumber="295"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l00296" /><CodeLine lineNumber="296"><Highlight kind="comment">/// Handles two situations:</Highlight></CodeLine>
<Link id="l00297" /><CodeLine lineNumber="297"><Highlight kind="comment">/// &#42; \\p Source already has an unconditional branch.</Highlight></CodeLine>
<Link id="l00298" /><CodeLine lineNumber="298"><Highlight kind="comment">/// &#42; \\p Source is a degenerate block (no terminator because the BB is</Highlight></CodeLine>
<Link id="l00299" /><CodeLine lineNumber="299"><Highlight kind="comment">///             the current head of the IR construction).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00300" /><CodeLine lineNumber="300" lineLink="#a3057c2b7e1e25de160497b1ef3985c2a"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Source, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/classes/llvm/target">Target</a>, <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>) &#123;</Highlight></CodeLine>
<Link id="l00301" /><CodeLine lineNumber="301"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Term = Source-&gt;getTerminator()) &#123;</Highlight></CodeLine>
<Link id="l00302" /><CodeLine lineNumber="302"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Br = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BranchInst&gt;</a>(Term);</Highlight></CodeLine>
<Link id="l00303" /><CodeLine lineNumber="303"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Br-&gt;isConditional() &amp;&amp;</Highlight></CodeLine>
<Link id="l00304" /><CodeLine lineNumber="304"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;BB&#39;s terminator must be an unconditional branch (or degenerate)&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00305" /><CodeLine lineNumber="305"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Succ = Br-&gt;getSuccessor(0);</Highlight></CodeLine>
<Link id="l00306" /><CodeLine lineNumber="306"><Highlight kind="normal">    Succ-&gt;<a href="/docs/api/classes/llvm/basicblock/#afe7af0c3ec2ef1f525173acd2ea4ba60">removePredecessor</a>(Source, </Highlight><Highlight kind="comment">/&#42;KeepOneInputPHIs=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00307" /><CodeLine lineNumber="307"><Highlight kind="normal">    Br-&gt;setSuccessor(0, <a href="/docs/api/classes/llvm/target">Target</a>);</Highlight></CodeLine>
<Link id="l00308" /><CodeLine lineNumber="308"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00309" /><CodeLine lineNumber="309"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00310" /><CodeLine lineNumber="310"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00311" /><CodeLine lineNumber="311"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;NewBr = <a href="/docs/api/classes/llvm/branchinst/#a9f40e42226cee617c16cb1c447b115c5">BranchInst::Create</a>(<a href="/docs/api/classes/llvm/target">Target</a>, Source);</Highlight></CodeLine>
<Link id="l00312" /><CodeLine lineNumber="312"><Highlight kind="normal">  NewBr-&gt;setDebugLoc(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l00313" /><CodeLine lineNumber="313"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00314" /><CodeLine lineNumber="314"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00315" /><CodeLine lineNumber="315" lineLink="/docs/api/namespaces/llvm/#a78e14f66d8a8405c6882b5ff6a3b7617"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a78e14f66d8a8405c6882b5ff6a3b7617">llvm::spliceBB</a>(<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint">IRBuilderBase::InsertPoint</a> IP, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;New,</Highlight></CodeLine>
<Link id="l00316" /><CodeLine lineNumber="316"><Highlight kind="normal">                    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> CreateBranch) &#123;</Highlight></CodeLine>
<Link id="l00317" /><CodeLine lineNumber="317"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(New-&gt;getFirstInsertionPt() == New-&gt;begin() &amp;&amp;</Highlight></CodeLine>
<Link id="l00318" /><CodeLine lineNumber="318"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Target BB must not have PHI nodes&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00319" /><CodeLine lineNumber="319"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00320" /><CodeLine lineNumber="320"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Move instructions to new block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00321" /><CodeLine lineNumber="321"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Old = IP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a3d072f8ac5e1b0724c4bb5a77adae9da">getBlock</a>();</Highlight></CodeLine>
<Link id="l00322" /><CodeLine lineNumber="322"><Highlight kind="normal">  New-&gt;splice(New-&gt;begin(), Old, IP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#add3c04c7d2a93c82846f7bea3ce2fe16">getPoint</a>(), Old-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>());</Highlight></CodeLine>
<Link id="l00323" /><CodeLine lineNumber="323"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00324" /><CodeLine lineNumber="324"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CreateBranch)</Highlight></CodeLine>
<Link id="l00325" /><CodeLine lineNumber="325"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/branchinst/#a9f40e42226cee617c16cb1c447b115c5">BranchInst::Create</a>(New, Old);</Highlight></CodeLine>
<Link id="l00326" /><CodeLine lineNumber="326"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00327" /><CodeLine lineNumber="327"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00328" /><CodeLine lineNumber="328" lineLink="/docs/api/namespaces/llvm/#afae3b747fc0c20f869df931130c534fa"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a78e14f66d8a8405c6882b5ff6a3b7617">llvm::spliceBB</a>(<a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> &amp;Builder, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;New, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> CreateBranch) &#123;</Highlight></CodeLine>
<Link id="l00329" /><CodeLine lineNumber="329"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a90a3242eeb2a7d1afbb5ab5bc5bfb20d">getCurrentDebugLocation</a>();</Highlight></CodeLine>
<Link id="l00330" /><CodeLine lineNumber="330"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Old = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l00331" /><CodeLine lineNumber="331"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00332" /><CodeLine lineNumber="332"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a78e14f66d8a8405c6882b5ff6a3b7617">spliceBB</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), New, CreateBranch);</Highlight></CodeLine>
<Link id="l00333" /><CodeLine lineNumber="333"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CreateBranch)</Highlight></CodeLine>
<Link id="l00334" /><CodeLine lineNumber="334"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Old-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l00335" /><CodeLine lineNumber="335"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00336" /><CodeLine lineNumber="336"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Old);</Highlight></CodeLine>
<Link id="l00337" /><CodeLine lineNumber="337"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00338" /><CodeLine lineNumber="338"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// SetInsertPoint also updates the Builder&#39;s debug location, but we want to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00339" /><CodeLine lineNumber="339"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// keep the one the Builder was configured to use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00340" /><CodeLine lineNumber="340"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a>);</Highlight></CodeLine>
<Link id="l00341" /><CodeLine lineNumber="341"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00342" /><CodeLine lineNumber="342"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00343" /><CodeLine lineNumber="343" lineLink="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2"><Highlight kind="normal"><a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">llvm::splitBB</a>(<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint">IRBuilderBase::InsertPoint</a> IP, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> CreateBranch,</Highlight></CodeLine>
<Link id="l00344" /><CodeLine lineNumber="344"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/twine">llvm::Twine</a> Name) &#123;</Highlight></CodeLine>
<Link id="l00345" /><CodeLine lineNumber="345"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Old = IP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a3d072f8ac5e1b0724c4bb5a77adae9da">getBlock</a>();</Highlight></CodeLine>
<Link id="l00346" /><CodeLine lineNumber="346"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;New = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l00347" /><CodeLine lineNumber="347"><Highlight kind="normal">      Old-&gt;<a href="/docs/api/classes/llvm/basicblock/#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(), Name.isTriviallyEmpty() ? Old-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : Name,</Highlight></CodeLine>
<Link id="l00348" /><CodeLine lineNumber="348"><Highlight kind="normal">      Old-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>(), Old-&gt;<a href="/docs/api/classes/llvm/ilist-node-with-parent/#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>());</Highlight></CodeLine>
<Link id="l00349" /><CodeLine lineNumber="349"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a78e14f66d8a8405c6882b5ff6a3b7617">spliceBB</a>(IP, New, CreateBranch);</Highlight></CodeLine>
<Link id="l00350" /><CodeLine lineNumber="350"><Highlight kind="normal">  New-&gt;replaceSuccessorsPhiUsesWith(Old, New);</Highlight></CodeLine>
<Link id="l00351" /><CodeLine lineNumber="351"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> New;</Highlight></CodeLine>
<Link id="l00352" /><CodeLine lineNumber="352"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00353" /><CodeLine lineNumber="353"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00354" /><CodeLine lineNumber="354" lineLink="/docs/api/namespaces/llvm/#a7e8bd8939aed271b684b21231da918ee"><Highlight kind="normal"><a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">llvm::splitBB</a>(<a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> CreateBranch,</Highlight></CodeLine>
<Link id="l00355" /><CodeLine lineNumber="355"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/twine">llvm::Twine</a> Name) &#123;</Highlight></CodeLine>
<Link id="l00356" /><CodeLine lineNumber="356"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a90a3242eeb2a7d1afbb5ab5bc5bfb20d">getCurrentDebugLocation</a>();</Highlight></CodeLine>
<Link id="l00357" /><CodeLine lineNumber="357"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;New = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), CreateBranch, Name);</Highlight></CodeLine>
<Link id="l00358" /><CodeLine lineNumber="358"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CreateBranch)</Highlight></CodeLine>
<Link id="l00359" /><CodeLine lineNumber="359"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l00360" /><CodeLine lineNumber="360"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00361" /><CodeLine lineNumber="361"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>());</Highlight></CodeLine>
<Link id="l00362" /><CodeLine lineNumber="362"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// SetInsertPoint also updates the Builder&#39;s debug location, but we want to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00363" /><CodeLine lineNumber="363"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// keep the one the Builder was configured to use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00364" /><CodeLine lineNumber="364"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a>);</Highlight></CodeLine>
<Link id="l00365" /><CodeLine lineNumber="365"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> New;</Highlight></CodeLine>
<Link id="l00366" /><CodeLine lineNumber="366"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00367" /><CodeLine lineNumber="367"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00368" /><CodeLine lineNumber="368" lineLink="/docs/api/namespaces/llvm/#a2522258b740c5c76b6f9354663773c7c"><Highlight kind="normal"><a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">llvm::splitBB</a>(<a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> &amp;Builder, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> CreateBranch,</Highlight></CodeLine>
<Link id="l00369" /><CodeLine lineNumber="369"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/twine">llvm::Twine</a> Name) &#123;</Highlight></CodeLine>
<Link id="l00370" /><CodeLine lineNumber="370"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a90a3242eeb2a7d1afbb5ab5bc5bfb20d">getCurrentDebugLocation</a>();</Highlight></CodeLine>
<Link id="l00371" /><CodeLine lineNumber="371"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;New = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), CreateBranch, Name);</Highlight></CodeLine>
<Link id="l00372" /><CodeLine lineNumber="372"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CreateBranch)</Highlight></CodeLine>
<Link id="l00373" /><CodeLine lineNumber="373"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l00374" /><CodeLine lineNumber="374"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00375" /><CodeLine lineNumber="375"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>());</Highlight></CodeLine>
<Link id="l00376" /><CodeLine lineNumber="376"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// SetInsertPoint also updates the Builder&#39;s debug location, but we want to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00377" /><CodeLine lineNumber="377"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// keep the one the Builder was configured to use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00378" /><CodeLine lineNumber="378"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a>);</Highlight></CodeLine>
<Link id="l00379" /><CodeLine lineNumber="379"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> New;</Highlight></CodeLine>
<Link id="l00380" /><CodeLine lineNumber="380"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00381" /><CodeLine lineNumber="381"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00382" /><CodeLine lineNumber="382" lineLink="/docs/api/namespaces/llvm/#a03f30f48490558525cd5458201d13afe"><Highlight kind="normal"><a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/#a03f30f48490558525cd5458201d13afe">llvm::splitBBWithSuffix</a>(<a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> CreateBranch,</Highlight></CodeLine>
<Link id="l00383" /><CodeLine lineNumber="383"><Highlight kind="normal">                                    <a href="/docs/api/classes/llvm/twine">llvm::Twine</a> Suffix) &#123;</Highlight></CodeLine>
<Link id="l00384" /><CodeLine lineNumber="384"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Old = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l00385" /><CodeLine lineNumber="385"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, CreateBranch, Old-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + Suffix);</Highlight></CodeLine>
<Link id="l00386" /><CodeLine lineNumber="386"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00387" /><CodeLine lineNumber="387"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00388" /><CodeLine lineNumber="388"><Highlight kind="normal"></Highlight><Highlight kind="comment">// This function creates a fake integer value and a fake use for the integer</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00389" /><CodeLine lineNumber="389"><Highlight kind="normal"></Highlight><Highlight kind="comment">// value. It returns the fake value created. This is useful in modeling the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00390" /><CodeLine lineNumber="390"><Highlight kind="normal"></Highlight><Highlight kind="comment">// extra arguments to the outlined functions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00391" /><CodeLine lineNumber="391" lineLink="#a35409dbaffc2cf38fefec12e3cf9094d"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="#a35409dbaffc2cf38fefec12e3cf9094d">createFakeIntVal</a>(<a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder,</Highlight></CodeLine>
<Link id="l00392" /><CodeLine lineNumber="392"><Highlight kind="normal">                        <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OuterAllocaIP,</Highlight></CodeLine>
<Link id="l00393" /><CodeLine lineNumber="393"><Highlight kind="normal">                        <a href="/docs/api/classes/llvm/smallvectorimpl">llvm::SmallVectorImpl&lt;Instruction &#42;&gt;</a> &amp;ToBeDeleted,</Highlight></CodeLine>
<Link id="l00394" /><CodeLine lineNumber="394"><Highlight kind="normal">                        <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> InnerAllocaIP,</Highlight></CodeLine>
<Link id="l00395" /><CodeLine lineNumber="395"><Highlight kind="normal">                        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp;Name = </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> AsPtr = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l00396" /><CodeLine lineNumber="396"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OuterAllocaIP);</Highlight></CodeLine>
<Link id="l00397" /><CodeLine lineNumber="397"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;FakeVal;</Highlight></CodeLine>
<Link id="l00398" /><CodeLine lineNumber="398"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;FakeValAddr =</Highlight></CodeLine>
<Link id="l00399" /><CodeLine lineNumber="399"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, Name + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00400" /><CodeLine lineNumber="400"><Highlight kind="normal">  ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(FakeValAddr);</Highlight></CodeLine>
<Link id="l00401" /><CodeLine lineNumber="401"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00402" /><CodeLine lineNumber="402"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AsPtr) &#123;</Highlight></CodeLine>
<Link id="l00403" /><CodeLine lineNumber="403"><Highlight kind="normal">    FakeVal = FakeValAddr;</Highlight></CodeLine>
<Link id="l00404" /><CodeLine lineNumber="404"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00405" /><CodeLine lineNumber="405"><Highlight kind="normal">    FakeVal =</Highlight></CodeLine>
<Link id="l00406" /><CodeLine lineNumber="406"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), FakeValAddr, Name + </Highlight><Highlight kind="stringliteral">&quot;.val&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00407" /><CodeLine lineNumber="407"><Highlight kind="normal">    ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(FakeVal);</Highlight></CodeLine>
<Link id="l00408" /><CodeLine lineNumber="408"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00409" /><CodeLine lineNumber="409"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00410" /><CodeLine lineNumber="410"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Generate a fake use of this value</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00411" /><CodeLine lineNumber="411"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(InnerAllocaIP);</Highlight></CodeLine>
<Link id="l00412" /><CodeLine lineNumber="412"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UseFakeVal;</Highlight></CodeLine>
<Link id="l00413" /><CodeLine lineNumber="413"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AsPtr) &#123;</Highlight></CodeLine>
<Link id="l00414" /><CodeLine lineNumber="414"><Highlight kind="normal">    UseFakeVal =</Highlight></CodeLine>
<Link id="l00415" /><CodeLine lineNumber="415"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), FakeVal, Name + </Highlight><Highlight kind="stringliteral">&quot;.use&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00416" /><CodeLine lineNumber="416"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00417" /><CodeLine lineNumber="417"><Highlight kind="normal">    UseFakeVal =</Highlight></CodeLine>
<Link id="l00418" /><CodeLine lineNumber="418"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BinaryOperator&gt;</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(FakeVal, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(10)));</Highlight></CodeLine>
<Link id="l00419" /><CodeLine lineNumber="419"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00420" /><CodeLine lineNumber="420"><Highlight kind="normal">  ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(UseFakeVal);</Highlight></CodeLine>
<Link id="l00421" /><CodeLine lineNumber="421"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> FakeVal;</Highlight></CodeLine>
<Link id="l00422" /><CodeLine lineNumber="422"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00423" /><CodeLine lineNumber="423"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00424" /><CodeLine lineNumber="424"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00425" /><CodeLine lineNumber="425"><Highlight kind="normal"></Highlight><Highlight kind="comment">// OpenMPIRBuilderConfig</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00426" /><CodeLine lineNumber="426"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00427" /><CodeLine lineNumber="427"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00428" /><CodeLine lineNumber="428" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00429" /><CodeLine lineNumber="429" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a5b6a7e92a601fa5fffd86f5d29df35fa"><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/#a344add483f0f71ecd426dd6c2d471e99">LLVM&#95;ENABLE&#95;BITMASK&#95;ENUMS&#95;IN&#95;NAMESPACE</a>();</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00430" /><CodeLine lineNumber="430"><Highlight kind="comment">/// Values for bit flags for marking which requires clauses have been used.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00431" /><CodeLine lineNumber="431" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59"><Highlight kind="normal"></Highlight><Highlight kind="keyword">enum</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59">OpenMPOffloadingRequiresDirFlags</a> &#123;</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00432" /><CodeLine lineNumber="432"><Highlight kind="comment">  /// flag undefined.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00433" /><CodeLine lineNumber="433" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a7972c62027157095f27334a175046ec8"><Highlight kind="normal">  <a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a7972c62027157095f27334a175046ec8">OMP&#95;REQ&#95;UNDEFINED</a> = 0x000,</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00434" /><CodeLine lineNumber="434"><Highlight kind="comment">  /// no requires directive present.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00435" /><CodeLine lineNumber="435" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a133a116519cf4d083bd62fe903222233"><Highlight kind="normal">  <a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a133a116519cf4d083bd62fe903222233">OMP&#95;REQ&#95;NONE</a> = 0x001,</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00436" /><CodeLine lineNumber="436"><Highlight kind="comment">  /// reverse&#95;offload clause.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00437" /><CodeLine lineNumber="437" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a9fc383d39ee53daf5acd732e83f612ac"><Highlight kind="normal">  <a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a9fc383d39ee53daf5acd732e83f612ac">OMP&#95;REQ&#95;REVERSE&#95;OFFLOAD</a> = 0x002,</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00438" /><CodeLine lineNumber="438"><Highlight kind="comment">  /// unified&#95;address clause.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00439" /><CodeLine lineNumber="439" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59adea434f369cc7e932a9a8a6794cf4d30"><Highlight kind="normal">  <a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59adea434f369cc7e932a9a8a6794cf4d30">OMP&#95;REQ&#95;UNIFIED&#95;ADDRESS</a> = 0x004,</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00440" /><CodeLine lineNumber="440"><Highlight kind="comment">  /// unified&#95;shared&#95;memory clause.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00441" /><CodeLine lineNumber="441" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a181e4e34f98a2ff557a47da8eba82652"><Highlight kind="normal">  <a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a181e4e34f98a2ff557a47da8eba82652">OMP&#95;REQ&#95;UNIFIED&#95;SHARED&#95;MEMORY</a> = 0x008,</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00442" /><CodeLine lineNumber="442"><Highlight kind="comment">  /// dynamic&#95;allocators clause.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00443" /><CodeLine lineNumber="443" lineLink="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59ae27c8208560d202db5844b7de3667d76"><Highlight kind="normal">  <a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59ae27c8208560d202db5844b7de3667d76">OMP&#95;REQ&#95;DYNAMIC&#95;ALLOCATORS</a> = 0x010,</Highlight></CodeLine>
<Link id="l00444" /><CodeLine lineNumber="444"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a9db8c44b250b90e3ab7e4d144e7c9c2eaab882f7771b12a605e94c8abb12db9cf">LLVM&#95;MARK&#95;AS&#95;BITMASK&#95;ENUM</a>(</Highlight><Highlight kind="comment">/&#42;LargestValue=&#42;/</Highlight><Highlight kind="normal"><a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59ae27c8208560d202db5844b7de3667d76">OMP&#95;REQ&#95;DYNAMIC&#95;ALLOCATORS</a>)</Highlight></CodeLine>
<Link id="l00445" /><CodeLine lineNumber="445"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00446" /><CodeLine lineNumber="446"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00447" /><CodeLine lineNumber="447"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00448" /><CodeLine lineNumber="448"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00449" /><CodeLine lineNumber="449" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#a700297913ed317f4442b189b1efdd454"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a700297913ed317f4442b189b1efdd454">OpenMPIRBuilderConfig::OpenMPIRBuilderConfig</a>()</Highlight></CodeLine>
<Link id="l00450" /><CodeLine lineNumber="450"><Highlight kind="normal">    : RequiresFlags(<a href="/docs/api/namespaces/anonymous-ompirbuilder-cpp-/#a6c4c036b1f33a03ce42152b5eb9c3f59a7972c62027157095f27334a175046ec8">OMP&#95;REQ&#95;UNDEFINED</a>) &#123;&#125;</Highlight></CodeLine>
<Link id="l00451" /><CodeLine lineNumber="451"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00452" /><CodeLine lineNumber="452" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#a3940df3db367cce0bfbe2aaae338b2d3"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a700297913ed317f4442b189b1efdd454">OpenMPIRBuilderConfig::OpenMPIRBuilderConfig</a>(</Highlight></CodeLine>
<Link id="l00453" /><CodeLine lineNumber="453"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a22e985ea690b791910dc19186b63cc37">IsTargetDevice</a>, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a24001aad64c43839eee308e15ad21166">IsGPU</a>, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a467a56dc1fad02dbb0540d9b7d68faa6">OpenMPOffloadMandatory</a>,</Highlight></CodeLine>
<Link id="l00454" /><CodeLine lineNumber="454"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasRequiresReverseOffload, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasRequiresUnifiedAddress,</Highlight></CodeLine>
<Link id="l00455" /><CodeLine lineNumber="455"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasRequiresUnifiedSharedMemory, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasRequiresDynamicAllocators)</Highlight></CodeLine>
<Link id="l00456" /><CodeLine lineNumber="456"><Highlight kind="normal">    : <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a22e985ea690b791910dc19186b63cc37">IsTargetDevice</a>(<a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a22e985ea690b791910dc19186b63cc37">IsTargetDevice</a>), <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a24001aad64c43839eee308e15ad21166">IsGPU</a>(<a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a24001aad64c43839eee308e15ad21166">IsGPU</a>),</Highlight></CodeLine>
<Link id="l00457" /><CodeLine lineNumber="457"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a467a56dc1fad02dbb0540d9b7d68faa6">OpenMPOffloadMandatory</a>(<a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a467a56dc1fad02dbb0540d9b7d68faa6">OpenMPOffloadMandatory</a>),</Highlight></CodeLine>
<Link id="l00458" /><CodeLine lineNumber="458"><Highlight kind="normal">      RequiresFlags(OMP&#95;REQ&#95;UNDEFINED) &#123;</Highlight></CodeLine>
<Link id="l00459" /><CodeLine lineNumber="459"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasRequiresReverseOffload)</Highlight></CodeLine>
<Link id="l00460" /><CodeLine lineNumber="460"><Highlight kind="normal">    RequiresFlags |= OMP&#95;REQ&#95;REVERSE&#95;OFFLOAD;</Highlight></CodeLine>
<Link id="l00461" /><CodeLine lineNumber="461"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasRequiresUnifiedAddress)</Highlight></CodeLine>
<Link id="l00462" /><CodeLine lineNumber="462"><Highlight kind="normal">    RequiresFlags |= OMP&#95;REQ&#95;UNIFIED&#95;ADDRESS;</Highlight></CodeLine>
<Link id="l00463" /><CodeLine lineNumber="463"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasRequiresUnifiedSharedMemory)</Highlight></CodeLine>
<Link id="l00464" /><CodeLine lineNumber="464"><Highlight kind="normal">    RequiresFlags |= OMP&#95;REQ&#95;UNIFIED&#95;SHARED&#95;MEMORY;</Highlight></CodeLine>
<Link id="l00465" /><CodeLine lineNumber="465"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasRequiresDynamicAllocators)</Highlight></CodeLine>
<Link id="l00466" /><CodeLine lineNumber="466"><Highlight kind="normal">    RequiresFlags |= OMP&#95;REQ&#95;DYNAMIC&#95;ALLOCATORS;</Highlight></CodeLine>
<Link id="l00467" /><CodeLine lineNumber="467"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00468" /><CodeLine lineNumber="468"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00469" /><CodeLine lineNumber="469" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#af53cf29288858444e087718f5f8cb089"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#af53cf29288858444e087718f5f8cb089">OpenMPIRBuilderConfig::hasRequiresReverseOffload</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00470" /><CodeLine lineNumber="470"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RequiresFlags &amp; OMP&#95;REQ&#95;REVERSE&#95;OFFLOAD;</Highlight></CodeLine>
<Link id="l00471" /><CodeLine lineNumber="471"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00472" /><CodeLine lineNumber="472"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00473" /><CodeLine lineNumber="473" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#af5ab024ecdc82f9f43003f49fbc63821"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#af5ab024ecdc82f9f43003f49fbc63821">OpenMPIRBuilderConfig::hasRequiresUnifiedAddress</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00474" /><CodeLine lineNumber="474"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RequiresFlags &amp; OMP&#95;REQ&#95;UNIFIED&#95;ADDRESS;</Highlight></CodeLine>
<Link id="l00475" /><CodeLine lineNumber="475"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00476" /><CodeLine lineNumber="476"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00477" /><CodeLine lineNumber="477" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#a8004b86f0e2c956fbdba73021821cae7"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a8004b86f0e2c956fbdba73021821cae7">OpenMPIRBuilderConfig::hasRequiresUnifiedSharedMemory</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00478" /><CodeLine lineNumber="478"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RequiresFlags &amp; OMP&#95;REQ&#95;UNIFIED&#95;SHARED&#95;MEMORY;</Highlight></CodeLine>
<Link id="l00479" /><CodeLine lineNumber="479"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00480" /><CodeLine lineNumber="480"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00481" /><CodeLine lineNumber="481" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#a8f00d1b04fd6cec310f24bd50fbe7f93"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a8f00d1b04fd6cec310f24bd50fbe7f93">OpenMPIRBuilderConfig::hasRequiresDynamicAllocators</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00482" /><CodeLine lineNumber="482"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RequiresFlags &amp; OMP&#95;REQ&#95;DYNAMIC&#95;ALLOCATORS;</Highlight></CodeLine>
<Link id="l00483" /><CodeLine lineNumber="483"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00484" /><CodeLine lineNumber="484"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00485" /><CodeLine lineNumber="485" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#a3550c2ca911ccadf62de0b831a8d51f2"><Highlight kind="normal">int64&#95;t <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a3550c2ca911ccadf62de0b831a8d51f2">OpenMPIRBuilderConfig::getRequiresFlags</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00486" /><CodeLine lineNumber="486"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#af555ff2fc75e765e341217f0c531e3f2">hasRequiresFlags</a>() ? RequiresFlags</Highlight></CodeLine>
<Link id="l00487" /><CodeLine lineNumber="487"><Highlight kind="normal">                            : </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">int64&#95;t</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(OMP&#95;REQ&#95;NONE);</Highlight></CodeLine>
<Link id="l00488" /><CodeLine lineNumber="488"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00489" /><CodeLine lineNumber="489"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00490" /><CodeLine lineNumber="490" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#a5d46c8aef9772e3f5a8897b48f0bc818"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a5d46c8aef9772e3f5a8897b48f0bc818">OpenMPIRBuilderConfig::setHasRequiresReverseOffload</a>(</Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a>) &#123;</Highlight></CodeLine>
<Link id="l00491" /><CodeLine lineNumber="491"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/value">Value</a>)</Highlight></CodeLine>
<Link id="l00492" /><CodeLine lineNumber="492"><Highlight kind="normal">    RequiresFlags |= OMP&#95;REQ&#95;REVERSE&#95;OFFLOAD;</Highlight></CodeLine>
<Link id="l00493" /><CodeLine lineNumber="493"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00494" /><CodeLine lineNumber="494"><Highlight kind="normal">    RequiresFlags &amp;= ~OMP&#95;REQ&#95;REVERSE&#95;OFFLOAD;</Highlight></CodeLine>
<Link id="l00495" /><CodeLine lineNumber="495"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00496" /><CodeLine lineNumber="496"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00497" /><CodeLine lineNumber="497" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#a97578e61977a91c51a3482a5964e7259"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a97578e61977a91c51a3482a5964e7259">OpenMPIRBuilderConfig::setHasRequiresUnifiedAddress</a>(</Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a>) &#123;</Highlight></CodeLine>
<Link id="l00498" /><CodeLine lineNumber="498"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/value">Value</a>)</Highlight></CodeLine>
<Link id="l00499" /><CodeLine lineNumber="499"><Highlight kind="normal">    RequiresFlags |= OMP&#95;REQ&#95;UNIFIED&#95;ADDRESS;</Highlight></CodeLine>
<Link id="l00500" /><CodeLine lineNumber="500"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00501" /><CodeLine lineNumber="501"><Highlight kind="normal">    RequiresFlags &amp;= ~OMP&#95;REQ&#95;UNIFIED&#95;ADDRESS;</Highlight></CodeLine>
<Link id="l00502" /><CodeLine lineNumber="502"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00503" /><CodeLine lineNumber="503"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00504" /><CodeLine lineNumber="504" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#a842f04d6d6f5a942d28b0fd26b6b17a8"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#a842f04d6d6f5a942d28b0fd26b6b17a8">OpenMPIRBuilderConfig::setHasRequiresUnifiedSharedMemory</a>(</Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a>) &#123;</Highlight></CodeLine>
<Link id="l00505" /><CodeLine lineNumber="505"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/value">Value</a>)</Highlight></CodeLine>
<Link id="l00506" /><CodeLine lineNumber="506"><Highlight kind="normal">    RequiresFlags |= OMP&#95;REQ&#95;UNIFIED&#95;SHARED&#95;MEMORY;</Highlight></CodeLine>
<Link id="l00507" /><CodeLine lineNumber="507"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00508" /><CodeLine lineNumber="508"><Highlight kind="normal">    RequiresFlags &amp;= ~OMP&#95;REQ&#95;UNIFIED&#95;SHARED&#95;MEMORY;</Highlight></CodeLine>
<Link id="l00509" /><CodeLine lineNumber="509"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00510" /><CodeLine lineNumber="510"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00511" /><CodeLine lineNumber="511" lineLink="/docs/api/classes/llvm/openmpirbuilderconfig/#adc9e390779faa4da74c5176a945b2afe"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilderconfig/#adc9e390779faa4da74c5176a945b2afe">OpenMPIRBuilderConfig::setHasRequiresDynamicAllocators</a>(</Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a>) &#123;</Highlight></CodeLine>
<Link id="l00512" /><CodeLine lineNumber="512"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/value">Value</a>)</Highlight></CodeLine>
<Link id="l00513" /><CodeLine lineNumber="513"><Highlight kind="normal">    RequiresFlags |= OMP&#95;REQ&#95;DYNAMIC&#95;ALLOCATORS;</Highlight></CodeLine>
<Link id="l00514" /><CodeLine lineNumber="514"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00515" /><CodeLine lineNumber="515"><Highlight kind="normal">    RequiresFlags &amp;= ~OMP&#95;REQ&#95;DYNAMIC&#95;ALLOCATORS;</Highlight></CodeLine>
<Link id="l00516" /><CodeLine lineNumber="516"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00517" /><CodeLine lineNumber="517"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00518" /><CodeLine lineNumber="518"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00519" /><CodeLine lineNumber="519"><Highlight kind="normal"></Highlight><Highlight kind="comment">// OpenMPIRBuilder</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00520" /><CodeLine lineNumber="520"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00521" /><CodeLine lineNumber="521"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00522" /><CodeLine lineNumber="522"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::getKernelArgsVector(TargetKernelArgs &amp;KernelArgs,</Highlight></CodeLine>
<Link id="l00523" /><CodeLine lineNumber="523"><Highlight kind="normal">                                          <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder,</Highlight></CodeLine>
<Link id="l00524" /><CodeLine lineNumber="524"><Highlight kind="normal">                                          <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;&gt;</a> &amp;ArgsVector) &#123;</Highlight></CodeLine>
<Link id="l00525" /><CodeLine lineNumber="525"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/#a689a023f54d38d41f6d952cac41ee538">Version</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/frontend/include/llvm/frontend/openmp/ompconstants-h/#a893a8cf8f1e26701b29719386c42c9a7">OMP&#95;KERNEL&#95;ARG&#95;VERSION</a>);</Highlight></CodeLine>
<Link id="l00526" /><CodeLine lineNumber="526"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;PointerNum = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(KernelArgs.NumTargetItems);</Highlight></CodeLine>
<Link id="l00527" /><CodeLine lineNumber="527"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a23f9ec4bb2576ca8738f3edc9c4f5cdf">Int32Ty</a> = <a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>());</Highlight></CodeLine>
<Link id="l00528" /><CodeLine lineNumber="528"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> MaxDim = 3;</Highlight></CodeLine>
<Link id="l00529" /><CodeLine lineNumber="529"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;ZeroArray = <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(<a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(<a href="/docs/api/namespaces/llvm/#a23f9ec4bb2576ca8738f3edc9c4f5cdf">Int32Ty</a>, MaxDim));</Highlight></CodeLine>
<Link id="l00530" /><CodeLine lineNumber="530"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Flags = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(KernelArgs.HasNoWait);</Highlight></CodeLine>
<Link id="l00531" /><CodeLine lineNumber="531"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00532" /><CodeLine lineNumber="532"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!KernelArgs.NumTeams.empty() &amp;&amp; !KernelArgs.NumThreads.empty());</Highlight></CodeLine>
<Link id="l00533" /><CodeLine lineNumber="533"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00534" /><CodeLine lineNumber="534"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumTeams3D =</Highlight></CodeLine>
<Link id="l00535" /><CodeLine lineNumber="535"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a20833e358e38f9a86074bb4cc72b0d14">CreateInsertValue</a>(ZeroArray, KernelArgs.NumTeams&#91;0&#93;, &#123;0&#125;);</Highlight></CodeLine>
<Link id="l00536" /><CodeLine lineNumber="536"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumThreads3D =</Highlight></CodeLine>
<Link id="l00537" /><CodeLine lineNumber="537"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a20833e358e38f9a86074bb4cc72b0d14">CreateInsertValue</a>(ZeroArray, KernelArgs.NumThreads&#91;0&#93;, &#123;0&#125;);</Highlight></CodeLine>
<Link id="l00538" /><CodeLine lineNumber="538"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> :</Highlight></CodeLine>
<Link id="l00539" /><CodeLine lineNumber="539"><Highlight kind="normal">       <a href="/docs/api/namespaces/llvm/#adc4eb8be6f7a12ede962987fb9cabb47">seq&lt;unsigned&gt;</a>(1, std::min(KernelArgs.NumTeams.size(), MaxDim)))</Highlight></CodeLine>
<Link id="l00540" /><CodeLine lineNumber="540"><Highlight kind="normal">    NumTeams3D =</Highlight></CodeLine>
<Link id="l00541" /><CodeLine lineNumber="541"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a20833e358e38f9a86074bb4cc72b0d14">CreateInsertValue</a>(NumTeams3D, KernelArgs.NumTeams&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;, &#123;I&#125;);</Highlight></CodeLine>
<Link id="l00542" /><CodeLine lineNumber="542"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> :</Highlight></CodeLine>
<Link id="l00543" /><CodeLine lineNumber="543"><Highlight kind="normal">       <a href="/docs/api/namespaces/llvm/#adc4eb8be6f7a12ede962987fb9cabb47">seq&lt;unsigned&gt;</a>(1, std::min(KernelArgs.NumThreads.size(), MaxDim)))</Highlight></CodeLine>
<Link id="l00544" /><CodeLine lineNumber="544"><Highlight kind="normal">    NumThreads3D =</Highlight></CodeLine>
<Link id="l00545" /><CodeLine lineNumber="545"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a20833e358e38f9a86074bb4cc72b0d14">CreateInsertValue</a>(NumThreads3D, KernelArgs.NumThreads&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;, &#123;I&#125;);</Highlight></CodeLine>
<Link id="l00546" /><CodeLine lineNumber="546"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00547" /><CodeLine lineNumber="547"><Highlight kind="normal">  ArgsVector = &#123;<a href="/docs/api/namespaces/llvm/#a689a023f54d38d41f6d952cac41ee538">Version</a>,</Highlight></CodeLine>
<Link id="l00548" /><CodeLine lineNumber="548"><Highlight kind="normal">                PointerNum,</Highlight></CodeLine>
<Link id="l00549" /><CodeLine lineNumber="549"><Highlight kind="normal">                KernelArgs.RTArgs.BasePointersArray,</Highlight></CodeLine>
<Link id="l00550" /><CodeLine lineNumber="550"><Highlight kind="normal">                KernelArgs.RTArgs.PointersArray,</Highlight></CodeLine>
<Link id="l00551" /><CodeLine lineNumber="551"><Highlight kind="normal">                KernelArgs.RTArgs.SizesArray,</Highlight></CodeLine>
<Link id="l00552" /><CodeLine lineNumber="552"><Highlight kind="normal">                KernelArgs.RTArgs.MapTypesArray,</Highlight></CodeLine>
<Link id="l00553" /><CodeLine lineNumber="553"><Highlight kind="normal">                KernelArgs.RTArgs.MapNamesArray,</Highlight></CodeLine>
<Link id="l00554" /><CodeLine lineNumber="554"><Highlight kind="normal">                KernelArgs.RTArgs.MappersArray,</Highlight></CodeLine>
<Link id="l00555" /><CodeLine lineNumber="555"><Highlight kind="normal">                KernelArgs.NumIterations,</Highlight></CodeLine>
<Link id="l00556" /><CodeLine lineNumber="556"><Highlight kind="normal">                Flags,</Highlight></CodeLine>
<Link id="l00557" /><CodeLine lineNumber="557"><Highlight kind="normal">                NumTeams3D,</Highlight></CodeLine>
<Link id="l00558" /><CodeLine lineNumber="558"><Highlight kind="normal">                NumThreads3D,</Highlight></CodeLine>
<Link id="l00559" /><CodeLine lineNumber="559"><Highlight kind="normal">                KernelArgs.DynCGGroupMem&#125;;</Highlight></CodeLine>
<Link id="l00560" /><CodeLine lineNumber="560"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00561" /><CodeLine lineNumber="561"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00562" /><CodeLine lineNumber="562" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a50c6490cf353f064946c4e32673ac098"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a50c6490cf353f064946c4e32673ac098">OpenMPIRBuilder::addAttributes</a>(<a href="/docs/api/namespaces/llvm/omp/#a4c503140c7f851151906d85b515330e9">omp::RuntimeFunction</a> FnID, <a href="/docs/api/classes/llvm/function">Function</a> &amp;Fn) &#123;</Highlight></CodeLine>
<Link id="l00563" /><CodeLine lineNumber="563"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = Fn.<a href="/docs/api/classes/llvm/function/#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</Highlight></CodeLine>
<Link id="l00564" /><CodeLine lineNumber="564"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00565" /><CodeLine lineNumber="565"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Get the function&#39;s current attributes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00566" /><CodeLine lineNumber="566"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Attrs = Fn.<a href="/docs/api/classes/llvm/function/#a7477aafbbe989ad35b96fac186d8e9fd">getAttributes</a>();</Highlight></CodeLine>
<Link id="l00567" /><CodeLine lineNumber="567"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FnAttrs = Attrs.getFnAttrs();</Highlight></CodeLine>
<Link id="l00568" /><CodeLine lineNumber="568"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> RetAttrs = Attrs.getRetAttrs();</Highlight></CodeLine>
<Link id="l00569" /><CodeLine lineNumber="569"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;AttributeSet, 4&gt;</a> ArgAttrs;</Highlight></CodeLine>
<Link id="l00570" /><CodeLine lineNumber="570"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> ArgNo = 0; ArgNo &lt; Fn.<a href="/docs/api/classes/llvm/function/#ac6baa801e4aea800984e760d5460662f">arg&#95;size</a>(); ++ArgNo)</Highlight></CodeLine>
<Link id="l00571" /><CodeLine lineNumber="571"><Highlight kind="normal">    ArgAttrs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Attrs.getParamAttrs(ArgNo));</Highlight></CodeLine>
<Link id="l00572" /><CodeLine lineNumber="572"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00573" /><CodeLine lineNumber="573"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add AS to FnAS while taking special care with integer extensions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00574" /><CodeLine lineNumber="574"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> addAttrSet = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/attributeset">AttributeSet</a> &amp;FnAS, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/attributeset">AttributeSet</a> &amp;AS,</Highlight></CodeLine>
<Link id="l00575" /><CodeLine lineNumber="575"><Highlight kind="normal">                        </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Param = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">) -&gt; </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00576" /><CodeLine lineNumber="576"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasSignExt = AS.hasAttribute(Attribute::SExt);</Highlight></CodeLine>
<Link id="l00577" /><CodeLine lineNumber="577"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasZeroExt = AS.hasAttribute(Attribute::ZExt);</Highlight></CodeLine>
<Link id="l00578" /><CodeLine lineNumber="578"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasSignExt || HasZeroExt) &#123;</Highlight></CodeLine>
<Link id="l00579" /><CodeLine lineNumber="579"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AS.getNumAttributes() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l00580" /><CodeLine lineNumber="580"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Currently not handling extension attr combined with others.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00581" /><CodeLine lineNumber="581"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Param) &#123;</Highlight></CodeLine>
<Link id="l00582" /><CodeLine lineNumber="582"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> AK = TargetLibraryInfo::getExtAttrForI32Param(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, HasSignExt))</Highlight></CodeLine>
<Link id="l00583" /><CodeLine lineNumber="583"><Highlight kind="normal">          FnAS = FnAS.<a href="/docs/api/classes/llvm/attributeset/#af2b9418751d1f1f1b99e5b05d0ed7efa">addAttribute</a>(Ctx, AK);</Highlight></CodeLine>
<Link id="l00584" /><CodeLine lineNumber="584"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> AK =</Highlight></CodeLine>
<Link id="l00585" /><CodeLine lineNumber="585"><Highlight kind="normal">                     TargetLibraryInfo::getExtAttrForI32Return(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, HasSignExt))</Highlight></CodeLine>
<Link id="l00586" /><CodeLine lineNumber="586"><Highlight kind="normal">        FnAS = FnAS.<a href="/docs/api/classes/llvm/attributeset/#af2b9418751d1f1f1b99e5b05d0ed7efa">addAttribute</a>(Ctx, AK);</Highlight></CodeLine>
<Link id="l00587" /><CodeLine lineNumber="587"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00588" /><CodeLine lineNumber="588"><Highlight kind="normal">      FnAS = FnAS.<a href="/docs/api/classes/llvm/attributeset/#a46f189c4026ace551d70a16566e641b1">addAttributes</a>(Ctx, AS);</Highlight></CodeLine>
<Link id="l00589" /><CodeLine lineNumber="589"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00590" /><CodeLine lineNumber="590"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l00591" /><CodeLine lineNumber="591"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00592" /><CodeLine lineNumber="592"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;ATTRS&#95;SET(VarName, AttrSet) AttributeSet VarName = AttrSet;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00593" /><CodeLine lineNumber="593"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;llvm/Frontend/OpenMP/OMPKinds.def&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00594" /><CodeLine lineNumber="594"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00595" /><CodeLine lineNumber="595"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add attributes to the function declaration.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00596" /><CodeLine lineNumber="596"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (FnID) &#123;</Highlight></CodeLine>
<Link id="l00597" /><CodeLine lineNumber="597"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;RTL&#95;ATTRS(Enum, FnAttrSet, RetAttrSet, ArgAttrSets)                \\</Highlight></CodeLine>
<Link id="l00598" /><CodeLine lineNumber="598"><Highlight kind="preprocessor">  case Enum:                                                                   \\</Highlight></CodeLine>
<Link id="l00599" /><CodeLine lineNumber="599"><Highlight kind="preprocessor">    FnAttrs = FnAttrs.addAttributes(Ctx, FnAttrSet);                           \\</Highlight></CodeLine>
<Link id="l00600" /><CodeLine lineNumber="600"><Highlight kind="preprocessor">    addAttrSet(RetAttrs, RetAttrSet, </Highlight><Highlight kind="comment">/&#42;Param&#42;/</Highlight><Highlight kind="preprocessor"> false);                         \\</Highlight></CodeLine>
<Link id="l00601" /><CodeLine lineNumber="601"><Highlight kind="preprocessor">    for (size&#95;t ArgNo = 0; ArgNo &lt; ArgAttrSets.size(); ++ArgNo)                \\</Highlight></CodeLine>
<Link id="l00602" /><CodeLine lineNumber="602"><Highlight kind="preprocessor">      addAttrSet(ArgAttrs&#91;ArgNo&#93;, ArgAttrSets&#91;ArgNo&#93;);                         \\</Highlight></CodeLine>
<Link id="l00603" /><CodeLine lineNumber="603"><Highlight kind="preprocessor">    Fn.setAttributes(AttributeList::get(Ctx, FnAttrs, RetAttrs, ArgAttrs));    \\</Highlight></CodeLine>
<Link id="l00604" /><CodeLine lineNumber="604"><Highlight kind="preprocessor">    break;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00605" /><CodeLine lineNumber="605"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;llvm/Frontend/OpenMP/OMPKinds.def&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00606" /><CodeLine lineNumber="606"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l00607" /><CodeLine lineNumber="607"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Attributes are optional.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00608" /><CodeLine lineNumber="608"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00609" /><CodeLine lineNumber="609"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00610" /><CodeLine lineNumber="610"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00611" /><CodeLine lineNumber="611"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00612" /><CodeLine lineNumber="612"><Highlight kind="normal"><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></Highlight></CodeLine>
<Link id="l00613" /><CodeLine lineNumber="613"><Highlight kind="normal">OpenMPIRBuilder::getOrCreateRuntimeFunction(<a href="/docs/api/classes/llvm/module">Module</a> &amp;M, <a href="/docs/api/namespaces/llvm/omp/#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> FnID) &#123;</Highlight></CodeLine>
<Link id="l00614" /><CodeLine lineNumber="614"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/functiontype">FunctionType</a> &#42;FnTy = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00615" /><CodeLine lineNumber="615"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;Fn = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00616" /><CodeLine lineNumber="616"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00617" /><CodeLine lineNumber="617"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Try to find the declation in the module first.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00618" /><CodeLine lineNumber="618"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (FnID) &#123;</Highlight></CodeLine>
<Link id="l00619" /><CodeLine lineNumber="619"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;RTL(Enum, Str, IsVarArg, ReturnType, ...)                          \\</Highlight></CodeLine>
<Link id="l00620" /><CodeLine lineNumber="620"><Highlight kind="preprocessor">  case Enum:                                                                   \\</Highlight></CodeLine>
<Link id="l00621" /><CodeLine lineNumber="621"><Highlight kind="preprocessor">    FnTy = FunctionType::get(ReturnType, ArrayRef&lt;Type &#42;&gt;&#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;,        \\</Highlight></CodeLine>
<Link id="l00622" /><CodeLine lineNumber="622"><Highlight kind="preprocessor">                             IsVarArg);                                        \\</Highlight></CodeLine>
<Link id="l00623" /><CodeLine lineNumber="623"><Highlight kind="preprocessor">    Fn = M.getFunction(Str);                                                   \\</Highlight></CodeLine>
<Link id="l00624" /><CodeLine lineNumber="624"><Highlight kind="preprocessor">    break;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00625" /><CodeLine lineNumber="625"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;llvm/Frontend/OpenMP/OMPKinds.def&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00626" /><CodeLine lineNumber="626"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00627" /><CodeLine lineNumber="627"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00628" /><CodeLine lineNumber="628"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Fn) &#123;</Highlight></CodeLine>
<Link id="l00629" /><CodeLine lineNumber="629"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Create a new declaration if we need one.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00630" /><CodeLine lineNumber="630"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (FnID) &#123;</Highlight></CodeLine>
<Link id="l00631" /><CodeLine lineNumber="631"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;RTL(Enum, Str, ...)                                                \\</Highlight></CodeLine>
<Link id="l00632" /><CodeLine lineNumber="632"><Highlight kind="preprocessor">  case Enum:                                                                   \\</Highlight></CodeLine>
<Link id="l00633" /><CodeLine lineNumber="633"><Highlight kind="preprocessor">    Fn = Function::Create(FnTy, GlobalValue::ExternalLinkage, Str, M);         \\</Highlight></CodeLine>
<Link id="l00634" /><CodeLine lineNumber="634"><Highlight kind="preprocessor">    break;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00635" /><CodeLine lineNumber="635"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;llvm/Frontend/OpenMP/OMPKinds.def&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00636" /><CodeLine lineNumber="636"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00637" /><CodeLine lineNumber="637"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00638" /><CodeLine lineNumber="638"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add information if the runtime function takes a callback function</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00639" /><CodeLine lineNumber="639"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FnID == OMPRTL&#95;&#95;&#95;kmpc&#95;fork&#95;call || FnID == OMPRTL&#95;&#95;&#95;kmpc&#95;fork&#95;teams) &#123;</Highlight></CodeLine>
<Link id="l00640" /><CodeLine lineNumber="640"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Fn-&gt;<a href="/docs/api/classes/llvm/globalobject/#a1f496e54accb2cbe919fb456cb703f1a">hasMetadata</a>(LLVMContext::MD&#95;callback)) &#123;</Highlight></CodeLine>
<Link id="l00641" /><CodeLine lineNumber="641"><Highlight kind="normal">        LLVMContext &amp;Ctx = Fn-&gt;<a href="/docs/api/classes/llvm/function/#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</Highlight></CodeLine>
<Link id="l00642" /><CodeLine lineNumber="642"><Highlight kind="normal">        MDBuilder MDB(Ctx);</Highlight></CodeLine>
<Link id="l00643" /><CodeLine lineNumber="643"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Annotate the callback behavior of the runtime function:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00644" /><CodeLine lineNumber="644"><Highlight kind="normal">        </Highlight><Highlight kind="comment">//  - The callback callee is argument number 2 (microtask).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00645" /><CodeLine lineNumber="645"><Highlight kind="normal">        </Highlight><Highlight kind="comment">//  - The first two arguments of the callback callee are unknown (-1).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00646" /><CodeLine lineNumber="646"><Highlight kind="normal">        </Highlight><Highlight kind="comment">//  - All variadic arguments to the runtime function are passed to the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00647" /><CodeLine lineNumber="647"><Highlight kind="normal">        </Highlight><Highlight kind="comment">//    callback callee.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00648" /><CodeLine lineNumber="648"><Highlight kind="normal">        Fn-&gt;<a href="/docs/api/classes/llvm/globalobject/#aa1b0638c63ba711320b3bb9c69367ed6">addMetadata</a>(</Highlight></CodeLine>
<Link id="l00649" /><CodeLine lineNumber="649"><Highlight kind="normal">            LLVMContext::MD&#95;callback,</Highlight></CodeLine>
<Link id="l00650" /><CodeLine lineNumber="650"><Highlight kind="normal">            &#42;<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, &#123;MDB.createCallbackEncoding(</Highlight></CodeLine>
<Link id="l00651" /><CodeLine lineNumber="651"><Highlight kind="normal">                                  2, &#123;-1, -1&#125;, </Highlight><Highlight kind="comment">/&#42; VarArgsArePassed &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">)&#125;));</Highlight></CodeLine>
<Link id="l00652" /><CodeLine lineNumber="652"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l00653" /><CodeLine lineNumber="653"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00654" /><CodeLine lineNumber="654"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00655" /><CodeLine lineNumber="655"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Created OpenMP runtime function &quot;</Highlight><Highlight kind="normal"> &lt;&lt; Fn-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</Highlight></CodeLine>
<Link id="l00656" /><CodeLine lineNumber="656"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; with type &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Fn-&gt;<a href="/docs/api/classes/llvm/function/#a21075305f0e463b24aafc2fb99514ace">getFunctionType</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00657" /><CodeLine lineNumber="657"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#a50c6490cf353f064946c4e32673ac098">addAttributes</a>(FnID, &#42;Fn);</Highlight></CodeLine>
<Link id="l00658" /><CodeLine lineNumber="658"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00659" /><CodeLine lineNumber="659"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00660" /><CodeLine lineNumber="660"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Found OpenMP runtime function &quot;</Highlight><Highlight kind="normal"> &lt;&lt; Fn-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()</Highlight></CodeLine>
<Link id="l00661" /><CodeLine lineNumber="661"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; with type &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Fn-&gt;<a href="/docs/api/classes/llvm/function/#a21075305f0e463b24aafc2fb99514ace">getFunctionType</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00662" /><CodeLine lineNumber="662"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00663" /><CodeLine lineNumber="663"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00664" /><CodeLine lineNumber="664"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Fn &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Failed to create OpenMP runtime function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00665" /><CodeLine lineNumber="665"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00666" /><CodeLine lineNumber="666"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;FnTy, Fn&#125;;</Highlight></CodeLine>
<Link id="l00667" /><CodeLine lineNumber="667"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00668" /><CodeLine lineNumber="668"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00669" /><CodeLine lineNumber="669"><Highlight kind="normal"><a href="/docs/api/classes/llvm/function">Function</a> &#42;OpenMPIRBuilder::getOrCreateRuntimeFunctionPtr(<a href="/docs/api/namespaces/llvm/omp/#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> FnID) &#123;</Highlight></CodeLine>
<Link id="l00670" /><CodeLine lineNumber="670"><Highlight kind="normal">  FunctionCallee RTLFn = getOrCreateRuntimeFunction(M, FnID);</Highlight></CodeLine>
<Link id="l00671" /><CodeLine lineNumber="671"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Fn = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;llvm::Function&gt;</a>(RTLFn.<a href="/docs/api/classes/llvm/functioncallee/#ac5d8da677233fa2e1e7039508ed56e0e">getCallee</a>());</Highlight></CodeLine>
<Link id="l00672" /><CodeLine lineNumber="672"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Fn &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Failed to create OpenMP runtime function pointer&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00673" /><CodeLine lineNumber="673"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Fn;</Highlight></CodeLine>
<Link id="l00674" /><CodeLine lineNumber="674"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00675" /><CodeLine lineNumber="675"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00676" /><CodeLine lineNumber="676" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a1af99f6f33b0db83a3e941fcb819fa29"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a1af99f6f33b0db83a3e941fcb819fa29">OpenMPIRBuilder::initialize</a>() &#123; initializeTypes(M); &#125;</Highlight></CodeLine>
<Link id="l00677" /><CodeLine lineNumber="677"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00678" /><CodeLine lineNumber="678" lineLink="#a6e4c46869d9d198562f7b8628814e407"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a6e4c46869d9d198562f7b8628814e407">raiseUserConstantDataAllocasToEntryBlock</a>(<a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder,</Highlight></CodeLine>
<Link id="l00679" /><CodeLine lineNumber="679"><Highlight kind="normal">                                                     <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/classes/llvm/function">Function</a>) &#123;</Highlight></CodeLine>
<Link id="l00680" /><CodeLine lineNumber="680"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &amp;EntryBlock = <a href="/docs/api/classes/llvm/function">Function</a>-&gt;<a href="/docs/api/classes/llvm/function/#a169f0c26ef46161741fdd120a806f853">getEntryBlock</a>();</Highlight></CodeLine>
<Link id="l00681" /><CodeLine lineNumber="681"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> MoveLocInst = EntryBlock.<a href="/docs/api/classes/llvm/basicblock/#a362b5e6097732cbc0d2fb555a1f73400">getFirstNonPHIIt</a>();</Highlight></CodeLine>
<Link id="l00682" /><CodeLine lineNumber="682"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00683" /><CodeLine lineNumber="683"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Loop over blocks looking for constant allocas, skipping the entry block</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00684" /><CodeLine lineNumber="684"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// as any allocas there are already in the desired location.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00685" /><CodeLine lineNumber="685"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> = std::next(<a href="/docs/api/classes/llvm/function">Function</a>-&gt;<a href="/docs/api/classes/llvm/function/#a88a5e60837674780a9d812d661897ac5">begin</a>(), 1); <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> != <a href="/docs/api/classes/llvm/function">Function</a>-&gt;<a href="/docs/api/classes/llvm/function/#ae4ca2261b8b901e415fda7feac5051ea">end</a>();</Highlight></CodeLine>
<Link id="l00686" /><CodeLine lineNumber="686"><Highlight kind="normal">       <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>++) &#123;</Highlight></CodeLine>
<Link id="l00687" /><CodeLine lineNumber="687"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Inst = <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;getReverseIterator()-&gt;begin();</Highlight></CodeLine>
<Link id="l00688" /><CodeLine lineNumber="688"><Highlight kind="normal">         Inst != <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;getReverseIterator()-&gt;end();) &#123;</Highlight></CodeLine>
<Link id="l00689" /><CodeLine lineNumber="689"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> = <a href="/docs/api/namespaces/llvm/#a3377eac88526e806d9d887c4a0ba2a73">dyn&#95;cast&#95;if&#95;present&lt;llvm::AllocaInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l00690" /><CodeLine lineNumber="690"><Highlight kind="normal">        Inst++;</Highlight></CodeLine>
<Link id="l00691" /><CodeLine lineNumber="691"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;ConstantData&gt;</a>(<a href="/docs/api/classes/llvm/allocainst">AllocaInst</a>-&gt;<a href="/docs/api/classes/llvm/allocainst/#af4283a4cef4e2b88f565d827d5857e14">getArraySize</a>()))</Highlight></CodeLine>
<Link id="l00692" /><CodeLine lineNumber="692"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00693" /><CodeLine lineNumber="693"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a>-&gt;<a href="/docs/api/classes/llvm/instruction/#ae3c2accff1fc7b0c4fc5ab15915573af">moveBeforePreserving</a>(MoveLocInst);</Highlight></CodeLine>
<Link id="l00694" /><CodeLine lineNumber="694"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00695" /><CodeLine lineNumber="695"><Highlight kind="normal">        Inst++;</Highlight></CodeLine>
<Link id="l00696" /><CodeLine lineNumber="696"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l00697" /><CodeLine lineNumber="697"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00698" /><CodeLine lineNumber="698"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00699" /><CodeLine lineNumber="699"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00700" /><CodeLine lineNumber="700"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00701" /><CodeLine lineNumber="701" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a784adc2347b72f745ff1239aef3a3c26"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a784adc2347b72f745ff1239aef3a3c26">OpenMPIRBuilder::finalize</a>(<a href="/docs/api/classes/llvm/function">Function</a> &#42;Fn) &#123;</Highlight></CodeLine>
<Link id="l00702" /><CodeLine lineNumber="702"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;BasicBlock &#42;, 32&gt;</a> ParallelRegionBlockSet;</Highlight></CodeLine>
<Link id="l00703" /><CodeLine lineNumber="703"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 32&gt;</a> Blocks;</Highlight></CodeLine>
<Link id="l00704" /><CodeLine lineNumber="704"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;OutlineInfo, 16&gt;</a> DeferredOutlines;</Highlight></CodeLine>
<Link id="l00705" /><CodeLine lineNumber="705"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (OutlineInfo &amp;OI : OutlineInfos) &#123;</Highlight></CodeLine>
<Link id="l00706" /><CodeLine lineNumber="706"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Skip functions that have not finalized yet; may happen with nested</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00707" /><CodeLine lineNumber="707"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// function generation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00708" /><CodeLine lineNumber="708"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Fn &amp;&amp; OI.<a href="/docs/api/classes/llvm/function/#a8743c58384e11cb6228f6f871304ad35">getFunction</a>() != Fn) &#123;</Highlight></CodeLine>
<Link id="l00709" /><CodeLine lineNumber="709"><Highlight kind="normal">      DeferredOutlines.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(OI);</Highlight></CodeLine>
<Link id="l00710" /><CodeLine lineNumber="710"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00711" /><CodeLine lineNumber="711"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00712" /><CodeLine lineNumber="712"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00713" /><CodeLine lineNumber="713"><Highlight kind="normal">    ParallelRegionBlockSet.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</Highlight></CodeLine>
<Link id="l00714" /><CodeLine lineNumber="714"><Highlight kind="normal">    Blocks.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</Highlight></CodeLine>
<Link id="l00715" /><CodeLine lineNumber="715"><Highlight kind="normal">    OI.collectBlocks(ParallelRegionBlockSet, Blocks);</Highlight></CodeLine>
<Link id="l00716" /><CodeLine lineNumber="716"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00717" /><CodeLine lineNumber="717"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function">Function</a> &#42;OuterFn = OI.<a href="/docs/api/classes/llvm/function/#a8743c58384e11cb6228f6f871304ad35">getFunction</a>();</Highlight></CodeLine>
<Link id="l00718" /><CodeLine lineNumber="718"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/codeextractoranalysiscache">CodeExtractorAnalysisCache</a> CEAC(&#42;OuterFn);</Highlight></CodeLine>
<Link id="l00719" /><CodeLine lineNumber="719"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If we generate code for the target device, we need to allocate</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00720" /><CodeLine lineNumber="720"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// struct for aggregate params in the device default alloca address space.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00721" /><CodeLine lineNumber="721"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// OpenMP runtime requires that the params of the extracted functions are</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00722" /><CodeLine lineNumber="722"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// passed as zero address space pointers. This flag ensures that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00723" /><CodeLine lineNumber="723"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// CodeExtractor generates correct code for extracted functions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00724" /><CodeLine lineNumber="724"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// which are used by OpenMP runtime.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00725" /><CodeLine lineNumber="725"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> ArgsInZeroAddressSpace = Config.isTargetDevice();</Highlight></CodeLine>
<Link id="l00726" /><CodeLine lineNumber="726"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/codeextractor">CodeExtractor</a> Extractor(Blocks, </Highlight><Highlight kind="comment">/&#42; DominatorTree &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00727" /><CodeLine lineNumber="727"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; AggregateArgs &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00728" /><CodeLine lineNumber="728"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; BlockFrequencyInfo &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00729" /><CodeLine lineNumber="729"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; BranchProbabilityInfo &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00730" /><CodeLine lineNumber="730"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; AssumptionCache &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00731" /><CodeLine lineNumber="731"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; AllowVarArgs &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00732" /><CodeLine lineNumber="732"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; AllowAlloca &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00733" /><CodeLine lineNumber="733"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; AllocaBlock&#42;/</Highlight><Highlight kind="normal"> OI.OuterAllocaBB,</Highlight></CodeLine>
<Link id="l00734" /><CodeLine lineNumber="734"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; Suffix &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="stringliteral">&quot;.omp&#95;par&quot;</Highlight><Highlight kind="normal">, ArgsInZeroAddressSpace);</Highlight></CodeLine>
<Link id="l00735" /><CodeLine lineNumber="735"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00736" /><CodeLine lineNumber="736"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Before     outlining: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OuterFn &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00737" /><CodeLine lineNumber="737"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Entry &quot;</Highlight><Highlight kind="normal"> &lt;&lt; OI.EntryBB-&gt;getName()</Highlight></CodeLine>
<Link id="l00738" /><CodeLine lineNumber="738"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; Exit: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; OI.ExitBB-&gt;getName() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00739" /><CodeLine lineNumber="739"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Extractor.isEligible() &amp;&amp;</Highlight></CodeLine>
<Link id="l00740" /><CodeLine lineNumber="740"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Expected OpenMP outlining to be possible!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00741" /><CodeLine lineNumber="741"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00742" /><CodeLine lineNumber="742"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;V : OI.ExcludeArgsFromAggregate)</Highlight></CodeLine>
<Link id="l00743" /><CodeLine lineNumber="743"><Highlight kind="normal">      Extractor.excludeArgFromAggregate(V);</Highlight></CodeLine>
<Link id="l00744" /><CodeLine lineNumber="744"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00745" /><CodeLine lineNumber="745"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function">Function</a> &#42;OutlinedFn = Extractor.extractCodeRegion(CEAC);</Highlight></CodeLine>
<Link id="l00746" /><CodeLine lineNumber="746"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00747" /><CodeLine lineNumber="747"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Forward target-cpu, target-features attributes to the outlined function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00748" /><CodeLine lineNumber="748"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> TargetCpuAttr = OuterFn-&gt;<a href="/docs/api/classes/llvm/function/#a4c319db4fe05c27cfe55bd133a87414d">getFnAttribute</a>(</Highlight><Highlight kind="stringliteral">&quot;target-cpu&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00749" /><CodeLine lineNumber="749"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TargetCpuAttr.isStringAttribute())</Highlight></CodeLine>
<Link id="l00750" /><CodeLine lineNumber="750"><Highlight kind="normal">      OutlinedFn-&gt;<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(TargetCpuAttr);</Highlight></CodeLine>
<Link id="l00751" /><CodeLine lineNumber="751"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00752" /><CodeLine lineNumber="752"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> TargetFeaturesAttr = OuterFn-&gt;<a href="/docs/api/classes/llvm/function/#a4c319db4fe05c27cfe55bd133a87414d">getFnAttribute</a>(</Highlight><Highlight kind="stringliteral">&quot;target-features&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00753" /><CodeLine lineNumber="753"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TargetFeaturesAttr.isStringAttribute())</Highlight></CodeLine>
<Link id="l00754" /><CodeLine lineNumber="754"><Highlight kind="normal">      OutlinedFn-&gt;<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(TargetFeaturesAttr);</Highlight></CodeLine>
<Link id="l00755" /><CodeLine lineNumber="755"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00756" /><CodeLine lineNumber="756"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After      outlining: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OuterFn &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00757" /><CodeLine lineNumber="757"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;   Outlined function: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OutlinedFn &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00758" /><CodeLine lineNumber="758"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn-&gt;<a href="/docs/api/classes/llvm/function/#acdd05db170cbfee8a0fcbc047b8504e5">getReturnType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#ae8eaa0b4eeac52a2b2282cb1bfd981ae">isVoidTy</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l00759" /><CodeLine lineNumber="759"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;OpenMP outlined functions should not return a value!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00760" /><CodeLine lineNumber="760"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00761" /><CodeLine lineNumber="761"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// For compability with the clang CG we move the outlined function after the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00762" /><CodeLine lineNumber="762"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// one with the parallel region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00763" /><CodeLine lineNumber="763"><Highlight kind="normal">    OutlinedFn-&gt;<a href="/docs/api/classes/llvm/function/#a29e0a562beb4b5d20eb0c426b363ceed">removeFromParent</a>();</Highlight></CodeLine>
<Link id="l00764" /><CodeLine lineNumber="764"><Highlight kind="normal">    M.getFunctionList().insertAfter(OuterFn-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>(), OutlinedFn);</Highlight></CodeLine>
<Link id="l00765" /><CodeLine lineNumber="765"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00766" /><CodeLine lineNumber="766"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Remove the artificial entry introduced by the extractor right away, we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00767" /><CodeLine lineNumber="767"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// made our own entry block after all.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00768" /><CodeLine lineNumber="768"><Highlight kind="normal">    &#123;</Highlight></CodeLine>
<Link id="l00769" /><CodeLine lineNumber="769"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &amp;ArtificialEntry = OutlinedFn-&gt;<a href="/docs/api/classes/llvm/function/#a169f0c26ef46161741fdd120a806f853">getEntryBlock</a>();</Highlight></CodeLine>
<Link id="l00770" /><CodeLine lineNumber="770"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ArtificialEntry.<a href="/docs/api/classes/llvm/basicblock/#a57f1945911ca1e95d0f51d7c3516b529">getUniqueSuccessor</a>() == OI.EntryBB);</Highlight></CodeLine>
<Link id="l00771" /><CodeLine lineNumber="771"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OI.EntryBB-&gt;getUniquePredecessor() == &amp;ArtificialEntry);</Highlight></CodeLine>
<Link id="l00772" /><CodeLine lineNumber="772"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Move instructions from the to-be-deleted ArtificialEntry to the entry</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00773" /><CodeLine lineNumber="773"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// basic block of the parallel region. CodeExtractor generates</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00774" /><CodeLine lineNumber="774"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// instructions to unwrap the aggregate argument and may sink</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00775" /><CodeLine lineNumber="775"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// allocas/bitcasts for values that are solely used in the outlined region</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00776" /><CodeLine lineNumber="776"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// and do not escape.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00777" /><CodeLine lineNumber="777"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!ArtificialEntry.<a href="/docs/api/classes/llvm/basicblock/#a266367eb01c634406b32f816d2d9c6bf">empty</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l00778" /><CodeLine lineNumber="778"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Expected instructions to add in the outlined region entry&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00779" /><CodeLine lineNumber="779"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock/#a6d3231fb84ed4182ec22e9442a87dbf8">BasicBlock::reverse&#95;iterator</a> It = ArtificialEntry.<a href="/docs/api/classes/llvm/basicblock/#a1c2af7a9e501d399f06ca7e10eef46e4">rbegin</a>(),</Highlight></CodeLine>
<Link id="l00780" /><CodeLine lineNumber="780"><Highlight kind="normal">                                        End = ArtificialEntry.<a href="/docs/api/classes/llvm/basicblock/#a9237251072bf6816163abc2d053212ee">rend</a>();</Highlight></CodeLine>
<Link id="l00781" /><CodeLine lineNumber="781"><Highlight kind="normal">           It != End;) &#123;</Highlight></CodeLine>
<Link id="l00782" /><CodeLine lineNumber="782"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/instruction">Instruction</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = &#42;It;</Highlight></CodeLine>
<Link id="l00783" /><CodeLine lineNumber="783"><Highlight kind="normal">        It++;</Highlight></CodeLine>
<Link id="l00784" /><CodeLine lineNumber="784"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00785" /><CodeLine lineNumber="785"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.isTerminator())</Highlight></CodeLine>
<Link id="l00786" /><CodeLine lineNumber="786"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00787" /><CodeLine lineNumber="787"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00788" /><CodeLine lineNumber="788"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.moveBeforePreserving(&#42;OI.EntryBB, OI.EntryBB-&gt;getFirstInsertionPt());</Highlight></CodeLine>
<Link id="l00789" /><CodeLine lineNumber="789"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l00790" /><CodeLine lineNumber="790"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00791" /><CodeLine lineNumber="791"><Highlight kind="normal">      OI.EntryBB-&gt;moveBefore(&amp;ArtificialEntry);</Highlight></CodeLine>
<Link id="l00792" /><CodeLine lineNumber="792"><Highlight kind="normal">      ArtificialEntry.<a href="/docs/api/classes/llvm/basicblock/#a8dd327a937563afdb08250abc43820b0">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l00793" /><CodeLine lineNumber="793"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00794" /><CodeLine lineNumber="794"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(&amp;OutlinedFn-&gt;<a href="/docs/api/classes/llvm/function/#a169f0c26ef46161741fdd120a806f853">getEntryBlock</a>() == OI.EntryBB);</Highlight></CodeLine>
<Link id="l00795" /><CodeLine lineNumber="795"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn &amp;&amp; OutlinedFn-&gt;<a href="/docs/api/classes/llvm/value/#aba0055050d741f60b6e0523507a2c79f">getNumUses</a>() == 1);</Highlight></CodeLine>
<Link id="l00796" /><CodeLine lineNumber="796"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00797" /><CodeLine lineNumber="797"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Run a user callback, e.g. to add attributes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00798" /><CodeLine lineNumber="798"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OI.PostOutlineCB)</Highlight></CodeLine>
<Link id="l00799" /><CodeLine lineNumber="799"><Highlight kind="normal">      OI.PostOutlineCB(&#42;OutlinedFn);</Highlight></CodeLine>
<Link id="l00800" /><CodeLine lineNumber="800"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00801" /><CodeLine lineNumber="801"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00802" /><CodeLine lineNumber="802"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remove work items that have been completed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00803" /><CodeLine lineNumber="803"><Highlight kind="normal">  OutlineInfos = std::move(DeferredOutlines);</Highlight></CodeLine>
<Link id="l00804" /><CodeLine lineNumber="804"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00805" /><CodeLine lineNumber="805"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The createTarget functions embeds user written code into</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00806" /><CodeLine lineNumber="806"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the target region which may inject allocas which need to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00807" /><CodeLine lineNumber="807"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// be moved to the entry block of our target or risk malformed</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00808" /><CodeLine lineNumber="808"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// optimisations by later passes, this is only relevant for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00809" /><CodeLine lineNumber="809"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the device pass which appears to be a little more delicate</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00810" /><CodeLine lineNumber="810"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// when it comes to optimisations (however, we do not block on</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00811" /><CodeLine lineNumber="811"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that here, it&#39;s up to the inserter to the list to do so).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00812" /><CodeLine lineNumber="812"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This notbaly has to occur after the OutlinedInfo candidates</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00813" /><CodeLine lineNumber="813"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// have been extracted so we have an end product that will not</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00814" /><CodeLine lineNumber="814"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// be implicitly adversely affected by any raises unless</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00815" /><CodeLine lineNumber="815"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// intentionally appended to the list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00816" /><CodeLine lineNumber="816"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// NOTE: This only does so for ConstantData, it could be extended</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00817" /><CodeLine lineNumber="817"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to ConstantExpr&#39;s with further effort, however, they should</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00818" /><CodeLine lineNumber="818"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// largely be folded when they get here. Extending it to runtime</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00819" /><CodeLine lineNumber="819"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// defined/read+writeable allocation sizes would be non-trivial</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00820" /><CodeLine lineNumber="820"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// (need to factor in movement of any stores to variables the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00821" /><CodeLine lineNumber="821"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// allocation size depends on, as well as the usual loads,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00822" /><CodeLine lineNumber="822"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// otherwise it&#39;ll yield the wrong result after movement) and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00823" /><CodeLine lineNumber="823"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// likely be more suitable as an LLVM optimisation pass.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00824" /><CodeLine lineNumber="824"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : ConstantAllocaRaiseCandidates)</Highlight></CodeLine>
<Link id="l00825" /><CodeLine lineNumber="825"><Highlight kind="normal">    <a href="#a6e4c46869d9d198562f7b8628814e407">raiseUserConstantDataAllocasToEntryBlock</a>(Builder, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l00826" /><CodeLine lineNumber="826"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00827" /><CodeLine lineNumber="827"><Highlight kind="normal">  EmitMetadataErrorReportFunctionTy &amp;&amp;ErrorReportFn =</Highlight></CodeLine>
<Link id="l00828" /><CodeLine lineNumber="828"><Highlight kind="normal">      &#91;&#93;(EmitMetadataErrorKind Kind,</Highlight></CodeLine>
<Link id="l00829" /><CodeLine lineNumber="829"><Highlight kind="normal">         </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp;EntryInfo) -&gt; </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00830" /><CodeLine lineNumber="830"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Error of kind: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; Kind</Highlight></CodeLine>
<Link id="l00831" /><CodeLine lineNumber="831"><Highlight kind="normal">           &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; when emitting offload entries and metadata during &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00832" /><CodeLine lineNumber="832"><Highlight kind="normal">              </Highlight><Highlight kind="stringliteral">&quot;OMPIRBuilder finalization \\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00833" /><CodeLine lineNumber="833"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l00834" /><CodeLine lineNumber="834"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00835" /><CodeLine lineNumber="835"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!OffloadInfoManager.empty())</Highlight></CodeLine>
<Link id="l00836" /><CodeLine lineNumber="836"><Highlight kind="normal">    createOffloadEntriesAndInfoMetadata(ErrorReportFn);</Highlight></CodeLine>
<Link id="l00837" /><CodeLine lineNumber="837"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00838" /><CodeLine lineNumber="838"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.EmitLLVMUsedMetaInfo.value&#95;or(</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">)) &#123;</Highlight></CodeLine>
<Link id="l00839" /><CodeLine lineNumber="839"><Highlight kind="normal">    std::vector&lt;WeakTrackingVH&gt; LLVMCompilerUsed = &#123;</Highlight></CodeLine>
<Link id="l00840" /><CodeLine lineNumber="840"><Highlight kind="normal">        M.getGlobalVariable(</Highlight><Highlight kind="stringliteral">&quot;&#95;&#95;openmp&#95;nvptx&#95;data&#95;transfer&#95;temporary&#95;storage&quot;</Highlight><Highlight kind="normal">)&#125;;</Highlight></CodeLine>
<Link id="l00841" /><CodeLine lineNumber="841"><Highlight kind="normal">    emitUsed(</Highlight><Highlight kind="stringliteral">&quot;llvm.compiler.used&quot;</Highlight><Highlight kind="normal">, LLVMCompilerUsed);</Highlight></CodeLine>
<Link id="l00842" /><CodeLine lineNumber="842"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00843" /><CodeLine lineNumber="843"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00844" /><CodeLine lineNumber="844"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00845" /><CodeLine lineNumber="845" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ad66949e2e846451e61d9c8f34014ea31"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#ad66949e2e846451e61d9c8f34014ea31">OpenMPIRBuilder::~OpenMPIRBuilder</a>() &#123;</Highlight></CodeLine>
<Link id="l00846" /><CodeLine lineNumber="846"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlineInfos.empty() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;There must be no outstanding outlinings&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00847" /><CodeLine lineNumber="847"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00848" /><CodeLine lineNumber="848"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00849" /><CodeLine lineNumber="849"><Highlight kind="normal"><a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;OpenMPIRBuilder::createGlobalFlag(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a>, <a href="/docs/api/classes/llvm/stringref">StringRef</a> Name) &#123;</Highlight></CodeLine>
<Link id="l00850" /><CodeLine lineNumber="850"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/integertype">IntegerType</a> &#42;I32Ty = <a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(M.getContext());</Highlight></CodeLine>
<Link id="l00851" /><CodeLine lineNumber="851"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/structs/llvm/omp/gv">GV</a> =</Highlight></CodeLine>
<Link id="l00852" /><CodeLine lineNumber="852"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/globalvariable">GlobalVariable</a>(M, I32Ty,</Highlight></CodeLine>
<Link id="l00853" /><CodeLine lineNumber="853"><Highlight kind="normal">                         </Highlight><Highlight kind="comment">/&#42; isConstant = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca696bb1c9b0b0e76bb70c61f68866452a">GlobalValue::WeakODRLinkage</a>,</Highlight></CodeLine>
<Link id="l00854" /><CodeLine lineNumber="854"><Highlight kind="normal">                         ConstantInt::get(I32Ty, <a href="/docs/api/classes/llvm/value">Value</a>), Name);</Highlight></CodeLine>
<Link id="l00855" /><CodeLine lineNumber="855"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/omp/gv">GV</a>-&gt;setVisibility(<a href="/docs/api/classes/llvm/globalvalue/#a9141f967188383108a69cc1b8ed3c195a7eade123587a08e674f2ca72e2443771">GlobalValue::HiddenVisibility</a>);</Highlight></CodeLine>
<Link id="l00856" /><CodeLine lineNumber="856"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00857" /><CodeLine lineNumber="857"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/omp/gv">GV</a>;</Highlight></CodeLine>
<Link id="l00858" /><CodeLine lineNumber="858"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00859" /><CodeLine lineNumber="859"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00860" /><CodeLine lineNumber="860"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitUsed(<a href="/docs/api/classes/llvm/stringref">StringRef</a> Name, <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;WeakTrackingVH&gt;</a> List) &#123;</Highlight></CodeLine>
<Link id="l00861" /><CodeLine lineNumber="861"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (List.empty())</Highlight></CodeLine>
<Link id="l00862" /><CodeLine lineNumber="862"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00863" /><CodeLine lineNumber="863"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00864" /><CodeLine lineNumber="864"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Convert List to what ConstantArray needs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00865" /><CodeLine lineNumber="865"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Constant &#42;, 8&gt;</a> UsedArray;</Highlight></CodeLine>
<Link id="l00866" /><CodeLine lineNumber="866"><Highlight kind="normal">  UsedArray.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(List.size());</Highlight></CodeLine>
<Link id="l00867" /><CodeLine lineNumber="867"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = List.size(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</Highlight></CodeLine>
<Link id="l00868" /><CodeLine lineNumber="868"><Highlight kind="normal">    UsedArray&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; = <a href="/docs/api/classes/llvm/constantexpr/#a28bf8984fbfb08fd27df435e631e6832">ConstantExpr::getPointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l00869" /><CodeLine lineNumber="869"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Constant&gt;</a>(&amp;&#42;List&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;), Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l00870" /><CodeLine lineNumber="870"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00871" /><CodeLine lineNumber="871"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UsedArray.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</Highlight></CodeLine>
<Link id="l00872" /><CodeLine lineNumber="872"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00873" /><CodeLine lineNumber="873"><Highlight kind="normal">  <a href="/docs/api/classes/arraytype">ArrayType</a> &#42;ATy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), UsedArray.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>());</Highlight></CodeLine>
<Link id="l00874" /><CodeLine lineNumber="874"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00875" /><CodeLine lineNumber="875"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/structs/llvm/omp/gv">GV</a> = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/globalvariable">GlobalVariable</a>(M, ATy, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca96ad6314ba9210b223b93dc3e15baf99">GlobalValue::AppendingLinkage</a>,</Highlight></CodeLine>
<Link id="l00876" /><CodeLine lineNumber="876"><Highlight kind="normal">                                <a href="/docs/api/classes/llvm/constantarray/#a0900dacdc7ad8e3ea0cc92993c7fd422">ConstantArray::get</a>(ATy, UsedArray), Name);</Highlight></CodeLine>
<Link id="l00877" /><CodeLine lineNumber="877"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00878" /><CodeLine lineNumber="878"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/omp/gv">GV</a>-&gt;setSection(</Highlight><Highlight kind="stringliteral">&quot;llvm.metadata&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00879" /><CodeLine lineNumber="879"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00880" /><CodeLine lineNumber="880"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00881" /><CodeLine lineNumber="881"><Highlight kind="normal"><a href="/docs/api/classes/llvm/globalvariable">GlobalVariable</a> &#42;</Highlight></CodeLine>
<Link id="l00882" /><CodeLine lineNumber="882"><Highlight kind="normal">OpenMPIRBuilder::emitKernelExecutionMode(<a href="/docs/api/classes/llvm/stringref">StringRef</a> KernelName,</Highlight></CodeLine>
<Link id="l00883" /><CodeLine lineNumber="883"><Highlight kind="normal">                                         <a href="/docs/api/namespaces/llvm/omp/#aa0c0d79dafb0d22308ce48808689f430">OMPTgtExecModeFlags</a> <a href="/docs/api/files/lib/lib/codegen/regallocevictionadvisor-cpp/#aef71c4b21823f236e70cc6d62375adcd">Mode</a>) &#123;</Highlight></CodeLine>
<Link id="l00884" /><CodeLine lineNumber="884"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Int8Ty = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae7be2e1490f01c049d748436f03760c5">getInt8Ty</a>();</Highlight></CodeLine>
<Link id="l00885" /><CodeLine lineNumber="885"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;GVMode = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> GlobalVariable(</Highlight></CodeLine>
<Link id="l00886" /><CodeLine lineNumber="886"><Highlight kind="normal">      M, Int8Ty, </Highlight><Highlight kind="comment">/&#42;isConstant=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f">GlobalValue::WeakAnyLinkage</a>,</Highlight></CodeLine>
<Link id="l00887" /><CodeLine lineNumber="887"><Highlight kind="normal">      ConstantInt::get(Int8Ty, <a href="/docs/api/files/lib/lib/codegen/regallocevictionadvisor-cpp/#aef71c4b21823f236e70cc6d62375adcd">Mode</a>), Twine(KernelName, </Highlight><Highlight kind="stringliteral">&quot;&#95;exec&#95;mode&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00888" /><CodeLine lineNumber="888"><Highlight kind="normal">  GVMode-&gt;setVisibility(<a href="/docs/api/classes/llvm/globalvalue/#a9141f967188383108a69cc1b8ed3c195ae1cc9a390520055573d459de25747caa">GlobalVariable::ProtectedVisibility</a>);</Highlight></CodeLine>
<Link id="l00889" /><CodeLine lineNumber="889"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> GVMode;</Highlight></CodeLine>
<Link id="l00890" /><CodeLine lineNumber="890"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00891" /><CodeLine lineNumber="891"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00892" /><CodeLine lineNumber="892"><Highlight kind="normal"><a href="/docs/api/classes/llvm/constant">Constant</a> &#42;OpenMPIRBuilder::getOrCreateIdent(<a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr,</Highlight></CodeLine>
<Link id="l00893" /><CodeLine lineNumber="893"><Highlight kind="normal">                                            uint32&#95;t SrcLocStrSize,</Highlight></CodeLine>
<Link id="l00894" /><CodeLine lineNumber="894"><Highlight kind="normal">                                            <a href="/docs/api/namespaces/llvm/omp/#a0e821d8251c97d66ca185efe2f8ffde2">IdentFlag</a> LocFlags,</Highlight></CodeLine>
<Link id="l00895" /><CodeLine lineNumber="895"><Highlight kind="normal">                                            </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Reserve2Flags) &#123;</Highlight></CodeLine>
<Link id="l00896" /><CodeLine lineNumber="896"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Enable &quot;C-mode&quot;.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00897" /><CodeLine lineNumber="897"><Highlight kind="normal">  LocFlags |= OMP&#95;IDENT&#95;FLAG&#95;KMPC;</Highlight></CodeLine>
<Link id="l00898" /><CodeLine lineNumber="898"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00899" /><CodeLine lineNumber="899"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;&amp;Ident =</Highlight></CodeLine>
<Link id="l00900" /><CodeLine lineNumber="900"><Highlight kind="normal">      IdentMap&#91;&#123;SrcLocStr, uint64&#95;t(LocFlags) &lt;&lt; 31 | Reserve2Flags&#125;&#93;;</Highlight></CodeLine>
<Link id="l00901" /><CodeLine lineNumber="901"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Ident) &#123;</Highlight></CodeLine>
<Link id="l00902" /><CodeLine lineNumber="902"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;I32Null = <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">ConstantInt::getNullValue</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>);</Highlight></CodeLine>
<Link id="l00903" /><CodeLine lineNumber="903"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;IdentData&#91;&#93; = &#123;I32Null,</Highlight></CodeLine>
<Link id="l00904" /><CodeLine lineNumber="904"><Highlight kind="normal">                             ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, uint32&#95;t(LocFlags)),</Highlight></CodeLine>
<Link id="l00905" /><CodeLine lineNumber="905"><Highlight kind="normal">                             ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, Reserve2Flags),</Highlight></CodeLine>
<Link id="l00906" /><CodeLine lineNumber="906"><Highlight kind="normal">                             ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, SrcLocStrSize), SrcLocStr&#125;;</Highlight></CodeLine>
<Link id="l00907" /><CodeLine lineNumber="907"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;Initializer =</Highlight></CodeLine>
<Link id="l00908" /><CodeLine lineNumber="908"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/constantstruct/#a54fcfa620deb80373f489ba2fdad7643">ConstantStruct::get</a>(OpenMPIRBuilder::Ident, IdentData);</Highlight></CodeLine>
<Link id="l00909" /><CodeLine lineNumber="909"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00910" /><CodeLine lineNumber="910"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Look for existing encoding of the location + flags, not needed but</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00911" /><CodeLine lineNumber="911"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// minimizes the difference to the existing solution while we transition.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00912" /><CodeLine lineNumber="912"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (GlobalVariable &amp;GV : <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.globals())</Highlight></CodeLine>
<Link id="l00913" /><CodeLine lineNumber="913"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (GV.getValueType() == OpenMPIRBuilder::Ident &amp;&amp; GV.hasInitializer())</Highlight></CodeLine>
<Link id="l00914" /><CodeLine lineNumber="914"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (GV.getInitializer() == Initializer)</Highlight></CodeLine>
<Link id="l00915" /><CodeLine lineNumber="915"><Highlight kind="normal">          Ident = &amp;GV;</Highlight></CodeLine>
<Link id="l00916" /><CodeLine lineNumber="916"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00917" /><CodeLine lineNumber="917"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Ident) &#123;</Highlight></CodeLine>
<Link id="l00918" /><CodeLine lineNumber="918"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;GV = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> GlobalVariable(</Highlight></CodeLine>
<Link id="l00919" /><CodeLine lineNumber="919"><Highlight kind="normal">          M, OpenMPIRBuilder::Ident,</Highlight></CodeLine>
<Link id="l00920" /><CodeLine lineNumber="920"><Highlight kind="normal">          </Highlight><Highlight kind="comment">/&#42; isConstant = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">GlobalValue::PrivateLinkage</a>, Initializer, </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00921" /><CodeLine lineNumber="921"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0">GlobalValue::NotThreadLocal</a>,</Highlight></CodeLine>
<Link id="l00922" /><CodeLine lineNumber="922"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l00923" /><CodeLine lineNumber="923"><Highlight kind="normal">      GV-&gt;setUnnamedAddr(<a href="/docs/api/classes/llvm/globalvalue/#ae8df4be75bfc50b1eadd74e85c25fa45a4cc6684df7b4a92b1dec6fce3264fac8">GlobalValue::UnnamedAddr::Global</a>);</Highlight></CodeLine>
<Link id="l00924" /><CodeLine lineNumber="924"><Highlight kind="normal">      GV-&gt;setAlignment(<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/arg/key/#a6b334a5f83504ebc99cc59f4f333ff98">Align</a>(8));</Highlight></CodeLine>
<Link id="l00925" /><CodeLine lineNumber="925"><Highlight kind="normal">      Ident = GV;</Highlight></CodeLine>
<Link id="l00926" /><CodeLine lineNumber="926"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00927" /><CodeLine lineNumber="927"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00928" /><CodeLine lineNumber="928"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00929" /><CodeLine lineNumber="929"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/constantexpr/#a28bf8984fbfb08fd27df435e631e6832">ConstantExpr::getPointerBitCastOrAddrSpaceCast</a>(Ident, IdentPtr);</Highlight></CodeLine>
<Link id="l00930" /><CodeLine lineNumber="930"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00931" /><CodeLine lineNumber="931"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00932" /><CodeLine lineNumber="932"><Highlight kind="normal"><a href="/docs/api/classes/llvm/constant">Constant</a> &#42;OpenMPIRBuilder::getOrCreateSrcLocStr(<a href="/docs/api/classes/llvm/stringref">StringRef</a> LocStr,</Highlight></CodeLine>
<Link id="l00933" /><CodeLine lineNumber="933"><Highlight kind="normal">                                                uint32&#95;t &amp;SrcLocStrSize) &#123;</Highlight></CodeLine>
<Link id="l00934" /><CodeLine lineNumber="934"><Highlight kind="normal">  SrcLocStrSize = LocStr.<a href="/docs/api/classes/llvm/stringref/#a5db9240c74644c67759dd0f901fc3c7d">size</a>();</Highlight></CodeLine>
<Link id="l00935" /><CodeLine lineNumber="935"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;&amp;SrcLocStr = SrcLocStrMap&#91;LocStr&#93;;</Highlight></CodeLine>
<Link id="l00936" /><CodeLine lineNumber="936"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SrcLocStr) &#123;</Highlight></CodeLine>
<Link id="l00937" /><CodeLine lineNumber="937"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;Initializer =</Highlight></CodeLine>
<Link id="l00938" /><CodeLine lineNumber="938"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/constantdataarray/#a3edef3fa47c611d3d10606591213e57b">ConstantDataArray::getString</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), LocStr);</Highlight></CodeLine>
<Link id="l00939" /><CodeLine lineNumber="939"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00940" /><CodeLine lineNumber="940"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Look for existing encoding of the location, not needed but minimizes the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00941" /><CodeLine lineNumber="941"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// difference to the existing solution while we transition.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00942" /><CodeLine lineNumber="942"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (GlobalVariable &amp;GV : <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.globals())</Highlight></CodeLine>
<Link id="l00943" /><CodeLine lineNumber="943"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (GV.isConstant() &amp;&amp; GV.hasInitializer() &amp;&amp;</Highlight></CodeLine>
<Link id="l00944" /><CodeLine lineNumber="944"><Highlight kind="normal">          GV.getInitializer() == Initializer)</Highlight></CodeLine>
<Link id="l00945" /><CodeLine lineNumber="945"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SrcLocStr = <a href="/docs/api/classes/llvm/constantexpr/#a1f469b1f703519ae25ce564c8704310f">ConstantExpr::getPointerCast</a>(&amp;GV, Int8Ptr);</Highlight></CodeLine>
<Link id="l00946" /><CodeLine lineNumber="946"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00947" /><CodeLine lineNumber="947"><Highlight kind="normal">    SrcLocStr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#af377188a476a2d71184b0498a136fd1d">CreateGlobalString</a>(LocStr, </Highlight><Highlight kind="comment">/&#42; Name &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00948" /><CodeLine lineNumber="948"><Highlight kind="normal">                                           </Highlight><Highlight kind="comment">/&#42; AddressSpace &#42;/</Highlight><Highlight kind="normal"> 0, &amp;M);</Highlight></CodeLine>
<Link id="l00949" /><CodeLine lineNumber="949"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00950" /><CodeLine lineNumber="950"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SrcLocStr;</Highlight></CodeLine>
<Link id="l00951" /><CodeLine lineNumber="951"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00952" /><CodeLine lineNumber="952"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00953" /><CodeLine lineNumber="953"><Highlight kind="normal"><a href="/docs/api/classes/llvm/constant">Constant</a> &#42;OpenMPIRBuilder::getOrCreateSrcLocStr(<a href="/docs/api/classes/llvm/stringref">StringRef</a> FunctionName,</Highlight></CodeLine>
<Link id="l00954" /><CodeLine lineNumber="954"><Highlight kind="normal">                                                <a href="/docs/api/classes/llvm/stringref">StringRef</a> FileName,</Highlight></CodeLine>
<Link id="l00955" /><CodeLine lineNumber="955"><Highlight kind="normal">                                                </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Line, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Column,</Highlight></CodeLine>
<Link id="l00956" /><CodeLine lineNumber="956"><Highlight kind="normal">                                                uint32&#95;t &amp;SrcLocStrSize) &#123;</Highlight></CodeLine>
<Link id="l00957" /><CodeLine lineNumber="957"><Highlight kind="normal">  SmallString&lt;128&gt; Buffer;</Highlight></CodeLine>
<Link id="l00958" /><CodeLine lineNumber="958"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="charliteral">&#39;;&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00959" /><CodeLine lineNumber="959"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallstring/#ac22cf1a1c08b7ccaefc51508536312a4">append</a>(FileName);</Highlight></CodeLine>
<Link id="l00960" /><CodeLine lineNumber="960"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="charliteral">&#39;;&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00961" /><CodeLine lineNumber="961"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallstring/#ac22cf1a1c08b7ccaefc51508536312a4">append</a>(FunctionName);</Highlight></CodeLine>
<Link id="l00962" /><CodeLine lineNumber="962"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="charliteral">&#39;;&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00963" /><CodeLine lineNumber="963"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallstring/#ac22cf1a1c08b7ccaefc51508536312a4">append</a>(std::to&#95;string(Line));</Highlight></CodeLine>
<Link id="l00964" /><CodeLine lineNumber="964"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="charliteral">&#39;;&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00965" /><CodeLine lineNumber="965"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallstring/#ac22cf1a1c08b7ccaefc51508536312a4">append</a>(std::to&#95;string(Column));</Highlight></CodeLine>
<Link id="l00966" /><CodeLine lineNumber="966"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="charliteral">&#39;;&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00967" /><CodeLine lineNumber="967"><Highlight kind="normal">  Buffer.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="charliteral">&#39;;&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00968" /><CodeLine lineNumber="968"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateSrcLocStr(Buffer.<a href="/docs/api/classes/llvm/smallstring/#af5dd7241878be5eed07736eb156bb10b">str</a>(), SrcLocStrSize);</Highlight></CodeLine>
<Link id="l00969" /><CodeLine lineNumber="969"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00970" /><CodeLine lineNumber="970"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00971" /><CodeLine lineNumber="971"><Highlight kind="normal"><a href="/docs/api/classes/llvm/constant">Constant</a> &#42;</Highlight></CodeLine>
<Link id="l00972" /><CodeLine lineNumber="972"><Highlight kind="normal">OpenMPIRBuilder::getOrCreateDefaultSrcLocStr(uint32&#95;t &amp;SrcLocStrSize) &#123;</Highlight></CodeLine>
<Link id="l00973" /><CodeLine lineNumber="973"><Highlight kind="normal">  StringRef UnknownLoc = </Highlight><Highlight kind="stringliteral">&quot;;unknown;unknown;0;0;;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00974" /><CodeLine lineNumber="974"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateSrcLocStr(UnknownLoc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l00975" /><CodeLine lineNumber="975"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00976" /><CodeLine lineNumber="976"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00977" /><CodeLine lineNumber="977"><Highlight kind="normal"><a href="/docs/api/classes/llvm/constant">Constant</a> &#42;OpenMPIRBuilder::getOrCreateSrcLocStr(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</Highlight></CodeLine>
<Link id="l00978" /><CodeLine lineNumber="978"><Highlight kind="normal">                                                uint32&#95;t &amp;SrcLocStrSize,</Highlight></CodeLine>
<Link id="l00979" /><CodeLine lineNumber="979"><Highlight kind="normal">                                                <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</Highlight></CodeLine>
<Link id="l00980" /><CodeLine lineNumber="980"><Highlight kind="normal">  DILocation &#42;DIL = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.get();</Highlight></CodeLine>
<Link id="l00981" /><CodeLine lineNumber="981"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DIL)</Highlight></CodeLine>
<Link id="l00982" /><CodeLine lineNumber="982"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateDefaultSrcLocStr(SrcLocStrSize);</Highlight></CodeLine>
<Link id="l00983" /><CodeLine lineNumber="983"><Highlight kind="normal">  StringRef FileName = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getName();</Highlight></CodeLine>
<Link id="l00984" /><CodeLine lineNumber="984"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DIFile &#42;DIF = DIL-&gt;getFile())</Highlight></CodeLine>
<Link id="l00985" /><CodeLine lineNumber="985"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (std::optional&lt;StringRef&gt; Source = DIF-&gt;getSource())</Highlight></CodeLine>
<Link id="l00986" /><CodeLine lineNumber="986"><Highlight kind="normal">      FileName = &#42;<a href="/docs/api/namespaces/llvm/sched/#ab8d854a5ce2331586bcc6830cca52f0fac13545a6345c7d5b3c9cc8932ad3b0e9">Source</a>;</Highlight></CodeLine>
<Link id="l00987" /><CodeLine lineNumber="987"><Highlight kind="normal">  StringRef <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> = DIL-&gt;getScope()-&gt;getSubprogram()-&gt;getName();</Highlight></CodeLine>
<Link id="l00988" /><CodeLine lineNumber="988"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a>.empty() &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</Highlight></CodeLine>
<Link id="l00989" /><CodeLine lineNumber="989"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getName();</Highlight></CodeLine>
<Link id="l00990" /><CodeLine lineNumber="990"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateSrcLocStr(Function, FileName, DIL-&gt;getLine(),</Highlight></CodeLine>
<Link id="l00991" /><CodeLine lineNumber="991"><Highlight kind="normal">                              DIL-&gt;getColumn(), SrcLocStrSize);</Highlight></CodeLine>
<Link id="l00992" /><CodeLine lineNumber="992"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00993" /><CodeLine lineNumber="993"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00994" /><CodeLine lineNumber="994"><Highlight kind="normal"><a href="/docs/api/classes/llvm/constant">Constant</a> &#42;OpenMPIRBuilder::getOrCreateSrcLocStr(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l00995" /><CodeLine lineNumber="995"><Highlight kind="normal">                                                uint32&#95;t &amp;SrcLocStrSize) &#123;</Highlight></CodeLine>
<Link id="l00996" /><CodeLine lineNumber="996"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateSrcLocStr(Loc.DL, SrcLocStrSize,</Highlight></CodeLine>
<Link id="l00997" /><CodeLine lineNumber="997"><Highlight kind="normal">                              Loc.IP.getBlock()-&gt;getParent());</Highlight></CodeLine>
<Link id="l00998" /><CodeLine lineNumber="998"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00999" /><CodeLine lineNumber="999"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01000" /><CodeLine lineNumber="1000"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::getOrCreateThreadID(<a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident) &#123;</Highlight></CodeLine>
<Link id="l01001" /><CodeLine lineNumber="1001"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l01002" /><CodeLine lineNumber="1002"><Highlight kind="normal">      getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;global&#95;thread&#95;num), Ident,</Highlight></CodeLine>
<Link id="l01003" /><CodeLine lineNumber="1003"><Highlight kind="normal">      </Highlight><Highlight kind="stringliteral">&quot;omp&#95;global&#95;thread&#95;num&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01004" /><CodeLine lineNumber="1004"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01005" /><CodeLine lineNumber="1005"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01006" /><CodeLine lineNumber="1006"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l01007" /><CodeLine lineNumber="1007" lineLink="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07">OpenMPIRBuilder::createBarrier</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/directive">Directive</a> Kind,</Highlight></CodeLine>
<Link id="l01008" /><CodeLine lineNumber="1008"><Highlight kind="normal">                               </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> ForceSimpleCall, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> CheckCancelFlag) &#123;</Highlight></CodeLine>
<Link id="l01009" /><CodeLine lineNumber="1009"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l01010" /><CodeLine lineNumber="1010"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP;</Highlight></CodeLine>
<Link id="l01011" /><CodeLine lineNumber="1011"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01012" /><CodeLine lineNumber="1012"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build call &#95;&#95;kmpc&#95;cancel&#95;barrier(loc, thread&#95;id) or</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01013" /><CodeLine lineNumber="1013"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//            &#95;&#95;kmpc&#95;barrier(loc, thread&#95;id);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01014" /><CodeLine lineNumber="1014"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01015" /><CodeLine lineNumber="1015"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a0e821d8251c97d66ca185efe2f8ffde2">IdentFlag</a> BarrierLocFlags;</Highlight></CodeLine>
<Link id="l01016" /><CodeLine lineNumber="1016"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (Kind) &#123;</Highlight></CodeLine>
<Link id="l01017" /><CodeLine lineNumber="1017"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPD&#95;for:</Highlight></CodeLine>
<Link id="l01018" /><CodeLine lineNumber="1018"><Highlight kind="normal">    BarrierLocFlags = OMP&#95;IDENT&#95;FLAG&#95;BARRIER&#95;IMPL&#95;FOR;</Highlight></CodeLine>
<Link id="l01019" /><CodeLine lineNumber="1019"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01020" /><CodeLine lineNumber="1020"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPD&#95;sections:</Highlight></CodeLine>
<Link id="l01021" /><CodeLine lineNumber="1021"><Highlight kind="normal">    BarrierLocFlags = OMP&#95;IDENT&#95;FLAG&#95;BARRIER&#95;IMPL&#95;SECTIONS;</Highlight></CodeLine>
<Link id="l01022" /><CodeLine lineNumber="1022"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01023" /><CodeLine lineNumber="1023"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPD&#95;single:</Highlight></CodeLine>
<Link id="l01024" /><CodeLine lineNumber="1024"><Highlight kind="normal">    BarrierLocFlags = OMP&#95;IDENT&#95;FLAG&#95;BARRIER&#95;IMPL&#95;SINGLE;</Highlight></CodeLine>
<Link id="l01025" /><CodeLine lineNumber="1025"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01026" /><CodeLine lineNumber="1026"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPD&#95;barrier:</Highlight></CodeLine>
<Link id="l01027" /><CodeLine lineNumber="1027"><Highlight kind="normal">    BarrierLocFlags = OMP&#95;IDENT&#95;FLAG&#95;BARRIER&#95;EXPL;</Highlight></CodeLine>
<Link id="l01028" /><CodeLine lineNumber="1028"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01029" /><CodeLine lineNumber="1029"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l01030" /><CodeLine lineNumber="1030"><Highlight kind="normal">    BarrierLocFlags = OMP&#95;IDENT&#95;FLAG&#95;BARRIER&#95;IMPL;</Highlight></CodeLine>
<Link id="l01031" /><CodeLine lineNumber="1031"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01032" /><CodeLine lineNumber="1032"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01033" /><CodeLine lineNumber="1033"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01034" /><CodeLine lineNumber="1034"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l01035" /><CodeLine lineNumber="1035"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01036" /><CodeLine lineNumber="1036"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l01037" /><CodeLine lineNumber="1037"><Highlight kind="normal">      getOrCreateIdent(SrcLocStr, SrcLocStrSize, BarrierLocFlags),</Highlight></CodeLine>
<Link id="l01038" /><CodeLine lineNumber="1038"><Highlight kind="normal">      getOrCreateThreadID(getOrCreateIdent(SrcLocStr, SrcLocStrSize))&#125;;</Highlight></CodeLine>
<Link id="l01039" /><CodeLine lineNumber="1039"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01040" /><CodeLine lineNumber="1040"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we are in a cancellable parallel region, barriers are cancellation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01041" /><CodeLine lineNumber="1041"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// points.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01042" /><CodeLine lineNumber="1042"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Check why we would force simple calls or to ignore the cancel flag.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01043" /><CodeLine lineNumber="1043"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> UseCancelBarrier =</Highlight></CodeLine>
<Link id="l01044" /><CodeLine lineNumber="1044"><Highlight kind="normal">      !ForceSimpleCall &amp;&amp; isLastFinalizationInfoCancellable(OMPD&#95;parallel);</Highlight></CodeLine>
<Link id="l01045" /><CodeLine lineNumber="1045"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01046" /><CodeLine lineNumber="1046"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Result =</Highlight></CodeLine>
<Link id="l01047" /><CodeLine lineNumber="1047"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l01048" /><CodeLine lineNumber="1048"><Highlight kind="normal">                             UseCancelBarrier ? OMPRTL&#95;&#95;&#95;kmpc&#95;cancel&#95;barrier</Highlight></CodeLine>
<Link id="l01049" /><CodeLine lineNumber="1049"><Highlight kind="normal">                                              : OMPRTL&#95;&#95;&#95;kmpc&#95;barrier),</Highlight></CodeLine>
<Link id="l01050" /><CodeLine lineNumber="1050"><Highlight kind="normal">                         Args);</Highlight></CodeLine>
<Link id="l01051" /><CodeLine lineNumber="1051"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01052" /><CodeLine lineNumber="1052"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UseCancelBarrier &amp;&amp; CheckCancelFlag)</Highlight></CodeLine>
<Link id="l01053" /><CodeLine lineNumber="1053"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/error">Error</a> Err = emitCancelationCheckImpl(Result, OMPD&#95;parallel))</Highlight></CodeLine>
<Link id="l01054" /><CodeLine lineNumber="1054"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l01055" /><CodeLine lineNumber="1055"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01056" /><CodeLine lineNumber="1056"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l01057" /><CodeLine lineNumber="1057"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01058" /><CodeLine lineNumber="1058"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01059" /><CodeLine lineNumber="1059"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l01060" /><CodeLine lineNumber="1060" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a04285415a321e48322c08f3b9185540e"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#a04285415a321e48322c08f3b9185540e">OpenMPIRBuilder::createCancel</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l01061" /><CodeLine lineNumber="1061"><Highlight kind="normal">                              <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCondition,</Highlight></CodeLine>
<Link id="l01062" /><CodeLine lineNumber="1062"><Highlight kind="normal">                              omp::Directive CanceledDirective) &#123;</Highlight></CodeLine>
<Link id="l01063" /><CodeLine lineNumber="1063"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l01064" /><CodeLine lineNumber="1064"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP;</Highlight></CodeLine>
<Link id="l01065" /><CodeLine lineNumber="1065"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01066" /><CodeLine lineNumber="1066"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// LLVM utilities like blocks with terminators.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01067" /><CodeLine lineNumber="1067"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;UI = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a39acc29443d48968a798fb22a76fa4c0">CreateUnreachable</a>();</Highlight></CodeLine>
<Link id="l01068" /><CodeLine lineNumber="1068"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01069" /><CodeLine lineNumber="1069"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;ThenTI = UI, &#42;ElseTI = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01070" /><CodeLine lineNumber="1070"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCondition)</Highlight></CodeLine>
<Link id="l01071" /><CodeLine lineNumber="1071"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a7ac00229d8c59902686f52ed061cdc80">SplitBlockAndInsertIfThenElse</a>(IfCondition, UI, &amp;ThenTI, &amp;ElseTI);</Highlight></CodeLine>
<Link id="l01072" /><CodeLine lineNumber="1072"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ThenTI);</Highlight></CodeLine>
<Link id="l01073" /><CodeLine lineNumber="1073"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01074" /><CodeLine lineNumber="1074"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;CancelKind = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01075" /><CodeLine lineNumber="1075"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (CanceledDirective) &#123;</Highlight></CodeLine>
<Link id="l01076" /><CodeLine lineNumber="1076"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;CANCEL&#95;KIND(Enum, Str, DirectiveEnum, Value)                       \\</Highlight></CodeLine>
<Link id="l01077" /><CodeLine lineNumber="1077"><Highlight kind="preprocessor">  case DirectiveEnum:                                                          \\</Highlight></CodeLine>
<Link id="l01078" /><CodeLine lineNumber="1078"><Highlight kind="preprocessor">    CancelKind = Builder.getInt32(Value);                                      \\</Highlight></CodeLine>
<Link id="l01079" /><CodeLine lineNumber="1079"><Highlight kind="preprocessor">    break;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01080" /><CodeLine lineNumber="1080"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;llvm/Frontend/OpenMP/OMPKinds.def&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01081" /><CodeLine lineNumber="1081"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l01082" /><CodeLine lineNumber="1082"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unknown cancel kind!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01083" /><CodeLine lineNumber="1083"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01084" /><CodeLine lineNumber="1084"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01085" /><CodeLine lineNumber="1085"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l01086" /><CodeLine lineNumber="1086"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01087" /><CodeLine lineNumber="1087"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01088" /><CodeLine lineNumber="1088"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args&#91;&#93; = &#123;Ident, getOrCreateThreadID(Ident), CancelKind&#125;;</Highlight></CodeLine>
<Link id="l01089" /><CodeLine lineNumber="1089"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Result = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l01090" /><CodeLine lineNumber="1090"><Highlight kind="normal">      getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;cancel), Args);</Highlight></CodeLine>
<Link id="l01091" /><CodeLine lineNumber="1091"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> ExitCB = &#91;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, CanceledDirective, <a href="/docs/api/namespaces/llvm/loc">Loc</a>&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> IP) -&gt; <a href="/docs/api/classes/llvm/error">Error</a> &#123;</Highlight></CodeLine>
<Link id="l01092" /><CodeLine lineNumber="1092"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CanceledDirective == OMPD&#95;parallel) &#123;</Highlight></CodeLine>
<Link id="l01093" /><CodeLine lineNumber="1093"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/irbuilderbase/insertpointguard">IRBuilder&lt;&gt;::InsertPointGuard</a> IPG(Builder);</Highlight></CodeLine>
<Link id="l01094" /><CodeLine lineNumber="1094"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(IP);</Highlight></CodeLine>
<Link id="l01095" /><CodeLine lineNumber="1095"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07">createBarrier</a>(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), <a href="/docs/api/namespaces/llvm/loc">Loc</a>.DL),</Highlight></CodeLine>
<Link id="l01096" /><CodeLine lineNumber="1096"><Highlight kind="normal">                           omp::Directive::OMPD&#95;unknown,</Highlight></CodeLine>
<Link id="l01097" /><CodeLine lineNumber="1097"><Highlight kind="normal">                           </Highlight><Highlight kind="comment">/&#42; ForceSimpleCall &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l01098" /><CodeLine lineNumber="1098"><Highlight kind="normal">                           </Highlight><Highlight kind="comment">/&#42; CheckCancelFlag &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l01099" /><CodeLine lineNumber="1099"><Highlight kind="normal">          .<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l01100" /><CodeLine lineNumber="1100"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01101" /><CodeLine lineNumber="1101"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l01102" /><CodeLine lineNumber="1102"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l01103" /><CodeLine lineNumber="1103"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01104" /><CodeLine lineNumber="1104"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The actual cancel logic is shared with others, e.g., cancel&#95;barriers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01105" /><CodeLine lineNumber="1105"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/error">Error</a> Err = emitCancelationCheckImpl(Result, CanceledDirective, ExitCB))</Highlight></CodeLine>
<Link id="l01106" /><CodeLine lineNumber="1106"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l01107" /><CodeLine lineNumber="1107"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01108" /><CodeLine lineNumber="1108"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update the insertion point and remove the terminator we introduced.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01109" /><CodeLine lineNumber="1109"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(UI-&gt;getParent());</Highlight></CodeLine>
<Link id="l01110" /><CodeLine lineNumber="1110"><Highlight kind="normal">  UI-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l01111" /><CodeLine lineNumber="1111"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01112" /><CodeLine lineNumber="1112"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l01113" /><CodeLine lineNumber="1113"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01114" /><CodeLine lineNumber="1114"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01115" /><CodeLine lineNumber="1115"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OpenMPIRBuilder::emitTargetKernel(</Highlight></CodeLine>
<Link id="l01116" /><CodeLine lineNumber="1116"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, InsertPointTy AllocaIP, <a href="/docs/api/classes/llvm/value">Value</a> &#42;&amp;Return,</Highlight></CodeLine>
<Link id="l01117" /><CodeLine lineNumber="1117"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident, <a href="/docs/api/classes/llvm/value">Value</a> &#42;DeviceID, <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumTeams, <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumThreads,</Highlight></CodeLine>
<Link id="l01118" /><CodeLine lineNumber="1118"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;HostPtr, <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;Value &#42;&gt;</a> KernelArgs) &#123;</Highlight></CodeLine>
<Link id="l01119" /><CodeLine lineNumber="1119"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l01120" /><CodeLine lineNumber="1120"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP;</Highlight></CodeLine>
<Link id="l01121" /><CodeLine lineNumber="1121"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01122" /><CodeLine lineNumber="1122"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l01123" /><CodeLine lineNumber="1123"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;KernelArgsPtr =</Highlight></CodeLine>
<Link id="l01124" /><CodeLine lineNumber="1124"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(OpenMPIRBuilder::KernelArgs, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;kernel&#95;args&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01125" /><CodeLine lineNumber="1125"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(<a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP);</Highlight></CodeLine>
<Link id="l01126" /><CodeLine lineNumber="1126"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01127" /><CodeLine lineNumber="1127"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = KernelArgs.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l01128" /><CodeLine lineNumber="1128"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;Arg =</Highlight></CodeLine>
<Link id="l01129" /><CodeLine lineNumber="1129"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(OpenMPIRBuilder::KernelArgs, KernelArgsPtr, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l01130" /><CodeLine lineNumber="1130"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(</Highlight></CodeLine>
<Link id="l01131" /><CodeLine lineNumber="1131"><Highlight kind="normal">        KernelArgs&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;, Arg,</Highlight></CodeLine>
<Link id="l01132" /><CodeLine lineNumber="1132"><Highlight kind="normal">        M.getDataLayout().getPrefTypeAlign(KernelArgs&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;-&gt;getType()));</Highlight></CodeLine>
<Link id="l01133" /><CodeLine lineNumber="1133"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01134" /><CodeLine lineNumber="1134"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01135" /><CodeLine lineNumber="1135"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;&gt;</a> OffloadingArgs&#123;Ident,      DeviceID, NumTeams,</Highlight></CodeLine>
<Link id="l01136" /><CodeLine lineNumber="1136"><Highlight kind="normal">                                      NumThreads, HostPtr,  KernelArgsPtr&#125;;</Highlight></CodeLine>
<Link id="l01137" /><CodeLine lineNumber="1137"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01138" /><CodeLine lineNumber="1138"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/mcid/#ab357441fcd1ea1f9b0d27c12700f6023a5416d9f1bd5f533efddadf17d713e469">Return</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l01139" /><CodeLine lineNumber="1139"><Highlight kind="normal">      getOrCreateRuntimeFunction(M, OMPRTL&#95;&#95;&#95;tgt&#95;target&#95;kernel),</Highlight></CodeLine>
<Link id="l01140" /><CodeLine lineNumber="1140"><Highlight kind="normal">      OffloadingArgs);</Highlight></CodeLine>
<Link id="l01141" /><CodeLine lineNumber="1141"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01142" /><CodeLine lineNumber="1142"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l01143" /><CodeLine lineNumber="1143"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01144" /><CodeLine lineNumber="1144"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01145" /><CodeLine lineNumber="1145"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::emitKernelLaunch(</Highlight></CodeLine>
<Link id="l01146" /><CodeLine lineNumber="1146"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;OutlinedFnID,</Highlight></CodeLine>
<Link id="l01147" /><CodeLine lineNumber="1147"><Highlight kind="normal">    EmitFallbackCallbackTy EmitTargetCallFallbackCB, TargetKernelArgs &amp;Args,</Highlight></CodeLine>
<Link id="l01148" /><CodeLine lineNumber="1148"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;DeviceID, <a href="/docs/api/classes/llvm/value">Value</a> &#42;RTLoc, InsertPointTy AllocaIP) &#123;</Highlight></CodeLine>
<Link id="l01149" /><CodeLine lineNumber="1149"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01150" /><CodeLine lineNumber="1150"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l01151" /><CodeLine lineNumber="1151"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l01152" /><CodeLine lineNumber="1152"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01153" /><CodeLine lineNumber="1153"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(Loc.IP);</Highlight></CodeLine>
<Link id="l01154" /><CodeLine lineNumber="1154"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// On top of the arrays that were filled up, the target offloading call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01155" /><CodeLine lineNumber="1155"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// takes as arguments the device id as well as the host pointer. The host</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01156" /><CodeLine lineNumber="1156"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// pointer is used by the runtime library to identify the current target</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01157" /><CodeLine lineNumber="1157"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// region, so it only has to be unique and not necessarily point to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01158" /><CodeLine lineNumber="1158"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// anything. It could be the pointer to the outlined function that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01159" /><CodeLine lineNumber="1159"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// implements the target region, but we aren&#39;t using that so that the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01160" /><CodeLine lineNumber="1160"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// compiler doesn&#39;t need to keep that, and could therefore inline the host</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01161" /><CodeLine lineNumber="1161"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// function if proven worthwhile during optimization.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01162" /><CodeLine lineNumber="1162"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01163" /><CodeLine lineNumber="1163"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// From this point on, we need to have an ID of the target region defined.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01164" /><CodeLine lineNumber="1164"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFnID &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Invalid outlined function ID!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01165" /><CodeLine lineNumber="1165"><Highlight kind="normal">  (void)OutlinedFnID;</Highlight></CodeLine>
<Link id="l01166" /><CodeLine lineNumber="1166"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01167" /><CodeLine lineNumber="1167"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Return value of the runtime offloading call.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01168" /><CodeLine lineNumber="1168"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/mcid/#ab357441fcd1ea1f9b0d27c12700f6023a5416d9f1bd5f533efddadf17d713e469">Return</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01169" /><CodeLine lineNumber="1169"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01170" /><CodeLine lineNumber="1170"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Arguments for the target kernel.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01171" /><CodeLine lineNumber="1171"><Highlight kind="normal">  SmallVector&lt;Value &#42;&gt; ArgsVector;</Highlight></CodeLine>
<Link id="l01172" /><CodeLine lineNumber="1172"><Highlight kind="normal">  getKernelArgsVector(Args, Builder, ArgsVector);</Highlight></CodeLine>
<Link id="l01173" /><CodeLine lineNumber="1173"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01174" /><CodeLine lineNumber="1174"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The target region is an outlined function launched by the runtime</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01175" /><CodeLine lineNumber="1175"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// via calls to &#95;&#95;tgt&#95;target&#95;kernel().</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01176" /><CodeLine lineNumber="1176"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01177" /><CodeLine lineNumber="1177"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Note that on the host and CPU targets, the runtime implementation of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01178" /><CodeLine lineNumber="1178"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// these calls simply call the outlined function without forking threads.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01179" /><CodeLine lineNumber="1179"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The outlined functions themselves have runtime calls to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01180" /><CodeLine lineNumber="1180"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#95;&#95;kmpc&#95;fork&#95;teams() and &#95;&#95;kmpc&#95;fork() for this purpose, codegen&#39;d by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01181" /><CodeLine lineNumber="1181"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the compiler in emitTeamsCall() and emitParallelCall().</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01182" /><CodeLine lineNumber="1182"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01183" /><CodeLine lineNumber="1183"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// In contrast, on the NVPTX target, the implementation of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01184" /><CodeLine lineNumber="1184"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#95;&#95;tgt&#95;target&#95;teams() launches a GPU kernel with the requested number</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01185" /><CodeLine lineNumber="1185"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// of teams and threads so no additional calls to the runtime are required.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01186" /><CodeLine lineNumber="1186"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check the error code and execute the host version if required.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01187" /><CodeLine lineNumber="1187"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(emitTargetKernel(</Highlight></CodeLine>
<Link id="l01188" /><CodeLine lineNumber="1188"><Highlight kind="normal">      Builder, AllocaIP, Return, RTLoc, DeviceID, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>.NumTeams.front(),</Highlight></CodeLine>
<Link id="l01189" /><CodeLine lineNumber="1189"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>.NumThreads.front(), OutlinedFnID, ArgsVector));</Highlight></CodeLine>
<Link id="l01190" /><CodeLine lineNumber="1190"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01191" /><CodeLine lineNumber="1191"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;OffloadFailedBlock =</Highlight></CodeLine>
<Link id="l01192" /><CodeLine lineNumber="1192"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;offload.failed&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01193" /><CodeLine lineNumber="1193"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;OffloadContBlock =</Highlight></CodeLine>
<Link id="l01194" /><CodeLine lineNumber="1194"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;offload.cont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01195" /><CodeLine lineNumber="1195"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/#a2cd7b2e49608a96ba42f59f642cf99ac">Failed</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aafd864f39fd28e235eea03ae424ab8e0">CreateIsNotNull</a>(Return);</Highlight></CodeLine>
<Link id="l01196" /><CodeLine lineNumber="1196"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(<a href="/docs/api/namespaces/llvm/#a2cd7b2e49608a96ba42f59f642cf99ac">Failed</a>, OffloadFailedBlock, OffloadContBlock);</Highlight></CodeLine>
<Link id="l01197" /><CodeLine lineNumber="1197"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01198" /><CodeLine lineNumber="1198"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> CurFn = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l01199" /><CodeLine lineNumber="1199"><Highlight kind="normal">  emitBlock(OffloadFailedBlock, CurFn);</Highlight></CodeLine>
<Link id="l01200" /><CodeLine lineNumber="1200"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP = EmitTargetCallFallbackCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l01201" /><CodeLine lineNumber="1201"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l01202" /><CodeLine lineNumber="1202"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l01203" /><CodeLine lineNumber="1203"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l01204" /><CodeLine lineNumber="1204"><Highlight kind="normal">  emitBranch(OffloadContBlock);</Highlight></CodeLine>
<Link id="l01205" /><CodeLine lineNumber="1205"><Highlight kind="normal">  emitBlock(OffloadContBlock, CurFn, </Highlight><Highlight kind="comment">/&#42;IsFinished=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01206" /><CodeLine lineNumber="1206"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l01207" /><CodeLine lineNumber="1207"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01208" /><CodeLine lineNumber="1208"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01209" /><CodeLine lineNumber="1209"><Highlight kind="normal"><a href="/docs/api/classes/llvm/error">Error</a> OpenMPIRBuilder::emitCancelationCheckImpl(</Highlight></CodeLine>
<Link id="l01210" /><CodeLine lineNumber="1210"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;CancelFlag, omp::Directive CanceledDirective,</Highlight></CodeLine>
<Link id="l01211" /><CodeLine lineNumber="1211"><Highlight kind="normal">    FinalizeCallbackTy ExitCB) &#123;</Highlight></CodeLine>
<Link id="l01212" /><CodeLine lineNumber="1212"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(isLastFinalizationInfoCancellable(CanceledDirective) &amp;&amp;</Highlight></CodeLine>
<Link id="l01213" /><CodeLine lineNumber="1213"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Unexpected cancellation!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01214" /><CodeLine lineNumber="1214"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01215" /><CodeLine lineNumber="1215"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// For a cancel barrier we create two new blocks.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01216" /><CodeLine lineNumber="1216"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;BB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l01217" /><CodeLine lineNumber="1217"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;NonCancellationBlock;</Highlight></CodeLine>
<Link id="l01218" /><CodeLine lineNumber="1218"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e5c1b91bf5e2860398e3fa35c96b5af">GetInsertPoint</a>() == BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()) &#123;</Highlight></CodeLine>
<Link id="l01219" /><CodeLine lineNumber="1219"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: This branch will not be needed once we moved to the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01220" /><CodeLine lineNumber="1220"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// OpenMPIRBuilder codegen completely.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01221" /><CodeLine lineNumber="1221"><Highlight kind="normal">    NonCancellationBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l01222" /><CodeLine lineNumber="1222"><Highlight kind="normal">        BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(), BB-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.cont&quot;</Highlight><Highlight kind="normal">, BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l01223" /><CodeLine lineNumber="1223"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l01224" /><CodeLine lineNumber="1224"><Highlight kind="normal">    NonCancellationBlock = <a href="/docs/api/namespaces/llvm/#ac6c9ffe7979754415f4ca0d677174bc2">SplitBlock</a>(BB, &amp;&#42;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e5c1b91bf5e2860398e3fa35c96b5af">GetInsertPoint</a>());</Highlight></CodeLine>
<Link id="l01225" /><CodeLine lineNumber="1225"><Highlight kind="normal">    BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l01226" /><CodeLine lineNumber="1226"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(BB);</Highlight></CodeLine>
<Link id="l01227" /><CodeLine lineNumber="1227"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01228" /><CodeLine lineNumber="1228"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CancellationBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l01229" /><CodeLine lineNumber="1229"><Highlight kind="normal">      BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(), BB-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.cncl&quot;</Highlight><Highlight kind="normal">, BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l01230" /><CodeLine lineNumber="1230"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01231" /><CodeLine lineNumber="1231"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Jump to them based on the return value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01232" /><CodeLine lineNumber="1232"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac9843b4f9f9cb144c608c48785a394a8">CreateIsNull</a>(CancelFlag);</Highlight></CodeLine>
<Link id="l01233" /><CodeLine lineNumber="1233"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(Cmp, NonCancellationBlock, CancellationBlock,</Highlight></CodeLine>
<Link id="l01234" /><CodeLine lineNumber="1234"><Highlight kind="normal">                       </Highlight><Highlight kind="comment">/&#42; TODO weight &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01235" /><CodeLine lineNumber="1235"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01236" /><CodeLine lineNumber="1236"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// From the cancellation block we finalize all variables and go to the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01237" /><CodeLine lineNumber="1237"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// post finalization block that is known to the FiniCB callback.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01238" /><CodeLine lineNumber="1238"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CancellationBlock);</Highlight></CodeLine>
<Link id="l01239" /><CodeLine lineNumber="1239"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ExitCB)</Highlight></CodeLine>
<Link id="l01240" /><CodeLine lineNumber="1240"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = ExitCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()))</Highlight></CodeLine>
<Link id="l01241" /><CodeLine lineNumber="1241"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l01242" /><CodeLine lineNumber="1242"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;FI = FinalizationStack.back();</Highlight></CodeLine>
<Link id="l01243" /><CodeLine lineNumber="1243"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = FI.FiniCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()))</Highlight></CodeLine>
<Link id="l01244" /><CodeLine lineNumber="1244"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l01245" /><CodeLine lineNumber="1245"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01246" /><CodeLine lineNumber="1246"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The continuation block is where code generation continues.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01247" /><CodeLine lineNumber="1247"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(NonCancellationBlock, NonCancellationBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l01248" /><CodeLine lineNumber="1248"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l01249" /><CodeLine lineNumber="1249"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01250" /><CodeLine lineNumber="1250"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01251" /><CodeLine lineNumber="1251"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Callback used to create OpenMP runtime calls to support</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01252" /><CodeLine lineNumber="1252"><Highlight kind="normal"></Highlight><Highlight kind="comment">// omp parallel clause for the device.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01253" /><CodeLine lineNumber="1253"><Highlight kind="normal"></Highlight><Highlight kind="comment">// We need to use this callback to replace call to the OutlinedFn in OuterFn</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01254" /><CodeLine lineNumber="1254"><Highlight kind="normal"></Highlight><Highlight kind="comment">// by the call to the OpenMP DeviceRTL runtime function (kmpc&#95;parallel&#95;51)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01255" /><CodeLine lineNumber="1255" lineLink="#af7668ce8080668a4f0ceac24e70c9f00"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#af7668ce8080668a4f0ceac24e70c9f00">targetParallelCallback</a>(</Highlight></CodeLine>
<Link id="l01256" /><CodeLine lineNumber="1256"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42;OMPIRBuilder, <a href="/docs/api/classes/llvm/function">Function</a> &amp;OutlinedFn, <a href="/docs/api/classes/llvm/function">Function</a> &#42;OuterFn,</Highlight></CodeLine>
<Link id="l01257" /><CodeLine lineNumber="1257"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;OuterAllocaBB, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident, <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCondition,</Highlight></CodeLine>
<Link id="l01258" /><CodeLine lineNumber="1258"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumThreads, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;PrivTID, <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;PrivTIDAddr,</Highlight></CodeLine>
<Link id="l01259" /><CodeLine lineNumber="1259"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;ThreadID, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Instruction &#42;, 4&gt;</a> &amp;ToBeDeleted) &#123;</Highlight></CodeLine>
<Link id="l01260" /><CodeLine lineNumber="1260"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add some known attributes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01261" /><CodeLine lineNumber="1261"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> &amp;Builder = OMPIRBuilder-&gt;Builder;</Highlight></CodeLine>
<Link id="l01262" /><CodeLine lineNumber="1262"><Highlight kind="normal">  OutlinedFn.<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoAlias);</Highlight></CodeLine>
<Link id="l01263" /><CodeLine lineNumber="1263"><Highlight kind="normal">  OutlinedFn.<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoAlias);</Highlight></CodeLine>
<Link id="l01264" /><CodeLine lineNumber="1264"><Highlight kind="normal">  OutlinedFn.<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l01265" /><CodeLine lineNumber="1265"><Highlight kind="normal">  OutlinedFn.<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l01266" /><CodeLine lineNumber="1266"><Highlight kind="normal">  OutlinedFn.<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(Attribute::NoUnwind);</Highlight></CodeLine>
<Link id="l01267" /><CodeLine lineNumber="1267"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01268" /><CodeLine lineNumber="1268"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn.<a href="/docs/api/classes/llvm/function/#ac6baa801e4aea800984e760d5460662f">arg&#95;size</a>() &gt;= 2 &amp;&amp;</Highlight></CodeLine>
<Link id="l01269" /><CodeLine lineNumber="1269"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Expected at least tid and bounded tid as arguments&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01270" /><CodeLine lineNumber="1270"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumCapturedVars = OutlinedFn.<a href="/docs/api/classes/llvm/function/#ac6baa801e4aea800984e760d5460662f">arg&#95;size</a>() - </Highlight><Highlight kind="comment">/&#42; tid &amp; bounded tid &#42;/</Highlight><Highlight kind="normal"> 2;</Highlight></CodeLine>
<Link id="l01271" /><CodeLine lineNumber="1271"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01272" /><CodeLine lineNumber="1272"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;CI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;CallInst&gt;</a>(OutlinedFn.<a href="/docs/api/classes/llvm/value/#a46db903db2484e1ef5062d094d6b0854">user&#95;back</a>());</Highlight></CodeLine>
<Link id="l01273" /><CodeLine lineNumber="1273"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CI &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected call instruction to outlined function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01274" /><CodeLine lineNumber="1274"><Highlight kind="normal">  CI-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;setName(</Highlight><Highlight kind="stringliteral">&quot;omp&#95;parallel&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01275" /><CodeLine lineNumber="1275"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01276" /><CodeLine lineNumber="1276"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CI);</Highlight></CodeLine>
<Link id="l01277" /><CodeLine lineNumber="1277"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;PtrTy = OMPIRBuilder-&gt;VoidPtr;</Highlight></CodeLine>
<Link id="l01278" /><CodeLine lineNumber="1278"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;NullPtrValue = <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(PtrTy);</Highlight></CodeLine>
<Link id="l01279" /><CodeLine lineNumber="1279"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01280" /><CodeLine lineNumber="1280"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add alloca for kernel args</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01281" /><CodeLine lineNumber="1281"><Highlight kind="normal">  OpenMPIRBuilder ::InsertPointTy CurrentIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l01282" /><CodeLine lineNumber="1282"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(OuterAllocaBB, OuterAllocaBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l01283" /><CodeLine lineNumber="1283"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;ArgsAlloca =</Highlight></CodeLine>
<Link id="l01284" /><CodeLine lineNumber="1284"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(<a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(PtrTy, NumCapturedVars));</Highlight></CodeLine>
<Link id="l01285" /><CodeLine lineNumber="1285"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args = ArgsAlloca;</Highlight></CodeLine>
<Link id="l01286" /><CodeLine lineNumber="1286"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add address space cast if array for storing arguments is not allocated</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01287" /><CodeLine lineNumber="1287"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// in address space 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01288" /><CodeLine lineNumber="1288"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ArgsAlloca-&gt;<a href="/docs/api/classes/llvm/allocainst/#ad2fb148dfac3182fce33be95fc4e9159">getAddressSpace</a>())</Highlight></CodeLine>
<Link id="l01289" /><CodeLine lineNumber="1289"><Highlight kind="normal">    Args = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a3ef26a11123d639b64307cc3c1b869b9">CreatePointerCast</a>(ArgsAlloca, PtrTy);</Highlight></CodeLine>
<Link id="l01290" /><CodeLine lineNumber="1290"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CurrentIP);</Highlight></CodeLine>
<Link id="l01291" /><CodeLine lineNumber="1291"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01292" /><CodeLine lineNumber="1292"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Store captured vars which are used by kmpc&#95;parallel&#95;51</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01293" /><CodeLine lineNumber="1293"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Idx = 0; Idx &lt; NumCapturedVars; Idx++) &#123;</Highlight></CodeLine>
<Link id="l01294" /><CodeLine lineNumber="1294"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;V = &#42;(CI-&gt;<a href="/docs/api/classes/llvm/callbase/#a4fb513d744ca72275932b2c7003f16f6">arg&#95;begin</a>() + 2 + Idx);</Highlight></CodeLine>
<Link id="l01295" /><CodeLine lineNumber="1295"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;StoreAddress = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa8ee5dc4e4a1b26c4bdf1a574eefe2fc">CreateConstInBoundsGEP2&#95;64</a>(</Highlight></CodeLine>
<Link id="l01296" /><CodeLine lineNumber="1296"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(PtrTy, NumCapturedVars), Args, 0, Idx);</Highlight></CodeLine>
<Link id="l01297" /><CodeLine lineNumber="1297"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(V, StoreAddress);</Highlight></CodeLine>
<Link id="l01298" /><CodeLine lineNumber="1298"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01299" /><CodeLine lineNumber="1299"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01300" /><CodeLine lineNumber="1300"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> =</Highlight></CodeLine>
<Link id="l01301" /><CodeLine lineNumber="1301"><Highlight kind="normal">      IfCondition ? Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aeb11a01107c6be1f52ba01902a165d71">CreateSExtOrTrunc</a>(IfCondition, OMPIRBuilder-&gt;Int32)</Highlight></CodeLine>
<Link id="l01302" /><CodeLine lineNumber="1302"><Highlight kind="normal">                  : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(1);</Highlight></CodeLine>
<Link id="l01303" /><CodeLine lineNumber="1303"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01304" /><CodeLine lineNumber="1304"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build kmpc&#95;parallel&#95;51 call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01305" /><CodeLine lineNumber="1305"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Parallel51CallArgs&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l01306" /><CodeLine lineNumber="1306"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; identifier&#42;/</Highlight><Highlight kind="normal"> Ident,</Highlight></CodeLine>
<Link id="l01307" /><CodeLine lineNumber="1307"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; global thread num&#42;/</Highlight><Highlight kind="normal"> ThreadID,</Highlight></CodeLine>
<Link id="l01308" /><CodeLine lineNumber="1308"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; if expression &#42;/</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>,</Highlight></CodeLine>
<Link id="l01309" /><CodeLine lineNumber="1309"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; number of threads &#42;/</Highlight><Highlight kind="normal"> NumThreads ? NumThreads : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(-1),</Highlight></CodeLine>
<Link id="l01310" /><CodeLine lineNumber="1310"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; Proc bind &#42;/</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(-1),</Highlight></CodeLine>
<Link id="l01311" /><CodeLine lineNumber="1311"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; outlined function &#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01312" /><CodeLine lineNumber="1312"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(&amp;OutlinedFn, OMPIRBuilder-&gt;ParallelTaskPtr),</Highlight></CodeLine>
<Link id="l01313" /><CodeLine lineNumber="1313"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; wrapper function &#42;/</Highlight><Highlight kind="normal"> NullPtrValue,</Highlight></CodeLine>
<Link id="l01314" /><CodeLine lineNumber="1314"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; arguments of the outlined funciton&#42;/</Highlight><Highlight kind="normal"> Args,</Highlight></CodeLine>
<Link id="l01315" /><CodeLine lineNumber="1315"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; number of arguments &#42;/</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(NumCapturedVars)&#125;;</Highlight></CodeLine>
<Link id="l01316" /><CodeLine lineNumber="1316"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01317" /><CodeLine lineNumber="1317"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> RTLFn =</Highlight></CodeLine>
<Link id="l01318" /><CodeLine lineNumber="1318"><Highlight kind="normal">      OMPIRBuilder-&gt;getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;parallel&#95;51);</Highlight></CodeLine>
<Link id="l01319" /><CodeLine lineNumber="1319"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01320" /><CodeLine lineNumber="1320"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(RTLFn, Parallel51CallArgs);</Highlight></CodeLine>
<Link id="l01321" /><CodeLine lineNumber="1321"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01322" /><CodeLine lineNumber="1322"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;With kmpc&#95;parallel&#95;51 placed: &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01323" /><CodeLine lineNumber="1323"><Highlight kind="normal">                    &lt;&lt; &#42;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01324" /><CodeLine lineNumber="1324"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01325" /><CodeLine lineNumber="1325"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Initialize the local TID stack location with the argument value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01326" /><CodeLine lineNumber="1326"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(PrivTID);</Highlight></CodeLine>
<Link id="l01327" /><CodeLine lineNumber="1327"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function/#a1c9f2f058966db1f8ca270398bda8362">Function::arg&#95;iterator</a> OutlinedAI = OutlinedFn.<a href="/docs/api/classes/llvm/function/#a8bf193a781a92cae52d7f9216d0824f8">arg&#95;begin</a>();</Highlight></CodeLine>
<Link id="l01328" /><CodeLine lineNumber="1328"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(OMPIRBuilder-&gt;Int32, OutlinedAI),</Highlight></CodeLine>
<Link id="l01329" /><CodeLine lineNumber="1329"><Highlight kind="normal">                      PrivTIDAddr);</Highlight></CodeLine>
<Link id="l01330" /><CodeLine lineNumber="1330"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01331" /><CodeLine lineNumber="1331"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remove redundant call to the outlined function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01332" /><CodeLine lineNumber="1332"><Highlight kind="normal">  CI-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l01333" /><CodeLine lineNumber="1333"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01334" /><CodeLine lineNumber="1334"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : ToBeDeleted) &#123;</Highlight></CodeLine>
<Link id="l01335" /><CodeLine lineNumber="1335"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l01336" /><CodeLine lineNumber="1336"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01337" /><CodeLine lineNumber="1337"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01338" /><CodeLine lineNumber="1338"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01339" /><CodeLine lineNumber="1339"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Callback used to create OpenMP runtime calls to support</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01340" /><CodeLine lineNumber="1340"><Highlight kind="normal"></Highlight><Highlight kind="comment">// omp parallel clause for the host.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01341" /><CodeLine lineNumber="1341"><Highlight kind="normal"></Highlight><Highlight kind="comment">// We need to use this callback to replace call to the OutlinedFn in OuterFn</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01342" /><CodeLine lineNumber="1342"><Highlight kind="normal"></Highlight><Highlight kind="comment">// by the call to the OpenMP host runtime function ( &#95;&#95;kmpc&#95;fork&#95;call&#91;&#95;if&#93;)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01343" /><CodeLine lineNumber="1343"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01344" /><CodeLine lineNumber="1344" lineLink="#afffa0ff2e1527ab545cef33be915c656"><Highlight kind="normal"><a href="#afffa0ff2e1527ab545cef33be915c656">hostParallelCallback</a>(<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42;OMPIRBuilder, <a href="/docs/api/classes/llvm/function">Function</a> &amp;OutlinedFn,</Highlight></CodeLine>
<Link id="l01345" /><CodeLine lineNumber="1345"><Highlight kind="normal">                     <a href="/docs/api/classes/llvm/function">Function</a> &#42;OuterFn, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident, <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCondition,</Highlight></CodeLine>
<Link id="l01346" /><CodeLine lineNumber="1346"><Highlight kind="normal">                     <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;PrivTID, <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;PrivTIDAddr,</Highlight></CodeLine>
<Link id="l01347" /><CodeLine lineNumber="1347"><Highlight kind="normal">                     </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Instruction &#42;, 4&gt;</a> &amp;ToBeDeleted) &#123;</Highlight></CodeLine>
<Link id="l01348" /><CodeLine lineNumber="1348"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> &amp;Builder = OMPIRBuilder-&gt;Builder;</Highlight></CodeLine>
<Link id="l01349" /><CodeLine lineNumber="1349"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> RTLFn;</Highlight></CodeLine>
<Link id="l01350" /><CodeLine lineNumber="1350"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCondition) &#123;</Highlight></CodeLine>
<Link id="l01351" /><CodeLine lineNumber="1351"><Highlight kind="normal">    RTLFn =</Highlight></CodeLine>
<Link id="l01352" /><CodeLine lineNumber="1352"><Highlight kind="normal">        OMPIRBuilder-&gt;getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;fork&#95;call&#95;if);</Highlight></CodeLine>
<Link id="l01353" /><CodeLine lineNumber="1353"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l01354" /><CodeLine lineNumber="1354"><Highlight kind="normal">    RTLFn =</Highlight></CodeLine>
<Link id="l01355" /><CodeLine lineNumber="1355"><Highlight kind="normal">        OMPIRBuilder-&gt;getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;fork&#95;call);</Highlight></CodeLine>
<Link id="l01356" /><CodeLine lineNumber="1356"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01357" /><CodeLine lineNumber="1357"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Function&gt;</a>(RTLFn.<a href="/docs/api/classes/llvm/functioncallee/#ac5d8da677233fa2e1e7039508ed56e0e">getCallee</a>())) &#123;</Highlight></CodeLine>
<Link id="l01358" /><CodeLine lineNumber="1358"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;hasMetadata(LLVMContext::MD&#95;callback)) &#123;</Highlight></CodeLine>
<Link id="l01359" /><CodeLine lineNumber="1359"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getContext();</Highlight></CodeLine>
<Link id="l01360" /><CodeLine lineNumber="1360"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/mdbuilder">MDBuilder</a> MDB(Ctx);</Highlight></CodeLine>
<Link id="l01361" /><CodeLine lineNumber="1361"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Annotate the callback behavior of the &#95;&#95;kmpc&#95;fork&#95;call:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01362" /><CodeLine lineNumber="1362"><Highlight kind="normal">      </Highlight><Highlight kind="comment">//  - The callback callee is argument number 2 (microtask).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01363" /><CodeLine lineNumber="1363"><Highlight kind="normal">      </Highlight><Highlight kind="comment">//  - The first two arguments of the callback callee are unknown (-1).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01364" /><CodeLine lineNumber="1364"><Highlight kind="normal">      </Highlight><Highlight kind="comment">//  - All variadic arguments to the &#95;&#95;kmpc&#95;fork&#95;call are passed to the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01365" /><CodeLine lineNumber="1365"><Highlight kind="normal">      </Highlight><Highlight kind="comment">//    callback callee.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01366" /><CodeLine lineNumber="1366"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;addMetadata(LLVMContext::MD&#95;callback,</Highlight></CodeLine>
<Link id="l01367" /><CodeLine lineNumber="1367"><Highlight kind="normal">                     &#42;<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, &#123;MDB.<a href="/docs/api/classes/llvm/mdbuilder/#a1d51e11adfffd05afe252d3398f50d4e">createCallbackEncoding</a>(</Highlight></CodeLine>
<Link id="l01368" /><CodeLine lineNumber="1368"><Highlight kind="normal">                                           2, &#123;-1, -1&#125;,</Highlight></CodeLine>
<Link id="l01369" /><CodeLine lineNumber="1369"><Highlight kind="normal">                                           </Highlight><Highlight kind="comment">/&#42; VarArgsArePassed &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">)&#125;));</Highlight></CodeLine>
<Link id="l01370" /><CodeLine lineNumber="1370"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01371" /><CodeLine lineNumber="1371"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01372" /><CodeLine lineNumber="1372"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add some known attributes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01373" /><CodeLine lineNumber="1373"><Highlight kind="normal">  OutlinedFn.<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoAlias);</Highlight></CodeLine>
<Link id="l01374" /><CodeLine lineNumber="1374"><Highlight kind="normal">  OutlinedFn.<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoAlias);</Highlight></CodeLine>
<Link id="l01375" /><CodeLine lineNumber="1375"><Highlight kind="normal">  OutlinedFn.<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(Attribute::NoUnwind);</Highlight></CodeLine>
<Link id="l01376" /><CodeLine lineNumber="1376"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01377" /><CodeLine lineNumber="1377"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn.<a href="/docs/api/classes/llvm/function/#ac6baa801e4aea800984e760d5460662f">arg&#95;size</a>() &gt;= 2 &amp;&amp;</Highlight></CodeLine>
<Link id="l01378" /><CodeLine lineNumber="1378"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Expected at least tid and bounded tid as arguments&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01379" /><CodeLine lineNumber="1379"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumCapturedVars = OutlinedFn.<a href="/docs/api/classes/llvm/function/#ac6baa801e4aea800984e760d5460662f">arg&#95;size</a>() - </Highlight><Highlight kind="comment">/&#42; tid &amp; bounded tid &#42;/</Highlight><Highlight kind="normal"> 2;</Highlight></CodeLine>
<Link id="l01380" /><CodeLine lineNumber="1380"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01381" /><CodeLine lineNumber="1381"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;CI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;CallInst&gt;</a>(OutlinedFn.<a href="/docs/api/classes/llvm/value/#a46db903db2484e1ef5062d094d6b0854">user&#95;back</a>());</Highlight></CodeLine>
<Link id="l01382" /><CodeLine lineNumber="1382"><Highlight kind="normal">  CI-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;setName(</Highlight><Highlight kind="stringliteral">&quot;omp&#95;parallel&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01383" /><CodeLine lineNumber="1383"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CI);</Highlight></CodeLine>
<Link id="l01384" /><CodeLine lineNumber="1384"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01385" /><CodeLine lineNumber="1385"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build call &#95;&#95;kmpc&#95;fork&#95;call&#91;&#95;if&#93;(Ident, n, microtask, var1, .., varn);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01386" /><CodeLine lineNumber="1386"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;ForkCallArgs&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l01387" /><CodeLine lineNumber="1387"><Highlight kind="normal">      Ident, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(NumCapturedVars),</Highlight></CodeLine>
<Link id="l01388" /><CodeLine lineNumber="1388"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(&amp;OutlinedFn, OMPIRBuilder-&gt;ParallelTaskPtr)&#125;;</Highlight></CodeLine>
<Link id="l01389" /><CodeLine lineNumber="1389"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01390" /><CodeLine lineNumber="1390"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 16&gt;</a> RealArgs;</Highlight></CodeLine>
<Link id="l01391" /><CodeLine lineNumber="1391"><Highlight kind="normal">  RealArgs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(std::begin(ForkCallArgs), std::end(ForkCallArgs));</Highlight></CodeLine>
<Link id="l01392" /><CodeLine lineNumber="1392"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCondition) &#123;</Highlight></CodeLine>
<Link id="l01393" /><CodeLine lineNumber="1393"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aeb11a01107c6be1f52ba01902a165d71">CreateSExtOrTrunc</a>(IfCondition, OMPIRBuilder-&gt;Int32);</Highlight></CodeLine>
<Link id="l01394" /><CodeLine lineNumber="1394"><Highlight kind="normal">    RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>);</Highlight></CodeLine>
<Link id="l01395" /><CodeLine lineNumber="1395"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01396" /><CodeLine lineNumber="1396"><Highlight kind="normal">  RealArgs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(CI-&gt;<a href="/docs/api/classes/llvm/callbase/#a4fb513d744ca72275932b2c7003f16f6">arg&#95;begin</a>() + </Highlight><Highlight kind="comment">/&#42; tid &amp; bound tid &#42;/</Highlight><Highlight kind="normal"> 2, CI-&gt;<a href="/docs/api/classes/llvm/callbase/#ac0f11b96f81b2769dd23d028e3189075">arg&#95;end</a>());</Highlight></CodeLine>
<Link id="l01397" /><CodeLine lineNumber="1397"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01398" /><CodeLine lineNumber="1398"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#95;&#95;kmpc&#95;fork&#95;call&#95;if always expects a void ptr as the last argument</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01399" /><CodeLine lineNumber="1399"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there are no arguments, pass a null pointer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01400" /><CodeLine lineNumber="1400"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> PtrTy = OMPIRBuilder-&gt;VoidPtr;</Highlight></CodeLine>
<Link id="l01401" /><CodeLine lineNumber="1401"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCondition &amp;&amp; NumCapturedVars == 0) &#123;</Highlight></CodeLine>
<Link id="l01402" /><CodeLine lineNumber="1402"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;NullPtrValue = <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(PtrTy);</Highlight></CodeLine>
<Link id="l01403" /><CodeLine lineNumber="1403"><Highlight kind="normal">    RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NullPtrValue);</Highlight></CodeLine>
<Link id="l01404" /><CodeLine lineNumber="1404"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01405" /><CodeLine lineNumber="1405"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCondition &amp;&amp; RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>()-&gt;getType() != PtrTy)</Highlight></CodeLine>
<Link id="l01406" /><CodeLine lineNumber="1406"><Highlight kind="normal">    RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>() = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>(), PtrTy);</Highlight></CodeLine>
<Link id="l01407" /><CodeLine lineNumber="1407"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01408" /><CodeLine lineNumber="1408"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(RTLFn, RealArgs);</Highlight></CodeLine>
<Link id="l01409" /><CodeLine lineNumber="1409"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01410" /><CodeLine lineNumber="1410"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;With fork&#95;call placed: &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01411" /><CodeLine lineNumber="1411"><Highlight kind="normal">                    &lt;&lt; &#42;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01412" /><CodeLine lineNumber="1412"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01413" /><CodeLine lineNumber="1413"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Initialize the local TID stack location with the argument value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01414" /><CodeLine lineNumber="1414"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(PrivTID);</Highlight></CodeLine>
<Link id="l01415" /><CodeLine lineNumber="1415"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function/#a1c9f2f058966db1f8ca270398bda8362">Function::arg&#95;iterator</a> OutlinedAI = OutlinedFn.<a href="/docs/api/classes/llvm/function/#a8bf193a781a92cae52d7f9216d0824f8">arg&#95;begin</a>();</Highlight></CodeLine>
<Link id="l01416" /><CodeLine lineNumber="1416"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(OMPIRBuilder-&gt;Int32, OutlinedAI),</Highlight></CodeLine>
<Link id="l01417" /><CodeLine lineNumber="1417"><Highlight kind="normal">                      PrivTIDAddr);</Highlight></CodeLine>
<Link id="l01418" /><CodeLine lineNumber="1418"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01419" /><CodeLine lineNumber="1419"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remove redundant call to the outlined function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01420" /><CodeLine lineNumber="1420"><Highlight kind="normal">  CI-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l01421" /><CodeLine lineNumber="1421"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01422" /><CodeLine lineNumber="1422"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : ToBeDeleted) &#123;</Highlight></CodeLine>
<Link id="l01423" /><CodeLine lineNumber="1423"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l01424" /><CodeLine lineNumber="1424"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01425" /><CodeLine lineNumber="1425"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01426" /><CodeLine lineNumber="1426"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01427" /><CodeLine lineNumber="1427" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a4f81b9940e1869e146636dc533455929"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> <a href="/docs/api/classes/llvm/openmpirbuilder/#a4f81b9940e1869e146636dc533455929">OpenMPIRBuilder::createParallel</a>(</Highlight></CodeLine>
<Link id="l01428" /><CodeLine lineNumber="1428"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> OuterAllocaIP,</Highlight></CodeLine>
<Link id="l01429" /><CodeLine lineNumber="1429"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#a49e35e3ee470add16efcde1ab5d5556b">BodyGenCallbackTy</a> BodyGenCB, <a href="/docs/api/classes/llvm/openmpirbuilder/#a71b5ba020f68829f5a1fd99f48b63d42">PrivatizeCallbackTy</a> PrivCB,</Highlight></CodeLine>
<Link id="l01430" /><CodeLine lineNumber="1430"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#a0c571620ff53fdb78e7404f5261dbd23">FinalizeCallbackTy</a> FiniCB, <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCondition, <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumThreads,</Highlight></CodeLine>
<Link id="l01431" /><CodeLine lineNumber="1431"><Highlight kind="normal">    omp::ProcBindKind ProcBind, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsCancellable) &#123;</Highlight></CodeLine>
<Link id="l01432" /><CodeLine lineNumber="1432"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="#a756b28f370cd5a39bc0ee3e5333b9c9b">isConflictIP</a>(<a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP, OuterAllocaIP) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;IPs must not be ambiguous&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01433" /><CodeLine lineNumber="1433"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01434" /><CodeLine lineNumber="1434"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l01435" /><CodeLine lineNumber="1435"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP;</Highlight></CodeLine>
<Link id="l01436" /><CodeLine lineNumber="1436"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01437" /><CodeLine lineNumber="1437"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l01438" /><CodeLine lineNumber="1438"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01439" /><CodeLine lineNumber="1439"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01440" /><CodeLine lineNumber="1440"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;ThreadID = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l01441" /><CodeLine lineNumber="1441"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we generate code for the target device, we need to allocate</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01442" /><CodeLine lineNumber="1442"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// struct for aggregate params in the device default alloca address space.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01443" /><CodeLine lineNumber="1443"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// OpenMP runtime requires that the params of the extracted functions are</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01444" /><CodeLine lineNumber="1444"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// passed as zero address space pointers. This flag ensures that extracted</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01445" /><CodeLine lineNumber="1445"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// function arguments are declared in zero address space</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01446" /><CodeLine lineNumber="1446"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> ArgsInZeroAddressSpace = Config.isTargetDevice();</Highlight></CodeLine>
<Link id="l01447" /><CodeLine lineNumber="1447"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01448" /><CodeLine lineNumber="1448"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build call &#95;&#95;kmpc&#95;push&#95;num&#95;threads(&amp;Ident, global&#95;tid, num&#95;threads)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01449" /><CodeLine lineNumber="1449"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// only if we compile for host side.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01450" /><CodeLine lineNumber="1450"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumThreads &amp;&amp; !Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l01451" /><CodeLine lineNumber="1451"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l01452" /><CodeLine lineNumber="1452"><Highlight kind="normal">        Ident, ThreadID,</Highlight></CodeLine>
<Link id="l01453" /><CodeLine lineNumber="1453"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac79ca3c2d2d74cf33684397a91846564">CreateIntCast</a>(NumThreads, <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, </Highlight><Highlight kind="comment">/&#42;isSigned&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">)&#125;;</Highlight></CodeLine>
<Link id="l01454" /><CodeLine lineNumber="1454"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l01455" /><CodeLine lineNumber="1455"><Highlight kind="normal">        getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;push&#95;num&#95;threads), Args);</Highlight></CodeLine>
<Link id="l01456" /><CodeLine lineNumber="1456"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01457" /><CodeLine lineNumber="1457"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01458" /><CodeLine lineNumber="1458"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ProcBind != OMP&#95;PROC&#95;BIND&#95;default) &#123;</Highlight></CodeLine>
<Link id="l01459" /><CodeLine lineNumber="1459"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Build call &#95;&#95;kmpc&#95;push&#95;proc&#95;bind(&amp;Ident, global&#95;tid, proc&#95;bind)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01460" /><CodeLine lineNumber="1460"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l01461" /><CodeLine lineNumber="1461"><Highlight kind="normal">        Ident, ThreadID,</Highlight></CodeLine>
<Link id="l01462" /><CodeLine lineNumber="1462"><Highlight kind="normal">        ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal">(ProcBind), </Highlight><Highlight kind="comment">/&#42;isSigned=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">)&#125;;</Highlight></CodeLine>
<Link id="l01463" /><CodeLine lineNumber="1463"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l01464" /><CodeLine lineNumber="1464"><Highlight kind="normal">        getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;push&#95;proc&#95;bind), Args);</Highlight></CodeLine>
<Link id="l01465" /><CodeLine lineNumber="1465"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01466" /><CodeLine lineNumber="1466"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01467" /><CodeLine lineNumber="1467"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;InsertBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l01468" /><CodeLine lineNumber="1468"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;OuterFn = InsertBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l01469" /><CodeLine lineNumber="1469"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01470" /><CodeLine lineNumber="1470"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Save the outer alloca block because the insertion iterator may get</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01471" /><CodeLine lineNumber="1471"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// invalidated and we still need this later.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01472" /><CodeLine lineNumber="1472"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;OuterAllocaBlock = OuterAllocaIP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a3d072f8ac5e1b0724c4bb5a77adae9da">getBlock</a>();</Highlight></CodeLine>
<Link id="l01473" /><CodeLine lineNumber="1473"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01474" /><CodeLine lineNumber="1474"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Vector to remember instructions we used only during the modeling but which</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01475" /><CodeLine lineNumber="1475"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// we want to delete at the end.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01476" /><CodeLine lineNumber="1476"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Instruction &#42;, 4&gt;</a> ToBeDeleted;</Highlight></CodeLine>
<Link id="l01477" /><CodeLine lineNumber="1477"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01478" /><CodeLine lineNumber="1478"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Change the location to the outer alloca insertion point to create and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01479" /><CodeLine lineNumber="1479"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// initialize the allocas we pass into the parallel region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01480" /><CodeLine lineNumber="1480"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> NewOuter(OuterAllocaBlock, OuterAllocaBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l01481" /><CodeLine lineNumber="1481"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(NewOuter);</Highlight></CodeLine>
<Link id="l01482" /><CodeLine lineNumber="1482"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;TIDAddrAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;tid.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01483" /><CodeLine lineNumber="1483"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;ZeroAddrAlloca =</Highlight></CodeLine>
<Link id="l01484" /><CodeLine lineNumber="1484"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;zero.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01485" /><CodeLine lineNumber="1485"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;TIDAddr = TIDAddrAlloca;</Highlight></CodeLine>
<Link id="l01486" /><CodeLine lineNumber="1486"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;ZeroAddr = ZeroAddrAlloca;</Highlight></CodeLine>
<Link id="l01487" /><CodeLine lineNumber="1487"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ArgsInZeroAddressSpace &amp;&amp; M.getDataLayout().getAllocaAddrSpace() != 0) &#123;</Highlight></CodeLine>
<Link id="l01488" /><CodeLine lineNumber="1488"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add additional casts to enforce pointers in zero address space</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01489" /><CodeLine lineNumber="1489"><Highlight kind="normal">    TIDAddr = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/addrspacecastinst">AddrSpaceCastInst</a>(</Highlight></CodeLine>
<Link id="l01490" /><CodeLine lineNumber="1490"><Highlight kind="normal">        TIDAddrAlloca, PointerType ::get(M.getContext(), 0), </Highlight><Highlight kind="stringliteral">&quot;tid.addr.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01491" /><CodeLine lineNumber="1491"><Highlight kind="normal">    TIDAddr-&gt;<a href="/docs/api/classes/llvm/instruction/#af09e4096de244d2fb345891328714a63">insertAfter</a>(TIDAddrAlloca-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l01492" /><CodeLine lineNumber="1492"><Highlight kind="normal">    ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(TIDAddr);</Highlight></CodeLine>
<Link id="l01493" /><CodeLine lineNumber="1493"><Highlight kind="normal">    ZeroAddr = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/addrspacecastinst">AddrSpaceCastInst</a>(ZeroAddrAlloca,</Highlight></CodeLine>
<Link id="l01494" /><CodeLine lineNumber="1494"><Highlight kind="normal">                                     PointerType ::get(M.getContext(), 0),</Highlight></CodeLine>
<Link id="l01495" /><CodeLine lineNumber="1495"><Highlight kind="normal">                                     </Highlight><Highlight kind="stringliteral">&quot;zero.addr.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01496" /><CodeLine lineNumber="1496"><Highlight kind="normal">    ZeroAddr-&gt;<a href="/docs/api/classes/llvm/instruction/#af09e4096de244d2fb345891328714a63">insertAfter</a>(ZeroAddrAlloca-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l01497" /><CodeLine lineNumber="1497"><Highlight kind="normal">    ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(ZeroAddr);</Highlight></CodeLine>
<Link id="l01498" /><CodeLine lineNumber="1498"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01499" /><CodeLine lineNumber="1499"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01500" /><CodeLine lineNumber="1500"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We only need TIDAddr and ZeroAddr for modeling purposes to get the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01501" /><CodeLine lineNumber="1501"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// associated arguments in the outlined function, so we delete them later.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01502" /><CodeLine lineNumber="1502"><Highlight kind="normal">  ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(TIDAddrAlloca);</Highlight></CodeLine>
<Link id="l01503" /><CodeLine lineNumber="1503"><Highlight kind="normal">  ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(ZeroAddrAlloca);</Highlight></CodeLine>
<Link id="l01504" /><CodeLine lineNumber="1504"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01505" /><CodeLine lineNumber="1505"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create an artificial insertion point that will also ensure the blocks we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01506" /><CodeLine lineNumber="1506"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// are about to split are not degenerated.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01507" /><CodeLine lineNumber="1507"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;UI = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/unreachableinst">UnreachableInst</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>(), InsertBB);</Highlight></CodeLine>
<Link id="l01508" /><CodeLine lineNumber="1508"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01509" /><CodeLine lineNumber="1509"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;EntryBB = UI-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l01510" /><CodeLine lineNumber="1510"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PRegEntryBB = EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(UI, </Highlight><Highlight kind="stringliteral">&quot;omp.par.entry&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01511" /><CodeLine lineNumber="1511"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PRegBodyBB = PRegEntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(UI, </Highlight><Highlight kind="stringliteral">&quot;omp.par.region&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01512" /><CodeLine lineNumber="1512"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PRegPreFiniBB =</Highlight></CodeLine>
<Link id="l01513" /><CodeLine lineNumber="1513"><Highlight kind="normal">      PRegBodyBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(UI, </Highlight><Highlight kind="stringliteral">&quot;omp.par.pre&#95;finalize&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01514" /><CodeLine lineNumber="1514"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PRegExitBB = PRegPreFiniBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(UI, </Highlight><Highlight kind="stringliteral">&quot;omp.par.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01515" /><CodeLine lineNumber="1515"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01516" /><CodeLine lineNumber="1516"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FiniCBWrapper = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> IP) &#123;</Highlight></CodeLine>
<Link id="l01517" /><CodeLine lineNumber="1517"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Hide &quot;open-ended&quot; blocks from the given FiniCB by setting the right jump</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01518" /><CodeLine lineNumber="1518"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// target to the region exit block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01519" /><CodeLine lineNumber="1519"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IP.getBlock()-&gt;end() == IP.getPoint()) &#123;</Highlight></CodeLine>
<Link id="l01520" /><CodeLine lineNumber="1520"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/irbuilderbase/insertpointguard">IRBuilder&lt;&gt;::InsertPointGuard</a> IPG(Builder);</Highlight></CodeLine>
<Link id="l01521" /><CodeLine lineNumber="1521"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(IP);</Highlight></CodeLine>
<Link id="l01522" /><CodeLine lineNumber="1522"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(PRegExitBB);</Highlight></CodeLine>
<Link id="l01523" /><CodeLine lineNumber="1523"><Highlight kind="normal">      IP = <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIterator());</Highlight></CodeLine>
<Link id="l01524" /><CodeLine lineNumber="1524"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01525" /><CodeLine lineNumber="1525"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IP.getBlock()-&gt;getTerminator()-&gt;getNumSuccessors() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l01526" /><CodeLine lineNumber="1526"><Highlight kind="normal">           IP.getBlock()-&gt;getTerminator()-&gt;getSuccessor(0) == PRegExitBB &amp;&amp;</Highlight></CodeLine>
<Link id="l01527" /><CodeLine lineNumber="1527"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Unexpected insertion point for finalization call!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01528" /><CodeLine lineNumber="1528"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> FiniCB(IP);</Highlight></CodeLine>
<Link id="l01529" /><CodeLine lineNumber="1529"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l01530" /><CodeLine lineNumber="1530"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01531" /><CodeLine lineNumber="1531"><Highlight kind="normal">  FinalizationStack.push&#95;back(&#123;FiniCBWrapper, OMPD&#95;parallel, IsCancellable&#125;);</Highlight></CodeLine>
<Link id="l01532" /><CodeLine lineNumber="1532"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01533" /><CodeLine lineNumber="1533"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Generate the privatization allocas in the block that will become the entry</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01534" /><CodeLine lineNumber="1534"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// of the outlined function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01535" /><CodeLine lineNumber="1535"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(PRegEntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l01536" /><CodeLine lineNumber="1536"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> InnerAllocaIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l01537" /><CodeLine lineNumber="1537"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01538" /><CodeLine lineNumber="1538"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;PrivTIDAddr =</Highlight></CodeLine>
<Link id="l01539" /><CodeLine lineNumber="1539"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;tid.addr.local&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01540" /><CodeLine lineNumber="1540"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;PrivTID = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, PrivTIDAddr, </Highlight><Highlight kind="stringliteral">&quot;tid&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01541" /><CodeLine lineNumber="1541"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01542" /><CodeLine lineNumber="1542"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add some fake uses for OpenMP provided arguments.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01543" /><CodeLine lineNumber="1543"><Highlight kind="normal">  ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, TIDAddr, </Highlight><Highlight kind="stringliteral">&quot;tid.addr.use&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l01544" /><CodeLine lineNumber="1544"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;ZeroAddrUse =</Highlight></CodeLine>
<Link id="l01545" /><CodeLine lineNumber="1545"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, ZeroAddr, </Highlight><Highlight kind="stringliteral">&quot;zero.addr.use&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01546" /><CodeLine lineNumber="1546"><Highlight kind="normal">  ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(ZeroAddrUse);</Highlight></CodeLine>
<Link id="l01547" /><CodeLine lineNumber="1547"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01548" /><CodeLine lineNumber="1548"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// EntryBB</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01549" /><CodeLine lineNumber="1549"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01550" /><CodeLine lineNumber="1550"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   V</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01551" /><CodeLine lineNumber="1551"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// PRegionEntryBB         &lt;- Privatization allocas are placed here.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01552" /><CodeLine lineNumber="1552"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01553" /><CodeLine lineNumber="1553"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   V</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01554" /><CodeLine lineNumber="1554"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// PRegionBodyBB          &lt;- BodeGen is invoked here.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01555" /><CodeLine lineNumber="1555"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01556" /><CodeLine lineNumber="1556"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   V</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01557" /><CodeLine lineNumber="1557"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// PRegPreFiniBB          &lt;- The block we will start finalization from.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01558" /><CodeLine lineNumber="1558"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01559" /><CodeLine lineNumber="1559"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   V</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01560" /><CodeLine lineNumber="1560"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// PRegionExitBB          &lt;- A common exit to simplify block collection.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01561" /><CodeLine lineNumber="1561"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01562" /><CodeLine lineNumber="1562"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01563" /><CodeLine lineNumber="1563"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Before body codegen: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OuterFn &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01564" /><CodeLine lineNumber="1564"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01565" /><CodeLine lineNumber="1565"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Let the caller create the body.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01566" /><CodeLine lineNumber="1566"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BodyGenCB &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected body generation callback!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01567" /><CodeLine lineNumber="1567"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP(PRegBodyBB, PRegBodyBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l01568" /><CodeLine lineNumber="1568"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/error">Error</a> Err = BodyGenCB(InnerAllocaIP, CodeGenIP))</Highlight></CodeLine>
<Link id="l01569" /><CodeLine lineNumber="1569"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l01570" /><CodeLine lineNumber="1570"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01571" /><CodeLine lineNumber="1571"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After  body codegen: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OuterFn &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01572" /><CodeLine lineNumber="1572"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01573" /><CodeLine lineNumber="1573"><Highlight kind="normal">  OutlineInfo OI;</Highlight></CodeLine>
<Link id="l01574" /><CodeLine lineNumber="1574"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l01575" /><CodeLine lineNumber="1575"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Generate OpenMP target specific runtime call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01576" /><CodeLine lineNumber="1576"><Highlight kind="normal">    OI.PostOutlineCB = &#91;=, ToBeDeletedVec =</Highlight></CodeLine>
<Link id="l01577" /><CodeLine lineNumber="1577"><Highlight kind="normal">                               std::move(ToBeDeleted)&#93;(<a href="/docs/api/classes/llvm/function">Function</a> &amp;OutlinedFn) &#123;</Highlight></CodeLine>
<Link id="l01578" /><CodeLine lineNumber="1578"><Highlight kind="normal">      <a href="#af7668ce8080668a4f0ceac24e70c9f00">targetParallelCallback</a>(</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, OutlinedFn, OuterFn, OuterAllocaBlock, Ident,</Highlight></CodeLine>
<Link id="l01579" /><CodeLine lineNumber="1579"><Highlight kind="normal">                             IfCondition, NumThreads, PrivTID, PrivTIDAddr,</Highlight></CodeLine>
<Link id="l01580" /><CodeLine lineNumber="1580"><Highlight kind="normal">                             ThreadID, ToBeDeletedVec);</Highlight></CodeLine>
<Link id="l01581" /><CodeLine lineNumber="1581"><Highlight kind="normal">    &#125;;</Highlight></CodeLine>
<Link id="l01582" /><CodeLine lineNumber="1582"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l01583" /><CodeLine lineNumber="1583"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Generate OpenMP host runtime call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01584" /><CodeLine lineNumber="1584"><Highlight kind="normal">    OI.PostOutlineCB = &#91;=, ToBeDeletedVec =</Highlight></CodeLine>
<Link id="l01585" /><CodeLine lineNumber="1585"><Highlight kind="normal">                               std::move(ToBeDeleted)&#93;(<a href="/docs/api/classes/llvm/function">Function</a> &amp;OutlinedFn) &#123;</Highlight></CodeLine>
<Link id="l01586" /><CodeLine lineNumber="1586"><Highlight kind="normal">      <a href="#afffa0ff2e1527ab545cef33be915c656">hostParallelCallback</a>(</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, OutlinedFn, OuterFn, Ident, IfCondition,</Highlight></CodeLine>
<Link id="l01587" /><CodeLine lineNumber="1587"><Highlight kind="normal">                           PrivTID, PrivTIDAddr, ToBeDeletedVec);</Highlight></CodeLine>
<Link id="l01588" /><CodeLine lineNumber="1588"><Highlight kind="normal">    &#125;;</Highlight></CodeLine>
<Link id="l01589" /><CodeLine lineNumber="1589"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01590" /><CodeLine lineNumber="1590"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01591" /><CodeLine lineNumber="1591"><Highlight kind="normal">  OI.OuterAllocaBB = OuterAllocaBlock;</Highlight></CodeLine>
<Link id="l01592" /><CodeLine lineNumber="1592"><Highlight kind="normal">  OI.EntryBB = PRegEntryBB;</Highlight></CodeLine>
<Link id="l01593" /><CodeLine lineNumber="1593"><Highlight kind="normal">  OI.ExitBB = PRegExitBB;</Highlight></CodeLine>
<Link id="l01594" /><CodeLine lineNumber="1594"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01595" /><CodeLine lineNumber="1595"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;BasicBlock &#42;, 32&gt;</a> ParallelRegionBlockSet;</Highlight></CodeLine>
<Link id="l01596" /><CodeLine lineNumber="1596"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 32&gt;</a> Blocks;</Highlight></CodeLine>
<Link id="l01597" /><CodeLine lineNumber="1597"><Highlight kind="normal">  OI.collectBlocks(ParallelRegionBlockSet, Blocks);</Highlight></CodeLine>
<Link id="l01598" /><CodeLine lineNumber="1598"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01599" /><CodeLine lineNumber="1599"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ensure a single exit node for the outlined region by creating one.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01600" /><CodeLine lineNumber="1600"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We might have multiple incoming edges to the exit now due to finalizations,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01601" /><CodeLine lineNumber="1601"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// e.g., cancel calls that cause the control flow to leave the region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01602" /><CodeLine lineNumber="1602"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PRegOutlinedExitBB = PRegExitBB;</Highlight></CodeLine>
<Link id="l01603" /><CodeLine lineNumber="1603"><Highlight kind="normal">  PRegExitBB = <a href="/docs/api/namespaces/llvm/#ac6c9ffe7979754415f4ca0d677174bc2">SplitBlock</a>(PRegExitBB, &amp;&#42;PRegExitBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l01604" /><CodeLine lineNumber="1604"><Highlight kind="normal">  PRegOutlinedExitBB-&gt;<a href="/docs/api/classes/llvm/value/#a35ee267850af7c235474a8c46c7ac5af">setName</a>(</Highlight><Highlight kind="stringliteral">&quot;omp.par.outlined.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01605" /><CodeLine lineNumber="1605"><Highlight kind="normal">  Blocks.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(PRegOutlinedExitBB);</Highlight></CodeLine>
<Link id="l01606" /><CodeLine lineNumber="1606"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01607" /><CodeLine lineNumber="1607"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/codeextractoranalysiscache">CodeExtractorAnalysisCache</a> CEAC(&#42;OuterFn);</Highlight></CodeLine>
<Link id="l01608" /><CodeLine lineNumber="1608"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/codeextractor">CodeExtractor</a> Extractor(Blocks, </Highlight><Highlight kind="comment">/&#42; DominatorTree &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l01609" /><CodeLine lineNumber="1609"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AggregateArgs &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l01610" /><CodeLine lineNumber="1610"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; BlockFrequencyInfo &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l01611" /><CodeLine lineNumber="1611"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; BranchProbabilityInfo &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l01612" /><CodeLine lineNumber="1612"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AssumptionCache &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l01613" /><CodeLine lineNumber="1613"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AllowVarArgs &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l01614" /><CodeLine lineNumber="1614"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AllowAlloca &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l01615" /><CodeLine lineNumber="1615"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AllocationBlock &#42;/</Highlight><Highlight kind="normal"> OuterAllocaBlock,</Highlight></CodeLine>
<Link id="l01616" /><CodeLine lineNumber="1616"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; Suffix &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="stringliteral">&quot;.omp&#95;par&quot;</Highlight><Highlight kind="normal">, ArgsInZeroAddressSpace);</Highlight></CodeLine>
<Link id="l01617" /><CodeLine lineNumber="1617"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01618" /><CodeLine lineNumber="1618"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Find inputs to, outputs from the code region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01619" /><CodeLine lineNumber="1619"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;CommonExit = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01620" /><CodeLine lineNumber="1620"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/setvector">SetVector&lt;Value &#42;&gt;</a> Inputs, Outputs, SinkingCands, HoistingCands;</Highlight></CodeLine>
<Link id="l01621" /><CodeLine lineNumber="1621"><Highlight kind="normal">  Extractor.findAllocas(CEAC, SinkingCands, HoistingCands, CommonExit);</Highlight></CodeLine>
<Link id="l01622" /><CodeLine lineNumber="1622"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01623" /><CodeLine lineNumber="1623"><Highlight kind="normal">  Extractor.findInputsOutputs(Inputs, Outputs, SinkingCands,</Highlight></CodeLine>
<Link id="l01624" /><CodeLine lineNumber="1624"><Highlight kind="normal">                              </Highlight><Highlight kind="comment">/&#42;CollectGlobalInputs=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01625" /><CodeLine lineNumber="1625"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01626" /><CodeLine lineNumber="1626"><Highlight kind="normal">  Inputs.<a href="/docs/api/classes/llvm/setvector/#a14d9be6f03ca789eb7489fa89273aa40">remove&#95;if</a>(&#91;&amp;&#93;(<a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l01627" /><CodeLine lineNumber="1627"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/structs/llvm/omp/gv">GV</a> = <a href="/docs/api/namespaces/llvm/#a3377eac88526e806d9d887c4a0ba2a73">dyn&#95;cast&#95;if&#95;present&lt;GlobalVariable&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</Highlight></CodeLine>
<Link id="l01628" /><CodeLine lineNumber="1628"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/omp/gv">GV</a>-&gt;getValueType() == OpenMPIRBuilder::Ident;</Highlight></CodeLine>
<Link id="l01629" /><CodeLine lineNumber="1629"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01630" /><CodeLine lineNumber="1630"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01631" /><CodeLine lineNumber="1631"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l01632" /><CodeLine lineNumber="1632"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01633" /><CodeLine lineNumber="1633"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Before privatization: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OuterFn &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01634" /><CodeLine lineNumber="1634"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01635" /><CodeLine lineNumber="1635"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> TIDRTLFn =</Highlight></CodeLine>
<Link id="l01636" /><CodeLine lineNumber="1636"><Highlight kind="normal">      getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;global&#95;thread&#95;num);</Highlight></CodeLine>
<Link id="l01637" /><CodeLine lineNumber="1637"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01638" /><CodeLine lineNumber="1638"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> PrivHelper = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/value">Value</a> &amp;V) -&gt; <a href="/docs/api/classes/llvm/error">Error</a> &#123;</Highlight></CodeLine>
<Link id="l01639" /><CodeLine lineNumber="1639"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (&amp;V == TIDAddr || &amp;V == ZeroAddr) &#123;</Highlight></CodeLine>
<Link id="l01640" /><CodeLine lineNumber="1640"><Highlight kind="normal">      OI.ExcludeArgsFromAggregate.push&#95;back(&amp;V);</Highlight></CodeLine>
<Link id="l01641" /><CodeLine lineNumber="1641"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l01642" /><CodeLine lineNumber="1642"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01643" /><CodeLine lineNumber="1643"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01644" /><CodeLine lineNumber="1644"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/setvector">SetVector&lt;Use &#42;&gt;</a> <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>;</Highlight></CodeLine>
<Link id="l01645" /><CodeLine lineNumber="1645"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/use">Use</a> &amp;U : V.uses())</Highlight></CodeLine>
<Link id="l01646" /><CodeLine lineNumber="1646"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;UserI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(U.getUser()))</Highlight></CodeLine>
<Link id="l01647" /><CodeLine lineNumber="1647"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ParallelRegionBlockSet.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(UserI-&gt;getParent()))</Highlight></CodeLine>
<Link id="l01648" /><CodeLine lineNumber="1648"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.insert(&amp;U);</Highlight></CodeLine>
<Link id="l01649" /><CodeLine lineNumber="1649"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01650" /><CodeLine lineNumber="1650"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// &#95;&#95;kmpc&#95;fork&#95;call expects extra arguments as pointers. If the input</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01651" /><CodeLine lineNumber="1651"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// already has a pointer type, everything is fine. Otherwise, store the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01652" /><CodeLine lineNumber="1652"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// value onto stack and load it back inside the to-be-outlined region. This</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01653" /><CodeLine lineNumber="1653"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// will ensure only the pointer will be passed to the function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01654" /><CodeLine lineNumber="1654"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// FIXME: if there are more than 15 trailing arguments, they must be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01655" /><CodeLine lineNumber="1655"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// additionally packed in a struct.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01656" /><CodeLine lineNumber="1656"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Inner = &amp;V;</Highlight></CodeLine>
<Link id="l01657" /><CodeLine lineNumber="1657"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!V.getType()-&gt;isPointerTy()) &#123;</Highlight></CodeLine>
<Link id="l01658" /><CodeLine lineNumber="1658"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/irbuilderbase/insertpointguard">IRBuilder&lt;&gt;::InsertPointGuard</a> Guard(Builder);</Highlight></CodeLine>
<Link id="l01659" /><CodeLine lineNumber="1659"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">llvm::dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Forwarding input as pointer: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; V &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01660" /><CodeLine lineNumber="1660"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01661" /><CodeLine lineNumber="1661"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OuterAllocaIP);</Highlight></CodeLine>
<Link id="l01662" /><CodeLine lineNumber="1662"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> =</Highlight></CodeLine>
<Link id="l01663" /><CodeLine lineNumber="1663"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(V.getType(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, V.getName() + </Highlight><Highlight kind="stringliteral">&quot;.reloaded&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01664" /><CodeLine lineNumber="1664"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01665" /><CodeLine lineNumber="1665"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Store to stack at end of the block that currently branches to the entry</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01666" /><CodeLine lineNumber="1666"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// block of the to-be-outlined region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01667" /><CodeLine lineNumber="1667"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(InsertBB,</Highlight></CodeLine>
<Link id="l01668" /><CodeLine lineNumber="1668"><Highlight kind="normal">                             InsertBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l01669" /><CodeLine lineNumber="1669"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(&amp;V, <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</Highlight></CodeLine>
<Link id="l01670" /><CodeLine lineNumber="1670"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01671" /><CodeLine lineNumber="1671"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Load back next to allocations in the to-be-outlined region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01672" /><CodeLine lineNumber="1672"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(InnerAllocaIP);</Highlight></CodeLine>
<Link id="l01673" /><CodeLine lineNumber="1673"><Highlight kind="normal">      Inner = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(V.getType(), <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</Highlight></CodeLine>
<Link id="l01674" /><CodeLine lineNumber="1674"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01675" /><CodeLine lineNumber="1675"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01676" /><CodeLine lineNumber="1676"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;ReplacementValue = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01677" /><CodeLine lineNumber="1677"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;CI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;CallInst&gt;</a>(&amp;V);</Highlight></CodeLine>
<Link id="l01678" /><CodeLine lineNumber="1678"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CI &amp;&amp; CI-&gt;<a href="/docs/api/classes/llvm/callbase/#a2b1ae7cf1bafdd43d1fee4c6ad0a2913">getCalledFunction</a>() == TIDRTLFn.<a href="/docs/api/classes/llvm/functioncallee/#ac5d8da677233fa2e1e7039508ed56e0e">getCallee</a>()) &#123;</Highlight></CodeLine>
<Link id="l01679" /><CodeLine lineNumber="1679"><Highlight kind="normal">      ReplacementValue = PrivTID;</Highlight></CodeLine>
<Link id="l01680" /><CodeLine lineNumber="1680"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l01681" /><CodeLine lineNumber="1681"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l01682" /><CodeLine lineNumber="1682"><Highlight kind="normal">          PrivCB(InnerAllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), V, &#42;Inner, ReplacementValue);</Highlight></CodeLine>
<Link id="l01683" /><CodeLine lineNumber="1683"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l01684" /><CodeLine lineNumber="1684"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l01685" /><CodeLine lineNumber="1685"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l01686" /><CodeLine lineNumber="1686"><Highlight kind="normal">      InnerAllocaIP = &#123;</Highlight></CodeLine>
<Link id="l01687" /><CodeLine lineNumber="1687"><Highlight kind="normal">          InnerAllocaIP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a3d072f8ac5e1b0724c4bb5a77adae9da">getBlock</a>(),</Highlight></CodeLine>
<Link id="l01688" /><CodeLine lineNumber="1688"><Highlight kind="normal">          InnerAllocaIP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a3d072f8ac5e1b0724c4bb5a77adae9da">getBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>()&#125;;</Highlight></CodeLine>
<Link id="l01689" /><CodeLine lineNumber="1689"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01690" /><CodeLine lineNumber="1690"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ReplacementValue &amp;&amp;</Highlight></CodeLine>
<Link id="l01691" /><CodeLine lineNumber="1691"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Expected copy/create callback to set replacement value!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01692" /><CodeLine lineNumber="1692"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ReplacementValue == &amp;V)</Highlight></CodeLine>
<Link id="l01693" /><CodeLine lineNumber="1693"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l01694" /><CodeLine lineNumber="1694"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01695" /><CodeLine lineNumber="1695"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01696" /><CodeLine lineNumber="1696"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/use">Use</a> &#42;UPtr : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>)</Highlight></CodeLine>
<Link id="l01697" /><CodeLine lineNumber="1697"><Highlight kind="normal">      UPtr-&gt;set(ReplacementValue);</Highlight></CodeLine>
<Link id="l01698" /><CodeLine lineNumber="1698"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01699" /><CodeLine lineNumber="1699"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l01700" /><CodeLine lineNumber="1700"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l01701" /><CodeLine lineNumber="1701"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01702" /><CodeLine lineNumber="1702"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Reset the inner alloca insertion as it will be used for loading the values</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01703" /><CodeLine lineNumber="1703"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// wrapped into pointers before passing them into the to-be-outlined region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01704" /><CodeLine lineNumber="1704"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Configure it to insert immediately after the fake use of zero address so</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01705" /><CodeLine lineNumber="1705"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that they are available in the generated body and so that the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01706" /><CodeLine lineNumber="1706"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// OpenMP-related values (thread ID and zero address pointers) remain leading</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01707" /><CodeLine lineNumber="1707"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// in the argument list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01708" /><CodeLine lineNumber="1708"><Highlight kind="normal">  InnerAllocaIP = <a href="/docs/api/classes/llvm/irbuilderbase/insertpoint">IRBuilder&lt;&gt;::InsertPoint</a>(</Highlight></CodeLine>
<Link id="l01709" /><CodeLine lineNumber="1709"><Highlight kind="normal">      ZeroAddrUse-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>(), ZeroAddrUse-&gt;<a href="/docs/api/classes/llvm/ilist-node-with-parent/#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>()-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l01710" /><CodeLine lineNumber="1710"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01711" /><CodeLine lineNumber="1711"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Reset the outer alloca insertion point to the entry of the relevant block</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01712" /><CodeLine lineNumber="1712"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// in case it was invalidated.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01713" /><CodeLine lineNumber="1713"><Highlight kind="normal">  OuterAllocaIP = <a href="/docs/api/classes/llvm/irbuilderbase/insertpoint">IRBuilder&lt;&gt;::InsertPoint</a>(</Highlight></CodeLine>
<Link id="l01714" /><CodeLine lineNumber="1714"><Highlight kind="normal">      OuterAllocaBlock, OuterAllocaBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l01715" /><CodeLine lineNumber="1715"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01716" /><CodeLine lineNumber="1716"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/classes/input">Input</a> : Inputs) &#123;</Highlight></CodeLine>
<Link id="l01717" /><CodeLine lineNumber="1717"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Captured input: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;<a href="/docs/api/classes/input">Input</a> &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01718" /><CodeLine lineNumber="1718"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/error">Error</a> Err = PrivHelper(&#42;<a href="/docs/api/classes/input">Input</a>))</Highlight></CodeLine>
<Link id="l01719" /><CodeLine lineNumber="1719"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l01720" /><CodeLine lineNumber="1720"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01721" /><CodeLine lineNumber="1721"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</Highlight></CodeLine>
<Link id="l01722" /><CodeLine lineNumber="1722"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/value">Value</a> &#42;Output : Outputs)</Highlight></CodeLine>
<Link id="l01723" /><CodeLine lineNumber="1723"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Captured output: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Output &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01724" /><CodeLine lineNumber="1724"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l01725" /><CodeLine lineNumber="1725"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Outputs.<a href="/docs/api/classes/llvm/setvector/#ac178f4fc4e4a0642610c374256b9fb27">empty</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l01726" /><CodeLine lineNumber="1726"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;OpenMP outlining should not produce live-out values!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01727" /><CodeLine lineNumber="1727"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01728" /><CodeLine lineNumber="1728"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After  privatization: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OuterFn &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01729" /><CodeLine lineNumber="1729"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</Highlight></CodeLine>
<Link id="l01730" /><CodeLine lineNumber="1730"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;BB : Blocks)</Highlight></CodeLine>
<Link id="l01731" /><CodeLine lineNumber="1731"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; PBR: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; BB-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01732" /><CodeLine lineNumber="1732"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l01733" /><CodeLine lineNumber="1733"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01734" /><CodeLine lineNumber="1734"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Adjust the finalization stack, verify the adjustment, and call the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01735" /><CodeLine lineNumber="1735"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// finalize function a last time to finalize values between the pre-fini</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01736" /><CodeLine lineNumber="1736"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// block and the exit block if we left the parallel &quot;the normal way&quot;.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01737" /><CodeLine lineNumber="1737"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FiniInfo = FinalizationStack.pop&#95;back&#95;val();</Highlight></CodeLine>
<Link id="l01738" /><CodeLine lineNumber="1738"><Highlight kind="normal">  (void)FiniInfo;</Highlight></CodeLine>
<Link id="l01739" /><CodeLine lineNumber="1739"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FiniInfo.DK == OMPD&#95;parallel &amp;&amp;</Highlight></CodeLine>
<Link id="l01740" /><CodeLine lineNumber="1740"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Unexpected finalization stack state!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01741" /><CodeLine lineNumber="1741"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01742" /><CodeLine lineNumber="1742"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;PRegPreFiniTI = PRegPreFiniBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l01743" /><CodeLine lineNumber="1743"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01744" /><CodeLine lineNumber="1744"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> PreFiniIP(PRegPreFiniBB, PRegPreFiniTI-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l01745" /><CodeLine lineNumber="1745"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/error">Error</a> Err = FiniCB(PreFiniIP))</Highlight></CodeLine>
<Link id="l01746" /><CodeLine lineNumber="1746"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l01747" /><CodeLine lineNumber="1747"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01748" /><CodeLine lineNumber="1748"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Register the outlined info.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01749" /><CodeLine lineNumber="1749"><Highlight kind="normal">  addOutlineInfo(std::move(OI));</Highlight></CodeLine>
<Link id="l01750" /><CodeLine lineNumber="1750"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01751" /><CodeLine lineNumber="1751"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AfterIP(UI-&gt;getParent(), UI-&gt;getParent()-&gt;end());</Highlight></CodeLine>
<Link id="l01752" /><CodeLine lineNumber="1752"><Highlight kind="normal">  UI-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l01753" /><CodeLine lineNumber="1753"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01754" /><CodeLine lineNumber="1754"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP;</Highlight></CodeLine>
<Link id="l01755" /><CodeLine lineNumber="1755"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01756" /><CodeLine lineNumber="1756"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01757" /><CodeLine lineNumber="1757"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitFlush(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>) &#123;</Highlight></CodeLine>
<Link id="l01758" /><CodeLine lineNumber="1758"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build call void &#95;&#95;kmpc&#95;flush(ident&#95;t &#42;loc)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01759" /><CodeLine lineNumber="1759"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l01760" /><CodeLine lineNumber="1760"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01761" /><CodeLine lineNumber="1761"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args&#91;&#93; = &#123;getOrCreateIdent(SrcLocStr, SrcLocStrSize)&#125;;</Highlight></CodeLine>
<Link id="l01762" /><CodeLine lineNumber="1762"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01763" /><CodeLine lineNumber="1763"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;flush), Args);</Highlight></CodeLine>
<Link id="l01764" /><CodeLine lineNumber="1764"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01765" /><CodeLine lineNumber="1765"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01766" /><CodeLine lineNumber="1766" lineLink="/docs/api/classes/llvm/openmpirbuilder/#afc2cc623eda981e1b3fbb61a44e80ef8"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#afc2cc623eda981e1b3fbb61a44e80ef8">OpenMPIRBuilder::createFlush</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>) &#123;</Highlight></CodeLine>
<Link id="l01767" /><CodeLine lineNumber="1767"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l01768" /><CodeLine lineNumber="1768"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01769" /><CodeLine lineNumber="1769"><Highlight kind="normal">  emitFlush(<a href="/docs/api/namespaces/llvm/loc">Loc</a>);</Highlight></CodeLine>
<Link id="l01770" /><CodeLine lineNumber="1770"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01771" /><CodeLine lineNumber="1771"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01772" /><CodeLine lineNumber="1772"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitTaskwaitImpl(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>) &#123;</Highlight></CodeLine>
<Link id="l01773" /><CodeLine lineNumber="1773"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build call kmp&#95;int32 &#95;&#95;kmpc&#95;omp&#95;taskwait(ident&#95;t &#42;loc, kmp&#95;int32</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01774" /><CodeLine lineNumber="1774"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// global&#95;tid);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01775" /><CodeLine lineNumber="1775"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l01776" /><CodeLine lineNumber="1776"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01777" /><CodeLine lineNumber="1777"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01778" /><CodeLine lineNumber="1778"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args&#91;&#93; = &#123;Ident, getOrCreateThreadID(Ident)&#125;;</Highlight></CodeLine>
<Link id="l01779" /><CodeLine lineNumber="1779"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01780" /><CodeLine lineNumber="1780"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ignore return result until untied tasks are supported.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01781" /><CodeLine lineNumber="1781"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;taskwait),</Highlight></CodeLine>
<Link id="l01782" /><CodeLine lineNumber="1782"><Highlight kind="normal">                     Args);</Highlight></CodeLine>
<Link id="l01783" /><CodeLine lineNumber="1783"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01784" /><CodeLine lineNumber="1784"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01785" /><CodeLine lineNumber="1785" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a419ffad9e4d59275e299ce1ad3c73cd4"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a419ffad9e4d59275e299ce1ad3c73cd4">OpenMPIRBuilder::createTaskwait</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>) &#123;</Highlight></CodeLine>
<Link id="l01786" /><CodeLine lineNumber="1786"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l01787" /><CodeLine lineNumber="1787"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01788" /><CodeLine lineNumber="1788"><Highlight kind="normal">  emitTaskwaitImpl(<a href="/docs/api/namespaces/llvm/loc">Loc</a>);</Highlight></CodeLine>
<Link id="l01789" /><CodeLine lineNumber="1789"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01790" /><CodeLine lineNumber="1790"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01791" /><CodeLine lineNumber="1791"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitTaskyieldImpl(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>) &#123;</Highlight></CodeLine>
<Link id="l01792" /><CodeLine lineNumber="1792"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build call &#95;&#95;kmpc&#95;omp&#95;taskyield(loc, thread&#95;id, 0);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01793" /><CodeLine lineNumber="1793"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l01794" /><CodeLine lineNumber="1794"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01795" /><CodeLine lineNumber="1795"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01796" /><CodeLine lineNumber="1796"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;I32Null = <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">ConstantInt::getNullValue</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>);</Highlight></CodeLine>
<Link id="l01797" /><CodeLine lineNumber="1797"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args&#91;&#93; = &#123;Ident, getOrCreateThreadID(Ident), I32Null&#125;;</Highlight></CodeLine>
<Link id="l01798" /><CodeLine lineNumber="1798"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01799" /><CodeLine lineNumber="1799"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;taskyield),</Highlight></CodeLine>
<Link id="l01800" /><CodeLine lineNumber="1800"><Highlight kind="normal">                     Args);</Highlight></CodeLine>
<Link id="l01801" /><CodeLine lineNumber="1801"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01802" /><CodeLine lineNumber="1802"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01803" /><CodeLine lineNumber="1803" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a0b0ed7f600549e4239bf10b5b85de66c"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a0b0ed7f600549e4239bf10b5b85de66c">OpenMPIRBuilder::createTaskyield</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>) &#123;</Highlight></CodeLine>
<Link id="l01804" /><CodeLine lineNumber="1804"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l01805" /><CodeLine lineNumber="1805"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01806" /><CodeLine lineNumber="1806"><Highlight kind="normal">  emitTaskyieldImpl(<a href="/docs/api/namespaces/llvm/loc">Loc</a>);</Highlight></CodeLine>
<Link id="l01807" /><CodeLine lineNumber="1807"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01808" /><CodeLine lineNumber="1808"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01809" /><CodeLine lineNumber="1809"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Processes the dependencies in Dependencies and does the following</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01810" /><CodeLine lineNumber="1810"><Highlight kind="normal"></Highlight><Highlight kind="comment">// - Allocates space on the stack of an array of DependInfo objects</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01811" /><CodeLine lineNumber="1811"><Highlight kind="normal"></Highlight><Highlight kind="comment">// - Populates each DependInfo object with relevant information of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01812" /><CodeLine lineNumber="1812"><Highlight kind="normal"></Highlight><Highlight kind="comment">//   the corresponding dependence.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01813" /><CodeLine lineNumber="1813"><Highlight kind="normal"></Highlight><Highlight kind="comment">// - All code is inserted in the entry block of the current function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01814" /><CodeLine lineNumber="1814" lineLink="#a9702d30c99a5459e9565631adf1fdf1b"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="#a9702d30c99a5459e9565631adf1fdf1b">emitTaskDependencies</a>(</Highlight></CodeLine>
<Link id="l01815" /><CodeLine lineNumber="1815"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder,</Highlight></CodeLine>
<Link id="l01816" /><CodeLine lineNumber="1816"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;OpenMPIRBuilder::DependData&gt;</a> &amp;Dependencies) &#123;</Highlight></CodeLine>
<Link id="l01817" /><CodeLine lineNumber="1817"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Early return if we have no dependencies to process</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01818" /><CodeLine lineNumber="1818"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Dependencies.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</Highlight></CodeLine>
<Link id="l01819" /><CodeLine lineNumber="1819"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01820" /><CodeLine lineNumber="1820"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01821" /><CodeLine lineNumber="1821"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Given a vector of DependData objects, in this function we create an</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01822" /><CodeLine lineNumber="1822"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// array on the stack that holds kmp&#95;dep&#95;info objects corresponding</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01823" /><CodeLine lineNumber="1823"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to each dependency. This is then passed to the OpenMP runtime.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01824" /><CodeLine lineNumber="1824"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// For example, if there are &#39;n&#39; dependencies then the following psedo</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01825" /><CodeLine lineNumber="1825"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// code is generated. Assume the first dependence is on a variable &#39;a&#39;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01826" /><CodeLine lineNumber="1826"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01827" /><CodeLine lineNumber="1827"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// \\code&#123;c&#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01828" /><CodeLine lineNumber="1828"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// DepArray = alloc(n x sizeof(kmp&#95;depend&#95;info);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01829" /><CodeLine lineNumber="1829"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// idx = 0;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01830" /><CodeLine lineNumber="1830"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// DepArray&#91;idx&#93;.base&#95;addr = ptrtoint(&amp;a);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01831" /><CodeLine lineNumber="1831"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// DepArray&#91;idx&#93;.len = 8;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01832" /><CodeLine lineNumber="1832"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// DepArray&#91;idx&#93;.flags = Dep.DepKind; /&#42;(See OMPContants.h for DepKind)&#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01833" /><CodeLine lineNumber="1833"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ++idx;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01834" /><CodeLine lineNumber="1834"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// DepArray&#91;idx&#93;.base&#95;addr = ...;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01835" /><CodeLine lineNumber="1835"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// \\endcode</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01836" /><CodeLine lineNumber="1836"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01837" /><CodeLine lineNumber="1837"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder = OMPBuilder.Builder;</Highlight></CodeLine>
<Link id="l01838" /><CodeLine lineNumber="1838"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;DependInfo = OMPBuilder.DependInfo;</Highlight></CodeLine>
<Link id="l01839" /><CodeLine lineNumber="1839"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/module">Module</a> &amp;M = OMPBuilder.M;</Highlight></CodeLine>
<Link id="l01840" /><CodeLine lineNumber="1840"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01841" /><CodeLine lineNumber="1841"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;DepArray = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01842" /><CodeLine lineNumber="1842"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OldIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l01843" /><CodeLine lineNumber="1843"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(</Highlight></CodeLine>
<Link id="l01844" /><CodeLine lineNumber="1844"><Highlight kind="normal">      OldIP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a3d072f8ac5e1b0724c4bb5a77adae9da">getBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>()-&gt;<a href="/docs/api/classes/llvm/function/#a169f0c26ef46161741fdd120a806f853">getEntryBlock</a>().<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l01845" /><CodeLine lineNumber="1845"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01846" /><CodeLine lineNumber="1846"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;DepArrayTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(DependInfo, Dependencies.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>());</Highlight></CodeLine>
<Link id="l01847" /><CodeLine lineNumber="1847"><Highlight kind="normal">  DepArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(DepArrayTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.dep.arr.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01848" /><CodeLine lineNumber="1848"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01849" /><CodeLine lineNumber="1849"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&#91;DepIdx, Dep&#93; : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(Dependencies)) &#123;</Highlight></CodeLine>
<Link id="l01850" /><CodeLine lineNumber="1850"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> =</Highlight></CodeLine>
<Link id="l01851" /><CodeLine lineNumber="1851"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa8ee5dc4e4a1b26c4bdf1a574eefe2fc">CreateConstInBoundsGEP2&#95;64</a>(DepArrayTy, DepArray, 0, DepIdx);</Highlight></CodeLine>
<Link id="l01852" /><CodeLine lineNumber="1852"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Store the pointer to the variable</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01853" /><CodeLine lineNumber="1853"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Addr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(</Highlight></CodeLine>
<Link id="l01854" /><CodeLine lineNumber="1854"><Highlight kind="normal">        DependInfo, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l01855" /><CodeLine lineNumber="1855"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(RTLDependInfoFields::BaseAddr));</Highlight></CodeLine>
<Link id="l01856" /><CodeLine lineNumber="1856"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;DepValPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aae2c1bf70058f3665edaec525457030c">CreatePtrToInt</a>(Dep.DepVal, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>());</Highlight></CodeLine>
<Link id="l01857" /><CodeLine lineNumber="1857"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(DepValPtr, Addr);</Highlight></CodeLine>
<Link id="l01858" /><CodeLine lineNumber="1858"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Store the size of the variable</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01859" /><CodeLine lineNumber="1859"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(</Highlight></CodeLine>
<Link id="l01860" /><CodeLine lineNumber="1860"><Highlight kind="normal">        DependInfo, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(RTLDependInfoFields::Len));</Highlight></CodeLine>
<Link id="l01861" /><CodeLine lineNumber="1861"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(</Highlight></CodeLine>
<Link id="l01862" /><CodeLine lineNumber="1862"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(M.getDataLayout().getTypeStoreSize(Dep.DepValueType)),</Highlight></CodeLine>
<Link id="l01863" /><CodeLine lineNumber="1863"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</Highlight></CodeLine>
<Link id="l01864" /><CodeLine lineNumber="1864"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Store the dependency kind</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01865" /><CodeLine lineNumber="1865"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Flags = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(</Highlight></CodeLine>
<Link id="l01866" /><CodeLine lineNumber="1866"><Highlight kind="normal">        DependInfo, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l01867" /><CodeLine lineNumber="1867"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(RTLDependInfoFields::Flags));</Highlight></CodeLine>
<Link id="l01868" /><CodeLine lineNumber="1868"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(</Highlight></CodeLine>
<Link id="l01869" /><CodeLine lineNumber="1869"><Highlight kind="normal">        ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae7be2e1490f01c049d748436f03760c5">getInt8Ty</a>(),</Highlight></CodeLine>
<Link id="l01870" /><CodeLine lineNumber="1870"><Highlight kind="normal">                         </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(Dep.DepKind)),</Highlight></CodeLine>
<Link id="l01871" /><CodeLine lineNumber="1871"><Highlight kind="normal">        Flags);</Highlight></CodeLine>
<Link id="l01872" /><CodeLine lineNumber="1872"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01873" /><CodeLine lineNumber="1873"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OldIP);</Highlight></CodeLine>
<Link id="l01874" /><CodeLine lineNumber="1874"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> DepArray;</Highlight></CodeLine>
<Link id="l01875" /><CodeLine lineNumber="1875"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01876" /><CodeLine lineNumber="1876"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01877" /><CodeLine lineNumber="1877"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::createTask(</Highlight></CodeLine>
<Link id="l01878" /><CodeLine lineNumber="1878"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l01879" /><CodeLine lineNumber="1879"><Highlight kind="normal">    BodyGenCallbackTy BodyGenCB, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Tied, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Final, <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCondition,</Highlight></CodeLine>
<Link id="l01880" /><CodeLine lineNumber="1880"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;DependData&gt;</a> Dependencies, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Mergeable, <a href="/docs/api/classes/llvm/value">Value</a> &#42;EventHandle,</Highlight></CodeLine>
<Link id="l01881" /><CodeLine lineNumber="1881"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Priority) &#123;</Highlight></CodeLine>
<Link id="l01882" /><CodeLine lineNumber="1882"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01883" /><CodeLine lineNumber="1883"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l01884" /><CodeLine lineNumber="1884"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l01885" /><CodeLine lineNumber="1885"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01886" /><CodeLine lineNumber="1886"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l01887" /><CodeLine lineNumber="1887"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01888" /><CodeLine lineNumber="1888"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l01889" /><CodeLine lineNumber="1889"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The current basic block is split into four basic blocks. After outlining,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01890" /><CodeLine lineNumber="1890"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// they will be mapped as follows:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01891" /><CodeLine lineNumber="1891"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#96;&#96;&#96;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01892" /><CodeLine lineNumber="1892"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// def current&#95;fn() &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01893" /><CodeLine lineNumber="1893"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   current&#95;basic&#95;block:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01894" /><CodeLine lineNumber="1894"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     br label %task.exit</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01895" /><CodeLine lineNumber="1895"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   task.exit:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01896" /><CodeLine lineNumber="1896"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     ; instructions after task</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01897" /><CodeLine lineNumber="1897"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01898" /><CodeLine lineNumber="1898"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// def outlined&#95;fn() &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01899" /><CodeLine lineNumber="1899"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   task.alloca:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01900" /><CodeLine lineNumber="1900"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     br label %task.body</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01901" /><CodeLine lineNumber="1901"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   task.body:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01902" /><CodeLine lineNumber="1902"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     ret void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01903" /><CodeLine lineNumber="1903"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01904" /><CodeLine lineNumber="1904"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#96;&#96;&#96;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01905" /><CodeLine lineNumber="1905"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;TaskExitBB = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;task.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01906" /><CodeLine lineNumber="1906"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;TaskBodyBB = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;task.body&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01907" /><CodeLine lineNumber="1907"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;TaskAllocaBB =</Highlight></CodeLine>
<Link id="l01908" /><CodeLine lineNumber="1908"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;task.alloca&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01909" /><CodeLine lineNumber="1909"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01910" /><CodeLine lineNumber="1910"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> TaskAllocaIP =</Highlight></CodeLine>
<Link id="l01911" /><CodeLine lineNumber="1911"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(TaskAllocaBB, TaskAllocaBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l01912" /><CodeLine lineNumber="1912"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> TaskBodyIP = <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(TaskBodyBB, TaskBodyBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l01913" /><CodeLine lineNumber="1913"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = BodyGenCB(TaskAllocaIP, TaskBodyIP))</Highlight></CodeLine>
<Link id="l01914" /><CodeLine lineNumber="1914"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l01915" /><CodeLine lineNumber="1915"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01916" /><CodeLine lineNumber="1916"><Highlight kind="normal">  OutlineInfo OI;</Highlight></CodeLine>
<Link id="l01917" /><CodeLine lineNumber="1917"><Highlight kind="normal">  OI.EntryBB = TaskAllocaBB;</Highlight></CodeLine>
<Link id="l01918" /><CodeLine lineNumber="1918"><Highlight kind="normal">  OI.OuterAllocaBB = AllocaIP.getBlock();</Highlight></CodeLine>
<Link id="l01919" /><CodeLine lineNumber="1919"><Highlight kind="normal">  OI.ExitBB = TaskExitBB;</Highlight></CodeLine>
<Link id="l01920" /><CodeLine lineNumber="1920"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01921" /><CodeLine lineNumber="1921"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add the thread ID argument.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01922" /><CodeLine lineNumber="1922"><Highlight kind="normal">  SmallVector&lt;Instruction &#42;, 4&gt; ToBeDeleted;</Highlight></CodeLine>
<Link id="l01923" /><CodeLine lineNumber="1923"><Highlight kind="normal">  OI.ExcludeArgsFromAggregate.push&#95;back(<a href="#a35409dbaffc2cf38fefec12e3cf9094d">createFakeIntVal</a>(</Highlight></CodeLine>
<Link id="l01924" /><CodeLine lineNumber="1924"><Highlight kind="normal">      Builder, AllocaIP, ToBeDeleted, TaskAllocaIP, </Highlight><Highlight kind="stringliteral">&quot;global.tid&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l01925" /><CodeLine lineNumber="1925"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01926" /><CodeLine lineNumber="1926"><Highlight kind="normal">  OI.PostOutlineCB = &#91;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, Ident, Tied, Final, IfCondition, Dependencies,</Highlight></CodeLine>
<Link id="l01927" /><CodeLine lineNumber="1927"><Highlight kind="normal">                      Mergeable, Priority, EventHandle, TaskAllocaBB,</Highlight></CodeLine>
<Link id="l01928" /><CodeLine lineNumber="1928"><Highlight kind="normal">                      ToBeDeleted&#93;(<a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &amp;OutlinedFn) </Highlight><Highlight kind="keyword">mutable</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l01929" /><CodeLine lineNumber="1929"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Replace the Stale CI by appropriate RTL function call.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01930" /><CodeLine lineNumber="1930"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn.getNumUses() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l01931" /><CodeLine lineNumber="1931"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;there must be a single user for the outlined function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01932" /><CodeLine lineNumber="1932"><Highlight kind="normal">    CallInst &#42;StaleCI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;CallInst&gt;</a>(OutlinedFn.user&#95;back());</Highlight></CodeLine>
<Link id="l01933" /><CodeLine lineNumber="1933"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01934" /><CodeLine lineNumber="1934"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// HasShareds is true if any variables are captured in the outlined region,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01935" /><CodeLine lineNumber="1935"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// false otherwise.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01936" /><CodeLine lineNumber="1936"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasShareds = StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#adde2ea00dd2613ee41bfe91908e4e68e">arg&#95;size</a>() &gt; 1;</Highlight></CodeLine>
<Link id="l01937" /><CodeLine lineNumber="1937"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(StaleCI);</Highlight></CodeLine>
<Link id="l01938" /><CodeLine lineNumber="1938"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01939" /><CodeLine lineNumber="1939"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Gather the arguments for emitting the runtime call for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01940" /><CodeLine lineNumber="1940"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// @&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01941" /><CodeLine lineNumber="1941"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskAllocFn =</Highlight></CodeLine>
<Link id="l01942" /><CodeLine lineNumber="1942"><Highlight kind="normal">        getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc);</Highlight></CodeLine>
<Link id="l01943" /><CodeLine lineNumber="1943"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01944" /><CodeLine lineNumber="1944"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Arguments - &#96;loc&#95;ref&#96; (Ident) and &#96;gtid&#96; (ThreadID)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01945" /><CodeLine lineNumber="1945"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// call.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01946" /><CodeLine lineNumber="1946"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadID = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l01947" /><CodeLine lineNumber="1947"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01948" /><CodeLine lineNumber="1948"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Argument - &#96;flags&#96;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01949" /><CodeLine lineNumber="1949"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is tied iff (Flags &amp; 1) == 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01950" /><CodeLine lineNumber="1950"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is untied iff (Flags &amp; 1) == 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01951" /><CodeLine lineNumber="1951"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is final iff (Flags &amp; 2) == 2</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01952" /><CodeLine lineNumber="1952"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is not final iff (Flags &amp; 2) == 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01953" /><CodeLine lineNumber="1953"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is mergeable iff (Flags &amp; 4) == 4</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01954" /><CodeLine lineNumber="1954"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is not mergeable iff (Flags &amp; 4) == 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01955" /><CodeLine lineNumber="1955"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is priority iff (Flags &amp; 32) == 32</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01956" /><CodeLine lineNumber="1956"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is not priority iff (Flags &amp; 32) == 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01957" /><CodeLine lineNumber="1957"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Handle the other flags.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01958" /><CodeLine lineNumber="1958"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(Tied);</Highlight></CodeLine>
<Link id="l01959" /><CodeLine lineNumber="1959"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Final) &#123;</Highlight></CodeLine>
<Link id="l01960" /><CodeLine lineNumber="1960"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;FinalFlag =</Highlight></CodeLine>
<Link id="l01961" /><CodeLine lineNumber="1961"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(Final, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(2), Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(0));</Highlight></CodeLine>
<Link id="l01962" /><CodeLine lineNumber="1962"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab61be8e3cf17e9848aeeeabacfa1b09a">CreateOr</a>(FinalFlag, <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>);</Highlight></CodeLine>
<Link id="l01963" /><CodeLine lineNumber="1963"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01964" /><CodeLine lineNumber="1964"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01965" /><CodeLine lineNumber="1965"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Mergeable)</Highlight></CodeLine>
<Link id="l01966" /><CodeLine lineNumber="1966"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab61be8e3cf17e9848aeeeabacfa1b09a">CreateOr</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(4), <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>);</Highlight></CodeLine>
<Link id="l01967" /><CodeLine lineNumber="1967"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Priority)</Highlight></CodeLine>
<Link id="l01968" /><CodeLine lineNumber="1968"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab61be8e3cf17e9848aeeeabacfa1b09a">CreateOr</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(32), <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>);</Highlight></CodeLine>
<Link id="l01969" /><CodeLine lineNumber="1969"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01970" /><CodeLine lineNumber="1970"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Argument - &#96;sizeof&#95;kmp&#95;task&#95;t&#96; (TaskSize)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01971" /><CodeLine lineNumber="1971"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Tasksize refers to the size in bytes of kmp&#95;task&#95;t data structure</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01972" /><CodeLine lineNumber="1972"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// including private vars accessed in task.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01973" /><CodeLine lineNumber="1973"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: add kmp&#95;task&#95;t&#95;with&#95;privates (privates)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01974" /><CodeLine lineNumber="1974"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TaskSize = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l01975" /><CodeLine lineNumber="1975"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a9dda4472ee0b7ea92ab49eedf6e13d50">divideCeil</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeSizeInBits(Task), 8));</Highlight></CodeLine>
<Link id="l01976" /><CodeLine lineNumber="1976"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01977" /><CodeLine lineNumber="1977"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Argument - &#96;sizeof&#95;shareds&#96; (SharedsSize)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01978" /><CodeLine lineNumber="1978"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// SharedsSize refers to the shareds array size in the kmp&#95;task&#95;t data</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01979" /><CodeLine lineNumber="1979"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// structure.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01980" /><CodeLine lineNumber="1980"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SharedsSize = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(0);</Highlight></CodeLine>
<Link id="l01981" /><CodeLine lineNumber="1981"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShareds) &#123;</Highlight></CodeLine>
<Link id="l01982" /><CodeLine lineNumber="1982"><Highlight kind="normal">      AllocaInst &#42;ArgStructAlloca =</Highlight></CodeLine>
<Link id="l01983" /><CodeLine lineNumber="1983"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AllocaInst&gt;</a>(StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#aabd76e6a8a23a5af1ce4d3c310d88bcd">getArgOperand</a>(1));</Highlight></CodeLine>
<Link id="l01984" /><CodeLine lineNumber="1984"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ArgStructAlloca &amp;&amp;</Highlight></CodeLine>
<Link id="l01985" /><CodeLine lineNumber="1985"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Unable to find the alloca instruction corresponding to arguments &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01986" /><CodeLine lineNumber="1986"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;for extracted function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01987" /><CodeLine lineNumber="1987"><Highlight kind="normal">      StructType &#42;ArgStructType =</Highlight></CodeLine>
<Link id="l01988" /><CodeLine lineNumber="1988"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StructType&gt;</a>(ArgStructAlloca-&gt;<a href="/docs/api/classes/llvm/allocainst/#a9b5ec84ea363eca9e35ddca20a5313af">getAllocatedType</a>());</Highlight></CodeLine>
<Link id="l01989" /><CodeLine lineNumber="1989"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ArgStructType &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Unable to find struct type corresponding to &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01990" /><CodeLine lineNumber="1990"><Highlight kind="normal">                              </Highlight><Highlight kind="stringliteral">&quot;arguments for extracted function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01991" /><CodeLine lineNumber="1991"><Highlight kind="normal">      SharedsSize =</Highlight></CodeLine>
<Link id="l01992" /><CodeLine lineNumber="1992"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(ArgStructType));</Highlight></CodeLine>
<Link id="l01993" /><CodeLine lineNumber="1993"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01994" /><CodeLine lineNumber="1994"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Emit the @&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc runtime call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01995" /><CodeLine lineNumber="1995"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The runtime call returns a pointer to an area where the task captured</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01996" /><CodeLine lineNumber="1996"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// variables must be copied before the task is run (TaskData)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01997" /><CodeLine lineNumber="1997"><Highlight kind="normal">    CallInst &#42;TaskData = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l01998" /><CodeLine lineNumber="1998"><Highlight kind="normal">        TaskAllocFn, &#123;</Highlight><Highlight kind="comment">/&#42;loc&#95;ref=&#42;/</Highlight><Highlight kind="normal">Ident, </Highlight><Highlight kind="comment">/&#42;gtid=&#42;/</Highlight><Highlight kind="normal">ThreadID, </Highlight><Highlight kind="comment">/&#42;flags=&#42;/</Highlight><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>,</Highlight></CodeLine>
<Link id="l01999" /><CodeLine lineNumber="1999"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42;sizeof&#95;task=&#42;/</Highlight><Highlight kind="normal">TaskSize, </Highlight><Highlight kind="comment">/&#42;sizeof&#95;shared=&#42;/</Highlight><Highlight kind="normal">SharedsSize,</Highlight></CodeLine>
<Link id="l02000" /><CodeLine lineNumber="2000"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42;task&#95;func=&#42;/</Highlight><Highlight kind="normal">&amp;OutlinedFn&#125;);</Highlight></CodeLine>
<Link id="l02001" /><CodeLine lineNumber="2001"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02002" /><CodeLine lineNumber="2002"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Emit detach clause initialization.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02003" /><CodeLine lineNumber="2003"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// evt = (typeof(evt))&#95;&#95;kmpc&#95;task&#95;allow&#95;completion&#95;event(loc, tid,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02004" /><CodeLine lineNumber="2004"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// task&#95;descriptor);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02005" /><CodeLine lineNumber="2005"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EventHandle) &#123;</Highlight></CodeLine>
<Link id="l02006" /><CodeLine lineNumber="2006"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskDetachFn = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l02007" /><CodeLine lineNumber="2007"><Highlight kind="normal">          OMPRTL&#95;&#95;&#95;kmpc&#95;task&#95;allow&#95;completion&#95;event);</Highlight></CodeLine>
<Link id="l02008" /><CodeLine lineNumber="2008"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">llvm::Value</a> &#42;EventVal =</Highlight></CodeLine>
<Link id="l02009" /><CodeLine lineNumber="2009"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskDetachFn, &#123;Ident, ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l02010" /><CodeLine lineNumber="2010"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">llvm::Value</a> &#42;EventHandleAddr =</Highlight></CodeLine>
<Link id="l02011" /><CodeLine lineNumber="2011"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(EventHandle,</Highlight></CodeLine>
<Link id="l02012" /><CodeLine lineNumber="2012"><Highlight kind="normal">                                                      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(0));</Highlight></CodeLine>
<Link id="l02013" /><CodeLine lineNumber="2013"><Highlight kind="normal">      EventVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aae2c1bf70058f3665edaec525457030c">CreatePtrToInt</a>(EventVal, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>());</Highlight></CodeLine>
<Link id="l02014" /><CodeLine lineNumber="2014"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(EventVal, EventHandleAddr);</Highlight></CodeLine>
<Link id="l02015" /><CodeLine lineNumber="2015"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02016" /><CodeLine lineNumber="2016"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Copy the arguments for outlined function</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02017" /><CodeLine lineNumber="2017"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShareds) &#123;</Highlight></CodeLine>
<Link id="l02018" /><CodeLine lineNumber="2018"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Shareds = StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#aabd76e6a8a23a5af1ce4d3c310d88bcd">getArgOperand</a>(1);</Highlight></CodeLine>
<Link id="l02019" /><CodeLine lineNumber="2019"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/arg/key/#a6b334a5f83504ebc99cc59f4f333ff98">Align</a> Alignment = TaskData-&gt;<a href="/docs/api/classes/llvm/value/#a47f5c74e1b14ba4a61db057400644acc">getPointerAlignment</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout());</Highlight></CodeLine>
<Link id="l02020" /><CodeLine lineNumber="2020"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TaskShareds = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(VoidPtr, TaskData);</Highlight></CodeLine>
<Link id="l02021" /><CodeLine lineNumber="2021"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae9f2730f66215fdb82f4e41e45124811">CreateMemCpy</a>(TaskShareds, Alignment, Shareds, Alignment,</Highlight></CodeLine>
<Link id="l02022" /><CodeLine lineNumber="2022"><Highlight kind="normal">                           SharedsSize);</Highlight></CodeLine>
<Link id="l02023" /><CodeLine lineNumber="2023"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02024" /><CodeLine lineNumber="2024"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02025" /><CodeLine lineNumber="2025"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Priority) &#123;</Highlight></CodeLine>
<Link id="l02026" /><CodeLine lineNumber="2026"><Highlight kind="normal">      </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02027" /><CodeLine lineNumber="2027"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// The return type of &quot;&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc&quot; is &quot;kmp&#95;task&#95;t &#42;&quot;,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02028" /><CodeLine lineNumber="2028"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// we populate the priority information into the &quot;kmp&#95;task&#95;t&quot; here</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02029" /><CodeLine lineNumber="2029"><Highlight kind="normal">      </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02030" /><CodeLine lineNumber="2030"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// The struct &quot;kmp&#95;task&#95;t&quot; definition is available in kmp.h</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02031" /><CodeLine lineNumber="2031"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// kmp&#95;task&#95;t = &#123; shareds, routine, part&#95;id, data1, data2 &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02032" /><CodeLine lineNumber="2032"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// data2 is used for priority</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02033" /><CodeLine lineNumber="2033"><Highlight kind="normal">      </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02034" /><CodeLine lineNumber="2034"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;<a href="/docs/api/namespaces/llvm/#a23f9ec4bb2576ca8738f3edc9c4f5cdf">Int32Ty</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>();</Highlight></CodeLine>
<Link id="l02035" /><CodeLine lineNumber="2035"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;<a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a> = ConstantInt::get(<a href="/docs/api/namespaces/llvm/#a23f9ec4bb2576ca8738f3edc9c4f5cdf">Int32Ty</a>, 0);</Highlight></CodeLine>
<Link id="l02036" /><CodeLine lineNumber="2036"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// kmp&#95;task&#95;t&#42; =&gt; &#123; ptr &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02037" /><CodeLine lineNumber="2037"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;TaskPtr = <a href="/docs/api/classes/llvm/structtype/#a18fc4545474c6ebb6f7c547f64f4fb31">StructType::get</a>(VoidPtr);</Highlight></CodeLine>
<Link id="l02038" /><CodeLine lineNumber="2038"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TaskGEP =</Highlight></CodeLine>
<Link id="l02039" /><CodeLine lineNumber="2039"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(TaskPtr, TaskData, &#123;<a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a>, <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a>&#125;);</Highlight></CodeLine>
<Link id="l02040" /><CodeLine lineNumber="2040"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// kmp&#95;task&#95;t =&gt; &#123; ptr, ptr, i32, ptr, ptr &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02041" /><CodeLine lineNumber="2041"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;TaskStructType = <a href="/docs/api/classes/llvm/structtype/#a18fc4545474c6ebb6f7c547f64f4fb31">StructType::get</a>(</Highlight></CodeLine>
<Link id="l02042" /><CodeLine lineNumber="2042"><Highlight kind="normal">          VoidPtr, VoidPtr, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), VoidPtr, VoidPtr);</Highlight></CodeLine>
<Link id="l02043" /><CodeLine lineNumber="2043"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PriorityData = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l02044" /><CodeLine lineNumber="2044"><Highlight kind="normal">          TaskStructType, TaskGEP, &#123;<a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a>, ConstantInt::get(<a href="/docs/api/namespaces/llvm/#a23f9ec4bb2576ca8738f3edc9c4f5cdf">Int32Ty</a>, 4)&#125;);</Highlight></CodeLine>
<Link id="l02045" /><CodeLine lineNumber="2045"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// kmp&#95;cmplrdata&#95;t =&gt; &#123; ptr, ptr &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02046" /><CodeLine lineNumber="2046"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;CmplrStructType = <a href="/docs/api/classes/llvm/structtype/#a18fc4545474c6ebb6f7c547f64f4fb31">StructType::get</a>(VoidPtr, VoidPtr);</Highlight></CodeLine>
<Link id="l02047" /><CodeLine lineNumber="2047"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CmplrData = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(CmplrStructType,</Highlight></CodeLine>
<Link id="l02048" /><CodeLine lineNumber="2048"><Highlight kind="normal">                                                   PriorityData, &#123;<a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a>, <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a>&#125;);</Highlight></CodeLine>
<Link id="l02049" /><CodeLine lineNumber="2049"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Priority, CmplrData);</Highlight></CodeLine>
<Link id="l02050" /><CodeLine lineNumber="2050"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02051" /><CodeLine lineNumber="2051"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02052" /><CodeLine lineNumber="2052"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DepArray = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02053" /><CodeLine lineNumber="2053"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Dependencies.size()) &#123;</Highlight></CodeLine>
<Link id="l02054" /><CodeLine lineNumber="2054"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> OldIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l02055" /><CodeLine lineNumber="2055"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(</Highlight></CodeLine>
<Link id="l02056" /><CodeLine lineNumber="2056"><Highlight kind="normal">          &amp;OldIP.getBlock()-&gt;getParent()-&gt;getEntryBlock().back());</Highlight></CodeLine>
<Link id="l02057" /><CodeLine lineNumber="2057"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02058" /><CodeLine lineNumber="2058"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;DepArrayTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(DependInfo, Dependencies.size());</Highlight></CodeLine>
<Link id="l02059" /><CodeLine lineNumber="2059"><Highlight kind="normal">      DepArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(DepArrayTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.dep.arr.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02060" /><CodeLine lineNumber="2060"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02061" /><CodeLine lineNumber="2061"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = 0;</Highlight></CodeLine>
<Link id="l02062" /><CodeLine lineNumber="2062"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/dependdata">DependData</a> &amp;Dep : Dependencies) &#123;</Highlight></CodeLine>
<Link id="l02063" /><CodeLine lineNumber="2063"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> =</Highlight></CodeLine>
<Link id="l02064" /><CodeLine lineNumber="2064"><Highlight kind="normal">            Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa8ee5dc4e4a1b26c4bdf1a574eefe2fc">CreateConstInBoundsGEP2&#95;64</a>(DepArrayTy, DepArray, 0, <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>);</Highlight></CodeLine>
<Link id="l02065" /><CodeLine lineNumber="2065"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Store the pointer to the variable</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02066" /><CodeLine lineNumber="2066"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Addr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(</Highlight></CodeLine>
<Link id="l02067" /><CodeLine lineNumber="2067"><Highlight kind="normal">            DependInfo, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l02068" /><CodeLine lineNumber="2068"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(RTLDependInfoFields::BaseAddr));</Highlight></CodeLine>
<Link id="l02069" /><CodeLine lineNumber="2069"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DepValPtr =</Highlight></CodeLine>
<Link id="l02070" /><CodeLine lineNumber="2070"><Highlight kind="normal">            Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aae2c1bf70058f3665edaec525457030c">CreatePtrToInt</a>(Dep.DepVal, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>());</Highlight></CodeLine>
<Link id="l02071" /><CodeLine lineNumber="2071"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(DepValPtr, Addr);</Highlight></CodeLine>
<Link id="l02072" /><CodeLine lineNumber="2072"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Store the size of the variable</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02073" /><CodeLine lineNumber="2073"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(</Highlight></CodeLine>
<Link id="l02074" /><CodeLine lineNumber="2074"><Highlight kind="normal">            DependInfo, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l02075" /><CodeLine lineNumber="2075"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(RTLDependInfoFields::Len));</Highlight></CodeLine>
<Link id="l02076" /><CodeLine lineNumber="2076"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(</Highlight></CodeLine>
<Link id="l02077" /><CodeLine lineNumber="2077"><Highlight kind="normal">                                Dep.DepValueType)),</Highlight></CodeLine>
<Link id="l02078" /><CodeLine lineNumber="2078"><Highlight kind="normal">                            <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</Highlight></CodeLine>
<Link id="l02079" /><CodeLine lineNumber="2079"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Store the dependency kind</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02080" /><CodeLine lineNumber="2080"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(</Highlight></CodeLine>
<Link id="l02081" /><CodeLine lineNumber="2081"><Highlight kind="normal">            DependInfo, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l02082" /><CodeLine lineNumber="2082"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(RTLDependInfoFields::Flags));</Highlight></CodeLine>
<Link id="l02083" /><CodeLine lineNumber="2083"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(</Highlight></CodeLine>
<Link id="l02084" /><CodeLine lineNumber="2084"><Highlight kind="normal">            ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae7be2e1490f01c049d748436f03760c5">getInt8Ty</a>(),</Highlight></CodeLine>
<Link id="l02085" /><CodeLine lineNumber="2085"><Highlight kind="normal">                             </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(Dep.DepKind)),</Highlight></CodeLine>
<Link id="l02086" /><CodeLine lineNumber="2086"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>);</Highlight></CodeLine>
<Link id="l02087" /><CodeLine lineNumber="2087"><Highlight kind="normal">        ++<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</Highlight></CodeLine>
<Link id="l02088" /><CodeLine lineNumber="2088"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02089" /><CodeLine lineNumber="2089"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02090" /><CodeLine lineNumber="2090"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OldIP);</Highlight></CodeLine>
<Link id="l02091" /><CodeLine lineNumber="2091"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02092" /><CodeLine lineNumber="2092"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02093" /><CodeLine lineNumber="2093"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// In the presence of the &#96;if&#96; clause, the following IR is generated:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02094" /><CodeLine lineNumber="2094"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    ...</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02095" /><CodeLine lineNumber="2095"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    %data = call @&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02096" /><CodeLine lineNumber="2096"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    br i1 %if&#95;condition, label %then, label %else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02097" /><CodeLine lineNumber="2097"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//  then:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02098" /><CodeLine lineNumber="2098"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    call @&#95;&#95;kmpc&#95;omp&#95;task(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02099" /><CodeLine lineNumber="2099"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    br label %exit</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02100" /><CodeLine lineNumber="2100"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//  else:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02101" /><CodeLine lineNumber="2101"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    ;; Wait for resolution of dependencies, if any, before</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02102" /><CodeLine lineNumber="2102"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    ;; beginning the task</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02103" /><CodeLine lineNumber="2103"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    call @&#95;&#95;kmpc&#95;omp&#95;wait&#95;deps(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02104" /><CodeLine lineNumber="2104"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    call @&#95;&#95;kmpc&#95;omp&#95;task&#95;begin&#95;if0(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02105" /><CodeLine lineNumber="2105"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    call @outlined&#95;fn(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02106" /><CodeLine lineNumber="2106"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    call @&#95;&#95;kmpc&#95;omp&#95;task&#95;complete&#95;if0(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02107" /><CodeLine lineNumber="2107"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    br label %exit</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02108" /><CodeLine lineNumber="2108"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//  exit:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02109" /><CodeLine lineNumber="2109"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//    ...</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02110" /><CodeLine lineNumber="2110"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCondition) &#123;</Highlight></CodeLine>
<Link id="l02111" /><CodeLine lineNumber="2111"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// &#96;SplitBlockAndInsertIfThenElse&#96; requires the block to have a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02112" /><CodeLine lineNumber="2112"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// terminator.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02113" /><CodeLine lineNumber="2113"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;if.end&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02114" /><CodeLine lineNumber="2114"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;IfTerminator =</Highlight></CodeLine>
<Link id="l02115" /><CodeLine lineNumber="2115"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e5c1b91bf5e2860398e3fa35c96b5af">GetInsertPoint</a>()-&gt;getParent()-&gt;getTerminator();</Highlight></CodeLine>
<Link id="l02116" /><CodeLine lineNumber="2116"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;ThenTI = IfTerminator, &#42;ElseTI = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02117" /><CodeLine lineNumber="2117"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(IfTerminator);</Highlight></CodeLine>
<Link id="l02118" /><CodeLine lineNumber="2118"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a7ac00229d8c59902686f52ed061cdc80">SplitBlockAndInsertIfThenElse</a>(IfCondition, IfTerminator, &amp;ThenTI,</Highlight></CodeLine>
<Link id="l02119" /><CodeLine lineNumber="2119"><Highlight kind="normal">                                    &amp;ElseTI);</Highlight></CodeLine>
<Link id="l02120" /><CodeLine lineNumber="2120"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ElseTI);</Highlight></CodeLine>
<Link id="l02121" /><CodeLine lineNumber="2121"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02122" /><CodeLine lineNumber="2122"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Dependencies.size()) &#123;</Highlight></CodeLine>
<Link id="l02123" /><CodeLine lineNumber="2123"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskWaitFn =</Highlight></CodeLine>
<Link id="l02124" /><CodeLine lineNumber="2124"><Highlight kind="normal">            getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;wait&#95;deps);</Highlight></CodeLine>
<Link id="l02125" /><CodeLine lineNumber="2125"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l02126" /><CodeLine lineNumber="2126"><Highlight kind="normal">            TaskWaitFn,</Highlight></CodeLine>
<Link id="l02127" /><CodeLine lineNumber="2127"><Highlight kind="normal">            &#123;Ident, ThreadID, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(Dependencies.size()), DepArray,</Highlight></CodeLine>
<Link id="l02128" /><CodeLine lineNumber="2128"><Highlight kind="normal">             ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), 0),</Highlight></CodeLine>
<Link id="l02129" /><CodeLine lineNumber="2129"><Highlight kind="normal">             <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext()))&#125;);</Highlight></CodeLine>
<Link id="l02130" /><CodeLine lineNumber="2130"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02131" /><CodeLine lineNumber="2131"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskBeginFn =</Highlight></CodeLine>
<Link id="l02132" /><CodeLine lineNumber="2132"><Highlight kind="normal">          getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task&#95;begin&#95;if0);</Highlight></CodeLine>
<Link id="l02133" /><CodeLine lineNumber="2133"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskCompleteFn =</Highlight></CodeLine>
<Link id="l02134" /><CodeLine lineNumber="2134"><Highlight kind="normal">          getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task&#95;complete&#95;if0);</Highlight></CodeLine>
<Link id="l02135" /><CodeLine lineNumber="2135"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskBeginFn, &#123;Ident, ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l02136" /><CodeLine lineNumber="2136"><Highlight kind="normal">      CallInst &#42;CI = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02137" /><CodeLine lineNumber="2137"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShareds)</Highlight></CodeLine>
<Link id="l02138" /><CodeLine lineNumber="2138"><Highlight kind="normal">        CI = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(&amp;OutlinedFn, &#123;ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l02139" /><CodeLine lineNumber="2139"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02140" /><CodeLine lineNumber="2140"><Highlight kind="normal">        CI = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(&amp;OutlinedFn, &#123;ThreadID&#125;);</Highlight></CodeLine>
<Link id="l02141" /><CodeLine lineNumber="2141"><Highlight kind="normal">      CI-&gt;<a href="/docs/api/classes/llvm/instruction/#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(StaleCI-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</Highlight></CodeLine>
<Link id="l02142" /><CodeLine lineNumber="2142"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskCompleteFn, &#123;Ident, ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l02143" /><CodeLine lineNumber="2143"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ThenTI);</Highlight></CodeLine>
<Link id="l02144" /><CodeLine lineNumber="2144"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02145" /><CodeLine lineNumber="2145"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02146" /><CodeLine lineNumber="2146"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Dependencies.size()) &#123;</Highlight></CodeLine>
<Link id="l02147" /><CodeLine lineNumber="2147"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskFn =</Highlight></CodeLine>
<Link id="l02148" /><CodeLine lineNumber="2148"><Highlight kind="normal">          getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task&#95;with&#95;deps);</Highlight></CodeLine>
<Link id="l02149" /><CodeLine lineNumber="2149"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l02150" /><CodeLine lineNumber="2150"><Highlight kind="normal">          TaskFn,</Highlight></CodeLine>
<Link id="l02151" /><CodeLine lineNumber="2151"><Highlight kind="normal">          &#123;Ident, ThreadID, TaskData, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(Dependencies.size()),</Highlight></CodeLine>
<Link id="l02152" /><CodeLine lineNumber="2152"><Highlight kind="normal">           DepArray, ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), 0),</Highlight></CodeLine>
<Link id="l02153" /><CodeLine lineNumber="2153"><Highlight kind="normal">           <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext()))&#125;);</Highlight></CodeLine>
<Link id="l02154" /><CodeLine lineNumber="2154"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02155" /><CodeLine lineNumber="2155"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l02156" /><CodeLine lineNumber="2156"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Emit the @&#95;&#95;kmpc&#95;omp&#95;task runtime call to spawn the task</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02157" /><CodeLine lineNumber="2157"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task);</Highlight></CodeLine>
<Link id="l02158" /><CodeLine lineNumber="2158"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskFn, &#123;Ident, ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l02159" /><CodeLine lineNumber="2159"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02160" /><CodeLine lineNumber="2160"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02161" /><CodeLine lineNumber="2161"><Highlight kind="normal">    StaleCI-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l02162" /><CodeLine lineNumber="2162"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02163" /><CodeLine lineNumber="2163"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(TaskAllocaBB, TaskAllocaBB-&gt;begin());</Highlight></CodeLine>
<Link id="l02164" /><CodeLine lineNumber="2164"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShareds) &#123;</Highlight></CodeLine>
<Link id="l02165" /><CodeLine lineNumber="2165"><Highlight kind="normal">      LoadInst &#42;Shareds = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(VoidPtr, OutlinedFn.getArg(1));</Highlight></CodeLine>
<Link id="l02166" /><CodeLine lineNumber="2166"><Highlight kind="normal">      OutlinedFn.getArg(1)-&gt;<a href="/docs/api/classes/llvm/value/#a7e8dad1701aa6445be4a29f654b0473c">replaceUsesWithIf</a>(</Highlight></CodeLine>
<Link id="l02167" /><CodeLine lineNumber="2167"><Highlight kind="normal">          Shareds, &#91;Shareds&#93;(Use &amp;U) &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser() != Shareds; &#125;);</Highlight></CodeLine>
<Link id="l02168" /><CodeLine lineNumber="2168"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02169" /><CodeLine lineNumber="2169"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02170" /><CodeLine lineNumber="2170"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (Instruction &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">llvm::reverse</a>(ToBeDeleted))</Highlight></CodeLine>
<Link id="l02171" /><CodeLine lineNumber="2171"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l02172" /><CodeLine lineNumber="2172"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l02173" /><CodeLine lineNumber="2173"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02174" /><CodeLine lineNumber="2174"><Highlight kind="normal">  addOutlineInfo(std::move(OI));</Highlight></CodeLine>
<Link id="l02175" /><CodeLine lineNumber="2175"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(TaskExitBB, TaskExitBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l02176" /><CodeLine lineNumber="2176"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02177" /><CodeLine lineNumber="2177"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l02178" /><CodeLine lineNumber="2178"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02179" /><CodeLine lineNumber="2179"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02180" /><CodeLine lineNumber="2180"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l02181" /><CodeLine lineNumber="2181"><Highlight kind="normal">OpenMPIRBuilder::createTaskgroup(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l02182" /><CodeLine lineNumber="2182"><Highlight kind="normal">                                 InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l02183" /><CodeLine lineNumber="2183"><Highlight kind="normal">                                 BodyGenCallbackTy BodyGenCB) &#123;</Highlight></CodeLine>
<Link id="l02184" /><CodeLine lineNumber="2184"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l02185" /><CodeLine lineNumber="2185"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l02186" /><CodeLine lineNumber="2186"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02187" /><CodeLine lineNumber="2187"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l02188" /><CodeLine lineNumber="2188"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l02189" /><CodeLine lineNumber="2189"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l02190" /><CodeLine lineNumber="2190"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadID = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l02191" /><CodeLine lineNumber="2191"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02192" /><CodeLine lineNumber="2192"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the @&#95;&#95;kmpc&#95;taskgroup runtime call to start the taskgroup</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02193" /><CodeLine lineNumber="2193"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskgroupFn =</Highlight></CodeLine>
<Link id="l02194" /><CodeLine lineNumber="2194"><Highlight kind="normal">      getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;taskgroup);</Highlight></CodeLine>
<Link id="l02195" /><CodeLine lineNumber="2195"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskgroupFn, &#123;Ident, ThreadID&#125;);</Highlight></CodeLine>
<Link id="l02196" /><CodeLine lineNumber="2196"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02197" /><CodeLine lineNumber="2197"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;TaskgroupExitBB = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;taskgroup.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02198" /><CodeLine lineNumber="2198"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = BodyGenCB(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()))</Highlight></CodeLine>
<Link id="l02199" /><CodeLine lineNumber="2199"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l02200" /><CodeLine lineNumber="2200"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02201" /><CodeLine lineNumber="2201"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(TaskgroupExitBB);</Highlight></CodeLine>
<Link id="l02202" /><CodeLine lineNumber="2202"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the @&#95;&#95;kmpc&#95;end&#95;taskgroup runtime call to end the taskgroup</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02203" /><CodeLine lineNumber="2203"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;EndTaskgroupFn =</Highlight></CodeLine>
<Link id="l02204" /><CodeLine lineNumber="2204"><Highlight kind="normal">      getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;end&#95;taskgroup);</Highlight></CodeLine>
<Link id="l02205" /><CodeLine lineNumber="2205"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(EndTaskgroupFn, &#123;Ident, ThreadID&#125;);</Highlight></CodeLine>
<Link id="l02206" /><CodeLine lineNumber="2206"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02207" /><CodeLine lineNumber="2207"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l02208" /><CodeLine lineNumber="2208"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02209" /><CodeLine lineNumber="2209"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02210" /><CodeLine lineNumber="2210"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::createSections(</Highlight></CodeLine>
<Link id="l02211" /><CodeLine lineNumber="2211"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l02212" /><CodeLine lineNumber="2212"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;StorableBodyGenCallbackTy&gt;</a> SectionCBs, PrivatizeCallbackTy PrivCB,</Highlight></CodeLine>
<Link id="l02213" /><CodeLine lineNumber="2213"><Highlight kind="normal">    FinalizeCallbackTy FiniCB, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsCancellable, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsNowait) &#123;</Highlight></CodeLine>
<Link id="l02214" /><CodeLine lineNumber="2214"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="#a756b28f370cd5a39bc0ee3e5333b9c9b">isConflictIP</a>(AllocaIP, Loc.IP) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Dedicated IP allocas required&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02215" /><CodeLine lineNumber="2215"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02216" /><CodeLine lineNumber="2216"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l02217" /><CodeLine lineNumber="2217"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l02218" /><CodeLine lineNumber="2218"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02219" /><CodeLine lineNumber="2219"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FiniCBWrapper = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> IP) &#123;</Highlight></CodeLine>
<Link id="l02220" /><CodeLine lineNumber="2220"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IP.getBlock()-&gt;end() != IP.getPoint())</Highlight></CodeLine>
<Link id="l02221" /><CodeLine lineNumber="2221"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> FiniCB(IP);</Highlight></CodeLine>
<Link id="l02222" /><CodeLine lineNumber="2222"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This must be done otherwise any nested constructs using FinalizeOMPRegion</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02223" /><CodeLine lineNumber="2223"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// will fail because that function requires the Finalization Basic Block to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02224" /><CodeLine lineNumber="2224"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// have a terminator, which is already removed by EmitOMPRegionBody.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02225" /><CodeLine lineNumber="2225"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// IP is currently at cancelation block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02226" /><CodeLine lineNumber="2226"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// We need to backtrack to the condition block to fetch</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02227" /><CodeLine lineNumber="2227"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the exit block and create a branch from cancelation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02228" /><CodeLine lineNumber="2228"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// to exit block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02229" /><CodeLine lineNumber="2229"><Highlight kind="normal">    IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l02230" /><CodeLine lineNumber="2230"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(IP);</Highlight></CodeLine>
<Link id="l02231" /><CodeLine lineNumber="2231"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CaseBB = IP.getBlock()-&gt;getSinglePredecessor();</Highlight></CodeLine>
<Link id="l02232" /><CodeLine lineNumber="2232"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CondBB = CaseBB-&gt;getSinglePredecessor()-&gt;getSinglePredecessor();</Highlight></CodeLine>
<Link id="l02233" /><CodeLine lineNumber="2233"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ExitBB = CondBB-&gt;getTerminator()-&gt;getSuccessor(1);</Highlight></CodeLine>
<Link id="l02234" /><CodeLine lineNumber="2234"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(ExitBB);</Highlight></CodeLine>
<Link id="l02235" /><CodeLine lineNumber="2235"><Highlight kind="normal">    IP = <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIterator());</Highlight></CodeLine>
<Link id="l02236" /><CodeLine lineNumber="2236"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> FiniCB(IP);</Highlight></CodeLine>
<Link id="l02237" /><CodeLine lineNumber="2237"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l02238" /><CodeLine lineNumber="2238"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02239" /><CodeLine lineNumber="2239"><Highlight kind="normal">  FinalizationStack.push&#95;back(&#123;FiniCBWrapper, OMPD&#95;sections, IsCancellable&#125;);</Highlight></CodeLine>
<Link id="l02240" /><CodeLine lineNumber="2240"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02241" /><CodeLine lineNumber="2241"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Each section is emitted as a switch case</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02242" /><CodeLine lineNumber="2242"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Each finalization callback is handled from clang.EmitOMPSectionDirective()</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02243" /><CodeLine lineNumber="2243"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// -&gt; OMP.createSection() which generates the IR for each section</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02244" /><CodeLine lineNumber="2244"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Iterate through all sections and emit a switch construct:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02245" /><CodeLine lineNumber="2245"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// switch (IV) &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02246" /><CodeLine lineNumber="2246"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   case 0:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02247" /><CodeLine lineNumber="2247"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     &lt;SectionStmt&#91;0&#93;&gt;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02248" /><CodeLine lineNumber="2248"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     break;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02249" /><CodeLine lineNumber="2249"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ...</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02250" /><CodeLine lineNumber="2250"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   case &lt;NumSection&gt; - 1:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02251" /><CodeLine lineNumber="2251"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     &lt;SectionStmt&#91;&lt;NumSection&gt; - 1&#93;&gt;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02252" /><CodeLine lineNumber="2252"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     break;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02253" /><CodeLine lineNumber="2253"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02254" /><CodeLine lineNumber="2254"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ...</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02255" /><CodeLine lineNumber="2255"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// section&#95;loop.after:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02256" /><CodeLine lineNumber="2256"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &lt;FiniCB&gt;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02257" /><CodeLine lineNumber="2257"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> LoopBodyGenCB = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP, <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IndVar) -&gt; <a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> &#123;</Highlight></CodeLine>
<Link id="l02258" /><CodeLine lineNumber="2258"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l02259" /><CodeLine lineNumber="2259"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a> =</Highlight></CodeLine>
<Link id="l02260" /><CodeLine lineNumber="2260"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a03f30f48490558525cd5458201d13afe">splitBBWithSuffix</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.sections.after&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02261" /><CodeLine lineNumber="2261"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;CurFn = <a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a>-&gt;getParent();</Highlight></CodeLine>
<Link id="l02262" /><CodeLine lineNumber="2262"><Highlight kind="normal">    SwitchInst &#42;SwitchStmt = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8b123015de85b2f41b0deda2aeaad9d3">CreateSwitch</a>(IndVar, <a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a>);</Highlight></CodeLine>
<Link id="l02263" /><CodeLine lineNumber="2263"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02264" /><CodeLine lineNumber="2264"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> CaseNumber = 0;</Highlight></CodeLine>
<Link id="l02265" /><CodeLine lineNumber="2265"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> SectionCB : SectionCBs) &#123;</Highlight></CodeLine>
<Link id="l02266" /><CodeLine lineNumber="2266"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CaseBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l02267" /><CodeLine lineNumber="2267"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;section&#95;loop.body.case&quot;</Highlight><Highlight kind="normal">, CurFn, <a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a>);</Highlight></CodeLine>
<Link id="l02268" /><CodeLine lineNumber="2268"><Highlight kind="normal">      SwitchStmt-&gt;<a href="/docs/api/classes/llvm/switchinst/#a62abc2475d09c01d583ba24a487898fd">addCase</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(CaseNumber), CaseBB);</Highlight></CodeLine>
<Link id="l02269" /><CodeLine lineNumber="2269"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CaseBB);</Highlight></CodeLine>
<Link id="l02270" /><CodeLine lineNumber="2270"><Highlight kind="normal">      BranchInst &#42;CaseEndBr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(<a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a>);</Highlight></CodeLine>
<Link id="l02271" /><CodeLine lineNumber="2271"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = SectionCB(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(), &#123;CaseEndBr-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>(),</Highlight></CodeLine>
<Link id="l02272" /><CodeLine lineNumber="2272"><Highlight kind="normal">                                                  CaseEndBr-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>()&#125;))</Highlight></CodeLine>
<Link id="l02273" /><CodeLine lineNumber="2273"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l02274" /><CodeLine lineNumber="2274"><Highlight kind="normal">      CaseNumber++;</Highlight></CodeLine>
<Link id="l02275" /><CodeLine lineNumber="2275"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02276" /><CodeLine lineNumber="2276"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// remove the existing terminator from body BB since there can be no</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02277" /><CodeLine lineNumber="2277"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// terminators after switch/case</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02278" /><CodeLine lineNumber="2278"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l02279" /><CodeLine lineNumber="2279"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l02280" /><CodeLine lineNumber="2280"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Loop body ends here</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02281" /><CodeLine lineNumber="2281"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// LowerBound, UpperBound, and STride for createCanonicalLoop</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02282" /><CodeLine lineNumber="2282"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;I32Ty = <a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l02283" /><CodeLine lineNumber="2283"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LB = ConstantInt::get(I32Ty, 0);</Highlight></CodeLine>
<Link id="l02284" /><CodeLine lineNumber="2284"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;UB = ConstantInt::get(I32Ty, SectionCBs.size());</Highlight></CodeLine>
<Link id="l02285" /><CodeLine lineNumber="2285"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/arm-mb/#ad70272e2a9ec2a7e3a497458e1edbc85aed0b9bef861c96eee19e89db753db7b2">ST</a> = ConstantInt::get(I32Ty, 1);</Highlight></CodeLine>
<Link id="l02286" /><CodeLine lineNumber="2286"><Highlight kind="normal">  Expected&lt;CanonicalLoopInfo &#42;&gt; LoopInfo = <a href="/docs/api/classes/llvm/openmpirbuilder/#ae0287686a5ffe03bc264972c862726ea">createCanonicalLoop</a>(</Highlight></CodeLine>
<Link id="l02287" /><CodeLine lineNumber="2287"><Highlight kind="normal">      Loc, LoopBodyGenCB, LB, UB, ST, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, AllocaIP, </Highlight><Highlight kind="stringliteral">&quot;section&#95;loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02288" /><CodeLine lineNumber="2288"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LoopInfo)</Highlight></CodeLine>
<Link id="l02289" /><CodeLine lineNumber="2289"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LoopInfo.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l02290" /><CodeLine lineNumber="2290"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02291" /><CodeLine lineNumber="2291"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> WsloopIP =</Highlight></CodeLine>
<Link id="l02292" /><CodeLine lineNumber="2292"><Highlight kind="normal">      applyStaticWorkshareLoop(Loc.DL, &#42;LoopInfo, AllocaIP, !IsNowait);</Highlight></CodeLine>
<Link id="l02293" /><CodeLine lineNumber="2293"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!WsloopIP)</Highlight></CodeLine>
<Link id="l02294" /><CodeLine lineNumber="2294"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> WsloopIP.takeError();</Highlight></CodeLine>
<Link id="l02295" /><CodeLine lineNumber="2295"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AfterIP = &#42;WsloopIP;</Highlight></CodeLine>
<Link id="l02296" /><CodeLine lineNumber="2296"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02297" /><CodeLine lineNumber="2297"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Apply the finalization callback in LoopAfterBB</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02298" /><CodeLine lineNumber="2298"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FiniInfo = FinalizationStack.pop&#95;back&#95;val();</Highlight></CodeLine>
<Link id="l02299" /><CodeLine lineNumber="2299"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FiniInfo.DK == OMPD&#95;sections &amp;&amp;</Highlight></CodeLine>
<Link id="l02300" /><CodeLine lineNumber="2300"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Unexpected finalization stack state!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02301" /><CodeLine lineNumber="2301"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/openmpirbuilder/#a0c571620ff53fdb78e7404f5261dbd23">FinalizeCallbackTy</a> &amp;CB = FiniInfo.FiniCB) &#123;</Highlight></CodeLine>
<Link id="l02302" /><CodeLine lineNumber="2302"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AfterIP);</Highlight></CodeLine>
<Link id="l02303" /><CodeLine lineNumber="2303"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;FiniBB =</Highlight></CodeLine>
<Link id="l02304" /><CodeLine lineNumber="2304"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a03f30f48490558525cd5458201d13afe">splitBBWithSuffix</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;sections.fini&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02305" /><CodeLine lineNumber="2305"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = CB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()))</Highlight></CodeLine>
<Link id="l02306" /><CodeLine lineNumber="2306"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l02307" /><CodeLine lineNumber="2307"><Highlight kind="normal">    AfterIP = &#123;FiniBB, FiniBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>()&#125;;</Highlight></CodeLine>
<Link id="l02308" /><CodeLine lineNumber="2308"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02309" /><CodeLine lineNumber="2309"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02310" /><CodeLine lineNumber="2310"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP;</Highlight></CodeLine>
<Link id="l02311" /><CodeLine lineNumber="2311"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02312" /><CodeLine lineNumber="2312"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02313" /><CodeLine lineNumber="2313"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l02314" /><CodeLine lineNumber="2314"><Highlight kind="normal">OpenMPIRBuilder::createSection(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l02315" /><CodeLine lineNumber="2315"><Highlight kind="normal">                               BodyGenCallbackTy BodyGenCB,</Highlight></CodeLine>
<Link id="l02316" /><CodeLine lineNumber="2316"><Highlight kind="normal">                               FinalizeCallbackTy FiniCB) &#123;</Highlight></CodeLine>
<Link id="l02317" /><CodeLine lineNumber="2317"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l02318" /><CodeLine lineNumber="2318"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l02319" /><CodeLine lineNumber="2319"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02320" /><CodeLine lineNumber="2320"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FiniCBWrapper = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> IP) &#123;</Highlight></CodeLine>
<Link id="l02321" /><CodeLine lineNumber="2321"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IP.getBlock()-&gt;end() != IP.getPoint())</Highlight></CodeLine>
<Link id="l02322" /><CodeLine lineNumber="2322"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> FiniCB(IP);</Highlight></CodeLine>
<Link id="l02323" /><CodeLine lineNumber="2323"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This must be done otherwise any nested constructs using FinalizeOMPRegion</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02324" /><CodeLine lineNumber="2324"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// will fail because that function requires the Finalization Basic Block to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02325" /><CodeLine lineNumber="2325"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// have a terminator, which is already removed by EmitOMPRegionBody.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02326" /><CodeLine lineNumber="2326"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// IP is currently at cancelation block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02327" /><CodeLine lineNumber="2327"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// We need to backtrack to the condition block to fetch</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02328" /><CodeLine lineNumber="2328"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the exit block and create a branch from cancelation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02329" /><CodeLine lineNumber="2329"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// to exit block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02330" /><CodeLine lineNumber="2330"><Highlight kind="normal">    IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l02331" /><CodeLine lineNumber="2331"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(IP);</Highlight></CodeLine>
<Link id="l02332" /><CodeLine lineNumber="2332"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CaseBB = Loc.IP.getBlock();</Highlight></CodeLine>
<Link id="l02333" /><CodeLine lineNumber="2333"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CondBB = CaseBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>();</Highlight></CodeLine>
<Link id="l02334" /><CodeLine lineNumber="2334"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ExitBB = CondBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a6e5d2e18c81baaeec7dadc81a0dea993">getSuccessor</a>(1);</Highlight></CodeLine>
<Link id="l02335" /><CodeLine lineNumber="2335"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(ExitBB);</Highlight></CodeLine>
<Link id="l02336" /><CodeLine lineNumber="2336"><Highlight kind="normal">    IP = <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getIterator());</Highlight></CodeLine>
<Link id="l02337" /><CodeLine lineNumber="2337"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> FiniCB(IP);</Highlight></CodeLine>
<Link id="l02338" /><CodeLine lineNumber="2338"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l02339" /><CodeLine lineNumber="2339"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02340" /><CodeLine lineNumber="2340"><Highlight kind="normal">  Directive OMPD = Directive::OMPD&#95;sections;</Highlight></CodeLine>
<Link id="l02341" /><CodeLine lineNumber="2341"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Since we are using Finalization Callback here, HasFinalize</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02342" /><CodeLine lineNumber="2342"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and IsCancellable have to be true</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02343" /><CodeLine lineNumber="2343"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EmitOMPInlinedRegion(OMPD, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, BodyGenCB, FiniCBWrapper,</Highlight></CodeLine>
<Link id="l02344" /><CodeLine lineNumber="2344"><Highlight kind="normal">                              </Highlight><Highlight kind="comment">/&#42;Conditional&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;hasFinalize&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02345" /><CodeLine lineNumber="2345"><Highlight kind="normal">                              </Highlight><Highlight kind="comment">/&#42;IsCancellable&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02346" /><CodeLine lineNumber="2346"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02347" /><CodeLine lineNumber="2347"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02348" /><CodeLine lineNumber="2348" lineLink="#ab5fa59567e3acc860411770354a1603a"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> <a href="#ab5fa59567e3acc860411770354a1603a">getInsertPointAfterInstr</a>(<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l02349" /><CodeLine lineNumber="2349"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armsubtarget-cpp/#a6f57985fa144303082fa7517a52e6db9">IT</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l02350" /><CodeLine lineNumber="2350"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/arm/armsubtarget-cpp/#a6f57985fa144303082fa7517a52e6db9">IT</a>++;</Highlight></CodeLine>
<Link id="l02351" /><CodeLine lineNumber="2351"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getParent(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armsubtarget-cpp/#a6f57985fa144303082fa7517a52e6db9">IT</a>);</Highlight></CodeLine>
<Link id="l02352" /><CodeLine lineNumber="2352"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02353" /><CodeLine lineNumber="2353"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02354" /><CodeLine lineNumber="2354"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::getGPUThreadID() &#123;</Highlight></CodeLine>
<Link id="l02355" /><CodeLine lineNumber="2355"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l02356" /><CodeLine lineNumber="2356"><Highlight kind="normal">      getOrCreateRuntimeFunction(M,</Highlight></CodeLine>
<Link id="l02357" /><CodeLine lineNumber="2357"><Highlight kind="normal">                                 OMPRTL&#95;&#95;&#95;kmpc&#95;get&#95;hardware&#95;thread&#95;id&#95;in&#95;block),</Highlight></CodeLine>
<Link id="l02358" /><CodeLine lineNumber="2358"><Highlight kind="normal">      &#123;&#125;);</Highlight></CodeLine>
<Link id="l02359" /><CodeLine lineNumber="2359"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02360" /><CodeLine lineNumber="2360"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02361" /><CodeLine lineNumber="2361"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::getGPUWarpSize() &#123;</Highlight></CodeLine>
<Link id="l02362" /><CodeLine lineNumber="2362"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l02363" /><CodeLine lineNumber="2363"><Highlight kind="normal">      getOrCreateRuntimeFunction(M, OMPRTL&#95;&#95;&#95;kmpc&#95;get&#95;warp&#95;size), &#123;&#125;);</Highlight></CodeLine>
<Link id="l02364" /><CodeLine lineNumber="2364"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02365" /><CodeLine lineNumber="2365"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02366" /><CodeLine lineNumber="2366"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::getNVPTXWarpID() &#123;</Highlight></CodeLine>
<Link id="l02367" /><CodeLine lineNumber="2367"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LaneIDBits = <a href="/docs/api/namespaces/llvm/#a646986783f35e0fef8988f0f28d2589f">Log2&#95;32</a>(Config.getGridValue().GV&#95;Warp&#95;Size);</Highlight></CodeLine>
<Link id="l02368" /><CodeLine lineNumber="2368"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#adc6a2686b807c18e4a7f7fc58e68d423">CreateAShr</a>(getGPUThreadID(), LaneIDBits, </Highlight><Highlight kind="stringliteral">&quot;nvptx&#95;warp&#95;id&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02369" /><CodeLine lineNumber="2369"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02370" /><CodeLine lineNumber="2370"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02371" /><CodeLine lineNumber="2371"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::getNVPTXLaneID() &#123;</Highlight></CodeLine>
<Link id="l02372" /><CodeLine lineNumber="2372"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LaneIDBits = <a href="/docs/api/namespaces/llvm/#a646986783f35e0fef8988f0f28d2589f">Log2&#95;32</a>(Config.getGridValue().GV&#95;Warp&#95;Size);</Highlight></CodeLine>
<Link id="l02373" /><CodeLine lineNumber="2373"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LaneIDBits &lt; 32 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Invalid LaneIDBits size in NVPTX device.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02374" /><CodeLine lineNumber="2374"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LaneIDMask = ~0<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea7b774effe4a349c6dd82ad4f4f21d34c">u</a> &gt;&gt; (32u - LaneIDBits);</Highlight></CodeLine>
<Link id="l02375" /><CodeLine lineNumber="2375"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(getGPUThreadID(), Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(LaneIDMask),</Highlight></CodeLine>
<Link id="l02376" /><CodeLine lineNumber="2376"><Highlight kind="normal">                           </Highlight><Highlight kind="stringliteral">&quot;nvptx&#95;lane&#95;id&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02377" /><CodeLine lineNumber="2377"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02378" /><CodeLine lineNumber="2378"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02379" /><CodeLine lineNumber="2379"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::castValueToType(InsertPointTy AllocaIP, <a href="/docs/api/classes/llvm/value">Value</a> &#42;From,</Highlight></CodeLine>
<Link id="l02380" /><CodeLine lineNumber="2380"><Highlight kind="normal">                                        <a href="/docs/api/classes/llvm/type">Type</a> &#42;ToType) &#123;</Highlight></CodeLine>
<Link id="l02381" /><CodeLine lineNumber="2381"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;<a href="/docs/api/namespaces/llvm/nvptx/ptxldstinstcode/#a0c4e2aa2235abdd10d2beffa32cd9b14">FromType</a> = From-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l02382" /><CodeLine lineNumber="2382"><Highlight kind="normal">  uint64&#95;t FromSize = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(FromType);</Highlight></CodeLine>
<Link id="l02383" /><CodeLine lineNumber="2383"><Highlight kind="normal">  uint64&#95;t ToSize = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(ToType);</Highlight></CodeLine>
<Link id="l02384" /><CodeLine lineNumber="2384"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FromSize &gt; 0 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;From size must be greater than zero&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02385" /><CodeLine lineNumber="2385"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ToSize &gt; 0 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;To size must be greater than zero&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02386" /><CodeLine lineNumber="2386"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FromType == ToType)</Highlight></CodeLine>
<Link id="l02387" /><CodeLine lineNumber="2387"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> From;</Highlight></CodeLine>
<Link id="l02388" /><CodeLine lineNumber="2388"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FromSize == ToSize)</Highlight></CodeLine>
<Link id="l02389" /><CodeLine lineNumber="2389"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(From, ToType);</Highlight></CodeLine>
<Link id="l02390" /><CodeLine lineNumber="2390"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ToType-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp; <a href="/docs/api/namespaces/llvm/nvptx/ptxldstinstcode/#a0c4e2aa2235abdd10d2beffa32cd9b14">FromType</a>-&gt;isIntegerTy())</Highlight></CodeLine>
<Link id="l02391" /><CodeLine lineNumber="2391"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac79ca3c2d2d74cf33684397a91846564">CreateIntCast</a>(From, ToType, </Highlight><Highlight kind="comment">/&#42;isSigned&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02392" /><CodeLine lineNumber="2392"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> SaveIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l02393" /><CodeLine lineNumber="2393"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l02394" /><CodeLine lineNumber="2394"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CastItem = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(ToType);</Highlight></CodeLine>
<Link id="l02395" /><CodeLine lineNumber="2395"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(SaveIP);</Highlight></CodeLine>
<Link id="l02396" /><CodeLine lineNumber="2396"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02397" /><CodeLine lineNumber="2397"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ValCastItem = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02398" /><CodeLine lineNumber="2398"><Highlight kind="normal">      CastItem, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(0));</Highlight></CodeLine>
<Link id="l02399" /><CodeLine lineNumber="2399"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(From, ValCastItem);</Highlight></CodeLine>
<Link id="l02400" /><CodeLine lineNumber="2400"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(ToType, CastItem);</Highlight></CodeLine>
<Link id="l02401" /><CodeLine lineNumber="2401"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02402" /><CodeLine lineNumber="2402"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02403" /><CodeLine lineNumber="2403"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::createRuntimeShuffleFunction(InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l02404" /><CodeLine lineNumber="2404"><Highlight kind="normal">                                                     <a href="/docs/api/classes/llvm/value">Value</a> &#42;Element,</Highlight></CodeLine>
<Link id="l02405" /><CodeLine lineNumber="2405"><Highlight kind="normal">                                                     <a href="/docs/api/classes/llvm/type">Type</a> &#42;ElementType,</Highlight></CodeLine>
<Link id="l02406" /><CodeLine lineNumber="2406"><Highlight kind="normal">                                                     <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &#123;</Highlight></CodeLine>
<Link id="l02407" /><CodeLine lineNumber="2407"><Highlight kind="normal">  uint64&#95;t <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(ElementType);</Highlight></CodeLine>
<Link id="l02408" /><CodeLine lineNumber="2408"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &lt;= 8 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Unsupported bitwidth in shuffle instruction&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02409" /><CodeLine lineNumber="2409"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02410" /><CodeLine lineNumber="2410"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Cast all types to 32- or 64-bit values before calling shuffle routines.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02411" /><CodeLine lineNumber="2411"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;CastTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a31e2db8d1b315202d2c19e711b5365fd">getIntNTy</a>(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &lt;= 4 ? 32 : 64);</Highlight></CodeLine>
<Link id="l02412" /><CodeLine lineNumber="2412"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemCast = castValueToType(AllocaIP, Element, CastTy);</Highlight></CodeLine>
<Link id="l02413" /><CodeLine lineNumber="2413"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;WarpSize =</Highlight></CodeLine>
<Link id="l02414" /><CodeLine lineNumber="2414"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac79ca3c2d2d74cf33684397a91846564">CreateIntCast</a>(getGPUWarpSize(), Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a7325c05ca5ad3b239d1e88b933324c01">getInt16Ty</a>(), </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02415" /><CodeLine lineNumber="2415"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ShuffleFunc = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l02416" /><CodeLine lineNumber="2416"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &lt;= 4 ? RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;shuffle&#95;int32</Highlight></CodeLine>
<Link id="l02417" /><CodeLine lineNumber="2417"><Highlight kind="normal">                : RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;shuffle&#95;int64);</Highlight></CodeLine>
<Link id="l02418" /><CodeLine lineNumber="2418"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;WarpSizeCast =</Highlight></CodeLine>
<Link id="l02419" /><CodeLine lineNumber="2419"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac79ca3c2d2d74cf33684397a91846564">CreateIntCast</a>(WarpSize, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a7325c05ca5ad3b239d1e88b933324c01">getInt16Ty</a>(), </Highlight><Highlight kind="comment">/&#42;isSigned=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02420" /><CodeLine lineNumber="2420"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ShuffleCall =</Highlight></CodeLine>
<Link id="l02421" /><CodeLine lineNumber="2421"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ShuffleFunc, &#123;ElemCast, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, WarpSizeCast&#125;);</Highlight></CodeLine>
<Link id="l02422" /><CodeLine lineNumber="2422"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> castValueToType(AllocaIP, ShuffleCall, CastTy);</Highlight></CodeLine>
<Link id="l02423" /><CodeLine lineNumber="2423"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02424" /><CodeLine lineNumber="2424"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02425" /><CodeLine lineNumber="2425"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::shuffleAndStore(InsertPointTy AllocaIP, <a href="/docs/api/classes/llvm/value">Value</a> &#42;SrcAddr,</Highlight></CodeLine>
<Link id="l02426" /><CodeLine lineNumber="2426"><Highlight kind="normal">                                      <a href="/docs/api/classes/llvm/value">Value</a> &#42;DstAddr, <a href="/docs/api/classes/llvm/type">Type</a> &#42;ElemType,</Highlight></CodeLine>
<Link id="l02427" /><CodeLine lineNumber="2427"><Highlight kind="normal">                                      <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a href="/docs/api/classes/llvm/type">Type</a> &#42;ReductionArrayTy) &#123;</Highlight></CodeLine>
<Link id="l02428" /><CodeLine lineNumber="2428"><Highlight kind="normal">  uint64&#95;t <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(ElemType);</Highlight></CodeLine>
<Link id="l02429" /><CodeLine lineNumber="2429"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create the loop over the big sized data.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02430" /><CodeLine lineNumber="2430"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ptr = (void&#42;)Elem;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02431" /><CodeLine lineNumber="2431"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ptrEnd = (void&#42;) Elem + 1;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02432" /><CodeLine lineNumber="2432"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Step = 8;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02433" /><CodeLine lineNumber="2433"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// while (ptr + Step &lt; ptrEnd)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02434" /><CodeLine lineNumber="2434"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   shuffle((int64&#95;t)&#42;ptr);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02435" /><CodeLine lineNumber="2435"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Step = 4;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02436" /><CodeLine lineNumber="2436"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// while (ptr + Step &lt; ptrEnd)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02437" /><CodeLine lineNumber="2437"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   shuffle((int32&#95;t)&#42;ptr);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02438" /><CodeLine lineNumber="2438"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ...</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02439" /><CodeLine lineNumber="2439"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l02440" /><CodeLine lineNumber="2440"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l02441" /><CodeLine lineNumber="2441"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemPtr = DstAddr;</Highlight></CodeLine>
<Link id="l02442" /><CodeLine lineNumber="2442"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = SrcAddr;</Highlight></CodeLine>
<Link id="l02443" /><CodeLine lineNumber="2443"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IntSize = 8; IntSize &gt;= 1; IntSize /= 2) &#123;</Highlight></CodeLine>
<Link id="l02444" /><CodeLine lineNumber="2444"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &lt; IntSize)</Highlight></CodeLine>
<Link id="l02445" /><CodeLine lineNumber="2445"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02446" /><CodeLine lineNumber="2446"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IntType = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a31e2db8d1b315202d2c19e711b5365fd">getIntNTy</a>(IntSize &#42; 8);</Highlight></CodeLine>
<Link id="l02447" /><CodeLine lineNumber="2447"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02448" /><CodeLine lineNumber="2448"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(0), <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02449" /><CodeLine lineNumber="2449"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcAddrGEP =</Highlight></CodeLine>
<Link id="l02450" /><CodeLine lineNumber="2450"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(ElemType, SrcAddr, &#123;ConstantInt::get(IndexTy, 1)&#125;);</Highlight></CodeLine>
<Link id="l02451" /><CodeLine lineNumber="2451"><Highlight kind="normal">    ElemPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02452" /><CodeLine lineNumber="2452"><Highlight kind="normal">        ElemPtr, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(0), ElemPtr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02453" /><CodeLine lineNumber="2453"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02454" /><CodeLine lineNumber="2454"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;CurFunc = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l02455" /><CodeLine lineNumber="2455"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> / IntSize) &gt; 1) &#123;</Highlight></CodeLine>
<Link id="l02456" /><CodeLine lineNumber="2456"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PtrEnd = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02457" /><CodeLine lineNumber="2457"><Highlight kind="normal">          SrcAddrGEP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l02458" /><CodeLine lineNumber="2458"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;PreCondBB =</Highlight></CodeLine>
<Link id="l02459" /><CodeLine lineNumber="2459"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;.shuffle.pre&#95;cond&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02460" /><CodeLine lineNumber="2460"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ThenBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;.shuffle.then&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02461" /><CodeLine lineNumber="2461"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ExitBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;.shuffle.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02462" /><CodeLine lineNumber="2462"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CurrentBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l02463" /><CodeLine lineNumber="2463"><Highlight kind="normal">      emitBlock(PreCondBB, CurFunc);</Highlight></CodeLine>
<Link id="l02464" /><CodeLine lineNumber="2464"><Highlight kind="normal">      PHINode &#42;PhiSrc =</Highlight></CodeLine>
<Link id="l02465" /><CodeLine lineNumber="2465"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a876fb556ecea804faa2cd8ad1e498ec3">CreatePHI</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;getType(), </Highlight><Highlight kind="comment">/&#42;NumReservedValues=&#42;/</Highlight><Highlight kind="normal">2);</Highlight></CodeLine>
<Link id="l02466" /><CodeLine lineNumber="2466"><Highlight kind="normal">      PhiSrc-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, CurrentBB);</Highlight></CodeLine>
<Link id="l02467" /><CodeLine lineNumber="2467"><Highlight kind="normal">      PHINode &#42;PhiDest =</Highlight></CodeLine>
<Link id="l02468" /><CodeLine lineNumber="2468"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a876fb556ecea804faa2cd8ad1e498ec3">CreatePHI</a>(ElemPtr-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>(), </Highlight><Highlight kind="comment">/&#42;NumReservedValues=&#42;/</Highlight><Highlight kind="normal">2);</Highlight></CodeLine>
<Link id="l02469" /><CodeLine lineNumber="2469"><Highlight kind="normal">      PhiDest-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(ElemPtr, CurrentBB);</Highlight></CodeLine>
<Link id="l02470" /><CodeLine lineNumber="2470"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = PhiSrc;</Highlight></CodeLine>
<Link id="l02471" /><CodeLine lineNumber="2471"><Highlight kind="normal">      ElemPtr = PhiDest;</Highlight></CodeLine>
<Link id="l02472" /><CodeLine lineNumber="2472"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PtrDiff = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a08252ccfac4481c88092435e56a0fb3b">CreatePtrDiff</a>(</Highlight></CodeLine>
<Link id="l02473" /><CodeLine lineNumber="2473"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae7be2e1490f01c049d748436f03760c5">getInt8Ty</a>(), PtrEnd,</Highlight></CodeLine>
<Link id="l02474" /><CodeLine lineNumber="2474"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>()));</Highlight></CodeLine>
<Link id="l02475" /><CodeLine lineNumber="2475"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(</Highlight></CodeLine>
<Link id="l02476" /><CodeLine lineNumber="2476"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a3280551f1232a760cb7b21e85fdd5eca">CreateICmpSGT</a>(PtrDiff, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(IntSize - 1)), ThenBB,</Highlight></CodeLine>
<Link id="l02477" /><CodeLine lineNumber="2477"><Highlight kind="normal">          ExitBB);</Highlight></CodeLine>
<Link id="l02478" /><CodeLine lineNumber="2478"><Highlight kind="normal">      emitBlock(ThenBB, CurFunc);</Highlight></CodeLine>
<Link id="l02479" /><CodeLine lineNumber="2479"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Res = createRuntimeShuffleFunction(</Highlight></CodeLine>
<Link id="l02480" /><CodeLine lineNumber="2480"><Highlight kind="normal">          AllocaIP,</Highlight></CodeLine>
<Link id="l02481" /><CodeLine lineNumber="2481"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a3313ae2d314fb689cebdaf062d86eec5">CreateAlignedLoad</a>(</Highlight></CodeLine>
<Link id="l02482" /><CodeLine lineNumber="2482"><Highlight kind="normal">              IntType, <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(ElemType)),</Highlight></CodeLine>
<Link id="l02483" /><CodeLine lineNumber="2483"><Highlight kind="normal">          IntType, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</Highlight></CodeLine>
<Link id="l02484" /><CodeLine lineNumber="2484"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(Res, ElemPtr,</Highlight></CodeLine>
<Link id="l02485" /><CodeLine lineNumber="2485"><Highlight kind="normal">                                 <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(ElemType));</Highlight></CodeLine>
<Link id="l02486" /><CodeLine lineNumber="2486"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LocalPtr =</Highlight></CodeLine>
<Link id="l02487" /><CodeLine lineNumber="2487"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(IntType, <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &#123;ConstantInt::get(IndexTy, 1)&#125;);</Highlight></CodeLine>
<Link id="l02488" /><CodeLine lineNumber="2488"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LocalElemPtr =</Highlight></CodeLine>
<Link id="l02489" /><CodeLine lineNumber="2489"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(IntType, ElemPtr, &#123;ConstantInt::get(IndexTy, 1)&#125;);</Highlight></CodeLine>
<Link id="l02490" /><CodeLine lineNumber="2490"><Highlight kind="normal">      PhiSrc-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(LocalPtr, ThenBB);</Highlight></CodeLine>
<Link id="l02491" /><CodeLine lineNumber="2491"><Highlight kind="normal">      PhiDest-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(LocalElemPtr, ThenBB);</Highlight></CodeLine>
<Link id="l02492" /><CodeLine lineNumber="2492"><Highlight kind="normal">      emitBranch(PreCondBB);</Highlight></CodeLine>
<Link id="l02493" /><CodeLine lineNumber="2493"><Highlight kind="normal">      emitBlock(ExitBB, CurFunc);</Highlight></CodeLine>
<Link id="l02494" /><CodeLine lineNumber="2494"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l02495" /><CodeLine lineNumber="2495"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Res = createRuntimeShuffleFunction(</Highlight></CodeLine>
<Link id="l02496" /><CodeLine lineNumber="2496"><Highlight kind="normal">          AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(IntType, <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>), IntType, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</Highlight></CodeLine>
<Link id="l02497" /><CodeLine lineNumber="2497"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ElemType-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp; ElemType-&gt;<a href="/docs/api/classes/llvm/type/#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>() &lt;</Highlight></CodeLine>
<Link id="l02498" /><CodeLine lineNumber="2498"><Highlight kind="normal">                                         Res-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>())</Highlight></CodeLine>
<Link id="l02499" /><CodeLine lineNumber="2499"><Highlight kind="normal">        Res = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab5b4acb0f45af3f2308cad1468804f1e">CreateTrunc</a>(Res, ElemType);</Highlight></CodeLine>
<Link id="l02500" /><CodeLine lineNumber="2500"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Res, ElemPtr);</Highlight></CodeLine>
<Link id="l02501" /><CodeLine lineNumber="2501"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(IntType, <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>, &#123;ConstantInt::get(IndexTy, 1)&#125;);</Highlight></CodeLine>
<Link id="l02502" /><CodeLine lineNumber="2502"><Highlight kind="normal">      ElemPtr =</Highlight></CodeLine>
<Link id="l02503" /><CodeLine lineNumber="2503"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(IntType, ElemPtr, &#123;ConstantInt::get(IndexTy, 1)&#125;);</Highlight></CodeLine>
<Link id="l02504" /><CodeLine lineNumber="2504"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02505" /><CodeLine lineNumber="2505"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> % IntSize;</Highlight></CodeLine>
<Link id="l02506" /><CodeLine lineNumber="2506"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02507" /><CodeLine lineNumber="2507"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02508" /><CodeLine lineNumber="2508"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02509" /><CodeLine lineNumber="2509"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitReductionListCopy(</Highlight></CodeLine>
<Link id="l02510" /><CodeLine lineNumber="2510"><Highlight kind="normal">    InsertPointTy AllocaIP, CopyAction Action, <a href="/docs/api/classes/llvm/type">Type</a> &#42;ReductionArrayTy,</Highlight></CodeLine>
<Link id="l02511" /><CodeLine lineNumber="2511"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos, <a href="/docs/api/classes/llvm/value">Value</a> &#42;SrcBase, <a href="/docs/api/classes/llvm/value">Value</a> &#42;DestBase,</Highlight></CodeLine>
<Link id="l02512" /><CodeLine lineNumber="2512"><Highlight kind="normal">    CopyOptionsTy CopyOptions) &#123;</Highlight></CodeLine>
<Link id="l02513" /><CodeLine lineNumber="2513"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l02514" /><CodeLine lineNumber="2514"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l02515" /><CodeLine lineNumber="2515"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RemoteLaneOffset = CopyOptions.RemoteLaneOffset;</Highlight></CodeLine>
<Link id="l02516" /><CodeLine lineNumber="2516"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02517" /><CodeLine lineNumber="2517"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Iterates, element-by-element, through the source Reduce list and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02518" /><CodeLine lineNumber="2518"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// make a copy.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02519" /><CodeLine lineNumber="2519"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l02520" /><CodeLine lineNumber="2520"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l02521" /><CodeLine lineNumber="2521"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcElementAddr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02522" /><CodeLine lineNumber="2522"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DestElementAddr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02523" /><CodeLine lineNumber="2523"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DestElementPtrAddr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02524" /><CodeLine lineNumber="2524"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Should we shuffle in an element from a remote lane?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02525" /><CodeLine lineNumber="2525"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> ShuffleInElement = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02526" /><CodeLine lineNumber="2526"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Set to true to update the pointer in the dest Reduce list to a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02527" /><CodeLine lineNumber="2527"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// newly created element.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02528" /><CodeLine lineNumber="2528"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> UpdateDestListPtr = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02529" /><CodeLine lineNumber="2529"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02530" /><CodeLine lineNumber="2530"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Step 1.1: Get the address for the src element in the Reduce list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02531" /><CodeLine lineNumber="2531"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcElementPtrAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l02532" /><CodeLine lineNumber="2532"><Highlight kind="normal">        ReductionArrayTy, SrcBase,</Highlight></CodeLine>
<Link id="l02533" /><CodeLine lineNumber="2533"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l02534" /><CodeLine lineNumber="2534"><Highlight kind="normal">    SrcElementAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), SrcElementPtrAddr);</Highlight></CodeLine>
<Link id="l02535" /><CodeLine lineNumber="2535"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02536" /><CodeLine lineNumber="2536"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Step 1.2: Create a temporary to store the element in the destination</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02537" /><CodeLine lineNumber="2537"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Reduce list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02538" /><CodeLine lineNumber="2538"><Highlight kind="normal">    DestElementPtrAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l02539" /><CodeLine lineNumber="2539"><Highlight kind="normal">        ReductionArrayTy, DestBase,</Highlight></CodeLine>
<Link id="l02540" /><CodeLine lineNumber="2540"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l02541" /><CodeLine lineNumber="2541"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (Action) &#123;</Highlight></CodeLine>
<Link id="l02542" /><CodeLine lineNumber="2542"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> CopyAction::RemoteLaneToThread: &#123;</Highlight></CodeLine>
<Link id="l02543" /><CodeLine lineNumber="2543"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CurIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l02544" /><CodeLine lineNumber="2544"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l02545" /><CodeLine lineNumber="2545"><Highlight kind="normal">      AllocaInst &#42;DestAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(RI.ElementType, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02546" /><CodeLine lineNumber="2546"><Highlight kind="normal">                                                    </Highlight><Highlight kind="stringliteral">&quot;.omp.reduction.element&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02547" /><CodeLine lineNumber="2547"><Highlight kind="normal">      DestAlloca-&gt;<a href="/docs/api/classes/llvm/allocainst/#af3bb24b322533dbe8a63c84b18568fe1">setAlignment</a>(</Highlight></CodeLine>
<Link id="l02548" /><CodeLine lineNumber="2548"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(RI.ElementType));</Highlight></CodeLine>
<Link id="l02549" /><CodeLine lineNumber="2549"><Highlight kind="normal">      DestElementAddr = DestAlloca;</Highlight></CodeLine>
<Link id="l02550" /><CodeLine lineNumber="2550"><Highlight kind="normal">      DestElementAddr =</Highlight></CodeLine>
<Link id="l02551" /><CodeLine lineNumber="2551"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aeb6ccc122c2f6868fc3a1e68e1ae157c">CreateAddrSpaceCast</a>(DestElementAddr, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l02552" /><CodeLine lineNumber="2552"><Highlight kind="normal">                                      DestElementAddr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02553" /><CodeLine lineNumber="2553"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CurIP);</Highlight></CodeLine>
<Link id="l02554" /><CodeLine lineNumber="2554"><Highlight kind="normal">      ShuffleInElement = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02555" /><CodeLine lineNumber="2555"><Highlight kind="normal">      UpdateDestListPtr = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02556" /><CodeLine lineNumber="2556"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02557" /><CodeLine lineNumber="2557"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02558" /><CodeLine lineNumber="2558"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> CopyAction::ThreadCopy: &#123;</Highlight></CodeLine>
<Link id="l02559" /><CodeLine lineNumber="2559"><Highlight kind="normal">      DestElementAddr =</Highlight></CodeLine>
<Link id="l02560" /><CodeLine lineNumber="2560"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), DestElementPtrAddr);</Highlight></CodeLine>
<Link id="l02561" /><CodeLine lineNumber="2561"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02562" /><CodeLine lineNumber="2562"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02563" /><CodeLine lineNumber="2563"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02564" /><CodeLine lineNumber="2564"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02565" /><CodeLine lineNumber="2565"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Now that all active lanes have read the element in the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02566" /><CodeLine lineNumber="2566"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Reduce list, shuffle over the value from the remote lane.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02567" /><CodeLine lineNumber="2567"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ShuffleInElement) &#123;</Highlight></CodeLine>
<Link id="l02568" /><CodeLine lineNumber="2568"><Highlight kind="normal">      shuffleAndStore(AllocaIP, SrcElementAddr, DestElementAddr, RI.ElementType,</Highlight></CodeLine>
<Link id="l02569" /><CodeLine lineNumber="2569"><Highlight kind="normal">                      RemoteLaneOffset, ReductionArrayTy);</Highlight></CodeLine>
<Link id="l02570" /><CodeLine lineNumber="2570"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l02571" /><CodeLine lineNumber="2571"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (RI.EvaluationKind) &#123;</Highlight></CodeLine>
<Link id="l02572" /><CodeLine lineNumber="2572"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Scalar: &#123;</Highlight></CodeLine>
<Link id="l02573" /><CodeLine lineNumber="2573"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Elem = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(RI.ElementType, SrcElementAddr);</Highlight></CodeLine>
<Link id="l02574" /><CodeLine lineNumber="2574"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Store the source element value to the dest element address.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02575" /><CodeLine lineNumber="2575"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Elem, DestElementAddr);</Highlight></CodeLine>
<Link id="l02576" /><CodeLine lineNumber="2576"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02577" /><CodeLine lineNumber="2577"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02578" /><CodeLine lineNumber="2578"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Complex: &#123;</Highlight></CodeLine>
<Link id="l02579" /><CodeLine lineNumber="2579"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcRealPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l02580" /><CodeLine lineNumber="2580"><Highlight kind="normal">            RI.ElementType, SrcElementAddr, 0, 0, </Highlight><Highlight kind="stringliteral">&quot;.realp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02581" /><CodeLine lineNumber="2581"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcReal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(</Highlight></CodeLine>
<Link id="l02582" /><CodeLine lineNumber="2582"><Highlight kind="normal">            RI.ElementType-&gt;getStructElementType(0), SrcRealPtr, </Highlight><Highlight kind="stringliteral">&quot;.real&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02583" /><CodeLine lineNumber="2583"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcImgPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l02584" /><CodeLine lineNumber="2584"><Highlight kind="normal">            RI.ElementType, SrcElementAddr, 0, 1, </Highlight><Highlight kind="stringliteral">&quot;.imagp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02585" /><CodeLine lineNumber="2585"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcImg = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(</Highlight></CodeLine>
<Link id="l02586" /><CodeLine lineNumber="2586"><Highlight kind="normal">            RI.ElementType-&gt;getStructElementType(1), SrcImgPtr, </Highlight><Highlight kind="stringliteral">&quot;.imag&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02587" /><CodeLine lineNumber="2587"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02588" /><CodeLine lineNumber="2588"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DestRealPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l02589" /><CodeLine lineNumber="2589"><Highlight kind="normal">            RI.ElementType, DestElementAddr, 0, 0, </Highlight><Highlight kind="stringliteral">&quot;.realp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02590" /><CodeLine lineNumber="2590"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DestImgPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l02591" /><CodeLine lineNumber="2591"><Highlight kind="normal">            RI.ElementType, DestElementAddr, 0, 1, </Highlight><Highlight kind="stringliteral">&quot;.imagp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02592" /><CodeLine lineNumber="2592"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(SrcReal, DestRealPtr);</Highlight></CodeLine>
<Link id="l02593" /><CodeLine lineNumber="2593"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(SrcImg, DestImgPtr);</Highlight></CodeLine>
<Link id="l02594" /><CodeLine lineNumber="2594"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02595" /><CodeLine lineNumber="2595"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02596" /><CodeLine lineNumber="2596"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Aggregate: &#123;</Highlight></CodeLine>
<Link id="l02597" /><CodeLine lineNumber="2597"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SizeVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l02598" /><CodeLine lineNumber="2598"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(RI.ElementType));</Highlight></CodeLine>
<Link id="l02599" /><CodeLine lineNumber="2599"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae9f2730f66215fdb82f4e41e45124811">CreateMemCpy</a>(</Highlight></CodeLine>
<Link id="l02600" /><CodeLine lineNumber="2600"><Highlight kind="normal">            DestElementAddr, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(RI.ElementType),</Highlight></CodeLine>
<Link id="l02601" /><CodeLine lineNumber="2601"><Highlight kind="normal">            SrcElementAddr, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(RI.ElementType),</Highlight></CodeLine>
<Link id="l02602" /><CodeLine lineNumber="2602"><Highlight kind="normal">            SizeVal, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02603" /><CodeLine lineNumber="2603"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02604" /><CodeLine lineNumber="2604"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02605" /><CodeLine lineNumber="2605"><Highlight kind="normal">      &#125;;</Highlight></CodeLine>
<Link id="l02606" /><CodeLine lineNumber="2606"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02607" /><CodeLine lineNumber="2607"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02608" /><CodeLine lineNumber="2608"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Step 3.1: Modify reference in dest Reduce list as needed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02609" /><CodeLine lineNumber="2609"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Modifying the reference in Reduce list to point to the newly</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02610" /><CodeLine lineNumber="2610"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// created element.  The element is live in the current function</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02611" /><CodeLine lineNumber="2611"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// scope and that of functions it invokes (i.e., reduce&#95;function).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02612" /><CodeLine lineNumber="2612"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// RemoteReduceData&#91;i&#93; = (void&#42;)&amp;RemoteElem</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02613" /><CodeLine lineNumber="2613"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UpdateDestListPtr) &#123;</Highlight></CodeLine>
<Link id="l02614" /><CodeLine lineNumber="2614"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CastDestAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02615" /><CodeLine lineNumber="2615"><Highlight kind="normal">          DestElementAddr, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l02616" /><CodeLine lineNumber="2616"><Highlight kind="normal">          DestElementAddr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02617" /><CodeLine lineNumber="2617"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(CastDestAddr, DestElementPtrAddr);</Highlight></CodeLine>
<Link id="l02618" /><CodeLine lineNumber="2618"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02619" /><CodeLine lineNumber="2619"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02620" /><CodeLine lineNumber="2620"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02621" /><CodeLine lineNumber="2621"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02622" /><CodeLine lineNumber="2622"><Highlight kind="normal"><a href="/docs/api/classes/llvm/expected">Expected&lt;Function &#42;&gt;</a> OpenMPIRBuilder::emitInterWarpCopyFunction(</Highlight></CodeLine>
<Link id="l02623" /><CodeLine lineNumber="2623"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos,</Highlight></CodeLine>
<Link id="l02624" /><CodeLine lineNumber="2624"><Highlight kind="normal">    AttributeList FuncAttrs) &#123;</Highlight></CodeLine>
<Link id="l02625" /><CodeLine lineNumber="2625"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> SavedIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l02626" /><CodeLine lineNumber="2626"><Highlight kind="normal">  LLVMContext &amp;Ctx = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l02627" /><CodeLine lineNumber="2627"><Highlight kind="normal">  FunctionType &#42;FuncTy = <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(</Highlight></CodeLine>
<Link id="l02628" /><CodeLine lineNumber="2628"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(), &#123;Builder.getPtrTy(), Builder.getInt32Ty()&#125;,</Highlight></CodeLine>
<Link id="l02629" /><CodeLine lineNumber="2629"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02630" /><CodeLine lineNumber="2630"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;WcFunc =</Highlight></CodeLine>
<Link id="l02631" /><CodeLine lineNumber="2631"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l02632" /><CodeLine lineNumber="2632"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;&#95;omp&#95;reduction&#95;inter&#95;warp&#95;copy&#95;func&quot;</Highlight><Highlight kind="normal">, &amp;M);</Highlight></CodeLine>
<Link id="l02633" /><CodeLine lineNumber="2633"><Highlight kind="normal">  WcFunc-&gt;<a href="/docs/api/classes/llvm/function/#a9e4c6c67f4b2528b5648299db4a86926">setAttributes</a>(FuncAttrs);</Highlight></CodeLine>
<Link id="l02634" /><CodeLine lineNumber="2634"><Highlight kind="normal">  WcFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l02635" /><CodeLine lineNumber="2635"><Highlight kind="normal">  WcFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l02636" /><CodeLine lineNumber="2636"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, WcFunc);</Highlight></CodeLine>
<Link id="l02637" /><CodeLine lineNumber="2637"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBB);</Highlight></CodeLine>
<Link id="l02638" /><CodeLine lineNumber="2638"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02639" /><CodeLine lineNumber="2639"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ReduceList: thread local Reduce list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02640" /><CodeLine lineNumber="2640"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// At the stage of the computation when this function is called, partially</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02641" /><CodeLine lineNumber="2641"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// aggregated values reside in the first lane of every active warp.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02642" /><CodeLine lineNumber="2642"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;ReduceListArg = WcFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l02643" /><CodeLine lineNumber="2643"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// NumWarps: number of warps active in the parallel region.  This could</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02644" /><CodeLine lineNumber="2644"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// be smaller than 32 (max warps in a CTA) for partial block reduction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02645" /><CodeLine lineNumber="2645"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;NumWarpsArg = WcFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l02646" /><CodeLine lineNumber="2646"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02647" /><CodeLine lineNumber="2647"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This array is used as a medium to transfer, one reduce element at a time,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02648" /><CodeLine lineNumber="2648"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the data from the first lane of every warp to lanes in the first warp</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02649" /><CodeLine lineNumber="2649"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// in order to perform the final step of a reduction in a parallel region</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02650" /><CodeLine lineNumber="2650"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// (reduction across warps).  The array is placed in NVPTX &#95;&#95;shared&#95;&#95; memory</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02651" /><CodeLine lineNumber="2651"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// for reduced latency, as well as to have a distinct copy for concurrently</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02652" /><CodeLine lineNumber="2652"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// executing target regions.  The array is declared with common linkage so</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02653" /><CodeLine lineNumber="2653"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// as to be shared across compilation units.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02654" /><CodeLine lineNumber="2654"><Highlight kind="normal">  StringRef TransferMediumName =</Highlight></CodeLine>
<Link id="l02655" /><CodeLine lineNumber="2655"><Highlight kind="normal">      </Highlight><Highlight kind="stringliteral">&quot;&#95;&#95;openmp&#95;nvptx&#95;data&#95;transfer&#95;temporary&#95;storage&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02656" /><CodeLine lineNumber="2656"><Highlight kind="normal">  GlobalVariable &#42;TransferMedium = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getGlobalVariable(TransferMediumName);</Highlight></CodeLine>
<Link id="l02657" /><CodeLine lineNumber="2657"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> WarpSize = Config.getGridValue().GV&#95;Warp&#95;Size;</Highlight></CodeLine>
<Link id="l02658" /><CodeLine lineNumber="2658"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bacb17ff5177bb277ed8dd79480aad9c27">ArrayType</a> &#42;ArrayTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), WarpSize);</Highlight></CodeLine>
<Link id="l02659" /><CodeLine lineNumber="2659"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!TransferMedium) &#123;</Highlight></CodeLine>
<Link id="l02660" /><CodeLine lineNumber="2660"><Highlight kind="normal">    TransferMedium = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> GlobalVariable(</Highlight></CodeLine>
<Link id="l02661" /><CodeLine lineNumber="2661"><Highlight kind="normal">        M, ArrayTy, </Highlight><Highlight kind="comment">/&#42;isConstant=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f">GlobalVariable::WeakAnyLinkage</a>,</Highlight></CodeLine>
<Link id="l02662" /><CodeLine lineNumber="2662"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/undefvalue/#a4ae5ff22b700a42bcc5d889233721335">UndefValue::get</a>(ArrayTy), TransferMediumName,</Highlight></CodeLine>
<Link id="l02663" /><CodeLine lineNumber="2663"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;InsertBefore=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0">GlobalVariable::NotThreadLocal</a>,</Highlight></CodeLine>
<Link id="l02664" /><CodeLine lineNumber="2664"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;AddressSpace=&#42;/</Highlight><Highlight kind="normal">3);</Highlight></CodeLine>
<Link id="l02665" /><CodeLine lineNumber="2665"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02666" /><CodeLine lineNumber="2666"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02667" /><CodeLine lineNumber="2667"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Get the CUDA thread id of the current OpenMP thread on the GPU.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02668" /><CodeLine lineNumber="2668"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;GPUThreadID = getGPUThreadID();</Highlight></CodeLine>
<Link id="l02669" /><CodeLine lineNumber="2669"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// nvptx&#95;lane&#95;id = nvptx&#95;id % warpsize</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02670" /><CodeLine lineNumber="2670"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LaneID = getNVPTXLaneID();</Highlight></CodeLine>
<Link id="l02671" /><CodeLine lineNumber="2671"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// nvptx&#95;warp&#95;id = nvptx&#95;id / warpsize</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02672" /><CodeLine lineNumber="2672"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;WarpID = getNVPTXWarpID();</Highlight></CodeLine>
<Link id="l02673" /><CodeLine lineNumber="2673"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02674" /><CodeLine lineNumber="2674"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP =</Highlight></CodeLine>
<Link id="l02675" /><CodeLine lineNumber="2675"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>(),</Highlight></CodeLine>
<Link id="l02676" /><CodeLine lineNumber="2676"><Highlight kind="normal">                    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l02677" /><CodeLine lineNumber="2677"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;Arg0Type = ReduceListArg-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l02678" /><CodeLine lineNumber="2678"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;Arg1Type = NumWarpsArg-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l02679" /><CodeLine lineNumber="2679"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l02680" /><CodeLine lineNumber="2680"><Highlight kind="normal">  AllocaInst &#42;ReduceListAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l02681" /><CodeLine lineNumber="2681"><Highlight kind="normal">      Arg0Type, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, ReduceListArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02682" /><CodeLine lineNumber="2682"><Highlight kind="normal">  AllocaInst &#42;NumWarpsAlloca =</Highlight></CodeLine>
<Link id="l02683" /><CodeLine lineNumber="2683"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Arg1Type, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, NumWarpsArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02684" /><CodeLine lineNumber="2684"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02685" /><CodeLine lineNumber="2685"><Highlight kind="normal">      ReduceListAlloca, Arg0Type, ReduceListAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02686" /><CodeLine lineNumber="2686"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;NumWarpsAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02687" /><CodeLine lineNumber="2687"><Highlight kind="normal">      NumWarpsAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(0),</Highlight></CodeLine>
<Link id="l02688" /><CodeLine lineNumber="2688"><Highlight kind="normal">      NumWarpsAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02689" /><CodeLine lineNumber="2689"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(ReduceListArg, ReduceListAddrCast);</Highlight></CodeLine>
<Link id="l02690" /><CodeLine lineNumber="2690"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(NumWarpsArg, NumWarpsAddrCast);</Highlight></CodeLine>
<Link id="l02691" /><CodeLine lineNumber="2691"><Highlight kind="normal">  AllocaIP = <a href="#ab5fa59567e3acc860411770354a1603a">getInsertPointAfterInstr</a>(NumWarpsAlloca);</Highlight></CodeLine>
<Link id="l02692" /><CodeLine lineNumber="2692"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP =</Highlight></CodeLine>
<Link id="l02693" /><CodeLine lineNumber="2693"><Highlight kind="normal">      <a href="#ab5fa59567e3acc860411770354a1603a">getInsertPointAfterInstr</a>(&amp;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a2d071e661a02790177ba05f62c7c27d1">back</a>());</Highlight></CodeLine>
<Link id="l02694" /><CodeLine lineNumber="2694"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l02695" /><CodeLine lineNumber="2695"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02696" /><CodeLine lineNumber="2696"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceList =</Highlight></CodeLine>
<Link id="l02697" /><CodeLine lineNumber="2697"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReduceListAddrCast);</Highlight></CodeLine>
<Link id="l02698" /><CodeLine lineNumber="2698"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02699" /><CodeLine lineNumber="2699"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l02700" /><CodeLine lineNumber="2700"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02701" /><CodeLine lineNumber="2701"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Warp master copies reduce element to transfer medium in &#95;&#95;shared&#95;&#95;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02702" /><CodeLine lineNumber="2702"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// memory.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02703" /><CodeLine lineNumber="2703"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02704" /><CodeLine lineNumber="2704"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l02705" /><CodeLine lineNumber="2705"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> RealTySize = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeAllocSize(RI.ElementType);</Highlight></CodeLine>
<Link id="l02706" /><CodeLine lineNumber="2706"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> TySize = 4; TySize &gt; 0 &amp;&amp; RealTySize &gt; 0; TySize /= 2) &#123;</Highlight></CodeLine>
<Link id="l02707" /><CodeLine lineNumber="2707"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;CType = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a31e2db8d1b315202d2c19e711b5365fd">getIntNTy</a>(TySize &#42; 8);</Highlight></CodeLine>
<Link id="l02708" /><CodeLine lineNumber="2708"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02709" /><CodeLine lineNumber="2709"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumIters = RealTySize / TySize;</Highlight></CodeLine>
<Link id="l02710" /><CodeLine lineNumber="2710"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumIters == 0)</Highlight></CodeLine>
<Link id="l02711" /><CodeLine lineNumber="2711"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02712" /><CodeLine lineNumber="2712"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Cnt = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02713" /><CodeLine lineNumber="2713"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CntAddr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02714" /><CodeLine lineNumber="2714"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;PrecondBB = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02715" /><CodeLine lineNumber="2715"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ExitBB = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02716" /><CodeLine lineNumber="2716"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumIters &gt; 1) &#123;</Highlight></CodeLine>
<Link id="l02717" /><CodeLine lineNumber="2717"><Highlight kind="normal">        CodeGenIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l02718" /><CodeLine lineNumber="2718"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l02719" /><CodeLine lineNumber="2719"><Highlight kind="normal">        CntAddr =</Highlight></CodeLine>
<Link id="l02720" /><CodeLine lineNumber="2720"><Highlight kind="normal">            Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.cnt.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02721" /><CodeLine lineNumber="2721"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02722" /><CodeLine lineNumber="2722"><Highlight kind="normal">        CntAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aeb6ccc122c2f6868fc3a1e68e1ae157c">CreateAddrSpaceCast</a>(CntAddr, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l02723" /><CodeLine lineNumber="2723"><Highlight kind="normal">                                              CntAddr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02724" /><CodeLine lineNumber="2724"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l02725" /><CodeLine lineNumber="2725"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(<a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>()),</Highlight></CodeLine>
<Link id="l02726" /><CodeLine lineNumber="2726"><Highlight kind="normal">                            CntAddr,</Highlight></CodeLine>
<Link id="l02727" /><CodeLine lineNumber="2727"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42;Volatile=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02728" /><CodeLine lineNumber="2728"><Highlight kind="normal">        PrecondBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;precond&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02729" /><CodeLine lineNumber="2729"><Highlight kind="normal">        ExitBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02730" /><CodeLine lineNumber="2730"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;BodyBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;body&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02731" /><CodeLine lineNumber="2731"><Highlight kind="normal">        emitBlock(PrecondBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02732" /><CodeLine lineNumber="2732"><Highlight kind="normal">        Cnt = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), CntAddr,</Highlight></CodeLine>
<Link id="l02733" /><CodeLine lineNumber="2733"><Highlight kind="normal">                                 </Highlight><Highlight kind="comment">/&#42;Volatile=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02734" /><CodeLine lineNumber="2734"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a09b4daefdf5b73efba51ce7ae6cd45c5">CreateICmpULT</a>(</Highlight></CodeLine>
<Link id="l02735" /><CodeLine lineNumber="2735"><Highlight kind="normal">            Cnt, ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), NumIters));</Highlight></CodeLine>
<Link id="l02736" /><CodeLine lineNumber="2736"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(Cmp, BodyBB, ExitBB);</Highlight></CodeLine>
<Link id="l02737" /><CodeLine lineNumber="2737"><Highlight kind="normal">        emitBlock(BodyBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02738" /><CodeLine lineNumber="2738"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02739" /><CodeLine lineNumber="2739"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02740" /><CodeLine lineNumber="2740"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// kmpc&#95;barrier.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02741" /><CodeLine lineNumber="2741"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> BarrierIP1 =</Highlight></CodeLine>
<Link id="l02742" /><CodeLine lineNumber="2742"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07">createBarrier</a>(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), Loc.DL),</Highlight></CodeLine>
<Link id="l02743" /><CodeLine lineNumber="2743"><Highlight kind="normal">                        omp::Directive::OMPD&#95;unknown,</Highlight></CodeLine>
<Link id="l02744" /><CodeLine lineNumber="2744"><Highlight kind="normal">                        </Highlight><Highlight kind="comment">/&#42; ForceSimpleCall &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02745" /><CodeLine lineNumber="2745"><Highlight kind="normal">                        </Highlight><Highlight kind="comment">/&#42; CheckCancelFlag &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02746" /><CodeLine lineNumber="2746"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!BarrierIP1)</Highlight></CodeLine>
<Link id="l02747" /><CodeLine lineNumber="2747"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> BarrierIP1.takeError();</Highlight></CodeLine>
<Link id="l02748" /><CodeLine lineNumber="2748"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ThenBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;then&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02749" /><CodeLine lineNumber="2749"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ElseBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;else&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02750" /><CodeLine lineNumber="2750"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;MergeBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;ifcont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02751" /><CodeLine lineNumber="2751"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02752" /><CodeLine lineNumber="2752"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// if (lane&#95;id  == 0)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02753" /><CodeLine lineNumber="2753"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IsWarpMaster = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac9843b4f9f9cb144c608c48785a394a8">CreateIsNull</a>(LaneID, </Highlight><Highlight kind="stringliteral">&quot;warp&#95;master&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02754" /><CodeLine lineNumber="2754"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(IsWarpMaster, ThenBB, ElseBB);</Highlight></CodeLine>
<Link id="l02755" /><CodeLine lineNumber="2755"><Highlight kind="normal">      emitBlock(ThenBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02756" /><CodeLine lineNumber="2756"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02757" /><CodeLine lineNumber="2757"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Reduce element = LocalReduceList&#91;i&#93;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02758" /><CodeLine lineNumber="2758"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;RedListArrayTy =</Highlight></CodeLine>
<Link id="l02759" /><CodeLine lineNumber="2759"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l02760" /><CodeLine lineNumber="2760"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l02761" /><CodeLine lineNumber="2761"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l02762" /><CodeLine lineNumber="2762"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemPtrPtr =</Highlight></CodeLine>
<Link id="l02763" /><CodeLine lineNumber="2763"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(RedListArrayTy, ReduceList,</Highlight></CodeLine>
<Link id="l02764" /><CodeLine lineNumber="2764"><Highlight kind="normal">                                    &#123;ConstantInt::get(IndexTy, 0),</Highlight></CodeLine>
<Link id="l02765" /><CodeLine lineNumber="2765"><Highlight kind="normal">                                     ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l02766" /><CodeLine lineNumber="2766"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// elemptr = ((CopyType&#42;)(elemptrptr)) + I</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02767" /><CodeLine lineNumber="2767"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ElemPtrPtr);</Highlight></CodeLine>
<Link id="l02768" /><CodeLine lineNumber="2768"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumIters &gt; 1)</Highlight></CodeLine>
<Link id="l02769" /><CodeLine lineNumber="2769"><Highlight kind="normal">        ElemPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), ElemPtr, Cnt);</Highlight></CodeLine>
<Link id="l02770" /><CodeLine lineNumber="2770"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02771" /><CodeLine lineNumber="2771"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Get pointer to location in transfer medium.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02772" /><CodeLine lineNumber="2772"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// MediumPtr = &amp;medium&#91;warp&#95;id&#93;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02773" /><CodeLine lineNumber="2773"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MediumPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l02774" /><CodeLine lineNumber="2774"><Highlight kind="normal">          ArrayTy, TransferMedium, &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(0), WarpID&#125;);</Highlight></CodeLine>
<Link id="l02775" /><CodeLine lineNumber="2775"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// elem = &#42;elemptr</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02776" /><CodeLine lineNumber="2776"><Highlight kind="normal">      </Highlight><Highlight kind="comment">//&#42;MediumPtr = elem</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02777" /><CodeLine lineNumber="2777"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Elem = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(CType, ElemPtr);</Highlight></CodeLine>
<Link id="l02778" /><CodeLine lineNumber="2778"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Store the source element value to the dest element address.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02779" /><CodeLine lineNumber="2779"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Elem, MediumPtr,</Highlight></CodeLine>
<Link id="l02780" /><CodeLine lineNumber="2780"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42;IsVolatile&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02781" /><CodeLine lineNumber="2781"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(MergeBB);</Highlight></CodeLine>
<Link id="l02782" /><CodeLine lineNumber="2782"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02783" /><CodeLine lineNumber="2783"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02784" /><CodeLine lineNumber="2784"><Highlight kind="normal">      emitBlock(ElseBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02785" /><CodeLine lineNumber="2785"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(MergeBB);</Highlight></CodeLine>
<Link id="l02786" /><CodeLine lineNumber="2786"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02787" /><CodeLine lineNumber="2787"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02788" /><CodeLine lineNumber="2788"><Highlight kind="normal">      emitBlock(MergeBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02789" /><CodeLine lineNumber="2789"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> BarrierIP2 =</Highlight></CodeLine>
<Link id="l02790" /><CodeLine lineNumber="2790"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07">createBarrier</a>(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), Loc.DL),</Highlight></CodeLine>
<Link id="l02791" /><CodeLine lineNumber="2791"><Highlight kind="normal">                        omp::Directive::OMPD&#95;unknown,</Highlight></CodeLine>
<Link id="l02792" /><CodeLine lineNumber="2792"><Highlight kind="normal">                        </Highlight><Highlight kind="comment">/&#42; ForceSimpleCall &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02793" /><CodeLine lineNumber="2793"><Highlight kind="normal">                        </Highlight><Highlight kind="comment">/&#42; CheckCancelFlag &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02794" /><CodeLine lineNumber="2794"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!BarrierIP2)</Highlight></CodeLine>
<Link id="l02795" /><CodeLine lineNumber="2795"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> BarrierIP2.takeError();</Highlight></CodeLine>
<Link id="l02796" /><CodeLine lineNumber="2796"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02797" /><CodeLine lineNumber="2797"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Warp 0 copies reduce element from transfer medium</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02798" /><CodeLine lineNumber="2798"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;W0ThenBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;then&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02799" /><CodeLine lineNumber="2799"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;W0ElseBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;else&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02800" /><CodeLine lineNumber="2800"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;W0MergeBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;ifcont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02801" /><CodeLine lineNumber="2801"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02802" /><CodeLine lineNumber="2802"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;NumWarpsVal =</Highlight></CodeLine>
<Link id="l02803" /><CodeLine lineNumber="2803"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), NumWarpsAddrCast);</Highlight></CodeLine>
<Link id="l02804" /><CodeLine lineNumber="2804"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Up to 32 threads in warp 0 are active.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02805" /><CodeLine lineNumber="2805"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IsActiveThread =</Highlight></CodeLine>
<Link id="l02806" /><CodeLine lineNumber="2806"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a09b4daefdf5b73efba51ce7ae6cd45c5">CreateICmpULT</a>(GPUThreadID, NumWarpsVal, </Highlight><Highlight kind="stringliteral">&quot;is&#95;active&#95;thread&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02807" /><CodeLine lineNumber="2807"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(IsActiveThread, W0ThenBB, W0ElseBB);</Highlight></CodeLine>
<Link id="l02808" /><CodeLine lineNumber="2808"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02809" /><CodeLine lineNumber="2809"><Highlight kind="normal">      emitBlock(W0ThenBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02810" /><CodeLine lineNumber="2810"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02811" /><CodeLine lineNumber="2811"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// SecMediumPtr = &amp;medium&#91;tid&#93;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02812" /><CodeLine lineNumber="2812"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// SrcMediumVal = &#42;SrcMediumPtr</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02813" /><CodeLine lineNumber="2813"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcMediumPtrVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l02814" /><CodeLine lineNumber="2814"><Highlight kind="normal">          ArrayTy, TransferMedium, &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(0), GPUThreadID&#125;);</Highlight></CodeLine>
<Link id="l02815" /><CodeLine lineNumber="2815"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// TargetElemPtr = (CopyType&#42;)(SrcDataAddr&#91;i&#93;) + I</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02816" /><CodeLine lineNumber="2816"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TargetElemPtrPtr =</Highlight></CodeLine>
<Link id="l02817" /><CodeLine lineNumber="2817"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(RedListArrayTy, ReduceList,</Highlight></CodeLine>
<Link id="l02818" /><CodeLine lineNumber="2818"><Highlight kind="normal">                                    &#123;ConstantInt::get(IndexTy, 0),</Highlight></CodeLine>
<Link id="l02819" /><CodeLine lineNumber="2819"><Highlight kind="normal">                                     ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l02820" /><CodeLine lineNumber="2820"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TargetElemPtrVal =</Highlight></CodeLine>
<Link id="l02821" /><CodeLine lineNumber="2821"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), TargetElemPtrPtr);</Highlight></CodeLine>
<Link id="l02822" /><CodeLine lineNumber="2822"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TargetElemPtr = TargetElemPtrVal;</Highlight></CodeLine>
<Link id="l02823" /><CodeLine lineNumber="2823"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumIters &gt; 1)</Highlight></CodeLine>
<Link id="l02824" /><CodeLine lineNumber="2824"><Highlight kind="normal">        TargetElemPtr =</Highlight></CodeLine>
<Link id="l02825" /><CodeLine lineNumber="2825"><Highlight kind="normal">            Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), TargetElemPtr, Cnt);</Highlight></CodeLine>
<Link id="l02826" /><CodeLine lineNumber="2826"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02827" /><CodeLine lineNumber="2827"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// &#42;TargetElemPtr = SrcMediumVal;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02828" /><CodeLine lineNumber="2828"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcMediumValue =</Highlight></CodeLine>
<Link id="l02829" /><CodeLine lineNumber="2829"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(CType, SrcMediumPtrVal, </Highlight><Highlight kind="comment">/&#42;IsVolatile&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02830" /><CodeLine lineNumber="2830"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(SrcMediumValue, TargetElemPtr);</Highlight></CodeLine>
<Link id="l02831" /><CodeLine lineNumber="2831"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(W0MergeBB);</Highlight></CodeLine>
<Link id="l02832" /><CodeLine lineNumber="2832"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02833" /><CodeLine lineNumber="2833"><Highlight kind="normal">      emitBlock(W0ElseBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02834" /><CodeLine lineNumber="2834"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(W0MergeBB);</Highlight></CodeLine>
<Link id="l02835" /><CodeLine lineNumber="2835"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02836" /><CodeLine lineNumber="2836"><Highlight kind="normal">      emitBlock(W0MergeBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02837" /><CodeLine lineNumber="2837"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02838" /><CodeLine lineNumber="2838"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumIters &gt; 1) &#123;</Highlight></CodeLine>
<Link id="l02839" /><CodeLine lineNumber="2839"><Highlight kind="normal">        Cnt = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5d708ffeb74e4eb145b9dca1bfd5627f">CreateNSWAdd</a>(</Highlight></CodeLine>
<Link id="l02840" /><CodeLine lineNumber="2840"><Highlight kind="normal">            Cnt, ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), </Highlight><Highlight kind="comment">/&#42;V=&#42;/</Highlight><Highlight kind="normal">1));</Highlight></CodeLine>
<Link id="l02841" /><CodeLine lineNumber="2841"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Cnt, CntAddr, </Highlight><Highlight kind="comment">/&#42;Volatile=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02842" /><CodeLine lineNumber="2842"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02843" /><CodeLine lineNumber="2843"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CurFn = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l02844" /><CodeLine lineNumber="2844"><Highlight kind="normal">        emitBranch(PrecondBB);</Highlight></CodeLine>
<Link id="l02845" /><CodeLine lineNumber="2845"><Highlight kind="normal">        emitBlock(ExitBB, CurFn);</Highlight></CodeLine>
<Link id="l02846" /><CodeLine lineNumber="2846"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02847" /><CodeLine lineNumber="2847"><Highlight kind="normal">      RealTySize %= TySize;</Highlight></CodeLine>
<Link id="l02848" /><CodeLine lineNumber="2848"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02849" /><CodeLine lineNumber="2849"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02850" /><CodeLine lineNumber="2850"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02851" /><CodeLine lineNumber="2851"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l02852" /><CodeLine lineNumber="2852"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(SavedIP);</Highlight></CodeLine>
<Link id="l02853" /><CodeLine lineNumber="2853"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02854" /><CodeLine lineNumber="2854"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> WcFunc;</Highlight></CodeLine>
<Link id="l02855" /><CodeLine lineNumber="2855"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02856" /><CodeLine lineNumber="2856"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02857" /><CodeLine lineNumber="2857"><Highlight kind="normal"><a href="/docs/api/classes/llvm/function">Function</a> &#42;OpenMPIRBuilder::emitShuffleAndReduceFunction(</Highlight></CodeLine>
<Link id="l02858" /><CodeLine lineNumber="2858"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos, <a href="/docs/api/classes/llvm/function">Function</a> &#42;ReduceFn,</Highlight></CodeLine>
<Link id="l02859" /><CodeLine lineNumber="2859"><Highlight kind="normal">    AttributeList FuncAttrs) &#123;</Highlight></CodeLine>
<Link id="l02860" /><CodeLine lineNumber="2860"><Highlight kind="normal">  LLVMContext &amp;Ctx = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l02861" /><CodeLine lineNumber="2861"><Highlight kind="normal">  FunctionType &#42;FuncTy =</Highlight></CodeLine>
<Link id="l02862" /><CodeLine lineNumber="2862"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(),</Highlight></CodeLine>
<Link id="l02863" /><CodeLine lineNumber="2863"><Highlight kind="normal">                        &#123;Builder.getPtrTy(), Builder.getInt16Ty(),</Highlight></CodeLine>
<Link id="l02864" /><CodeLine lineNumber="2864"><Highlight kind="normal">                         Builder.getInt16Ty(), Builder.getInt16Ty()&#125;,</Highlight></CodeLine>
<Link id="l02865" /><CodeLine lineNumber="2865"><Highlight kind="normal">                        </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02866" /><CodeLine lineNumber="2866"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;SarFunc =</Highlight></CodeLine>
<Link id="l02867" /><CodeLine lineNumber="2867"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l02868" /><CodeLine lineNumber="2868"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;&#95;omp&#95;reduction&#95;shuffle&#95;and&#95;reduce&#95;func&quot;</Highlight><Highlight kind="normal">, &amp;M);</Highlight></CodeLine>
<Link id="l02869" /><CodeLine lineNumber="2869"><Highlight kind="normal">  SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#a9e4c6c67f4b2528b5648299db4a86926">setAttributes</a>(FuncAttrs);</Highlight></CodeLine>
<Link id="l02870" /><CodeLine lineNumber="2870"><Highlight kind="normal">  SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l02871" /><CodeLine lineNumber="2871"><Highlight kind="normal">  SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l02872" /><CodeLine lineNumber="2872"><Highlight kind="normal">  SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(2, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l02873" /><CodeLine lineNumber="2873"><Highlight kind="normal">  SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(3, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l02874" /><CodeLine lineNumber="2874"><Highlight kind="normal">  SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::SExt);</Highlight></CodeLine>
<Link id="l02875" /><CodeLine lineNumber="2875"><Highlight kind="normal">  SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(2, Attribute::SExt);</Highlight></CodeLine>
<Link id="l02876" /><CodeLine lineNumber="2876"><Highlight kind="normal">  SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(3, Attribute::SExt);</Highlight></CodeLine>
<Link id="l02877" /><CodeLine lineNumber="2877"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, SarFunc);</Highlight></CodeLine>
<Link id="l02878" /><CodeLine lineNumber="2878"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBB);</Highlight></CodeLine>
<Link id="l02879" /><CodeLine lineNumber="2879"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02880" /><CodeLine lineNumber="2880"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Thread local Reduce list used to host the values of data to be reduced.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02881" /><CodeLine lineNumber="2881"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;ReduceListArg = SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l02882" /><CodeLine lineNumber="2882"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Current lane id; could be logical.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02883" /><CodeLine lineNumber="2883"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;LaneIDArg = SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l02884" /><CodeLine lineNumber="2884"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Offset of the remote source lane relative to the current lane.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02885" /><CodeLine lineNumber="2885"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;RemoteLaneOffsetArg = SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(2);</Highlight></CodeLine>
<Link id="l02886" /><CodeLine lineNumber="2886"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Algorithm version.  This is expected to be known at compile time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02887" /><CodeLine lineNumber="2887"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;AlgoVerArg = SarFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(3);</Highlight></CodeLine>
<Link id="l02888" /><CodeLine lineNumber="2888"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02889" /><CodeLine lineNumber="2889"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;ReduceListArgType = ReduceListArg-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l02890" /><CodeLine lineNumber="2890"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;LaneIDArgType = LaneIDArg-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l02891" /><CodeLine lineNumber="2891"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;LaneIDArgPtrType = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(0);</Highlight></CodeLine>
<Link id="l02892" /><CodeLine lineNumber="2892"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l02893" /><CodeLine lineNumber="2893"><Highlight kind="normal">      ReduceListArgType, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, ReduceListArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02894" /><CodeLine lineNumber="2894"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LaneIdAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(LaneIDArgType, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02895" /><CodeLine lineNumber="2895"><Highlight kind="normal">                                             LaneIDArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02896" /><CodeLine lineNumber="2896"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RemoteLaneOffsetAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l02897" /><CodeLine lineNumber="2897"><Highlight kind="normal">      LaneIDArgType, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, RemoteLaneOffsetArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02898" /><CodeLine lineNumber="2898"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;AlgoVerAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(LaneIDArgType, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02899" /><CodeLine lineNumber="2899"><Highlight kind="normal">                                              AlgoVerArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02900" /><CodeLine lineNumber="2900"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bacb17ff5177bb277ed8dd79480aad9c27">ArrayType</a> &#42;RedListArrayTy =</Highlight></CodeLine>
<Link id="l02901" /><CodeLine lineNumber="2901"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l02902" /><CodeLine lineNumber="2902"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02903" /><CodeLine lineNumber="2903"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create a local thread-private variable to host the Reduce list</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02904" /><CodeLine lineNumber="2904"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// from a remote lane.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02905" /><CodeLine lineNumber="2905"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;RemoteReductionListAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l02906" /><CodeLine lineNumber="2906"><Highlight kind="normal">      RedListArrayTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.omp.reduction.remote&#95;reduce&#95;list&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02907" /><CodeLine lineNumber="2907"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02908" /><CodeLine lineNumber="2908"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02909" /><CodeLine lineNumber="2909"><Highlight kind="normal">      ReduceListAlloca, ReduceListArgType,</Highlight></CodeLine>
<Link id="l02910" /><CodeLine lineNumber="2910"><Highlight kind="normal">      ReduceListAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02911" /><CodeLine lineNumber="2911"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LaneIdAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02912" /><CodeLine lineNumber="2912"><Highlight kind="normal">      LaneIdAlloca, LaneIDArgPtrType, LaneIdAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02913" /><CodeLine lineNumber="2913"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RemoteLaneOffsetAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02914" /><CodeLine lineNumber="2914"><Highlight kind="normal">      RemoteLaneOffsetAlloca, LaneIDArgPtrType,</Highlight></CodeLine>
<Link id="l02915" /><CodeLine lineNumber="2915"><Highlight kind="normal">      RemoteLaneOffsetAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02916" /><CodeLine lineNumber="2916"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;AlgoVerAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02917" /><CodeLine lineNumber="2917"><Highlight kind="normal">      AlgoVerAlloca, LaneIDArgPtrType, AlgoVerAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02918" /><CodeLine lineNumber="2918"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RemoteListAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02919" /><CodeLine lineNumber="2919"><Highlight kind="normal">      RemoteReductionListAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l02920" /><CodeLine lineNumber="2920"><Highlight kind="normal">      RemoteReductionListAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02921" /><CodeLine lineNumber="2921"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02922" /><CodeLine lineNumber="2922"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(ReduceListArg, ReduceListAddrCast);</Highlight></CodeLine>
<Link id="l02923" /><CodeLine lineNumber="2923"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(LaneIDArg, LaneIdAddrCast);</Highlight></CodeLine>
<Link id="l02924" /><CodeLine lineNumber="2924"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(RemoteLaneOffsetArg, RemoteLaneOffsetAddrCast);</Highlight></CodeLine>
<Link id="l02925" /><CodeLine lineNumber="2925"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(AlgoVerArg, AlgoVerAddrCast);</Highlight></CodeLine>
<Link id="l02926" /><CodeLine lineNumber="2926"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02927" /><CodeLine lineNumber="2927"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceList = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(ReduceListArgType, ReduceListAddrCast);</Highlight></CodeLine>
<Link id="l02928" /><CodeLine lineNumber="2928"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LaneId = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(LaneIDArgType, LaneIdAddrCast);</Highlight></CodeLine>
<Link id="l02929" /><CodeLine lineNumber="2929"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RemoteLaneOffset =</Highlight></CodeLine>
<Link id="l02930" /><CodeLine lineNumber="2930"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(LaneIDArgType, RemoteLaneOffsetAddrCast);</Highlight></CodeLine>
<Link id="l02931" /><CodeLine lineNumber="2931"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;AlgoVer = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(LaneIDArgType, AlgoVerAddrCast);</Highlight></CodeLine>
<Link id="l02932" /><CodeLine lineNumber="2932"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02933" /><CodeLine lineNumber="2933"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP = <a href="#ab5fa59567e3acc860411770354a1603a">getInsertPointAfterInstr</a>(RemoteReductionListAlloca);</Highlight></CodeLine>
<Link id="l02934" /><CodeLine lineNumber="2934"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02935" /><CodeLine lineNumber="2935"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This loop iterates through the list of reduce elements and copies,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02936" /><CodeLine lineNumber="2936"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// element by element, from a remote lane in the warp to RemoteReduceList,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02937" /><CodeLine lineNumber="2937"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// hosted on the thread&#39;s stack.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02938" /><CodeLine lineNumber="2938"><Highlight kind="normal">  emitReductionListCopy(</Highlight></CodeLine>
<Link id="l02939" /><CodeLine lineNumber="2939"><Highlight kind="normal">      AllocaIP, CopyAction::RemoteLaneToThread, RedListArrayTy, ReductionInfos,</Highlight></CodeLine>
<Link id="l02940" /><CodeLine lineNumber="2940"><Highlight kind="normal">      ReduceList, RemoteListAddrCast, &#123;RemoteLaneOffset, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">&#125;);</Highlight></CodeLine>
<Link id="l02941" /><CodeLine lineNumber="2941"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02942" /><CodeLine lineNumber="2942"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The actions to be performed on the Remote Reduce list is dependent</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02943" /><CodeLine lineNumber="2943"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// on the algorithm version.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02944" /><CodeLine lineNumber="2944"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02945" /><CodeLine lineNumber="2945"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  if (AlgoVer==0) || (AlgoVer==1 &amp;&amp; (LaneId &lt; Offset)) || (AlgoVer==2 &amp;&amp;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02946" /><CodeLine lineNumber="2946"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  LaneId % 2 == 0 &amp;&amp; Offset &gt; 0):</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02947" /><CodeLine lineNumber="2947"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    do the reduction value aggregation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02948" /><CodeLine lineNumber="2948"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02949" /><CodeLine lineNumber="2949"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  The thread local variable Reduce list is mutated in place to host the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02950" /><CodeLine lineNumber="2950"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  reduced data, which is the aggregated value produced from local and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02951" /><CodeLine lineNumber="2951"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  remote lanes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02952" /><CodeLine lineNumber="2952"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02953" /><CodeLine lineNumber="2953"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  Note that AlgoVer is expected to be a constant integer known at compile</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02954" /><CodeLine lineNumber="2954"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02955" /><CodeLine lineNumber="2955"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  When AlgoVer==0, the first conjunction evaluates to true, making</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02956" /><CodeLine lineNumber="2956"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    the entire predicate true during compile time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02957" /><CodeLine lineNumber="2957"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  When AlgoVer==1, the second conjunction has only the second part to be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02958" /><CodeLine lineNumber="2958"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    evaluated during runtime.  Other conjunctions evaluates to false</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02959" /><CodeLine lineNumber="2959"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    during compile time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02960" /><CodeLine lineNumber="2960"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  When AlgoVer==2, the third conjunction has only the second part to be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02961" /><CodeLine lineNumber="2961"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    evaluated during runtime.  Other conjunctions evaluates to false</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02962" /><CodeLine lineNumber="2962"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    during compile time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02963" /><CodeLine lineNumber="2963"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CondAlgo0 = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac9843b4f9f9cb144c608c48785a394a8">CreateIsNull</a>(AlgoVer);</Highlight></CodeLine>
<Link id="l02964" /><CodeLine lineNumber="2964"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Algo1 = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(AlgoVer, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac33b7f085ea15691aa45a61ef207d603">getInt16</a>(1));</Highlight></CodeLine>
<Link id="l02965" /><CodeLine lineNumber="2965"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LaneComp = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a09b4daefdf5b73efba51ce7ae6cd45c5">CreateICmpULT</a>(LaneId, RemoteLaneOffset);</Highlight></CodeLine>
<Link id="l02966" /><CodeLine lineNumber="2966"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CondAlgo1 = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(Algo1, LaneComp);</Highlight></CodeLine>
<Link id="l02967" /><CodeLine lineNumber="2967"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Algo2 = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(AlgoVer, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac33b7f085ea15691aa45a61ef207d603">getInt16</a>(2));</Highlight></CodeLine>
<Link id="l02968" /><CodeLine lineNumber="2968"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LaneIdAnd1 = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(LaneId, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac33b7f085ea15691aa45a61ef207d603">getInt16</a>(1));</Highlight></CodeLine>
<Link id="l02969" /><CodeLine lineNumber="2969"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LaneIdComp = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac9843b4f9f9cb144c608c48785a394a8">CreateIsNull</a>(LaneIdAnd1);</Highlight></CodeLine>
<Link id="l02970" /><CodeLine lineNumber="2970"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Algo2AndLaneIdComp = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(Algo2, LaneIdComp);</Highlight></CodeLine>
<Link id="l02971" /><CodeLine lineNumber="2971"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RemoteOffsetComp =</Highlight></CodeLine>
<Link id="l02972" /><CodeLine lineNumber="2972"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a3280551f1232a760cb7b21e85fdd5eca">CreateICmpSGT</a>(RemoteLaneOffset, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac33b7f085ea15691aa45a61ef207d603">getInt16</a>(0));</Highlight></CodeLine>
<Link id="l02973" /><CodeLine lineNumber="2973"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CondAlgo2 = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(Algo2AndLaneIdComp, RemoteOffsetComp);</Highlight></CodeLine>
<Link id="l02974" /><CodeLine lineNumber="2974"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CA0OrCA1 = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab61be8e3cf17e9848aeeeabacfa1b09a">CreateOr</a>(CondAlgo0, CondAlgo1);</Highlight></CodeLine>
<Link id="l02975" /><CodeLine lineNumber="2975"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CondReduce = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab61be8e3cf17e9848aeeeabacfa1b09a">CreateOr</a>(CA0OrCA1, CondAlgo2);</Highlight></CodeLine>
<Link id="l02976" /><CodeLine lineNumber="2976"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02977" /><CodeLine lineNumber="2977"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ThenBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;then&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02978" /><CodeLine lineNumber="2978"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ElseBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;else&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02979" /><CodeLine lineNumber="2979"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;MergeBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;ifcont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02980" /><CodeLine lineNumber="2980"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02981" /><CodeLine lineNumber="2981"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(CondReduce, ThenBB, ElseBB);</Highlight></CodeLine>
<Link id="l02982" /><CodeLine lineNumber="2982"><Highlight kind="normal">  emitBlock(ThenBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02983" /><CodeLine lineNumber="2983"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LocalReduceListPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02984" /><CodeLine lineNumber="2984"><Highlight kind="normal">      ReduceList, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l02985" /><CodeLine lineNumber="2985"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RemoteReduceListPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l02986" /><CodeLine lineNumber="2986"><Highlight kind="normal">      RemoteListAddrCast, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l02987" /><CodeLine lineNumber="2987"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ReduceFn, &#123;LocalReduceListPtr, RemoteReduceListPtr&#125;)</Highlight></CodeLine>
<Link id="l02988" /><CodeLine lineNumber="2988"><Highlight kind="normal">      -&gt;addFnAttr(Attribute::NoUnwind);</Highlight></CodeLine>
<Link id="l02989" /><CodeLine lineNumber="2989"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(MergeBB);</Highlight></CodeLine>
<Link id="l02990" /><CodeLine lineNumber="2990"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02991" /><CodeLine lineNumber="2991"><Highlight kind="normal">  emitBlock(ElseBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02992" /><CodeLine lineNumber="2992"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(MergeBB);</Highlight></CodeLine>
<Link id="l02993" /><CodeLine lineNumber="2993"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02994" /><CodeLine lineNumber="2994"><Highlight kind="normal">  emitBlock(MergeBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l02995" /><CodeLine lineNumber="2995"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02996" /><CodeLine lineNumber="2996"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// if (AlgoVer==1 &amp;&amp; (LaneId &gt;= Offset)) copy Remote Reduce list to local</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02997" /><CodeLine lineNumber="2997"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Reduce list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02998" /><CodeLine lineNumber="2998"><Highlight kind="normal">  Algo1 = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(AlgoVer, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac33b7f085ea15691aa45a61ef207d603">getInt16</a>(1));</Highlight></CodeLine>
<Link id="l02999" /><CodeLine lineNumber="2999"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LaneIdGtOffset = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac613fa8e66fca464885c3f274fbeb834">CreateICmpUGE</a>(LaneId, RemoteLaneOffset);</Highlight></CodeLine>
<Link id="l03000" /><CodeLine lineNumber="3000"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CondCopy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(Algo1, LaneIdGtOffset);</Highlight></CodeLine>
<Link id="l03001" /><CodeLine lineNumber="3001"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03002" /><CodeLine lineNumber="3002"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CpyThenBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;then&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03003" /><CodeLine lineNumber="3003"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CpyElseBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;else&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03004" /><CodeLine lineNumber="3004"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CpyMergeBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;ifcont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03005" /><CodeLine lineNumber="3005"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(CondCopy, CpyThenBB, CpyElseBB);</Highlight></CodeLine>
<Link id="l03006" /><CodeLine lineNumber="3006"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03007" /><CodeLine lineNumber="3007"><Highlight kind="normal">  emitBlock(CpyThenBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l03008" /><CodeLine lineNumber="3008"><Highlight kind="normal">  emitReductionListCopy(AllocaIP, CopyAction::ThreadCopy, RedListArrayTy,</Highlight></CodeLine>
<Link id="l03009" /><CodeLine lineNumber="3009"><Highlight kind="normal">                        ReductionInfos, RemoteListAddrCast, ReduceList);</Highlight></CodeLine>
<Link id="l03010" /><CodeLine lineNumber="3010"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(CpyMergeBB);</Highlight></CodeLine>
<Link id="l03011" /><CodeLine lineNumber="3011"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03012" /><CodeLine lineNumber="3012"><Highlight kind="normal">  emitBlock(CpyElseBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l03013" /><CodeLine lineNumber="3013"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(CpyMergeBB);</Highlight></CodeLine>
<Link id="l03014" /><CodeLine lineNumber="3014"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03015" /><CodeLine lineNumber="3015"><Highlight kind="normal">  emitBlock(CpyMergeBB, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l03016" /><CodeLine lineNumber="3016"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03017" /><CodeLine lineNumber="3017"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l03018" /><CodeLine lineNumber="3018"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03019" /><CodeLine lineNumber="3019"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SarFunc;</Highlight></CodeLine>
<Link id="l03020" /><CodeLine lineNumber="3020"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03021" /><CodeLine lineNumber="3021"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03022" /><CodeLine lineNumber="3022"><Highlight kind="normal"><a href="/docs/api/classes/llvm/function">Function</a> &#42;OpenMPIRBuilder::emitListToGlobalCopyFunction(</Highlight></CodeLine>
<Link id="l03023" /><CodeLine lineNumber="3023"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos, <a href="/docs/api/classes/llvm/type">Type</a> &#42;ReductionsBufferTy,</Highlight></CodeLine>
<Link id="l03024" /><CodeLine lineNumber="3024"><Highlight kind="normal">    AttributeList FuncAttrs) &#123;</Highlight></CodeLine>
<Link id="l03025" /><CodeLine lineNumber="3025"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OldIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03026" /><CodeLine lineNumber="3026"><Highlight kind="normal">  LLVMContext &amp;Ctx = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l03027" /><CodeLine lineNumber="3027"><Highlight kind="normal">  FunctionType &#42;FuncTy = <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(</Highlight></CodeLine>
<Link id="l03028" /><CodeLine lineNumber="3028"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(),</Highlight></CodeLine>
<Link id="l03029" /><CodeLine lineNumber="3029"><Highlight kind="normal">      &#123;Builder.getPtrTy(), Builder.getInt32Ty(), Builder.getPtrTy()&#125;,</Highlight></CodeLine>
<Link id="l03030" /><CodeLine lineNumber="3030"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03031" /><CodeLine lineNumber="3031"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;LtGCFunc =</Highlight></CodeLine>
<Link id="l03032" /><CodeLine lineNumber="3032"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l03033" /><CodeLine lineNumber="3033"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;&#95;omp&#95;reduction&#95;list&#95;to&#95;global&#95;copy&#95;func&quot;</Highlight><Highlight kind="normal">, &amp;M);</Highlight></CodeLine>
<Link id="l03034" /><CodeLine lineNumber="3034"><Highlight kind="normal">  LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#a9e4c6c67f4b2528b5648299db4a86926">setAttributes</a>(FuncAttrs);</Highlight></CodeLine>
<Link id="l03035" /><CodeLine lineNumber="3035"><Highlight kind="normal">  LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03036" /><CodeLine lineNumber="3036"><Highlight kind="normal">  LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03037" /><CodeLine lineNumber="3037"><Highlight kind="normal">  LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(2, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03038" /><CodeLine lineNumber="3038"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03039" /><CodeLine lineNumber="3039"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, LtGCFunc);</Highlight></CodeLine>
<Link id="l03040" /><CodeLine lineNumber="3040"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBlock);</Highlight></CodeLine>
<Link id="l03041" /><CodeLine lineNumber="3041"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03042" /><CodeLine lineNumber="3042"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Buffer: global reduction buffer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03043" /><CodeLine lineNumber="3043"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;BufferArg = LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l03044" /><CodeLine lineNumber="3044"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Idx: index of the buffer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03045" /><CodeLine lineNumber="3045"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;IdxArg = LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l03046" /><CodeLine lineNumber="3046"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ReduceList: thread local Reduce list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03047" /><CodeLine lineNumber="3047"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;ReduceListArg = LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(2);</Highlight></CodeLine>
<Link id="l03048" /><CodeLine lineNumber="3048"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03049" /><CodeLine lineNumber="3049"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03050" /><CodeLine lineNumber="3050"><Highlight kind="normal">                                                BufferArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03051" /><CodeLine lineNumber="3051"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IdxArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03052" /><CodeLine lineNumber="3052"><Highlight kind="normal">                                             IdxArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03053" /><CodeLine lineNumber="3053"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l03054" /><CodeLine lineNumber="3054"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, ReduceListArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03055" /><CodeLine lineNumber="3055"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03056" /><CodeLine lineNumber="3056"><Highlight kind="normal">      BufferArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03057" /><CodeLine lineNumber="3057"><Highlight kind="normal">      BufferArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03058" /><CodeLine lineNumber="3058"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IdxArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03059" /><CodeLine lineNumber="3059"><Highlight kind="normal">      IdxArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), IdxArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03060" /><CodeLine lineNumber="3060"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03061" /><CodeLine lineNumber="3061"><Highlight kind="normal">      ReduceListArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03062" /><CodeLine lineNumber="3062"><Highlight kind="normal">      ReduceListArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03063" /><CodeLine lineNumber="3063"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03064" /><CodeLine lineNumber="3064"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(BufferArg, BufferArgAddrCast);</Highlight></CodeLine>
<Link id="l03065" /><CodeLine lineNumber="3065"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(IdxArg, IdxArgAddrCast);</Highlight></CodeLine>
<Link id="l03066" /><CodeLine lineNumber="3066"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(ReduceListArg, ReduceListArgAddrCast);</Highlight></CodeLine>
<Link id="l03067" /><CodeLine lineNumber="3067"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03068" /><CodeLine lineNumber="3068"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LocalReduceList =</Highlight></CodeLine>
<Link id="l03069" /><CodeLine lineNumber="3069"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReduceListArgAddrCast);</Highlight></CodeLine>
<Link id="l03070" /><CodeLine lineNumber="3070"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgVal =</Highlight></CodeLine>
<Link id="l03071" /><CodeLine lineNumber="3071"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), BufferArgAddrCast);</Highlight></CodeLine>
<Link id="l03072" /><CodeLine lineNumber="3072"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Idxs&#91;&#93; = &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), IdxArgAddrCast)&#125;;</Highlight></CodeLine>
<Link id="l03073" /><CodeLine lineNumber="3073"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l03074" /><CodeLine lineNumber="3074"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l03075" /><CodeLine lineNumber="3075"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03076" /><CodeLine lineNumber="3076"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03077" /><CodeLine lineNumber="3077"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;RedListArrayTy =</Highlight></CodeLine>
<Link id="l03078" /><CodeLine lineNumber="3078"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l03079" /><CodeLine lineNumber="3079"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Reduce element = LocalReduceList&#91;i&#93;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03080" /><CodeLine lineNumber="3080"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemPtrPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l03081" /><CodeLine lineNumber="3081"><Highlight kind="normal">        RedListArrayTy, LocalReduceList,</Highlight></CodeLine>
<Link id="l03082" /><CodeLine lineNumber="3082"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l03083" /><CodeLine lineNumber="3083"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// elemptr = ((CopyType&#42;)(elemptrptr)) + I</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03084" /><CodeLine lineNumber="3084"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ElemPtrPtr);</Highlight></CodeLine>
<Link id="l03085" /><CodeLine lineNumber="3085"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03086" /><CodeLine lineNumber="3086"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Global = Buffer.VD&#91;Idx&#93;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03087" /><CodeLine lineNumber="3087"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferVD =</Highlight></CodeLine>
<Link id="l03088" /><CodeLine lineNumber="3088"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(ReductionsBufferTy, BufferArgVal, Idxs);</Highlight></CodeLine>
<Link id="l03089" /><CodeLine lineNumber="3089"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;GlobVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03090" /><CodeLine lineNumber="3090"><Highlight kind="normal">        ReductionsBufferTy, BufferVD, 0, En.index());</Highlight></CodeLine>
<Link id="l03091" /><CodeLine lineNumber="3091"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03092" /><CodeLine lineNumber="3092"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (RI.EvaluationKind) &#123;</Highlight></CodeLine>
<Link id="l03093" /><CodeLine lineNumber="3093"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Scalar: &#123;</Highlight></CodeLine>
<Link id="l03094" /><CodeLine lineNumber="3094"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TargetElement = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(RI.ElementType, ElemPtr);</Highlight></CodeLine>
<Link id="l03095" /><CodeLine lineNumber="3095"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(TargetElement, GlobVal);</Highlight></CodeLine>
<Link id="l03096" /><CodeLine lineNumber="3096"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03097" /><CodeLine lineNumber="3097"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03098" /><CodeLine lineNumber="3098"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Complex: &#123;</Highlight></CodeLine>
<Link id="l03099" /><CodeLine lineNumber="3099"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcRealPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03100" /><CodeLine lineNumber="3100"><Highlight kind="normal">          RI.ElementType, ElemPtr, 0, 0, </Highlight><Highlight kind="stringliteral">&quot;.realp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03101" /><CodeLine lineNumber="3101"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcReal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(</Highlight></CodeLine>
<Link id="l03102" /><CodeLine lineNumber="3102"><Highlight kind="normal">          RI.ElementType-&gt;getStructElementType(0), SrcRealPtr, </Highlight><Highlight kind="stringliteral">&quot;.real&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03103" /><CodeLine lineNumber="3103"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcImgPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03104" /><CodeLine lineNumber="3104"><Highlight kind="normal">          RI.ElementType, ElemPtr, 0, 1, </Highlight><Highlight kind="stringliteral">&quot;.imagp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03105" /><CodeLine lineNumber="3105"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcImg = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(</Highlight></CodeLine>
<Link id="l03106" /><CodeLine lineNumber="3106"><Highlight kind="normal">          RI.ElementType-&gt;getStructElementType(1), SrcImgPtr, </Highlight><Highlight kind="stringliteral">&quot;.imag&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03107" /><CodeLine lineNumber="3107"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03108" /><CodeLine lineNumber="3108"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DestRealPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03109" /><CodeLine lineNumber="3109"><Highlight kind="normal">          RI.ElementType, GlobVal, 0, 0, </Highlight><Highlight kind="stringliteral">&quot;.realp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03110" /><CodeLine lineNumber="3110"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DestImgPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03111" /><CodeLine lineNumber="3111"><Highlight kind="normal">          RI.ElementType, GlobVal, 0, 1, </Highlight><Highlight kind="stringliteral">&quot;.imagp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03112" /><CodeLine lineNumber="3112"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(SrcReal, DestRealPtr);</Highlight></CodeLine>
<Link id="l03113" /><CodeLine lineNumber="3113"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(SrcImg, DestImgPtr);</Highlight></CodeLine>
<Link id="l03114" /><CodeLine lineNumber="3114"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03115" /><CodeLine lineNumber="3115"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03116" /><CodeLine lineNumber="3116"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Aggregate: &#123;</Highlight></CodeLine>
<Link id="l03117" /><CodeLine lineNumber="3117"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SizeVal =</Highlight></CodeLine>
<Link id="l03118" /><CodeLine lineNumber="3118"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(RI.ElementType));</Highlight></CodeLine>
<Link id="l03119" /><CodeLine lineNumber="3119"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae9f2730f66215fdb82f4e41e45124811">CreateMemCpy</a>(</Highlight></CodeLine>
<Link id="l03120" /><CodeLine lineNumber="3120"><Highlight kind="normal">          GlobVal, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(RI.ElementType), ElemPtr,</Highlight></CodeLine>
<Link id="l03121" /><CodeLine lineNumber="3121"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(RI.ElementType), SizeVal, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03122" /><CodeLine lineNumber="3122"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03123" /><CodeLine lineNumber="3123"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03124" /><CodeLine lineNumber="3124"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03125" /><CodeLine lineNumber="3125"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03126" /><CodeLine lineNumber="3126"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03127" /><CodeLine lineNumber="3127"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l03128" /><CodeLine lineNumber="3128"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OldIP);</Highlight></CodeLine>
<Link id="l03129" /><CodeLine lineNumber="3129"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LtGCFunc;</Highlight></CodeLine>
<Link id="l03130" /><CodeLine lineNumber="3130"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03131" /><CodeLine lineNumber="3131"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03132" /><CodeLine lineNumber="3132"><Highlight kind="normal"><a href="/docs/api/classes/llvm/function">Function</a> &#42;OpenMPIRBuilder::emitListToGlobalReduceFunction(</Highlight></CodeLine>
<Link id="l03133" /><CodeLine lineNumber="3133"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos, <a href="/docs/api/classes/llvm/function">Function</a> &#42;ReduceFn,</Highlight></CodeLine>
<Link id="l03134" /><CodeLine lineNumber="3134"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;ReductionsBufferTy, AttributeList FuncAttrs) &#123;</Highlight></CodeLine>
<Link id="l03135" /><CodeLine lineNumber="3135"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OldIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03136" /><CodeLine lineNumber="3136"><Highlight kind="normal">  LLVMContext &amp;Ctx = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l03137" /><CodeLine lineNumber="3137"><Highlight kind="normal">  FunctionType &#42;FuncTy = <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(</Highlight></CodeLine>
<Link id="l03138" /><CodeLine lineNumber="3138"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(),</Highlight></CodeLine>
<Link id="l03139" /><CodeLine lineNumber="3139"><Highlight kind="normal">      &#123;Builder.getPtrTy(), Builder.getInt32Ty(), Builder.getPtrTy()&#125;,</Highlight></CodeLine>
<Link id="l03140" /><CodeLine lineNumber="3140"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03141" /><CodeLine lineNumber="3141"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;LtGRFunc =</Highlight></CodeLine>
<Link id="l03142" /><CodeLine lineNumber="3142"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l03143" /><CodeLine lineNumber="3143"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;&#95;omp&#95;reduction&#95;list&#95;to&#95;global&#95;reduce&#95;func&quot;</Highlight><Highlight kind="normal">, &amp;M);</Highlight></CodeLine>
<Link id="l03144" /><CodeLine lineNumber="3144"><Highlight kind="normal">  LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#a9e4c6c67f4b2528b5648299db4a86926">setAttributes</a>(FuncAttrs);</Highlight></CodeLine>
<Link id="l03145" /><CodeLine lineNumber="3145"><Highlight kind="normal">  LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03146" /><CodeLine lineNumber="3146"><Highlight kind="normal">  LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03147" /><CodeLine lineNumber="3147"><Highlight kind="normal">  LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(2, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03148" /><CodeLine lineNumber="3148"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03149" /><CodeLine lineNumber="3149"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, LtGRFunc);</Highlight></CodeLine>
<Link id="l03150" /><CodeLine lineNumber="3150"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBlock);</Highlight></CodeLine>
<Link id="l03151" /><CodeLine lineNumber="3151"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03152" /><CodeLine lineNumber="3152"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Buffer: global reduction buffer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03153" /><CodeLine lineNumber="3153"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;BufferArg = LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l03154" /><CodeLine lineNumber="3154"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Idx: index of the buffer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03155" /><CodeLine lineNumber="3155"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;IdxArg = LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l03156" /><CodeLine lineNumber="3156"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ReduceList: thread local Reduce list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03157" /><CodeLine lineNumber="3157"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;ReduceListArg = LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(2);</Highlight></CodeLine>
<Link id="l03158" /><CodeLine lineNumber="3158"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03159" /><CodeLine lineNumber="3159"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03160" /><CodeLine lineNumber="3160"><Highlight kind="normal">                                                BufferArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03161" /><CodeLine lineNumber="3161"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IdxArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03162" /><CodeLine lineNumber="3162"><Highlight kind="normal">                                             IdxArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03163" /><CodeLine lineNumber="3163"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l03164" /><CodeLine lineNumber="3164"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, ReduceListArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03165" /><CodeLine lineNumber="3165"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;RedListArrayTy =</Highlight></CodeLine>
<Link id="l03166" /><CodeLine lineNumber="3166"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l03167" /><CodeLine lineNumber="3167"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03168" /><CodeLine lineNumber="3168"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// 1 Build a list of reduction variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03169" /><CodeLine lineNumber="3169"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// void &#42;RedList&#91;&lt;n&gt;&#93; = &#123;&lt;ReductionVars&gt;&#91;0&#93;, ..., &lt;ReductionVars&gt;&#91;&lt;n&gt;-1&#93;&#125;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03170" /><CodeLine lineNumber="3170"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LocalReduceList =</Highlight></CodeLine>
<Link id="l03171" /><CodeLine lineNumber="3171"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(RedListArrayTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.omp.reduction.red&#95;list&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03172" /><CodeLine lineNumber="3172"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03173" /><CodeLine lineNumber="3173"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03174" /><CodeLine lineNumber="3174"><Highlight kind="normal">      BufferArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03175" /><CodeLine lineNumber="3175"><Highlight kind="normal">      BufferArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03176" /><CodeLine lineNumber="3176"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IdxArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03177" /><CodeLine lineNumber="3177"><Highlight kind="normal">      IdxArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), IdxArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03178" /><CodeLine lineNumber="3178"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03179" /><CodeLine lineNumber="3179"><Highlight kind="normal">      ReduceListArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03180" /><CodeLine lineNumber="3180"><Highlight kind="normal">      ReduceListArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03181" /><CodeLine lineNumber="3181"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LocalReduceListAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03182" /><CodeLine lineNumber="3182"><Highlight kind="normal">      LocalReduceList, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03183" /><CodeLine lineNumber="3183"><Highlight kind="normal">      LocalReduceList-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03184" /><CodeLine lineNumber="3184"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03185" /><CodeLine lineNumber="3185"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(BufferArg, BufferArgAddrCast);</Highlight></CodeLine>
<Link id="l03186" /><CodeLine lineNumber="3186"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(IdxArg, IdxArgAddrCast);</Highlight></CodeLine>
<Link id="l03187" /><CodeLine lineNumber="3187"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(ReduceListArg, ReduceListArgAddrCast);</Highlight></CodeLine>
<Link id="l03188" /><CodeLine lineNumber="3188"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03189" /><CodeLine lineNumber="3189"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), BufferArgAddrCast);</Highlight></CodeLine>
<Link id="l03190" /><CodeLine lineNumber="3190"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Idxs&#91;&#93; = &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), IdxArgAddrCast)&#125;;</Highlight></CodeLine>
<Link id="l03191" /><CodeLine lineNumber="3191"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l03192" /><CodeLine lineNumber="3192"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l03193" /><CodeLine lineNumber="3193"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03194" /><CodeLine lineNumber="3194"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TargetElementPtrPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l03195" /><CodeLine lineNumber="3195"><Highlight kind="normal">        RedListArrayTy, LocalReduceListAddrCast,</Highlight></CodeLine>
<Link id="l03196" /><CodeLine lineNumber="3196"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l03197" /><CodeLine lineNumber="3197"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferVD =</Highlight></CodeLine>
<Link id="l03198" /><CodeLine lineNumber="3198"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(ReductionsBufferTy, BufferVal, Idxs);</Highlight></CodeLine>
<Link id="l03199" /><CodeLine lineNumber="3199"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Global = Buffer.VD&#91;Idx&#93;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03200" /><CodeLine lineNumber="3200"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;GlobValPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03201" /><CodeLine lineNumber="3201"><Highlight kind="normal">        ReductionsBufferTy, BufferVD, 0, En.index());</Highlight></CodeLine>
<Link id="l03202" /><CodeLine lineNumber="3202"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(GlobValPtr, TargetElementPtrPtr);</Highlight></CodeLine>
<Link id="l03203" /><CodeLine lineNumber="3203"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03204" /><CodeLine lineNumber="3204"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03205" /><CodeLine lineNumber="3205"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Call reduce&#95;function(GlobalReduceList, ReduceList)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03206" /><CodeLine lineNumber="3206"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceList =</Highlight></CodeLine>
<Link id="l03207" /><CodeLine lineNumber="3207"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReduceListArgAddrCast);</Highlight></CodeLine>
<Link id="l03208" /><CodeLine lineNumber="3208"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ReduceFn, &#123;LocalReduceListAddrCast, ReduceList&#125;)</Highlight></CodeLine>
<Link id="l03209" /><CodeLine lineNumber="3209"><Highlight kind="normal">      -&gt;addFnAttr(Attribute::NoUnwind);</Highlight></CodeLine>
<Link id="l03210" /><CodeLine lineNumber="3210"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l03211" /><CodeLine lineNumber="3211"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OldIP);</Highlight></CodeLine>
<Link id="l03212" /><CodeLine lineNumber="3212"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LtGRFunc;</Highlight></CodeLine>
<Link id="l03213" /><CodeLine lineNumber="3213"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03214" /><CodeLine lineNumber="3214"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03215" /><CodeLine lineNumber="3215"><Highlight kind="normal"><a href="/docs/api/classes/llvm/function">Function</a> &#42;OpenMPIRBuilder::emitGlobalToListCopyFunction(</Highlight></CodeLine>
<Link id="l03216" /><CodeLine lineNumber="3216"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos, <a href="/docs/api/classes/llvm/type">Type</a> &#42;ReductionsBufferTy,</Highlight></CodeLine>
<Link id="l03217" /><CodeLine lineNumber="3217"><Highlight kind="normal">    AttributeList FuncAttrs) &#123;</Highlight></CodeLine>
<Link id="l03218" /><CodeLine lineNumber="3218"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OldIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03219" /><CodeLine lineNumber="3219"><Highlight kind="normal">  LLVMContext &amp;Ctx = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l03220" /><CodeLine lineNumber="3220"><Highlight kind="normal">  FunctionType &#42;FuncTy = <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(</Highlight></CodeLine>
<Link id="l03221" /><CodeLine lineNumber="3221"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(),</Highlight></CodeLine>
<Link id="l03222" /><CodeLine lineNumber="3222"><Highlight kind="normal">      &#123;Builder.getPtrTy(), Builder.getInt32Ty(), Builder.getPtrTy()&#125;,</Highlight></CodeLine>
<Link id="l03223" /><CodeLine lineNumber="3223"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03224" /><CodeLine lineNumber="3224"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;LtGCFunc =</Highlight></CodeLine>
<Link id="l03225" /><CodeLine lineNumber="3225"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l03226" /><CodeLine lineNumber="3226"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;&#95;omp&#95;reduction&#95;global&#95;to&#95;list&#95;copy&#95;func&quot;</Highlight><Highlight kind="normal">, &amp;M);</Highlight></CodeLine>
<Link id="l03227" /><CodeLine lineNumber="3227"><Highlight kind="normal">  LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#a9e4c6c67f4b2528b5648299db4a86926">setAttributes</a>(FuncAttrs);</Highlight></CodeLine>
<Link id="l03228" /><CodeLine lineNumber="3228"><Highlight kind="normal">  LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03229" /><CodeLine lineNumber="3229"><Highlight kind="normal">  LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03230" /><CodeLine lineNumber="3230"><Highlight kind="normal">  LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(2, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03231" /><CodeLine lineNumber="3231"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03232" /><CodeLine lineNumber="3232"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, LtGCFunc);</Highlight></CodeLine>
<Link id="l03233" /><CodeLine lineNumber="3233"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBlock);</Highlight></CodeLine>
<Link id="l03234" /><CodeLine lineNumber="3234"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03235" /><CodeLine lineNumber="3235"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Buffer: global reduction buffer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03236" /><CodeLine lineNumber="3236"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;BufferArg = LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l03237" /><CodeLine lineNumber="3237"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Idx: index of the buffer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03238" /><CodeLine lineNumber="3238"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;IdxArg = LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l03239" /><CodeLine lineNumber="3239"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ReduceList: thread local Reduce list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03240" /><CodeLine lineNumber="3240"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;ReduceListArg = LtGCFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(2);</Highlight></CodeLine>
<Link id="l03241" /><CodeLine lineNumber="3241"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03242" /><CodeLine lineNumber="3242"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03243" /><CodeLine lineNumber="3243"><Highlight kind="normal">                                                BufferArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03244" /><CodeLine lineNumber="3244"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IdxArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03245" /><CodeLine lineNumber="3245"><Highlight kind="normal">                                             IdxArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03246" /><CodeLine lineNumber="3246"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l03247" /><CodeLine lineNumber="3247"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, ReduceListArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03248" /><CodeLine lineNumber="3248"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03249" /><CodeLine lineNumber="3249"><Highlight kind="normal">      BufferArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03250" /><CodeLine lineNumber="3250"><Highlight kind="normal">      BufferArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03251" /><CodeLine lineNumber="3251"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IdxArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03252" /><CodeLine lineNumber="3252"><Highlight kind="normal">      IdxArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), IdxArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03253" /><CodeLine lineNumber="3253"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03254" /><CodeLine lineNumber="3254"><Highlight kind="normal">      ReduceListArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03255" /><CodeLine lineNumber="3255"><Highlight kind="normal">      ReduceListArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03256" /><CodeLine lineNumber="3256"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(BufferArg, BufferArgAddrCast);</Highlight></CodeLine>
<Link id="l03257" /><CodeLine lineNumber="3257"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(IdxArg, IdxArgAddrCast);</Highlight></CodeLine>
<Link id="l03258" /><CodeLine lineNumber="3258"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(ReduceListArg, ReduceListArgAddrCast);</Highlight></CodeLine>
<Link id="l03259" /><CodeLine lineNumber="3259"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03260" /><CodeLine lineNumber="3260"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LocalReduceList =</Highlight></CodeLine>
<Link id="l03261" /><CodeLine lineNumber="3261"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReduceListArgAddrCast);</Highlight></CodeLine>
<Link id="l03262" /><CodeLine lineNumber="3262"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), BufferArgAddrCast);</Highlight></CodeLine>
<Link id="l03263" /><CodeLine lineNumber="3263"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Idxs&#91;&#93; = &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), IdxArgAddrCast)&#125;;</Highlight></CodeLine>
<Link id="l03264" /><CodeLine lineNumber="3264"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l03265" /><CodeLine lineNumber="3265"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l03266" /><CodeLine lineNumber="3266"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03267" /><CodeLine lineNumber="3267"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OpenMPIRBuilder::ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03268" /><CodeLine lineNumber="3268"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;RedListArrayTy =</Highlight></CodeLine>
<Link id="l03269" /><CodeLine lineNumber="3269"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l03270" /><CodeLine lineNumber="3270"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Reduce element = LocalReduceList&#91;i&#93;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03271" /><CodeLine lineNumber="3271"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemPtrPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l03272" /><CodeLine lineNumber="3272"><Highlight kind="normal">        RedListArrayTy, LocalReduceList,</Highlight></CodeLine>
<Link id="l03273" /><CodeLine lineNumber="3273"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l03274" /><CodeLine lineNumber="3274"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// elemptr = ((CopyType&#42;)(elemptrptr)) + I</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03275" /><CodeLine lineNumber="3275"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ElemPtrPtr);</Highlight></CodeLine>
<Link id="l03276" /><CodeLine lineNumber="3276"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Global = Buffer.VD&#91;Idx&#93;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03277" /><CodeLine lineNumber="3277"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferVD =</Highlight></CodeLine>
<Link id="l03278" /><CodeLine lineNumber="3278"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(ReductionsBufferTy, BufferVal, Idxs);</Highlight></CodeLine>
<Link id="l03279" /><CodeLine lineNumber="3279"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;GlobValPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03280" /><CodeLine lineNumber="3280"><Highlight kind="normal">        ReductionsBufferTy, BufferVD, 0, En.index());</Highlight></CodeLine>
<Link id="l03281" /><CodeLine lineNumber="3281"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03282" /><CodeLine lineNumber="3282"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (RI.EvaluationKind) &#123;</Highlight></CodeLine>
<Link id="l03283" /><CodeLine lineNumber="3283"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Scalar: &#123;</Highlight></CodeLine>
<Link id="l03284" /><CodeLine lineNumber="3284"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TargetElement = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(RI.ElementType, GlobValPtr);</Highlight></CodeLine>
<Link id="l03285" /><CodeLine lineNumber="3285"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(TargetElement, ElemPtr);</Highlight></CodeLine>
<Link id="l03286" /><CodeLine lineNumber="3286"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03287" /><CodeLine lineNumber="3287"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03288" /><CodeLine lineNumber="3288"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Complex: &#123;</Highlight></CodeLine>
<Link id="l03289" /><CodeLine lineNumber="3289"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcRealPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03290" /><CodeLine lineNumber="3290"><Highlight kind="normal">          RI.ElementType, GlobValPtr, 0, 0, </Highlight><Highlight kind="stringliteral">&quot;.realp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03291" /><CodeLine lineNumber="3291"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcReal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(</Highlight></CodeLine>
<Link id="l03292" /><CodeLine lineNumber="3292"><Highlight kind="normal">          RI.ElementType-&gt;getStructElementType(0), SrcRealPtr, </Highlight><Highlight kind="stringliteral">&quot;.real&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03293" /><CodeLine lineNumber="3293"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcImgPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03294" /><CodeLine lineNumber="3294"><Highlight kind="normal">          RI.ElementType, GlobValPtr, 0, 1, </Highlight><Highlight kind="stringliteral">&quot;.imagp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03295" /><CodeLine lineNumber="3295"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcImg = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(</Highlight></CodeLine>
<Link id="l03296" /><CodeLine lineNumber="3296"><Highlight kind="normal">          RI.ElementType-&gt;getStructElementType(1), SrcImgPtr, </Highlight><Highlight kind="stringliteral">&quot;.imag&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03297" /><CodeLine lineNumber="3297"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03298" /><CodeLine lineNumber="3298"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DestRealPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03299" /><CodeLine lineNumber="3299"><Highlight kind="normal">          RI.ElementType, ElemPtr, 0, 0, </Highlight><Highlight kind="stringliteral">&quot;.realp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03300" /><CodeLine lineNumber="3300"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DestImgPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03301" /><CodeLine lineNumber="3301"><Highlight kind="normal">          RI.ElementType, ElemPtr, 0, 1, </Highlight><Highlight kind="stringliteral">&quot;.imagp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03302" /><CodeLine lineNumber="3302"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(SrcReal, DestRealPtr);</Highlight></CodeLine>
<Link id="l03303" /><CodeLine lineNumber="3303"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(SrcImg, DestImgPtr);</Highlight></CodeLine>
<Link id="l03304" /><CodeLine lineNumber="3304"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03305" /><CodeLine lineNumber="3305"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03306" /><CodeLine lineNumber="3306"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> EvalKind::Aggregate: &#123;</Highlight></CodeLine>
<Link id="l03307" /><CodeLine lineNumber="3307"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SizeVal =</Highlight></CodeLine>
<Link id="l03308" /><CodeLine lineNumber="3308"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(RI.ElementType));</Highlight></CodeLine>
<Link id="l03309" /><CodeLine lineNumber="3309"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae9f2730f66215fdb82f4e41e45124811">CreateMemCpy</a>(</Highlight></CodeLine>
<Link id="l03310" /><CodeLine lineNumber="3310"><Highlight kind="normal">          ElemPtr, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(RI.ElementType),</Highlight></CodeLine>
<Link id="l03311" /><CodeLine lineNumber="3311"><Highlight kind="normal">          GlobValPtr, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(RI.ElementType),</Highlight></CodeLine>
<Link id="l03312" /><CodeLine lineNumber="3312"><Highlight kind="normal">          SizeVal, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03313" /><CodeLine lineNumber="3313"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03314" /><CodeLine lineNumber="3314"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03315" /><CodeLine lineNumber="3315"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03316" /><CodeLine lineNumber="3316"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03317" /><CodeLine lineNumber="3317"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03318" /><CodeLine lineNumber="3318"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l03319" /><CodeLine lineNumber="3319"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OldIP);</Highlight></CodeLine>
<Link id="l03320" /><CodeLine lineNumber="3320"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LtGCFunc;</Highlight></CodeLine>
<Link id="l03321" /><CodeLine lineNumber="3321"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03322" /><CodeLine lineNumber="3322"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03323" /><CodeLine lineNumber="3323"><Highlight kind="normal"><a href="/docs/api/classes/llvm/function">Function</a> &#42;OpenMPIRBuilder::emitGlobalToListReduceFunction(</Highlight></CodeLine>
<Link id="l03324" /><CodeLine lineNumber="3324"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos, <a href="/docs/api/classes/llvm/function">Function</a> &#42;ReduceFn,</Highlight></CodeLine>
<Link id="l03325" /><CodeLine lineNumber="3325"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;ReductionsBufferTy, AttributeList FuncAttrs) &#123;</Highlight></CodeLine>
<Link id="l03326" /><CodeLine lineNumber="3326"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OldIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03327" /><CodeLine lineNumber="3327"><Highlight kind="normal">  LLVMContext &amp;Ctx = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l03328" /><CodeLine lineNumber="3328"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;FuncTy = <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(</Highlight></CodeLine>
<Link id="l03329" /><CodeLine lineNumber="3329"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(),</Highlight></CodeLine>
<Link id="l03330" /><CodeLine lineNumber="3330"><Highlight kind="normal">      &#123;Builder.getPtrTy(), Builder.getInt32Ty(), Builder.getPtrTy()&#125;,</Highlight></CodeLine>
<Link id="l03331" /><CodeLine lineNumber="3331"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03332" /><CodeLine lineNumber="3332"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;LtGRFunc =</Highlight></CodeLine>
<Link id="l03333" /><CodeLine lineNumber="3333"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l03334" /><CodeLine lineNumber="3334"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;&#95;omp&#95;reduction&#95;global&#95;to&#95;list&#95;reduce&#95;func&quot;</Highlight><Highlight kind="normal">, &amp;M);</Highlight></CodeLine>
<Link id="l03335" /><CodeLine lineNumber="3335"><Highlight kind="normal">  LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#a9e4c6c67f4b2528b5648299db4a86926">setAttributes</a>(FuncAttrs);</Highlight></CodeLine>
<Link id="l03336" /><CodeLine lineNumber="3336"><Highlight kind="normal">  LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03337" /><CodeLine lineNumber="3337"><Highlight kind="normal">  LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03338" /><CodeLine lineNumber="3338"><Highlight kind="normal">  LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(2, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03339" /><CodeLine lineNumber="3339"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03340" /><CodeLine lineNumber="3340"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, LtGRFunc);</Highlight></CodeLine>
<Link id="l03341" /><CodeLine lineNumber="3341"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBlock);</Highlight></CodeLine>
<Link id="l03342" /><CodeLine lineNumber="3342"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03343" /><CodeLine lineNumber="3343"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Buffer: global reduction buffer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03344" /><CodeLine lineNumber="3344"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;BufferArg = LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l03345" /><CodeLine lineNumber="3345"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Idx: index of the buffer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03346" /><CodeLine lineNumber="3346"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;IdxArg = LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l03347" /><CodeLine lineNumber="3347"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ReduceList: thread local Reduce list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03348" /><CodeLine lineNumber="3348"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;ReduceListArg = LtGRFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(2);</Highlight></CodeLine>
<Link id="l03349" /><CodeLine lineNumber="3349"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03350" /><CodeLine lineNumber="3350"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03351" /><CodeLine lineNumber="3351"><Highlight kind="normal">                                                BufferArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03352" /><CodeLine lineNumber="3352"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IdxArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03353" /><CodeLine lineNumber="3353"><Highlight kind="normal">                                             IdxArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03354" /><CodeLine lineNumber="3354"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListArgAlloca = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l03355" /><CodeLine lineNumber="3355"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, ReduceListArg-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03356" /><CodeLine lineNumber="3356"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bacb17ff5177bb277ed8dd79480aad9c27">ArrayType</a> &#42;RedListArrayTy =</Highlight></CodeLine>
<Link id="l03357" /><CodeLine lineNumber="3357"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l03358" /><CodeLine lineNumber="3358"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03359" /><CodeLine lineNumber="3359"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// 1 Build a list of reduction variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03360" /><CodeLine lineNumber="3360"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// void &#42;RedList&#91;&lt;n&gt;&#93; = &#123;&lt;ReductionVars&gt;&#91;0&#93;, ..., &lt;ReductionVars&gt;&#91;&lt;n&gt;-1&#93;&#125;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03361" /><CodeLine lineNumber="3361"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LocalReduceList =</Highlight></CodeLine>
<Link id="l03362" /><CodeLine lineNumber="3362"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(RedListArrayTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.omp.reduction.red&#95;list&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03363" /><CodeLine lineNumber="3363"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03364" /><CodeLine lineNumber="3364"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03365" /><CodeLine lineNumber="3365"><Highlight kind="normal">      BufferArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03366" /><CodeLine lineNumber="3366"><Highlight kind="normal">      BufferArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03367" /><CodeLine lineNumber="3367"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IdxArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03368" /><CodeLine lineNumber="3368"><Highlight kind="normal">      IdxArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), IdxArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03369" /><CodeLine lineNumber="3369"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceListArgAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03370" /><CodeLine lineNumber="3370"><Highlight kind="normal">      ReduceListArgAlloca, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03371" /><CodeLine lineNumber="3371"><Highlight kind="normal">      ReduceListArgAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03372" /><CodeLine lineNumber="3372"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReductionList = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03373" /><CodeLine lineNumber="3373"><Highlight kind="normal">      LocalReduceList, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(),</Highlight></CodeLine>
<Link id="l03374" /><CodeLine lineNumber="3374"><Highlight kind="normal">      LocalReduceList-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03375" /><CodeLine lineNumber="3375"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03376" /><CodeLine lineNumber="3376"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(BufferArg, BufferArgAddrCast);</Highlight></CodeLine>
<Link id="l03377" /><CodeLine lineNumber="3377"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(IdxArg, IdxArgAddrCast);</Highlight></CodeLine>
<Link id="l03378" /><CodeLine lineNumber="3378"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(ReduceListArg, ReduceListArgAddrCast);</Highlight></CodeLine>
<Link id="l03379" /><CodeLine lineNumber="3379"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03380" /><CodeLine lineNumber="3380"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), BufferArgAddrCast);</Highlight></CodeLine>
<Link id="l03381" /><CodeLine lineNumber="3381"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Idxs&#91;&#93; = &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), IdxArgAddrCast)&#125;;</Highlight></CodeLine>
<Link id="l03382" /><CodeLine lineNumber="3382"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l03383" /><CodeLine lineNumber="3383"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l03384" /><CodeLine lineNumber="3384"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03385" /><CodeLine lineNumber="3385"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TargetElementPtrPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l03386" /><CodeLine lineNumber="3386"><Highlight kind="normal">        RedListArrayTy, ReductionList,</Highlight></CodeLine>
<Link id="l03387" /><CodeLine lineNumber="3387"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l03388" /><CodeLine lineNumber="3388"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Global = Buffer.VD&#91;Idx&#93;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03389" /><CodeLine lineNumber="3389"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BufferVD =</Highlight></CodeLine>
<Link id="l03390" /><CodeLine lineNumber="3390"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(ReductionsBufferTy, BufferVal, Idxs);</Highlight></CodeLine>
<Link id="l03391" /><CodeLine lineNumber="3391"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;GlobValPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l03392" /><CodeLine lineNumber="3392"><Highlight kind="normal">        ReductionsBufferTy, BufferVD, 0, En.index());</Highlight></CodeLine>
<Link id="l03393" /><CodeLine lineNumber="3393"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(GlobValPtr, TargetElementPtrPtr);</Highlight></CodeLine>
<Link id="l03394" /><CodeLine lineNumber="3394"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03395" /><CodeLine lineNumber="3395"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03396" /><CodeLine lineNumber="3396"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Call reduce&#95;function(ReduceList, GlobalReduceList)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03397" /><CodeLine lineNumber="3397"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReduceList =</Highlight></CodeLine>
<Link id="l03398" /><CodeLine lineNumber="3398"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReduceListArgAddrCast);</Highlight></CodeLine>
<Link id="l03399" /><CodeLine lineNumber="3399"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ReduceFn, &#123;ReduceList, ReductionList&#125;)</Highlight></CodeLine>
<Link id="l03400" /><CodeLine lineNumber="3400"><Highlight kind="normal">      -&gt;addFnAttr(Attribute::NoUnwind);</Highlight></CodeLine>
<Link id="l03401" /><CodeLine lineNumber="3401"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l03402" /><CodeLine lineNumber="3402"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OldIP);</Highlight></CodeLine>
<Link id="l03403" /><CodeLine lineNumber="3403"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LtGRFunc;</Highlight></CodeLine>
<Link id="l03404" /><CodeLine lineNumber="3404"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03405" /><CodeLine lineNumber="3405"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03406" /><CodeLine lineNumber="3406"><Highlight kind="normal">std::string OpenMPIRBuilder::getReductionFuncName(<a href="/docs/api/classes/llvm/stringref">StringRef</a> Name)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l03407" /><CodeLine lineNumber="3407"><Highlight kind="normal">  std::string Suffix =</Highlight></CodeLine>
<Link id="l03408" /><CodeLine lineNumber="3408"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;</Highlight><Highlight kind="stringliteral">&quot;omp&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;reduction&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;reduction&#95;func&quot;</Highlight><Highlight kind="normal">&#125;);</Highlight></CodeLine>
<Link id="l03409" /><CodeLine lineNumber="3409"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> (Name + Suffix).str();</Highlight></CodeLine>
<Link id="l03410" /><CodeLine lineNumber="3410"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03411" /><CodeLine lineNumber="3411"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03412" /><CodeLine lineNumber="3412"><Highlight kind="normal"><a href="/docs/api/classes/llvm/expected">Expected&lt;Function &#42;&gt;</a> OpenMPIRBuilder::createReductionFunction(</Highlight></CodeLine>
<Link id="l03413" /><CodeLine lineNumber="3413"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/stringref">StringRef</a> ReducerName, <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos,</Highlight></CodeLine>
<Link id="l03414" /><CodeLine lineNumber="3414"><Highlight kind="normal">    ReductionGenCBKind ReductionGenCBKind, AttributeList FuncAttrs) &#123;</Highlight></CodeLine>
<Link id="l03415" /><CodeLine lineNumber="3415"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;FuncTy = <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(),</Highlight></CodeLine>
<Link id="l03416" /><CodeLine lineNumber="3416"><Highlight kind="normal">                                   &#123;Builder.getPtrTy(), Builder.getPtrTy()&#125;,</Highlight></CodeLine>
<Link id="l03417" /><CodeLine lineNumber="3417"><Highlight kind="normal">                                   </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03418" /><CodeLine lineNumber="3418"><Highlight kind="normal">  std::string <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = getReductionFuncName(ReducerName);</Highlight></CodeLine>
<Link id="l03419" /><CodeLine lineNumber="3419"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ReductionFunc =</Highlight></CodeLine>
<Link id="l03420" /><CodeLine lineNumber="3420"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>, Name, &amp;M);</Highlight></CodeLine>
<Link id="l03421" /><CodeLine lineNumber="3421"><Highlight kind="normal">  ReductionFunc-&gt;<a href="/docs/api/classes/llvm/function/#a9e4c6c67f4b2528b5648299db4a86926">setAttributes</a>(FuncAttrs);</Highlight></CodeLine>
<Link id="l03422" /><CodeLine lineNumber="3422"><Highlight kind="normal">  ReductionFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03423" /><CodeLine lineNumber="3423"><Highlight kind="normal">  ReductionFunc-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l03424" /><CodeLine lineNumber="3424"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBB =</Highlight></CodeLine>
<Link id="l03425" /><CodeLine lineNumber="3425"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, ReductionFunc);</Highlight></CodeLine>
<Link id="l03426" /><CodeLine lineNumber="3426"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBB);</Highlight></CodeLine>
<Link id="l03427" /><CodeLine lineNumber="3427"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03428" /><CodeLine lineNumber="3428"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Need to alloca memory here and deal with the pointers before getting</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03429" /><CodeLine lineNumber="3429"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// LHS/RHS pointers out</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03430" /><CodeLine lineNumber="3430"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSArrayPtr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03431" /><CodeLine lineNumber="3431"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSArrayPtr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03432" /><CodeLine lineNumber="3432"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;Arg0 = ReductionFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l03433" /><CodeLine lineNumber="3433"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa1853680a6d666b9fea2d789dd00bc7eb">Argument</a> &#42;Arg1 = ReductionFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l03434" /><CodeLine lineNumber="3434"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;Arg0Type = Arg0-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l03435" /><CodeLine lineNumber="3435"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;Arg1Type = Arg1-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l03436" /><CodeLine lineNumber="3436"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03437" /><CodeLine lineNumber="3437"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSAlloca =</Highlight></CodeLine>
<Link id="l03438" /><CodeLine lineNumber="3438"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Arg0Type, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, Arg0-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03439" /><CodeLine lineNumber="3439"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSAlloca =</Highlight></CodeLine>
<Link id="l03440" /><CodeLine lineNumber="3440"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(Arg1Type, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, Arg1-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.addr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03441" /><CodeLine lineNumber="3441"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03442" /><CodeLine lineNumber="3442"><Highlight kind="normal">      LHSAlloca, Arg0Type, LHSAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03443" /><CodeLine lineNumber="3443"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSAddrCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03444" /><CodeLine lineNumber="3444"><Highlight kind="normal">      RHSAlloca, Arg1Type, RHSAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03445" /><CodeLine lineNumber="3445"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Arg0, LHSAddrCast);</Highlight></CodeLine>
<Link id="l03446" /><CodeLine lineNumber="3446"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Arg1, RHSAddrCast);</Highlight></CodeLine>
<Link id="l03447" /><CodeLine lineNumber="3447"><Highlight kind="normal">  LHSArrayPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Arg0Type, LHSAddrCast);</Highlight></CodeLine>
<Link id="l03448" /><CodeLine lineNumber="3448"><Highlight kind="normal">  RHSArrayPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Arg1Type, RHSAddrCast);</Highlight></CodeLine>
<Link id="l03449" /><CodeLine lineNumber="3449"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03450" /><CodeLine lineNumber="3450"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;RedArrayTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l03451" /><CodeLine lineNumber="3451"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l03452" /><CodeLine lineNumber="3452"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l03453" /><CodeLine lineNumber="3453"><Highlight kind="normal">  SmallVector&lt;Value &#42;&gt; LHSPtrs, RHSPtrs;</Highlight></CodeLine>
<Link id="l03454" /><CodeLine lineNumber="3454"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03455" /><CodeLine lineNumber="3455"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03456" /><CodeLine lineNumber="3456"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSI8PtrPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l03457" /><CodeLine lineNumber="3457"><Highlight kind="normal">        RedArrayTy, RHSArrayPtr,</Highlight></CodeLine>
<Link id="l03458" /><CodeLine lineNumber="3458"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l03459" /><CodeLine lineNumber="3459"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSI8Ptr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), RHSI8PtrPtr);</Highlight></CodeLine>
<Link id="l03460" /><CodeLine lineNumber="3460"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03461" /><CodeLine lineNumber="3461"><Highlight kind="normal">        RHSI8Ptr, RI.PrivateVariable-&gt;getType(),</Highlight></CodeLine>
<Link id="l03462" /><CodeLine lineNumber="3462"><Highlight kind="normal">        RHSI8Ptr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03463" /><CodeLine lineNumber="3463"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03464" /><CodeLine lineNumber="3464"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSI8PtrPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l03465" /><CodeLine lineNumber="3465"><Highlight kind="normal">        RedArrayTy, LHSArrayPtr,</Highlight></CodeLine>
<Link id="l03466" /><CodeLine lineNumber="3466"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l03467" /><CodeLine lineNumber="3467"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSI8Ptr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), LHSI8PtrPtr);</Highlight></CodeLine>
<Link id="l03468" /><CodeLine lineNumber="3468"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03469" /><CodeLine lineNumber="3469"><Highlight kind="normal">        LHSI8Ptr, RI.Variable-&gt;getType(), LHSI8Ptr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03470" /><CodeLine lineNumber="3470"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03471" /><CodeLine lineNumber="3471"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ReductionGenCBKind == ReductionGenCBKind::Clang) &#123;</Highlight></CodeLine>
<Link id="l03472" /><CodeLine lineNumber="3472"><Highlight kind="normal">      LHSPtrs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(LHSPtr);</Highlight></CodeLine>
<Link id="l03473" /><CodeLine lineNumber="3473"><Highlight kind="normal">      RHSPtrs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(RHSPtr);</Highlight></CodeLine>
<Link id="l03474" /><CodeLine lineNumber="3474"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l03475" /><CodeLine lineNumber="3475"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(RI.ElementType, LHSPtr);</Highlight></CodeLine>
<Link id="l03476" /><CodeLine lineNumber="3476"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(RI.ElementType, RHSPtr);</Highlight></CodeLine>
<Link id="l03477" /><CodeLine lineNumber="3477"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Reduced;</Highlight></CodeLine>
<Link id="l03478" /><CodeLine lineNumber="3478"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l03479" /><CodeLine lineNumber="3479"><Highlight kind="normal">          RI.ReductionGen(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, Reduced);</Highlight></CodeLine>
<Link id="l03480" /><CodeLine lineNumber="3480"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l03481" /><CodeLine lineNumber="3481"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l03482" /><CodeLine lineNumber="3482"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>())</Highlight></CodeLine>
<Link id="l03483" /><CodeLine lineNumber="3483"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ReductionFunc;</Highlight></CodeLine>
<Link id="l03484" /><CodeLine lineNumber="3484"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Reduced, LHSPtr);</Highlight></CodeLine>
<Link id="l03485" /><CodeLine lineNumber="3485"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03486" /><CodeLine lineNumber="3486"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03487" /><CodeLine lineNumber="3487"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03488" /><CodeLine lineNumber="3488"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ReductionGenCBKind == ReductionGenCBKind::Clang)</Highlight></CodeLine>
<Link id="l03489" /><CodeLine lineNumber="3489"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03490" /><CodeLine lineNumber="3490"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/dwarf/#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = En.index();</Highlight></CodeLine>
<Link id="l03491" /><CodeLine lineNumber="3491"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03492" /><CodeLine lineNumber="3492"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSFixupPtr, &#42;RHSFixupPtr;</Highlight></CodeLine>
<Link id="l03493" /><CodeLine lineNumber="3493"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(RI.ReductionGenClang(</Highlight></CodeLine>
<Link id="l03494" /><CodeLine lineNumber="3494"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), Index, &amp;LHSFixupPtr, &amp;RHSFixupPtr, ReductionFunc));</Highlight></CodeLine>
<Link id="l03495" /><CodeLine lineNumber="3495"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03496" /><CodeLine lineNumber="3496"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Fix the CallBack code genereated to use the correct Values for the LHS</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03497" /><CodeLine lineNumber="3497"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// and RHS</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03498" /><CodeLine lineNumber="3498"><Highlight kind="normal">      LHSFixupPtr-&gt;<a href="/docs/api/classes/llvm/value/#a7e8dad1701aa6445be4a29f654b0473c">replaceUsesWithIf</a>(</Highlight></CodeLine>
<Link id="l03499" /><CodeLine lineNumber="3499"><Highlight kind="normal">          LHSPtrs&#91;Index&#93;, &#91;ReductionFunc&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Use &amp;U) &#123;</Highlight></CodeLine>
<Link id="l03500" /><CodeLine lineNumber="3500"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser())-&gt;getParent()-&gt;getParent() ==</Highlight></CodeLine>
<Link id="l03501" /><CodeLine lineNumber="3501"><Highlight kind="normal">                   ReductionFunc;</Highlight></CodeLine>
<Link id="l03502" /><CodeLine lineNumber="3502"><Highlight kind="normal">          &#125;);</Highlight></CodeLine>
<Link id="l03503" /><CodeLine lineNumber="3503"><Highlight kind="normal">      RHSFixupPtr-&gt;<a href="/docs/api/classes/llvm/value/#a7e8dad1701aa6445be4a29f654b0473c">replaceUsesWithIf</a>(</Highlight></CodeLine>
<Link id="l03504" /><CodeLine lineNumber="3504"><Highlight kind="normal">          RHSPtrs&#91;Index&#93;, &#91;ReductionFunc&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Use &amp;U) &#123;</Highlight></CodeLine>
<Link id="l03505" /><CodeLine lineNumber="3505"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser())-&gt;getParent()-&gt;getParent() ==</Highlight></CodeLine>
<Link id="l03506" /><CodeLine lineNumber="3506"><Highlight kind="normal">                   ReductionFunc;</Highlight></CodeLine>
<Link id="l03507" /><CodeLine lineNumber="3507"><Highlight kind="normal">          &#125;);</Highlight></CodeLine>
<Link id="l03508" /><CodeLine lineNumber="3508"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03509" /><CodeLine lineNumber="3509"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03510" /><CodeLine lineNumber="3510"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l03511" /><CodeLine lineNumber="3511"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ReductionFunc;</Highlight></CodeLine>
<Link id="l03512" /><CodeLine lineNumber="3512"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03513" /><CodeLine lineNumber="3513"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03514" /><CodeLine lineNumber="3514"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03515" /><CodeLine lineNumber="3515" lineLink="#a75e12544ba3cf3438ac62e2065e4941d"><Highlight kind="normal"><a href="#a75e12544ba3cf3438ac62e2065e4941d">checkReductionInfos</a>(<a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;OpenMPIRBuilder::ReductionInfo&gt;</a> ReductionInfos,</Highlight></CodeLine>
<Link id="l03516" /><CodeLine lineNumber="3516"><Highlight kind="normal">                    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsGPU) &#123;</Highlight></CodeLine>
<Link id="l03517" /><CodeLine lineNumber="3517"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OpenMPIRBuilder::ReductionInfo &amp;RI : ReductionInfos) &#123;</Highlight></CodeLine>
<Link id="l03518" /><CodeLine lineNumber="3518"><Highlight kind="normal">    (void)RI;</Highlight></CodeLine>
<Link id="l03519" /><CodeLine lineNumber="3519"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.Variable &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;expected non-null variable&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03520" /><CodeLine lineNumber="3520"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.PrivateVariable &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;expected non-null private variable&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03521" /><CodeLine lineNumber="3521"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((RI.ReductionGen || RI.ReductionGenClang) &amp;&amp;</Highlight></CodeLine>
<Link id="l03522" /><CodeLine lineNumber="3522"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;expected non-null reduction generator callback&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03523" /><CodeLine lineNumber="3523"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsGPU) &#123;</Highlight></CodeLine>
<Link id="l03524" /><CodeLine lineNumber="3524"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</Highlight></CodeLine>
<Link id="l03525" /><CodeLine lineNumber="3525"><Highlight kind="normal">          RI.Variable-&gt;getType() == RI.PrivateVariable-&gt;getType() &amp;&amp;</Highlight></CodeLine>
<Link id="l03526" /><CodeLine lineNumber="3526"><Highlight kind="normal">          </Highlight><Highlight kind="stringliteral">&quot;expected variables and their private equivalents to have the same &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03527" /><CodeLine lineNumber="3527"><Highlight kind="normal">          </Highlight><Highlight kind="stringliteral">&quot;type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03528" /><CodeLine lineNumber="3528"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03529" /><CodeLine lineNumber="3529"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.Variable-&gt;getType()-&gt;isPointerTy() &amp;&amp;</Highlight></CodeLine>
<Link id="l03530" /><CodeLine lineNumber="3530"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;expected variables to be pointers&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03531" /><CodeLine lineNumber="3531"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03532" /><CodeLine lineNumber="3532"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03533" /><CodeLine lineNumber="3533"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03534" /><CodeLine lineNumber="3534"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::createReductionsGPU(</Highlight></CodeLine>
<Link id="l03535" /><CodeLine lineNumber="3535"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l03536" /><CodeLine lineNumber="3536"><Highlight kind="normal">    InsertPointTy CodeGenIP, <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos,</Highlight></CodeLine>
<Link id="l03537" /><CodeLine lineNumber="3537"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsNoWait, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsTeamsReduction, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasDistribute,</Highlight></CodeLine>
<Link id="l03538" /><CodeLine lineNumber="3538"><Highlight kind="normal">    ReductionGenCBKind ReductionGenCBKind, std::optional&lt;omp::GV&gt; GridValue,</Highlight></CodeLine>
<Link id="l03539" /><CodeLine lineNumber="3539"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> ReductionBufNum, <a href="/docs/api/classes/llvm/value">Value</a> &#42;SrcLocInfo) &#123;</Highlight></CodeLine>
<Link id="l03540" /><CodeLine lineNumber="3540"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l03541" /><CodeLine lineNumber="3541"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l03542" /><CodeLine lineNumber="3542"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l03543" /><CodeLine lineNumber="3543"><Highlight kind="normal">  <a href="#a75e12544ba3cf3438ac62e2065e4941d">checkReductionInfos</a>(ReductionInfos, </Highlight><Highlight kind="comment">/&#42;IsGPU&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03544" /><CodeLine lineNumber="3544"><Highlight kind="normal">  LLVMContext &amp;Ctx = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l03545" /><CodeLine lineNumber="3545"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03546" /><CodeLine lineNumber="3546"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Source location for the ident struct</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03547" /><CodeLine lineNumber="3547"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SrcLocInfo) &#123;</Highlight></CodeLine>
<Link id="l03548" /><CodeLine lineNumber="3548"><Highlight kind="normal">    uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l03549" /><CodeLine lineNumber="3549"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l03550" /><CodeLine lineNumber="3550"><Highlight kind="normal">    SrcLocInfo = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l03551" /><CodeLine lineNumber="3551"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03552" /><CodeLine lineNumber="3552"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03553" /><CodeLine lineNumber="3553"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>() == 0)</Highlight></CodeLine>
<Link id="l03554" /><CodeLine lineNumber="3554"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03555" /><CodeLine lineNumber="3555"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03556" /><CodeLine lineNumber="3556"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;CurFunc = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l03557" /><CodeLine lineNumber="3557"><Highlight kind="normal">  AttributeList FuncAttrs;</Highlight></CodeLine>
<Link id="l03558" /><CodeLine lineNumber="3558"><Highlight kind="normal">  AttrBuilder AttrBldr(Ctx);</Highlight></CodeLine>
<Link id="l03559" /><CodeLine lineNumber="3559"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Attr : CurFunc-&gt;<a href="/docs/api/classes/llvm/function/#a7477aafbbe989ad35b96fac186d8e9fd">getAttributes</a>().getFnAttrs())</Highlight></CodeLine>
<Link id="l03560" /><CodeLine lineNumber="3560"><Highlight kind="normal">    AttrBldr.addAttribute(Attr);</Highlight></CodeLine>
<Link id="l03561" /><CodeLine lineNumber="3561"><Highlight kind="normal">  AttrBldr.removeAttribute(Attribute::OptimizeNone);</Highlight></CodeLine>
<Link id="l03562" /><CodeLine lineNumber="3562"><Highlight kind="normal">  FuncAttrs = FuncAttrs.addFnAttributes(Ctx, AttrBldr);</Highlight></CodeLine>
<Link id="l03563" /><CodeLine lineNumber="3563"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03564" /><CodeLine lineNumber="3564"><Highlight kind="normal">  CodeGenIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03565" /><CodeLine lineNumber="3565"><Highlight kind="normal">  Expected&lt;Function &#42;&gt; ReductionResult =</Highlight></CodeLine>
<Link id="l03566" /><CodeLine lineNumber="3566"><Highlight kind="normal">      createReductionFunction(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>()-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>(),</Highlight></CodeLine>
<Link id="l03567" /><CodeLine lineNumber="3567"><Highlight kind="normal">                              ReductionInfos, ReductionGenCBKind, FuncAttrs);</Highlight></CodeLine>
<Link id="l03568" /><CodeLine lineNumber="3568"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!ReductionResult)</Highlight></CodeLine>
<Link id="l03569" /><CodeLine lineNumber="3569"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ReductionResult.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l03570" /><CodeLine lineNumber="3570"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ReductionFunc = &#42;ReductionResult;</Highlight></CodeLine>
<Link id="l03571" /><CodeLine lineNumber="3571"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l03572" /><CodeLine lineNumber="3572"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03573" /><CodeLine lineNumber="3573"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Set the grid value in the config needed for lowering later on</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03574" /><CodeLine lineNumber="3574"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (GridValue.has&#95;value())</Highlight></CodeLine>
<Link id="l03575" /><CodeLine lineNumber="3575"><Highlight kind="normal">    Config.setGridValue(GridValue.value());</Highlight></CodeLine>
<Link id="l03576" /><CodeLine lineNumber="3576"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03577" /><CodeLine lineNumber="3577"><Highlight kind="normal">    Config.setGridValue(<a href="#ad52342fdd467389643191fdac7abcd40">getGridValue</a>(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, ReductionFunc));</Highlight></CodeLine>
<Link id="l03578" /><CodeLine lineNumber="3578"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03579" /><CodeLine lineNumber="3579"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build res = &#95;&#95;kmpc&#95;reduce&#123;&#95;nowait&#125;(&lt;gtid&gt;, &lt;n&gt;, sizeof(RedList),</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03580" /><CodeLine lineNumber="3580"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// RedList, shuffle&#95;reduce&#95;func, interwarp&#95;copy&#95;func);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03581" /><CodeLine lineNumber="3581"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// or</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03582" /><CodeLine lineNumber="3582"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build res = &#95;&#95;kmpc&#95;reduce&#95;teams&#95;nowait&#95;simple(&lt;loc&gt;, &lt;gtid&gt;, &lt;lck&gt;);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03583" /><CodeLine lineNumber="3583"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Res;</Highlight></CodeLine>
<Link id="l03584" /><CodeLine lineNumber="3584"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03585" /><CodeLine lineNumber="3585"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// 1 Build a list of reduction variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03586" /><CodeLine lineNumber="3586"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// void &#42;RedList&#91;&lt;n&gt;&#93; = &#123;&lt;ReductionVars&gt;&#91;0&#93;, ..., &lt;ReductionVars&gt;&#91;&lt;n&gt;-1&#93;&#125;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03587" /><CodeLine lineNumber="3587"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>();</Highlight></CodeLine>
<Link id="l03588" /><CodeLine lineNumber="3588"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;PtrTy = <a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(Ctx);</Highlight></CodeLine>
<Link id="l03589" /><CodeLine lineNumber="3589"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;RedArrayTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(PtrTy, <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</Highlight></CodeLine>
<Link id="l03590" /><CodeLine lineNumber="3590"><Highlight kind="normal">  CodeGenIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03591" /><CodeLine lineNumber="3591"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l03592" /><CodeLine lineNumber="3592"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReductionListAlloca =</Highlight></CodeLine>
<Link id="l03593" /><CodeLine lineNumber="3593"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(RedArrayTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.omp.reduction.red&#95;list&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03594" /><CodeLine lineNumber="3594"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReductionList = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l03595" /><CodeLine lineNumber="3595"><Highlight kind="normal">      ReductionListAlloca, PtrTy, ReductionListAlloca-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.ascast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03596" /><CodeLine lineNumber="3596"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l03597" /><CodeLine lineNumber="3597"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IndexTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a50cf39b25a9fc8862b6361e22168dce7">getIndexTy</a>(</Highlight></CodeLine>
<Link id="l03598" /><CodeLine lineNumber="3598"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout(), <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l03599" /><CodeLine lineNumber="3599"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03600" /><CodeLine lineNumber="3600"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03601" /><CodeLine lineNumber="3601"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ElemPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l03602" /><CodeLine lineNumber="3602"><Highlight kind="normal">        RedArrayTy, ReductionList,</Highlight></CodeLine>
<Link id="l03603" /><CodeLine lineNumber="3603"><Highlight kind="normal">        &#123;ConstantInt::get(IndexTy, 0), ConstantInt::get(IndexTy, En.index())&#125;);</Highlight></CodeLine>
<Link id="l03604" /><CodeLine lineNumber="3604"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CastElem =</Highlight></CodeLine>
<Link id="l03605" /><CodeLine lineNumber="3605"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(RI.PrivateVariable, PtrTy);</Highlight></CodeLine>
<Link id="l03606" /><CodeLine lineNumber="3606"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(CastElem, ElemPtr);</Highlight></CodeLine>
<Link id="l03607" /><CodeLine lineNumber="3607"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03608" /><CodeLine lineNumber="3608"><Highlight kind="normal">  CodeGenIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03609" /><CodeLine lineNumber="3609"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;SarFunc =</Highlight></CodeLine>
<Link id="l03610" /><CodeLine lineNumber="3610"><Highlight kind="normal">      emitShuffleAndReduceFunction(ReductionInfos, ReductionFunc, FuncAttrs);</Highlight></CodeLine>
<Link id="l03611" /><CodeLine lineNumber="3611"><Highlight kind="normal">  Expected&lt;Function &#42;&gt; CopyResult =</Highlight></CodeLine>
<Link id="l03612" /><CodeLine lineNumber="3612"><Highlight kind="normal">      emitInterWarpCopyFunction(Loc, ReductionInfos, FuncAttrs);</Highlight></CodeLine>
<Link id="l03613" /><CodeLine lineNumber="3613"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CopyResult)</Highlight></CodeLine>
<Link id="l03614" /><CodeLine lineNumber="3614"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> CopyResult.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l03615" /><CodeLine lineNumber="3615"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;WcFunc = &#42;CopyResult;</Highlight></CodeLine>
<Link id="l03616" /><CodeLine lineNumber="3616"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l03617" /><CodeLine lineNumber="3617"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03618" /><CodeLine lineNumber="3618"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RL = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(ReductionList, PtrTy);</Highlight></CodeLine>
<Link id="l03619" /><CodeLine lineNumber="3619"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03620" /><CodeLine lineNumber="3620"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> MaxDataSize = 0;</Highlight></CodeLine>
<Link id="l03621" /><CodeLine lineNumber="3621"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;Type &#42;&gt;</a> ReductionTypeArgs;</Highlight></CodeLine>
<Link id="l03622" /><CodeLine lineNumber="3622"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03623" /><CodeLine lineNumber="3623"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(En.value().ElementType);</Highlight></CodeLine>
<Link id="l03624" /><CodeLine lineNumber="3624"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &gt; MaxDataSize)</Highlight></CodeLine>
<Link id="l03625" /><CodeLine lineNumber="3625"><Highlight kind="normal">      MaxDataSize = <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>;</Highlight></CodeLine>
<Link id="l03626" /><CodeLine lineNumber="3626"><Highlight kind="normal">    ReductionTypeArgs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(En.value().ElementType);</Highlight></CodeLine>
<Link id="l03627" /><CodeLine lineNumber="3627"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03628" /><CodeLine lineNumber="3628"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ReductionDataSize =</Highlight></CodeLine>
<Link id="l03629" /><CodeLine lineNumber="3629"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(MaxDataSize &#42; ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l03630" /><CodeLine lineNumber="3630"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsTeamsReduction) &#123;</Highlight></CodeLine>
<Link id="l03631" /><CodeLine lineNumber="3631"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SarFuncCast =</Highlight></CodeLine>
<Link id="l03632" /><CodeLine lineNumber="3632"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(SarFunc, PtrTy);</Highlight></CodeLine>
<Link id="l03633" /><CodeLine lineNumber="3633"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;WcFuncCast =</Highlight></CodeLine>
<Link id="l03634" /><CodeLine lineNumber="3634"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(WcFunc, PtrTy);</Highlight></CodeLine>
<Link id="l03635" /><CodeLine lineNumber="3635"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;SrcLocInfo, ReductionDataSize, RL, SarFuncCast,</Highlight></CodeLine>
<Link id="l03636" /><CodeLine lineNumber="3636"><Highlight kind="normal">                     WcFuncCast&#125;;</Highlight></CodeLine>
<Link id="l03637" /><CodeLine lineNumber="3637"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Pv2Ptr = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l03638" /><CodeLine lineNumber="3638"><Highlight kind="normal">        RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;nvptx&#95;parallel&#95;reduce&#95;nowait&#95;v2);</Highlight></CodeLine>
<Link id="l03639" /><CodeLine lineNumber="3639"><Highlight kind="normal">    Res = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Pv2Ptr, Args);</Highlight></CodeLine>
<Link id="l03640" /><CodeLine lineNumber="3640"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l03641" /><CodeLine lineNumber="3641"><Highlight kind="normal">    CodeGenIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03642" /><CodeLine lineNumber="3642"><Highlight kind="normal">    StructType &#42;ReductionsBufferTy = <a href="/docs/api/classes/llvm/structtype/#a82648246c07eb8a33f628eea28cb988c">StructType::create</a>(</Highlight></CodeLine>
<Link id="l03643" /><CodeLine lineNumber="3643"><Highlight kind="normal">        Ctx, ReductionTypeArgs, </Highlight><Highlight kind="stringliteral">&quot;struct.&#95;globalized&#95;locals&#95;ty&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03644" /><CodeLine lineNumber="3644"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;RedFixedBuferFn = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l03645" /><CodeLine lineNumber="3645"><Highlight kind="normal">        RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;reduction&#95;get&#95;fixed&#95;buffer);</Highlight></CodeLine>
<Link id="l03646" /><CodeLine lineNumber="3646"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;LtGCFunc = emitListToGlobalCopyFunction(</Highlight></CodeLine>
<Link id="l03647" /><CodeLine lineNumber="3647"><Highlight kind="normal">        ReductionInfos, ReductionsBufferTy, FuncAttrs);</Highlight></CodeLine>
<Link id="l03648" /><CodeLine lineNumber="3648"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;LtGRFunc = emitListToGlobalReduceFunction(</Highlight></CodeLine>
<Link id="l03649" /><CodeLine lineNumber="3649"><Highlight kind="normal">        ReductionInfos, ReductionFunc, ReductionsBufferTy, FuncAttrs);</Highlight></CodeLine>
<Link id="l03650" /><CodeLine lineNumber="3650"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;GtLCFunc = emitGlobalToListCopyFunction(</Highlight></CodeLine>
<Link id="l03651" /><CodeLine lineNumber="3651"><Highlight kind="normal">        ReductionInfos, ReductionsBufferTy, FuncAttrs);</Highlight></CodeLine>
<Link id="l03652" /><CodeLine lineNumber="3652"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;GtLRFunc = emitGlobalToListReduceFunction(</Highlight></CodeLine>
<Link id="l03653" /><CodeLine lineNumber="3653"><Highlight kind="normal">        ReductionInfos, ReductionFunc, ReductionsBufferTy, FuncAttrs);</Highlight></CodeLine>
<Link id="l03654" /><CodeLine lineNumber="3654"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l03655" /><CodeLine lineNumber="3655"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03656" /><CodeLine lineNumber="3656"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;KernelTeamsReductionPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l03657" /><CodeLine lineNumber="3657"><Highlight kind="normal">        RedFixedBuferFn, &#123;&#125;, </Highlight><Highlight kind="stringliteral">&quot;&#95;openmp&#95;teams&#95;reductions&#95;buffer&#95;$&#95;$ptr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03658" /><CodeLine lineNumber="3658"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03659" /><CodeLine lineNumber="3659"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Args3&#91;&#93; = &#123;SrcLocInfo,</Highlight></CodeLine>
<Link id="l03660" /><CodeLine lineNumber="3660"><Highlight kind="normal">                      KernelTeamsReductionPtr,</Highlight></CodeLine>
<Link id="l03661" /><CodeLine lineNumber="3661"><Highlight kind="normal">                      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(ReductionBufNum),</Highlight></CodeLine>
<Link id="l03662" /><CodeLine lineNumber="3662"><Highlight kind="normal">                      ReductionDataSize,</Highlight></CodeLine>
<Link id="l03663" /><CodeLine lineNumber="3663"><Highlight kind="normal">                      RL,</Highlight></CodeLine>
<Link id="l03664" /><CodeLine lineNumber="3664"><Highlight kind="normal">                      SarFunc,</Highlight></CodeLine>
<Link id="l03665" /><CodeLine lineNumber="3665"><Highlight kind="normal">                      WcFunc,</Highlight></CodeLine>
<Link id="l03666" /><CodeLine lineNumber="3666"><Highlight kind="normal">                      LtGCFunc,</Highlight></CodeLine>
<Link id="l03667" /><CodeLine lineNumber="3667"><Highlight kind="normal">                      LtGRFunc,</Highlight></CodeLine>
<Link id="l03668" /><CodeLine lineNumber="3668"><Highlight kind="normal">                      GtLCFunc,</Highlight></CodeLine>
<Link id="l03669" /><CodeLine lineNumber="3669"><Highlight kind="normal">                      GtLRFunc&#125;;</Highlight></CodeLine>
<Link id="l03670" /><CodeLine lineNumber="3670"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03671" /><CodeLine lineNumber="3671"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TeamsReduceFn = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l03672" /><CodeLine lineNumber="3672"><Highlight kind="normal">        RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;nvptx&#95;teams&#95;reduce&#95;nowait&#95;v2);</Highlight></CodeLine>
<Link id="l03673" /><CodeLine lineNumber="3673"><Highlight kind="normal">    Res = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TeamsReduceFn, Args3);</Highlight></CodeLine>
<Link id="l03674" /><CodeLine lineNumber="3674"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03675" /><CodeLine lineNumber="3675"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03676" /><CodeLine lineNumber="3676"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// 5 Build if (res == 1)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03677" /><CodeLine lineNumber="3677"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ExitBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;.omp.reduction.done&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03678" /><CodeLine lineNumber="3678"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ThenBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;.omp.reduction.then&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03679" /><CodeLine lineNumber="3679"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(Res, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(1));</Highlight></CodeLine>
<Link id="l03680" /><CodeLine lineNumber="3680"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, ThenBB, ExitBB);</Highlight></CodeLine>
<Link id="l03681" /><CodeLine lineNumber="3681"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03682" /><CodeLine lineNumber="3682"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// 6 Build then branch: where we have reduced values in the master</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03683" /><CodeLine lineNumber="3683"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    thread in each team.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03684" /><CodeLine lineNumber="3684"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    &#95;&#95;kmpc&#95;end&#95;reduce&#123;&#95;nowait&#125;(&lt;gtid&gt;);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03685" /><CodeLine lineNumber="3685"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    break;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03686" /><CodeLine lineNumber="3686"><Highlight kind="normal">  emitBlock(ThenBB, CurFunc);</Highlight></CodeLine>
<Link id="l03687" /><CodeLine lineNumber="3687"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03688" /><CodeLine lineNumber="3688"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add emission of &#95;&#95;kmpc&#95;end&#95;reduce&#123;&#95;nowait&#125;(&lt;gtid&gt;);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03689" /><CodeLine lineNumber="3689"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03690" /><CodeLine lineNumber="3690"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03691" /><CodeLine lineNumber="3691"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = RI.Variable;</Highlight></CodeLine>
<Link id="l03692" /><CodeLine lineNumber="3692"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> =</Highlight></CodeLine>
<Link id="l03693" /><CodeLine lineNumber="3693"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(RI.PrivateVariable, PtrTy);</Highlight></CodeLine>
<Link id="l03694" /><CodeLine lineNumber="3694"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03695" /><CodeLine lineNumber="3695"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ReductionGenCBKind == ReductionGenCBKind::Clang) &#123;</Highlight></CodeLine>
<Link id="l03696" /><CodeLine lineNumber="3696"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSPtr, &#42;RHSPtr;</Highlight></CodeLine>
<Link id="l03697" /><CodeLine lineNumber="3697"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(RI.ReductionGenClang(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), En.index(),</Highlight></CodeLine>
<Link id="l03698" /><CodeLine lineNumber="3698"><Highlight kind="normal">                                             &amp;LHSPtr, &amp;RHSPtr, CurFunc));</Highlight></CodeLine>
<Link id="l03699" /><CodeLine lineNumber="3699"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03700" /><CodeLine lineNumber="3700"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Fix the CallBack code genereated to use the correct Values for the LHS</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03701" /><CodeLine lineNumber="3701"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// and RHS</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03702" /><CodeLine lineNumber="3702"><Highlight kind="normal">      LHSPtr-&gt;<a href="/docs/api/classes/llvm/value/#a7e8dad1701aa6445be4a29f654b0473c">replaceUsesWithIf</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, &#91;ReductionFunc&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Use &amp;U) &#123;</Highlight></CodeLine>
<Link id="l03703" /><CodeLine lineNumber="3703"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser())-&gt;getParent()-&gt;getParent() ==</Highlight></CodeLine>
<Link id="l03704" /><CodeLine lineNumber="3704"><Highlight kind="normal">               ReductionFunc;</Highlight></CodeLine>
<Link id="l03705" /><CodeLine lineNumber="3705"><Highlight kind="normal">      &#125;);</Highlight></CodeLine>
<Link id="l03706" /><CodeLine lineNumber="3706"><Highlight kind="normal">      RHSPtr-&gt;<a href="/docs/api/classes/llvm/value/#a7e8dad1701aa6445be4a29f654b0473c">replaceUsesWithIf</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, &#91;ReductionFunc&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Use &amp;U) &#123;</Highlight></CodeLine>
<Link id="l03707" /><CodeLine lineNumber="3707"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser())-&gt;getParent()-&gt;getParent() ==</Highlight></CodeLine>
<Link id="l03708" /><CodeLine lineNumber="3708"><Highlight kind="normal">               ReductionFunc;</Highlight></CodeLine>
<Link id="l03709" /><CodeLine lineNumber="3709"><Highlight kind="normal">      &#125;);</Highlight></CodeLine>
<Link id="l03710" /><CodeLine lineNumber="3710"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l03711" /><CodeLine lineNumber="3711"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal"> &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Unhandled ReductionGenCBKind&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03712" /><CodeLine lineNumber="3712"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03713" /><CodeLine lineNumber="3713"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03714" /><CodeLine lineNumber="3714"><Highlight kind="normal">  emitBlock(ExitBB, CurFunc);</Highlight></CodeLine>
<Link id="l03715" /><CodeLine lineNumber="3715"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03716" /><CodeLine lineNumber="3716"><Highlight kind="normal">  Config.setEmitLLVMUsed();</Highlight></CodeLine>
<Link id="l03717" /><CodeLine lineNumber="3717"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03718" /><CodeLine lineNumber="3718"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03719" /><CodeLine lineNumber="3719"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03720" /><CodeLine lineNumber="3720"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03721" /><CodeLine lineNumber="3721" lineLink="#a669fae0a15d7219ef3ca3f3b16e3f5a0"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="#a669fae0a15d7219ef3ca3f3b16e3f5a0">getFreshReductionFunc</a>(<a href="/docs/api/classes/llvm/module">Module</a> &amp;M) &#123;</Highlight></CodeLine>
<Link id="l03722" /><CodeLine lineNumber="3722"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;VoidTy = <a href="/docs/api/classes/llvm/type/#a6e20e76960d952de088354cbcd14c3ab">Type::getVoidTy</a>(M.getContext());</Highlight></CodeLine>
<Link id="l03723" /><CodeLine lineNumber="3723"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;Int8PtrTy = <a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(M.getContext());</Highlight></CodeLine>
<Link id="l03724" /><CodeLine lineNumber="3724"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;FuncTy =</Highlight></CodeLine>
<Link id="l03725" /><CodeLine lineNumber="3725"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(VoidTy, &#123;Int8PtrTy, Int8PtrTy&#125;, </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03726" /><CodeLine lineNumber="3726"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalVariable::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l03727" /><CodeLine lineNumber="3727"><Highlight kind="normal">                          </Highlight><Highlight kind="stringliteral">&quot;.omp.reduction.func&quot;</Highlight><Highlight kind="normal">, &amp;M);</Highlight></CodeLine>
<Link id="l03728" /><CodeLine lineNumber="3728"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03729" /><CodeLine lineNumber="3729"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03730" /><CodeLine lineNumber="3730"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l03731" /><CodeLine lineNumber="3731"><Highlight kind="normal">OpenMPIRBuilder::createReductions(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l03732" /><CodeLine lineNumber="3732"><Highlight kind="normal">                                  InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l03733" /><CodeLine lineNumber="3733"><Highlight kind="normal">                                  <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;ReductionInfo&gt;</a> ReductionInfos,</Highlight></CodeLine>
<Link id="l03734" /><CodeLine lineNumber="3734"><Highlight kind="normal">                                  <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;bool&gt;</a> IsByRef, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsNoWait) &#123;</Highlight></CodeLine>
<Link id="l03735" /><CodeLine lineNumber="3735"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ReductionInfos.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>() == IsByRef.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>());</Highlight></CodeLine>
<Link id="l03736" /><CodeLine lineNumber="3736"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI : ReductionInfos) &#123;</Highlight></CodeLine>
<Link id="l03737" /><CodeLine lineNumber="3737"><Highlight kind="normal">    (void)RI;</Highlight></CodeLine>
<Link id="l03738" /><CodeLine lineNumber="3738"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.Variable &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;expected non-null variable&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03739" /><CodeLine lineNumber="3739"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.PrivateVariable &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;expected non-null private variable&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03740" /><CodeLine lineNumber="3740"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.ReductionGen &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;expected non-null reduction generator callback&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03741" /><CodeLine lineNumber="3741"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.Variable-&gt;getType() == RI.PrivateVariable-&gt;getType() &amp;&amp;</Highlight></CodeLine>
<Link id="l03742" /><CodeLine lineNumber="3742"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;expected variables and their private equivalents to have the same &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03743" /><CodeLine lineNumber="3743"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03744" /><CodeLine lineNumber="3744"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RI.Variable-&gt;getType()-&gt;isPointerTy() &amp;&amp;</Highlight></CodeLine>
<Link id="l03745" /><CodeLine lineNumber="3745"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;expected variables to be pointers&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03746" /><CodeLine lineNumber="3746"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03747" /><CodeLine lineNumber="3747"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03748" /><CodeLine lineNumber="3748"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l03749" /><CodeLine lineNumber="3749"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l03750" /><CodeLine lineNumber="3750"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03751" /><CodeLine lineNumber="3751"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;InsertBlock = Loc.IP.getBlock();</Highlight></CodeLine>
<Link id="l03752" /><CodeLine lineNumber="3752"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ContinuationBlock =</Highlight></CodeLine>
<Link id="l03753" /><CodeLine lineNumber="3753"><Highlight kind="normal">      InsertBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(Loc.IP.getPoint(), </Highlight><Highlight kind="stringliteral">&quot;reduce.finalize&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03754" /><CodeLine lineNumber="3754"><Highlight kind="normal">  InsertBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l03755" /><CodeLine lineNumber="3755"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03756" /><CodeLine lineNumber="3756"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create and populate array of type-erased pointers to private reduction</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03757" /><CodeLine lineNumber="3757"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// values.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03758" /><CodeLine lineNumber="3758"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumReductions = ReductionInfos.size();</Highlight></CodeLine>
<Link id="l03759" /><CodeLine lineNumber="3759"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;RedArrayTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), NumReductions);</Highlight></CodeLine>
<Link id="l03760" /><CodeLine lineNumber="3760"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(AllocaIP.getBlock()-&gt;getTerminator());</Highlight></CodeLine>
<Link id="l03761" /><CodeLine lineNumber="3761"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RedArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(RedArrayTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;red.array&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03762" /><CodeLine lineNumber="3762"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03763" /><CodeLine lineNumber="3763"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(InsertBlock, InsertBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>());</Highlight></CodeLine>
<Link id="l03764" /><CodeLine lineNumber="3764"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03765" /><CodeLine lineNumber="3765"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03766" /><CodeLine lineNumber="3766"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/dwarf/#a5d3c920b66ea797d6adb243862fdf47a">Index</a> = En.index();</Highlight></CodeLine>
<Link id="l03767" /><CodeLine lineNumber="3767"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03768" /><CodeLine lineNumber="3768"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RedArrayElemPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa8ee5dc4e4a1b26c4bdf1a574eefe2fc">CreateConstInBoundsGEP2&#95;64</a>(</Highlight></CodeLine>
<Link id="l03769" /><CodeLine lineNumber="3769"><Highlight kind="normal">        RedArrayTy, RedArray, 0, Index, </Highlight><Highlight kind="stringliteral">&quot;red.array.elem.&quot;</Highlight><Highlight kind="normal"> + Twine(Index));</Highlight></CodeLine>
<Link id="l03770" /><CodeLine lineNumber="3770"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(RI.PrivateVariable, RedArrayElemPtr);</Highlight></CodeLine>
<Link id="l03771" /><CodeLine lineNumber="3771"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03772" /><CodeLine lineNumber="3772"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03773" /><CodeLine lineNumber="3773"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit a call to the runtime function that orchestrates the reduction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03774" /><CodeLine lineNumber="3774"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Declare the reduction function in the process.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03775" /><CodeLine lineNumber="3775"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;<a href="/docs/api/namespaces/llvm/rdf/#ad43aeb5ac76bcef25986fbb0918d1165">Func</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l03776" /><CodeLine lineNumber="3776"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/machinecheckdebugify-cpp/#a85892acfa8970627e9bd9c9815f15c25">Module</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinecheckdebugify-cpp/#a85892acfa8970627e9bd9c9815f15c25">Module</a> = <a href="/docs/api/namespaces/llvm/rdf/#ad43aeb5ac76bcef25986fbb0918d1165">Func</a>-&gt;getParent();</Highlight></CodeLine>
<Link id="l03777" /><CodeLine lineNumber="3777"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l03778" /><CodeLine lineNumber="3778"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l03779" /><CodeLine lineNumber="3779"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> CanGenerateAtomic = <a href="/docs/api/namespaces/llvm/#a0d10fe510ced2849a8074fe81e5d04ce">all&#95;of</a>(ReductionInfos, &#91;&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI) &#123;</Highlight></CodeLine>
<Link id="l03780" /><CodeLine lineNumber="3780"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RI.AtomicReductionGen;</Highlight></CodeLine>
<Link id="l03781" /><CodeLine lineNumber="3781"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l03782" /><CodeLine lineNumber="3782"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize,</Highlight></CodeLine>
<Link id="l03783" /><CodeLine lineNumber="3783"><Highlight kind="normal">                                  CanGenerateAtomic</Highlight></CodeLine>
<Link id="l03784" /><CodeLine lineNumber="3784"><Highlight kind="normal">                                      ? IdentFlag::OMP&#95;IDENT&#95;FLAG&#95;ATOMIC&#95;REDUCE</Highlight></CodeLine>
<Link id="l03785" /><CodeLine lineNumber="3785"><Highlight kind="normal">                                      : <a href="/docs/api/namespaces/llvm/omp/#a0e821d8251c97d66ca185efe2f8ffde2">IdentFlag</a>(0));</Highlight></CodeLine>
<Link id="l03786" /><CodeLine lineNumber="3786"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l03787" /><CodeLine lineNumber="3787"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;NumVariables = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(NumReductions);</Highlight></CodeLine>
<Link id="l03788" /><CodeLine lineNumber="3788"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> DataLayout &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a href="/docs/api/files/lib/lib/codegen/machinecheckdebugify-cpp/#a85892acfa8970627e9bd9c9815f15c25">Module</a>-&gt;getDataLayout();</Highlight></CodeLine>
<Link id="l03789" /><CodeLine lineNumber="3789"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> RedArrayByteSize = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getTypeStoreSize(RedArrayTy);</Highlight></CodeLine>
<Link id="l03790" /><CodeLine lineNumber="3790"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;RedArraySize = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(RedArrayByteSize);</Highlight></CodeLine>
<Link id="l03791" /><CodeLine lineNumber="3791"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ReductionFunc = <a href="#a669fae0a15d7219ef3ca3f3b16e3f5a0">getFreshReductionFunc</a>(&#42;<a href="/docs/api/files/lib/lib/codegen/machinecheckdebugify-cpp/#a85892acfa8970627e9bd9c9815f15c25">Module</a>);</Highlight></CodeLine>
<Link id="l03792" /><CodeLine lineNumber="3792"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Lock = getOMPCriticalRegionLock(</Highlight><Highlight kind="stringliteral">&quot;.reduction&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03793" /><CodeLine lineNumber="3793"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ReduceFunc = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l03794" /><CodeLine lineNumber="3794"><Highlight kind="normal">      IsNoWait ? RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;reduce&#95;nowait</Highlight></CodeLine>
<Link id="l03795" /><CodeLine lineNumber="3795"><Highlight kind="normal">               : RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;reduce);</Highlight></CodeLine>
<Link id="l03796" /><CodeLine lineNumber="3796"><Highlight kind="normal">  CallInst &#42;ReduceCall =</Highlight></CodeLine>
<Link id="l03797" /><CodeLine lineNumber="3797"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ReduceFunc,</Highlight></CodeLine>
<Link id="l03798" /><CodeLine lineNumber="3798"><Highlight kind="normal">                         &#123;Ident, ThreadId, NumVariables, RedArraySize, RedArray,</Highlight></CodeLine>
<Link id="l03799" /><CodeLine lineNumber="3799"><Highlight kind="normal">                          ReductionFunc, Lock&#125;,</Highlight></CodeLine>
<Link id="l03800" /><CodeLine lineNumber="3800"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;reduce&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03801" /><CodeLine lineNumber="3801"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03802" /><CodeLine lineNumber="3802"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create final reduction entry blocks for the atomic and non-atomic case.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03803" /><CodeLine lineNumber="3803"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit IR that dispatches control flow to one of the blocks based on the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03804" /><CodeLine lineNumber="3804"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// reduction supporting the atomic mode.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03805" /><CodeLine lineNumber="3805"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;NonAtomicRedBlock =</Highlight></CodeLine>
<Link id="l03806" /><CodeLine lineNumber="3806"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/files/lib/lib/codegen/machinecheckdebugify-cpp/#a85892acfa8970627e9bd9c9815f15c25">Module</a>-&gt;getContext(), </Highlight><Highlight kind="stringliteral">&quot;reduce.switch.nonatomic&quot;</Highlight><Highlight kind="normal">, Func);</Highlight></CodeLine>
<Link id="l03807" /><CodeLine lineNumber="3807"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;AtomicRedBlock =</Highlight></CodeLine>
<Link id="l03808" /><CodeLine lineNumber="3808"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/files/lib/lib/codegen/machinecheckdebugify-cpp/#a85892acfa8970627e9bd9c9815f15c25">Module</a>-&gt;getContext(), </Highlight><Highlight kind="stringliteral">&quot;reduce.switch.atomic&quot;</Highlight><Highlight kind="normal">, Func);</Highlight></CodeLine>
<Link id="l03809" /><CodeLine lineNumber="3809"><Highlight kind="normal">  SwitchInst &#42;<a href="/docs/api/namespaces/llvm/coro/#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a> =</Highlight></CodeLine>
<Link id="l03810" /><CodeLine lineNumber="3810"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8b123015de85b2f41b0deda2aeaad9d3">CreateSwitch</a>(ReduceCall, ContinuationBlock, </Highlight><Highlight kind="comment">/&#42; NumCases &#42;/</Highlight><Highlight kind="normal"> 2);</Highlight></CodeLine>
<Link id="l03811" /><CodeLine lineNumber="3811"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/coro/#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a>-&gt;addCase(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(1), NonAtomicRedBlock);</Highlight></CodeLine>
<Link id="l03812" /><CodeLine lineNumber="3812"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/coro/#a36a5e731a6e92a83c26e5fee63d12380abbc155fb2b111bf61c4f5ff892915e6b">Switch</a>-&gt;addCase(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(2), AtomicRedBlock);</Highlight></CodeLine>
<Link id="l03813" /><CodeLine lineNumber="3813"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03814" /><CodeLine lineNumber="3814"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Populate the non-atomic reduction using the elementwise reduction function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03815" /><CodeLine lineNumber="3815"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This loads the elements from the global and private variables and reduces</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03816" /><CodeLine lineNumber="3816"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// them before storing back the result to the global variable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03817" /><CodeLine lineNumber="3817"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(NonAtomicRedBlock);</Highlight></CodeLine>
<Link id="l03818" /><CodeLine lineNumber="3818"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03819" /><CodeLine lineNumber="3819"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03820" /><CodeLine lineNumber="3820"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;<a href="/docs/api/namespaces/llvm/#ad18871060ac1b051c7322cc6ad71e11c">ValueType</a> = RI.ElementType;</Highlight></CodeLine>
<Link id="l03821" /><CodeLine lineNumber="3821"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// We have one less load for by-ref case because that load is now inside of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03822" /><CodeLine lineNumber="3822"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the reduction region</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03823" /><CodeLine lineNumber="3823"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RedValue = RI.Variable;</Highlight></CodeLine>
<Link id="l03824" /><CodeLine lineNumber="3824"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsByRef&#91;En.index()&#93;) &#123;</Highlight></CodeLine>
<Link id="l03825" /><CodeLine lineNumber="3825"><Highlight kind="normal">      RedValue = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(<a href="/docs/api/namespaces/llvm/#ad18871060ac1b051c7322cc6ad71e11c">ValueType</a>, RI.Variable,</Highlight></CodeLine>
<Link id="l03826" /><CodeLine lineNumber="3826"><Highlight kind="normal">                                    </Highlight><Highlight kind="stringliteral">&quot;red.value.&quot;</Highlight><Highlight kind="normal"> + Twine(En.index()));</Highlight></CodeLine>
<Link id="l03827" /><CodeLine lineNumber="3827"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03828" /><CodeLine lineNumber="3828"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PrivateRedValue =</Highlight></CodeLine>
<Link id="l03829" /><CodeLine lineNumber="3829"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(<a href="/docs/api/namespaces/llvm/#ad18871060ac1b051c7322cc6ad71e11c">ValueType</a>, RI.PrivateVariable,</Highlight></CodeLine>
<Link id="l03830" /><CodeLine lineNumber="3830"><Highlight kind="normal">                           </Highlight><Highlight kind="stringliteral">&quot;red.private.value.&quot;</Highlight><Highlight kind="normal"> + Twine(En.index()));</Highlight></CodeLine>
<Link id="l03831" /><CodeLine lineNumber="3831"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Reduced;</Highlight></CodeLine>
<Link id="l03832" /><CodeLine lineNumber="3832"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l03833" /><CodeLine lineNumber="3833"><Highlight kind="normal">        RI.ReductionGen(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), RedValue, PrivateRedValue, Reduced);</Highlight></CodeLine>
<Link id="l03834" /><CodeLine lineNumber="3834"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l03835" /><CodeLine lineNumber="3835"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l03836" /><CodeLine lineNumber="3836"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l03837" /><CodeLine lineNumber="3837"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03838" /><CodeLine lineNumber="3838"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>())</Highlight></CodeLine>
<Link id="l03839" /><CodeLine lineNumber="3839"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l03840" /><CodeLine lineNumber="3840"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// for by-ref case, the load is inside of the reduction region</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03841" /><CodeLine lineNumber="3841"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsByRef&#91;En.index()&#93;)</Highlight></CodeLine>
<Link id="l03842" /><CodeLine lineNumber="3842"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Reduced, RI.Variable);</Highlight></CodeLine>
<Link id="l03843" /><CodeLine lineNumber="3843"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03844" /><CodeLine lineNumber="3844"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;EndReduceFunc = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l03845" /><CodeLine lineNumber="3845"><Highlight kind="normal">      IsNoWait ? RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;end&#95;reduce&#95;nowait</Highlight></CodeLine>
<Link id="l03846" /><CodeLine lineNumber="3846"><Highlight kind="normal">               : RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;end&#95;reduce);</Highlight></CodeLine>
<Link id="l03847" /><CodeLine lineNumber="3847"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(EndReduceFunc, &#123;Ident, ThreadId, Lock&#125;);</Highlight></CodeLine>
<Link id="l03848" /><CodeLine lineNumber="3848"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(ContinuationBlock);</Highlight></CodeLine>
<Link id="l03849" /><CodeLine lineNumber="3849"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03850" /><CodeLine lineNumber="3850"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Populate the atomic reduction using the atomic elementwise reduction</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03851" /><CodeLine lineNumber="3851"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// function. There are no loads/stores here because they will be happening</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03852" /><CodeLine lineNumber="3852"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// inside the atomic elementwise reduction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03853" /><CodeLine lineNumber="3853"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(AtomicRedBlock);</Highlight></CodeLine>
<Link id="l03854" /><CodeLine lineNumber="3854"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CanGenerateAtomic &amp;&amp; <a href="/docs/api/namespaces/llvm/#a7dc3069afa2ce5ea62ac2eb183e51c00">llvm::none&#95;of</a>(IsByRef, &#91;&#93;(</Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>) &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>; &#125;)) &#123;</Highlight></CodeLine>
<Link id="l03855" /><CodeLine lineNumber="3855"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI : ReductionInfos) &#123;</Highlight></CodeLine>
<Link id="l03856" /><CodeLine lineNumber="3856"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP = RI.AtomicReductionGen(</Highlight></CodeLine>
<Link id="l03857" /><CodeLine lineNumber="3857"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), RI.ElementType, RI.Variable, RI.PrivateVariable);</Highlight></CodeLine>
<Link id="l03858" /><CodeLine lineNumber="3858"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l03859" /><CodeLine lineNumber="3859"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l03860" /><CodeLine lineNumber="3860"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l03861" /><CodeLine lineNumber="3861"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>())</Highlight></CodeLine>
<Link id="l03862" /><CodeLine lineNumber="3862"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l03863" /><CodeLine lineNumber="3863"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03864" /><CodeLine lineNumber="3864"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(ContinuationBlock);</Highlight></CodeLine>
<Link id="l03865" /><CodeLine lineNumber="3865"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l03866" /><CodeLine lineNumber="3866"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a39acc29443d48968a798fb22a76fa4c0">CreateUnreachable</a>();</Highlight></CodeLine>
<Link id="l03867" /><CodeLine lineNumber="3867"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03868" /><CodeLine lineNumber="3868"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03869" /><CodeLine lineNumber="3869"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Populate the outlined reduction function using the elementwise reduction</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03870" /><CodeLine lineNumber="3870"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// function. Partial values are extracted from the type-erased array of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03871" /><CodeLine lineNumber="3871"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// pointers to private variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03872" /><CodeLine lineNumber="3872"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ReductionFuncBlock =</Highlight></CodeLine>
<Link id="l03873" /><CodeLine lineNumber="3873"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/files/lib/lib/codegen/machinecheckdebugify-cpp/#a85892acfa8970627e9bd9c9815f15c25">Module</a>-&gt;getContext(), </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">, ReductionFunc);</Highlight></CodeLine>
<Link id="l03874" /><CodeLine lineNumber="3874"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ReductionFuncBlock);</Highlight></CodeLine>
<Link id="l03875" /><CodeLine lineNumber="3875"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSArrayPtr = ReductionFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l03876" /><CodeLine lineNumber="3876"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSArrayPtr = ReductionFunc-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l03877" /><CodeLine lineNumber="3877"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03878" /><CodeLine lineNumber="3878"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> En : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(ReductionInfos)) &#123;</Highlight></CodeLine>
<Link id="l03879" /><CodeLine lineNumber="3879"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ReductionInfo &amp;RI = En.value();</Highlight></CodeLine>
<Link id="l03880" /><CodeLine lineNumber="3880"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSI8PtrPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa8ee5dc4e4a1b26c4bdf1a574eefe2fc">CreateConstInBoundsGEP2&#95;64</a>(</Highlight></CodeLine>
<Link id="l03881" /><CodeLine lineNumber="3881"><Highlight kind="normal">        RedArrayTy, LHSArrayPtr, 0, En.index());</Highlight></CodeLine>
<Link id="l03882" /><CodeLine lineNumber="3882"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSI8Ptr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), LHSI8PtrPtr);</Highlight></CodeLine>
<Link id="l03883" /><CodeLine lineNumber="3883"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LHSPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(LHSI8Ptr, RI.Variable-&gt;getType());</Highlight></CodeLine>
<Link id="l03884" /><CodeLine lineNumber="3884"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(RI.ElementType, LHSPtr);</Highlight></CodeLine>
<Link id="l03885" /><CodeLine lineNumber="3885"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSI8PtrPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa8ee5dc4e4a1b26c4bdf1a574eefe2fc">CreateConstInBoundsGEP2&#95;64</a>(</Highlight></CodeLine>
<Link id="l03886" /><CodeLine lineNumber="3886"><Highlight kind="normal">        RedArrayTy, RHSArrayPtr, 0, En.index());</Highlight></CodeLine>
<Link id="l03887" /><CodeLine lineNumber="3887"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSI8Ptr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), RHSI8PtrPtr);</Highlight></CodeLine>
<Link id="l03888" /><CodeLine lineNumber="3888"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;RHSPtr =</Highlight></CodeLine>
<Link id="l03889" /><CodeLine lineNumber="3889"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(RHSI8Ptr, RI.PrivateVariable-&gt;getType());</Highlight></CodeLine>
<Link id="l03890" /><CodeLine lineNumber="3890"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(RI.ElementType, RHSPtr);</Highlight></CodeLine>
<Link id="l03891" /><CodeLine lineNumber="3891"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Reduced;</Highlight></CodeLine>
<Link id="l03892" /><CodeLine lineNumber="3892"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l03893" /><CodeLine lineNumber="3893"><Highlight kind="normal">        RI.ReductionGen(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, Reduced);</Highlight></CodeLine>
<Link id="l03894" /><CodeLine lineNumber="3894"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l03895" /><CodeLine lineNumber="3895"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l03896" /><CodeLine lineNumber="3896"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l03897" /><CodeLine lineNumber="3897"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>())</Highlight></CodeLine>
<Link id="l03898" /><CodeLine lineNumber="3898"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l03899" /><CodeLine lineNumber="3899"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// store is inside of the reduction region when using by-ref</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03900" /><CodeLine lineNumber="3900"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsByRef&#91;En.index()&#93;)</Highlight></CodeLine>
<Link id="l03901" /><CodeLine lineNumber="3901"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Reduced, LHSPtr);</Highlight></CodeLine>
<Link id="l03902" /><CodeLine lineNumber="3902"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03903" /><CodeLine lineNumber="3903"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l03904" /><CodeLine lineNumber="3904"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03905" /><CodeLine lineNumber="3905"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ContinuationBlock);</Highlight></CodeLine>
<Link id="l03906" /><CodeLine lineNumber="3906"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l03907" /><CodeLine lineNumber="3907"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03908" /><CodeLine lineNumber="3908"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03909" /><CodeLine lineNumber="3909"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l03910" /><CodeLine lineNumber="3910"><Highlight kind="normal">OpenMPIRBuilder::createMaster(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l03911" /><CodeLine lineNumber="3911"><Highlight kind="normal">                              BodyGenCallbackTy BodyGenCB,</Highlight></CodeLine>
<Link id="l03912" /><CodeLine lineNumber="3912"><Highlight kind="normal">                              FinalizeCallbackTy FiniCB) &#123;</Highlight></CodeLine>
<Link id="l03913" /><CodeLine lineNumber="3913"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l03914" /><CodeLine lineNumber="3914"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l03915" /><CodeLine lineNumber="3915"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03916" /><CodeLine lineNumber="3916"><Highlight kind="normal">  Directive OMPD = Directive::OMPD&#95;master;</Highlight></CodeLine>
<Link id="l03917" /><CodeLine lineNumber="3917"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l03918" /><CodeLine lineNumber="3918"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l03919" /><CodeLine lineNumber="3919"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l03920" /><CodeLine lineNumber="3920"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l03921" /><CodeLine lineNumber="3921"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;Ident, ThreadId&#125;;</Highlight></CodeLine>
<Link id="l03922" /><CodeLine lineNumber="3922"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03923" /><CodeLine lineNumber="3923"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;EntryRTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;master);</Highlight></CodeLine>
<Link id="l03924" /><CodeLine lineNumber="3924"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;EntryCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(EntryRTLFn, Args);</Highlight></CodeLine>
<Link id="l03925" /><CodeLine lineNumber="3925"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03926" /><CodeLine lineNumber="3926"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ExitRTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;end&#95;master);</Highlight></CodeLine>
<Link id="l03927" /><CodeLine lineNumber="3927"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;ExitCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ExitRTLFn, Args);</Highlight></CodeLine>
<Link id="l03928" /><CodeLine lineNumber="3928"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03929" /><CodeLine lineNumber="3929"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EmitOMPInlinedRegion(OMPD, EntryCall, ExitCall, BodyGenCB, FiniCB,</Highlight></CodeLine>
<Link id="l03930" /><CodeLine lineNumber="3930"><Highlight kind="normal">                              </Highlight><Highlight kind="comment">/&#42;Conditional&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;hasFinalize&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03931" /><CodeLine lineNumber="3931"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03932" /><CodeLine lineNumber="3932"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03933" /><CodeLine lineNumber="3933"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l03934" /><CodeLine lineNumber="3934"><Highlight kind="normal">OpenMPIRBuilder::createMasked(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l03935" /><CodeLine lineNumber="3935"><Highlight kind="normal">                              BodyGenCallbackTy BodyGenCB,</Highlight></CodeLine>
<Link id="l03936" /><CodeLine lineNumber="3936"><Highlight kind="normal">                              FinalizeCallbackTy FiniCB, <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/#aaee5189b9c4db9ad666a88abaf1ee0c4ad7778d0c64b6ba21494c97f77a66885a">Filter</a>) &#123;</Highlight></CodeLine>
<Link id="l03937" /><CodeLine lineNumber="3937"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l03938" /><CodeLine lineNumber="3938"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l03939" /><CodeLine lineNumber="3939"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03940" /><CodeLine lineNumber="3940"><Highlight kind="normal">  Directive OMPD = Directive::OMPD&#95;masked;</Highlight></CodeLine>
<Link id="l03941" /><CodeLine lineNumber="3941"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l03942" /><CodeLine lineNumber="3942"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l03943" /><CodeLine lineNumber="3943"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l03944" /><CodeLine lineNumber="3944"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l03945" /><CodeLine lineNumber="3945"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;Ident, ThreadId, <a href="/docs/api/namespaces/llvm/#aaee5189b9c4db9ad666a88abaf1ee0c4ad7778d0c64b6ba21494c97f77a66885a">Filter</a>&#125;;</Highlight></CodeLine>
<Link id="l03946" /><CodeLine lineNumber="3946"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ArgsEnd&#91;&#93; = &#123;Ident, ThreadId&#125;;</Highlight></CodeLine>
<Link id="l03947" /><CodeLine lineNumber="3947"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03948" /><CodeLine lineNumber="3948"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;EntryRTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;masked);</Highlight></CodeLine>
<Link id="l03949" /><CodeLine lineNumber="3949"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;EntryCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(EntryRTLFn, Args);</Highlight></CodeLine>
<Link id="l03950" /><CodeLine lineNumber="3950"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03951" /><CodeLine lineNumber="3951"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ExitRTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;end&#95;masked);</Highlight></CodeLine>
<Link id="l03952" /><CodeLine lineNumber="3952"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;ExitCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ExitRTLFn, ArgsEnd);</Highlight></CodeLine>
<Link id="l03953" /><CodeLine lineNumber="3953"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03954" /><CodeLine lineNumber="3954"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EmitOMPInlinedRegion(OMPD, EntryCall, ExitCall, BodyGenCB, FiniCB,</Highlight></CodeLine>
<Link id="l03955" /><CodeLine lineNumber="3955"><Highlight kind="normal">                              </Highlight><Highlight kind="comment">/&#42;Conditional&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;hasFinalize&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03956" /><CodeLine lineNumber="3956"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03957" /><CodeLine lineNumber="3957"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03958" /><CodeLine lineNumber="3958" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a445fa52d77040bccb16bfea111234a2e"><Highlight kind="normal"><a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;<a href="/docs/api/classes/llvm/openmpirbuilder/#a445fa52d77040bccb16bfea111234a2e">OpenMPIRBuilder::createLoopSkeleton</a>(</Highlight></CodeLine>
<Link id="l03959" /><CodeLine lineNumber="3959"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount, <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PreInsertBefore,</Highlight></CodeLine>
<Link id="l03960" /><CodeLine lineNumber="3960"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PostInsertBefore, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp;Name) &#123;</Highlight></CodeLine>
<Link id="l03961" /><CodeLine lineNumber="3961"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/module">Module</a> &#42;M = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getParent();</Highlight></CodeLine>
<Link id="l03962" /><CodeLine lineNumber="3962"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = M-&gt;getContext();</Highlight></CodeLine>
<Link id="l03963" /><CodeLine lineNumber="3963"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IndVarTy = TripCount-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l03964" /><CodeLine lineNumber="3964"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03965" /><CodeLine lineNumber="3965"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create the basic block structure.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03966" /><CodeLine lineNumber="3966"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Preheader =</Highlight></CodeLine>
<Link id="l03967" /><CodeLine lineNumber="3967"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.preheader&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PreInsertBefore);</Highlight></CodeLine>
<Link id="l03968" /><CodeLine lineNumber="3968"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Header =</Highlight></CodeLine>
<Link id="l03969" /><CodeLine lineNumber="3969"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.header&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PreInsertBefore);</Highlight></CodeLine>
<Link id="l03970" /><CodeLine lineNumber="3970"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> =</Highlight></CodeLine>
<Link id="l03971" /><CodeLine lineNumber="3971"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.cond&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PreInsertBefore);</Highlight></CodeLine>
<Link id="l03972" /><CodeLine lineNumber="3972"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Body =</Highlight></CodeLine>
<Link id="l03973" /><CodeLine lineNumber="3973"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.body&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PreInsertBefore);</Highlight></CodeLine>
<Link id="l03974" /><CodeLine lineNumber="3974"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Latch =</Highlight></CodeLine>
<Link id="l03975" /><CodeLine lineNumber="3975"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.inc&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PostInsertBefore);</Highlight></CodeLine>
<Link id="l03976" /><CodeLine lineNumber="3976"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Exit =</Highlight></CodeLine>
<Link id="l03977" /><CodeLine lineNumber="3977"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.exit&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PostInsertBefore);</Highlight></CodeLine>
<Link id="l03978" /><CodeLine lineNumber="3978"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a> =</Highlight></CodeLine>
<Link id="l03979" /><CodeLine lineNumber="3979"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.after&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, PostInsertBefore);</Highlight></CodeLine>
<Link id="l03980" /><CodeLine lineNumber="3980"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03981" /><CodeLine lineNumber="3981"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Use specified DebugLoc for new instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03982" /><CodeLine lineNumber="3982"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l03983" /><CodeLine lineNumber="3983"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03984" /><CodeLine lineNumber="3984"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Preheader);</Highlight></CodeLine>
<Link id="l03985" /><CodeLine lineNumber="3985"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(Header);</Highlight></CodeLine>
<Link id="l03986" /><CodeLine lineNumber="3986"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03987" /><CodeLine lineNumber="3987"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Header);</Highlight></CodeLine>
<Link id="l03988" /><CodeLine lineNumber="3988"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;IndVarPHI = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a876fb556ecea804faa2cd8ad1e498ec3">CreatePHI</a>(IndVarTy, 2, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.iv&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03989" /><CodeLine lineNumber="3989"><Highlight kind="normal">  IndVarPHI-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(ConstantInt::get(IndVarTy, 0), Preheader);</Highlight></CodeLine>
<Link id="l03990" /><CodeLine lineNumber="3990"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>);</Highlight></CodeLine>
<Link id="l03991" /><CodeLine lineNumber="3991"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03992" /><CodeLine lineNumber="3992"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>);</Highlight></CodeLine>
<Link id="l03993" /><CodeLine lineNumber="3993"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Cmp =</Highlight></CodeLine>
<Link id="l03994" /><CodeLine lineNumber="3994"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a09b4daefdf5b73efba51ce7ae6cd45c5">CreateICmpULT</a>(IndVarPHI, TripCount, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.cmp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03995" /><CodeLine lineNumber="3995"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(Cmp, Body, Exit);</Highlight></CodeLine>
<Link id="l03996" /><CodeLine lineNumber="3996"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03997" /><CodeLine lineNumber="3997"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Body);</Highlight></CodeLine>
<Link id="l03998" /><CodeLine lineNumber="3998"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(Latch);</Highlight></CodeLine>
<Link id="l03999" /><CodeLine lineNumber="3999"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04000" /><CodeLine lineNumber="4000"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Latch);</Highlight></CodeLine>
<Link id="l04001" /><CodeLine lineNumber="4001"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/#ab13c360340346d082b959b8cd79f2c1a">Next</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(IndVarPHI, ConstantInt::get(IndVarTy, 1),</Highlight></CodeLine>
<Link id="l04002" /><CodeLine lineNumber="4002"><Highlight kind="normal">                                  </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.next&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;HasNUW=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04003" /><CodeLine lineNumber="4003"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(Header);</Highlight></CodeLine>
<Link id="l04004" /><CodeLine lineNumber="4004"><Highlight kind="normal">  IndVarPHI-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(<a href="/docs/api/namespaces/llvm/#ab13c360340346d082b959b8cd79f2c1a">Next</a>, Latch);</Highlight></CodeLine>
<Link id="l04005" /><CodeLine lineNumber="4005"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04006" /><CodeLine lineNumber="4006"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Exit);</Highlight></CodeLine>
<Link id="l04007" /><CodeLine lineNumber="4007"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(<a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a>);</Highlight></CodeLine>
<Link id="l04008" /><CodeLine lineNumber="4008"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04009" /><CodeLine lineNumber="4009"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remember and return the canonical control flow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04010" /><CodeLine lineNumber="4010"><Highlight kind="normal">  LoopInfos.emplace&#95;front();</Highlight></CodeLine>
<Link id="l04011" /><CodeLine lineNumber="4011"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CL = &amp;LoopInfos.front();</Highlight></CodeLine>
<Link id="l04012" /><CodeLine lineNumber="4012"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04013" /><CodeLine lineNumber="4013"><Highlight kind="normal">  CL-&gt;Header = Header;</Highlight></CodeLine>
<Link id="l04014" /><CodeLine lineNumber="4014"><Highlight kind="normal">  CL-&gt;Cond = <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l04015" /><CodeLine lineNumber="4015"><Highlight kind="normal">  CL-&gt;Latch = Latch;</Highlight></CodeLine>
<Link id="l04016" /><CodeLine lineNumber="4016"><Highlight kind="normal">  CL-&gt;Exit = Exit;</Highlight></CodeLine>
<Link id="l04017" /><CodeLine lineNumber="4017"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04018" /><CodeLine lineNumber="4018"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04019" /><CodeLine lineNumber="4019"><Highlight kind="normal">  CL-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a32ff799dcb39887a8d21322020f305ba">assertOK</a>();</Highlight></CodeLine>
<Link id="l04020" /><CodeLine lineNumber="4020"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04021" /><CodeLine lineNumber="4021"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> CL;</Highlight></CodeLine>
<Link id="l04022" /><CodeLine lineNumber="4022"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04023" /><CodeLine lineNumber="4023"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04024" /><CodeLine lineNumber="4024"><Highlight kind="normal"><a href="/docs/api/classes/llvm/expected">Expected&lt;CanonicalLoopInfo &#42;&gt;</a></Highlight></CodeLine>
<Link id="l04025" /><CodeLine lineNumber="4025" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ae0287686a5ffe03bc264972c862726ea"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#ae0287686a5ffe03bc264972c862726ea">OpenMPIRBuilder::createCanonicalLoop</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l04026" /><CodeLine lineNumber="4026"><Highlight kind="normal">                                     <a href="/docs/api/classes/llvm/openmpirbuilder/#a296d2e28bddf1051d614f48b61005899">LoopBodyGenCallbackTy</a> BodyGenCB,</Highlight></CodeLine>
<Link id="l04027" /><CodeLine lineNumber="4027"><Highlight kind="normal">                                     <a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp;Name) &#123;</Highlight></CodeLine>
<Link id="l04028" /><CodeLine lineNumber="4028"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB = <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP.getBlock();</Highlight></CodeLine>
<Link id="l04029" /><CodeLine lineNumber="4029"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;NextBB = BB-&gt;<a href="/docs/api/classes/llvm/ilist-node-with-parent/#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>();</Highlight></CodeLine>
<Link id="l04030" /><CodeLine lineNumber="4030"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04031" /><CodeLine lineNumber="4031"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CL = <a href="/docs/api/classes/llvm/openmpirbuilder/#a445fa52d77040bccb16bfea111234a2e">createLoopSkeleton</a>(<a href="/docs/api/namespaces/llvm/loc">Loc</a>.DL, TripCount, BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>(),</Highlight></CodeLine>
<Link id="l04032" /><CodeLine lineNumber="4032"><Highlight kind="normal">                                             NextBB, NextBB, Name);</Highlight></CodeLine>
<Link id="l04033" /><CodeLine lineNumber="4033"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a> = CL-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>();</Highlight></CodeLine>
<Link id="l04034" /><CodeLine lineNumber="4034"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04035" /><CodeLine lineNumber="4035"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If location is not set, don&#39;t connect the loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04036" /><CodeLine lineNumber="4036"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>)) &#123;</Highlight></CodeLine>
<Link id="l04037" /><CodeLine lineNumber="4037"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Split the loop at the insertion point: Branch to the preheader and move</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04038" /><CodeLine lineNumber="4038"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// every following instruction to after the loop (the After BB). Also, the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04039" /><CodeLine lineNumber="4039"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// new successor is the loop&#39;s after block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04040" /><CodeLine lineNumber="4040"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a78e14f66d8a8405c6882b5ff6a3b7617">spliceBB</a>(Builder, <a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a>, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04041" /><CodeLine lineNumber="4041"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(CL-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>());</Highlight></CodeLine>
<Link id="l04042" /><CodeLine lineNumber="4042"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04043" /><CodeLine lineNumber="4043"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04044" /><CodeLine lineNumber="4044"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the body content. We do it after connecting the loop to the CFG to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04045" /><CodeLine lineNumber="4045"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// avoid that the callback encounters degenerate BBs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04046" /><CodeLine lineNumber="4046"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/error">Error</a> Err = BodyGenCB(CL-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a8031442528bff99473596a0de4aa0422">getBodyIP</a>(), CL-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>()))</Highlight></CodeLine>
<Link id="l04047" /><CodeLine lineNumber="4047"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l04048" /><CodeLine lineNumber="4048"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04049" /><CodeLine lineNumber="4049"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04050" /><CodeLine lineNumber="4050"><Highlight kind="normal">  CL-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a32ff799dcb39887a8d21322020f305ba">assertOK</a>();</Highlight></CodeLine>
<Link id="l04051" /><CodeLine lineNumber="4051"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04052" /><CodeLine lineNumber="4052"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> CL;</Highlight></CodeLine>
<Link id="l04053" /><CodeLine lineNumber="4053"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04054" /><CodeLine lineNumber="4054"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04055" /><CodeLine lineNumber="4055" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ac669acbd0f638c6ef32977575362052e"><Highlight kind="normal"><a href="/docs/api/classes/llvm/expected">Expected&lt;CanonicalLoopInfo &#42;&gt;</a> <a href="/docs/api/classes/llvm/openmpirbuilder/#ae0287686a5ffe03bc264972c862726ea">OpenMPIRBuilder::createCanonicalLoop</a>(</Highlight></CodeLine>
<Link id="l04056" /><CodeLine lineNumber="4056"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/openmpirbuilder/#a296d2e28bddf1051d614f48b61005899">LoopBodyGenCallbackTy</a> BodyGenCB,</Highlight></CodeLine>
<Link id="l04057" /><CodeLine lineNumber="4057"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Start, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Stop, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Step, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsSigned, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> InclusiveStop,</Highlight></CodeLine>
<Link id="l04058" /><CodeLine lineNumber="4058"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> ComputeIP, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp;Name) &#123;</Highlight></CodeLine>
<Link id="l04059" /><CodeLine lineNumber="4059"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04060" /><CodeLine lineNumber="4060"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Consider the following difficulties (assuming 8-bit signed integers):</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04061" /><CodeLine lineNumber="4061"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  &#42; Adding \\p Step to the loop counter which passes \\p Stop may overflow:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04062" /><CodeLine lineNumber="4062"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//      DO I = 1, 100, 50</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04063" /><CodeLine lineNumber="4063"><Highlight kind="comment">  ///  &#42; A \\p Step of INT&#95;MIN cannot not be normalized to a positive direction:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04064" /><CodeLine lineNumber="4064"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//      DO I = 100, 0, -128</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04065" /><CodeLine lineNumber="4065"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04066" /><CodeLine lineNumber="4066"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Start, Stop and Step must be of the same integer type.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04067" /><CodeLine lineNumber="4067"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;IndVarTy = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;IntegerType&gt;</a>(Start-&gt;getType());</Highlight></CodeLine>
<Link id="l04068" /><CodeLine lineNumber="4068"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IndVarTy == Stop-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Stop type mismatch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04069" /><CodeLine lineNumber="4069"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IndVarTy == Step-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Step type mismatch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04070" /><CodeLine lineNumber="4070"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04071" /><CodeLine lineNumber="4071"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> ComputeLoc =</Highlight></CodeLine>
<Link id="l04072" /><CodeLine lineNumber="4072"><Highlight kind="normal">      ComputeIP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a85b9635b21610f18b51007437bcc26cf">isSet</a>() ? <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(ComputeIP, <a href="/docs/api/namespaces/llvm/loc">Loc</a>.DL) : <a href="/docs/api/namespaces/llvm/loc">Loc</a>;</Highlight></CodeLine>
<Link id="l04073" /><CodeLine lineNumber="4073"><Highlight kind="normal">  updateToLocation(ComputeLoc);</Highlight></CodeLine>
<Link id="l04074" /><CodeLine lineNumber="4074"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04075" /><CodeLine lineNumber="4075"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;Zero = ConstantInt::get(IndVarTy, 0);</Highlight></CodeLine>
<Link id="l04076" /><CodeLine lineNumber="4076"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;One = ConstantInt::get(IndVarTy, 1);</Highlight></CodeLine>
<Link id="l04077" /><CodeLine lineNumber="4077"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04078" /><CodeLine lineNumber="4078"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Like Step, but always positive.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04079" /><CodeLine lineNumber="4079"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Incr = Step;</Highlight></CodeLine>
<Link id="l04080" /><CodeLine lineNumber="4080"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04081" /><CodeLine lineNumber="4081"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Distance between Start and Stop; always positive.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04082" /><CodeLine lineNumber="4082"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Span;</Highlight></CodeLine>
<Link id="l04083" /><CodeLine lineNumber="4083"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04084" /><CodeLine lineNumber="4084"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Condition whether there are no iterations are executed at all, e.g. because</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04085" /><CodeLine lineNumber="4085"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// UB &lt; LB.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04086" /><CodeLine lineNumber="4086"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;ZeroCmp;</Highlight></CodeLine>
<Link id="l04087" /><CodeLine lineNumber="4087"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04088" /><CodeLine lineNumber="4088"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsSigned) &#123;</Highlight></CodeLine>
<Link id="l04089" /><CodeLine lineNumber="4089"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Ensure that increment is positive. If not, negate and invert LB and UB.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04090" /><CodeLine lineNumber="4090"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;IsNeg = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac2bfef55549675e0ea117f29cd7309be">CreateICmpSLT</a>(Step, Zero);</Highlight></CodeLine>
<Link id="l04091" /><CodeLine lineNumber="4091"><Highlight kind="normal">    Incr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(IsNeg, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a7704bf68951054ffeb3efe605750e2d9">CreateNeg</a>(Step), Step);</Highlight></CodeLine>
<Link id="l04092" /><CodeLine lineNumber="4092"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;LB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(IsNeg, Stop, Start);</Highlight></CodeLine>
<Link id="l04093" /><CodeLine lineNumber="4093"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;UB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(IsNeg, Start, Stop);</Highlight></CodeLine>
<Link id="l04094" /><CodeLine lineNumber="4094"><Highlight kind="normal">    Span = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(UB, LB, </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04095" /><CodeLine lineNumber="4095"><Highlight kind="normal">    ZeroCmp = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae0bd6c2fab2d18443038a8f3a2b64856">CreateICmp</a>(</Highlight></CodeLine>
<Link id="l04096" /><CodeLine lineNumber="4096"><Highlight kind="normal">        InclusiveStop ? <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c">CmpInst::ICMP&#95;SLT</a> : <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba2751d6136a2819749dcef65dc19a4246">CmpInst::ICMP&#95;SLE</a>, UB, LB);</Highlight></CodeLine>
<Link id="l04097" /><CodeLine lineNumber="4097"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l04098" /><CodeLine lineNumber="4098"><Highlight kind="normal">    Span = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(Stop, Start, </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04099" /><CodeLine lineNumber="4099"><Highlight kind="normal">    ZeroCmp = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae0bd6c2fab2d18443038a8f3a2b64856">CreateICmp</a>(</Highlight></CodeLine>
<Link id="l04100" /><CodeLine lineNumber="4100"><Highlight kind="normal">        InclusiveStop ? <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">CmpInst::ICMP&#95;ULT</a> : <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78bad92f160316221fd4090520bb2b3cefc5">CmpInst::ICMP&#95;ULE</a>, Stop, Start);</Highlight></CodeLine>
<Link id="l04101" /><CodeLine lineNumber="4101"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04102" /><CodeLine lineNumber="4102"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04103" /><CodeLine lineNumber="4103"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;CountIfLooping;</Highlight></CodeLine>
<Link id="l04104" /><CodeLine lineNumber="4104"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (InclusiveStop) &#123;</Highlight></CodeLine>
<Link id="l04105" /><CodeLine lineNumber="4105"><Highlight kind="normal">    CountIfLooping = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a6b68047eda0d6d6eec5dd564ed1a22b8">CreateUDiv</a>(Span, Incr), One);</Highlight></CodeLine>
<Link id="l04106" /><CodeLine lineNumber="4106"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l04107" /><CodeLine lineNumber="4107"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Avoid incrementing past stop since it could overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04108" /><CodeLine lineNumber="4108"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;CountIfTwo = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(</Highlight></CodeLine>
<Link id="l04109" /><CodeLine lineNumber="4109"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a6b68047eda0d6d6eec5dd564ed1a22b8">CreateUDiv</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(Span, One), Incr), One);</Highlight></CodeLine>
<Link id="l04110" /><CodeLine lineNumber="4110"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;OneCmp = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae0bd6c2fab2d18443038a8f3a2b64856">CreateICmp</a>(<a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78bad92f160316221fd4090520bb2b3cefc5">CmpInst::ICMP&#95;ULE</a>, Span, Incr);</Highlight></CodeLine>
<Link id="l04111" /><CodeLine lineNumber="4111"><Highlight kind="normal">    CountIfLooping = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(OneCmp, One, CountIfTwo);</Highlight></CodeLine>
<Link id="l04112" /><CodeLine lineNumber="4112"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04113" /><CodeLine lineNumber="4113"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(ZeroCmp, Zero, CountIfLooping,</Highlight></CodeLine>
<Link id="l04114" /><CodeLine lineNumber="4114"><Highlight kind="normal">                                          </Highlight><Highlight kind="stringliteral">&quot;omp&#95;&quot;</Highlight><Highlight kind="normal"> + Name + </Highlight><Highlight kind="stringliteral">&quot;.tripcount&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04115" /><CodeLine lineNumber="4115"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04116" /><CodeLine lineNumber="4116"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> BodyGen = &#91;=&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP, <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>) &#123;</Highlight></CodeLine>
<Link id="l04117" /><CodeLine lineNumber="4117"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l04118" /><CodeLine lineNumber="4118"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Span = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aecd40f9a16dc0ef1e0bc416599f89277">CreateMul</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>, Step);</Highlight></CodeLine>
<Link id="l04119" /><CodeLine lineNumber="4119"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;IndVar = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(Span, Start);</Highlight></CodeLine>
<Link id="l04120" /><CodeLine lineNumber="4120"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> BodyGenCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), IndVar);</Highlight></CodeLine>
<Link id="l04121" /><CodeLine lineNumber="4121"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l04122" /><CodeLine lineNumber="4122"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> LoopLoc = ComputeIP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a85b9635b21610f18b51007437bcc26cf">isSet</a>() ? <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l04123" /><CodeLine lineNumber="4123"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#ae0287686a5ffe03bc264972c862726ea">createCanonicalLoop</a>(LoopLoc, BodyGen, TripCount, Name);</Highlight></CodeLine>
<Link id="l04124" /><CodeLine lineNumber="4124"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04125" /><CodeLine lineNumber="4125"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04126" /><CodeLine lineNumber="4126"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Returns an LLVM function to call for initializing loop bounds using OpenMP</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04127" /><CodeLine lineNumber="4127"><Highlight kind="normal"></Highlight><Highlight kind="comment">// static scheduling depending on &#96;type&#96;. Only i32 and i64 are supported by the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04128" /><CodeLine lineNumber="4128"><Highlight kind="normal"></Highlight><Highlight kind="comment">// runtime. Always interpret integers as unsigned similarly to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04129" /><CodeLine lineNumber="4129"><Highlight kind="normal"></Highlight><Highlight kind="comment">// CanonicalLoopInfo.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04130" /><CodeLine lineNumber="4130" lineLink="#ac04904b32ea7f45e108b8752b1a940e7"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> <a href="#ac04904b32ea7f45e108b8752b1a940e7">getKmpcForStaticInitForType</a>(<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty, <a href="/docs/api/classes/llvm/module">Module</a> &amp;M,</Highlight></CodeLine>
<Link id="l04131" /><CodeLine lineNumber="4131"><Highlight kind="normal">                                                  <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder) &#123;</Highlight></CodeLine>
<Link id="l04132" /><CodeLine lineNumber="4132"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Bitwidth = Ty-&gt;getIntegerBitWidth();</Highlight></CodeLine>
<Link id="l04133" /><CodeLine lineNumber="4133"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 32)</Highlight></CodeLine>
<Link id="l04134" /><CodeLine lineNumber="4134"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04135" /><CodeLine lineNumber="4135"><Highlight kind="normal">        M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;init&#95;4u);</Highlight></CodeLine>
<Link id="l04136" /><CodeLine lineNumber="4136"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 64)</Highlight></CodeLine>
<Link id="l04137" /><CodeLine lineNumber="4137"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04138" /><CodeLine lineNumber="4138"><Highlight kind="normal">        M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;init&#95;8u);</Highlight></CodeLine>
<Link id="l04139" /><CodeLine lineNumber="4139"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;unknown OpenMP loop iterator bitwidth&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04140" /><CodeLine lineNumber="4140"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04141" /><CodeLine lineNumber="4141"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04142" /><CodeLine lineNumber="4142"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l04143" /><CodeLine lineNumber="4143"><Highlight kind="normal">OpenMPIRBuilder::applyStaticWorkshareLoop(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CLI,</Highlight></CodeLine>
<Link id="l04144" /><CodeLine lineNumber="4144"><Highlight kind="normal">                                          InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l04145" /><CodeLine lineNumber="4145"><Highlight kind="normal">                                          </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> NeedsBarrier) &#123;</Highlight></CodeLine>
<Link id="l04146" /><CodeLine lineNumber="4146"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a4b2b7074e300c251f7cb8913620b1d80">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Requires a valid canonical loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04147" /><CodeLine lineNumber="4147"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="#a756b28f370cd5a39bc0ee3e5333b9c9b">isConflictIP</a>(AllocaIP, CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac72ebc430ef7dcf1791c66080ddedd9d">getPreheaderIP</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l04148" /><CodeLine lineNumber="4148"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Require dedicated allocate IP&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04149" /><CodeLine lineNumber="4149"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04150" /><CodeLine lineNumber="4150"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Set up the source location value for OpenMP runtime.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04151" /><CodeLine lineNumber="4151"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac72ebc430ef7dcf1791c66080ddedd9d">getPreheaderIP</a>());</Highlight></CodeLine>
<Link id="l04152" /><CodeLine lineNumber="4152"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04153" /><CodeLine lineNumber="4153"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04154" /><CodeLine lineNumber="4154"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l04155" /><CodeLine lineNumber="4155"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l04156" /><CodeLine lineNumber="4156"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcLoc = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l04157" /><CodeLine lineNumber="4157"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04158" /><CodeLine lineNumber="4158"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Declare useful OpenMP runtime functions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04159" /><CodeLine lineNumber="4159"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>();</Highlight></CodeLine>
<Link id="l04160" /><CodeLine lineNumber="4160"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IVTy = <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;getType();</Highlight></CodeLine>
<Link id="l04161" /><CodeLine lineNumber="4161"><Highlight kind="normal">  FunctionCallee StaticInit = <a href="#ac04904b32ea7f45e108b8752b1a940e7">getKmpcForStaticInitForType</a>(IVTy, M, &#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04162" /><CodeLine lineNumber="4162"><Highlight kind="normal">  FunctionCallee StaticFini =</Highlight></CodeLine>
<Link id="l04163" /><CodeLine lineNumber="4163"><Highlight kind="normal">      getOrCreateRuntimeFunction(M, omp::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;fini);</Highlight></CodeLine>
<Link id="l04164" /><CodeLine lineNumber="4164"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04165" /><CodeLine lineNumber="4165"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Allocate space for computed loop bounds as expected by the &quot;init&quot; function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04166" /><CodeLine lineNumber="4166"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(AllocaIP.getBlock()-&gt;getFirstNonPHIOrDbgOrAlloca());</Highlight></CodeLine>
<Link id="l04167" /><CodeLine lineNumber="4167"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04168" /><CodeLine lineNumber="4168"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;I32Type = <a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l04169" /><CodeLine lineNumber="4169"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PLastIter = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(I32Type, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.lastiter&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04170" /><CodeLine lineNumber="4170"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PLowerBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(IVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.lowerbound&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04171" /><CodeLine lineNumber="4171"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PUpperBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(IVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.upperbound&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04172" /><CodeLine lineNumber="4172"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PStride = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(IVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.stride&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04173" /><CodeLine lineNumber="4173"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04174" /><CodeLine lineNumber="4174"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// At the end of the preheader, prepare for calling the &quot;init&quot; function by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04175" /><CodeLine lineNumber="4175"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// storing the current loop bounds into the allocated space. A canonical loop</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04176" /><CodeLine lineNumber="4176"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// always iterates from 0 to trip-count with step 1 Note that &quot;init&quot; expects</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04177" /><CodeLine lineNumber="4177"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and produces an inclusive upper bound.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04178" /><CodeLine lineNumber="4178"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l04179" /><CodeLine lineNumber="4179"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;<a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a> = ConstantInt::get(IVTy, 0);</Highlight></CodeLine>
<Link id="l04180" /><CodeLine lineNumber="4180"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;One = ConstantInt::get(IVTy, 1);</Highlight></CodeLine>
<Link id="l04181" /><CodeLine lineNumber="4181"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Zero, PLowerBound);</Highlight></CodeLine>
<Link id="l04182" /><CodeLine lineNumber="4182"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;UpperBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01560f4a4ff7bfc8a96bd406b6f17ea2">getTripCount</a>(), One);</Highlight></CodeLine>
<Link id="l04183" /><CodeLine lineNumber="4183"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(UpperBound, PUpperBound);</Highlight></CodeLine>
<Link id="l04184" /><CodeLine lineNumber="4184"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(One, PStride);</Highlight></CodeLine>
<Link id="l04185" /><CodeLine lineNumber="4185"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04186" /><CodeLine lineNumber="4186"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadNum = getOrCreateThreadID(SrcLoc);</Highlight></CodeLine>
<Link id="l04187" /><CodeLine lineNumber="4187"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04188" /><CodeLine lineNumber="4188"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SchedulingType = ConstantInt::get(</Highlight></CodeLine>
<Link id="l04189" /><CodeLine lineNumber="4189"><Highlight kind="normal">      I32Type, </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(OMPScheduleType::UnorderedStatic));</Highlight></CodeLine>
<Link id="l04190" /><CodeLine lineNumber="4190"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04191" /><CodeLine lineNumber="4191"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Call the &quot;init&quot; function and update the trip count of the loop with the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04192" /><CodeLine lineNumber="4192"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// value it produced.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04193" /><CodeLine lineNumber="4193"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(StaticInit,</Highlight></CodeLine>
<Link id="l04194" /><CodeLine lineNumber="4194"><Highlight kind="normal">                     &#123;SrcLoc, ThreadNum, SchedulingType, PLastIter, PLowerBound,</Highlight></CodeLine>
<Link id="l04195" /><CodeLine lineNumber="4195"><Highlight kind="normal">                      PUpperBound, PStride, One, <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a>&#125;);</Highlight></CodeLine>
<Link id="l04196" /><CodeLine lineNumber="4196"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LowerBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(IVTy, PLowerBound);</Highlight></CodeLine>
<Link id="l04197" /><CodeLine lineNumber="4197"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;InclusiveUpperBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(IVTy, PUpperBound);</Highlight></CodeLine>
<Link id="l04198" /><CodeLine lineNumber="4198"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TripCountMinusOne = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(InclusiveUpperBound, LowerBound);</Highlight></CodeLine>
<Link id="l04199" /><CodeLine lineNumber="4199"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TripCount = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(TripCountMinusOne, One);</Highlight></CodeLine>
<Link id="l04200" /><CodeLine lineNumber="4200"><Highlight kind="normal">  CLI-&gt;setTripCount(TripCount);</Highlight></CodeLine>
<Link id="l04201" /><CodeLine lineNumber="4201"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04202" /><CodeLine lineNumber="4202"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update all uses of the induction variable except the one in the condition</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04203" /><CodeLine lineNumber="4203"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// block that compares it with the actual upper bound, and the increment in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04204" /><CodeLine lineNumber="4204"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the latch block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04205" /><CodeLine lineNumber="4205"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04206" /><CodeLine lineNumber="4206"><Highlight kind="normal">  CLI-&gt;mapIndVar(&#91;&amp;&#93;(Instruction &#42;OldIV) -&gt; <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42; &#123;</Highlight></CodeLine>
<Link id="l04207" /><CodeLine lineNumber="4207"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>(),</Highlight></CodeLine>
<Link id="l04208" /><CodeLine lineNumber="4208"><Highlight kind="normal">                           CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l04209" /><CodeLine lineNumber="4209"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04210" /><CodeLine lineNumber="4210"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(OldIV, LowerBound);</Highlight></CodeLine>
<Link id="l04211" /><CodeLine lineNumber="4211"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l04212" /><CodeLine lineNumber="4212"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04213" /><CodeLine lineNumber="4213"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// In the &quot;exit&quot; block, call the &quot;fini&quot; function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04214" /><CodeLine lineNumber="4214"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>(),</Highlight></CodeLine>
<Link id="l04215" /><CodeLine lineNumber="4215"><Highlight kind="normal">                         CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l04216" /><CodeLine lineNumber="4216"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(StaticFini, &#123;SrcLoc, ThreadNum&#125;);</Highlight></CodeLine>
<Link id="l04217" /><CodeLine lineNumber="4217"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04218" /><CodeLine lineNumber="4218"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add the barrier if requested.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04219" /><CodeLine lineNumber="4219"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NeedsBarrier) &#123;</Highlight></CodeLine>
<Link id="l04220" /><CodeLine lineNumber="4220"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> BarrierIP =</Highlight></CodeLine>
<Link id="l04221" /><CodeLine lineNumber="4221"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07">createBarrier</a>(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>),</Highlight></CodeLine>
<Link id="l04222" /><CodeLine lineNumber="4222"><Highlight kind="normal">                      omp::Directive::OMPD&#95;for, </Highlight><Highlight kind="comment">/&#42; ForceSimpleCall &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04223" /><CodeLine lineNumber="4223"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42; CheckCancelFlag &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04224" /><CodeLine lineNumber="4224"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!BarrierIP)</Highlight></CodeLine>
<Link id="l04225" /><CodeLine lineNumber="4225"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> BarrierIP.takeError();</Highlight></CodeLine>
<Link id="l04226" /><CodeLine lineNumber="4226"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04227" /><CodeLine lineNumber="4227"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04228" /><CodeLine lineNumber="4228"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AfterIP = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a578dd7d619d0ccfc6ace07aa380022cc">getAfterIP</a>();</Highlight></CodeLine>
<Link id="l04229" /><CodeLine lineNumber="4229"><Highlight kind="normal">  CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a9ce55b05f8ad85126fc92eeeb35457c7">invalidate</a>();</Highlight></CodeLine>
<Link id="l04230" /><CodeLine lineNumber="4230"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04231" /><CodeLine lineNumber="4231"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP;</Highlight></CodeLine>
<Link id="l04232" /><CodeLine lineNumber="4232"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04233" /><CodeLine lineNumber="4233"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04234" /><CodeLine lineNumber="4234"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l04235" /><CodeLine lineNumber="4235"><Highlight kind="normal">OpenMPIRBuilder::applyStaticChunkedWorkshareLoop(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>,</Highlight></CodeLine>
<Link id="l04236" /><CodeLine lineNumber="4236"><Highlight kind="normal">                                                 <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CLI,</Highlight></CodeLine>
<Link id="l04237" /><CodeLine lineNumber="4237"><Highlight kind="normal">                                                 InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l04238" /><CodeLine lineNumber="4238"><Highlight kind="normal">                                                 </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> NeedsBarrier,</Highlight></CodeLine>
<Link id="l04239" /><CodeLine lineNumber="4239"><Highlight kind="normal">                                                 <a href="/docs/api/classes/llvm/value">Value</a> &#42;ChunkSize) &#123;</Highlight></CodeLine>
<Link id="l04240" /><CodeLine lineNumber="4240"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a4b2b7074e300c251f7cb8913620b1d80">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Requires a valid canonical loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04241" /><CodeLine lineNumber="4241"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ChunkSize &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Chunk size is required&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04242" /><CodeLine lineNumber="4242"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04243" /><CodeLine lineNumber="4243"><Highlight kind="normal">  LLVMContext &amp;Ctx = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a9592feb460b27d417f42a41aabfe253a">getFunction</a>()-&gt;<a href="/docs/api/classes/llvm/function/#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</Highlight></CodeLine>
<Link id="l04244" /><CodeLine lineNumber="4244"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>();</Highlight></CodeLine>
<Link id="l04245" /><CodeLine lineNumber="4245"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OrigTripCount = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01560f4a4ff7bfc8a96bd406b6f17ea2">getTripCount</a>();</Highlight></CodeLine>
<Link id="l04246" /><CodeLine lineNumber="4246"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IVTy = <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;getType();</Highlight></CodeLine>
<Link id="l04247" /><CodeLine lineNumber="4247"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IVTy-&gt;<a href="/docs/api/classes/llvm/type/#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>() &lt;= 64 &amp;&amp;</Highlight></CodeLine>
<Link id="l04248" /><CodeLine lineNumber="4248"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Max supported tripcount bitwidth is 64 bits&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04249" /><CodeLine lineNumber="4249"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;InternalIVTy = IVTy-&gt;<a href="/docs/api/classes/llvm/type/#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>() &lt;= 32 ? <a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Ctx)</Highlight></CodeLine>
<Link id="l04250" /><CodeLine lineNumber="4250"><Highlight kind="normal">                                                        : <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a>::getInt64Ty(Ctx);</Highlight></CodeLine>
<Link id="l04251" /><CodeLine lineNumber="4251"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;I32Type = <a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l04252" /><CodeLine lineNumber="4252"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;<a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefad7ed4ee1df437474d005188535f74875">Zero</a> = ConstantInt::get(InternalIVTy, 0);</Highlight></CodeLine>
<Link id="l04253" /><CodeLine lineNumber="4253"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;One = ConstantInt::get(InternalIVTy, 1);</Highlight></CodeLine>
<Link id="l04254" /><CodeLine lineNumber="4254"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04255" /><CodeLine lineNumber="4255"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Declare useful OpenMP runtime functions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04256" /><CodeLine lineNumber="4256"><Highlight kind="normal">  FunctionCallee StaticInit =</Highlight></CodeLine>
<Link id="l04257" /><CodeLine lineNumber="4257"><Highlight kind="normal">      <a href="#ac04904b32ea7f45e108b8752b1a940e7">getKmpcForStaticInitForType</a>(InternalIVTy, M, &#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04258" /><CodeLine lineNumber="4258"><Highlight kind="normal">  FunctionCallee StaticFini =</Highlight></CodeLine>
<Link id="l04259" /><CodeLine lineNumber="4259"><Highlight kind="normal">      getOrCreateRuntimeFunction(M, omp::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;fini);</Highlight></CodeLine>
<Link id="l04260" /><CodeLine lineNumber="4260"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04261" /><CodeLine lineNumber="4261"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Allocate space for computed loop bounds as expected by the &quot;init&quot; function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04262" /><CodeLine lineNumber="4262"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l04263" /><CodeLine lineNumber="4263"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04264" /><CodeLine lineNumber="4264"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PLastIter = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(I32Type, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.lastiter&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04265" /><CodeLine lineNumber="4265"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PLowerBound =</Highlight></CodeLine>
<Link id="l04266" /><CodeLine lineNumber="4266"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(InternalIVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.lowerbound&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04267" /><CodeLine lineNumber="4267"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PUpperBound =</Highlight></CodeLine>
<Link id="l04268" /><CodeLine lineNumber="4268"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(InternalIVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.upperbound&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04269" /><CodeLine lineNumber="4269"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PStride = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(InternalIVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.stride&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04270" /><CodeLine lineNumber="4270"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04271" /><CodeLine lineNumber="4271"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Set up the source location value for the OpenMP runtime.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04272" /><CodeLine lineNumber="4272"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac72ebc430ef7dcf1791c66080ddedd9d">getPreheaderIP</a>());</Highlight></CodeLine>
<Link id="l04273" /><CodeLine lineNumber="4273"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04274" /><CodeLine lineNumber="4274"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04275" /><CodeLine lineNumber="4275"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Detect overflow in ubsan or max-out with current tripcount.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04276" /><CodeLine lineNumber="4276"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CastedChunkSize =</Highlight></CodeLine>
<Link id="l04277" /><CodeLine lineNumber="4277"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a36742c35a8fff5f74bb3d76c9c19dd47">CreateZExtOrTrunc</a>(ChunkSize, InternalIVTy, </Highlight><Highlight kind="stringliteral">&quot;chunksize&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04278" /><CodeLine lineNumber="4278"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CastedTripCount =</Highlight></CodeLine>
<Link id="l04279" /><CodeLine lineNumber="4279"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9e6950f7f17700d5c0d61ad0b846ec5c">CreateZExt</a>(OrigTripCount, InternalIVTy, </Highlight><Highlight kind="stringliteral">&quot;tripcount&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04280" /><CodeLine lineNumber="4280"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04281" /><CodeLine lineNumber="4281"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SchedulingType = ConstantInt::get(</Highlight></CodeLine>
<Link id="l04282" /><CodeLine lineNumber="4282"><Highlight kind="normal">      I32Type, </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(OMPScheduleType::UnorderedStaticChunked));</Highlight></CodeLine>
<Link id="l04283" /><CodeLine lineNumber="4283"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Zero, PLowerBound);</Highlight></CodeLine>
<Link id="l04284" /><CodeLine lineNumber="4284"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OrigUpperBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(CastedTripCount, One);</Highlight></CodeLine>
<Link id="l04285" /><CodeLine lineNumber="4285"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(OrigUpperBound, PUpperBound);</Highlight></CodeLine>
<Link id="l04286" /><CodeLine lineNumber="4286"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(One, PStride);</Highlight></CodeLine>
<Link id="l04287" /><CodeLine lineNumber="4287"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04288" /><CodeLine lineNumber="4288"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Call the &quot;init&quot; function and update the trip count of the loop with the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04289" /><CodeLine lineNumber="4289"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// value it produced.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04290" /><CodeLine lineNumber="4290"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l04291" /><CodeLine lineNumber="4291"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l04292" /><CodeLine lineNumber="4292"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcLoc = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l04293" /><CodeLine lineNumber="4293"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadNum = getOrCreateThreadID(SrcLoc);</Highlight></CodeLine>
<Link id="l04294" /><CodeLine lineNumber="4294"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(StaticInit,</Highlight></CodeLine>
<Link id="l04295" /><CodeLine lineNumber="4295"><Highlight kind="normal">                     &#123;</Highlight><Highlight kind="comment">/&#42;loc=&#42;/</Highlight><Highlight kind="normal">SrcLoc, </Highlight><Highlight kind="comment">/&#42;global&#95;tid=&#42;/</Highlight><Highlight kind="normal">ThreadNum,</Highlight></CodeLine>
<Link id="l04296" /><CodeLine lineNumber="4296"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42;schedtype=&#42;/</Highlight><Highlight kind="normal">SchedulingType, </Highlight><Highlight kind="comment">/&#42;plastiter=&#42;/</Highlight><Highlight kind="normal">PLastIter,</Highlight></CodeLine>
<Link id="l04297" /><CodeLine lineNumber="4297"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42;plower=&#42;/</Highlight><Highlight kind="normal">PLowerBound, </Highlight><Highlight kind="comment">/&#42;pupper=&#42;/</Highlight><Highlight kind="normal">PUpperBound,</Highlight></CodeLine>
<Link id="l04298" /><CodeLine lineNumber="4298"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42;pstride=&#42;/</Highlight><Highlight kind="normal">PStride, </Highlight><Highlight kind="comment">/&#42;incr=&#42;/</Highlight><Highlight kind="normal">One,</Highlight></CodeLine>
<Link id="l04299" /><CodeLine lineNumber="4299"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42;chunk=&#42;/</Highlight><Highlight kind="normal">CastedChunkSize&#125;);</Highlight></CodeLine>
<Link id="l04300" /><CodeLine lineNumber="4300"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04301" /><CodeLine lineNumber="4301"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Load values written by the &quot;init&quot; function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04302" /><CodeLine lineNumber="4302"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;FirstChunkStart =</Highlight></CodeLine>
<Link id="l04303" /><CodeLine lineNumber="4303"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(InternalIVTy, PLowerBound, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;firstchunk.lb&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04304" /><CodeLine lineNumber="4304"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;FirstChunkStop =</Highlight></CodeLine>
<Link id="l04305" /><CodeLine lineNumber="4305"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(InternalIVTy, PUpperBound, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;firstchunk.ub&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04306" /><CodeLine lineNumber="4306"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;FirstChunkEnd = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(FirstChunkStop, One);</Highlight></CodeLine>
<Link id="l04307" /><CodeLine lineNumber="4307"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ChunkRange =</Highlight></CodeLine>
<Link id="l04308" /><CodeLine lineNumber="4308"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(FirstChunkEnd, FirstChunkStart, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;chunk.range&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04309" /><CodeLine lineNumber="4309"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;NextChunkStride =</Highlight></CodeLine>
<Link id="l04310" /><CodeLine lineNumber="4310"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(InternalIVTy, PStride, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;dispatch.stride&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04311" /><CodeLine lineNumber="4311"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04312" /><CodeLine lineNumber="4312"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create outer &quot;dispatch&quot; loop for enumerating the chunks.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04313" /><CodeLine lineNumber="4313"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;DispatchEnter = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04314" /><CodeLine lineNumber="4314"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DispatchCounter;</Highlight></CodeLine>
<Link id="l04315" /><CodeLine lineNumber="4315"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04316" /><CodeLine lineNumber="4316"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// It is safe to assume this didn&#39;t return an error because the callback</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04317" /><CodeLine lineNumber="4317"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// passed into createCanonicalLoop is the only possible error source, and it</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04318" /><CodeLine lineNumber="4318"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// always returns success.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04319" /><CodeLine lineNumber="4319"><Highlight kind="normal">  CanonicalLoopInfo &#42;DispatchCLI = <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(<a href="/docs/api/classes/llvm/openmpirbuilder/#ae0287686a5ffe03bc264972c862726ea">createCanonicalLoop</a>(</Highlight></CodeLine>
<Link id="l04320" /><CodeLine lineNumber="4320"><Highlight kind="normal">      &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>&#125;,</Highlight></CodeLine>
<Link id="l04321" /><CodeLine lineNumber="4321"><Highlight kind="normal">      &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> BodyIP, <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Counter) &#123;</Highlight></CodeLine>
<Link id="l04322" /><CodeLine lineNumber="4322"><Highlight kind="normal">        DispatchCounter = Counter;</Highlight></CodeLine>
<Link id="l04323" /><CodeLine lineNumber="4323"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l04324" /><CodeLine lineNumber="4324"><Highlight kind="normal">      &#125;,</Highlight></CodeLine>
<Link id="l04325" /><CodeLine lineNumber="4325"><Highlight kind="normal">      FirstChunkStart, CastedTripCount, NextChunkStride,</Highlight></CodeLine>
<Link id="l04326" /><CodeLine lineNumber="4326"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;IsSigned=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;InclusiveStop=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;ComputeIP=&#42;/</Highlight><Highlight kind="normal">&#123;&#125;,</Highlight></CodeLine>
<Link id="l04327" /><CodeLine lineNumber="4327"><Highlight kind="normal">      </Highlight><Highlight kind="stringliteral">&quot;dispatch&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l04328" /><CodeLine lineNumber="4328"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04329" /><CodeLine lineNumber="4329"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remember the BasicBlocks of the dispatch loop we need, then invalidate to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04330" /><CodeLine lineNumber="4330"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// not have to preserve the canonical invariant.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04331" /><CodeLine lineNumber="4331"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;DispatchBody = DispatchCLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>();</Highlight></CodeLine>
<Link id="l04332" /><CodeLine lineNumber="4332"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;DispatchLatch = DispatchCLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>();</Highlight></CodeLine>
<Link id="l04333" /><CodeLine lineNumber="4333"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;DispatchExit = DispatchCLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>();</Highlight></CodeLine>
<Link id="l04334" /><CodeLine lineNumber="4334"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;DispatchAfter = DispatchCLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>();</Highlight></CodeLine>
<Link id="l04335" /><CodeLine lineNumber="4335"><Highlight kind="normal">  DispatchCLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a9ce55b05f8ad85126fc92eeeb35457c7">invalidate</a>();</Highlight></CodeLine>
<Link id="l04336" /><CodeLine lineNumber="4336"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04337" /><CodeLine lineNumber="4337"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Rewire the original loop to become the chunk loop inside the dispatch loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04338" /><CodeLine lineNumber="4338"><Highlight kind="normal">  <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(DispatchAfter, CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04339" /><CodeLine lineNumber="4339"><Highlight kind="normal">  <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>(), DispatchLatch, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04340" /><CodeLine lineNumber="4340"><Highlight kind="normal">  <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(DispatchBody, DispatchEnter, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04341" /><CodeLine lineNumber="4341"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04342" /><CodeLine lineNumber="4342"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Prepare the prolog of the chunk loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04343" /><CodeLine lineNumber="4343"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac72ebc430ef7dcf1791c66080ddedd9d">getPreheaderIP</a>());</Highlight></CodeLine>
<Link id="l04344" /><CodeLine lineNumber="4344"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04345" /><CodeLine lineNumber="4345"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04346" /><CodeLine lineNumber="4346"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Compute the number of iterations of the chunk loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04347" /><CodeLine lineNumber="4347"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l04348" /><CodeLine lineNumber="4348"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ChunkEnd = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(DispatchCounter, ChunkRange);</Highlight></CodeLine>
<Link id="l04349" /><CodeLine lineNumber="4349"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IsLastChunk =</Highlight></CodeLine>
<Link id="l04350" /><CodeLine lineNumber="4350"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac613fa8e66fca464885c3f274fbeb834">CreateICmpUGE</a>(ChunkEnd, CastedTripCount, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;chunk.is&#95;last&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04351" /><CodeLine lineNumber="4351"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CountUntilOrigTripCount =</Highlight></CodeLine>
<Link id="l04352" /><CodeLine lineNumber="4352"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(CastedTripCount, DispatchCounter);</Highlight></CodeLine>
<Link id="l04353" /><CodeLine lineNumber="4353"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ChunkTripCount = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(</Highlight></CodeLine>
<Link id="l04354" /><CodeLine lineNumber="4354"><Highlight kind="normal">      IsLastChunk, CountUntilOrigTripCount, ChunkRange, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;chunk.tripcount&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04355" /><CodeLine lineNumber="4355"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BackcastedChunkTC =</Highlight></CodeLine>
<Link id="l04356" /><CodeLine lineNumber="4356"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab5b4acb0f45af3f2308cad1468804f1e">CreateTrunc</a>(ChunkTripCount, IVTy, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;chunk.tripcount.trunc&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04357" /><CodeLine lineNumber="4357"><Highlight kind="normal">  CLI-&gt;setTripCount(BackcastedChunkTC);</Highlight></CodeLine>
<Link id="l04358" /><CodeLine lineNumber="4358"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04359" /><CodeLine lineNumber="4359"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update all uses of the induction variable except the one in the condition</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04360" /><CodeLine lineNumber="4360"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// block that compares it with the actual upper bound, and the increment in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04361" /><CodeLine lineNumber="4361"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the latch block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04362" /><CodeLine lineNumber="4362"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BackcastedDispatchCounter =</Highlight></CodeLine>
<Link id="l04363" /><CodeLine lineNumber="4363"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab5b4acb0f45af3f2308cad1468804f1e">CreateTrunc</a>(DispatchCounter, IVTy, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;dispatch.iv.trunc&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04364" /><CodeLine lineNumber="4364"><Highlight kind="normal">  CLI-&gt;mapIndVar(&#91;&amp;&#93;(Instruction &#42;) -&gt; <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42; &#123;</Highlight></CodeLine>
<Link id="l04365" /><CodeLine lineNumber="4365"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a8031442528bff99473596a0de4aa0422">getBodyIP</a>());</Highlight></CodeLine>
<Link id="l04366" /><CodeLine lineNumber="4366"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>, BackcastedDispatchCounter);</Highlight></CodeLine>
<Link id="l04367" /><CodeLine lineNumber="4367"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l04368" /><CodeLine lineNumber="4368"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04369" /><CodeLine lineNumber="4369"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// In the &quot;exit&quot; block, call the &quot;fini&quot; function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04370" /><CodeLine lineNumber="4370"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(DispatchExit, DispatchExit-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l04371" /><CodeLine lineNumber="4371"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(StaticFini, &#123;SrcLoc, ThreadNum&#125;);</Highlight></CodeLine>
<Link id="l04372" /><CodeLine lineNumber="4372"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04373" /><CodeLine lineNumber="4373"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add the barrier if requested.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04374" /><CodeLine lineNumber="4374"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NeedsBarrier) &#123;</Highlight></CodeLine>
<Link id="l04375" /><CodeLine lineNumber="4375"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l04376" /><CodeLine lineNumber="4376"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07">createBarrier</a>(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>), OMPD&#95;for,</Highlight></CodeLine>
<Link id="l04377" /><CodeLine lineNumber="4377"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42;ForceSimpleCall=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;CheckCancelFlag=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04378" /><CodeLine lineNumber="4378"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l04379" /><CodeLine lineNumber="4379"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l04380" /><CodeLine lineNumber="4380"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04381" /><CodeLine lineNumber="4381"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04382" /><CodeLine lineNumber="4382"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04383" /><CodeLine lineNumber="4383"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Even though we currently do not support applying additional methods to it,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04384" /><CodeLine lineNumber="4384"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the chunk loop should remain a canonical loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04385" /><CodeLine lineNumber="4385"><Highlight kind="normal">  CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a32ff799dcb39887a8d21322020f305ba">assertOK</a>();</Highlight></CodeLine>
<Link id="l04386" /><CodeLine lineNumber="4386"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04387" /><CodeLine lineNumber="4387"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04388" /><CodeLine lineNumber="4388"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(DispatchAfter, DispatchAfter-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l04389" /><CodeLine lineNumber="4389"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04390" /><CodeLine lineNumber="4390"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04391" /><CodeLine lineNumber="4391"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Returns an LLVM function to call for executing an OpenMP static worksharing</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04392" /><CodeLine lineNumber="4392"><Highlight kind="normal"></Highlight><Highlight kind="comment">// for loop depending on &#96;type&#96;. Only i32 and i64 are supported by the runtime.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04393" /><CodeLine lineNumber="4393"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Always interpret integers as unsigned similarly to CanonicalLoopInfo.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04394" /><CodeLine lineNumber="4394"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></Highlight></CodeLine>
<Link id="l04395" /><CodeLine lineNumber="4395" lineLink="#aca27639a720491c7c7ea13c2bbe8c162"><Highlight kind="normal"><a href="#aca27639a720491c7c7ea13c2bbe8c162">getKmpcForStaticLoopForType</a>(<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42;OMPBuilder,</Highlight></CodeLine>
<Link id="l04396" /><CodeLine lineNumber="4396"><Highlight kind="normal">                            <a href="/docs/api/namespaces/llvm/omp/#ab6fb146c332fd3f3d677ee65081fe669">WorksharingLoopType</a> LoopType) &#123;</Highlight></CodeLine>
<Link id="l04397" /><CodeLine lineNumber="4397"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Bitwidth = Ty-&gt;getIntegerBitWidth();</Highlight></CodeLine>
<Link id="l04398" /><CodeLine lineNumber="4398"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/module">Module</a> &amp;M = OMPBuilder-&gt;M;</Highlight></CodeLine>
<Link id="l04399" /><CodeLine lineNumber="4399"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (LoopType) &#123;</Highlight></CodeLine>
<Link id="l04400" /><CodeLine lineNumber="4400"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> WorksharingLoopType::ForStaticLoop:</Highlight></CodeLine>
<Link id="l04401" /><CodeLine lineNumber="4401"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 32)</Highlight></CodeLine>
<Link id="l04402" /><CodeLine lineNumber="4402"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder-&gt;getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04403" /><CodeLine lineNumber="4403"><Highlight kind="normal">          M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;loop&#95;4u);</Highlight></CodeLine>
<Link id="l04404" /><CodeLine lineNumber="4404"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 64)</Highlight></CodeLine>
<Link id="l04405" /><CodeLine lineNumber="4405"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder-&gt;getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04406" /><CodeLine lineNumber="4406"><Highlight kind="normal">          M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;loop&#95;8u);</Highlight></CodeLine>
<Link id="l04407" /><CodeLine lineNumber="4407"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04408" /><CodeLine lineNumber="4408"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> WorksharingLoopType::DistributeStaticLoop:</Highlight></CodeLine>
<Link id="l04409" /><CodeLine lineNumber="4409"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 32)</Highlight></CodeLine>
<Link id="l04410" /><CodeLine lineNumber="4410"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder-&gt;getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04411" /><CodeLine lineNumber="4411"><Highlight kind="normal">          M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;distribute&#95;static&#95;loop&#95;4u);</Highlight></CodeLine>
<Link id="l04412" /><CodeLine lineNumber="4412"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 64)</Highlight></CodeLine>
<Link id="l04413" /><CodeLine lineNumber="4413"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder-&gt;getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04414" /><CodeLine lineNumber="4414"><Highlight kind="normal">          M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;distribute&#95;static&#95;loop&#95;8u);</Highlight></CodeLine>
<Link id="l04415" /><CodeLine lineNumber="4415"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04416" /><CodeLine lineNumber="4416"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> WorksharingLoopType::DistributeForStaticLoop:</Highlight></CodeLine>
<Link id="l04417" /><CodeLine lineNumber="4417"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 32)</Highlight></CodeLine>
<Link id="l04418" /><CodeLine lineNumber="4418"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder-&gt;getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04419" /><CodeLine lineNumber="4419"><Highlight kind="normal">          M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;distribute&#95;for&#95;static&#95;loop&#95;4u);</Highlight></CodeLine>
<Link id="l04420" /><CodeLine lineNumber="4420"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 64)</Highlight></CodeLine>
<Link id="l04421" /><CodeLine lineNumber="4421"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder-&gt;getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04422" /><CodeLine lineNumber="4422"><Highlight kind="normal">          M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;distribute&#95;for&#95;static&#95;loop&#95;8u);</Highlight></CodeLine>
<Link id="l04423" /><CodeLine lineNumber="4423"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04424" /><CodeLine lineNumber="4424"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04425" /><CodeLine lineNumber="4425"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth != 32 &amp;&amp; Bitwidth != 64) &#123;</Highlight></CodeLine>
<Link id="l04426" /><CodeLine lineNumber="4426"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unknown OpenMP loop iterator bitwidth&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04427" /><CodeLine lineNumber="4427"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04428" /><CodeLine lineNumber="4428"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unknown type of OpenMP worksharing loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04429" /><CodeLine lineNumber="4429"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04430" /><CodeLine lineNumber="4430"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04431" /><CodeLine lineNumber="4431"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Inserts a call to proper OpenMP Device RTL function which handles</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04432" /><CodeLine lineNumber="4432"><Highlight kind="normal"></Highlight><Highlight kind="comment">// loop worksharing.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04433" /><CodeLine lineNumber="4433" lineLink="#acae95016bcdeb105bcbcaaa872893f5f"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#acae95016bcdeb105bcbcaaa872893f5f">createTargetLoopWorkshareCall</a>(</Highlight></CodeLine>
<Link id="l04434" /><CodeLine lineNumber="4434"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42;OMPBuilder, <a href="/docs/api/namespaces/llvm/omp/#ab6fb146c332fd3f3d677ee65081fe669">WorksharingLoopType</a> LoopType,</Highlight></CodeLine>
<Link id="l04435" /><CodeLine lineNumber="4435"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;InsertBlock, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident, <a href="/docs/api/classes/llvm/value">Value</a> &#42;LoopBodyArg,</Highlight></CodeLine>
<Link id="l04436" /><CodeLine lineNumber="4436"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;ParallelTaskPtr, <a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount, <a href="/docs/api/classes/llvm/function">Function</a> &amp;LoopBodyFn) &#123;</Highlight></CodeLine>
<Link id="l04437" /><CodeLine lineNumber="4437"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;TripCountTy = TripCount-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l04438" /><CodeLine lineNumber="4438"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/module">Module</a> &amp;M = OMPBuilder-&gt;M;</Highlight></CodeLine>
<Link id="l04439" /><CodeLine lineNumber="4439"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> &amp;Builder = OMPBuilder-&gt;Builder;</Highlight></CodeLine>
<Link id="l04440" /><CodeLine lineNumber="4440"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> RTLFn =</Highlight></CodeLine>
<Link id="l04441" /><CodeLine lineNumber="4441"><Highlight kind="normal">      <a href="#aca27639a720491c7c7ea13c2bbe8c162">getKmpcForStaticLoopForType</a>(TripCountTy, OMPBuilder, LoopType);</Highlight></CodeLine>
<Link id="l04442" /><CodeLine lineNumber="4442"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 8&gt;</a> RealArgs;</Highlight></CodeLine>
<Link id="l04443" /><CodeLine lineNumber="4443"><Highlight kind="normal">  RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Ident);</Highlight></CodeLine>
<Link id="l04444" /><CodeLine lineNumber="4444"><Highlight kind="normal">  RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(&amp;LoopBodyFn, ParallelTaskPtr));</Highlight></CodeLine>
<Link id="l04445" /><CodeLine lineNumber="4445"><Highlight kind="normal">  RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LoopBodyArg);</Highlight></CodeLine>
<Link id="l04446" /><CodeLine lineNumber="4446"><Highlight kind="normal">  RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(TripCount);</Highlight></CodeLine>
<Link id="l04447" /><CodeLine lineNumber="4447"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LoopType == WorksharingLoopType::DistributeStaticLoop) &#123;</Highlight></CodeLine>
<Link id="l04448" /><CodeLine lineNumber="4448"><Highlight kind="normal">    RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(ConstantInt::get(TripCountTy, 0));</Highlight></CodeLine>
<Link id="l04449" /><CodeLine lineNumber="4449"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(RTLFn, RealArgs);</Highlight></CodeLine>
<Link id="l04450" /><CodeLine lineNumber="4450"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04451" /><CodeLine lineNumber="4451"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04452" /><CodeLine lineNumber="4452"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> RTLNumThreads = OMPBuilder-&gt;getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04453" /><CodeLine lineNumber="4453"><Highlight kind="normal">      M, omp::RuntimeFunction::OMPRTL&#95;omp&#95;get&#95;num&#95;threads);</Highlight></CodeLine>
<Link id="l04454" /><CodeLine lineNumber="4454"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#123;InsertBlock, std::prev(InsertBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>())&#125;);</Highlight></CodeLine>
<Link id="l04455" /><CodeLine lineNumber="4455"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumThreads = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(RTLNumThreads, &#123;&#125;);</Highlight></CodeLine>
<Link id="l04456" /><CodeLine lineNumber="4456"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04457" /><CodeLine lineNumber="4457"><Highlight kind="normal">  RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight></CodeLine>
<Link id="l04458" /><CodeLine lineNumber="4458"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a36742c35a8fff5f74bb3d76c9c19dd47">CreateZExtOrTrunc</a>(NumThreads, TripCountTy, </Highlight><Highlight kind="stringliteral">&quot;num.threads.cast&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l04459" /><CodeLine lineNumber="4459"><Highlight kind="normal">  RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(ConstantInt::get(TripCountTy, 0));</Highlight></CodeLine>
<Link id="l04460" /><CodeLine lineNumber="4460"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LoopType == WorksharingLoopType::DistributeForStaticLoop) &#123;</Highlight></CodeLine>
<Link id="l04461" /><CodeLine lineNumber="4461"><Highlight kind="normal">    RealArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(ConstantInt::get(TripCountTy, 0));</Highlight></CodeLine>
<Link id="l04462" /><CodeLine lineNumber="4462"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04463" /><CodeLine lineNumber="4463"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04464" /><CodeLine lineNumber="4464"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(RTLFn, RealArgs);</Highlight></CodeLine>
<Link id="l04465" /><CodeLine lineNumber="4465"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04466" /><CodeLine lineNumber="4466"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04467" /><CodeLine lineNumber="4467"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04468" /><CodeLine lineNumber="4468" lineLink="#aa2a5199bf39360e25f40b93cd5f9468a"><Highlight kind="normal"><a href="#aa2a5199bf39360e25f40b93cd5f9468a">workshareLoopTargetCallback</a>(<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &#42;OMPIRBuilder,</Highlight></CodeLine>
<Link id="l04469" /><CodeLine lineNumber="4469"><Highlight kind="normal">                            <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CLI, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident,</Highlight></CodeLine>
<Link id="l04470" /><CodeLine lineNumber="4470"><Highlight kind="normal">                            <a href="/docs/api/classes/llvm/function">Function</a> &amp;OutlinedFn, <a href="/docs/api/classes/llvm/type">Type</a> &#42;ParallelTaskPtr,</Highlight></CodeLine>
<Link id="l04471" /><CodeLine lineNumber="4471"><Highlight kind="normal">                            </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Instruction &#42;, 4&gt;</a> &amp;ToBeDeleted,</Highlight></CodeLine>
<Link id="l04472" /><CodeLine lineNumber="4472"><Highlight kind="normal">                            <a href="/docs/api/namespaces/llvm/omp/#ab6fb146c332fd3f3d677ee65081fe669">WorksharingLoopType</a> LoopType) &#123;</Highlight></CodeLine>
<Link id="l04473" /><CodeLine lineNumber="4473"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> &amp;Builder = OMPIRBuilder-&gt;Builder;</Highlight></CodeLine>
<Link id="l04474" /><CodeLine lineNumber="4474"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Preheader = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>();</Highlight></CodeLine>
<Link id="l04475" /><CodeLine lineNumber="4475"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01560f4a4ff7bfc8a96bd406b6f17ea2">getTripCount</a>();</Highlight></CodeLine>
<Link id="l04476" /><CodeLine lineNumber="4476"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04477" /><CodeLine lineNumber="4477"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// After loop body outling, the loop body contains only set up</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04478" /><CodeLine lineNumber="4478"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// of loop body argument structure and the call to the outlined</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04479" /><CodeLine lineNumber="4479"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// loop body function. Firstly, we need to move setup of loop body args</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04480" /><CodeLine lineNumber="4480"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// into loop preheader.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04481" /><CodeLine lineNumber="4481"><Highlight kind="normal">  Preheader-&gt;<a href="/docs/api/classes/llvm/basicblock/#af29f89e91dfd0ae90950f0b1bf49798d">splice</a>(std::prev(Preheader-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()), CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>(),</Highlight></CodeLine>
<Link id="l04482" /><CodeLine lineNumber="4482"><Highlight kind="normal">                    CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(), std::prev(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()));</Highlight></CodeLine>
<Link id="l04483" /><CodeLine lineNumber="4483"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04484" /><CodeLine lineNumber="4484"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The next step is to remove the whole loop. We do not it need anymore.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04485" /><CodeLine lineNumber="4485"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// That&#39;s why make an unconditional branch from loop preheader to loop</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04486" /><CodeLine lineNumber="4486"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// exit block</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04487" /><CodeLine lineNumber="4487"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#123;Preheader, Preheader-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0b4e7bee9b8575cc7db73329f1a561bd">end</a>()&#125;);</Highlight></CodeLine>
<Link id="l04488" /><CodeLine lineNumber="4488"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(Preheader-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</Highlight></CodeLine>
<Link id="l04489" /><CodeLine lineNumber="4489"><Highlight kind="normal">  Preheader-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l04490" /><CodeLine lineNumber="4490"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>());</Highlight></CodeLine>
<Link id="l04491" /><CodeLine lineNumber="4491"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04492" /><CodeLine lineNumber="4492"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Delete dead loop blocks</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04493" /><CodeLine lineNumber="4493"><Highlight kind="normal">  OpenMPIRBuilder::OutlineInfo CleanUpInfo;</Highlight></CodeLine>
<Link id="l04494" /><CodeLine lineNumber="4494"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;BasicBlock &#42;, 32&gt;</a> RegionBlockSet;</Highlight></CodeLine>
<Link id="l04495" /><CodeLine lineNumber="4495"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 32&gt;</a> BlocksToBeRemoved;</Highlight></CodeLine>
<Link id="l04496" /><CodeLine lineNumber="4496"><Highlight kind="normal">  CleanUpInfo.EntryBB = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01c4471afa921c4962d7138cfcef4942">getHeader</a>();</Highlight></CodeLine>
<Link id="l04497" /><CodeLine lineNumber="4497"><Highlight kind="normal">  CleanUpInfo.ExitBB = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>();</Highlight></CodeLine>
<Link id="l04498" /><CodeLine lineNumber="4498"><Highlight kind="normal">  CleanUpInfo.collectBlocks(RegionBlockSet, BlocksToBeRemoved);</Highlight></CodeLine>
<Link id="l04499" /><CodeLine lineNumber="4499"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#addf42fea14164ec994d4d517eaa56688">DeleteDeadBlocks</a>(BlocksToBeRemoved);</Highlight></CodeLine>
<Link id="l04500" /><CodeLine lineNumber="4500"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04501" /><CodeLine lineNumber="4501"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Find the instruction which corresponds to loop body argument structure</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04502" /><CodeLine lineNumber="4502"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and remove the call to loop body function instruction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04503" /><CodeLine lineNumber="4503"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;LoopBodyArg;</Highlight></CodeLine>
<Link id="l04504" /><CodeLine lineNumber="4504"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/user">User</a> &#42;OutlinedFnUser = OutlinedFn.<a href="/docs/api/classes/llvm/value/#a93270009c3358fba0a61654a9376ab4c">getUniqueUndroppableUser</a>();</Highlight></CodeLine>
<Link id="l04505" /><CodeLine lineNumber="4505"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFnUser &amp;&amp;</Highlight></CodeLine>
<Link id="l04506" /><CodeLine lineNumber="4506"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Expected unique undroppable user of outlined function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04507" /><CodeLine lineNumber="4507"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;OutlinedFnCallInstruction = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;CallInst&gt;</a>(OutlinedFnUser);</Highlight></CodeLine>
<Link id="l04508" /><CodeLine lineNumber="4508"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFnCallInstruction &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected outlined function call&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04509" /><CodeLine lineNumber="4509"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((OutlinedFnCallInstruction-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() == Preheader) &amp;&amp;</Highlight></CodeLine>
<Link id="l04510" /><CodeLine lineNumber="4510"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Expected outlined function call to be located in loop preheader&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04511" /><CodeLine lineNumber="4511"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check in case no argument structure has been passed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04512" /><CodeLine lineNumber="4512"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OutlinedFnCallInstruction-&gt;<a href="/docs/api/classes/llvm/callbase/#adde2ea00dd2613ee41bfe91908e4e68e">arg&#95;size</a>() &gt; 1)</Highlight></CodeLine>
<Link id="l04513" /><CodeLine lineNumber="4513"><Highlight kind="normal">    LoopBodyArg = OutlinedFnCallInstruction-&gt;<a href="/docs/api/classes/llvm/callbase/#aabd76e6a8a23a5af1ce4d3c310d88bcd">getArgOperand</a>(1);</Highlight></CodeLine>
<Link id="l04514" /><CodeLine lineNumber="4514"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04515" /><CodeLine lineNumber="4515"><Highlight kind="normal">    LoopBodyArg = <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l04516" /><CodeLine lineNumber="4516"><Highlight kind="normal">  OutlinedFnCallInstruction-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l04517" /><CodeLine lineNumber="4517"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04518" /><CodeLine lineNumber="4518"><Highlight kind="normal">  <a href="#acae95016bcdeb105bcbcaaa872893f5f">createTargetLoopWorkshareCall</a>(OMPIRBuilder, LoopType, Preheader, Ident,</Highlight></CodeLine>
<Link id="l04519" /><CodeLine lineNumber="4519"><Highlight kind="normal">                                LoopBodyArg, ParallelTaskPtr, TripCount,</Highlight></CodeLine>
<Link id="l04520" /><CodeLine lineNumber="4520"><Highlight kind="normal">                                OutlinedFn);</Highlight></CodeLine>
<Link id="l04521" /><CodeLine lineNumber="4521"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04522" /><CodeLine lineNumber="4522"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;ToBeDeletedItem : ToBeDeleted)</Highlight></CodeLine>
<Link id="l04523" /><CodeLine lineNumber="4523"><Highlight kind="normal">    ToBeDeletedItem-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l04524" /><CodeLine lineNumber="4524"><Highlight kind="normal">  CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a9ce55b05f8ad85126fc92eeeb35457c7">invalidate</a>();</Highlight></CodeLine>
<Link id="l04525" /><CodeLine lineNumber="4525"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04526" /><CodeLine lineNumber="4526"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04527" /><CodeLine lineNumber="4527"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a></Highlight></CodeLine>
<Link id="l04528" /><CodeLine lineNumber="4528"><Highlight kind="normal">OpenMPIRBuilder::applyWorkshareLoopTarget(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CLI,</Highlight></CodeLine>
<Link id="l04529" /><CodeLine lineNumber="4529"><Highlight kind="normal">                                          InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l04530" /><CodeLine lineNumber="4530"><Highlight kind="normal">                                          <a href="/docs/api/namespaces/llvm/omp/#ab6fb146c332fd3f3d677ee65081fe669">WorksharingLoopType</a> LoopType) &#123;</Highlight></CodeLine>
<Link id="l04531" /><CodeLine lineNumber="4531"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l04532" /><CodeLine lineNumber="4532"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l04533" /><CodeLine lineNumber="4533"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l04534" /><CodeLine lineNumber="4534"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04535" /><CodeLine lineNumber="4535"><Highlight kind="normal">  OutlineInfo OI;</Highlight></CodeLine>
<Link id="l04536" /><CodeLine lineNumber="4536"><Highlight kind="normal">  OI.OuterAllocaBB = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>();</Highlight></CodeLine>
<Link id="l04537" /><CodeLine lineNumber="4537"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;OuterFn = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l04538" /><CodeLine lineNumber="4538"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04539" /><CodeLine lineNumber="4539"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Instructions which need to be deleted at the end of code generation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04540" /><CodeLine lineNumber="4540"><Highlight kind="normal">  SmallVector&lt;Instruction &#42;, 4&gt; ToBeDeleted;</Highlight></CodeLine>
<Link id="l04541" /><CodeLine lineNumber="4541"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04542" /><CodeLine lineNumber="4542"><Highlight kind="normal">  OI.OuterAllocaBB = AllocaIP.getBlock();</Highlight></CodeLine>
<Link id="l04543" /><CodeLine lineNumber="4543"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04544" /><CodeLine lineNumber="4544"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Mark the body loop as region which needs to be extracted</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04545" /><CodeLine lineNumber="4545"><Highlight kind="normal">  OI.EntryBB = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>();</Highlight></CodeLine>
<Link id="l04546" /><CodeLine lineNumber="4546"><Highlight kind="normal">  OI.ExitBB = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>(),</Highlight></CodeLine>
<Link id="l04547" /><CodeLine lineNumber="4547"><Highlight kind="normal">                                               </Highlight><Highlight kind="stringliteral">&quot;omp.prelatch&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04548" /><CodeLine lineNumber="4548"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04549" /><CodeLine lineNumber="4549"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Prepare loop body for extraction</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04550" /><CodeLine lineNumber="4550"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#123;CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>(), CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>()&#125;);</Highlight></CodeLine>
<Link id="l04551" /><CodeLine lineNumber="4551"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04552" /><CodeLine lineNumber="4552"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Insert new loop counter variable which will be used only in loop</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04553" /><CodeLine lineNumber="4553"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// body.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04554" /><CodeLine lineNumber="4554"><Highlight kind="normal">  AllocaInst &#42;NewLoopCnt = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a46b5cd2a0881c8be5183d70a32eef90d">getIndVarType</a>(), 0, </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04555" /><CodeLine lineNumber="4555"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;NewLoopCntLoad =</Highlight></CodeLine>
<Link id="l04556" /><CodeLine lineNumber="4556"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a46b5cd2a0881c8be5183d70a32eef90d">getIndVarType</a>(), NewLoopCnt);</Highlight></CodeLine>
<Link id="l04557" /><CodeLine lineNumber="4557"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// New loop counter instructions are redundant in the loop preheader when</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04558" /><CodeLine lineNumber="4558"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// code generation for workshare loop is finshed. That&#39;s why mark them as</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04559" /><CodeLine lineNumber="4559"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ready for deletion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04560" /><CodeLine lineNumber="4560"><Highlight kind="normal">  ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NewLoopCntLoad);</Highlight></CodeLine>
<Link id="l04561" /><CodeLine lineNumber="4561"><Highlight kind="normal">  ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NewLoopCnt);</Highlight></CodeLine>
<Link id="l04562" /><CodeLine lineNumber="4562"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04563" /><CodeLine lineNumber="4563"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Analyse loop body region. Find all input variables which are used inside</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04564" /><CodeLine lineNumber="4564"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// loop body region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04565" /><CodeLine lineNumber="4565"><Highlight kind="normal">  SmallPtrSet&lt;BasicBlock &#42;, 32&gt; ParallelRegionBlockSet;</Highlight></CodeLine>
<Link id="l04566" /><CodeLine lineNumber="4566"><Highlight kind="normal">  SmallVector&lt;BasicBlock &#42;, 32&gt; Blocks;</Highlight></CodeLine>
<Link id="l04567" /><CodeLine lineNumber="4567"><Highlight kind="normal">  OI.collectBlocks(ParallelRegionBlockSet, Blocks);</Highlight></CodeLine>
<Link id="l04568" /><CodeLine lineNumber="4568"><Highlight kind="normal">  SmallVector&lt;BasicBlock &#42;, 32&gt; BlocksT(ParallelRegionBlockSet.<a href="/docs/api/classes/llvm/smallptrsetimpl/#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>(),</Highlight></CodeLine>
<Link id="l04569" /><CodeLine lineNumber="4569"><Highlight kind="normal">                                        ParallelRegionBlockSet.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a7004354fbee1c8cd74ed9001915e1db5">end</a>());</Highlight></CodeLine>
<Link id="l04570" /><CodeLine lineNumber="4570"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04571" /><CodeLine lineNumber="4571"><Highlight kind="normal">  CodeExtractorAnalysisCache CEAC(&#42;OuterFn);</Highlight></CodeLine>
<Link id="l04572" /><CodeLine lineNumber="4572"><Highlight kind="normal">  CodeExtractor Extractor(Blocks,</Highlight></CodeLine>
<Link id="l04573" /><CodeLine lineNumber="4573"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; DominatorTree &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04574" /><CodeLine lineNumber="4574"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AggregateArgs &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04575" /><CodeLine lineNumber="4575"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; BlockFrequencyInfo &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04576" /><CodeLine lineNumber="4576"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; BranchProbabilityInfo &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04577" /><CodeLine lineNumber="4577"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AssumptionCache &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04578" /><CodeLine lineNumber="4578"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AllowVarArgs &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04579" /><CodeLine lineNumber="4579"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AllowAlloca &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04580" /><CodeLine lineNumber="4580"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AllocationBlock &#42;/</Highlight><Highlight kind="normal"> CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>(),</Highlight></CodeLine>
<Link id="l04581" /><CodeLine lineNumber="4581"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; Suffix &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="stringliteral">&quot;.omp&#95;wsloop&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04582" /><CodeLine lineNumber="4582"><Highlight kind="normal">                          </Highlight><Highlight kind="comment">/&#42; AggrArgsIn0AddrSpace &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04583" /><CodeLine lineNumber="4583"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04584" /><CodeLine lineNumber="4584"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CommonExit = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04585" /><CodeLine lineNumber="4585"><Highlight kind="normal">  SetVector&lt;Value &#42;&gt; Inputs, Outputs, SinkingCands, HoistingCands;</Highlight></CodeLine>
<Link id="l04586" /><CodeLine lineNumber="4586"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04587" /><CodeLine lineNumber="4587"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Find allocas outside the loop body region which are used inside loop</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04588" /><CodeLine lineNumber="4588"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// body</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04589" /><CodeLine lineNumber="4589"><Highlight kind="normal">  Extractor.findAllocas(CEAC, SinkingCands, HoistingCands, CommonExit);</Highlight></CodeLine>
<Link id="l04590" /><CodeLine lineNumber="4590"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04591" /><CodeLine lineNumber="4591"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We need to model loop body region as the function f(cnt, loop&#95;arg).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04592" /><CodeLine lineNumber="4592"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// That&#39;s why we replace loop induction variable by the new counter</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04593" /><CodeLine lineNumber="4593"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// which will be one of loop body function argument</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04594" /><CodeLine lineNumber="4594"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;User &#42;&gt;</a> <a href="/docs/api/files/lib/lib/analysis/ivusers-cpp/#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>()-&gt;<a href="/docs/api/classes/llvm/value/#a158da2b6d3d938aaa15b6acd00150e2c">user&#95;begin</a>(),</Highlight></CodeLine>
<Link id="l04595" /><CodeLine lineNumber="4595"><Highlight kind="normal">                            CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>()-&gt;<a href="/docs/api/classes/llvm/value/#aa22118b2b3f206bfda2ffab4cda94d64">user&#95;end</a>());</Highlight></CodeLine>
<Link id="l04596" /><CodeLine lineNumber="4596"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Use : <a href="/docs/api/files/lib/lib/analysis/ivusers-cpp/#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>) &#123;</Highlight></CodeLine>
<Link id="l04597" /><CodeLine lineNumber="4597"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Instruction &#42;Inst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(Use)) &#123;</Highlight></CodeLine>
<Link id="l04598" /><CodeLine lineNumber="4598"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ParallelRegionBlockSet.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(Inst-&gt;getParent())) &#123;</Highlight></CodeLine>
<Link id="l04599" /><CodeLine lineNumber="4599"><Highlight kind="normal">        Inst-&gt;replaceUsesOfWith(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>(), NewLoopCntLoad);</Highlight></CodeLine>
<Link id="l04600" /><CodeLine lineNumber="4600"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04601" /><CodeLine lineNumber="4601"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04602" /><CodeLine lineNumber="4602"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04603" /><CodeLine lineNumber="4603"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Make sure that loop counter variable is not merged into loop body</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04604" /><CodeLine lineNumber="4604"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// function argument structure and it is passed as separate variable</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04605" /><CodeLine lineNumber="4605"><Highlight kind="normal">  OI.ExcludeArgsFromAggregate.push&#95;back(NewLoopCntLoad);</Highlight></CodeLine>
<Link id="l04606" /><CodeLine lineNumber="4606"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04607" /><CodeLine lineNumber="4607"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// PostOutline CB is invoked when loop body function is outlined and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04608" /><CodeLine lineNumber="4608"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// loop body is replaced by call to outlined function. We need to add</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04609" /><CodeLine lineNumber="4609"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// call to OpenMP device rtl inside loop preheader. OpenMP device rtl</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04610" /><CodeLine lineNumber="4610"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// function will handle loop control logic.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04611" /><CodeLine lineNumber="4611"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04612" /><CodeLine lineNumber="4612"><Highlight kind="normal">  OI.PostOutlineCB = &#91;=, ToBeDeletedVec =</Highlight></CodeLine>
<Link id="l04613" /><CodeLine lineNumber="4613"><Highlight kind="normal">                             std::move(ToBeDeleted)&#93;(<a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &amp;OutlinedFn) &#123;</Highlight></CodeLine>
<Link id="l04614" /><CodeLine lineNumber="4614"><Highlight kind="normal">    <a href="#aa2a5199bf39360e25f40b93cd5f9468a">workshareLoopTargetCallback</a>(</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, CLI, Ident, OutlinedFn, ParallelTaskPtr,</Highlight></CodeLine>
<Link id="l04615" /><CodeLine lineNumber="4615"><Highlight kind="normal">                                ToBeDeletedVec, LoopType);</Highlight></CodeLine>
<Link id="l04616" /><CodeLine lineNumber="4616"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l04617" /><CodeLine lineNumber="4617"><Highlight kind="normal">  addOutlineInfo(std::move(OI));</Highlight></CodeLine>
<Link id="l04618" /><CodeLine lineNumber="4618"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a578dd7d619d0ccfc6ace07aa380022cc">getAfterIP</a>();</Highlight></CodeLine>
<Link id="l04619" /><CodeLine lineNumber="4619"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04620" /><CodeLine lineNumber="4620"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04621" /><CodeLine lineNumber="4621" lineLink="/docs/api/classes/llvm/openmpirbuilder/#adaa14806d128ad33bdc48d2bfc46870c"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> <a href="/docs/api/classes/llvm/openmpirbuilder/#adaa14806d128ad33bdc48d2bfc46870c">OpenMPIRBuilder::applyWorkshareLoop</a>(</Highlight></CodeLine>
<Link id="l04622" /><CodeLine lineNumber="4622"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CLI, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP,</Highlight></CodeLine>
<Link id="l04623" /><CodeLine lineNumber="4623"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> NeedsBarrier, omp::ScheduleKind SchedKind, <a href="/docs/api/classes/llvm/value">Value</a> &#42;ChunkSize,</Highlight></CodeLine>
<Link id="l04624" /><CodeLine lineNumber="4624"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasSimdModifier, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasMonotonicModifier,</Highlight></CodeLine>
<Link id="l04625" /><CodeLine lineNumber="4625"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasNonmonotonicModifier, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasOrderedClause,</Highlight></CodeLine>
<Link id="l04626" /><CodeLine lineNumber="4626"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#ab6fb146c332fd3f3d677ee65081fe669">WorksharingLoopType</a> LoopType) &#123;</Highlight></CodeLine>
<Link id="l04627" /><CodeLine lineNumber="4627"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice())</Highlight></CodeLine>
<Link id="l04628" /><CodeLine lineNumber="4628"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> applyWorkshareLoopTarget(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CLI, AllocaIP, LoopType);</Highlight></CodeLine>
<Link id="l04629" /><CodeLine lineNumber="4629"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> EffectiveScheduleType = <a href="#a554000c782275642b783964853720bee">computeOpenMPScheduleType</a>(</Highlight></CodeLine>
<Link id="l04630" /><CodeLine lineNumber="4630"><Highlight kind="normal">      SchedKind, ChunkSize, HasSimdModifier, HasMonotonicModifier,</Highlight></CodeLine>
<Link id="l04631" /><CodeLine lineNumber="4631"><Highlight kind="normal">      HasNonmonotonicModifier, HasOrderedClause);</Highlight></CodeLine>
<Link id="l04632" /><CodeLine lineNumber="4632"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04633" /><CodeLine lineNumber="4633"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsOrdered = (EffectiveScheduleType &amp; OMPScheduleType::ModifierOrdered) ==</Highlight></CodeLine>
<Link id="l04634" /><CodeLine lineNumber="4634"><Highlight kind="normal">                   OMPScheduleType::ModifierOrdered;</Highlight></CodeLine>
<Link id="l04635" /><CodeLine lineNumber="4635"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (EffectiveScheduleType &amp; ~OMPScheduleType::ModifierMask) &#123;</Highlight></CodeLine>
<Link id="l04636" /><CodeLine lineNumber="4636"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseStatic:</Highlight></CodeLine>
<Link id="l04637" /><CodeLine lineNumber="4637"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!ChunkSize &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;No chunk size with static-chunked schedule&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04638" /><CodeLine lineNumber="4638"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsOrdered)</Highlight></CodeLine>
<Link id="l04639" /><CodeLine lineNumber="4639"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> applyDynamicWorkshareLoop(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CLI, AllocaIP, EffectiveScheduleType,</Highlight></CodeLine>
<Link id="l04640" /><CodeLine lineNumber="4640"><Highlight kind="normal">                                       NeedsBarrier, ChunkSize);</Highlight></CodeLine>
<Link id="l04641" /><CodeLine lineNumber="4641"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// FIXME: Monotonicity ignored?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04642" /><CodeLine lineNumber="4642"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> applyStaticWorkshareLoop(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CLI, AllocaIP, NeedsBarrier);</Highlight></CodeLine>
<Link id="l04643" /><CodeLine lineNumber="4643"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04644" /><CodeLine lineNumber="4644"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseStaticChunked:</Highlight></CodeLine>
<Link id="l04645" /><CodeLine lineNumber="4645"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsOrdered)</Highlight></CodeLine>
<Link id="l04646" /><CodeLine lineNumber="4646"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> applyDynamicWorkshareLoop(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CLI, AllocaIP, EffectiveScheduleType,</Highlight></CodeLine>
<Link id="l04647" /><CodeLine lineNumber="4647"><Highlight kind="normal">                                       NeedsBarrier, ChunkSize);</Highlight></CodeLine>
<Link id="l04648" /><CodeLine lineNumber="4648"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// FIXME: Monotonicity ignored?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04649" /><CodeLine lineNumber="4649"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> applyStaticChunkedWorkshareLoop(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CLI, AllocaIP, NeedsBarrier,</Highlight></CodeLine>
<Link id="l04650" /><CodeLine lineNumber="4650"><Highlight kind="normal">                                           ChunkSize);</Highlight></CodeLine>
<Link id="l04651" /><CodeLine lineNumber="4651"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04652" /><CodeLine lineNumber="4652"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseRuntime:</Highlight></CodeLine>
<Link id="l04653" /><CodeLine lineNumber="4653"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseAuto:</Highlight></CodeLine>
<Link id="l04654" /><CodeLine lineNumber="4654"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseGreedy:</Highlight></CodeLine>
<Link id="l04655" /><CodeLine lineNumber="4655"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseBalanced:</Highlight></CodeLine>
<Link id="l04656" /><CodeLine lineNumber="4656"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseSteal:</Highlight></CodeLine>
<Link id="l04657" /><CodeLine lineNumber="4657"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseGuidedSimd:</Highlight></CodeLine>
<Link id="l04658" /><CodeLine lineNumber="4658"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseRuntimeSimd:</Highlight></CodeLine>
<Link id="l04659" /><CodeLine lineNumber="4659"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!ChunkSize &amp;&amp;</Highlight></CodeLine>
<Link id="l04660" /><CodeLine lineNumber="4660"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;schedule type does not support user-defined chunk sizes&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04661" /><CodeLine lineNumber="4661"><Highlight kind="normal">    &#91;&#91;fallthrough&#93;&#93;;</Highlight></CodeLine>
<Link id="l04662" /><CodeLine lineNumber="4662"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseDynamicChunked:</Highlight></CodeLine>
<Link id="l04663" /><CodeLine lineNumber="4663"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseGuidedChunked:</Highlight></CodeLine>
<Link id="l04664" /><CodeLine lineNumber="4664"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseGuidedIterativeChunked:</Highlight></CodeLine>
<Link id="l04665" /><CodeLine lineNumber="4665"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseGuidedAnalyticalChunked:</Highlight></CodeLine>
<Link id="l04666" /><CodeLine lineNumber="4666"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OMPScheduleType::BaseStaticBalancedChunked:</Highlight></CodeLine>
<Link id="l04667" /><CodeLine lineNumber="4667"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> applyDynamicWorkshareLoop(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CLI, AllocaIP, EffectiveScheduleType,</Highlight></CodeLine>
<Link id="l04668" /><CodeLine lineNumber="4668"><Highlight kind="normal">                                     NeedsBarrier, ChunkSize);</Highlight></CodeLine>
<Link id="l04669" /><CodeLine lineNumber="4669"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04670" /><CodeLine lineNumber="4670"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l04671" /><CodeLine lineNumber="4671"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unknown/unimplemented schedule kind&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04672" /><CodeLine lineNumber="4672"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04673" /><CodeLine lineNumber="4673"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04674" /><CodeLine lineNumber="4674"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04675" /><CodeLine lineNumber="4675"><Highlight kind="comment">/// Returns an LLVM function to call for initializing loop bounds using OpenMP</Highlight></CodeLine>
<Link id="l04676" /><CodeLine lineNumber="4676"><Highlight kind="comment">/// dynamic scheduling depending on &#96;type&#96;. Only i32 and i64 are supported by</Highlight></CodeLine>
<Link id="l04677" /><CodeLine lineNumber="4677"><Highlight kind="comment">/// the runtime. Always interpret integers as unsigned similarly to</Highlight></CodeLine>
<Link id="l04678" /><CodeLine lineNumber="4678"><Highlight kind="comment">/// CanonicalLoopInfo.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04679" /><CodeLine lineNumber="4679"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></Highlight></CodeLine>
<Link id="l04680" /><CodeLine lineNumber="4680" lineLink="#a7a68322ba864bccb8736e42fbc915a8a"><Highlight kind="normal"><a href="#a7a68322ba864bccb8736e42fbc915a8a">getKmpcForDynamicInitForType</a>(<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty, <a href="/docs/api/classes/llvm/module">Module</a> &amp;M, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder) &#123;</Highlight></CodeLine>
<Link id="l04681" /><CodeLine lineNumber="4681"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Bitwidth = Ty-&gt;getIntegerBitWidth();</Highlight></CodeLine>
<Link id="l04682" /><CodeLine lineNumber="4682"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 32)</Highlight></CodeLine>
<Link id="l04683" /><CodeLine lineNumber="4683"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04684" /><CodeLine lineNumber="4684"><Highlight kind="normal">        M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;init&#95;4u);</Highlight></CodeLine>
<Link id="l04685" /><CodeLine lineNumber="4685"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 64)</Highlight></CodeLine>
<Link id="l04686" /><CodeLine lineNumber="4686"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04687" /><CodeLine lineNumber="4687"><Highlight kind="normal">        M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;init&#95;8u);</Highlight></CodeLine>
<Link id="l04688" /><CodeLine lineNumber="4688"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;unknown OpenMP loop iterator bitwidth&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04689" /><CodeLine lineNumber="4689"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04690" /><CodeLine lineNumber="4690"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04691" /><CodeLine lineNumber="4691"><Highlight kind="comment">/// Returns an LLVM function to call for updating the next loop using OpenMP</Highlight></CodeLine>
<Link id="l04692" /><CodeLine lineNumber="4692"><Highlight kind="comment">/// dynamic scheduling depending on &#96;type&#96;. Only i32 and i64 are supported by</Highlight></CodeLine>
<Link id="l04693" /><CodeLine lineNumber="4693"><Highlight kind="comment">/// the runtime. Always interpret integers as unsigned similarly to</Highlight></CodeLine>
<Link id="l04694" /><CodeLine lineNumber="4694"><Highlight kind="comment">/// CanonicalLoopInfo.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04695" /><CodeLine lineNumber="4695"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></Highlight></CodeLine>
<Link id="l04696" /><CodeLine lineNumber="4696" lineLink="#a74bf2240e1da04168d57a7534c9613f7"><Highlight kind="normal"><a href="#a74bf2240e1da04168d57a7534c9613f7">getKmpcForDynamicNextForType</a>(<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty, <a href="/docs/api/classes/llvm/module">Module</a> &amp;M, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder) &#123;</Highlight></CodeLine>
<Link id="l04697" /><CodeLine lineNumber="4697"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Bitwidth = Ty-&gt;getIntegerBitWidth();</Highlight></CodeLine>
<Link id="l04698" /><CodeLine lineNumber="4698"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 32)</Highlight></CodeLine>
<Link id="l04699" /><CodeLine lineNumber="4699"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04700" /><CodeLine lineNumber="4700"><Highlight kind="normal">        M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;next&#95;4u);</Highlight></CodeLine>
<Link id="l04701" /><CodeLine lineNumber="4701"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 64)</Highlight></CodeLine>
<Link id="l04702" /><CodeLine lineNumber="4702"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04703" /><CodeLine lineNumber="4703"><Highlight kind="normal">        M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;next&#95;8u);</Highlight></CodeLine>
<Link id="l04704" /><CodeLine lineNumber="4704"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;unknown OpenMP loop iterator bitwidth&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04705" /><CodeLine lineNumber="4705"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04706" /><CodeLine lineNumber="4706"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04707" /><CodeLine lineNumber="4707"><Highlight kind="comment">/// Returns an LLVM function to call for finalizing the dynamic loop using</Highlight></CodeLine>
<Link id="l04708" /><CodeLine lineNumber="4708"><Highlight kind="comment">/// depending on &#96;type&#96;. Only i32 and i64 are supported by the runtime. Always</Highlight></CodeLine>
<Link id="l04709" /><CodeLine lineNumber="4709"><Highlight kind="comment">/// interpret integers as unsigned similarly to CanonicalLoopInfo.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04710" /><CodeLine lineNumber="4710"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></Highlight></CodeLine>
<Link id="l04711" /><CodeLine lineNumber="4711" lineLink="#a3d17252beff7921e40622170990c89ab"><Highlight kind="normal"><a href="#a3d17252beff7921e40622170990c89ab">getKmpcForDynamicFiniForType</a>(<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty, <a href="/docs/api/classes/llvm/module">Module</a> &amp;M, <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder) &#123;</Highlight></CodeLine>
<Link id="l04712" /><CodeLine lineNumber="4712"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Bitwidth = Ty-&gt;getIntegerBitWidth();</Highlight></CodeLine>
<Link id="l04713" /><CodeLine lineNumber="4713"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 32)</Highlight></CodeLine>
<Link id="l04714" /><CodeLine lineNumber="4714"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04715" /><CodeLine lineNumber="4715"><Highlight kind="normal">        M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;fini&#95;4u);</Highlight></CodeLine>
<Link id="l04716" /><CodeLine lineNumber="4716"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Bitwidth == 64)</Highlight></CodeLine>
<Link id="l04717" /><CodeLine lineNumber="4717"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.getOrCreateRuntimeFunction(</Highlight></CodeLine>
<Link id="l04718" /><CodeLine lineNumber="4718"><Highlight kind="normal">        M, omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;fini&#95;8u);</Highlight></CodeLine>
<Link id="l04719" /><CodeLine lineNumber="4719"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;unknown OpenMP loop iterator bitwidth&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04720" /><CodeLine lineNumber="4720"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04721" /><CodeLine lineNumber="4721"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04722" /><CodeLine lineNumber="4722"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l04723" /><CodeLine lineNumber="4723"><Highlight kind="normal">OpenMPIRBuilder::applyDynamicWorkshareLoop(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CLI,</Highlight></CodeLine>
<Link id="l04724" /><CodeLine lineNumber="4724"><Highlight kind="normal">                                           InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l04725" /><CodeLine lineNumber="4725"><Highlight kind="normal">                                           <a href="/docs/api/namespaces/llvm/omp/#a231ea6a9a0009e38969a20d4293119c7">OMPScheduleType</a> SchedType,</Highlight></CodeLine>
<Link id="l04726" /><CodeLine lineNumber="4726"><Highlight kind="normal">                                           </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> NeedsBarrier, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Chunk) &#123;</Highlight></CodeLine>
<Link id="l04727" /><CodeLine lineNumber="4727"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a4b2b7074e300c251f7cb8913620b1d80">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Requires a valid canonical loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04728" /><CodeLine lineNumber="4728"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="#a756b28f370cd5a39bc0ee3e5333b9c9b">isConflictIP</a>(AllocaIP, CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac72ebc430ef7dcf1791c66080ddedd9d">getPreheaderIP</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l04729" /><CodeLine lineNumber="4729"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Require dedicated allocate IP&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04730" /><CodeLine lineNumber="4730"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a596dcc3bb2ae8b7561e94095584e0f1e">isValidWorkshareLoopScheduleType</a>(SchedType) &amp;&amp;</Highlight></CodeLine>
<Link id="l04731" /><CodeLine lineNumber="4731"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Require valid schedule type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04732" /><CodeLine lineNumber="4732"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04733" /><CodeLine lineNumber="4733"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Ordered = (SchedType &amp; OMPScheduleType::ModifierOrdered) ==</Highlight></CodeLine>
<Link id="l04734" /><CodeLine lineNumber="4734"><Highlight kind="normal">                 OMPScheduleType::ModifierOrdered;</Highlight></CodeLine>
<Link id="l04735" /><CodeLine lineNumber="4735"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04736" /><CodeLine lineNumber="4736"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Set up the source location value for OpenMP runtime.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04737" /><CodeLine lineNumber="4737"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04738" /><CodeLine lineNumber="4738"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04739" /><CodeLine lineNumber="4739"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l04740" /><CodeLine lineNumber="4740"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l04741" /><CodeLine lineNumber="4741"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SrcLoc = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l04742" /><CodeLine lineNumber="4742"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04743" /><CodeLine lineNumber="4743"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Declare useful OpenMP runtime functions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04744" /><CodeLine lineNumber="4744"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>();</Highlight></CodeLine>
<Link id="l04745" /><CodeLine lineNumber="4745"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;IVTy = <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>-&gt;getType();</Highlight></CodeLine>
<Link id="l04746" /><CodeLine lineNumber="4746"><Highlight kind="normal">  FunctionCallee DynamicInit = <a href="#a7a68322ba864bccb8736e42fbc915a8a">getKmpcForDynamicInitForType</a>(IVTy, M, &#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04747" /><CodeLine lineNumber="4747"><Highlight kind="normal">  FunctionCallee DynamicNext = <a href="#a74bf2240e1da04168d57a7534c9613f7">getKmpcForDynamicNextForType</a>(IVTy, M, &#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04748" /><CodeLine lineNumber="4748"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04749" /><CodeLine lineNumber="4749"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Allocate space for computed loop bounds as expected by the &quot;init&quot; function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04750" /><CodeLine lineNumber="4750"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(AllocaIP.getBlock()-&gt;getFirstNonPHIOrDbgOrAlloca());</Highlight></CodeLine>
<Link id="l04751" /><CodeLine lineNumber="4751"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;I32Type = <a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l04752" /><CodeLine lineNumber="4752"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PLastIter = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(I32Type, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.lastiter&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04753" /><CodeLine lineNumber="4753"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PLowerBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(IVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.lowerbound&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04754" /><CodeLine lineNumber="4754"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PUpperBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(IVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.upperbound&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04755" /><CodeLine lineNumber="4755"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PStride = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(IVTy, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;p.stride&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04756" /><CodeLine lineNumber="4756"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04757" /><CodeLine lineNumber="4757"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// At the end of the preheader, prepare for calling the &quot;init&quot; function by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04758" /><CodeLine lineNumber="4758"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// storing the current loop bounds into the allocated space. A canonical loop</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04759" /><CodeLine lineNumber="4759"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// always iterates from 0 to trip-count with step 1 Note that &quot;init&quot; expects</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04760" /><CodeLine lineNumber="4760"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and produces an inclusive upper bound.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04761" /><CodeLine lineNumber="4761"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;PreHeader = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>();</Highlight></CodeLine>
<Link id="l04762" /><CodeLine lineNumber="4762"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(PreHeader-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l04763" /><CodeLine lineNumber="4763"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;One = ConstantInt::get(IVTy, 1);</Highlight></CodeLine>
<Link id="l04764" /><CodeLine lineNumber="4764"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(One, PLowerBound);</Highlight></CodeLine>
<Link id="l04765" /><CodeLine lineNumber="4765"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;UpperBound = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01560f4a4ff7bfc8a96bd406b6f17ea2">getTripCount</a>();</Highlight></CodeLine>
<Link id="l04766" /><CodeLine lineNumber="4766"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(UpperBound, PUpperBound);</Highlight></CodeLine>
<Link id="l04767" /><CodeLine lineNumber="4767"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(One, PStride);</Highlight></CodeLine>
<Link id="l04768" /><CodeLine lineNumber="4768"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04769" /><CodeLine lineNumber="4769"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;<a href="/docs/api/namespaces/anonymous-lvcompare-cpp-/#a1ad6686ca7dcf67bc791fff07fdf7818abf50d5e661106d0abe925af3c2e6f7e7">Header</a> = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01c4471afa921c4962d7138cfcef4942">getHeader</a>();</Highlight></CodeLine>
<Link id="l04770" /><CodeLine lineNumber="4770"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/coff/#ae7629a0652411dc2be61aea4fee2b39cacd4cef2a5a26efd5d75ecca95bc6ff24">Exit</a> = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>();</Highlight></CodeLine>
<Link id="l04771" /><CodeLine lineNumber="4771"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#acb5b5b136597312e0d5df6b746a7e6db">getCond</a>();</Highlight></CodeLine>
<Link id="l04772" /><CodeLine lineNumber="4772"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;Latch = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>();</Highlight></CodeLine>
<Link id="l04773" /><CodeLine lineNumber="4773"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AfterIP = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a578dd7d619d0ccfc6ace07aa380022cc">getAfterIP</a>();</Highlight></CodeLine>
<Link id="l04774" /><CodeLine lineNumber="4774"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04775" /><CodeLine lineNumber="4775"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The CLI will be &quot;broken&quot; in the code below, as the loop is no longer</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04776" /><CodeLine lineNumber="4776"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// a valid canonical loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04777" /><CodeLine lineNumber="4777"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04778" /><CodeLine lineNumber="4778"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Chunk)</Highlight></CodeLine>
<Link id="l04779" /><CodeLine lineNumber="4779"><Highlight kind="normal">    Chunk = One;</Highlight></CodeLine>
<Link id="l04780" /><CodeLine lineNumber="4780"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04781" /><CodeLine lineNumber="4781"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadNum = getOrCreateThreadID(SrcLoc);</Highlight></CodeLine>
<Link id="l04782" /><CodeLine lineNumber="4782"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04783" /><CodeLine lineNumber="4783"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SchedulingType =</Highlight></CodeLine>
<Link id="l04784" /><CodeLine lineNumber="4784"><Highlight kind="normal">      ConstantInt::get(I32Type, </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(SchedType));</Highlight></CodeLine>
<Link id="l04785" /><CodeLine lineNumber="4785"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04786" /><CodeLine lineNumber="4786"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Call the &quot;init&quot; function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04787" /><CodeLine lineNumber="4787"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(DynamicInit,</Highlight></CodeLine>
<Link id="l04788" /><CodeLine lineNumber="4788"><Highlight kind="normal">                     &#123;SrcLoc, ThreadNum, SchedulingType, </Highlight><Highlight kind="comment">/&#42; LowerBound &#42;/</Highlight><Highlight kind="normal"> One,</Highlight></CodeLine>
<Link id="l04789" /><CodeLine lineNumber="4789"><Highlight kind="normal">                      UpperBound, </Highlight><Highlight kind="comment">/&#42; step &#42;/</Highlight><Highlight kind="normal"> One, Chunk&#125;);</Highlight></CodeLine>
<Link id="l04790" /><CodeLine lineNumber="4790"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04791" /><CodeLine lineNumber="4791"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// An outer loop around the existing one.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04792" /><CodeLine lineNumber="4792"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;OuterCond = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l04793" /><CodeLine lineNumber="4793"><Highlight kind="normal">      PreHeader-&gt;<a href="/docs/api/classes/llvm/basicblock/#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(), Twine(PreHeader-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>()) + </Highlight><Highlight kind="stringliteral">&quot;.outer.cond&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04794" /><CodeLine lineNumber="4794"><Highlight kind="normal">      PreHeader-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l04795" /><CodeLine lineNumber="4795"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This needs to be 32-bit always, so can&#39;t use the IVTy Zero above.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04796" /><CodeLine lineNumber="4796"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(OuterCond, OuterCond-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l04797" /><CodeLine lineNumber="4797"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Res =</Highlight></CodeLine>
<Link id="l04798" /><CodeLine lineNumber="4798"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(DynamicNext, &#123;SrcLoc, ThreadNum, PLastIter,</Highlight></CodeLine>
<Link id="l04799" /><CodeLine lineNumber="4799"><Highlight kind="normal">                                       PLowerBound, PUpperBound, PStride&#125;);</Highlight></CodeLine>
<Link id="l04800" /><CodeLine lineNumber="4800"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;Zero32 = ConstantInt::get(I32Type, 0);</Highlight></CodeLine>
<Link id="l04801" /><CodeLine lineNumber="4801"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MoreWork = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a843d43d070f0b1c6a133403edce488ef">CreateCmp</a>(<a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP&#95;NE</a>, Res, Zero32);</Highlight></CodeLine>
<Link id="l04802" /><CodeLine lineNumber="4802"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LowerBound =</Highlight></CodeLine>
<Link id="l04803" /><CodeLine lineNumber="4803"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(IVTy, PLowerBound), One, </Highlight><Highlight kind="stringliteral">&quot;lb&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04804" /><CodeLine lineNumber="4804"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(MoreWork, Header, Exit);</Highlight></CodeLine>
<Link id="l04805" /><CodeLine lineNumber="4805"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04806" /><CodeLine lineNumber="4806"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Change PHI-node in loop header to use outer cond rather than preheader,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04807" /><CodeLine lineNumber="4807"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and set IV to the LowerBound.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04808" /><CodeLine lineNumber="4808"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;<a href="/docs/api/namespaces/llvm/rdf/#a379bee2dadbfd1d7a599f003c4275dd8">Phi</a> = &amp;<a href="/docs/api/namespaces/anonymous-lvcompare-cpp-/#a1ad6686ca7dcf67bc791fff07fdf7818abf50d5e661106d0abe925af3c2e6f7e7">Header</a>-&gt;front();</Highlight></CodeLine>
<Link id="l04809" /><CodeLine lineNumber="4809"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;PI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(Phi);</Highlight></CodeLine>
<Link id="l04810" /><CodeLine lineNumber="4810"><Highlight kind="normal">  PI-&gt;setIncomingBlock(0, OuterCond);</Highlight></CodeLine>
<Link id="l04811" /><CodeLine lineNumber="4811"><Highlight kind="normal">  PI-&gt;setIncomingValue(0, LowerBound);</Highlight></CodeLine>
<Link id="l04812" /><CodeLine lineNumber="4812"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04813" /><CodeLine lineNumber="4813"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Then set the pre-header to jump to the OuterCond</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04814" /><CodeLine lineNumber="4814"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;<a href="/docs/api/namespaces/llvm/m68kbeads/#abf9ad6053d17fcef3b68af71aa681944a27d0e059322508a76f918503800ef1bd">Term</a> = PreHeader-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l04815" /><CodeLine lineNumber="4815"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Br = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BranchInst&gt;</a>(Term);</Highlight></CodeLine>
<Link id="l04816" /><CodeLine lineNumber="4816"><Highlight kind="normal">  Br-&gt;setSuccessor(0, OuterCond);</Highlight></CodeLine>
<Link id="l04817" /><CodeLine lineNumber="4817"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04818" /><CodeLine lineNumber="4818"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Modify the inner condition:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04819" /><CodeLine lineNumber="4819"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#42; Use the UpperBound returned from the DynamicNext call.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04820" /><CodeLine lineNumber="4820"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#42; jump to the loop outer loop when done with one of the inner loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04821" /><CodeLine lineNumber="4821"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getFirstInsertionPt());</Highlight></CodeLine>
<Link id="l04822" /><CodeLine lineNumber="4822"><Highlight kind="normal">  UpperBound = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(IVTy, PUpperBound, </Highlight><Highlight kind="stringliteral">&quot;ub&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04823" /><CodeLine lineNumber="4823"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;Comp = &amp;&#42;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e5c1b91bf5e2860398e3fa35c96b5af">GetInsertPoint</a>();</Highlight></CodeLine>
<Link id="l04824" /><CodeLine lineNumber="4824"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;CmpInst&gt;</a>(Comp);</Highlight></CodeLine>
<Link id="l04825" /><CodeLine lineNumber="4825"><Highlight kind="normal">  CI-&gt;<a href="/docs/api/classes/llvm/user/#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, UpperBound);</Highlight></CodeLine>
<Link id="l04826" /><CodeLine lineNumber="4826"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Redirect the inner exit to branch to outer condition.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04827" /><CodeLine lineNumber="4827"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;<a href="/docs/api/namespaces/llvm/mcid/#ab357441fcd1ea1f9b0d27c12700f6023a359237c780f7c8e40645575826da8a3c">Branch</a> = &amp;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>();</Highlight></CodeLine>
<Link id="l04828" /><CodeLine lineNumber="4828"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;BI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BranchInst&gt;</a>(Branch);</Highlight></CodeLine>
<Link id="l04829" /><CodeLine lineNumber="4829"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BI-&gt;getSuccessor(1) == Exit);</Highlight></CodeLine>
<Link id="l04830" /><CodeLine lineNumber="4830"><Highlight kind="normal">  BI-&gt;setSuccessor(1, OuterCond);</Highlight></CodeLine>
<Link id="l04831" /><CodeLine lineNumber="4831"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04832" /><CodeLine lineNumber="4832"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Call the &quot;fini&quot; function if &quot;ordered&quot; is present in wsloop directive.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04833" /><CodeLine lineNumber="4833"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Ordered) &#123;</Highlight></CodeLine>
<Link id="l04834" /><CodeLine lineNumber="4834"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(&amp;Latch-&gt;<a href="/docs/api/classes/llvm/basicblock/#a2d071e661a02790177ba05f62c7c27d1">back</a>());</Highlight></CodeLine>
<Link id="l04835" /><CodeLine lineNumber="4835"><Highlight kind="normal">    FunctionCallee DynamicFini = <a href="#a3d17252beff7921e40622170990c89ab">getKmpcForDynamicFiniForType</a>(IVTy, M, &#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04836" /><CodeLine lineNumber="4836"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(DynamicFini, &#123;SrcLoc, ThreadNum&#125;);</Highlight></CodeLine>
<Link id="l04837" /><CodeLine lineNumber="4837"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04838" /><CodeLine lineNumber="4838"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04839" /><CodeLine lineNumber="4839"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add the barrier if requested.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04840" /><CodeLine lineNumber="4840"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NeedsBarrier) &#123;</Highlight></CodeLine>
<Link id="l04841" /><CodeLine lineNumber="4841"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(&amp;<a href="/docs/api/namespaces/llvm/coff/#ae7629a0652411dc2be61aea4fee2b39cacd4cef2a5a26efd5d75ecca95bc6ff24">Exit</a>-&gt;back());</Highlight></CodeLine>
<Link id="l04842" /><CodeLine lineNumber="4842"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> BarrierIP =</Highlight></CodeLine>
<Link id="l04843" /><CodeLine lineNumber="4843"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07">createBarrier</a>(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>),</Highlight></CodeLine>
<Link id="l04844" /><CodeLine lineNumber="4844"><Highlight kind="normal">                      omp::Directive::OMPD&#95;for, </Highlight><Highlight kind="comment">/&#42; ForceSimpleCall &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04845" /><CodeLine lineNumber="4845"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42; CheckCancelFlag &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04846" /><CodeLine lineNumber="4846"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!BarrierIP)</Highlight></CodeLine>
<Link id="l04847" /><CodeLine lineNumber="4847"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> BarrierIP.takeError();</Highlight></CodeLine>
<Link id="l04848" /><CodeLine lineNumber="4848"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04849" /><CodeLine lineNumber="4849"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04850" /><CodeLine lineNumber="4850"><Highlight kind="normal">  CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a9ce55b05f8ad85126fc92eeeb35457c7">invalidate</a>();</Highlight></CodeLine>
<Link id="l04851" /><CodeLine lineNumber="4851"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP;</Highlight></CodeLine>
<Link id="l04852" /><CodeLine lineNumber="4852"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04853" /><CodeLine lineNumber="4853"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04854" /><CodeLine lineNumber="4854"><Highlight kind="comment">/// Redirect all edges that branch to \\p OldTarget to \\p NewTarget. That is,</Highlight></CodeLine>
<Link id="l04855" /><CodeLine lineNumber="4855"><Highlight kind="comment">/// after this \\p OldTarget will be orphaned.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04856" /><CodeLine lineNumber="4856" lineLink="#abdcdbfc178873f5055fbcf98bad92f53"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#abdcdbfc178873f5055fbcf98bad92f53">redirectAllPredecessorsTo</a>(<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;OldTarget,</Highlight></CodeLine>
<Link id="l04857" /><CodeLine lineNumber="4857"><Highlight kind="normal">                                      <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;NewTarget, <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>) &#123;</Highlight></CodeLine>
<Link id="l04858" /><CodeLine lineNumber="4858"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Pred : <a href="/docs/api/namespaces/llvm/#a3d2cdc4a0db233678e7141c9d6ea3419">make&#95;early&#95;inc&#95;range</a>(<a href="/docs/api/namespaces/llvm/#acb22fb04083152eee862457e42e8dc31">predecessors</a>(OldTarget)))</Highlight></CodeLine>
<Link id="l04859" /><CodeLine lineNumber="4859"><Highlight kind="normal">    <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(Pred, NewTarget, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04860" /><CodeLine lineNumber="4860"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04861" /><CodeLine lineNumber="4861"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04862" /><CodeLine lineNumber="4862"><Highlight kind="comment">/// Determine which blocks in \\p BBs are reachable from outside and remove the</Highlight></CodeLine>
<Link id="l04863" /><CodeLine lineNumber="4863"><Highlight kind="comment">/// ones that are not reachable from the function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04864" /><CodeLine lineNumber="4864" lineLink="#af0ce60c4a958016f62ce78f1eda423af"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#af0ce60c4a958016f62ce78f1eda423af">removeUnusedBlocksFromParent</a>(<a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;BasicBlock &#42;&gt;</a> BBs) &#123;</Highlight></CodeLine>
<Link id="l04865" /><CodeLine lineNumber="4865"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;BasicBlock &#42;, 6&gt;</a> BBsToErase&#123;BBs.<a href="/docs/api/classes/llvm/arrayref/#aab36927882fbfdcbb860d87fd9c30da8">begin</a>(), BBs.<a href="/docs/api/classes/llvm/arrayref/#a7ca5197533a9c1fb8a2bd30587fcec6b">end</a>()&#125;;</Highlight></CodeLine>
<Link id="l04866" /><CodeLine lineNumber="4866"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> HasRemainingUses = &#91;&amp;BBsToErase&#93;(<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB) &#123;</Highlight></CodeLine>
<Link id="l04867" /><CodeLine lineNumber="4867"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/use">Use</a> &amp;U : BB-&gt;<a href="/docs/api/classes/llvm/value/#abf855b7cd63a0cd7f73759e396f280c9">uses</a>()) &#123;</Highlight></CodeLine>
<Link id="l04868" /><CodeLine lineNumber="4868"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;UseInst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(U.getUser());</Highlight></CodeLine>
<Link id="l04869" /><CodeLine lineNumber="4869"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!UseInst)</Highlight></CodeLine>
<Link id="l04870" /><CodeLine lineNumber="4870"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04871" /><CodeLine lineNumber="4871"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BBsToErase.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(UseInst-&gt;getParent()))</Highlight></CodeLine>
<Link id="l04872" /><CodeLine lineNumber="4872"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04873" /><CodeLine lineNumber="4873"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04874" /><CodeLine lineNumber="4874"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04875" /><CodeLine lineNumber="4875"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04876" /><CodeLine lineNumber="4876"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l04877" /><CodeLine lineNumber="4877"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04878" /><CodeLine lineNumber="4878"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (BBsToErase.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a4323c151516742793df95050739d72ab">remove&#95;if</a>(HasRemainingUses)) &#123;</Highlight></CodeLine>
<Link id="l04879" /><CodeLine lineNumber="4879"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Try again if anything was removed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04880" /><CodeLine lineNumber="4880"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04881" /><CodeLine lineNumber="4881"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04882" /><CodeLine lineNumber="4882"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 7&gt;</a> BBVec(BBsToErase.<a href="/docs/api/classes/llvm/smallptrsetimpl/#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>(), BBsToErase.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a7004354fbee1c8cd74ed9001915e1db5">end</a>());</Highlight></CodeLine>
<Link id="l04883" /><CodeLine lineNumber="4883"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#addf42fea14164ec994d4d517eaa56688">DeleteDeadBlocks</a>(BBVec);</Highlight></CodeLine>
<Link id="l04884" /><CodeLine lineNumber="4884"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04885" /><CodeLine lineNumber="4885"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04886" /><CodeLine lineNumber="4886"><Highlight kind="normal"><a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;</Highlight></CodeLine>
<Link id="l04887" /><CodeLine lineNumber="4887" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a08610118e213de1b759470f0eafb9b18"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#a08610118e213de1b759470f0eafb9b18">OpenMPIRBuilder::collapseLoops</a>(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;CanonicalLoopInfo &#42;&gt;</a> <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>,</Highlight></CodeLine>
<Link id="l04888" /><CodeLine lineNumber="4888"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> ComputeIP) &#123;</Highlight></CodeLine>
<Link id="l04889" /><CodeLine lineNumber="4889"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.size() &gt;= 1 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;At least one loop required&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04890" /><CodeLine lineNumber="4890"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> NumLoops = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.size();</Highlight></CodeLine>
<Link id="l04891" /><CodeLine lineNumber="4891"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04892" /><CodeLine lineNumber="4892"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Nothing to do if there is already just one loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04893" /><CodeLine lineNumber="4893"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumLoops == 1)</Highlight></CodeLine>
<Link id="l04894" /><CodeLine lineNumber="4894"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.front();</Highlight></CodeLine>
<Link id="l04895" /><CodeLine lineNumber="4895"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04896" /><CodeLine lineNumber="4896"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;Outermost = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.front();</Highlight></CodeLine>
<Link id="l04897" /><CodeLine lineNumber="4897"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;Innermost = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.back();</Highlight></CodeLine>
<Link id="l04898" /><CodeLine lineNumber="4898"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;OrigPreheader = Outermost-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>();</Highlight></CodeLine>
<Link id="l04899" /><CodeLine lineNumber="4899"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;OrigAfter = Outermost-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>();</Highlight></CodeLine>
<Link id="l04900" /><CodeLine lineNumber="4900"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = OrigPreheader-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l04901" /><CodeLine lineNumber="4901"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04902" /><CodeLine lineNumber="4902"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Loop control blocks that may become orphaned later.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04903" /><CodeLine lineNumber="4903"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 12&gt;</a> OldControlBBs;</Highlight></CodeLine>
<Link id="l04904" /><CodeLine lineNumber="4904"><Highlight kind="normal">  OldControlBBs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(6 &#42; <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.size());</Highlight></CodeLine>
<Link id="l04905" /><CodeLine lineNumber="4905"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;<a href="/docs/api/classes/llvm/loop">Loop</a> : <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>)</Highlight></CodeLine>
<Link id="l04906" /><CodeLine lineNumber="4906"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/loop">Loop</a>-&gt;collectControlBlocks(OldControlBBs);</Highlight></CodeLine>
<Link id="l04907" /><CodeLine lineNumber="4907"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04908" /><CodeLine lineNumber="4908"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Setup the IRBuilder for inserting the trip count computation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04909" /><CodeLine lineNumber="4909"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04910" /><CodeLine lineNumber="4910"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ComputeIP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a85b9635b21610f18b51007437bcc26cf">isSet</a>())</Highlight></CodeLine>
<Link id="l04911" /><CodeLine lineNumber="4911"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(ComputeIP);</Highlight></CodeLine>
<Link id="l04912" /><CodeLine lineNumber="4912"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04913" /><CodeLine lineNumber="4913"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(Outermost-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac72ebc430ef7dcf1791c66080ddedd9d">getPreheaderIP</a>());</Highlight></CodeLine>
<Link id="l04914" /><CodeLine lineNumber="4914"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04915" /><CodeLine lineNumber="4915"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Derive the collapsed&#39; loop trip count.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04916" /><CodeLine lineNumber="4916"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Find common/largest indvar type.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04917" /><CodeLine lineNumber="4917"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;CollapsedTripCount = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04918" /><CodeLine lineNumber="4918"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;L : <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>) &#123;</Highlight></CodeLine>
<Link id="l04919" /><CodeLine lineNumber="4919"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L-&gt;isValid() &amp;&amp;</Highlight></CodeLine>
<Link id="l04920" /><CodeLine lineNumber="4920"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;All loops to collapse must be valid canonical loops&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04921" /><CodeLine lineNumber="4921"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;OrigTripCount = L-&gt;getTripCount();</Highlight></CodeLine>
<Link id="l04922" /><CodeLine lineNumber="4922"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CollapsedTripCount) &#123;</Highlight></CodeLine>
<Link id="l04923" /><CodeLine lineNumber="4923"><Highlight kind="normal">      CollapsedTripCount = OrigTripCount;</Highlight></CodeLine>
<Link id="l04924" /><CodeLine lineNumber="4924"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04925" /><CodeLine lineNumber="4925"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04926" /><CodeLine lineNumber="4926"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04927" /><CodeLine lineNumber="4927"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Enable UndefinedSanitizer to diagnose an overflow here.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04928" /><CodeLine lineNumber="4928"><Highlight kind="normal">    CollapsedTripCount = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aecd40f9a16dc0ef1e0bc416599f89277">CreateMul</a>(CollapsedTripCount, OrigTripCount,</Highlight></CodeLine>
<Link id="l04929" /><CodeLine lineNumber="4929"><Highlight kind="normal">                                           &#123;&#125;, </Highlight><Highlight kind="comment">/&#42;HasNUW=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04930" /><CodeLine lineNumber="4930"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04931" /><CodeLine lineNumber="4931"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04932" /><CodeLine lineNumber="4932"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create the collapsed loop control flow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04933" /><CodeLine lineNumber="4933"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;Result =</Highlight></CodeLine>
<Link id="l04934" /><CodeLine lineNumber="4934"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#a445fa52d77040bccb16bfea111234a2e">createLoopSkeleton</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, CollapsedTripCount, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l04935" /><CodeLine lineNumber="4935"><Highlight kind="normal">                         OrigPreheader-&gt;<a href="/docs/api/classes/llvm/ilist-node-with-parent/#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>(), OrigAfter, </Highlight><Highlight kind="stringliteral">&quot;collapsed&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04936" /><CodeLine lineNumber="4936"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04937" /><CodeLine lineNumber="4937"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build the collapsed loop body code.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04938" /><CodeLine lineNumber="4938"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Start with deriving the input loop induction variables from the collapsed</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04939" /><CodeLine lineNumber="4939"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// one, using a divmod scheme. To preserve the original loops&#39; order, the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04940" /><CodeLine lineNumber="4940"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// innermost loop use the least significant bits.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04941" /><CodeLine lineNumber="4941"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(Result-&gt;getBodyIP());</Highlight></CodeLine>
<Link id="l04942" /><CodeLine lineNumber="4942"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04943" /><CodeLine lineNumber="4943"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Leftover = Result-&gt;getIndVar();</Highlight></CodeLine>
<Link id="l04944" /><CodeLine lineNumber="4944"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;&gt;</a> NewIndVars;</Highlight></CodeLine>
<Link id="l04945" /><CodeLine lineNumber="4945"><Highlight kind="normal">  NewIndVars.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(NumLoops);</Highlight></CodeLine>
<Link id="l04946" /><CodeLine lineNumber="4946"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> i = NumLoops - 1; i &gt;= 1; --i) &#123;</Highlight></CodeLine>
<Link id="l04947" /><CodeLine lineNumber="4947"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;OrigTripCount = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>&#91;i&#93;-&gt;getTripCount();</Highlight></CodeLine>
<Link id="l04948" /><CodeLine lineNumber="4948"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04949" /><CodeLine lineNumber="4949"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;NewIndVar = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae884a856c5f31ab8fcf64f81db130dcd">CreateURem</a>(Leftover, OrigTripCount);</Highlight></CodeLine>
<Link id="l04950" /><CodeLine lineNumber="4950"><Highlight kind="normal">    NewIndVars&#91;i&#93; = NewIndVar;</Highlight></CodeLine>
<Link id="l04951" /><CodeLine lineNumber="4951"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04952" /><CodeLine lineNumber="4952"><Highlight kind="normal">    Leftover = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a6b68047eda0d6d6eec5dd564ed1a22b8">CreateUDiv</a>(Leftover, OrigTripCount);</Highlight></CodeLine>
<Link id="l04953" /><CodeLine lineNumber="4953"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04954" /><CodeLine lineNumber="4954"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Outermost loop gets all the remaining bits.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04955" /><CodeLine lineNumber="4955"><Highlight kind="normal">  NewIndVars&#91;0&#93; = Leftover;</Highlight></CodeLine>
<Link id="l04956" /><CodeLine lineNumber="4956"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04957" /><CodeLine lineNumber="4957"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Construct the loop body control flow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04958" /><CodeLine lineNumber="4958"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We progressively construct the branch structure following in direction of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04959" /><CodeLine lineNumber="4959"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the control flow, from the leading in-between code, the loop nest body, the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04960" /><CodeLine lineNumber="4960"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// trailing in-between code, and rejoining the collapsed loop&#39;s latch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04961" /><CodeLine lineNumber="4961"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ContinueBlock and ContinuePred keep track of the source(s) of next edge. If</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04962" /><CodeLine lineNumber="4962"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the ContinueBlock is set, continue with that block. If ContinuePred, use</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04963" /><CodeLine lineNumber="4963"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// its predecessors as sources.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04964" /><CodeLine lineNumber="4964"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ContinueBlock = Result-&gt;getBody();</Highlight></CodeLine>
<Link id="l04965" /><CodeLine lineNumber="4965"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ContinuePred = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04966" /><CodeLine lineNumber="4966"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> ContinueWith = &#91;&amp;ContinueBlock, &amp;ContinuePred, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>&#93;(<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Dest,</Highlight></CodeLine>
<Link id="l04967" /><CodeLine lineNumber="4967"><Highlight kind="normal">                                                          <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;NextSrc) &#123;</Highlight></CodeLine>
<Link id="l04968" /><CodeLine lineNumber="4968"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ContinueBlock)</Highlight></CodeLine>
<Link id="l04969" /><CodeLine lineNumber="4969"><Highlight kind="normal">      <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(ContinueBlock, Dest, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04970" /><CodeLine lineNumber="4970"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04971" /><CodeLine lineNumber="4971"><Highlight kind="normal">      <a href="#abdcdbfc178873f5055fbcf98bad92f53">redirectAllPredecessorsTo</a>(ContinuePred, Dest, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04972" /><CodeLine lineNumber="4972"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04973" /><CodeLine lineNumber="4973"><Highlight kind="normal">    ContinueBlock = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04974" /><CodeLine lineNumber="4974"><Highlight kind="normal">    ContinuePred = NextSrc;</Highlight></CodeLine>
<Link id="l04975" /><CodeLine lineNumber="4975"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l04976" /><CodeLine lineNumber="4976"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04977" /><CodeLine lineNumber="4977"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The code before the nested loop of each level.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04978" /><CodeLine lineNumber="4978"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Because we are sinking it into the nest, it will be executed more often</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04979" /><CodeLine lineNumber="4979"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that the original loop. More sophisticated schemes could keep track of what</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04980" /><CodeLine lineNumber="4980"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the in-between code is and instantiate it only once per thread.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04981" /><CodeLine lineNumber="4981"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0; i &lt; NumLoops - 1; ++i)</Highlight></CodeLine>
<Link id="l04982" /><CodeLine lineNumber="4982"><Highlight kind="normal">    ContinueWith(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>&#91;i&#93;-&gt;getBody(), <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>&#91;i + 1&#93;-&gt;getHeader());</Highlight></CodeLine>
<Link id="l04983" /><CodeLine lineNumber="4983"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04984" /><CodeLine lineNumber="4984"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Connect the loop nest body.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04985" /><CodeLine lineNumber="4985"><Highlight kind="normal">  ContinueWith(Innermost-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>(), Innermost-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>());</Highlight></CodeLine>
<Link id="l04986" /><CodeLine lineNumber="4986"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04987" /><CodeLine lineNumber="4987"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The code after the nested loop at each level.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04988" /><CodeLine lineNumber="4988"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = NumLoops - 1; i &gt; 0; --i)</Highlight></CodeLine>
<Link id="l04989" /><CodeLine lineNumber="4989"><Highlight kind="normal">    ContinueWith(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>&#91;i&#93;-&gt;getAfter(), <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>&#91;i - 1&#93;-&gt;getLatch());</Highlight></CodeLine>
<Link id="l04990" /><CodeLine lineNumber="4990"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04991" /><CodeLine lineNumber="4991"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Connect the finished loop to the collapsed loop latch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04992" /><CodeLine lineNumber="4992"><Highlight kind="normal">  ContinueWith(Result-&gt;getLatch(), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04993" /><CodeLine lineNumber="4993"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04994" /><CodeLine lineNumber="4994"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Replace the input loops with the new collapsed loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04995" /><CodeLine lineNumber="4995"><Highlight kind="normal">  <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(Outermost-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>(), Result-&gt;getPreheader(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04996" /><CodeLine lineNumber="4996"><Highlight kind="normal">  <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(Result-&gt;getAfter(), Outermost-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l04997" /><CodeLine lineNumber="4997"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04998" /><CodeLine lineNumber="4998"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Replace the input loop indvars with the derived ones.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04999" /><CodeLine lineNumber="4999"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0; i &lt; NumLoops; ++i)</Highlight></CodeLine>
<Link id="l05000" /><CodeLine lineNumber="5000"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>&#91;i&#93;-&gt;getIndVar()-&gt;replaceAllUsesWith(NewIndVars&#91;i&#93;);</Highlight></CodeLine>
<Link id="l05001" /><CodeLine lineNumber="5001"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05002" /><CodeLine lineNumber="5002"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remove unused parts of the input loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05003" /><CodeLine lineNumber="5003"><Highlight kind="normal">  <a href="#af0ce60c4a958016f62ce78f1eda423af">removeUnusedBlocksFromParent</a>(OldControlBBs);</Highlight></CodeLine>
<Link id="l05004" /><CodeLine lineNumber="5004"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05005" /><CodeLine lineNumber="5005"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;L : <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>)</Highlight></CodeLine>
<Link id="l05006" /><CodeLine lineNumber="5006"><Highlight kind="normal">    L-&gt;invalidate();</Highlight></CodeLine>
<Link id="l05007" /><CodeLine lineNumber="5007"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05008" /><CodeLine lineNumber="5008"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05009" /><CodeLine lineNumber="5009"><Highlight kind="normal">  Result-&gt;assertOK();</Highlight></CodeLine>
<Link id="l05010" /><CodeLine lineNumber="5010"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05011" /><CodeLine lineNumber="5011"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Result;</Highlight></CodeLine>
<Link id="l05012" /><CodeLine lineNumber="5012"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05013" /><CodeLine lineNumber="5013"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05014" /><CodeLine lineNumber="5014"><Highlight kind="normal">std::vector&lt;CanonicalLoopInfo &#42;&gt;</Highlight></CodeLine>
<Link id="l05015" /><CodeLine lineNumber="5015" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a76e12ec076e7af4be7b8b77a5d53d3fc"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#a76e12ec076e7af4be7b8b77a5d53d3fc">OpenMPIRBuilder::tileLoops</a>(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;CanonicalLoopInfo &#42;&gt;</a> <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>,</Highlight></CodeLine>
<Link id="l05016" /><CodeLine lineNumber="5016"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;Value &#42;&gt;</a> TileSizes) &#123;</Highlight></CodeLine>
<Link id="l05017" /><CodeLine lineNumber="5017"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(TileSizes.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>() == <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.size() &amp;&amp;</Highlight></CodeLine>
<Link id="l05018" /><CodeLine lineNumber="5018"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Must pass as many tile sizes as there are loops&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05019" /><CodeLine lineNumber="5019"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> NumLoops = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.size();</Highlight></CodeLine>
<Link id="l05020" /><CodeLine lineNumber="5020"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NumLoops &gt;= 1 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;At least one loop to tile required&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05021" /><CodeLine lineNumber="5021"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05022" /><CodeLine lineNumber="5022"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;OutermostLoop = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.front();</Highlight></CodeLine>
<Link id="l05023" /><CodeLine lineNumber="5023"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;InnermostLoop = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.back();</Highlight></CodeLine>
<Link id="l05024" /><CodeLine lineNumber="5024"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = OutermostLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l05025" /><CodeLine lineNumber="5025"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;InnerEnter = InnermostLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>();</Highlight></CodeLine>
<Link id="l05026" /><CodeLine lineNumber="5026"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;InnerLatch = InnermostLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>();</Highlight></CodeLine>
<Link id="l05027" /><CodeLine lineNumber="5027"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05028" /><CodeLine lineNumber="5028"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Loop control blocks that may become orphaned later.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05029" /><CodeLine lineNumber="5029"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 12&gt;</a> OldControlBBs;</Highlight></CodeLine>
<Link id="l05030" /><CodeLine lineNumber="5030"><Highlight kind="normal">  OldControlBBs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(6 &#42; <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.size());</Highlight></CodeLine>
<Link id="l05031" /><CodeLine lineNumber="5031"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;<a href="/docs/api/classes/llvm/loop">Loop</a> : <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>)</Highlight></CodeLine>
<Link id="l05032" /><CodeLine lineNumber="5032"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/loop">Loop</a>-&gt;collectControlBlocks(OldControlBBs);</Highlight></CodeLine>
<Link id="l05033" /><CodeLine lineNumber="5033"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05034" /><CodeLine lineNumber="5034"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Collect original trip counts and induction variable to be accessible by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05035" /><CodeLine lineNumber="5035"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// index. Also, the structure of the original loops is not preserved during</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05036" /><CodeLine lineNumber="5036"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the construction of the tiled loops, so do it before we scavenge the BBs of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05037" /><CodeLine lineNumber="5037"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// any original CanonicalLoopInfo.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05038" /><CodeLine lineNumber="5038"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 4&gt;</a> OrigTripCounts, OrigIndVars;</Highlight></CodeLine>
<Link id="l05039" /><CodeLine lineNumber="5039"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;L : <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>) &#123;</Highlight></CodeLine>
<Link id="l05040" /><CodeLine lineNumber="5040"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L-&gt;isValid() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;All input loops must be valid canonical loops&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05041" /><CodeLine lineNumber="5041"><Highlight kind="normal">    OrigTripCounts.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(L-&gt;getTripCount());</Highlight></CodeLine>
<Link id="l05042" /><CodeLine lineNumber="5042"><Highlight kind="normal">    OrigIndVars.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(L-&gt;getIndVar());</Highlight></CodeLine>
<Link id="l05043" /><CodeLine lineNumber="5043"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05044" /><CodeLine lineNumber="5044"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05045" /><CodeLine lineNumber="5045"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Collect the code between loop headers. These may contain SSA definitions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05046" /><CodeLine lineNumber="5046"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that are used in the loop nest body. To be usable with in the innermost</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05047" /><CodeLine lineNumber="5047"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// body, these BasicBlocks will be sunk into the loop nest body. That is,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05048" /><CodeLine lineNumber="5048"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// these instructions may be executed more often than before the tiling.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05049" /><CodeLine lineNumber="5049"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: It would be sufficient to only sink them into body of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05050" /><CodeLine lineNumber="5050"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// corresponding tile loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05051" /><CodeLine lineNumber="5051"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;BasicBlock &#42;, BasicBlock &#42;&gt;</a>, 4&gt; InbetweenCode;</Highlight></CodeLine>
<Link id="l05052" /><CodeLine lineNumber="5052"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> i = 0; i &lt; NumLoops - 1; ++i) &#123;</Highlight></CodeLine>
<Link id="l05053" /><CodeLine lineNumber="5053"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;Surrounding = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05054" /><CodeLine lineNumber="5054"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;Nested = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>&#91;i + 1&#93;;</Highlight></CodeLine>
<Link id="l05055" /><CodeLine lineNumber="5055"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05056" /><CodeLine lineNumber="5056"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;EnterBB = Surrounding-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>();</Highlight></CodeLine>
<Link id="l05057" /><CodeLine lineNumber="5057"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ExitBB = Nested-&gt;getHeader();</Highlight></CodeLine>
<Link id="l05058" /><CodeLine lineNumber="5058"><Highlight kind="normal">    InbetweenCode.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(EnterBB, ExitBB);</Highlight></CodeLine>
<Link id="l05059" /><CodeLine lineNumber="5059"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05060" /><CodeLine lineNumber="5060"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05061" /><CodeLine lineNumber="5061"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Compute the trip counts of the floor loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05062" /><CodeLine lineNumber="5062"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l05063" /><CodeLine lineNumber="5063"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OutermostLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac72ebc430ef7dcf1791c66080ddedd9d">getPreheaderIP</a>());</Highlight></CodeLine>
<Link id="l05064" /><CodeLine lineNumber="5064"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 4&gt;</a> FloorCount, FloorRems;</Highlight></CodeLine>
<Link id="l05065" /><CodeLine lineNumber="5065"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> i = 0; i &lt; NumLoops; ++i) &#123;</Highlight></CodeLine>
<Link id="l05066" /><CodeLine lineNumber="5066"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/lowermatrixintrinsics-cpp/#af1138294df67ee063ee3b7632a2f843f">TileSize</a> = TileSizes&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05067" /><CodeLine lineNumber="5067"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;OrigTripCount = OrigTripCounts&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05068" /><CodeLine lineNumber="5068"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;IVType = OrigTripCount-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l05069" /><CodeLine lineNumber="5069"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05070" /><CodeLine lineNumber="5070"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;FloorTripCount = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a6b68047eda0d6d6eec5dd564ed1a22b8">CreateUDiv</a>(OrigTripCount, <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/lowermatrixintrinsics-cpp/#af1138294df67ee063ee3b7632a2f843f">TileSize</a>);</Highlight></CodeLine>
<Link id="l05071" /><CodeLine lineNumber="5071"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;FloorTripRem = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae884a856c5f31ab8fcf64f81db130dcd">CreateURem</a>(OrigTripCount, <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/lowermatrixintrinsics-cpp/#af1138294df67ee063ee3b7632a2f843f">TileSize</a>);</Highlight></CodeLine>
<Link id="l05072" /><CodeLine lineNumber="5072"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05073" /><CodeLine lineNumber="5073"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// 0 if tripcount divides the tilesize, 1 otherwise.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05074" /><CodeLine lineNumber="5074"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// 1 means we need an additional iteration for a partial tile.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05075" /><CodeLine lineNumber="5075"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05076" /><CodeLine lineNumber="5076"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Unfortunately we cannot just use the roundup-formula</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05077" /><CodeLine lineNumber="5077"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//   (tripcount + tilesize - 1)/tilesize</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05078" /><CodeLine lineNumber="5078"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// because the summation might overflow. We do not want introduce undefined</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05079" /><CodeLine lineNumber="5079"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// behavior when the untiled loop nest did not.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05080" /><CodeLine lineNumber="5080"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;FloorTripOverflow =</Highlight></CodeLine>
<Link id="l05081" /><CodeLine lineNumber="5081"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a6ef1729b04a4fbd6c6f27787cdd0e813">CreateICmpNE</a>(FloorTripRem, ConstantInt::get(IVType, 0));</Highlight></CodeLine>
<Link id="l05082" /><CodeLine lineNumber="5082"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05083" /><CodeLine lineNumber="5083"><Highlight kind="normal">    FloorTripOverflow = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9e6950f7f17700d5c0d61ad0b846ec5c">CreateZExt</a>(FloorTripOverflow, IVType);</Highlight></CodeLine>
<Link id="l05084" /><CodeLine lineNumber="5084"><Highlight kind="normal">    FloorTripCount =</Highlight></CodeLine>
<Link id="l05085" /><CodeLine lineNumber="5085"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(FloorTripCount, FloorTripOverflow,</Highlight></CodeLine>
<Link id="l05086" /><CodeLine lineNumber="5086"><Highlight kind="normal">                          </Highlight><Highlight kind="stringliteral">&quot;omp&#95;floor&quot;</Highlight><Highlight kind="normal"> + <a href="/docs/api/classes/llvm/twine">Twine</a>(i) + </Highlight><Highlight kind="stringliteral">&quot;.tripcount&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05087" /><CodeLine lineNumber="5087"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05088" /><CodeLine lineNumber="5088"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Remember some values for later use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05089" /><CodeLine lineNumber="5089"><Highlight kind="normal">    FloorCount.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(FloorTripCount);</Highlight></CodeLine>
<Link id="l05090" /><CodeLine lineNumber="5090"><Highlight kind="normal">    FloorRems.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(FloorTripRem);</Highlight></CodeLine>
<Link id="l05091" /><CodeLine lineNumber="5091"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05092" /><CodeLine lineNumber="5092"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05093" /><CodeLine lineNumber="5093"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Generate the new loop nest, from the outermost to the innermost.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05094" /><CodeLine lineNumber="5094"><Highlight kind="normal">  std::vector&lt;CanonicalLoopInfo &#42;&gt; Result;</Highlight></CodeLine>
<Link id="l05095" /><CodeLine lineNumber="5095"><Highlight kind="normal">  Result.reserve(NumLoops &#42; 2);</Highlight></CodeLine>
<Link id="l05096" /><CodeLine lineNumber="5096"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05097" /><CodeLine lineNumber="5097"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The basic block of the surrounding loop that enters the nest generated</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05098" /><CodeLine lineNumber="5098"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05099" /><CodeLine lineNumber="5099"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Enter = OutermostLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>();</Highlight></CodeLine>
<Link id="l05100" /><CodeLine lineNumber="5100"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05101" /><CodeLine lineNumber="5101"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The basic block of the surrounding loop where the inner code should</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05102" /><CodeLine lineNumber="5102"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// continue.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05103" /><CodeLine lineNumber="5103"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a> = OutermostLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>();</Highlight></CodeLine>
<Link id="l05104" /><CodeLine lineNumber="5104"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05105" /><CodeLine lineNumber="5105"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Where the next loop basic block should be inserted.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05106" /><CodeLine lineNumber="5106"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;OutroInsertBefore = InnermostLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>();</Highlight></CodeLine>
<Link id="l05107" /><CodeLine lineNumber="5107"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05108" /><CodeLine lineNumber="5108"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> EmbeddNewLoop =</Highlight></CodeLine>
<Link id="l05109" /><CodeLine lineNumber="5109"><Highlight kind="normal">      &#91;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, InnerEnter, &amp;Enter, &amp;<a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a>, &amp;OutroInsertBefore&#93;(</Highlight></CodeLine>
<Link id="l05110" /><CodeLine lineNumber="5110"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp;Name) -&gt; <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42; &#123;</Highlight></CodeLine>
<Link id="l05111" /><CodeLine lineNumber="5111"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;EmbeddedLoop = <a href="/docs/api/classes/llvm/openmpirbuilder/#a445fa52d77040bccb16bfea111234a2e">createLoopSkeleton</a>(</Highlight></CodeLine>
<Link id="l05112" /><CodeLine lineNumber="5112"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, TripCount, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, InnerEnter, OutroInsertBefore, Name);</Highlight></CodeLine>
<Link id="l05113" /><CodeLine lineNumber="5113"><Highlight kind="normal">    <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(Enter, EmbeddedLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l05114" /><CodeLine lineNumber="5114"><Highlight kind="normal">    <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(EmbeddedLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>(), <a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a>, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l05115" /><CodeLine lineNumber="5115"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05116" /><CodeLine lineNumber="5116"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Setup the position where the next embedded loop connects to this loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05117" /><CodeLine lineNumber="5117"><Highlight kind="normal">    Enter = EmbeddedLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>();</Highlight></CodeLine>
<Link id="l05118" /><CodeLine lineNumber="5118"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a> = EmbeddedLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>();</Highlight></CodeLine>
<Link id="l05119" /><CodeLine lineNumber="5119"><Highlight kind="normal">    OutroInsertBefore = EmbeddedLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>();</Highlight></CodeLine>
<Link id="l05120" /><CodeLine lineNumber="5120"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EmbeddedLoop;</Highlight></CodeLine>
<Link id="l05121" /><CodeLine lineNumber="5121"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l05122" /><CodeLine lineNumber="5122"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05123" /><CodeLine lineNumber="5123"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> EmbeddNewLoops = &#91;&amp;Result, &amp;EmbeddNewLoop&#93;(<a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;Value &#42;&gt;</a> TripCounts,</Highlight></CodeLine>
<Link id="l05124" /><CodeLine lineNumber="5124"><Highlight kind="normal">                                                  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp;NameBase) &#123;</Highlight></CodeLine>
<Link id="l05125" /><CodeLine lineNumber="5125"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : <a href="/docs/api/namespaces/llvm/#a206e2134ddd2312c3488d0632d98f554">enumerate</a>(TripCounts)) &#123;</Highlight></CodeLine>
<Link id="l05126" /><CodeLine lineNumber="5126"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;EmbeddedLoop =</Highlight></CodeLine>
<Link id="l05127" /><CodeLine lineNumber="5127"><Highlight kind="normal">          EmbeddNewLoop(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.value(), NameBase + <a href="/docs/api/classes/llvm/twine">Twine</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.index()));</Highlight></CodeLine>
<Link id="l05128" /><CodeLine lineNumber="5128"><Highlight kind="normal">      Result.push&#95;back(EmbeddedLoop);</Highlight></CodeLine>
<Link id="l05129" /><CodeLine lineNumber="5129"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05130" /><CodeLine lineNumber="5130"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l05131" /><CodeLine lineNumber="5131"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05132" /><CodeLine lineNumber="5132"><Highlight kind="normal">  EmbeddNewLoops(FloorCount, </Highlight><Highlight kind="stringliteral">&quot;floor&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05133" /><CodeLine lineNumber="5133"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05134" /><CodeLine lineNumber="5134"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Within the innermost floor loop, emit the code that computes the tile</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05135" /><CodeLine lineNumber="5135"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// sizes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05136" /><CodeLine lineNumber="5136"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Enter-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l05137" /><CodeLine lineNumber="5137"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 4&gt;</a> TileCounts;</Highlight></CodeLine>
<Link id="l05138" /><CodeLine lineNumber="5138"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> i = 0; i &lt; NumLoops; ++i) &#123;</Highlight></CodeLine>
<Link id="l05139" /><CodeLine lineNumber="5139"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;FloorLoop = Result&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05140" /><CodeLine lineNumber="5140"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/lowermatrixintrinsics-cpp/#af1138294df67ee063ee3b7632a2f843f">TileSize</a> = TileSizes&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05141" /><CodeLine lineNumber="5141"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05142" /><CodeLine lineNumber="5142"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;FloorIsEpilogue =</Highlight></CodeLine>
<Link id="l05143" /><CodeLine lineNumber="5143"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(FloorLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>(), FloorCount&#91;i&#93;);</Highlight></CodeLine>
<Link id="l05144" /><CodeLine lineNumber="5144"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;TileTripCount =</Highlight></CodeLine>
<Link id="l05145" /><CodeLine lineNumber="5145"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(FloorIsEpilogue, FloorRems&#91;i&#93;, <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/lowermatrixintrinsics-cpp/#af1138294df67ee063ee3b7632a2f843f">TileSize</a>);</Highlight></CodeLine>
<Link id="l05146" /><CodeLine lineNumber="5146"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05147" /><CodeLine lineNumber="5147"><Highlight kind="normal">    TileCounts.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(TileTripCount);</Highlight></CodeLine>
<Link id="l05148" /><CodeLine lineNumber="5148"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05149" /><CodeLine lineNumber="5149"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05150" /><CodeLine lineNumber="5150"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create the tile loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05151" /><CodeLine lineNumber="5151"><Highlight kind="normal">  EmbeddNewLoops(TileCounts, </Highlight><Highlight kind="stringliteral">&quot;tile&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05152" /><CodeLine lineNumber="5152"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05153" /><CodeLine lineNumber="5153"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Insert the inbetween code into the body.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05154" /><CodeLine lineNumber="5154"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BodyEnter = Enter;</Highlight></CodeLine>
<Link id="l05155" /><CodeLine lineNumber="5155"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BodyEntered = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05156" /><CodeLine lineNumber="5156"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (std::pair&lt;BasicBlock &#42;, BasicBlock &#42;&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : InbetweenCode) &#123;</Highlight></CodeLine>
<Link id="l05157" /><CodeLine lineNumber="5157"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;EnterBB = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first;</Highlight></CodeLine>
<Link id="l05158" /><CodeLine lineNumber="5158"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ExitBB = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second;</Highlight></CodeLine>
<Link id="l05159" /><CodeLine lineNumber="5159"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05160" /><CodeLine lineNumber="5160"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BodyEnter)</Highlight></CodeLine>
<Link id="l05161" /><CodeLine lineNumber="5161"><Highlight kind="normal">      <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(BodyEnter, EnterBB, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l05162" /><CodeLine lineNumber="5162"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05163" /><CodeLine lineNumber="5163"><Highlight kind="normal">      <a href="#abdcdbfc178873f5055fbcf98bad92f53">redirectAllPredecessorsTo</a>(BodyEntered, EnterBB, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l05164" /><CodeLine lineNumber="5164"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05165" /><CodeLine lineNumber="5165"><Highlight kind="normal">    BodyEnter = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05166" /><CodeLine lineNumber="5166"><Highlight kind="normal">    BodyEntered = ExitBB;</Highlight></CodeLine>
<Link id="l05167" /><CodeLine lineNumber="5167"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05168" /><CodeLine lineNumber="5168"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05169" /><CodeLine lineNumber="5169"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Append the original loop nest body into the generated loop nest body.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05170" /><CodeLine lineNumber="5170"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BodyEnter)</Highlight></CodeLine>
<Link id="l05171" /><CodeLine lineNumber="5171"><Highlight kind="normal">    <a href="#a3057c2b7e1e25de160497b1ef3985c2a">redirectTo</a>(BodyEnter, InnerEnter, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l05172" /><CodeLine lineNumber="5172"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05173" /><CodeLine lineNumber="5173"><Highlight kind="normal">    <a href="#abdcdbfc178873f5055fbcf98bad92f53">redirectAllPredecessorsTo</a>(BodyEntered, InnerEnter, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l05174" /><CodeLine lineNumber="5174"><Highlight kind="normal">  <a href="#abdcdbfc178873f5055fbcf98bad92f53">redirectAllPredecessorsTo</a>(InnerLatch, <a href="/docs/api/namespaces/llvm/#ada72881d16e555ca8525a916364048f9a69820949e2fb6d1d719487d27f0df883">Continue</a>, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</Highlight></CodeLine>
<Link id="l05175" /><CodeLine lineNumber="5175"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05176" /><CodeLine lineNumber="5176"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Replace the original induction variable with an induction variable computed</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05177" /><CodeLine lineNumber="5177"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// from the tile and floor induction variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05178" /><CodeLine lineNumber="5178"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(Result.back()-&gt;getBodyIP());</Highlight></CodeLine>
<Link id="l05179" /><CodeLine lineNumber="5179"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> i = 0; i &lt; NumLoops; ++i) &#123;</Highlight></CodeLine>
<Link id="l05180" /><CodeLine lineNumber="5180"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;FloorLoop = Result&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05181" /><CodeLine lineNumber="5181"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;TileLoop = Result&#91;NumLoops + i&#93;;</Highlight></CodeLine>
<Link id="l05182" /><CodeLine lineNumber="5182"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;OrigIndVar = OrigIndVars&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05183" /><CodeLine lineNumber="5183"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = TileSizes&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05184" /><CodeLine lineNumber="5184"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05185" /><CodeLine lineNumber="5185"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Scale =</Highlight></CodeLine>
<Link id="l05186" /><CodeLine lineNumber="5186"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aecd40f9a16dc0ef1e0bc416599f89277">CreateMul</a>(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, FloorLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>(), &#123;&#125;, </Highlight><Highlight kind="comment">/&#42;HasNUW=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05187" /><CodeLine lineNumber="5187"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Shift =</Highlight></CodeLine>
<Link id="l05188" /><CodeLine lineNumber="5188"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(Scale, TileLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>(), &#123;&#125;, </Highlight><Highlight kind="comment">/&#42;HasNUW=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05189" /><CodeLine lineNumber="5189"><Highlight kind="normal">    OrigIndVar-&gt;<a href="/docs/api/classes/llvm/value/#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(Shift);</Highlight></CodeLine>
<Link id="l05190" /><CodeLine lineNumber="5190"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05191" /><CodeLine lineNumber="5191"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05192" /><CodeLine lineNumber="5192"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remove unused parts of the original loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05193" /><CodeLine lineNumber="5193"><Highlight kind="normal">  <a href="#af0ce60c4a958016f62ce78f1eda423af">removeUnusedBlocksFromParent</a>(OldControlBBs);</Highlight></CodeLine>
<Link id="l05194" /><CodeLine lineNumber="5194"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05195" /><CodeLine lineNumber="5195"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;L : <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>)</Highlight></CodeLine>
<Link id="l05196" /><CodeLine lineNumber="5196"><Highlight kind="normal">    L-&gt;invalidate();</Highlight></CodeLine>
<Link id="l05197" /><CodeLine lineNumber="5197"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05198" /><CodeLine lineNumber="5198"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05199" /><CodeLine lineNumber="5199"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;GenL : Result)</Highlight></CodeLine>
<Link id="l05200" /><CodeLine lineNumber="5200"><Highlight kind="normal">    GenL-&gt;assertOK();</Highlight></CodeLine>
<Link id="l05201" /><CodeLine lineNumber="5201"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05202" /><CodeLine lineNumber="5202"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Result;</Highlight></CodeLine>
<Link id="l05203" /><CodeLine lineNumber="5203"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05204" /><CodeLine lineNumber="5204"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05205" /><CodeLine lineNumber="5205"><Highlight kind="comment">/// Attach metadata \\p Properties to the basic block described by \\p BB. If the</Highlight></CodeLine>
<Link id="l05206" /><CodeLine lineNumber="5206"><Highlight kind="comment">/// basic block already has metadata, the basic block properties are appended.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05207" /><CodeLine lineNumber="5207" lineLink="#ac36177cea684b1e36fdbc92d692f69d0"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#ac36177cea684b1e36fdbc92d692f69d0">addBasicBlockMetadata</a>(<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB,</Highlight></CodeLine>
<Link id="l05208" /><CodeLine lineNumber="5208"><Highlight kind="normal">                                  <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;Metadata &#42;&gt;</a> Properties) &#123;</Highlight></CodeLine>
<Link id="l05209" /><CodeLine lineNumber="5209"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Nothing to do if no property to attach.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05210" /><CodeLine lineNumber="5210"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Properties.<a href="/docs/api/classes/llvm/arrayref/#ac835b8735b1b2faec0efdca236e37d94">empty</a>())</Highlight></CodeLine>
<Link id="l05211" /><CodeLine lineNumber="5211"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05212" /><CodeLine lineNumber="5212"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05213" /><CodeLine lineNumber="5213"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>();</Highlight></CodeLine>
<Link id="l05214" /><CodeLine lineNumber="5214"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Metadata &#42;&gt;</a> NewProperties;</Highlight></CodeLine>
<Link id="l05215" /><CodeLine lineNumber="5215"><Highlight kind="normal">  NewProperties.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05216" /><CodeLine lineNumber="5216"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05217" /><CodeLine lineNumber="5217"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If the basic block already has metadata, prepend it to the new metadata.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05218" /><CodeLine lineNumber="5218"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42;Existing = BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a6c09737e146b2d816c911a047ac67ba4">getMetadata</a>(LLVMContext::MD&#95;loop);</Highlight></CodeLine>
<Link id="l05219" /><CodeLine lineNumber="5219"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Existing)</Highlight></CodeLine>
<Link id="l05220" /><CodeLine lineNumber="5220"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a39d3d23a084c4544ee5903203db10e8a">append&#95;range</a>(NewProperties, <a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">drop&#95;begin</a>(Existing-&gt;<a href="/docs/api/classes/llvm/mdnode/#a571612461ea4af620bc4c441d61579a3">operands</a>(), 1));</Highlight></CodeLine>
<Link id="l05221" /><CodeLine lineNumber="5221"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05222" /><CodeLine lineNumber="5222"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a39d3d23a084c4544ee5903203db10e8a">append&#95;range</a>(NewProperties, Properties);</Highlight></CodeLine>
<Link id="l05223" /><CodeLine lineNumber="5223"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42;BasicBlockID = <a href="/docs/api/classes/llvm/mdnode/#a21a975fd58c287a6ca3f1c89c048e7d3">MDNode::getDistinct</a>(Ctx, NewProperties);</Highlight></CodeLine>
<Link id="l05224" /><CodeLine lineNumber="5224"><Highlight kind="normal">  BasicBlockID-&gt;<a href="/docs/api/classes/llvm/mdnode/#a160e9e1a4fd597f83034c8b2ba316984">replaceOperandWith</a>(0, BasicBlockID);</Highlight></CodeLine>
<Link id="l05225" /><CodeLine lineNumber="5225"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05226" /><CodeLine lineNumber="5226"><Highlight kind="normal">  BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a9247a212ea89acc9573fa7e7f557eaba">setMetadata</a>(LLVMContext::MD&#95;loop, BasicBlockID);</Highlight></CodeLine>
<Link id="l05227" /><CodeLine lineNumber="5227"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05228" /><CodeLine lineNumber="5228"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05229" /><CodeLine lineNumber="5229"><Highlight kind="comment">/// Attach loop metadata \\p Properties to the loop described by \\p Loop. If the</Highlight></CodeLine>
<Link id="l05230" /><CodeLine lineNumber="5230"><Highlight kind="comment">/// loop already has metadata, the loop properties are appended.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05231" /><CodeLine lineNumber="5231" lineLink="#adf813540e363817b85e9eecef51269b5"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#adf813540e363817b85e9eecef51269b5">addLoopMetadata</a>(<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;<a href="/docs/api/classes/llvm/loop">Loop</a>,</Highlight></CodeLine>
<Link id="l05232" /><CodeLine lineNumber="5232"><Highlight kind="normal">                            <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;Metadata &#42;&gt;</a> Properties) &#123;</Highlight></CodeLine>
<Link id="l05233" /><CodeLine lineNumber="5233"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/loop">Loop</a>-&gt;isValid() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expecting a valid CanonicalLoopInfo&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05234" /><CodeLine lineNumber="5234"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05235" /><CodeLine lineNumber="5235"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Attach metadata to the loop&#39;s latch</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05236" /><CodeLine lineNumber="5236"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Latch = <a href="/docs/api/classes/llvm/loop">Loop</a>-&gt;getLatch();</Highlight></CodeLine>
<Link id="l05237" /><CodeLine lineNumber="5237"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Latch &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;A valid CanonicalLoopInfo must have a unique latch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05238" /><CodeLine lineNumber="5238"><Highlight kind="normal">  <a href="#ac36177cea684b1e36fdbc92d692f69d0">addBasicBlockMetadata</a>(Latch, Properties);</Highlight></CodeLine>
<Link id="l05239" /><CodeLine lineNumber="5239"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05240" /><CodeLine lineNumber="5240"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05241" /><CodeLine lineNumber="5241"><Highlight kind="comment">/// Attach llvm.access.group metadata to the memref instructions of \\p Block</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05242" /><CodeLine lineNumber="5242" lineLink="#a545cc7eb4f94d0957ba9960a69b10a90"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a545cc7eb4f94d0957ba9960a69b10a90">addSimdMetadata</a>(<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>, <a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42;AccessGroup,</Highlight></CodeLine>
<Link id="l05243" /><CodeLine lineNumber="5243"><Highlight kind="normal">                            <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI) &#123;</Highlight></CodeLine>
<Link id="l05244" /><CodeLine lineNumber="5244"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : &#42;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>) &#123;</Highlight></CodeLine>
<Link id="l05245" /><CodeLine lineNumber="5245"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.mayReadOrWriteMemory()) &#123;</Highlight></CodeLine>
<Link id="l05246" /><CodeLine lineNumber="5246"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// TODO: This instruction may already have access group from</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05247" /><CodeLine lineNumber="5247"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// other pragmas e.g. #pragma clang loop vectorize.  Append</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05248" /><CodeLine lineNumber="5248"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// so that the existing metadata is not overwritten.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05249" /><CodeLine lineNumber="5249"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.setMetadata(LLVMContext::MD&#95;access&#95;group, AccessGroup);</Highlight></CodeLine>
<Link id="l05250" /><CodeLine lineNumber="5250"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05251" /><CodeLine lineNumber="5251"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05252" /><CodeLine lineNumber="5252"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05253" /><CodeLine lineNumber="5253"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05254" /><CodeLine lineNumber="5254" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a28a2a9806d828609fe107f766d2dd569"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a28a2a9806d828609fe107f766d2dd569">OpenMPIRBuilder::unrollLoopFull</a>(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a>, <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;<a href="/docs/api/classes/llvm/loop">Loop</a>) &#123;</Highlight></CodeLine>
<Link id="l05255" /><CodeLine lineNumber="5255"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>();</Highlight></CodeLine>
<Link id="l05256" /><CodeLine lineNumber="5256"><Highlight kind="normal">  <a href="#adf813540e363817b85e9eecef51269b5">addLoopMetadata</a>(</Highlight></CodeLine>
<Link id="l05257" /><CodeLine lineNumber="5257"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/loop">Loop</a>, &#123;<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, <a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.unroll.enable&quot;</Highlight><Highlight kind="normal">)),</Highlight></CodeLine>
<Link id="l05258" /><CodeLine lineNumber="5258"><Highlight kind="normal">             <a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, <a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.unroll.full&quot;</Highlight><Highlight kind="normal">))&#125;);</Highlight></CodeLine>
<Link id="l05259" /><CodeLine lineNumber="5259"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05260" /><CodeLine lineNumber="5260"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05261" /><CodeLine lineNumber="5261" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a4ca0068cb6a50615c74ecdb8f23839e0"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a4ca0068cb6a50615c74ecdb8f23839e0">OpenMPIRBuilder::unrollLoopHeuristic</a>(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a>, <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;<a href="/docs/api/classes/llvm/loop">Loop</a>) &#123;</Highlight></CodeLine>
<Link id="l05262" /><CodeLine lineNumber="5262"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>();</Highlight></CodeLine>
<Link id="l05263" /><CodeLine lineNumber="5263"><Highlight kind="normal">  <a href="#adf813540e363817b85e9eecef51269b5">addLoopMetadata</a>(</Highlight></CodeLine>
<Link id="l05264" /><CodeLine lineNumber="5264"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/loop">Loop</a>, &#123;</Highlight></CodeLine>
<Link id="l05265" /><CodeLine lineNumber="5265"><Highlight kind="normal">                <a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, <a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.unroll.enable&quot;</Highlight><Highlight kind="normal">)),</Highlight></CodeLine>
<Link id="l05266" /><CodeLine lineNumber="5266"><Highlight kind="normal">            &#125;);</Highlight></CodeLine>
<Link id="l05267" /><CodeLine lineNumber="5267"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05268" /><CodeLine lineNumber="5268"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05269" /><CodeLine lineNumber="5269"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::createIfVersion(<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CanonicalLoop,</Highlight></CodeLine>
<Link id="l05270" /><CodeLine lineNumber="5270"><Highlight kind="normal">                                      <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCond, <a href="/docs/api/namespaces/llvm/#abf0f52ae29f87b5e0f2b95ff961cdae1">ValueToValueMapTy</a> &amp;VMap,</Highlight></CodeLine>
<Link id="l05271" /><CodeLine lineNumber="5271"><Highlight kind="normal">                                      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp;NamePrefix) &#123;</Highlight></CodeLine>
<Link id="l05272" /><CodeLine lineNumber="5272"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a9592feb460b27d417f42a41aabfe253a">getFunction</a>();</Highlight></CodeLine>
<Link id="l05273" /><CodeLine lineNumber="5273"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05274" /><CodeLine lineNumber="5274"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Define where if branch should be inserted</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05275" /><CodeLine lineNumber="5275"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;SplitBefore = CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l05276" /><CodeLine lineNumber="5276"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05277" /><CodeLine lineNumber="5277"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: We should not rely on pass manager. Currently we use pass manager</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05278" /><CodeLine lineNumber="5278"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// only for getting llvm::Loop which corresponds to given CanonicalLoopInfo</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05279" /><CodeLine lineNumber="5279"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// object. We should have a method  which returns all blocks between</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05280" /><CodeLine lineNumber="5280"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// CanonicalLoopInfo::getHeader() and CanonicalLoopInfo::getAfter()</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05281" /><CodeLine lineNumber="5281"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#adce09a5a0de0e3177eb00e932734af2f">FunctionAnalysisManager</a> <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>;</Highlight></CodeLine>
<Link id="l05282" /><CodeLine lineNumber="5282"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/dominatortreeanalysis">DominatorTreeAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05283" /><CodeLine lineNumber="5283"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loopanalysis">LoopAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05284" /><CodeLine lineNumber="5284"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.<a href="/docs/api/classes/llvm/analysismanager/#a91ff894f756175a693c85bf73f79de9e">registerPass</a>(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> PassInstrumentationAnalysis(); &#125;);</Highlight></CodeLine>
<Link id="l05285" /><CodeLine lineNumber="5285"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05286" /><CodeLine lineNumber="5286"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Get the loop which needs to be cloned</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05287" /><CodeLine lineNumber="5287"><Highlight kind="normal">  LoopAnalysis LIA;</Highlight></CodeLine>
<Link id="l05288" /><CodeLine lineNumber="5288"><Highlight kind="normal">  LoopInfo &amp;&amp;LI = LIA.<a href="/docs/api/classes/llvm/loopanalysis/#aea38b668f2d98b7e9f64b8b3c2e524dc">run</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</Highlight></CodeLine>
<Link id="l05289" /><CodeLine lineNumber="5289"><Highlight kind="normal">  Loop &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = LI.<a href="/docs/api/classes/llvm/loopinfobase/#ad61bd84d4988c90bf6c5cd62d8e7fb00">getLoopFor</a>(CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01c4471afa921c4962d7138cfcef4942">getHeader</a>());</Highlight></CodeLine>
<Link id="l05290" /><CodeLine lineNumber="5290"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05291" /><CodeLine lineNumber="5291"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create additional blocks for the if statement</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05292" /><CodeLine lineNumber="5292"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;Head = SplitBefore-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>();</Highlight></CodeLine>
<Link id="l05293" /><CodeLine lineNumber="5293"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;HeadOldTerm = Head-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l05294" /><CodeLine lineNumber="5294"><Highlight kind="normal">  llvm::LLVMContext &amp;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = Head-&gt;<a href="/docs/api/classes/llvm/basicblock/#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>();</Highlight></CodeLine>
<Link id="l05295" /><CodeLine lineNumber="5295"><Highlight kind="normal">  llvm::BasicBlock &#42;ThenBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">llvm::BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l05296" /><CodeLine lineNumber="5296"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, NamePrefix + </Highlight><Highlight kind="stringliteral">&quot;.if.then&quot;</Highlight><Highlight kind="normal">, Head-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>(), Head-&gt;<a href="/docs/api/classes/llvm/ilist-node-with-parent/#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>());</Highlight></CodeLine>
<Link id="l05297" /><CodeLine lineNumber="5297"><Highlight kind="normal">  llvm::BasicBlock &#42;ElseBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">llvm::BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l05298" /><CodeLine lineNumber="5298"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, NamePrefix + </Highlight><Highlight kind="stringliteral">&quot;.if.else&quot;</Highlight><Highlight kind="normal">, Head-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>(), CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>());</Highlight></CodeLine>
<Link id="l05299" /><CodeLine lineNumber="5299"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05300" /><CodeLine lineNumber="5300"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create if condition branch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05301" /><CodeLine lineNumber="5301"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(HeadOldTerm);</Highlight></CodeLine>
<Link id="l05302" /><CodeLine lineNumber="5302"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;BrInstr =</Highlight></CodeLine>
<Link id="l05303" /><CodeLine lineNumber="5303"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(IfCond, ThenBlock, </Highlight><Highlight kind="comment">/&#42;ifFalse&#42;/</Highlight><Highlight kind="normal"> ElseBlock);</Highlight></CodeLine>
<Link id="l05304" /><CodeLine lineNumber="5304"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> IP&#123;BrInstr-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>(), ++BrInstr-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>()&#125;;</Highlight></CodeLine>
<Link id="l05305" /><CodeLine lineNumber="5305"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Then block contains branch to omp loop which needs to be vectorized</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05306" /><CodeLine lineNumber="5306"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a78e14f66d8a8405c6882b5ff6a3b7617">spliceBB</a>(IP, ThenBlock, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05307" /><CodeLine lineNumber="5307"><Highlight kind="normal">  ThenBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#a089e003bb688e55b9a91ed4e7fed3678">replaceSuccessorsPhiUsesWith</a>(Head, ThenBlock);</Highlight></CodeLine>
<Link id="l05308" /><CodeLine lineNumber="5308"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05309" /><CodeLine lineNumber="5309"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ElseBlock);</Highlight></CodeLine>
<Link id="l05310" /><CodeLine lineNumber="5310"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05311" /><CodeLine lineNumber="5311"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Clone loop for the else branch</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05312" /><CodeLine lineNumber="5312"><Highlight kind="normal">  SmallVector&lt;BasicBlock &#42;, 8&gt; NewBlocks;</Highlight></CodeLine>
<Link id="l05313" /><CodeLine lineNumber="5313"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05314" /><CodeLine lineNumber="5314"><Highlight kind="normal">  VMap&#91;CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>()&#93; = ElseBlock;</Highlight></CodeLine>
<Link id="l05315" /><CodeLine lineNumber="5315"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (BasicBlock &#42;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getBlocks()) &#123;</Highlight></CodeLine>
<Link id="l05316" /><CodeLine lineNumber="5316"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;NewBB = <a href="/docs/api/namespaces/llvm/#aa1c8d384f90fc9d69d7fcdf920138cf2">CloneBasicBlock</a>(<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>, VMap, </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l05317" /><CodeLine lineNumber="5317"><Highlight kind="normal">    NewBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#ac1fd6437bbfce263b87f01767d950ce5">moveBefore</a>(CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad3bf46daef8ce8176a68bcec0320dfd3">getExit</a>());</Highlight></CodeLine>
<Link id="l05318" /><CodeLine lineNumber="5318"><Highlight kind="normal">    VMap&#91;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>&#93; = NewBB;</Highlight></CodeLine>
<Link id="l05319" /><CodeLine lineNumber="5319"><Highlight kind="normal">    NewBlocks.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NewBB);</Highlight></CodeLine>
<Link id="l05320" /><CodeLine lineNumber="5320"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05321" /><CodeLine lineNumber="5321"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#ab8ec5c940fbc440c992716fbe4a48636">remapInstructionsInBlocks</a>(NewBlocks, VMap);</Highlight></CodeLine>
<Link id="l05322" /><CodeLine lineNumber="5322"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(NewBlocks.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>());</Highlight></CodeLine>
<Link id="l05323" /><CodeLine lineNumber="5323"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05324" /><CodeLine lineNumber="5324"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05325" /><CodeLine lineNumber="5325"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05326" /><CodeLine lineNumber="5326" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ac5b407054e7727d04053af9c3f1a5568"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#ac5b407054e7727d04053af9c3f1a5568">OpenMPIRBuilder::getOpenMPDefaultSimdAlign</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/triple">Triple</a> &amp;TargetTriple,</Highlight></CodeLine>
<Link id="l05327" /><CodeLine lineNumber="5327"><Highlight kind="normal">                                           </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/stringmap">StringMap&lt;bool&gt;</a> &amp;Features) &#123;</Highlight></CodeLine>
<Link id="l05328" /><CodeLine lineNumber="5328"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TargetTriple.<a href="/docs/api/classes/llvm/triple/#a31d94b95418472bb1179f7c130ad3667">isX86</a>()) &#123;</Highlight></CodeLine>
<Link id="l05329" /><CodeLine lineNumber="5329"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Features.<a href="/docs/api/classes/llvm/stringmap/#aa6528965c64b379c2cb311599babdd66">lookup</a>(</Highlight><Highlight kind="stringliteral">&quot;avx512f&quot;</Highlight><Highlight kind="normal">))</Highlight></CodeLine>
<Link id="l05330" /><CodeLine lineNumber="5330"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 512;</Highlight></CodeLine>
<Link id="l05331" /><CodeLine lineNumber="5331"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Features.<a href="/docs/api/classes/llvm/stringmap/#aa6528965c64b379c2cb311599babdd66">lookup</a>(</Highlight><Highlight kind="stringliteral">&quot;avx&quot;</Highlight><Highlight kind="normal">))</Highlight></CodeLine>
<Link id="l05332" /><CodeLine lineNumber="5332"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 256;</Highlight></CodeLine>
<Link id="l05333" /><CodeLine lineNumber="5333"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 128;</Highlight></CodeLine>
<Link id="l05334" /><CodeLine lineNumber="5334"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05335" /><CodeLine lineNumber="5335"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TargetTriple.<a href="/docs/api/classes/llvm/triple/#a0338eabc8ab4dff6368bdfae6ec94cbc">isPPC</a>())</Highlight></CodeLine>
<Link id="l05336" /><CodeLine lineNumber="5336"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 128;</Highlight></CodeLine>
<Link id="l05337" /><CodeLine lineNumber="5337"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TargetTriple.<a href="/docs/api/classes/llvm/triple/#acf7f07dbe7dd1f7edd291b75005280bb">isWasm</a>())</Highlight></CodeLine>
<Link id="l05338" /><CodeLine lineNumber="5338"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 128;</Highlight></CodeLine>
<Link id="l05339" /><CodeLine lineNumber="5339"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 0;</Highlight></CodeLine>
<Link id="l05340" /><CodeLine lineNumber="5340"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05341" /><CodeLine lineNumber="5341"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05342" /><CodeLine lineNumber="5342" lineLink="/docs/api/classes/llvm/openmpirbuilder/#acd1fbb2df257f945afda92919be322f3"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#acd1fbb2df257f945afda92919be322f3">OpenMPIRBuilder::applySimd</a>(<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CanonicalLoop,</Highlight></CodeLine>
<Link id="l05343" /><CodeLine lineNumber="5343"><Highlight kind="normal">                                <a href="/docs/api/classes/llvm/mapvector">MapVector&lt;Value &#42;, Value &#42;&gt;</a> AlignedVars,</Highlight></CodeLine>
<Link id="l05344" /><CodeLine lineNumber="5344"><Highlight kind="normal">                                <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCond, OrderKind Order,</Highlight></CodeLine>
<Link id="l05345" /><CodeLine lineNumber="5345"><Highlight kind="normal">                                <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;Simdlen, <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;Safelen) &#123;</Highlight></CodeLine>
<Link id="l05346" /><CodeLine lineNumber="5346"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>();</Highlight></CodeLine>
<Link id="l05347" /><CodeLine lineNumber="5347"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05348" /><CodeLine lineNumber="5348"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a9592feb460b27d417f42a41aabfe253a">getFunction</a>();</Highlight></CodeLine>
<Link id="l05349" /><CodeLine lineNumber="5349"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05350" /><CodeLine lineNumber="5350"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: We should not rely on pass manager. Currently we use pass manager</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05351" /><CodeLine lineNumber="5351"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// only for getting llvm::Loop which corresponds to given CanonicalLoopInfo</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05352" /><CodeLine lineNumber="5352"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// object. We should have a method  which returns all blocks between</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05353" /><CodeLine lineNumber="5353"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// CanonicalLoopInfo::getHeader() and CanonicalLoopInfo::getAfter()</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05354" /><CodeLine lineNumber="5354"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#adce09a5a0de0e3177eb00e932734af2f">FunctionAnalysisManager</a> <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>;</Highlight></CodeLine>
<Link id="l05355" /><CodeLine lineNumber="5355"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/dominatortreeanalysis">DominatorTreeAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05356" /><CodeLine lineNumber="5356"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loopanalysis">LoopAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05357" /><CodeLine lineNumber="5357"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/passinstrumentationanalysis">PassInstrumentationAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05358" /><CodeLine lineNumber="5358"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05359" /><CodeLine lineNumber="5359"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/loopanalysis">LoopAnalysis</a> LIA;</Highlight></CodeLine>
<Link id="l05360" /><CodeLine lineNumber="5360"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;&amp;LI = LIA.<a href="/docs/api/classes/llvm/loopanalysis/#aea38b668f2d98b7e9f64b8b3c2e524dc">run</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</Highlight></CodeLine>
<Link id="l05361" /><CodeLine lineNumber="5361"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05362" /><CodeLine lineNumber="5362"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L = LI.<a href="/docs/api/classes/llvm/loopinfobase/#ad61bd84d4988c90bf6c5cd62d8e7fb00">getLoopFor</a>(CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01c4471afa921c4962d7138cfcef4942">getHeader</a>());</Highlight></CodeLine>
<Link id="l05363" /><CodeLine lineNumber="5363"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AlignedVars.<a href="/docs/api/classes/llvm/mapvector/#acf4c09e1f30cdd4e0b5b1b8a236ead34">size</a>()) &#123;</Highlight></CodeLine>
<Link id="l05364" /><CodeLine lineNumber="5364"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> IP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l05365" /><CodeLine lineNumber="5365"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;AlignedItem : AlignedVars) &#123;</Highlight></CodeLine>
<Link id="l05366" /><CodeLine lineNumber="5366"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;AlignedPtr = AlignedItem.first;</Highlight></CodeLine>
<Link id="l05367" /><CodeLine lineNumber="5367"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;Alignment = AlignedItem.second;</Highlight></CodeLine>
<Link id="l05368" /><CodeLine lineNumber="5368"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;loadInst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(AlignedPtr);</Highlight></CodeLine>
<Link id="l05369" /><CodeLine lineNumber="5369"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(loadInst-&gt;<a href="/docs/api/classes/llvm/ilist-node-with-parent/#a62ee7ece4986606d41363bc1f70d5ab2">getNextNode</a>());</Highlight></CodeLine>
<Link id="l05370" /><CodeLine lineNumber="5370"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a480959ce9fb41e0ac0ce2cd7907d7ace">CreateAlignmentAssumption</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getDataLayout(), AlignedPtr,</Highlight></CodeLine>
<Link id="l05371" /><CodeLine lineNumber="5371"><Highlight kind="normal">                                        Alignment);</Highlight></CodeLine>
<Link id="l05372" /><CodeLine lineNumber="5372"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05373" /><CodeLine lineNumber="5373"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(IP);</Highlight></CodeLine>
<Link id="l05374" /><CodeLine lineNumber="5374"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05375" /><CodeLine lineNumber="5375"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05376" /><CodeLine lineNumber="5376"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCond) &#123;</Highlight></CodeLine>
<Link id="l05377" /><CodeLine lineNumber="5377"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#abf0f52ae29f87b5e0f2b95ff961cdae1">ValueToValueMapTy</a> VMap;</Highlight></CodeLine>
<Link id="l05378" /><CodeLine lineNumber="5378"><Highlight kind="normal">    createIfVersion(CanonicalLoop, IfCond, VMap, </Highlight><Highlight kind="stringliteral">&quot;simd&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05379" /><CodeLine lineNumber="5379"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add metadata to the cloned loop which disables vectorization</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05380" /><CodeLine lineNumber="5380"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;MappedLatch = VMap.<a href="/docs/api/classes/llvm/valuemap/#a15f92579a5fc316dab8cd1fad51015ef">lookup</a>(CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>());</Highlight></CodeLine>
<Link id="l05381" /><CodeLine lineNumber="5381"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MappedLatch &amp;&amp;</Highlight></CodeLine>
<Link id="l05382" /><CodeLine lineNumber="5382"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Cannot find value which corresponds to original loop latch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05383" /><CodeLine lineNumber="5383"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;BasicBlock&gt;</a>(MappedLatch) &amp;&amp;</Highlight></CodeLine>
<Link id="l05384" /><CodeLine lineNumber="5384"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Cannot cast mapped latch block value to BasicBlock&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05385" /><CodeLine lineNumber="5385"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;NewLatchBlock = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;BasicBlock&gt;</a>(MappedLatch);</Highlight></CodeLine>
<Link id="l05386" /><CodeLine lineNumber="5386"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constantasmetadata">ConstantAsMetadata</a> &#42;BoolConst =</Highlight></CodeLine>
<Link id="l05387" /><CodeLine lineNumber="5387"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(<a href="/docs/api/classes/llvm/constantint/#aa7cce62ac5cc6df09cce0535874336b7">ConstantInt::getFalse</a>(<a href="/docs/api/classes/llvm/type/#aa75984a442f2379de0c66018201fa628">Type::getInt1Ty</a>(Ctx)));</Highlight></CodeLine>
<Link id="l05388" /><CodeLine lineNumber="5388"><Highlight kind="normal">    <a href="#ac36177cea684b1e36fdbc92d692f69d0">addBasicBlockMetadata</a>(</Highlight></CodeLine>
<Link id="l05389" /><CodeLine lineNumber="5389"><Highlight kind="normal">        NewLatchBlock,</Highlight></CodeLine>
<Link id="l05390" /><CodeLine lineNumber="5390"><Highlight kind="normal">        &#123;<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, &#123;<a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.vectorize.enable&quot;</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l05391" /><CodeLine lineNumber="5391"><Highlight kind="normal">                           BoolConst&#125;)&#125;);</Highlight></CodeLine>
<Link id="l05392" /><CodeLine lineNumber="5392"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05393" /><CodeLine lineNumber="5393"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05394" /><CodeLine lineNumber="5394"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallset">SmallSet&lt;BasicBlock &#42;, 8&gt;</a> Reachable;</Highlight></CodeLine>
<Link id="l05395" /><CodeLine lineNumber="5395"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05396" /><CodeLine lineNumber="5396"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Get the basic blocks from the loop in which memref instructions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05397" /><CodeLine lineNumber="5397"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// can be found.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05398" /><CodeLine lineNumber="5398"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Generalize getting all blocks inside a CanonicalizeLoopInfo,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05399" /><CodeLine lineNumber="5399"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// preferably without running any passes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05400" /><CodeLine lineNumber="5400"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> : L-&gt;getBlocks()) &#123;</Highlight></CodeLine>
<Link id="l05401" /><CodeLine lineNumber="5401"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> == CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#acb5b5b136597312e0d5df6b746a7e6db">getCond</a>() ||</Highlight></CodeLine>
<Link id="l05402" /><CodeLine lineNumber="5402"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> == CanonicalLoop-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01c4471afa921c4962d7138cfcef4942">getHeader</a>())</Highlight></CodeLine>
<Link id="l05403" /><CodeLine lineNumber="5403"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05404" /><CodeLine lineNumber="5404"><Highlight kind="normal">    Reachable.insert(<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>);</Highlight></CodeLine>
<Link id="l05405" /><CodeLine lineNumber="5405"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05406" /><CodeLine lineNumber="5406"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05407" /><CodeLine lineNumber="5407"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Metadata &#42;&gt;</a> LoopMDList;</Highlight></CodeLine>
<Link id="l05408" /><CodeLine lineNumber="5408"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05409" /><CodeLine lineNumber="5409"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// In presence of finite &#39;safelen&#39;, it may be unsafe to mark all</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05410" /><CodeLine lineNumber="5410"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the memory instructions parallel, because loop-carried</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05411" /><CodeLine lineNumber="5411"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// dependences of &#39;safelen&#39; iterations are possible.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05412" /><CodeLine lineNumber="5412"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If clause order(concurrent) is specified then the memory instructions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05413" /><CodeLine lineNumber="5413"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// are marked parallel even if &#39;safelen&#39; is finite.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05414" /><CodeLine lineNumber="5414"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((Safelen == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">) || (Order == OrderKind::OMP&#95;ORDER&#95;concurrent)) &#123;</Highlight></CodeLine>
<Link id="l05415" /><CodeLine lineNumber="5415"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add access group metadata to memory-access instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05416" /><CodeLine lineNumber="5416"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42;AccessGroup = <a href="/docs/api/classes/llvm/mdnode/#a21a975fd58c287a6ca3f1c89c048e7d3">MDNode::getDistinct</a>(Ctx, &#123;&#125;);</Highlight></CodeLine>
<Link id="l05417" /><CodeLine lineNumber="5417"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB : Reachable)</Highlight></CodeLine>
<Link id="l05418" /><CodeLine lineNumber="5418"><Highlight kind="normal">      <a href="#a545cc7eb4f94d0957ba9960a69b10a90">addSimdMetadata</a>(BB, AccessGroup, LI);</Highlight></CodeLine>
<Link id="l05419" /><CodeLine lineNumber="5419"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO:  If the loop has existing parallel access metadata, have</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05420" /><CodeLine lineNumber="5420"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// to combine two lists.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05421" /><CodeLine lineNumber="5421"><Highlight kind="normal">    LoopMDList.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(</Highlight></CodeLine>
<Link id="l05422" /><CodeLine lineNumber="5422"><Highlight kind="normal">        Ctx, &#123;<a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.parallel&#95;accesses&quot;</Highlight><Highlight kind="normal">), AccessGroup&#125;));</Highlight></CodeLine>
<Link id="l05423" /><CodeLine lineNumber="5423"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05424" /><CodeLine lineNumber="5424"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05425" /><CodeLine lineNumber="5425"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Use the above access group metadata to create loop level</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05426" /><CodeLine lineNumber="5426"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// metadata, which should be distinct for each loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05427" /><CodeLine lineNumber="5427"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constantasmetadata">ConstantAsMetadata</a> &#42;BoolConst =</Highlight></CodeLine>
<Link id="l05428" /><CodeLine lineNumber="5428"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(<a href="/docs/api/classes/llvm/constantint/#a82dbbd8e3688b0bc1eedb338864d0d0c">ConstantInt::getTrue</a>(<a href="/docs/api/classes/llvm/type/#aa75984a442f2379de0c66018201fa628">Type::getInt1Ty</a>(Ctx)));</Highlight></CodeLine>
<Link id="l05429" /><CodeLine lineNumber="5429"><Highlight kind="normal">  LoopMDList.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(</Highlight></CodeLine>
<Link id="l05430" /><CodeLine lineNumber="5430"><Highlight kind="normal">      Ctx, &#123;<a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.vectorize.enable&quot;</Highlight><Highlight kind="normal">), BoolConst&#125;));</Highlight></CodeLine>
<Link id="l05431" /><CodeLine lineNumber="5431"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05432" /><CodeLine lineNumber="5432"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Simdlen || Safelen) &#123;</Highlight></CodeLine>
<Link id="l05433" /><CodeLine lineNumber="5433"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If both simdlen and safelen clauses are specified, the value of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05434" /><CodeLine lineNumber="5434"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// simdlen parameter must be less than or equal to the value of the safelen</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05435" /><CodeLine lineNumber="5435"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// parameter. Therefore, use safelen only in the absence of simdlen.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05436" /><CodeLine lineNumber="5436"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;VectorizeWidth = Simdlen == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal"> ? Safelen : Simdlen;</Highlight></CodeLine>
<Link id="l05437" /><CodeLine lineNumber="5437"><Highlight kind="normal">    LoopMDList.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight></CodeLine>
<Link id="l05438" /><CodeLine lineNumber="5438"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, &#123;<a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.vectorize.width&quot;</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l05439" /><CodeLine lineNumber="5439"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(VectorizeWidth)&#125;));</Highlight></CodeLine>
<Link id="l05440" /><CodeLine lineNumber="5440"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05441" /><CodeLine lineNumber="5441"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05442" /><CodeLine lineNumber="5442"><Highlight kind="normal">  <a href="#adf813540e363817b85e9eecef51269b5">addLoopMetadata</a>(CanonicalLoop, LoopMDList);</Highlight></CodeLine>
<Link id="l05443" /><CodeLine lineNumber="5443"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05444" /><CodeLine lineNumber="5444"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05445" /><CodeLine lineNumber="5445"><Highlight kind="comment">/// Create the TargetMachine object to query the backend for optimization</Highlight></CodeLine>
<Link id="l05446" /><CodeLine lineNumber="5446"><Highlight kind="comment">/// preferences.</Highlight></CodeLine>
<Link id="l05447" /><CodeLine lineNumber="5447"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l05448" /><CodeLine lineNumber="5448"><Highlight kind="comment">/// Ideally, this would be passed from the front-end to the OpenMPBuilder, but</Highlight></CodeLine>
<Link id="l05449" /><CodeLine lineNumber="5449"><Highlight kind="comment">/// e.g. Clang does not pass it to its CodeGen layer and creates it only when</Highlight></CodeLine>
<Link id="l05450" /><CodeLine lineNumber="5450"><Highlight kind="comment">/// needed for the LLVM pass pipline. We use some default options to avoid</Highlight></CodeLine>
<Link id="l05451" /><CodeLine lineNumber="5451"><Highlight kind="comment">/// having to pass too many settings from the frontend that probably do not</Highlight></CodeLine>
<Link id="l05452" /><CodeLine lineNumber="5452"><Highlight kind="comment">/// matter.</Highlight></CodeLine>
<Link id="l05453" /><CodeLine lineNumber="5453"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l05454" /><CodeLine lineNumber="5454"><Highlight kind="comment">/// Currently, TargetMachine is only used sometimes by the unrollLoopPartial</Highlight></CodeLine>
<Link id="l05455" /><CodeLine lineNumber="5455"><Highlight kind="comment">/// method. If we are going to use TargetMachine for more purposes, especially</Highlight></CodeLine>
<Link id="l05456" /><CodeLine lineNumber="5456"><Highlight kind="comment">/// those that are sensitive to TargetOptions, RelocModel and CodeModel, it</Highlight></CodeLine>
<Link id="l05457" /><CodeLine lineNumber="5457"><Highlight kind="comment">/// might become be worth requiring front-ends to pass on their TargetMachine,</Highlight></CodeLine>
<Link id="l05458" /><CodeLine lineNumber="5458"><Highlight kind="comment">/// or at least cache it between methods. Note that while fontends such as Clang</Highlight></CodeLine>
<Link id="l05459" /><CodeLine lineNumber="5459"><Highlight kind="comment">/// have just a single main TargetMachine per translation unit, &quot;target-cpu&quot; and</Highlight></CodeLine>
<Link id="l05460" /><CodeLine lineNumber="5460"><Highlight kind="comment">/// &quot;target-features&quot; that determine the TargetMachine are per-function and can</Highlight></CodeLine>
<Link id="l05461" /><CodeLine lineNumber="5461"><Highlight kind="comment">/// be overrided using &#95;&#95;attribute&#95;&#95;((target(&quot;OPTIONS&quot;))).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05462" /><CodeLine lineNumber="5462"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> std::unique&#95;ptr&lt;TargetMachine&gt;</Highlight></CodeLine>
<Link id="l05463" /><CodeLine lineNumber="5463" lineLink="#abfc7ebfffc7baaf23279854fec1412ac"><Highlight kind="normal"><a href="#abfc7ebfffc7baaf23279854fec1412ac">createTargetMachine</a>(<a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/namespaces/llvm/#a8ec1bf8d7b792ca9fac56f8514db18d2">CodeGenOptLevel</a> OptLevel) &#123;</Highlight></CodeLine>
<Link id="l05464" /><CodeLine lineNumber="5464"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/module">Module</a> &#42;M = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getParent();</Highlight></CodeLine>
<Link id="l05465" /><CodeLine lineNumber="5465"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05466" /><CodeLine lineNumber="5466"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/stringref">StringRef</a> CPU = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getFnAttribute(</Highlight><Highlight kind="stringliteral">&quot;target-cpu&quot;</Highlight><Highlight kind="normal">).getValueAsString();</Highlight></CodeLine>
<Link id="l05467" /><CodeLine lineNumber="5467"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/stringref">StringRef</a> Features = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getFnAttribute(</Highlight><Highlight kind="stringliteral">&quot;target-features&quot;</Highlight><Highlight kind="normal">).getValueAsString();</Highlight></CodeLine>
<Link id="l05468" /><CodeLine lineNumber="5468"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> std::string &amp;<a href="/docs/api/classes/llvm/triple">Triple</a> = M-&gt;getTargetTriple();</Highlight></CodeLine>
<Link id="l05469" /><CodeLine lineNumber="5469"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05470" /><CodeLine lineNumber="5470"><Highlight kind="normal">  std::string <a href="/docs/api/classes/llvm/error">Error</a>;</Highlight></CodeLine>
<Link id="l05471" /><CodeLine lineNumber="5471"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/target">llvm::Target</a> &#42;TheTarget = <a href="/docs/api/structs/llvm/targetregistry/#a85a69009ec328d5835241f56fb62cc6d">TargetRegistry::lookupTarget</a>(<a href="/docs/api/classes/llvm/triple">Triple</a>, <a href="/docs/api/classes/llvm/error">Error</a>);</Highlight></CodeLine>
<Link id="l05472" /><CodeLine lineNumber="5472"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!TheTarget)</Highlight></CodeLine>
<Link id="l05473" /><CodeLine lineNumber="5473"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;&#125;;</Highlight></CodeLine>
<Link id="l05474" /><CodeLine lineNumber="5474"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05475" /><CodeLine lineNumber="5475"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/targetoptions">llvm::TargetOptions</a> <a href="/docs/api/files/lib/lib/debuginfo/lib/debuginfo/logicalview/lib/debuginfo/logicalview/core/lvoptions-cpp/#ab4088b7a11f3cbc38ac16a6e9c72494e">Options</a>;</Highlight></CodeLine>
<Link id="l05476" /><CodeLine lineNumber="5476"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> std::unique&#95;ptr&lt;TargetMachine&gt;(TheTarget-&gt;<a href="/docs/api/classes/llvm/target/#a97b31e68ba164458a37e49e7d1053fc1">createTargetMachine</a>(</Highlight></CodeLine>
<Link id="l05477" /><CodeLine lineNumber="5477"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/triple">Triple</a>, CPU, Features, <a href="/docs/api/files/lib/lib/debuginfo/lib/debuginfo/logicalview/lib/debuginfo/logicalview/core/lvoptions-cpp/#ab4088b7a11f3cbc38ac16a6e9c72494e">Options</a>, </Highlight><Highlight kind="comment">/&#42;RelocModel=&#42;/</Highlight><Highlight kind="normal">std::nullopt,</Highlight></CodeLine>
<Link id="l05478" /><CodeLine lineNumber="5478"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;CodeModel=&#42;/</Highlight><Highlight kind="normal">std::nullopt, OptLevel));</Highlight></CodeLine>
<Link id="l05479" /><CodeLine lineNumber="5479"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05480" /><CodeLine lineNumber="5480"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05481" /><CodeLine lineNumber="5481"><Highlight kind="comment">/// Heuristically determine the best-performant unroll factor for \\p CLI. This</Highlight></CodeLine>
<Link id="l05482" /><CodeLine lineNumber="5482"><Highlight kind="comment">/// depends on the target processor. We are re-using the same heuristics as the</Highlight></CodeLine>
<Link id="l05483" /><CodeLine lineNumber="5483"><Highlight kind="comment">/// LoopUnrollPass.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05484" /><CodeLine lineNumber="5484" lineLink="#a946282957319b8c23ab9f169abb504c4"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> int32&#95;t <a href="#a946282957319b8c23ab9f169abb504c4">computeHeuristicUnrollFactor</a>(<a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;CLI) &#123;</Highlight></CodeLine>
<Link id="l05485" /><CodeLine lineNumber="5485"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a9592feb460b27d417f42a41aabfe253a">getFunction</a>();</Highlight></CodeLine>
<Link id="l05486" /><CodeLine lineNumber="5486"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05487" /><CodeLine lineNumber="5487"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Assume the user requests the most aggressive unrolling, even if the rest of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05488" /><CodeLine lineNumber="5488"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the code is optimized using a lower setting.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05489" /><CodeLine lineNumber="5489"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a8ec1bf8d7b792ca9fac56f8514db18d2">CodeGenOptLevel</a> OptLevel = <a href="/docs/api/namespaces/llvm/#a8ec1bf8d7b792ca9fac56f8514db18d2a389a96d0d9b3feb46b8c9d941566a4ae">CodeGenOptLevel::Aggressive</a>;</Highlight></CodeLine>
<Link id="l05490" /><CodeLine lineNumber="5490"><Highlight kind="normal">  std::unique&#95;ptr&lt;TargetMachine&gt; TM = <a href="#abfc7ebfffc7baaf23279854fec1412ac">createTargetMachine</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, OptLevel);</Highlight></CodeLine>
<Link id="l05491" /><CodeLine lineNumber="5491"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05492" /><CodeLine lineNumber="5492"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#adce09a5a0de0e3177eb00e932734af2f">FunctionAnalysisManager</a> <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>;</Highlight></CodeLine>
<Link id="l05493" /><CodeLine lineNumber="5493"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targetlibraryanalysis">TargetLibraryAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05494" /><CodeLine lineNumber="5494"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/assumptionanalysis">AssumptionAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05495" /><CodeLine lineNumber="5495"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/dominatortreeanalysis">DominatorTreeAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05496" /><CodeLine lineNumber="5496"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loopanalysis">LoopAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05497" /><CodeLine lineNumber="5497"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scalarevolutionanalysis">ScalarEvolutionAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05498" /><CodeLine lineNumber="5498"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/passinstrumentationanalysis">PassInstrumentationAnalysis</a>(); &#125;);</Highlight></CodeLine>
<Link id="l05499" /><CodeLine lineNumber="5499"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/targetiranalysis">TargetIRAnalysis</a> TIRA;</Highlight></CodeLine>
<Link id="l05500" /><CodeLine lineNumber="5500"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TM)</Highlight></CodeLine>
<Link id="l05501" /><CodeLine lineNumber="5501"><Highlight kind="normal">    TIRA = <a href="/docs/api/classes/llvm/targetiranalysis">TargetIRAnalysis</a>(</Highlight></CodeLine>
<Link id="l05502" /><CodeLine lineNumber="5502"><Highlight kind="normal">        &#91;&amp;&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/function">Function</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> TM-&gt;getTargetTransformInfo(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>); &#125;);</Highlight></CodeLine>
<Link id="l05503" /><CodeLine lineNumber="5503"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>.registerPass(&#91;&amp;&#93;() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> TIRA; &#125;);</Highlight></CodeLine>
<Link id="l05504" /><CodeLine lineNumber="5504"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05505" /><CodeLine lineNumber="5505"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/targetiranalysis/#a86179e1ebe9886a51ca1212368ee1e24">TargetIRAnalysis::Result</a> &amp;&amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a> = TIRA.<a href="/docs/api/classes/llvm/targetiranalysis/#a4c1acdb96111dcff6f3eb282adecf86b">run</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</Highlight></CodeLine>
<Link id="l05506" /><CodeLine lineNumber="5506"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/scalarevolutionanalysis">ScalarEvolutionAnalysis</a> SEA;</Highlight></CodeLine>
<Link id="l05507" /><CodeLine lineNumber="5507"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;&amp;SE = SEA.<a href="/docs/api/classes/llvm/scalarevolutionanalysis/#acbc87d909d53e5f43fde82950e15b59d">run</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</Highlight></CodeLine>
<Link id="l05508" /><CodeLine lineNumber="5508"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/dominatortreeanalysis">DominatorTreeAnalysis</a> DTA;</Highlight></CodeLine>
<Link id="l05509" /><CodeLine lineNumber="5509"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;&amp;DT = DTA.<a href="/docs/api/classes/llvm/dominatortreeanalysis/#a4aa821b3dea8d981f76a77e5c099e3b5">run</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</Highlight></CodeLine>
<Link id="l05510" /><CodeLine lineNumber="5510"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/loopanalysis">LoopAnalysis</a> LIA;</Highlight></CodeLine>
<Link id="l05511" /><CodeLine lineNumber="5511"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;&amp;LI = LIA.<a href="/docs/api/classes/llvm/loopanalysis/#aea38b668f2d98b7e9f64b8b3c2e524dc">run</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</Highlight></CodeLine>
<Link id="l05512" /><CodeLine lineNumber="5512"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/assumptionanalysis">AssumptionAnalysis</a> ACT;</Highlight></CodeLine>
<Link id="l05513" /><CodeLine lineNumber="5513"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;&amp;AC = ACT.<a href="/docs/api/classes/llvm/assumptionanalysis/#aeb8f2cc893c02d3d5a926b69bab89185">run</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#a83c7e5ca51099e4efa895791a02fb0ed">FAM</a>);</Highlight></CodeLine>
<Link id="l05514" /><CodeLine lineNumber="5514"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/optimizationremarkemitter">OptimizationRemarkEmitter</a> ORE&#123;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>&#125;;</Highlight></CodeLine>
<Link id="l05515" /><CodeLine lineNumber="5515"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05516" /><CodeLine lineNumber="5516"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L = LI.<a href="/docs/api/classes/llvm/loopinfobase/#ad61bd84d4988c90bf6c5cd62d8e7fb00">getLoopFor</a>(CLI-&gt;<a href="/docs/api/classes/llvm/canonicalloopinfo/#a01c4471afa921c4962d7138cfcef4942">getHeader</a>());</Highlight></CodeLine>
<Link id="l05517" /><CodeLine lineNumber="5517"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(L &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expecting CanonicalLoopInfo to be recognized as a loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05518" /><CodeLine lineNumber="5518"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05519" /><CodeLine lineNumber="5519"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences">TargetTransformInfo::UnrollingPreferences</a> UP = <a href="/docs/api/namespaces/llvm/#abd642fa74effc122158e6fb11da78600">gatherUnrollingPreferences</a>(</Highlight></CodeLine>
<Link id="l05520" /><CodeLine lineNumber="5520"><Highlight kind="normal">      L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l05521" /><CodeLine lineNumber="5521"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;BlockFrequencyInfo=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05522" /><CodeLine lineNumber="5522"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;ProfileSummaryInfo=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, ORE, </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(OptLevel),</Highlight></CodeLine>
<Link id="l05523" /><CodeLine lineNumber="5523"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;UserThreshold=&#42;/</Highlight><Highlight kind="normal">std::nullopt,</Highlight></CodeLine>
<Link id="l05524" /><CodeLine lineNumber="5524"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;UserCount=&#42;/</Highlight><Highlight kind="normal">std::nullopt,</Highlight></CodeLine>
<Link id="l05525" /><CodeLine lineNumber="5525"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;UserAllowPartial=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05526" /><CodeLine lineNumber="5526"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;UserAllowRuntime=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05527" /><CodeLine lineNumber="5527"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;UserUpperBound=&#42;/</Highlight><Highlight kind="normal">std::nullopt,</Highlight></CodeLine>
<Link id="l05528" /><CodeLine lineNumber="5528"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;UserFullUnrollMaxCount=&#42;/</Highlight><Highlight kind="normal">std::nullopt);</Highlight></CodeLine>
<Link id="l05529" /><CodeLine lineNumber="5529"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05530" /><CodeLine lineNumber="5530"><Highlight kind="normal">  UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#a4217ba2e3d1295f8e9e6b49cef2a8b76">Force</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05531" /><CodeLine lineNumber="5531"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05532" /><CodeLine lineNumber="5532"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Account for additional optimizations taking place before the LoopUnrollPass</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05533" /><CodeLine lineNumber="5533"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// would unroll the loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05534" /><CodeLine lineNumber="5534"><Highlight kind="normal">  UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#a21e7febf468c370793f606da5cd0e6fe">Threshold</a> &#42;= <a href="#a87dfce8f7ae9d7942d55ac782438dbf8">UnrollThresholdFactor</a>;</Highlight></CodeLine>
<Link id="l05535" /><CodeLine lineNumber="5535"><Highlight kind="normal">  UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#ae28e05c1aac288aa7e4a49d858b35c46">PartialThreshold</a> &#42;= <a href="#a87dfce8f7ae9d7942d55ac782438dbf8">UnrollThresholdFactor</a>;</Highlight></CodeLine>
<Link id="l05536" /><CodeLine lineNumber="5536"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05537" /><CodeLine lineNumber="5537"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Use normal unroll factors even if the rest of the code is optimized for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05538" /><CodeLine lineNumber="5538"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// size.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05539" /><CodeLine lineNumber="5539"><Highlight kind="normal">  UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#af9a7105299bd43b8b61c803f26e4a31b">OptSizeThreshold</a> = UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#a21e7febf468c370793f606da5cd0e6fe">Threshold</a>;</Highlight></CodeLine>
<Link id="l05540" /><CodeLine lineNumber="5540"><Highlight kind="normal">  UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#a54b17420c467d2bb9edd2f79e54d2b6f">PartialOptSizeThreshold</a> = UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#ae28e05c1aac288aa7e4a49d858b35c46">PartialThreshold</a>;</Highlight></CodeLine>
<Link id="l05541" /><CodeLine lineNumber="5541"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05542" /><CodeLine lineNumber="5542"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Unroll heuristic thresholds:\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05543" /><CodeLine lineNumber="5543"><Highlight kind="normal">                    &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Threshold=&quot;</Highlight><Highlight kind="normal"> &lt;&lt; UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#a21e7febf468c370793f606da5cd0e6fe">Threshold</a> &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05544" /><CodeLine lineNumber="5544"><Highlight kind="normal">                    &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  PartialThreshold=&quot;</Highlight><Highlight kind="normal"> &lt;&lt; UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#ae28e05c1aac288aa7e4a49d858b35c46">PartialThreshold</a> &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05545" /><CodeLine lineNumber="5545"><Highlight kind="normal">                    &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  OptSizeThreshold=&quot;</Highlight><Highlight kind="normal"> &lt;&lt; UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#af9a7105299bd43b8b61c803f26e4a31b">OptSizeThreshold</a> &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05546" /><CodeLine lineNumber="5546"><Highlight kind="normal">                    &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  PartialOptSizeThreshold=&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05547" /><CodeLine lineNumber="5547"><Highlight kind="normal">                    &lt;&lt; UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#a54b17420c467d2bb9edd2f79e54d2b6f">PartialOptSizeThreshold</a> &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05548" /><CodeLine lineNumber="5548"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05549" /><CodeLine lineNumber="5549"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Disable peeling.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05550" /><CodeLine lineNumber="5550"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/targettransforminfo/peelingpreferences">TargetTransformInfo::PeelingPreferences</a> PP =</Highlight></CodeLine>
<Link id="l05551" /><CodeLine lineNumber="5551"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a6e86d0ac2e968adc60290ca52da02e42">gatherPeelingPreferences</a>(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l05552" /><CodeLine lineNumber="5552"><Highlight kind="normal">                               </Highlight><Highlight kind="comment">/&#42;UserAllowPeeling=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05553" /><CodeLine lineNumber="5553"><Highlight kind="normal">                               </Highlight><Highlight kind="comment">/&#42;UserAllowProfileBasedPeeling=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05554" /><CodeLine lineNumber="5554"><Highlight kind="normal">                               </Highlight><Highlight kind="comment">/&#42;UnrollingSpecficValues=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05555" /><CodeLine lineNumber="5555"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05556" /><CodeLine lineNumber="5556"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const Value &#42;, 32&gt;</a> EphValues;</Highlight></CodeLine>
<Link id="l05557" /><CodeLine lineNumber="5557"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/codemetrics/#a7e174506b52ad46ea1f746a7f727d999">CodeMetrics::collectEphemeralValues</a>(L, &amp;AC, EphValues);</Highlight></CodeLine>
<Link id="l05558" /><CodeLine lineNumber="5558"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05559" /><CodeLine lineNumber="5559"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Assume that reads and writes to stack variables can be eliminated by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05560" /><CodeLine lineNumber="5560"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Mem2Reg, SROA or LICM. That is, don&#39;t count them towards the loop body&#39;s</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05561" /><CodeLine lineNumber="5561"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// size.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05562" /><CodeLine lineNumber="5562"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB : L-&gt;blocks()) &#123;</Highlight></CodeLine>
<Link id="l05563" /><CodeLine lineNumber="5563"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : &#42;BB) &#123;</Highlight></CodeLine>
<Link id="l05564" /><CodeLine lineNumber="5564"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>;</Highlight></CodeLine>
<Link id="l05565" /><CodeLine lineNumber="5565"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Load = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;LoadInst&gt;</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &#123;</Highlight></CodeLine>
<Link id="l05566" /><CodeLine lineNumber="5566"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = Load-&gt;getPointerOperand();</Highlight></CodeLine>
<Link id="l05567" /><CodeLine lineNumber="5567"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Store = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StoreInst&gt;</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &#123;</Highlight></CodeLine>
<Link id="l05568" /><CodeLine lineNumber="5568"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = Store-&gt;getPointerOperand();</Highlight></CodeLine>
<Link id="l05569" /><CodeLine lineNumber="5569"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05570" /><CodeLine lineNumber="5570"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05571" /><CodeLine lineNumber="5571"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05572" /><CodeLine lineNumber="5572"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>-&gt;stripPointerCasts();</Highlight></CodeLine>
<Link id="l05573" /><CodeLine lineNumber="5573"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05574" /><CodeLine lineNumber="5574"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Alloca = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AllocaInst&gt;</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>)) &#123;</Highlight></CodeLine>
<Link id="l05575" /><CodeLine lineNumber="5575"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Alloca-&gt;getParent() == &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getEntryBlock())</Highlight></CodeLine>
<Link id="l05576" /><CodeLine lineNumber="5576"><Highlight kind="normal">          EphValues.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l05577" /><CodeLine lineNumber="5577"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05578" /><CodeLine lineNumber="5578"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05579" /><CodeLine lineNumber="5579"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05580" /><CodeLine lineNumber="5580"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05581" /><CodeLine lineNumber="5581"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/unrollcostestimator">UnrollCostEstimator</a> UCE(L, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, EphValues, UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#acc2a7ecc1c0355035c91448ed850390f">BEInsns</a>);</Highlight></CodeLine>
<Link id="l05582" /><CodeLine lineNumber="5582"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05583" /><CodeLine lineNumber="5583"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Loop is not unrollable if the loop contains certain instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05584" /><CodeLine lineNumber="5584"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!UCE.<a href="/docs/api/classes/llvm/unrollcostestimator/#a8170d7668dde15a0223b899ffc3380e5">canUnroll</a>()) &#123;</Highlight></CodeLine>
<Link id="l05585" /><CodeLine lineNumber="5585"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Loop not considered unrollable\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05586" /><CodeLine lineNumber="5586"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 1;</Highlight></CodeLine>
<Link id="l05587" /><CodeLine lineNumber="5587"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05588" /><CodeLine lineNumber="5588"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05589" /><CodeLine lineNumber="5589"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Estimated loop size is &quot;</Highlight><Highlight kind="normal"> &lt;&lt; UCE.<a href="/docs/api/classes/llvm/unrollcostestimator/#afcdc5884d4a759a519a679fc4293c0e0">getRolledLoopSize</a>()</Highlight></CodeLine>
<Link id="l05590" /><CodeLine lineNumber="5590"><Highlight kind="normal">                    &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05591" /><CodeLine lineNumber="5591"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05592" /><CodeLine lineNumber="5592"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Determine trip count of \\p CLI if constant, computeUnrollCount might</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05593" /><CodeLine lineNumber="5593"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// be able to use it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05594" /><CodeLine lineNumber="5594"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> TripCount = 0;</Highlight></CodeLine>
<Link id="l05595" /><CodeLine lineNumber="5595"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> MaxTripCount = 0;</Highlight></CodeLine>
<Link id="l05596" /><CodeLine lineNumber="5596"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> MaxOrZero = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05597" /><CodeLine lineNumber="5597"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> TripMultiple = 0;</Highlight></CodeLine>
<Link id="l05598" /><CodeLine lineNumber="5598"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05599" /><CodeLine lineNumber="5599"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> UseUpperBound = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05600" /><CodeLine lineNumber="5600"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a921421142b15c9fb9196fc4b0d7b77cb">computeUnrollCount</a>(L, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, DT, &amp;LI, &amp;AC, SE, EphValues, &amp;ORE, TripCount,</Highlight></CodeLine>
<Link id="l05601" /><CodeLine lineNumber="5601"><Highlight kind="normal">                     MaxTripCount, MaxOrZero, TripMultiple, UCE, UP, PP,</Highlight></CodeLine>
<Link id="l05602" /><CodeLine lineNumber="5602"><Highlight kind="normal">                     UseUpperBound);</Highlight></CodeLine>
<Link id="l05603" /><CodeLine lineNumber="5603"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Factor = UP.<a href="/docs/api/structs/llvm/targettransforminfo/unrollingpreferences/#a19cc5df79c699ab1e137118b8c472a9e">Count</a>;</Highlight></CodeLine>
<Link id="l05604" /><CodeLine lineNumber="5604"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Suggesting unroll factor of &quot;</Highlight><Highlight kind="normal"> &lt;&lt; Factor &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05605" /><CodeLine lineNumber="5605"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05606" /><CodeLine lineNumber="5606"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This function returns 1 to signal to not unroll a loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05607" /><CodeLine lineNumber="5607"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Factor == 0)</Highlight></CodeLine>
<Link id="l05608" /><CodeLine lineNumber="5608"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 1;</Highlight></CodeLine>
<Link id="l05609" /><CodeLine lineNumber="5609"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Factor;</Highlight></CodeLine>
<Link id="l05610" /><CodeLine lineNumber="5610"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05611" /><CodeLine lineNumber="5611"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05612" /><CodeLine lineNumber="5612" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a5e2b7ac5f48193117a340aa15b085719"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a5e2b7ac5f48193117a340aa15b085719">OpenMPIRBuilder::unrollLoopPartial</a>(<a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;<a href="/docs/api/classes/llvm/loop">Loop</a>,</Highlight></CodeLine>
<Link id="l05613" /><CodeLine lineNumber="5613"><Highlight kind="normal">                                        int32&#95;t Factor,</Highlight></CodeLine>
<Link id="l05614" /><CodeLine lineNumber="5614"><Highlight kind="normal">                                        <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;&#42;UnrolledCLI) &#123;</Highlight></CodeLine>
<Link id="l05615" /><CodeLine lineNumber="5615"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Factor &gt;= 0 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Unroll factor must not be negative&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05616" /><CodeLine lineNumber="5616"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05617" /><CodeLine lineNumber="5617"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/classes/llvm/loop">Loop</a>-&gt;getFunction();</Highlight></CodeLine>
<Link id="l05618" /><CodeLine lineNumber="5618"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>-&gt;getContext();</Highlight></CodeLine>
<Link id="l05619" /><CodeLine lineNumber="5619"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05620" /><CodeLine lineNumber="5620"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If the unrolled loop is not used for another loop-associated directive, it</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05621" /><CodeLine lineNumber="5621"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// is sufficient to add metadata for the LoopUnrollPass.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05622" /><CodeLine lineNumber="5622"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!UnrolledCLI) &#123;</Highlight></CodeLine>
<Link id="l05623" /><CodeLine lineNumber="5623"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Metadata &#42;, 2&gt;</a> LoopMetadata;</Highlight></CodeLine>
<Link id="l05624" /><CodeLine lineNumber="5624"><Highlight kind="normal">    LoopMetadata.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight></CodeLine>
<Link id="l05625" /><CodeLine lineNumber="5625"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, <a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.unroll.enable&quot;</Highlight><Highlight kind="normal">)));</Highlight></CodeLine>
<Link id="l05626" /><CodeLine lineNumber="5626"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05627" /><CodeLine lineNumber="5627"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Factor &gt;= 1) &#123;</Highlight></CodeLine>
<Link id="l05628" /><CodeLine lineNumber="5628"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constantasmetadata">ConstantAsMetadata</a> &#42;FactorConst = <a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(</Highlight></CodeLine>
<Link id="l05629" /><CodeLine lineNumber="5629"><Highlight kind="normal">          ConstantInt::get(<a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Ctx), <a href="/docs/api/classes/llvm/apint">APInt</a>(32, Factor)));</Highlight></CodeLine>
<Link id="l05630" /><CodeLine lineNumber="5630"><Highlight kind="normal">      LoopMetadata.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(</Highlight></CodeLine>
<Link id="l05631" /><CodeLine lineNumber="5631"><Highlight kind="normal">          Ctx, &#123;<a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.unroll.count&quot;</Highlight><Highlight kind="normal">), FactorConst&#125;));</Highlight></CodeLine>
<Link id="l05632" /><CodeLine lineNumber="5632"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05633" /><CodeLine lineNumber="5633"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05634" /><CodeLine lineNumber="5634"><Highlight kind="normal">    <a href="#adf813540e363817b85e9eecef51269b5">addLoopMetadata</a>(<a href="/docs/api/classes/llvm/loop">Loop</a>, LoopMetadata);</Highlight></CodeLine>
<Link id="l05635" /><CodeLine lineNumber="5635"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05636" /><CodeLine lineNumber="5636"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05637" /><CodeLine lineNumber="5637"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05638" /><CodeLine lineNumber="5638"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Heuristically determine the unroll factor.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05639" /><CodeLine lineNumber="5639"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Factor == 0)</Highlight></CodeLine>
<Link id="l05640" /><CodeLine lineNumber="5640"><Highlight kind="normal">    Factor = <a href="#a946282957319b8c23ab9f169abb504c4">computeHeuristicUnrollFactor</a>(<a href="/docs/api/classes/llvm/loop">Loop</a>);</Highlight></CodeLine>
<Link id="l05641" /><CodeLine lineNumber="5641"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05642" /><CodeLine lineNumber="5642"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// No change required with unroll factor 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05643" /><CodeLine lineNumber="5643"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Factor == 1) &#123;</Highlight></CodeLine>
<Link id="l05644" /><CodeLine lineNumber="5644"><Highlight kind="normal">    &#42;UnrolledCLI = <a href="/docs/api/classes/llvm/loop">Loop</a>;</Highlight></CodeLine>
<Link id="l05645" /><CodeLine lineNumber="5645"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05646" /><CodeLine lineNumber="5646"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05647" /><CodeLine lineNumber="5647"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05648" /><CodeLine lineNumber="5648"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Factor &gt;= 2 &amp;&amp;</Highlight></CodeLine>
<Link id="l05649" /><CodeLine lineNumber="5649"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;unrolling only makes sense with a factor of 2 or larger&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05650" /><CodeLine lineNumber="5650"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05651" /><CodeLine lineNumber="5651"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IndVarTy = <a href="/docs/api/classes/llvm/loop">Loop</a>-&gt;getIndVarType();</Highlight></CodeLine>
<Link id="l05652" /><CodeLine lineNumber="5652"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05653" /><CodeLine lineNumber="5653"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Apply partial unrolling by tiling the loop by the unroll-factor, then fully</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05654" /><CodeLine lineNumber="5654"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// unroll the inner loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05655" /><CodeLine lineNumber="5655"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;FactorVal =</Highlight></CodeLine>
<Link id="l05656" /><CodeLine lineNumber="5656"><Highlight kind="normal">      ConstantInt::get(IndVarTy, <a href="/docs/api/classes/llvm/apint">APInt</a>(IndVarTy-&gt;<a href="/docs/api/classes/llvm/type/#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>(), Factor,</Highlight></CodeLine>
<Link id="l05657" /><CodeLine lineNumber="5657"><Highlight kind="normal">                                       </Highlight><Highlight kind="comment">/&#42;isSigned=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l05658" /><CodeLine lineNumber="5658"><Highlight kind="normal">  std::vector&lt;CanonicalLoopInfo &#42;&gt; <a href="/docs/api/classes/llvm/loopnest">LoopNest</a> =</Highlight></CodeLine>
<Link id="l05659" /><CodeLine lineNumber="5659"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#a76e12ec076e7af4be7b8b77a5d53d3fc">tileLoops</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, &#123;<a href="/docs/api/classes/llvm/loop">Loop</a>&#125;, &#123;FactorVal&#125;);</Highlight></CodeLine>
<Link id="l05660" /><CodeLine lineNumber="5660"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/loopnest">LoopNest</a>.size() == 2 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expect 2 loops after tiling&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05661" /><CodeLine lineNumber="5661"><Highlight kind="normal">  &#42;UnrolledCLI = <a href="/docs/api/classes/llvm/loopnest">LoopNest</a>&#91;0&#93;;</Highlight></CodeLine>
<Link id="l05662" /><CodeLine lineNumber="5662"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo">CanonicalLoopInfo</a> &#42;InnerLoop = <a href="/docs/api/classes/llvm/loopnest">LoopNest</a>&#91;1&#93;;</Highlight></CodeLine>
<Link id="l05663" /><CodeLine lineNumber="5663"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05664" /><CodeLine lineNumber="5664"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// LoopUnrollPass can only fully unroll loops with constant trip count.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05665" /><CodeLine lineNumber="5665"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Unroll by the unroll factor with a fallback epilog for the remainder</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05666" /><CodeLine lineNumber="5666"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// iterations if necessary.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05667" /><CodeLine lineNumber="5667"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constantasmetadata">ConstantAsMetadata</a> &#42;FactorConst = <a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(</Highlight></CodeLine>
<Link id="l05668" /><CodeLine lineNumber="5668"><Highlight kind="normal">      ConstantInt::get(<a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Ctx), <a href="/docs/api/classes/llvm/apint">APInt</a>(32, Factor)));</Highlight></CodeLine>
<Link id="l05669" /><CodeLine lineNumber="5669"><Highlight kind="normal">  <a href="#adf813540e363817b85e9eecef51269b5">addLoopMetadata</a>(</Highlight></CodeLine>
<Link id="l05670" /><CodeLine lineNumber="5670"><Highlight kind="normal">      InnerLoop,</Highlight></CodeLine>
<Link id="l05671" /><CodeLine lineNumber="5671"><Highlight kind="normal">      &#123;<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, <a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.unroll.enable&quot;</Highlight><Highlight kind="normal">)),</Highlight></CodeLine>
<Link id="l05672" /><CodeLine lineNumber="5672"><Highlight kind="normal">       <a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(</Highlight></CodeLine>
<Link id="l05673" /><CodeLine lineNumber="5673"><Highlight kind="normal">           Ctx, &#123;<a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, </Highlight><Highlight kind="stringliteral">&quot;llvm.loop.unroll.count&quot;</Highlight><Highlight kind="normal">), FactorConst&#125;)&#125;);</Highlight></CodeLine>
<Link id="l05674" /><CodeLine lineNumber="5674"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05675" /><CodeLine lineNumber="5675"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05676" /><CodeLine lineNumber="5676"><Highlight kind="normal">  (&#42;UnrolledCLI)-&gt;assertOK();</Highlight></CodeLine>
<Link id="l05677" /><CodeLine lineNumber="5677"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05678" /><CodeLine lineNumber="5678"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05679" /><CodeLine lineNumber="5679"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05680" /><CodeLine lineNumber="5680"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a></Highlight></CodeLine>
<Link id="l05681" /><CodeLine lineNumber="5681"><Highlight kind="normal">OpenMPIRBuilder::createCopyPrivate(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l05682" /><CodeLine lineNumber="5682"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;BufSize, <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;CpyBuf,</Highlight></CodeLine>
<Link id="l05683" /><CodeLine lineNumber="5683"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;CpyFn, <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;DidIt) &#123;</Highlight></CodeLine>
<Link id="l05684" /><CodeLine lineNumber="5684"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l05685" /><CodeLine lineNumber="5685"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP;</Highlight></CodeLine>
<Link id="l05686" /><CodeLine lineNumber="5686"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05687" /><CodeLine lineNumber="5687"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l05688" /><CodeLine lineNumber="5688"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05689" /><CodeLine lineNumber="5689"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05690" /><CodeLine lineNumber="5690"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l05691" /><CodeLine lineNumber="5691"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05692" /><CodeLine lineNumber="5692"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;DidItLD = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), DidIt);</Highlight></CodeLine>
<Link id="l05693" /><CodeLine lineNumber="5693"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05694" /><CodeLine lineNumber="5694"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Args&#91;&#93; = &#123;Ident, ThreadId, BufSize, CpyBuf, CpyFn, DidItLD&#125;;</Highlight></CodeLine>
<Link id="l05695" /><CodeLine lineNumber="5695"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05696" /><CodeLine lineNumber="5696"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;Fn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;copyprivate);</Highlight></CodeLine>
<Link id="l05697" /><CodeLine lineNumber="5697"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, Args);</Highlight></CodeLine>
<Link id="l05698" /><CodeLine lineNumber="5698"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05699" /><CodeLine lineNumber="5699"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l05700" /><CodeLine lineNumber="5700"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05701" /><CodeLine lineNumber="5701"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05702" /><CodeLine lineNumber="5702"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::createSingle(</Highlight></CodeLine>
<Link id="l05703" /><CodeLine lineNumber="5703"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, BodyGenCallbackTy BodyGenCB,</Highlight></CodeLine>
<Link id="l05704" /><CodeLine lineNumber="5704"><Highlight kind="normal">    FinalizeCallbackTy FiniCB, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsNowait, <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;llvm::Value &#42;&gt;</a> CPVars,</Highlight></CodeLine>
<Link id="l05705" /><CodeLine lineNumber="5705"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;llvm::Function &#42;&gt;</a> CPFuncs) &#123;</Highlight></CodeLine>
<Link id="l05706" /><CodeLine lineNumber="5706"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05707" /><CodeLine lineNumber="5707"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l05708" /><CodeLine lineNumber="5708"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l05709" /><CodeLine lineNumber="5709"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05710" /><CodeLine lineNumber="5710"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If needed allocate and initialize &#96;DidIt&#96; with 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05711" /><CodeLine lineNumber="5711"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// DidIt: flag variable: 1=single thread; 0=not single thread.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05712" /><CodeLine lineNumber="5712"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">llvm::Value</a> &#42;DidIt = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05713" /><CodeLine lineNumber="5713"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CPVars.<a href="/docs/api/classes/llvm/arrayref/#ac835b8735b1b2faec0efdca236e37d94">empty</a>()) &#123;</Highlight></CodeLine>
<Link id="l05714" /><CodeLine lineNumber="5714"><Highlight kind="normal">    DidIt = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(<a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">llvm::Type::getInt32Ty</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>()));</Highlight></CodeLine>
<Link id="l05715" /><CodeLine lineNumber="5715"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(0), DidIt);</Highlight></CodeLine>
<Link id="l05716" /><CodeLine lineNumber="5716"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05717" /><CodeLine lineNumber="5717"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05718" /><CodeLine lineNumber="5718"><Highlight kind="normal">  Directive OMPD = Directive::OMPD&#95;single;</Highlight></CodeLine>
<Link id="l05719" /><CodeLine lineNumber="5719"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l05720" /><CodeLine lineNumber="5720"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05721" /><CodeLine lineNumber="5721"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05722" /><CodeLine lineNumber="5722"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l05723" /><CodeLine lineNumber="5723"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;Ident, ThreadId&#125;;</Highlight></CodeLine>
<Link id="l05724" /><CodeLine lineNumber="5724"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05725" /><CodeLine lineNumber="5725"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;EntryRTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;single);</Highlight></CodeLine>
<Link id="l05726" /><CodeLine lineNumber="5726"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;EntryCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(EntryRTLFn, Args);</Highlight></CodeLine>
<Link id="l05727" /><CodeLine lineNumber="5727"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05728" /><CodeLine lineNumber="5728"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ExitRTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;end&#95;single);</Highlight></CodeLine>
<Link id="l05729" /><CodeLine lineNumber="5729"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;ExitCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ExitRTLFn, Args);</Highlight></CodeLine>
<Link id="l05730" /><CodeLine lineNumber="5730"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05731" /><CodeLine lineNumber="5731"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FiniCBWrapper = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> IP) -&gt; <a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> &#123;</Highlight></CodeLine>
<Link id="l05732" /><CodeLine lineNumber="5732"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = FiniCB(IP))</Highlight></CodeLine>
<Link id="l05733" /><CodeLine lineNumber="5733"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l05734" /><CodeLine lineNumber="5734"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05735" /><CodeLine lineNumber="5735"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The thread that executes the single region must set &#96;DidIt&#96; to 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05736" /><CodeLine lineNumber="5736"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This is used by &#95;&#95;kmpc&#95;copyprivate, to know if the caller is the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05737" /><CodeLine lineNumber="5737"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// single thread or not.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05738" /><CodeLine lineNumber="5738"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DidIt)</Highlight></CodeLine>
<Link id="l05739" /><CodeLine lineNumber="5739"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(1), DidIt);</Highlight></CodeLine>
<Link id="l05740" /><CodeLine lineNumber="5740"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05741" /><CodeLine lineNumber="5741"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l05742" /><CodeLine lineNumber="5742"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l05743" /><CodeLine lineNumber="5743"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05744" /><CodeLine lineNumber="5744"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// generates the following:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05745" /><CodeLine lineNumber="5745"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// if (&#95;&#95;kmpc&#95;single()) &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05746" /><CodeLine lineNumber="5746"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    .... single region ...</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05747" /><CodeLine lineNumber="5747"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    &#95;&#95;kmpc&#95;end&#95;single</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05748" /><CodeLine lineNumber="5748"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05749" /><CodeLine lineNumber="5749"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#95;&#95;kmpc&#95;copyprivate</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05750" /><CodeLine lineNumber="5750"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#95;&#95;kmpc&#95;barrier</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05751" /><CodeLine lineNumber="5751"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05752" /><CodeLine lineNumber="5752"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l05753" /><CodeLine lineNumber="5753"><Highlight kind="normal">      EmitOMPInlinedRegion(OMPD, EntryCall, ExitCall, BodyGenCB, FiniCBWrapper,</Highlight></CodeLine>
<Link id="l05754" /><CodeLine lineNumber="5754"><Highlight kind="normal">                           </Highlight><Highlight kind="comment">/&#42;Conditional&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05755" /><CodeLine lineNumber="5755"><Highlight kind="normal">                           </Highlight><Highlight kind="comment">/&#42;hasFinalize&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05756" /><CodeLine lineNumber="5756"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l05757" /><CodeLine lineNumber="5757"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l05758" /><CodeLine lineNumber="5758"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05759" /><CodeLine lineNumber="5759"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DidIt) &#123;</Highlight></CodeLine>
<Link id="l05760" /><CodeLine lineNumber="5760"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = CPVars.<a href="/docs/api/classes/llvm/arrayref/#a85ffb6531d4cda988ea81f18d4e56fb7">size</a>(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</Highlight></CodeLine>
<Link id="l05761" /><CodeLine lineNumber="5761"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// NOTE BufSize is currently unused, so just pass 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05762" /><CodeLine lineNumber="5762"><Highlight kind="normal">      createCopyPrivate(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), Loc.DL),</Highlight></CodeLine>
<Link id="l05763" /><CodeLine lineNumber="5763"><Highlight kind="normal">                        </Highlight><Highlight kind="comment">/&#42;BufSize=&#42;/</Highlight><Highlight kind="normal">ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872ada475947399b8ab4d13d40fea50f950c">Int64</a>, 0), CPVars&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;,</Highlight></CodeLine>
<Link id="l05764" /><CodeLine lineNumber="5764"><Highlight kind="normal">                        CPFuncs&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;, DidIt);</Highlight></CodeLine>
<Link id="l05765" /><CodeLine lineNumber="5765"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// NOTE &#95;&#95;kmpc&#95;copyprivate already inserts a barrier</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05766" /><CodeLine lineNumber="5766"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsNowait) &#123;</Highlight></CodeLine>
<Link id="l05767" /><CodeLine lineNumber="5767"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l05768" /><CodeLine lineNumber="5768"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/openmpirbuilder/#abca6530c9099bd1b1c3e0a5c32381f07">createBarrier</a>(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), Loc.DL),</Highlight></CodeLine>
<Link id="l05769" /><CodeLine lineNumber="5769"><Highlight kind="normal">                      omp::Directive::OMPD&#95;unknown, </Highlight><Highlight kind="comment">/&#42; ForceSimpleCall &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05770" /><CodeLine lineNumber="5770"><Highlight kind="normal">                      </Highlight><Highlight kind="comment">/&#42; CheckCancelFlag &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05771" /><CodeLine lineNumber="5771"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l05772" /><CodeLine lineNumber="5772"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l05773" /><CodeLine lineNumber="5773"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05774" /><CodeLine lineNumber="5774"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l05775" /><CodeLine lineNumber="5775"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05776" /><CodeLine lineNumber="5776"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05777" /><CodeLine lineNumber="5777"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::createCritical(</Highlight></CodeLine>
<Link id="l05778" /><CodeLine lineNumber="5778"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, BodyGenCallbackTy BodyGenCB,</Highlight></CodeLine>
<Link id="l05779" /><CodeLine lineNumber="5779"><Highlight kind="normal">    FinalizeCallbackTy FiniCB, <a href="/docs/api/classes/llvm/stringref">StringRef</a> CriticalName, <a href="/docs/api/classes/llvm/value">Value</a> &#42;HintInst) &#123;</Highlight></CodeLine>
<Link id="l05780" /><CodeLine lineNumber="5780"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05781" /><CodeLine lineNumber="5781"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l05782" /><CodeLine lineNumber="5782"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l05783" /><CodeLine lineNumber="5783"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05784" /><CodeLine lineNumber="5784"><Highlight kind="normal">  Directive OMPD = Directive::OMPD&#95;critical;</Highlight></CodeLine>
<Link id="l05785" /><CodeLine lineNumber="5785"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l05786" /><CodeLine lineNumber="5786"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05787" /><CodeLine lineNumber="5787"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05788" /><CodeLine lineNumber="5788"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l05789" /><CodeLine lineNumber="5789"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LockVar = getOMPCriticalRegionLock(CriticalName);</Highlight></CodeLine>
<Link id="l05790" /><CodeLine lineNumber="5790"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;Ident, ThreadId, LockVar&#125;;</Highlight></CodeLine>
<Link id="l05791" /><CodeLine lineNumber="5791"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05792" /><CodeLine lineNumber="5792"><Highlight kind="normal">  SmallVector&lt;llvm::Value &#42;, 4&gt; EnterArgs(std::begin(Args), std::end(Args));</Highlight></CodeLine>
<Link id="l05793" /><CodeLine lineNumber="5793"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;RTFn = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05794" /><CodeLine lineNumber="5794"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HintInst) &#123;</Highlight></CodeLine>
<Link id="l05795" /><CodeLine lineNumber="5795"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add Hint to entry Args and create call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05796" /><CodeLine lineNumber="5796"><Highlight kind="normal">    EnterArgs.push&#95;back(HintInst);</Highlight></CodeLine>
<Link id="l05797" /><CodeLine lineNumber="5797"><Highlight kind="normal">    RTFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;critical&#95;with&#95;hint);</Highlight></CodeLine>
<Link id="l05798" /><CodeLine lineNumber="5798"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05799" /><CodeLine lineNumber="5799"><Highlight kind="normal">    RTFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;critical);</Highlight></CodeLine>
<Link id="l05800" /><CodeLine lineNumber="5800"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05801" /><CodeLine lineNumber="5801"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;EntryCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(RTFn, EnterArgs);</Highlight></CodeLine>
<Link id="l05802" /><CodeLine lineNumber="5802"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05803" /><CodeLine lineNumber="5803"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ExitRTLFn =</Highlight></CodeLine>
<Link id="l05804" /><CodeLine lineNumber="5804"><Highlight kind="normal">      getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;end&#95;critical);</Highlight></CodeLine>
<Link id="l05805" /><CodeLine lineNumber="5805"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;ExitCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ExitRTLFn, Args);</Highlight></CodeLine>
<Link id="l05806" /><CodeLine lineNumber="5806"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05807" /><CodeLine lineNumber="5807"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EmitOMPInlinedRegion(OMPD, EntryCall, ExitCall, BodyGenCB, FiniCB,</Highlight></CodeLine>
<Link id="l05808" /><CodeLine lineNumber="5808"><Highlight kind="normal">                              </Highlight><Highlight kind="comment">/&#42;Conditional&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;hasFinalize&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05809" /><CodeLine lineNumber="5809"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05810" /><CodeLine lineNumber="5810"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05811" /><CodeLine lineNumber="5811"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a></Highlight></CodeLine>
<Link id="l05812" /><CodeLine lineNumber="5812"><Highlight kind="normal">OpenMPIRBuilder::createOrderedDepend(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l05813" /><CodeLine lineNumber="5813"><Highlight kind="normal">                                     InsertPointTy AllocaIP, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumLoops,</Highlight></CodeLine>
<Link id="l05814" /><CodeLine lineNumber="5814"><Highlight kind="normal">                                     <a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;llvm::Value &#42;&gt;</a> StoreValues,</Highlight></CodeLine>
<Link id="l05815" /><CodeLine lineNumber="5815"><Highlight kind="normal">                                     </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">Twine</a> &amp;Name, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsDependSource) &#123;</Highlight></CodeLine>
<Link id="l05816" /><CodeLine lineNumber="5816"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</Highlight></CodeLine>
<Link id="l05817" /><CodeLine lineNumber="5817"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all&#95;of</a>(StoreValues,</Highlight></CodeLine>
<Link id="l05818" /><CodeLine lineNumber="5818"><Highlight kind="normal">                   &#91;&#93;(<a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SV) &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>(64); &#125;) &amp;&amp;</Highlight></CodeLine>
<Link id="l05819" /><CodeLine lineNumber="5819"><Highlight kind="normal">      </Highlight><Highlight kind="stringliteral">&quot;OpenMP runtime requires depend vec with i64 type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05820" /><CodeLine lineNumber="5820"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05821" /><CodeLine lineNumber="5821"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l05822" /><CodeLine lineNumber="5822"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l05823" /><CodeLine lineNumber="5823"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05824" /><CodeLine lineNumber="5824"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Allocate space for vector and generate alloc instruction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05825" /><CodeLine lineNumber="5825"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArrI64Ty = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872ada475947399b8ab4d13d40fea50f950c">Int64</a>, NumLoops);</Highlight></CodeLine>
<Link id="l05826" /><CodeLine lineNumber="5826"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l05827" /><CodeLine lineNumber="5827"><Highlight kind="normal">  AllocaInst &#42;ArgsBase = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(ArrI64Ty, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, Name);</Highlight></CodeLine>
<Link id="l05828" /><CodeLine lineNumber="5828"><Highlight kind="normal">  ArgsBase-&gt;<a href="/docs/api/classes/llvm/allocainst/#af3bb24b322533dbe8a63c84b18568fe1">setAlignment</a>(<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/arg/key/#a6b334a5f83504ebc99cc59f4f333ff98">Align</a>(8));</Highlight></CodeLine>
<Link id="l05829" /><CodeLine lineNumber="5829"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(Loc.IP);</Highlight></CodeLine>
<Link id="l05830" /><CodeLine lineNumber="5830"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05831" /><CodeLine lineNumber="5831"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Store the index value with offset in depend vector.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05832" /><CodeLine lineNumber="5832"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumLoops; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l05833" /><CodeLine lineNumber="5833"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DependAddrGEPIter = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l05834" /><CodeLine lineNumber="5834"><Highlight kind="normal">        ArrI64Ty, ArgsBase, &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(0), Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)&#125;);</Highlight></CodeLine>
<Link id="l05835" /><CodeLine lineNumber="5835"><Highlight kind="normal">    StoreInst &#42;STInst = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(StoreValues&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;, DependAddrGEPIter);</Highlight></CodeLine>
<Link id="l05836" /><CodeLine lineNumber="5836"><Highlight kind="normal">    STInst-&gt;<a href="/docs/api/classes/llvm/storeinst/#a55195fa18cf783fe74de0cced1ca6eb3">setAlignment</a>(<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/arg/key/#a6b334a5f83504ebc99cc59f4f333ff98">Align</a>(8));</Highlight></CodeLine>
<Link id="l05837" /><CodeLine lineNumber="5837"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05838" /><CodeLine lineNumber="5838"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05839" /><CodeLine lineNumber="5839"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DependBaseAddrGEP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l05840" /><CodeLine lineNumber="5840"><Highlight kind="normal">      ArrI64Ty, ArgsBase, &#123;Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(0), Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(0)&#125;);</Highlight></CodeLine>
<Link id="l05841" /><CodeLine lineNumber="5841"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05842" /><CodeLine lineNumber="5842"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l05843" /><CodeLine lineNumber="5843"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05844" /><CodeLine lineNumber="5844"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05845" /><CodeLine lineNumber="5845"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l05846" /><CodeLine lineNumber="5846"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;Ident, ThreadId, DependBaseAddrGEP&#125;;</Highlight></CodeLine>
<Link id="l05847" /><CodeLine lineNumber="5847"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05848" /><CodeLine lineNumber="5848"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;RTLFn = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05849" /><CodeLine lineNumber="5849"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsDependSource)</Highlight></CodeLine>
<Link id="l05850" /><CodeLine lineNumber="5850"><Highlight kind="normal">    RTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;doacross&#95;post);</Highlight></CodeLine>
<Link id="l05851" /><CodeLine lineNumber="5851"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05852" /><CodeLine lineNumber="5852"><Highlight kind="normal">    RTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;doacross&#95;wait);</Highlight></CodeLine>
<Link id="l05853" /><CodeLine lineNumber="5853"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(RTLFn, Args);</Highlight></CodeLine>
<Link id="l05854" /><CodeLine lineNumber="5854"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05855" /><CodeLine lineNumber="5855"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l05856" /><CodeLine lineNumber="5856"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05857" /><CodeLine lineNumber="5857"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05858" /><CodeLine lineNumber="5858"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::createOrderedThreadsSimd(</Highlight></CodeLine>
<Link id="l05859" /><CodeLine lineNumber="5859"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, BodyGenCallbackTy BodyGenCB,</Highlight></CodeLine>
<Link id="l05860" /><CodeLine lineNumber="5860"><Highlight kind="normal">    FinalizeCallbackTy FiniCB, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsThreads) &#123;</Highlight></CodeLine>
<Link id="l05861" /><CodeLine lineNumber="5861"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l05862" /><CodeLine lineNumber="5862"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l05863" /><CodeLine lineNumber="5863"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05864" /><CodeLine lineNumber="5864"><Highlight kind="normal">  Directive OMPD = Directive::OMPD&#95;ordered;</Highlight></CodeLine>
<Link id="l05865" /><CodeLine lineNumber="5865"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;EntryCall = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05866" /><CodeLine lineNumber="5866"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;ExitCall = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05867" /><CodeLine lineNumber="5867"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05868" /><CodeLine lineNumber="5868"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsThreads) &#123;</Highlight></CodeLine>
<Link id="l05869" /><CodeLine lineNumber="5869"><Highlight kind="normal">    uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l05870" /><CodeLine lineNumber="5870"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05871" /><CodeLine lineNumber="5871"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l05872" /><CodeLine lineNumber="5872"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l05873" /><CodeLine lineNumber="5873"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;Ident, ThreadId&#125;;</Highlight></CodeLine>
<Link id="l05874" /><CodeLine lineNumber="5874"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05875" /><CodeLine lineNumber="5875"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;EntryRTLFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;ordered);</Highlight></CodeLine>
<Link id="l05876" /><CodeLine lineNumber="5876"><Highlight kind="normal">    EntryCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(EntryRTLFn, Args);</Highlight></CodeLine>
<Link id="l05877" /><CodeLine lineNumber="5877"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05878" /><CodeLine lineNumber="5878"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ExitRTLFn =</Highlight></CodeLine>
<Link id="l05879" /><CodeLine lineNumber="5879"><Highlight kind="normal">        getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;end&#95;ordered);</Highlight></CodeLine>
<Link id="l05880" /><CodeLine lineNumber="5880"><Highlight kind="normal">    ExitCall = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ExitRTLFn, Args);</Highlight></CodeLine>
<Link id="l05881" /><CodeLine lineNumber="5881"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05882" /><CodeLine lineNumber="5882"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05883" /><CodeLine lineNumber="5883"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EmitOMPInlinedRegion(OMPD, EntryCall, ExitCall, BodyGenCB, FiniCB,</Highlight></CodeLine>
<Link id="l05884" /><CodeLine lineNumber="5884"><Highlight kind="normal">                              </Highlight><Highlight kind="comment">/&#42;Conditional&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;hasFinalize&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05885" /><CodeLine lineNumber="5885"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05886" /><CodeLine lineNumber="5886"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05887" /><CodeLine lineNumber="5887"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::EmitOMPInlinedRegion(</Highlight></CodeLine>
<Link id="l05888" /><CodeLine lineNumber="5888"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/directive">Directive</a> OMPD, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;EntryCall, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;ExitCall,</Highlight></CodeLine>
<Link id="l05889" /><CodeLine lineNumber="5889"><Highlight kind="normal">    BodyGenCallbackTy BodyGenCB, FinalizeCallbackTy FiniCB, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Conditional,</Highlight></CodeLine>
<Link id="l05890" /><CodeLine lineNumber="5890"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasFinalize, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsCancellable) &#123;</Highlight></CodeLine>
<Link id="l05891" /><CodeLine lineNumber="5891"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05892" /><CodeLine lineNumber="5892"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasFinalize)</Highlight></CodeLine>
<Link id="l05893" /><CodeLine lineNumber="5893"><Highlight kind="normal">    FinalizationStack.push&#95;back(&#123;FiniCB, OMPD, IsCancellable&#125;);</Highlight></CodeLine>
<Link id="l05894" /><CodeLine lineNumber="5894"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05895" /><CodeLine lineNumber="5895"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create inlined region&#39;s entry and body blocks, in preparation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05896" /><CodeLine lineNumber="5896"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// for conditional creation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05897" /><CodeLine lineNumber="5897"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l05898" /><CodeLine lineNumber="5898"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;SplitPos = EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l05899" /><CodeLine lineNumber="5899"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a4956305191cdba7f9995569d011a5ab7">isa&#95;and&#95;nonnull&lt;BranchInst&gt;</a>(SplitPos))</Highlight></CodeLine>
<Link id="l05900" /><CodeLine lineNumber="5900"><Highlight kind="normal">    SplitPos = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> UnreachableInst(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>(), EntryBB);</Highlight></CodeLine>
<Link id="l05901" /><CodeLine lineNumber="5901"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ExitBB = EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(SplitPos, </Highlight><Highlight kind="stringliteral">&quot;omp&#95;region.end&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05902" /><CodeLine lineNumber="5902"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;FiniBB =</Highlight></CodeLine>
<Link id="l05903" /><CodeLine lineNumber="5903"><Highlight kind="normal">      EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;region.finalize&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05904" /><CodeLine lineNumber="5904"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05905" /><CodeLine lineNumber="5905"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l05906" /><CodeLine lineNumber="5906"><Highlight kind="normal">  emitCommonDirectiveEntry(OMPD, EntryCall, ExitBB, Conditional);</Highlight></CodeLine>
<Link id="l05907" /><CodeLine lineNumber="5907"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05908" /><CodeLine lineNumber="5908"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// generate body</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05909" /><CodeLine lineNumber="5909"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = BodyGenCB(</Highlight><Highlight kind="comment">/&#42; AllocaIP &#42;/</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(),</Highlight></CodeLine>
<Link id="l05910" /><CodeLine lineNumber="5910"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42; CodeGenIP &#42;/</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()))</Highlight></CodeLine>
<Link id="l05911" /><CodeLine lineNumber="5911"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l05912" /><CodeLine lineNumber="5912"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05913" /><CodeLine lineNumber="5913"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// emit exit call and do any needed finalization.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05914" /><CodeLine lineNumber="5914"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FinIP = <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(FiniBB, FiniBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l05915" /><CodeLine lineNumber="5915"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FiniBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l05916" /><CodeLine lineNumber="5916"><Highlight kind="normal">         FiniBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a6e5d2e18c81baaeec7dadc81a0dea993">getSuccessor</a>(0) == ExitBB &amp;&amp;</Highlight></CodeLine>
<Link id="l05917" /><CodeLine lineNumber="5917"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Unexpected control flow graph state!!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05918" /><CodeLine lineNumber="5918"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l05919" /><CodeLine lineNumber="5919"><Highlight kind="normal">      emitCommonDirectiveExit(OMPD, FinIP, ExitCall, HasFinalize);</Highlight></CodeLine>
<Link id="l05920" /><CodeLine lineNumber="5920"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l05921" /><CodeLine lineNumber="5921"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l05922" /><CodeLine lineNumber="5922"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(FiniBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a74aa9daea070e2ad3394a3ec58b7316a">getUniquePredecessor</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a57f1945911ca1e95d0f51d7c3516b529">getUniqueSuccessor</a>() == FiniBB &amp;&amp;</Highlight></CodeLine>
<Link id="l05923" /><CodeLine lineNumber="5923"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Unexpected Control Flow State!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05924" /><CodeLine lineNumber="5924"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#aa76a2cf19b821f320ab439d5659ef4b9">MergeBlockIntoPredecessor</a>(FiniBB);</Highlight></CodeLine>
<Link id="l05925" /><CodeLine lineNumber="5925"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05926" /><CodeLine lineNumber="5926"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we are skipping the region of a non conditional, remove the exit</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05927" /><CodeLine lineNumber="5927"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// block, and clear the builder&#39;s insertion point.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05928" /><CodeLine lineNumber="5928"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SplitPos-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() == ExitBB &amp;&amp;</Highlight></CodeLine>
<Link id="l05929" /><CodeLine lineNumber="5929"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Unexpected Insertion point location!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05930" /><CodeLine lineNumber="5930"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> merged = <a href="/docs/api/namespaces/llvm/#aa76a2cf19b821f320ab439d5659ef4b9">MergeBlockIntoPredecessor</a>(ExitBB);</Highlight></CodeLine>
<Link id="l05931" /><CodeLine lineNumber="5931"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ExitPredBB = SplitPos-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>();</Highlight></CodeLine>
<Link id="l05932" /><CodeLine lineNumber="5932"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> InsertBB = merged ? ExitPredBB : ExitBB;</Highlight></CodeLine>
<Link id="l05933" /><CodeLine lineNumber="5933"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a4956305191cdba7f9995569d011a5ab7">isa&#95;and&#95;nonnull&lt;BranchInst&gt;</a>(SplitPos))</Highlight></CodeLine>
<Link id="l05934" /><CodeLine lineNumber="5934"><Highlight kind="normal">    SplitPos-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l05935" /><CodeLine lineNumber="5935"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(InsertBB);</Highlight></CodeLine>
<Link id="l05936" /><CodeLine lineNumber="5936"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05937" /><CodeLine lineNumber="5937"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l05938" /><CodeLine lineNumber="5938"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05939" /><CodeLine lineNumber="5939"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05940" /><CodeLine lineNumber="5940"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OpenMPIRBuilder::emitCommonDirectiveEntry(</Highlight></CodeLine>
<Link id="l05941" /><CodeLine lineNumber="5941"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/directive">Directive</a> OMPD, <a href="/docs/api/classes/llvm/value">Value</a> &#42;EntryCall, <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ExitBB, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Conditional) &#123;</Highlight></CodeLine>
<Link id="l05942" /><CodeLine lineNumber="5942"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// if nothing to do, Return current insertion point.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05943" /><CodeLine lineNumber="5943"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Conditional || !EntryCall)</Highlight></CodeLine>
<Link id="l05944" /><CodeLine lineNumber="5944"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l05945" /><CodeLine lineNumber="5945"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05946" /><CodeLine lineNumber="5946"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l05947" /><CodeLine lineNumber="5947"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CallBool = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aafd864f39fd28e235eea03ae424ab8e0">CreateIsNotNull</a>(EntryCall);</Highlight></CodeLine>
<Link id="l05948" /><CodeLine lineNumber="5948"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ThenBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;region.body&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05949" /><CodeLine lineNumber="5949"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;UI = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> UnreachableInst(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>(), ThenBB);</Highlight></CodeLine>
<Link id="l05950" /><CodeLine lineNumber="5950"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05951" /><CodeLine lineNumber="5951"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit thenBB and set the Builder&#39;s insertion point there for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05952" /><CodeLine lineNumber="5952"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// body generation next. Place the block after the current block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05953" /><CodeLine lineNumber="5953"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;CurFn = EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l05954" /><CodeLine lineNumber="5954"><Highlight kind="normal">  CurFn-&gt;<a href="/docs/api/classes/llvm/function/#aaab8110aafc070c83bc701b13d2260df">insert</a>(std::next(EntryBB-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>()), ThenBB);</Highlight></CodeLine>
<Link id="l05955" /><CodeLine lineNumber="5955"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05956" /><CodeLine lineNumber="5956"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Move Entry branch to end of ThenBB, and replace with conditional</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05957" /><CodeLine lineNumber="5957"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// branch (If-stmt)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05958" /><CodeLine lineNumber="5958"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;EntryBBTI = EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l05959" /><CodeLine lineNumber="5959"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(CallBool, ThenBB, ExitBB);</Highlight></CodeLine>
<Link id="l05960" /><CodeLine lineNumber="5960"><Highlight kind="normal">  EntryBBTI-&gt;<a href="/docs/api/classes/llvm/instruction/#a0fd53f63d349dc8a7c5fc0cdd7a94c8d">removeFromParent</a>();</Highlight></CodeLine>
<Link id="l05961" /><CodeLine lineNumber="5961"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(UI);</Highlight></CodeLine>
<Link id="l05962" /><CodeLine lineNumber="5962"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8ef25defccf4817608a13e7a9db4000d">Insert</a>(EntryBBTI);</Highlight></CodeLine>
<Link id="l05963" /><CodeLine lineNumber="5963"><Highlight kind="normal">  UI-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l05964" /><CodeLine lineNumber="5964"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ThenBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l05965" /><CodeLine lineNumber="5965"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05966" /><CodeLine lineNumber="5966"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// return an insertion point to ExitBB.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05967" /><CodeLine lineNumber="5967"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IRBuilder&lt;&gt;::InsertPoint(ExitBB, ExitBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l05968" /><CodeLine lineNumber="5968"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05969" /><CodeLine lineNumber="5969"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05970" /><CodeLine lineNumber="5970"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::emitCommonDirectiveExit(</Highlight></CodeLine>
<Link id="l05971" /><CodeLine lineNumber="5971"><Highlight kind="normal">    omp::Directive OMPD, InsertPointTy FinIP, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;ExitCall,</Highlight></CodeLine>
<Link id="l05972" /><CodeLine lineNumber="5972"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasFinalize) &#123;</Highlight></CodeLine>
<Link id="l05973" /><CodeLine lineNumber="5973"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05974" /><CodeLine lineNumber="5974"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(FinIP);</Highlight></CodeLine>
<Link id="l05975" /><CodeLine lineNumber="5975"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05976" /><CodeLine lineNumber="5976"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there is finalization to do, emit it before the exit call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05977" /><CodeLine lineNumber="5977"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasFinalize) &#123;</Highlight></CodeLine>
<Link id="l05978" /><CodeLine lineNumber="5978"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!FinalizationStack.empty() &amp;&amp;</Highlight></CodeLine>
<Link id="l05979" /><CodeLine lineNumber="5979"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Unexpected finalization stack state!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05980" /><CodeLine lineNumber="5980"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05981" /><CodeLine lineNumber="5981"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/openmpirbuilder/finalizationinfo">FinalizationInfo</a> Fi = FinalizationStack.pop&#95;back&#95;val();</Highlight></CodeLine>
<Link id="l05982" /><CodeLine lineNumber="5982"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Fi.DK == OMPD &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Unexpected Directive for Finalization call!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05983" /><CodeLine lineNumber="5983"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05984" /><CodeLine lineNumber="5984"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = Fi.FiniCB(FinIP))</Highlight></CodeLine>
<Link id="l05985" /><CodeLine lineNumber="5985"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l05986" /><CodeLine lineNumber="5986"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05987" /><CodeLine lineNumber="5987"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;FiniBB = FinIP.getBlock();</Highlight></CodeLine>
<Link id="l05988" /><CodeLine lineNumber="5988"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;FiniBBTI = FiniBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l05989" /><CodeLine lineNumber="5989"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05990" /><CodeLine lineNumber="5990"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// set Builder IP for call creation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05991" /><CodeLine lineNumber="5991"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(FiniBBTI);</Highlight></CodeLine>
<Link id="l05992" /><CodeLine lineNumber="5992"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05993" /><CodeLine lineNumber="5993"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05994" /><CodeLine lineNumber="5994"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!ExitCall)</Highlight></CodeLine>
<Link id="l05995" /><CodeLine lineNumber="5995"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l05996" /><CodeLine lineNumber="5996"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05997" /><CodeLine lineNumber="5997"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// place the Exitcall as last instruction before Finalization block terminator</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05998" /><CodeLine lineNumber="5998"><Highlight kind="normal">  ExitCall-&gt;<a href="/docs/api/classes/llvm/instruction/#a0fd53f63d349dc8a7c5fc0cdd7a94c8d">removeFromParent</a>();</Highlight></CodeLine>
<Link id="l05999" /><CodeLine lineNumber="5999"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8ef25defccf4817608a13e7a9db4000d">Insert</a>(ExitCall);</Highlight></CodeLine>
<Link id="l06000" /><CodeLine lineNumber="6000"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06001" /><CodeLine lineNumber="6001"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IRBuilder&lt;&gt;::InsertPoint(ExitCall-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>(),</Highlight></CodeLine>
<Link id="l06002" /><CodeLine lineNumber="6002"><Highlight kind="normal">                                  ExitCall-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l06003" /><CodeLine lineNumber="6003"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06004" /><CodeLine lineNumber="6004"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06005" /><CodeLine lineNumber="6005"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OpenMPIRBuilder::createCopyinClauseBlocks(</Highlight></CodeLine>
<Link id="l06006" /><CodeLine lineNumber="6006"><Highlight kind="normal">    InsertPointTy IP, <a href="/docs/api/classes/llvm/value">Value</a> &#42;MasterAddr, <a href="/docs/api/classes/llvm/value">Value</a> &#42;PrivateAddr,</Highlight></CodeLine>
<Link id="l06007" /><CodeLine lineNumber="6007"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/integertype">llvm::IntegerType</a> &#42;IntPtrTy, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> BranchtoEnd) &#123;</Highlight></CodeLine>
<Link id="l06008" /><CodeLine lineNumber="6008"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IP.isSet())</Highlight></CodeLine>
<Link id="l06009" /><CodeLine lineNumber="6009"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IP;</Highlight></CodeLine>
<Link id="l06010" /><CodeLine lineNumber="6010"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06011" /><CodeLine lineNumber="6011"><Highlight kind="normal">  IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l06012" /><CodeLine lineNumber="6012"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06013" /><CodeLine lineNumber="6013"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// creates the following CFG structure</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06014" /><CodeLine lineNumber="6014"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     OMP&#95;Entry : (MasterAddr != PrivateAddr)?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06015" /><CodeLine lineNumber="6015"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       F     T</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06016" /><CodeLine lineNumber="6016"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       |      \\</Highlight></CodeLine>
<Link id="l06017" /><CodeLine lineNumber="6017"><Highlight kind="comment">  //       |     copin.not.master</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06018" /><CodeLine lineNumber="6018"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       |      /</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06019" /><CodeLine lineNumber="6019"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       v     /</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06020" /><CodeLine lineNumber="6020"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   copyin.not.master.end</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06021" /><CodeLine lineNumber="6021"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//         |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06022" /><CodeLine lineNumber="6022"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//         v</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06023" /><CodeLine lineNumber="6023"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   OMP.Entry.Next</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06024" /><CodeLine lineNumber="6024"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06025" /><CodeLine lineNumber="6025"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;OMP&#95;Entry = IP.getBlock();</Highlight></CodeLine>
<Link id="l06026" /><CodeLine lineNumber="6026"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;CurFn = OMP&#95;Entry-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l06027" /><CodeLine lineNumber="6027"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CopyBegin =</Highlight></CodeLine>
<Link id="l06028" /><CodeLine lineNumber="6028"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;copyin.not.master&quot;</Highlight><Highlight kind="normal">, CurFn);</Highlight></CodeLine>
<Link id="l06029" /><CodeLine lineNumber="6029"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CopyEnd = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06030" /><CodeLine lineNumber="6030"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06031" /><CodeLine lineNumber="6031"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If entry block is terminated, split to preserve the branch to following</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06032" /><CodeLine lineNumber="6032"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// basic block (i.e. OMP.Entry.Next), otherwise, leave everything as is.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06033" /><CodeLine lineNumber="6033"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a4956305191cdba7f9995569d011a5ab7">isa&#95;and&#95;nonnull&lt;BranchInst&gt;</a>(OMP&#95;Entry-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>())) &#123;</Highlight></CodeLine>
<Link id="l06034" /><CodeLine lineNumber="6034"><Highlight kind="normal">    CopyEnd = OMP&#95;Entry-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(OMP&#95;Entry-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>(),</Highlight></CodeLine>
<Link id="l06035" /><CodeLine lineNumber="6035"><Highlight kind="normal">                                         </Highlight><Highlight kind="stringliteral">&quot;copyin.not.master.end&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06036" /><CodeLine lineNumber="6036"><Highlight kind="normal">    OMP&#95;Entry-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l06037" /><CodeLine lineNumber="6037"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06038" /><CodeLine lineNumber="6038"><Highlight kind="normal">    CopyEnd =</Highlight></CodeLine>
<Link id="l06039" /><CodeLine lineNumber="6039"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;copyin.not.master.end&quot;</Highlight><Highlight kind="normal">, CurFn);</Highlight></CodeLine>
<Link id="l06040" /><CodeLine lineNumber="6040"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06041" /><CodeLine lineNumber="6041"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06042" /><CodeLine lineNumber="6042"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(OMP&#95;Entry);</Highlight></CodeLine>
<Link id="l06043" /><CodeLine lineNumber="6043"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MasterPtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aae2c1bf70058f3665edaec525457030c">CreatePtrToInt</a>(MasterAddr, IntPtrTy);</Highlight></CodeLine>
<Link id="l06044" /><CodeLine lineNumber="6044"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PrivatePtr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aae2c1bf70058f3665edaec525457030c">CreatePtrToInt</a>(PrivateAddr, IntPtrTy);</Highlight></CodeLine>
<Link id="l06045" /><CodeLine lineNumber="6045"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;cmp = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a6ef1729b04a4fbd6c6f27787cdd0e813">CreateICmpNE</a>(MasterPtr, PrivatePtr);</Highlight></CodeLine>
<Link id="l06046" /><CodeLine lineNumber="6046"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(cmp, CopyBegin, CopyEnd);</Highlight></CodeLine>
<Link id="l06047" /><CodeLine lineNumber="6047"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06048" /><CodeLine lineNumber="6048"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CopyBegin);</Highlight></CodeLine>
<Link id="l06049" /><CodeLine lineNumber="6049"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BranchtoEnd)</Highlight></CodeLine>
<Link id="l06050" /><CodeLine lineNumber="6050"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(CopyEnd));</Highlight></CodeLine>
<Link id="l06051" /><CodeLine lineNumber="6051"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06052" /><CodeLine lineNumber="6052"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l06053" /><CodeLine lineNumber="6053"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06054" /><CodeLine lineNumber="6054"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06055" /><CodeLine lineNumber="6055"><Highlight kind="normal"><a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;OpenMPIRBuilder::createOMPAlloc(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l06056" /><CodeLine lineNumber="6056"><Highlight kind="normal">                                          <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>,</Highlight></CodeLine>
<Link id="l06057" /><CodeLine lineNumber="6057"><Highlight kind="normal">                                          std::string Name) &#123;</Highlight></CodeLine>
<Link id="l06058" /><CodeLine lineNumber="6058"><Highlight kind="normal">  IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l06059" /><CodeLine lineNumber="6059"><Highlight kind="normal">  updateToLocation(Loc);</Highlight></CodeLine>
<Link id="l06060" /><CodeLine lineNumber="6060"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06061" /><CodeLine lineNumber="6061"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06062" /><CodeLine lineNumber="6062"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06063" /><CodeLine lineNumber="6063"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06064" /><CodeLine lineNumber="6064"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l06065" /><CodeLine lineNumber="6065"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;ThreadId, <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>&#125;;</Highlight></CodeLine>
<Link id="l06066" /><CodeLine lineNumber="6066"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06067" /><CodeLine lineNumber="6067"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;alloc);</Highlight></CodeLine>
<Link id="l06068" /><CodeLine lineNumber="6068"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06069" /><CodeLine lineNumber="6069"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, Args, Name);</Highlight></CodeLine>
<Link id="l06070" /><CodeLine lineNumber="6070"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06071" /><CodeLine lineNumber="6071"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06072" /><CodeLine lineNumber="6072"><Highlight kind="normal"><a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;OpenMPIRBuilder::createOMPFree(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l06073" /><CodeLine lineNumber="6073"><Highlight kind="normal">                                         <a href="/docs/api/classes/llvm/value">Value</a> &#42;Addr, <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>,</Highlight></CodeLine>
<Link id="l06074" /><CodeLine lineNumber="6074"><Highlight kind="normal">                                         std::string Name) &#123;</Highlight></CodeLine>
<Link id="l06075" /><CodeLine lineNumber="6075"><Highlight kind="normal">  IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l06076" /><CodeLine lineNumber="6076"><Highlight kind="normal">  updateToLocation(Loc);</Highlight></CodeLine>
<Link id="l06077" /><CodeLine lineNumber="6077"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06078" /><CodeLine lineNumber="6078"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06079" /><CodeLine lineNumber="6079"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06080" /><CodeLine lineNumber="6080"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06081" /><CodeLine lineNumber="6081"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l06082" /><CodeLine lineNumber="6082"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;ThreadId, Addr, <a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>&#125;;</Highlight></CodeLine>
<Link id="l06083" /><CodeLine lineNumber="6083"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;free);</Highlight></CodeLine>
<Link id="l06084" /><CodeLine lineNumber="6084"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, Args, Name);</Highlight></CodeLine>
<Link id="l06085" /><CodeLine lineNumber="6085"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06086" /><CodeLine lineNumber="6086"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06087" /><CodeLine lineNumber="6087"><Highlight kind="normal"><a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;OpenMPIRBuilder::createOMPInteropInit(</Highlight></CodeLine>
<Link id="l06088" /><CodeLine lineNumber="6088"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;InteropVar,</Highlight></CodeLine>
<Link id="l06089" /><CodeLine lineNumber="6089"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#afeaad9a7fc12d9246c2e42578fddc718">omp::OMPInteropType</a> InteropType, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Device, <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumDependences,</Highlight></CodeLine>
<Link id="l06090" /><CodeLine lineNumber="6090"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;DependenceAddress, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HaveNowaitClause) &#123;</Highlight></CodeLine>
<Link id="l06091" /><CodeLine lineNumber="6091"><Highlight kind="normal">  IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l06092" /><CodeLine lineNumber="6092"><Highlight kind="normal">  updateToLocation(Loc);</Highlight></CodeLine>
<Link id="l06093" /><CodeLine lineNumber="6093"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06094" /><CodeLine lineNumber="6094"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06095" /><CodeLine lineNumber="6095"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06096" /><CodeLine lineNumber="6096"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06097" /><CodeLine lineNumber="6097"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l06098" /><CodeLine lineNumber="6098"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Device == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l06099" /><CodeLine lineNumber="6099"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/nvptx/#abd325b49b8e2f00c0370b1c68cf51557a67abb9e8dc09f85f29d80f83816cc1fc">Device</a> = <a href="/docs/api/classes/llvm/constant/#a4d51384de6e1798bb6aa875aebeea9f0">Constant::getAllOnesValue</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>);</Highlight></CodeLine>
<Link id="l06100" /><CodeLine lineNumber="6100"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;InteropTypeVal = ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, (</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">)InteropType);</Highlight></CodeLine>
<Link id="l06101" /><CodeLine lineNumber="6101"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumDependences == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l06102" /><CodeLine lineNumber="6102"><Highlight kind="normal">    NumDependences = ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, 0);</Highlight></CodeLine>
<Link id="l06103" /><CodeLine lineNumber="6103"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bae385c38bb67ea909198e13ee23c21028">PointerType</a> &#42;PointerTypeVar = <a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l06104" /><CodeLine lineNumber="6104"><Highlight kind="normal">    DependenceAddress = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(PointerTypeVar);</Highlight></CodeLine>
<Link id="l06105" /><CodeLine lineNumber="6105"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06106" /><CodeLine lineNumber="6106"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;HaveNowaitClauseVal = ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, HaveNowaitClause);</Highlight></CodeLine>
<Link id="l06107" /><CodeLine lineNumber="6107"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l06108" /><CodeLine lineNumber="6108"><Highlight kind="normal">      Ident,  ThreadId,       InteropVar,        InteropTypeVal,</Highlight></CodeLine>
<Link id="l06109" /><CodeLine lineNumber="6109"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/nvptx/#abd325b49b8e2f00c0370b1c68cf51557a67abb9e8dc09f85f29d80f83816cc1fc">Device</a>, NumDependences, DependenceAddress, HaveNowaitClauseVal&#125;;</Highlight></CodeLine>
<Link id="l06110" /><CodeLine lineNumber="6110"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06111" /><CodeLine lineNumber="6111"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;tgt&#95;interop&#95;init);</Highlight></CodeLine>
<Link id="l06112" /><CodeLine lineNumber="6112"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06113" /><CodeLine lineNumber="6113"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, Args);</Highlight></CodeLine>
<Link id="l06114" /><CodeLine lineNumber="6114"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06115" /><CodeLine lineNumber="6115"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06116" /><CodeLine lineNumber="6116"><Highlight kind="normal"><a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;OpenMPIRBuilder::createOMPInteropDestroy(</Highlight></CodeLine>
<Link id="l06117" /><CodeLine lineNumber="6117"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;InteropVar, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Device,</Highlight></CodeLine>
<Link id="l06118" /><CodeLine lineNumber="6118"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumDependences, <a href="/docs/api/classes/llvm/value">Value</a> &#42;DependenceAddress, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HaveNowaitClause) &#123;</Highlight></CodeLine>
<Link id="l06119" /><CodeLine lineNumber="6119"><Highlight kind="normal">  IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l06120" /><CodeLine lineNumber="6120"><Highlight kind="normal">  updateToLocation(Loc);</Highlight></CodeLine>
<Link id="l06121" /><CodeLine lineNumber="6121"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06122" /><CodeLine lineNumber="6122"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06123" /><CodeLine lineNumber="6123"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06124" /><CodeLine lineNumber="6124"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06125" /><CodeLine lineNumber="6125"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l06126" /><CodeLine lineNumber="6126"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Device == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l06127" /><CodeLine lineNumber="6127"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/nvptx/#abd325b49b8e2f00c0370b1c68cf51557a67abb9e8dc09f85f29d80f83816cc1fc">Device</a> = <a href="/docs/api/classes/llvm/constant/#a4d51384de6e1798bb6aa875aebeea9f0">Constant::getAllOnesValue</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>);</Highlight></CodeLine>
<Link id="l06128" /><CodeLine lineNumber="6128"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumDependences == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l06129" /><CodeLine lineNumber="6129"><Highlight kind="normal">    NumDependences = ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, 0);</Highlight></CodeLine>
<Link id="l06130" /><CodeLine lineNumber="6130"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bae385c38bb67ea909198e13ee23c21028">PointerType</a> &#42;PointerTypeVar = <a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l06131" /><CodeLine lineNumber="6131"><Highlight kind="normal">    DependenceAddress = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(PointerTypeVar);</Highlight></CodeLine>
<Link id="l06132" /><CodeLine lineNumber="6132"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06133" /><CodeLine lineNumber="6133"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;HaveNowaitClauseVal = ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, HaveNowaitClause);</Highlight></CodeLine>
<Link id="l06134" /><CodeLine lineNumber="6134"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l06135" /><CodeLine lineNumber="6135"><Highlight kind="normal">      Ident,          ThreadId,          InteropVar,         <a href="/docs/api/namespaces/llvm/nvptx/#abd325b49b8e2f00c0370b1c68cf51557a67abb9e8dc09f85f29d80f83816cc1fc">Device</a>,</Highlight></CodeLine>
<Link id="l06136" /><CodeLine lineNumber="6136"><Highlight kind="normal">      NumDependences, DependenceAddress, HaveNowaitClauseVal&#125;;</Highlight></CodeLine>
<Link id="l06137" /><CodeLine lineNumber="6137"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06138" /><CodeLine lineNumber="6138"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;tgt&#95;interop&#95;destroy);</Highlight></CodeLine>
<Link id="l06139" /><CodeLine lineNumber="6139"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06140" /><CodeLine lineNumber="6140"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, Args);</Highlight></CodeLine>
<Link id="l06141" /><CodeLine lineNumber="6141"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06142" /><CodeLine lineNumber="6142"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06143" /><CodeLine lineNumber="6143"><Highlight kind="normal"><a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;OpenMPIRBuilder::createOMPInteropUse(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l06144" /><CodeLine lineNumber="6144"><Highlight kind="normal">                                               <a href="/docs/api/classes/llvm/value">Value</a> &#42;InteropVar, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Device,</Highlight></CodeLine>
<Link id="l06145" /><CodeLine lineNumber="6145"><Highlight kind="normal">                                               <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumDependences,</Highlight></CodeLine>
<Link id="l06146" /><CodeLine lineNumber="6146"><Highlight kind="normal">                                               <a href="/docs/api/classes/llvm/value">Value</a> &#42;DependenceAddress,</Highlight></CodeLine>
<Link id="l06147" /><CodeLine lineNumber="6147"><Highlight kind="normal">                                               </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HaveNowaitClause) &#123;</Highlight></CodeLine>
<Link id="l06148" /><CodeLine lineNumber="6148"><Highlight kind="normal">  IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l06149" /><CodeLine lineNumber="6149"><Highlight kind="normal">  updateToLocation(Loc);</Highlight></CodeLine>
<Link id="l06150" /><CodeLine lineNumber="6150"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06151" /><CodeLine lineNumber="6151"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06152" /><CodeLine lineNumber="6152"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06153" /><CodeLine lineNumber="6153"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l06154" /><CodeLine lineNumber="6154"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Device == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l06155" /><CodeLine lineNumber="6155"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/nvptx/#abd325b49b8e2f00c0370b1c68cf51557a67abb9e8dc09f85f29d80f83816cc1fc">Device</a> = <a href="/docs/api/classes/llvm/constant/#a4d51384de6e1798bb6aa875aebeea9f0">Constant::getAllOnesValue</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>);</Highlight></CodeLine>
<Link id="l06156" /><CodeLine lineNumber="6156"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumDependences == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l06157" /><CodeLine lineNumber="6157"><Highlight kind="normal">    NumDependences = ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, 0);</Highlight></CodeLine>
<Link id="l06158" /><CodeLine lineNumber="6158"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bae385c38bb67ea909198e13ee23c21028">PointerType</a> &#42;PointerTypeVar = <a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l06159" /><CodeLine lineNumber="6159"><Highlight kind="normal">    DependenceAddress = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(PointerTypeVar);</Highlight></CodeLine>
<Link id="l06160" /><CodeLine lineNumber="6160"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06161" /><CodeLine lineNumber="6161"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;HaveNowaitClauseVal = ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, HaveNowaitClause);</Highlight></CodeLine>
<Link id="l06162" /><CodeLine lineNumber="6162"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l06163" /><CodeLine lineNumber="6163"><Highlight kind="normal">      Ident,          ThreadId,          InteropVar,         <a href="/docs/api/namespaces/llvm/nvptx/#abd325b49b8e2f00c0370b1c68cf51557a67abb9e8dc09f85f29d80f83816cc1fc">Device</a>,</Highlight></CodeLine>
<Link id="l06164" /><CodeLine lineNumber="6164"><Highlight kind="normal">      NumDependences, DependenceAddress, HaveNowaitClauseVal&#125;;</Highlight></CodeLine>
<Link id="l06165" /><CodeLine lineNumber="6165"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06166" /><CodeLine lineNumber="6166"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;tgt&#95;interop&#95;use);</Highlight></CodeLine>
<Link id="l06167" /><CodeLine lineNumber="6167"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06168" /><CodeLine lineNumber="6168"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, Args);</Highlight></CodeLine>
<Link id="l06169" /><CodeLine lineNumber="6169"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06170" /><CodeLine lineNumber="6170"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06171" /><CodeLine lineNumber="6171"><Highlight kind="normal"><a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;OpenMPIRBuilder::createCachedThreadPrivate(</Highlight></CodeLine>
<Link id="l06172" /><CodeLine lineNumber="6172"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;Pointer,</Highlight></CodeLine>
<Link id="l06173" /><CodeLine lineNumber="6173"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constantint">llvm::ConstantInt</a> &#42;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/twine">llvm::Twine</a> &amp;Name) &#123;</Highlight></CodeLine>
<Link id="l06174" /><CodeLine lineNumber="6174"><Highlight kind="normal">  IRBuilder&lt;&gt;::InsertPointGuard IPG(Builder);</Highlight></CodeLine>
<Link id="l06175" /><CodeLine lineNumber="6175"><Highlight kind="normal">  updateToLocation(Loc);</Highlight></CodeLine>
<Link id="l06176" /><CodeLine lineNumber="6176"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06177" /><CodeLine lineNumber="6177"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06178" /><CodeLine lineNumber="6178"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06179" /><CodeLine lineNumber="6179"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06180" /><CodeLine lineNumber="6180"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadId = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l06181" /><CodeLine lineNumber="6181"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;ThreadPrivateCache =</Highlight></CodeLine>
<Link id="l06182" /><CodeLine lineNumber="6182"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#aa5ef00e5a7487cc6c5bfed0f301fa1cc">getOrCreateInternalVariable</a>(Int8PtrPtr, <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>.str());</Highlight></CodeLine>
<Link id="l06183" /><CodeLine lineNumber="6183"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">llvm::Value</a> &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>&#91;&#93; = &#123;Ident, ThreadId, <a href="/docs/api/namespaces/llvm/codeview/#a0bfa8e65ecd85f3151f84bb53ad4bcbca61cf8510205077b6f5491d38cd44c0f7">Pointer</a>, <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, ThreadPrivateCache&#125;;</Highlight></CodeLine>
<Link id="l06184" /><CodeLine lineNumber="6184"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06185" /><CodeLine lineNumber="6185"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn =</Highlight></CodeLine>
<Link id="l06186" /><CodeLine lineNumber="6186"><Highlight kind="normal">      getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;threadprivate&#95;cached);</Highlight></CodeLine>
<Link id="l06187" /><CodeLine lineNumber="6187"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06188" /><CodeLine lineNumber="6188"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, Args);</Highlight></CodeLine>
<Link id="l06189" /><CodeLine lineNumber="6189"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06190" /><CodeLine lineNumber="6190"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06191" /><CodeLine lineNumber="6191"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> OpenMPIRBuilder::createTargetInit(</Highlight></CodeLine>
<Link id="l06192" /><CodeLine lineNumber="6192"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l06193" /><CodeLine lineNumber="6193"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> llvm::OpenMPIRBuilder::TargetKernelDefaultAttrs &amp;Attrs) &#123;</Highlight></CodeLine>
<Link id="l06194" /><CodeLine lineNumber="6194"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MaxThreads.empty() &amp;&amp; !<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MaxTeams.empty() &amp;&amp;</Highlight></CodeLine>
<Link id="l06195" /><CodeLine lineNumber="6195"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;expected num&#95;threads and num&#95;teams to be specified&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06196" /><CodeLine lineNumber="6196"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06197" /><CodeLine lineNumber="6197"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l06198" /><CodeLine lineNumber="6198"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l06199" /><CodeLine lineNumber="6199"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06200" /><CodeLine lineNumber="6200"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06201" /><CodeLine lineNumber="6201"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06202" /><CodeLine lineNumber="6202"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06203" /><CodeLine lineNumber="6203"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;IsSPMDVal = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(Int8, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.ExecFlags);</Highlight></CodeLine>
<Link id="l06204" /><CodeLine lineNumber="6204"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;UseGenericStateMachineVal = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(</Highlight></CodeLine>
<Link id="l06205" /><CodeLine lineNumber="6205"><Highlight kind="normal">      Int8, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.ExecFlags != <a href="/docs/api/namespaces/llvm/omp/#aa0c0d79dafb0d22308ce48808689f430a338c51f37ed4e4b2c9973a383c566c19">omp::OMP&#95;TGT&#95;EXEC&#95;MODE&#95;SPMD</a>);</Highlight></CodeLine>
<Link id="l06206" /><CodeLine lineNumber="6206"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;MayUseNestedParallelismVal = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(Int8, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06207" /><CodeLine lineNumber="6207"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;DebugIndentionLevelVal = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a150558aeaa819431aeb9729d26b2ac9f">Int16</a>, 0);</Highlight></CodeLine>
<Link id="l06208" /><CodeLine lineNumber="6208"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06209" /><CodeLine lineNumber="6209"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;DebugKernelWrapper = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l06210" /><CodeLine lineNumber="6210"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a> = DebugKernelWrapper;</Highlight></CodeLine>
<Link id="l06211" /><CodeLine lineNumber="6211"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06212" /><CodeLine lineNumber="6212"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We need to strip the debug prefix to get the correct kernel name.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06213" /><CodeLine lineNumber="6213"><Highlight kind="normal">  StringRef KernelName = <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>();</Highlight></CodeLine>
<Link id="l06214" /><CodeLine lineNumber="6214"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> std::string DebugPrefix = </Highlight><Highlight kind="stringliteral">&quot;&#95;debug&#95;&#95;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06215" /><CodeLine lineNumber="6215"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (KernelName.<a href="/docs/api/classes/llvm/stringref/#aca439bf65258d9d8d057812938b617c5">ends&#95;with</a>(DebugPrefix)) &#123;</Highlight></CodeLine>
<Link id="l06216" /><CodeLine lineNumber="6216"><Highlight kind="normal">    KernelName = KernelName.<a href="/docs/api/classes/llvm/stringref/#ae2705fd641fb3d1eefa2691b5117cf22">drop&#95;back</a>(DebugPrefix.length());</Highlight></CodeLine>
<Link id="l06217" /><CodeLine lineNumber="6217"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a> = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getFunction(KernelName);</Highlight></CodeLine>
<Link id="l06218" /><CodeLine lineNumber="6218"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a> &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected the real kernel to exist&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06219" /><CodeLine lineNumber="6219"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06220" /><CodeLine lineNumber="6220"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06221" /><CodeLine lineNumber="6221"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Manifest the launch configuration in the metadata matching the kernel</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06222" /><CodeLine lineNumber="6222"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// environment.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06223" /><CodeLine lineNumber="6223"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MinTeams &gt; 1 || <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MaxTeams.front() &gt; 0)</Highlight></CodeLine>
<Link id="l06224" /><CodeLine lineNumber="6224"><Highlight kind="normal">    writeTeamsForKernel(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, &#42;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MinTeams, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MaxTeams.front());</Highlight></CodeLine>
<Link id="l06225" /><CodeLine lineNumber="6225"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06226" /><CodeLine lineNumber="6226"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If MaxThreads not set, select the maximum between the default workgroup</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06227" /><CodeLine lineNumber="6227"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// size and the MinThreads value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06228" /><CodeLine lineNumber="6228"><Highlight kind="normal">  int32&#95;t MaxThreadsVal = <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MaxThreads.front();</Highlight></CodeLine>
<Link id="l06229" /><CodeLine lineNumber="6229"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (MaxThreadsVal &lt; 0)</Highlight></CodeLine>
<Link id="l06230" /><CodeLine lineNumber="6230"><Highlight kind="normal">    MaxThreadsVal = std::max(</Highlight></CodeLine>
<Link id="l06231" /><CodeLine lineNumber="6231"><Highlight kind="normal">        int32&#95;t(<a href="#ad52342fdd467389643191fdac7abcd40">getGridValue</a>(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>).GV&#95;Default&#95;WG&#95;Size), <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MinThreads);</Highlight></CodeLine>
<Link id="l06232" /><CodeLine lineNumber="6232"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06233" /><CodeLine lineNumber="6233"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (MaxThreadsVal &gt; 0)</Highlight></CodeLine>
<Link id="l06234" /><CodeLine lineNumber="6234"><Highlight kind="normal">    writeThreadBoundsForKernel(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, &#42;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MinThreads, MaxThreadsVal);</Highlight></CodeLine>
<Link id="l06235" /><CodeLine lineNumber="6235"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06236" /><CodeLine lineNumber="6236"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;MinThreads = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MinThreads);</Highlight></CodeLine>
<Link id="l06237" /><CodeLine lineNumber="6237"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/xcore/xcorelowerthreadlocal-cpp/#aa5ae01d4881f7ebccb4f8738541721ca">MaxThreads</a> = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, MaxThreadsVal);</Highlight></CodeLine>
<Link id="l06238" /><CodeLine lineNumber="6238"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;MinTeams = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MinTeams);</Highlight></CodeLine>
<Link id="l06239" /><CodeLine lineNumber="6239"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;MaxTeams = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a47142a8413e4b403d01f9365ac8d7ff7">Attrs</a>.MaxTeams.front());</Highlight></CodeLine>
<Link id="l06240" /><CodeLine lineNumber="6240"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;ReductionDataSize = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, 0);</Highlight></CodeLine>
<Link id="l06241" /><CodeLine lineNumber="6241"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;ReductionBufferLength = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, 0);</Highlight></CodeLine>
<Link id="l06242" /><CodeLine lineNumber="6242"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06243" /><CodeLine lineNumber="6243"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l06244" /><CodeLine lineNumber="6244"><Highlight kind="normal">      omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;target&#95;init);</Highlight></CodeLine>
<Link id="l06245" /><CodeLine lineNumber="6245"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> DataLayout &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = Fn-&gt;<a href="/docs/api/classes/llvm/function/#a3275c50993afaf4fdd723640c2c3ca0f">getDataLayout</a>();</Highlight></CodeLine>
<Link id="l06246" /><CodeLine lineNumber="6246"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06247" /><CodeLine lineNumber="6247"><Highlight kind="normal">  Twine DynamicEnvironmentName = KernelName + </Highlight><Highlight kind="stringliteral">&quot;&#95;dynamic&#95;environment&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06248" /><CodeLine lineNumber="6248"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;DynamicEnvironmentInitializer =</Highlight></CodeLine>
<Link id="l06249" /><CodeLine lineNumber="6249"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constantstruct/#a54fcfa620deb80373f489ba2fdad7643">ConstantStruct::get</a>(DynamicEnvironment, &#123;DebugIndentionLevelVal&#125;);</Highlight></CodeLine>
<Link id="l06250" /><CodeLine lineNumber="6250"><Highlight kind="normal">  GlobalVariable &#42;DynamicEnvironmentGV = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> GlobalVariable(</Highlight></CodeLine>
<Link id="l06251" /><CodeLine lineNumber="6251"><Highlight kind="normal">      M, DynamicEnvironment, </Highlight><Highlight kind="comment">/&#42;IsConstant=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca696bb1c9b0b0e76bb70c61f68866452a">GlobalValue::WeakODRLinkage</a>,</Highlight></CodeLine>
<Link id="l06252" /><CodeLine lineNumber="6252"><Highlight kind="normal">      DynamicEnvironmentInitializer, DynamicEnvironmentName,</Highlight></CodeLine>
<Link id="l06253" /><CodeLine lineNumber="6253"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;InsertBefore=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0">GlobalValue::NotThreadLocal</a>,</Highlight></CodeLine>
<Link id="l06254" /><CodeLine lineNumber="6254"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l06255" /><CodeLine lineNumber="6255"><Highlight kind="normal">  DynamicEnvironmentGV-&gt;setVisibility(<a href="/docs/api/classes/llvm/globalvalue/#a9141f967188383108a69cc1b8ed3c195ae1cc9a390520055573d459de25747caa">GlobalValue::ProtectedVisibility</a>);</Highlight></CodeLine>
<Link id="l06256" /><CodeLine lineNumber="6256"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06257" /><CodeLine lineNumber="6257"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;DynamicEnvironment =</Highlight></CodeLine>
<Link id="l06258" /><CodeLine lineNumber="6258"><Highlight kind="normal">      DynamicEnvironmentGV-&gt;getType() == DynamicEnvironmentPtr</Highlight></CodeLine>
<Link id="l06259" /><CodeLine lineNumber="6259"><Highlight kind="normal">          ? DynamicEnvironmentGV</Highlight></CodeLine>
<Link id="l06260" /><CodeLine lineNumber="6260"><Highlight kind="normal">          : <a href="/docs/api/classes/llvm/constantexpr/#acac8bfd6018661b40690c621bece1540">ConstantExpr::getAddrSpaceCast</a>(DynamicEnvironmentGV,</Highlight></CodeLine>
<Link id="l06261" /><CodeLine lineNumber="6261"><Highlight kind="normal">                                           DynamicEnvironmentPtr);</Highlight></CodeLine>
<Link id="l06262" /><CodeLine lineNumber="6262"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06263" /><CodeLine lineNumber="6263"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;ConfigurationEnvironmentInitializer = <a href="/docs/api/classes/llvm/constantstruct/#a54fcfa620deb80373f489ba2fdad7643">ConstantStruct::get</a>(</Highlight></CodeLine>
<Link id="l06264" /><CodeLine lineNumber="6264"><Highlight kind="normal">      ConfigurationEnvironment, &#123;</Highlight></CodeLine>
<Link id="l06265" /><CodeLine lineNumber="6265"><Highlight kind="normal">                                    UseGenericStateMachineVal,</Highlight></CodeLine>
<Link id="l06266" /><CodeLine lineNumber="6266"><Highlight kind="normal">                                    MayUseNestedParallelismVal,</Highlight></CodeLine>
<Link id="l06267" /><CodeLine lineNumber="6267"><Highlight kind="normal">                                    IsSPMDVal,</Highlight></CodeLine>
<Link id="l06268" /><CodeLine lineNumber="6268"><Highlight kind="normal">                                    MinThreads,</Highlight></CodeLine>
<Link id="l06269" /><CodeLine lineNumber="6269"><Highlight kind="normal">                                    <a href="/docs/api/files/lib/lib/target/lib/target/xcore/xcorelowerthreadlocal-cpp/#aa5ae01d4881f7ebccb4f8738541721ca">MaxThreads</a>,</Highlight></CodeLine>
<Link id="l06270" /><CodeLine lineNumber="6270"><Highlight kind="normal">                                    MinTeams,</Highlight></CodeLine>
<Link id="l06271" /><CodeLine lineNumber="6271"><Highlight kind="normal">                                    MaxTeams,</Highlight></CodeLine>
<Link id="l06272" /><CodeLine lineNumber="6272"><Highlight kind="normal">                                    ReductionDataSize,</Highlight></CodeLine>
<Link id="l06273" /><CodeLine lineNumber="6273"><Highlight kind="normal">                                    ReductionBufferLength,</Highlight></CodeLine>
<Link id="l06274" /><CodeLine lineNumber="6274"><Highlight kind="normal">                                &#125;);</Highlight></CodeLine>
<Link id="l06275" /><CodeLine lineNumber="6275"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;KernelEnvironmentInitializer = <a href="/docs/api/classes/llvm/constantstruct/#a54fcfa620deb80373f489ba2fdad7643">ConstantStruct::get</a>(</Highlight></CodeLine>
<Link id="l06276" /><CodeLine lineNumber="6276"><Highlight kind="normal">      KernelEnvironment, &#123;</Highlight></CodeLine>
<Link id="l06277" /><CodeLine lineNumber="6277"><Highlight kind="normal">                             ConfigurationEnvironmentInitializer,</Highlight></CodeLine>
<Link id="l06278" /><CodeLine lineNumber="6278"><Highlight kind="normal">                             Ident,</Highlight></CodeLine>
<Link id="l06279" /><CodeLine lineNumber="6279"><Highlight kind="normal">                             DynamicEnvironment,</Highlight></CodeLine>
<Link id="l06280" /><CodeLine lineNumber="6280"><Highlight kind="normal">                         &#125;);</Highlight></CodeLine>
<Link id="l06281" /><CodeLine lineNumber="6281"><Highlight kind="normal">  std::string KernelEnvironmentName =</Highlight></CodeLine>
<Link id="l06282" /><CodeLine lineNumber="6282"><Highlight kind="normal">      (KernelName + </Highlight><Highlight kind="stringliteral">&quot;&#95;kernel&#95;environment&quot;</Highlight><Highlight kind="normal">).str();</Highlight></CodeLine>
<Link id="l06283" /><CodeLine lineNumber="6283"><Highlight kind="normal">  GlobalVariable &#42;KernelEnvironmentGV = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> GlobalVariable(</Highlight></CodeLine>
<Link id="l06284" /><CodeLine lineNumber="6284"><Highlight kind="normal">      M, KernelEnvironment, </Highlight><Highlight kind="comment">/&#42;IsConstant=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca696bb1c9b0b0e76bb70c61f68866452a">GlobalValue::WeakODRLinkage</a>,</Highlight></CodeLine>
<Link id="l06285" /><CodeLine lineNumber="6285"><Highlight kind="normal">      KernelEnvironmentInitializer, KernelEnvironmentName,</Highlight></CodeLine>
<Link id="l06286" /><CodeLine lineNumber="6286"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;InsertBefore=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0">GlobalValue::NotThreadLocal</a>,</Highlight></CodeLine>
<Link id="l06287" /><CodeLine lineNumber="6287"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getDefaultGlobalsAddressSpace());</Highlight></CodeLine>
<Link id="l06288" /><CodeLine lineNumber="6288"><Highlight kind="normal">  KernelEnvironmentGV-&gt;<a href="/docs/api/classes/llvm/globalvalue/#aa242d8ab89216c14beab812e07009b2a">setVisibility</a>(<a href="/docs/api/classes/llvm/globalvalue/#a9141f967188383108a69cc1b8ed3c195ae1cc9a390520055573d459de25747caa">GlobalValue::ProtectedVisibility</a>);</Highlight></CodeLine>
<Link id="l06289" /><CodeLine lineNumber="6289"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06290" /><CodeLine lineNumber="6290"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;KernelEnvironment =</Highlight></CodeLine>
<Link id="l06291" /><CodeLine lineNumber="6291"><Highlight kind="normal">      KernelEnvironmentGV-&gt;<a href="/docs/api/classes/llvm/globalvalue/#a913a5d4b2cddde762446bd494e81a3f2">getType</a>() == KernelEnvironmentPtr</Highlight></CodeLine>
<Link id="l06292" /><CodeLine lineNumber="6292"><Highlight kind="normal">          ? KernelEnvironmentGV</Highlight></CodeLine>
<Link id="l06293" /><CodeLine lineNumber="6293"><Highlight kind="normal">          : <a href="/docs/api/classes/llvm/constantexpr/#acac8bfd6018661b40690c621bece1540">ConstantExpr::getAddrSpaceCast</a>(KernelEnvironmentGV,</Highlight></CodeLine>
<Link id="l06294" /><CodeLine lineNumber="6294"><Highlight kind="normal">                                           KernelEnvironmentPtr);</Highlight></CodeLine>
<Link id="l06295" /><CodeLine lineNumber="6295"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;KernelLaunchEnvironment = DebugKernelWrapper-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l06296" /><CodeLine lineNumber="6296"><Highlight kind="normal">  CallInst &#42;ThreadKind =</Highlight></CodeLine>
<Link id="l06297" /><CodeLine lineNumber="6297"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, &#123;KernelEnvironment, KernelLaunchEnvironment&#125;);</Highlight></CodeLine>
<Link id="l06298" /><CodeLine lineNumber="6298"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06299" /><CodeLine lineNumber="6299"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ExecUserCode = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(</Highlight></CodeLine>
<Link id="l06300" /><CodeLine lineNumber="6300"><Highlight kind="normal">      ThreadKind, <a href="/docs/api/classes/llvm/constant/#a4d51384de6e1798bb6aa875aebeea9f0">Constant::getAllOnesValue</a>(ThreadKind-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()),</Highlight></CodeLine>
<Link id="l06301" /><CodeLine lineNumber="6301"><Highlight kind="normal">      </Highlight><Highlight kind="stringliteral">&quot;exec&#95;user&#95;code&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06302" /><CodeLine lineNumber="6302"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06303" /><CodeLine lineNumber="6303"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ThreadKind = &#95;&#95;kmpc&#95;target&#95;init(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06304" /><CodeLine lineNumber="6304"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// if (ThreadKind == -1)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06305" /><CodeLine lineNumber="6305"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   user&#95;code</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06306" /><CodeLine lineNumber="6306"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06307" /><CodeLine lineNumber="6307"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   return;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06308" /><CodeLine lineNumber="6308"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06309" /><CodeLine lineNumber="6309"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;UI = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a39acc29443d48968a798fb22a76fa4c0">CreateUnreachable</a>();</Highlight></CodeLine>
<Link id="l06310" /><CodeLine lineNumber="6310"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CheckBB = UI-&gt;getParent();</Highlight></CodeLine>
<Link id="l06311" /><CodeLine lineNumber="6311"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;UserCodeEntryBB = CheckBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(UI, </Highlight><Highlight kind="stringliteral">&quot;user&#95;code.entry&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06312" /><CodeLine lineNumber="6312"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06313" /><CodeLine lineNumber="6313"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;WorkerExitBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l06314" /><CodeLine lineNumber="6314"><Highlight kind="normal">      CheckBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aa286a0f7f5d38488d593bb7ef0ba183e">getContext</a>(), </Highlight><Highlight kind="stringliteral">&quot;worker.exit&quot;</Highlight><Highlight kind="normal">, CheckBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>());</Highlight></CodeLine>
<Link id="l06315" /><CodeLine lineNumber="6315"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(WorkerExitBB);</Highlight></CodeLine>
<Link id="l06316" /><CodeLine lineNumber="6316"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l06317" /><CodeLine lineNumber="6317"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06318" /><CodeLine lineNumber="6318"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CheckBBTI = CheckBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l06319" /><CodeLine lineNumber="6319"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(CheckBBTI);</Highlight></CodeLine>
<Link id="l06320" /><CodeLine lineNumber="6320"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(ExecUserCode, UI-&gt;getParent(), WorkerExitBB);</Highlight></CodeLine>
<Link id="l06321" /><CodeLine lineNumber="6321"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06322" /><CodeLine lineNumber="6322"><Highlight kind="normal">  CheckBBTI-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l06323" /><CodeLine lineNumber="6323"><Highlight kind="normal">  UI-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l06324" /><CodeLine lineNumber="6324"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06325" /><CodeLine lineNumber="6325"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Continue in the &quot;user&#95;code&quot; block, see diagram above and in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06326" /><CodeLine lineNumber="6326"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// openmp/libomptarget/deviceRTLs/common/include/target.h .</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06327" /><CodeLine lineNumber="6327"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>(UserCodeEntryBB, UserCodeEntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a161fd4e9fa5367f64c2a4c9e921c3ad3">getFirstInsertionPt</a>());</Highlight></CodeLine>
<Link id="l06328" /><CodeLine lineNumber="6328"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06329" /><CodeLine lineNumber="6329"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06330" /><CodeLine lineNumber="6330"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::createTargetDeinit(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l06331" /><CodeLine lineNumber="6331"><Highlight kind="normal">                                         int32&#95;t TeamsReductionDataSize,</Highlight></CodeLine>
<Link id="l06332" /><CodeLine lineNumber="6332"><Highlight kind="normal">                                         int32&#95;t TeamsReductionBufferLength) &#123;</Highlight></CodeLine>
<Link id="l06333" /><CodeLine lineNumber="6333"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l06334" /><CodeLine lineNumber="6334"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06335" /><CodeLine lineNumber="6335"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06336" /><CodeLine lineNumber="6336"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l06337" /><CodeLine lineNumber="6337"><Highlight kind="normal">      omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;target&#95;deinit);</Highlight></CodeLine>
<Link id="l06338" /><CodeLine lineNumber="6338"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06339" /><CodeLine lineNumber="6339"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(Fn, &#123;&#125;);</Highlight></CodeLine>
<Link id="l06340" /><CodeLine lineNumber="6340"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06341" /><CodeLine lineNumber="6341"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!TeamsReductionBufferLength || !TeamsReductionDataSize)</Highlight></CodeLine>
<Link id="l06342" /><CodeLine lineNumber="6342"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06343" /><CodeLine lineNumber="6343"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06344" /><CodeLine lineNumber="6344"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l06345" /><CodeLine lineNumber="6345"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We need to strip the debug prefix to get the correct kernel name.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06346" /><CodeLine lineNumber="6346"><Highlight kind="normal">  StringRef KernelName = <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>();</Highlight></CodeLine>
<Link id="l06347" /><CodeLine lineNumber="6347"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> std::string DebugPrefix = </Highlight><Highlight kind="stringliteral">&quot;&#95;debug&#95;&#95;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06348" /><CodeLine lineNumber="6348"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (KernelName.<a href="/docs/api/classes/llvm/stringref/#aca439bf65258d9d8d057812938b617c5">ends&#95;with</a>(DebugPrefix))</Highlight></CodeLine>
<Link id="l06349" /><CodeLine lineNumber="6349"><Highlight kind="normal">    KernelName = KernelName.<a href="/docs/api/classes/llvm/stringref/#ae2705fd641fb3d1eefa2691b5117cf22">drop&#95;back</a>(DebugPrefix.length());</Highlight></CodeLine>
<Link id="l06350" /><CodeLine lineNumber="6350"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;KernelEnvironmentGV =</Highlight></CodeLine>
<Link id="l06351" /><CodeLine lineNumber="6351"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getNamedGlobal((KernelName + </Highlight><Highlight kind="stringliteral">&quot;&#95;kernel&#95;environment&quot;</Highlight><Highlight kind="normal">).str());</Highlight></CodeLine>
<Link id="l06352" /><CodeLine lineNumber="6352"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(KernelEnvironmentGV &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected kernel environment global\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06353" /><CodeLine lineNumber="6353"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;KernelEnvironmentInitializer = KernelEnvironmentGV-&gt;<a href="/docs/api/classes/llvm/globalvariable/#a0698d5bcabbfbca4f56a9d7a81cecb25">getInitializer</a>();</Highlight></CodeLine>
<Link id="l06354" /><CodeLine lineNumber="6354"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;NewInitializer = <a href="/docs/api/namespaces/llvm/#ad7fa9b738742521d0a684cec016ef47e">ConstantFoldInsertValueInstruction</a>(</Highlight></CodeLine>
<Link id="l06355" /><CodeLine lineNumber="6355"><Highlight kind="normal">      KernelEnvironmentInitializer,</Highlight></CodeLine>
<Link id="l06356" /><CodeLine lineNumber="6356"><Highlight kind="normal">      ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, TeamsReductionDataSize), &#123;0, 7&#125;);</Highlight></CodeLine>
<Link id="l06357" /><CodeLine lineNumber="6357"><Highlight kind="normal">  NewInitializer = <a href="/docs/api/namespaces/llvm/#ad7fa9b738742521d0a684cec016ef47e">ConstantFoldInsertValueInstruction</a>(</Highlight></CodeLine>
<Link id="l06358" /><CodeLine lineNumber="6358"><Highlight kind="normal">      NewInitializer, ConstantInt::get(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>, TeamsReductionBufferLength),</Highlight></CodeLine>
<Link id="l06359" /><CodeLine lineNumber="6359"><Highlight kind="normal">      &#123;0, 8&#125;);</Highlight></CodeLine>
<Link id="l06360" /><CodeLine lineNumber="6360"><Highlight kind="normal">  KernelEnvironmentGV-&gt;<a href="/docs/api/classes/llvm/globalvariable/#a095f8f031d99ce3c0b25478713293dea">setInitializer</a>(NewInitializer);</Highlight></CodeLine>
<Link id="l06361" /><CodeLine lineNumber="6361"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06362" /><CodeLine lineNumber="6362"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06363" /><CodeLine lineNumber="6363" lineLink="#a749d7f5580e6a5b6214d911bad2a0b36"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42;<a href="#a749d7f5580e6a5b6214d911bad2a0b36">getNVPTXMDNode</a>(<a href="/docs/api/classes/llvm/function">Function</a> &amp;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, <a href="/docs/api/classes/llvm/stringref">StringRef</a> Name) &#123;</Highlight></CodeLine>
<Link id="l06364" /><CodeLine lineNumber="6364"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/module">Module</a> &amp;M = &#42;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.getParent();</Highlight></CodeLine>
<Link id="l06365" /><CodeLine lineNumber="6365"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/namedmdnode">NamedMDNode</a> &#42;MD = M.getOrInsertNamedMetadata(</Highlight><Highlight kind="stringliteral">&quot;nvvm.annotations&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06366" /><CodeLine lineNumber="6366"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : MD-&gt;<a href="/docs/api/classes/llvm/namedmdnode/#adc55e223d70c06a924fd5cb248052d9d">operands</a>()) &#123;</Highlight></CodeLine>
<Link id="l06367" /><CodeLine lineNumber="6367"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>-&gt;getNumOperands() != 3)</Highlight></CodeLine>
<Link id="l06368" /><CodeLine lineNumber="6368"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06369" /><CodeLine lineNumber="6369"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;KernelOp = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantAsMetadata&gt;</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>-&gt;getOperand(0));</Highlight></CodeLine>
<Link id="l06370" /><CodeLine lineNumber="6370"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!KernelOp || KernelOp-&gt;getValue() != &amp;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>)</Highlight></CodeLine>
<Link id="l06371" /><CodeLine lineNumber="6371"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06372" /><CodeLine lineNumber="6372"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Prop = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;MDString&gt;</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>-&gt;getOperand(1));</Highlight></CodeLine>
<Link id="l06373" /><CodeLine lineNumber="6373"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Prop || Prop-&gt;getString() != Name)</Highlight></CodeLine>
<Link id="l06374" /><CodeLine lineNumber="6374"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06375" /><CodeLine lineNumber="6375"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>;</Highlight></CodeLine>
<Link id="l06376" /><CodeLine lineNumber="6376"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06377" /><CodeLine lineNumber="6377"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06378" /><CodeLine lineNumber="6378"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06379" /><CodeLine lineNumber="6379"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06380" /><CodeLine lineNumber="6380" lineLink="#a457f42a32df73079ac4526c572a2d7fd"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a457f42a32df73079ac4526c572a2d7fd">updateNVPTXMetadata</a>(<a href="/docs/api/classes/llvm/function">Function</a> &amp;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, <a href="/docs/api/classes/llvm/stringref">StringRef</a> Name, int32&#95;t <a href="/docs/api/classes/llvm/value">Value</a>,</Highlight></CodeLine>
<Link id="l06381" /><CodeLine lineNumber="6381"><Highlight kind="normal">                                </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Min) &#123;</Highlight></CodeLine>
<Link id="l06382" /><CodeLine lineNumber="6382"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update the &quot;maxntidx&quot; metadata for NVIDIA, or add it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06383" /><CodeLine lineNumber="6383"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42;ExistingOp = <a href="#a749d7f5580e6a5b6214d911bad2a0b36">getNVPTXMDNode</a>(<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, Name);</Highlight></CodeLine>
<Link id="l06384" /><CodeLine lineNumber="6384"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ExistingOp) &#123;</Highlight></CodeLine>
<Link id="l06385" /><CodeLine lineNumber="6385"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;OldVal = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ConstantAsMetadata&gt;</a>(ExistingOp-&gt;<a href="/docs/api/classes/llvm/mdnode/#a42409838a49255a3770da1469872f20b">getOperand</a>(2));</Highlight></CodeLine>
<Link id="l06386" /><CodeLine lineNumber="6386"><Highlight kind="normal">    int32&#95;t OldLimit = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ConstantInt&gt;</a>(OldVal-&gt;getValue())-&gt;getZExtValue();</Highlight></CodeLine>
<Link id="l06387" /><CodeLine lineNumber="6387"><Highlight kind="normal">    ExistingOp-&gt;<a href="/docs/api/classes/llvm/mdnode/#a160e9e1a4fd597f83034c8b2ba316984">replaceOperandWith</a>(</Highlight></CodeLine>
<Link id="l06388" /><CodeLine lineNumber="6388"><Highlight kind="normal">        2, <a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(ConstantInt::get(</Highlight></CodeLine>
<Link id="l06389" /><CodeLine lineNumber="6389"><Highlight kind="normal">               OldVal-&gt;getValue()-&gt;getType(),</Highlight></CodeLine>
<Link id="l06390" /><CodeLine lineNumber="6390"><Highlight kind="normal">               Min ? std::min(OldLimit, <a href="/docs/api/classes/llvm/value">Value</a>) : std::max(OldLimit, <a href="/docs/api/classes/llvm/value">Value</a>))));</Highlight></CodeLine>
<Link id="l06391" /><CodeLine lineNumber="6391"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06392" /><CodeLine lineNumber="6392"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.getContext();</Highlight></CodeLine>
<Link id="l06393" /><CodeLine lineNumber="6393"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/metadata">Metadata</a> &#42;MDVals&#91;&#93; = &#123;<a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(&amp;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>),</Highlight></CodeLine>
<Link id="l06394" /><CodeLine lineNumber="6394"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(Ctx, Name),</Highlight></CodeLine>
<Link id="l06395" /><CodeLine lineNumber="6395"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(</Highlight></CodeLine>
<Link id="l06396" /><CodeLine lineNumber="6396"><Highlight kind="normal">                              ConstantInt::get(<a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Ctx), <a href="/docs/api/classes/llvm/value">Value</a>))&#125;;</Highlight></CodeLine>
<Link id="l06397" /><CodeLine lineNumber="6397"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Append metadata to nvvm.annotations</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06398" /><CodeLine lineNumber="6398"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/module">Module</a> &amp;M = &#42;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.getParent();</Highlight></CodeLine>
<Link id="l06399" /><CodeLine lineNumber="6399"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/namedmdnode">NamedMDNode</a> &#42;MD = M.getOrInsertNamedMetadata(</Highlight><Highlight kind="stringliteral">&quot;nvvm.annotations&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06400" /><CodeLine lineNumber="6400"><Highlight kind="normal">    MD-&gt;<a href="/docs/api/classes/llvm/namedmdnode/#ae917c72e5b8e15491cd0dbdd44d818f2">addOperand</a>(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(Ctx, MDVals));</Highlight></CodeLine>
<Link id="l06401" /><CodeLine lineNumber="6401"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06402" /><CodeLine lineNumber="6402"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06403" /><CodeLine lineNumber="6403"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06404" /><CodeLine lineNumber="6404"><Highlight kind="normal">std::pair&lt;int32&#95;t, int32&#95;t&gt;</Highlight></CodeLine>
<Link id="l06405" /><CodeLine lineNumber="6405"><Highlight kind="normal">OpenMPIRBuilder::readThreadBoundsForKernel(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/triple">Triple</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, <a href="/docs/api/classes/llvm/function">Function</a> &amp;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>) &#123;</Highlight></CodeLine>
<Link id="l06406" /><CodeLine lineNumber="6406"><Highlight kind="normal">  int32&#95;t ThreadLimit =</Highlight></CodeLine>
<Link id="l06407" /><CodeLine lineNumber="6407"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.<a href="/docs/api/classes/llvm/function/#a4c866d3504a1e0717c8152a590bd6203">getFnAttributeAsParsedInteger</a>(</Highlight><Highlight kind="stringliteral">&quot;omp&#95;target&#95;thread&#95;limit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06408" /><CodeLine lineNumber="6408"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06409" /><CodeLine lineNumber="6409"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isAMDGPU()) &#123;</Highlight></CodeLine>
<Link id="l06410" /><CodeLine lineNumber="6410"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Attr = <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.<a href="/docs/api/classes/llvm/function/#a4c319db4fe05c27cfe55bd133a87414d">getFnAttribute</a>(</Highlight><Highlight kind="stringliteral">&quot;amdgpu-flat-work-group-size&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06411" /><CodeLine lineNumber="6411"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Attr.isValid() || !Attr.isStringAttribute())</Highlight></CodeLine>
<Link id="l06412" /><CodeLine lineNumber="6412"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;0, ThreadLimit&#125;;</Highlight></CodeLine>
<Link id="l06413" /><CodeLine lineNumber="6413"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#91;LBStr, UBStr&#93; = Attr.<a href="/docs/api/classes/llvm/attribute/#a968930aea9d9efa8d46dd890fce75643">getValueAsString</a>().<a href="/docs/api/classes/llvm/stringref/#a0320b2a5a6d440bf4479a02e78cf5ca7">split</a>(</Highlight><Highlight kind="charliteral">&#39;,&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06414" /><CodeLine lineNumber="6414"><Highlight kind="normal">    int32&#95;t LB, UB;</Highlight></CodeLine>
<Link id="l06415" /><CodeLine lineNumber="6415"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#ae03f2b6a02fc9092755ba3a6cf6d2446">llvm::to&#95;integer</a>(UBStr, UB, 10))</Highlight></CodeLine>
<Link id="l06416" /><CodeLine lineNumber="6416"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;0, ThreadLimit&#125;;</Highlight></CodeLine>
<Link id="l06417" /><CodeLine lineNumber="6417"><Highlight kind="normal">    UB = ThreadLimit ? std::min(ThreadLimit, UB) : UB;</Highlight></CodeLine>
<Link id="l06418" /><CodeLine lineNumber="6418"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#ae03f2b6a02fc9092755ba3a6cf6d2446">llvm::to&#95;integer</a>(LBStr, LB, 10))</Highlight></CodeLine>
<Link id="l06419" /><CodeLine lineNumber="6419"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;0, UB&#125;;</Highlight></CodeLine>
<Link id="l06420" /><CodeLine lineNumber="6420"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;LB, UB&#125;;</Highlight></CodeLine>
<Link id="l06421" /><CodeLine lineNumber="6421"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06422" /><CodeLine lineNumber="6422"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06423" /><CodeLine lineNumber="6423"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (MDNode &#42;ExistingOp = <a href="#a749d7f5580e6a5b6214d911bad2a0b36">getNVPTXMDNode</a>(<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, </Highlight><Highlight kind="stringliteral">&quot;maxntidx&quot;</Highlight><Highlight kind="normal">)) &#123;</Highlight></CodeLine>
<Link id="l06424" /><CodeLine lineNumber="6424"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;OldVal = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ConstantAsMetadata&gt;</a>(ExistingOp-&gt;getOperand(2));</Highlight></CodeLine>
<Link id="l06425" /><CodeLine lineNumber="6425"><Highlight kind="normal">    int32&#95;t UB = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ConstantInt&gt;</a>(OldVal-&gt;getValue())-&gt;getZExtValue();</Highlight></CodeLine>
<Link id="l06426" /><CodeLine lineNumber="6426"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;0, ThreadLimit ? std::min(ThreadLimit, UB) : UB&#125;;</Highlight></CodeLine>
<Link id="l06427" /><CodeLine lineNumber="6427"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06428" /><CodeLine lineNumber="6428"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;0, ThreadLimit&#125;;</Highlight></CodeLine>
<Link id="l06429" /><CodeLine lineNumber="6429"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06430" /><CodeLine lineNumber="6430"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06431" /><CodeLine lineNumber="6431"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::writeThreadBoundsForKernel(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Triple &amp;<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>,</Highlight></CodeLine>
<Link id="l06432" /><CodeLine lineNumber="6432"><Highlight kind="normal">                                                 Function &amp;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, int32&#95;t LB,</Highlight></CodeLine>
<Link id="l06433" /><CodeLine lineNumber="6433"><Highlight kind="normal">                                                 int32&#95;t UB) &#123;</Highlight></CodeLine>
<Link id="l06434" /><CodeLine lineNumber="6434"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(</Highlight><Highlight kind="stringliteral">&quot;omp&#95;target&#95;thread&#95;limit&quot;</Highlight><Highlight kind="normal">, std::to&#95;string(UB));</Highlight></CodeLine>
<Link id="l06435" /><CodeLine lineNumber="6435"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06436" /><CodeLine lineNumber="6436"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isAMDGPU()) &#123;</Highlight></CodeLine>
<Link id="l06437" /><CodeLine lineNumber="6437"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(</Highlight><Highlight kind="stringliteral">&quot;amdgpu-flat-work-group-size&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l06438" /><CodeLine lineNumber="6438"><Highlight kind="normal">                     <a href="/docs/api/namespaces/llvm/#a41972fe6f3fab862543b7b835a714f9b">llvm::utostr</a>(LB) + </Highlight><Highlight kind="stringliteral">&quot;,&quot;</Highlight><Highlight kind="normal"> + <a href="/docs/api/namespaces/llvm/#a41972fe6f3fab862543b7b835a714f9b">llvm::utostr</a>(UB));</Highlight></CodeLine>
<Link id="l06439" /><CodeLine lineNumber="6439"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06440" /><CodeLine lineNumber="6440"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06441" /><CodeLine lineNumber="6441"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06442" /><CodeLine lineNumber="6442"><Highlight kind="normal">  <a href="#a457f42a32df73079ac4526c572a2d7fd">updateNVPTXMetadata</a>(<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, </Highlight><Highlight kind="stringliteral">&quot;maxntidx&quot;</Highlight><Highlight kind="normal">, UB, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06443" /><CodeLine lineNumber="6443"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06444" /><CodeLine lineNumber="6444"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06445" /><CodeLine lineNumber="6445"><Highlight kind="normal">std::pair&lt;int32&#95;t, int32&#95;t&gt;</Highlight></CodeLine>
<Link id="l06446" /><CodeLine lineNumber="6446"><Highlight kind="normal">OpenMPIRBuilder::readTeamBoundsForKernel(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Triple &amp;, Function &amp;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>) &#123;</Highlight></CodeLine>
<Link id="l06447" /><CodeLine lineNumber="6447"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Read from backend annotations if available.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06448" /><CodeLine lineNumber="6448"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;0, <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.<a href="/docs/api/classes/llvm/function/#a4c866d3504a1e0717c8152a590bd6203">getFnAttributeAsParsedInteger</a>(</Highlight><Highlight kind="stringliteral">&quot;omp&#95;target&#95;num&#95;teams&quot;</Highlight><Highlight kind="normal">)&#125;;</Highlight></CodeLine>
<Link id="l06449" /><CodeLine lineNumber="6449"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06450" /><CodeLine lineNumber="6450"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06451" /><CodeLine lineNumber="6451"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::writeTeamsForKernel(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Triple &amp;<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>, Function &amp;<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>,</Highlight></CodeLine>
<Link id="l06452" /><CodeLine lineNumber="6452"><Highlight kind="normal">                                          int32&#95;t LB, int32&#95;t UB) &#123;</Highlight></CodeLine>
<Link id="l06453" /><CodeLine lineNumber="6453"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isNVPTX())</Highlight></CodeLine>
<Link id="l06454" /><CodeLine lineNumber="6454"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UB &gt; 0)</Highlight></CodeLine>
<Link id="l06455" /><CodeLine lineNumber="6455"><Highlight kind="normal">      <a href="#a457f42a32df73079ac4526c572a2d7fd">updateNVPTXMetadata</a>(<a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>, </Highlight><Highlight kind="stringliteral">&quot;maxclusterrank&quot;</Highlight><Highlight kind="normal">, UB, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06456" /><CodeLine lineNumber="6456"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isAMDGPU())</Highlight></CodeLine>
<Link id="l06457" /><CodeLine lineNumber="6457"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(</Highlight><Highlight kind="stringliteral">&quot;amdgpu-max-num-workgroups&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/#a41972fe6f3fab862543b7b835a714f9b">llvm::utostr</a>(LB) + </Highlight><Highlight kind="stringliteral">&quot;,1,1&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06458" /><CodeLine lineNumber="6458"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06459" /><CodeLine lineNumber="6459"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#ab07e7d76494438d05bf51cd36ba5a795">Kernel</a>.<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(</Highlight><Highlight kind="stringliteral">&quot;omp&#95;target&#95;num&#95;teams&quot;</Highlight><Highlight kind="normal">, std::to&#95;string(LB));</Highlight></CodeLine>
<Link id="l06460" /><CodeLine lineNumber="6460"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06461" /><CodeLine lineNumber="6461"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06462" /><CodeLine lineNumber="6462"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::setOutlinedTargetRegionFunctionAttributes(</Highlight></CodeLine>
<Link id="l06463" /><CodeLine lineNumber="6463"><Highlight kind="normal">    Function &#42;OutlinedFn) &#123;</Highlight></CodeLine>
<Link id="l06464" /><CodeLine lineNumber="6464"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l06465" /><CodeLine lineNumber="6465"><Highlight kind="normal">    OutlinedFn-&gt;<a href="/docs/api/classes/llvm/globalvalue/#a687973de03d041e04b50a76d19d4fd36">setLinkage</a>(<a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca696bb1c9b0b0e76bb70c61f68866452a">GlobalValue::WeakODRLinkage</a>);</Highlight></CodeLine>
<Link id="l06466" /><CodeLine lineNumber="6466"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Determine if DSO local can be set to true.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06467" /><CodeLine lineNumber="6467"><Highlight kind="normal">    OutlinedFn-&gt;<a href="/docs/api/classes/llvm/globalvalue/#a78c4d0538c7dbffa955486abae2b61bb">setDSOLocal</a>(</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06468" /><CodeLine lineNumber="6468"><Highlight kind="normal">    OutlinedFn-&gt;<a href="/docs/api/classes/llvm/globalvalue/#aa242d8ab89216c14beab812e07009b2a">setVisibility</a>(<a href="/docs/api/classes/llvm/globalvalue/#a9141f967188383108a69cc1b8ed3c195ae1cc9a390520055573d459de25747caa">GlobalValue::ProtectedVisibility</a>);</Highlight></CodeLine>
<Link id="l06469" /><CodeLine lineNumber="6469"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isAMDGCN())</Highlight></CodeLine>
<Link id="l06470" /><CodeLine lineNumber="6470"><Highlight kind="normal">      OutlinedFn-&gt;<a href="/docs/api/classes/llvm/function/#ae6db8746934e6feae3649a8709fce3cc">setCallingConv</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4ca27a385675142c462571165c839e41aa0">CallingConv::AMDGPU&#95;KERNEL</a>);</Highlight></CodeLine>
<Link id="l06471" /><CodeLine lineNumber="6471"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isNVPTX())</Highlight></CodeLine>
<Link id="l06472" /><CodeLine lineNumber="6472"><Highlight kind="normal">      OutlinedFn-&gt;<a href="/docs/api/classes/llvm/function/#ae6db8746934e6feae3649a8709fce3cc">setCallingConv</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cae60325da71f0576e18cc0e5dd7e8afb6">CallingConv::PTX&#95;Kernel</a>);</Highlight></CodeLine>
<Link id="l06473" /><CodeLine lineNumber="6473"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06474" /><CodeLine lineNumber="6474"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06475" /><CodeLine lineNumber="6475"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06476" /><CodeLine lineNumber="6476"><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;OpenMPIRBuilder::createOutlinedFunctionID(Function &#42;OutlinedFn,</Highlight></CodeLine>
<Link id="l06477" /><CodeLine lineNumber="6477"><Highlight kind="normal">                                                    StringRef EntryFnIDName) &#123;</Highlight></CodeLine>
<Link id="l06478" /><CodeLine lineNumber="6478"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l06479" /><CodeLine lineNumber="6479"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;The outlined function must exist if embedded&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06480" /><CodeLine lineNumber="6480"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OutlinedFn;</Highlight></CodeLine>
<Link id="l06481" /><CodeLine lineNumber="6481"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06482" /><CodeLine lineNumber="6482"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06483" /><CodeLine lineNumber="6483"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> GlobalVariable(</Highlight></CodeLine>
<Link id="l06484" /><CodeLine lineNumber="6484"><Highlight kind="normal">      M, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae7be2e1490f01c049d748436f03760c5">getInt8Ty</a>(), </Highlight><Highlight kind="comment">/&#42;isConstant=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f">GlobalValue::WeakAnyLinkage</a>,</Highlight></CodeLine>
<Link id="l06485" /><CodeLine lineNumber="6485"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae7be2e1490f01c049d748436f03760c5">getInt8Ty</a>()), EntryFnIDName);</Highlight></CodeLine>
<Link id="l06486" /><CodeLine lineNumber="6486"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06487" /><CodeLine lineNumber="6487"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06488" /><CodeLine lineNumber="6488"><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;OpenMPIRBuilder::createTargetRegionEntryAddr(Function &#42;OutlinedFn,</Highlight></CodeLine>
<Link id="l06489" /><CodeLine lineNumber="6489"><Highlight kind="normal">                                                       StringRef EntryFnName) &#123;</Highlight></CodeLine>
<Link id="l06490" /><CodeLine lineNumber="6490"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OutlinedFn)</Highlight></CodeLine>
<Link id="l06491" /><CodeLine lineNumber="6491"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OutlinedFn;</Highlight></CodeLine>
<Link id="l06492" /><CodeLine lineNumber="6492"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06493" /><CodeLine lineNumber="6493"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getGlobalVariable(EntryFnName, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">) &amp;&amp;</Highlight></CodeLine>
<Link id="l06494" /><CodeLine lineNumber="6494"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Named kernel already exists?&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06495" /><CodeLine lineNumber="6495"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> GlobalVariable(</Highlight></CodeLine>
<Link id="l06496" /><CodeLine lineNumber="6496"><Highlight kind="normal">      M, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae7be2e1490f01c049d748436f03760c5">getInt8Ty</a>(), </Highlight><Highlight kind="comment">/&#42;isConstant=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l06497" /><CodeLine lineNumber="6497"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae7be2e1490f01c049d748436f03760c5">getInt8Ty</a>()), EntryFnName);</Highlight></CodeLine>
<Link id="l06498" /><CodeLine lineNumber="6498"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06499" /><CodeLine lineNumber="6499"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06500" /><CodeLine lineNumber="6500"><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> OpenMPIRBuilder::emitTargetRegionFunction(</Highlight></CodeLine>
<Link id="l06501" /><CodeLine lineNumber="6501"><Highlight kind="normal">    TargetRegionEntryInfo &amp;EntryInfo,</Highlight></CodeLine>
<Link id="l06502" /><CodeLine lineNumber="6502"><Highlight kind="normal">    FunctionGenCallback &amp;GenerateFunctionCallback, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsOffloadEntry,</Highlight></CodeLine>
<Link id="l06503" /><CodeLine lineNumber="6503"><Highlight kind="normal">    Function &#42;&amp;OutlinedFn, <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;&amp;OutlinedFnID) &#123;</Highlight></CodeLine>
<Link id="l06504" /><CodeLine lineNumber="6504"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06505" /><CodeLine lineNumber="6505"><Highlight kind="normal">  SmallString&lt;64&gt; EntryFnName;</Highlight></CodeLine>
<Link id="l06506" /><CodeLine lineNumber="6506"><Highlight kind="normal">  OffloadInfoManager.getTargetRegionEntryFnName(EntryFnName, EntryInfo);</Highlight></CodeLine>
<Link id="l06507" /><CodeLine lineNumber="6507"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06508" /><CodeLine lineNumber="6508"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice() || !Config.openMPOffloadMandatory()) &#123;</Highlight></CodeLine>
<Link id="l06509" /><CodeLine lineNumber="6509"><Highlight kind="normal">    Expected&lt;Function &#42;&gt; CBResult = GenerateFunctionCallback(EntryFnName);</Highlight></CodeLine>
<Link id="l06510" /><CodeLine lineNumber="6510"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CBResult)</Highlight></CodeLine>
<Link id="l06511" /><CodeLine lineNumber="6511"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> CBResult.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l06512" /><CodeLine lineNumber="6512"><Highlight kind="normal">    OutlinedFn = &#42;CBResult;</Highlight></CodeLine>
<Link id="l06513" /><CodeLine lineNumber="6513"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06514" /><CodeLine lineNumber="6514"><Highlight kind="normal">    OutlinedFn = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06515" /><CodeLine lineNumber="6515"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06516" /><CodeLine lineNumber="6516"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06517" /><CodeLine lineNumber="6517"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If this target outline function is not an offload entry, we don&#39;t need to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06518" /><CodeLine lineNumber="6518"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// register it. This may be in the case of a false if clause, or if there are</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06519" /><CodeLine lineNumber="6519"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// no OpenMP targets.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06520" /><CodeLine lineNumber="6520"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsOffloadEntry)</Highlight></CodeLine>
<Link id="l06521" /><CodeLine lineNumber="6521"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l06522" /><CodeLine lineNumber="6522"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06523" /><CodeLine lineNumber="6523"><Highlight kind="normal">  std::string EntryFnIDName =</Highlight></CodeLine>
<Link id="l06524" /><CodeLine lineNumber="6524"><Highlight kind="normal">      Config.isTargetDevice()</Highlight></CodeLine>
<Link id="l06525" /><CodeLine lineNumber="6525"><Highlight kind="normal">          ? std::string(EntryFnName)</Highlight></CodeLine>
<Link id="l06526" /><CodeLine lineNumber="6526"><Highlight kind="normal">          : <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;EntryFnName, </Highlight><Highlight kind="stringliteral">&quot;region&#95;id&quot;</Highlight><Highlight kind="normal">&#125;);</Highlight></CodeLine>
<Link id="l06527" /><CodeLine lineNumber="6527"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06528" /><CodeLine lineNumber="6528"><Highlight kind="normal">  OutlinedFnID = registerTargetRegionFunction(EntryInfo, OutlinedFn,</Highlight></CodeLine>
<Link id="l06529" /><CodeLine lineNumber="6529"><Highlight kind="normal">                                              EntryFnName, EntryFnIDName);</Highlight></CodeLine>
<Link id="l06530" /><CodeLine lineNumber="6530"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l06531" /><CodeLine lineNumber="6531"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06532" /><CodeLine lineNumber="6532"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06533" /><CodeLine lineNumber="6533"><Highlight kind="normal"><a href="/docs/api/classes/llvm/constant">Constant</a> &#42;OpenMPIRBuilder::registerTargetRegionFunction(</Highlight></CodeLine>
<Link id="l06534" /><CodeLine lineNumber="6534"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp;EntryInfo, <a href="/docs/api/classes/llvm/function">Function</a> &#42;OutlinedFn,</Highlight></CodeLine>
<Link id="l06535" /><CodeLine lineNumber="6535"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/stringref">StringRef</a> EntryFnName, <a href="/docs/api/classes/llvm/stringref">StringRef</a> EntryFnIDName) &#123;</Highlight></CodeLine>
<Link id="l06536" /><CodeLine lineNumber="6536"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OutlinedFn)</Highlight></CodeLine>
<Link id="l06537" /><CodeLine lineNumber="6537"><Highlight kind="normal">    setOutlinedTargetRegionFunctionAttributes(OutlinedFn);</Highlight></CodeLine>
<Link id="l06538" /><CodeLine lineNumber="6538"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> OutlinedFnID = createOutlinedFunctionID(OutlinedFn, EntryFnIDName);</Highlight></CodeLine>
<Link id="l06539" /><CodeLine lineNumber="6539"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> EntryAddr = createTargetRegionEntryAddr(OutlinedFn, EntryFnName);</Highlight></CodeLine>
<Link id="l06540" /><CodeLine lineNumber="6540"><Highlight kind="normal">  OffloadInfoManager.registerTargetRegionEntryInfo(</Highlight></CodeLine>
<Link id="l06541" /><CodeLine lineNumber="6541"><Highlight kind="normal">      EntryInfo, EntryAddr, OutlinedFnID,</Highlight></CodeLine>
<Link id="l06542" /><CodeLine lineNumber="6542"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a4e85049eada7d6cc3bedde1433ce4a7ba1e2537a111117d2cebad779b6de1856b">OffloadEntriesInfoManager::OMPTargetRegionEntryTargetRegion</a>);</Highlight></CodeLine>
<Link id="l06543" /><CodeLine lineNumber="6543"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OutlinedFnID;</Highlight></CodeLine>
<Link id="l06544" /><CodeLine lineNumber="6544"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06545" /><CodeLine lineNumber="6545"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06546" /><CodeLine lineNumber="6546"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::createTargetData(</Highlight></CodeLine>
<Link id="l06547" /><CodeLine lineNumber="6547"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l06548" /><CodeLine lineNumber="6548"><Highlight kind="normal">    InsertPointTy CodeGenIP, <a href="/docs/api/classes/llvm/value">Value</a> &#42;DeviceID, <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCond,</Highlight></CodeLine>
<Link id="l06549" /><CodeLine lineNumber="6549"><Highlight kind="normal">    TargetDataInfo &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>, GenMapInfoCallbackTy GenMapInfoCB,</Highlight></CodeLine>
<Link id="l06550" /><CodeLine lineNumber="6550"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a4c503140c7f851151906d85b515330e9">omp::RuntimeFunction</a> &#42;MapperFunc,</Highlight></CodeLine>
<Link id="l06551" /><CodeLine lineNumber="6551"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;InsertPointOrErrorTy(InsertPointTy CodeGenIP,</Highlight></CodeLine>
<Link id="l06552" /><CodeLine lineNumber="6552"><Highlight kind="normal">                                      BodyGenTy BodyGenType)&gt;</Highlight></CodeLine>
<Link id="l06553" /><CodeLine lineNumber="6553"><Highlight kind="normal">        BodyGenCB,</Highlight></CodeLine>
<Link id="l06554" /><CodeLine lineNumber="6554"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;</Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal">(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/value">Value</a> &#42;)&gt; DeviceAddrCB,</Highlight></CodeLine>
<Link id="l06555" /><CodeLine lineNumber="6555"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;<a href="/docs/api/classes/llvm/value">Value</a> &#42;(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">)&gt; CustomMapperCB, <a href="/docs/api/classes/llvm/value">Value</a> &#42;SrcLocInfo) &#123;</Highlight></CodeLine>
<Link id="l06556" /><CodeLine lineNumber="6556"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l06557" /><CodeLine lineNumber="6557"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l06558" /><CodeLine lineNumber="6558"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06559" /><CodeLine lineNumber="6559"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l06560" /><CodeLine lineNumber="6560"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Disable TargetData CodeGen on Device pass.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06561" /><CodeLine lineNumber="6561"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.IsTargetDevice.value&#95;or(</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">)) &#123;</Highlight></CodeLine>
<Link id="l06562" /><CodeLine lineNumber="6562"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BodyGenCB) &#123;</Highlight></CodeLine>
<Link id="l06563" /><CodeLine lineNumber="6563"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l06564" /><CodeLine lineNumber="6564"><Highlight kind="normal">          BodyGenCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), BodyGenTy::NoPriv);</Highlight></CodeLine>
<Link id="l06565" /><CodeLine lineNumber="6565"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l06566" /><CodeLine lineNumber="6566"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l06567" /><CodeLine lineNumber="6567"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l06568" /><CodeLine lineNumber="6568"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06569" /><CodeLine lineNumber="6569"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l06570" /><CodeLine lineNumber="6570"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06571" /><CodeLine lineNumber="6571"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06572" /><CodeLine lineNumber="6572"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsStandAlone = !BodyGenCB;</Highlight></CodeLine>
<Link id="l06573" /><CodeLine lineNumber="6573"><Highlight kind="normal">  MapInfosTy &#42;MapInfo;</Highlight></CodeLine>
<Link id="l06574" /><CodeLine lineNumber="6574"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Generate the code for the opening of the data environment. Capture all the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06575" /><CodeLine lineNumber="6575"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// arguments of the runtime call by reference because they are used in the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06576" /><CodeLine lineNumber="6576"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// closing of the region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06577" /><CodeLine lineNumber="6577"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> BeginThenGen = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP,</Highlight></CodeLine>
<Link id="l06578" /><CodeLine lineNumber="6578"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP) -&gt; <a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> &#123;</Highlight></CodeLine>
<Link id="l06579" /><CodeLine lineNumber="6579"><Highlight kind="normal">    MapInfo = &amp;GenMapInfoCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l06580" /><CodeLine lineNumber="6580"><Highlight kind="normal">    emitOffloadingArrays(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), &#42;MapInfo, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>,</Highlight></CodeLine>
<Link id="l06581" /><CodeLine lineNumber="6581"><Highlight kind="normal">                         </Highlight><Highlight kind="comment">/&#42;IsNonContiguous=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, DeviceAddrCB,</Highlight></CodeLine>
<Link id="l06582" /><CodeLine lineNumber="6582"><Highlight kind="normal">                         CustomMapperCB);</Highlight></CodeLine>
<Link id="l06583" /><CodeLine lineNumber="6583"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06584" /><CodeLine lineNumber="6584"><Highlight kind="normal">    TargetDataRTArgs RTArgs;</Highlight></CodeLine>
<Link id="l06585" /><CodeLine lineNumber="6585"><Highlight kind="normal">    emitOffloadingArraysArgument(Builder, RTArgs, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>);</Highlight></CodeLine>
<Link id="l06586" /><CodeLine lineNumber="6586"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06587" /><CodeLine lineNumber="6587"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Emit the number of elements in the offloading arrays.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06588" /><CodeLine lineNumber="6588"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PointerNum = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs);</Highlight></CodeLine>
<Link id="l06589" /><CodeLine lineNumber="6589"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06590" /><CodeLine lineNumber="6590"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Source location for the ident struct</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06591" /><CodeLine lineNumber="6591"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SrcLocInfo) &#123;</Highlight></CodeLine>
<Link id="l06592" /><CodeLine lineNumber="6592"><Highlight kind="normal">      uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06593" /><CodeLine lineNumber="6593"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06594" /><CodeLine lineNumber="6594"><Highlight kind="normal">      SrcLocInfo = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06595" /><CodeLine lineNumber="6595"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06596" /><CodeLine lineNumber="6596"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06597" /><CodeLine lineNumber="6597"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;llvm::Value &#42;, 13&gt;</a> OffloadingArgs = &#123;</Highlight></CodeLine>
<Link id="l06598" /><CodeLine lineNumber="6598"><Highlight kind="normal">        SrcLocInfo,           DeviceID,</Highlight></CodeLine>
<Link id="l06599" /><CodeLine lineNumber="6599"><Highlight kind="normal">        PointerNum,           RTArgs.BasePointersArray,</Highlight></CodeLine>
<Link id="l06600" /><CodeLine lineNumber="6600"><Highlight kind="normal">        RTArgs.PointersArray, RTArgs.SizesArray,</Highlight></CodeLine>
<Link id="l06601" /><CodeLine lineNumber="6601"><Highlight kind="normal">        RTArgs.MapTypesArray, RTArgs.MapNamesArray,</Highlight></CodeLine>
<Link id="l06602" /><CodeLine lineNumber="6602"><Highlight kind="normal">        RTArgs.MappersArray&#125;;</Highlight></CodeLine>
<Link id="l06603" /><CodeLine lineNumber="6603"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06604" /><CodeLine lineNumber="6604"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsStandAlone) &#123;</Highlight></CodeLine>
<Link id="l06605" /><CodeLine lineNumber="6605"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MapperFunc &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;MapperFunc missing for standalone target data&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06606" /><CodeLine lineNumber="6606"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06607" /><CodeLine lineNumber="6607"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> TaskBodyCB = &#91;&amp;&#93;(<a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;, <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;,</Highlight></CodeLine>
<Link id="l06608" /><CodeLine lineNumber="6608"><Highlight kind="normal">                            IRBuilderBase::InsertPoint) -&gt; <a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> &#123;</Highlight></CodeLine>
<Link id="l06609" /><CodeLine lineNumber="6609"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.HasNoWait) &#123;</Highlight></CodeLine>
<Link id="l06610" /><CodeLine lineNumber="6610"><Highlight kind="normal">          OffloadingArgs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(&#123;<a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>),</Highlight></CodeLine>
<Link id="l06611" /><CodeLine lineNumber="6611"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a>(VoidPtr),</Highlight></CodeLine>
<Link id="l06612" /><CodeLine lineNumber="6612"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a788a72ddbf1bd572b3fcd7a5e7ec8cff">Int32</a>),</Highlight></CodeLine>
<Link id="l06613" /><CodeLine lineNumber="6613"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">llvm::Constant::getNullValue</a>(VoidPtr)&#125;);</Highlight></CodeLine>
<Link id="l06614" /><CodeLine lineNumber="6614"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l06615" /><CodeLine lineNumber="6615"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06616" /><CodeLine lineNumber="6616"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(getOrCreateRuntimeFunctionPtr(&#42;MapperFunc),</Highlight></CodeLine>
<Link id="l06617" /><CodeLine lineNumber="6617"><Highlight kind="normal">                           OffloadingArgs);</Highlight></CodeLine>
<Link id="l06618" /><CodeLine lineNumber="6618"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06619" /><CodeLine lineNumber="6619"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.HasNoWait) &#123;</Highlight></CodeLine>
<Link id="l06620" /><CodeLine lineNumber="6620"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;OffloadContBlock =</Highlight></CodeLine>
<Link id="l06621" /><CodeLine lineNumber="6621"><Highlight kind="normal">              <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;offload.cont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06622" /><CodeLine lineNumber="6622"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;CurFn = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l06623" /><CodeLine lineNumber="6623"><Highlight kind="normal">          emitBlock(OffloadContBlock, CurFn, </Highlight><Highlight kind="comment">/&#42;IsFinished=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06624" /><CodeLine lineNumber="6624"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l06625" /><CodeLine lineNumber="6625"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l06626" /><CodeLine lineNumber="6626"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l06627" /><CodeLine lineNumber="6627"><Highlight kind="normal">      &#125;;</Highlight></CodeLine>
<Link id="l06628" /><CodeLine lineNumber="6628"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06629" /><CodeLine lineNumber="6629"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> RequiresOuterTargetTask = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.HasNoWait;</Highlight></CodeLine>
<Link id="l06630" /><CodeLine lineNumber="6630"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!RequiresOuterTargetTask)</Highlight></CodeLine>
<Link id="l06631" /><CodeLine lineNumber="6631"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(TaskBodyCB(</Highlight><Highlight kind="comment">/&#42;DeviceID=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;RTLoc=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l06632" /><CodeLine lineNumber="6632"><Highlight kind="normal">                            </Highlight><Highlight kind="comment">/&#42;TargetTaskAllocaIP=&#42;/</Highlight><Highlight kind="normal">&#123;&#125;));</Highlight></CodeLine>
<Link id="l06633" /><CodeLine lineNumber="6633"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06634" /><CodeLine lineNumber="6634"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(emitTargetTask(TaskBodyCB, DeviceID, SrcLocInfo, AllocaIP,</Highlight></CodeLine>
<Link id="l06635" /><CodeLine lineNumber="6635"><Highlight kind="normal">                                </Highlight><Highlight kind="comment">/&#42;Dependencies=&#42;/</Highlight><Highlight kind="normal">&#123;&#125;, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.HasNoWait));</Highlight></CodeLine>
<Link id="l06636" /><CodeLine lineNumber="6636"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06637" /><CodeLine lineNumber="6637"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;BeginMapperFunc = getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l06638" /><CodeLine lineNumber="6638"><Highlight kind="normal">          omp::OMPRTL&#95;&#95;&#95;tgt&#95;target&#95;data&#95;begin&#95;mapper);</Highlight></CodeLine>
<Link id="l06639" /><CodeLine lineNumber="6639"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06640" /><CodeLine lineNumber="6640"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(BeginMapperFunc, OffloadingArgs);</Highlight></CodeLine>
<Link id="l06641" /><CodeLine lineNumber="6641"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06642" /><CodeLine lineNumber="6642"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> DeviceMap : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.DevicePtrInfoMap) &#123;</Highlight></CodeLine>
<Link id="l06643" /><CodeLine lineNumber="6643"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;AllocaInst&gt;</a>(DeviceMap.second.second)) &#123;</Highlight></CodeLine>
<Link id="l06644" /><CodeLine lineNumber="6644"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;LI =</Highlight></CodeLine>
<Link id="l06645" /><CodeLine lineNumber="6645"><Highlight kind="normal">              Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), DeviceMap.second.first);</Highlight></CodeLine>
<Link id="l06646" /><CodeLine lineNumber="6646"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(LI, DeviceMap.second.second);</Highlight></CodeLine>
<Link id="l06647" /><CodeLine lineNumber="6647"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l06648" /><CodeLine lineNumber="6648"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l06649" /><CodeLine lineNumber="6649"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06650" /><CodeLine lineNumber="6650"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If device pointer privatization is required, emit the body of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06651" /><CodeLine lineNumber="6651"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// region here. It will have to be duplicated: with and without</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06652" /><CodeLine lineNumber="6652"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// privatization.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06653" /><CodeLine lineNumber="6653"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l06654" /><CodeLine lineNumber="6654"><Highlight kind="normal">          BodyGenCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), BodyGenTy::Priv);</Highlight></CodeLine>
<Link id="l06655" /><CodeLine lineNumber="6655"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l06656" /><CodeLine lineNumber="6656"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l06657" /><CodeLine lineNumber="6657"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l06658" /><CodeLine lineNumber="6658"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06659" /><CodeLine lineNumber="6659"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l06660" /><CodeLine lineNumber="6660"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l06661" /><CodeLine lineNumber="6661"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06662" /><CodeLine lineNumber="6662"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we need device pointer privatization, we need to emit the body of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06663" /><CodeLine lineNumber="6663"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// region with no privatization in the &#39;else&#39; branch of the conditional.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06664" /><CodeLine lineNumber="6664"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Otherwise, we don&#39;t have to do anything.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06665" /><CodeLine lineNumber="6665"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> BeginElseGen = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP,</Highlight></CodeLine>
<Link id="l06666" /><CodeLine lineNumber="6666"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP) -&gt; <a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> &#123;</Highlight></CodeLine>
<Link id="l06667" /><CodeLine lineNumber="6667"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l06668" /><CodeLine lineNumber="6668"><Highlight kind="normal">        BodyGenCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), BodyGenTy::DupNoPriv);</Highlight></CodeLine>
<Link id="l06669" /><CodeLine lineNumber="6669"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l06670" /><CodeLine lineNumber="6670"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l06671" /><CodeLine lineNumber="6671"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l06672" /><CodeLine lineNumber="6672"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l06673" /><CodeLine lineNumber="6673"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l06674" /><CodeLine lineNumber="6674"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06675" /><CodeLine lineNumber="6675"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Generate code for the closing of the data region.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06676" /><CodeLine lineNumber="6676"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> EndThenGen = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP) &#123;</Highlight></CodeLine>
<Link id="l06677" /><CodeLine lineNumber="6677"><Highlight kind="normal">    TargetDataRTArgs RTArgs;</Highlight></CodeLine>
<Link id="l06678" /><CodeLine lineNumber="6678"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.EmitDebug = !MapInfo-&gt;Names.empty();</Highlight></CodeLine>
<Link id="l06679" /><CodeLine lineNumber="6679"><Highlight kind="normal">    emitOffloadingArraysArgument(Builder, RTArgs, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>, </Highlight><Highlight kind="comment">/&#42;ForEndCall=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06680" /><CodeLine lineNumber="6680"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06681" /><CodeLine lineNumber="6681"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Emit the number of elements in the offloading arrays.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06682" /><CodeLine lineNumber="6682"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PointerNum = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs);</Highlight></CodeLine>
<Link id="l06683" /><CodeLine lineNumber="6683"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06684" /><CodeLine lineNumber="6684"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Source location for the ident struct</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06685" /><CodeLine lineNumber="6685"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SrcLocInfo) &#123;</Highlight></CodeLine>
<Link id="l06686" /><CodeLine lineNumber="6686"><Highlight kind="normal">      uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l06687" /><CodeLine lineNumber="6687"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(Loc, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06688" /><CodeLine lineNumber="6688"><Highlight kind="normal">      SrcLocInfo = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l06689" /><CodeLine lineNumber="6689"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06690" /><CodeLine lineNumber="6690"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06691" /><CodeLine lineNumber="6691"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OffloadingArgs&#91;&#93; = &#123;SrcLocInfo,           DeviceID,</Highlight></CodeLine>
<Link id="l06692" /><CodeLine lineNumber="6692"><Highlight kind="normal">                               PointerNum,           RTArgs.BasePointersArray,</Highlight></CodeLine>
<Link id="l06693" /><CodeLine lineNumber="6693"><Highlight kind="normal">                               RTArgs.PointersArray, RTArgs.SizesArray,</Highlight></CodeLine>
<Link id="l06694" /><CodeLine lineNumber="6694"><Highlight kind="normal">                               RTArgs.MapTypesArray, RTArgs.MapNamesArray,</Highlight></CodeLine>
<Link id="l06695" /><CodeLine lineNumber="6695"><Highlight kind="normal">                               RTArgs.MappersArray&#125;;</Highlight></CodeLine>
<Link id="l06696" /><CodeLine lineNumber="6696"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;EndMapperFunc =</Highlight></CodeLine>
<Link id="l06697" /><CodeLine lineNumber="6697"><Highlight kind="normal">        getOrCreateRuntimeFunctionPtr(omp::OMPRTL&#95;&#95;&#95;tgt&#95;target&#95;data&#95;end&#95;mapper);</Highlight></CodeLine>
<Link id="l06698" /><CodeLine lineNumber="6698"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06699" /><CodeLine lineNumber="6699"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(EndMapperFunc, OffloadingArgs);</Highlight></CodeLine>
<Link id="l06700" /><CodeLine lineNumber="6700"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l06701" /><CodeLine lineNumber="6701"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l06702" /><CodeLine lineNumber="6702"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06703" /><CodeLine lineNumber="6703"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We don&#39;t have to do anything to close the region if the if clause evaluates</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06704" /><CodeLine lineNumber="6704"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to false.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06705" /><CodeLine lineNumber="6705"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> EndElseGen = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP) &#123;</Highlight></CodeLine>
<Link id="l06706" /><CodeLine lineNumber="6706"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l06707" /><CodeLine lineNumber="6707"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l06708" /><CodeLine lineNumber="6708"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06709" /><CodeLine lineNumber="6709"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = &#91;&amp;&#93;() -&gt; <a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> &#123;</Highlight></CodeLine>
<Link id="l06710" /><CodeLine lineNumber="6710"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BodyGenCB) &#123;</Highlight></CodeLine>
<Link id="l06711" /><CodeLine lineNumber="6711"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = &#91;&amp;&#93;() &#123;</Highlight></CodeLine>
<Link id="l06712" /><CodeLine lineNumber="6712"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCond)</Highlight></CodeLine>
<Link id="l06713" /><CodeLine lineNumber="6713"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> emitIfClause(IfCond, BeginThenGen, BeginElseGen, AllocaIP);</Highlight></CodeLine>
<Link id="l06714" /><CodeLine lineNumber="6714"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> BeginThenGen(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l06715" /><CodeLine lineNumber="6715"><Highlight kind="normal">      &#125;();</Highlight></CodeLine>
<Link id="l06716" /><CodeLine lineNumber="6716"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06717" /><CodeLine lineNumber="6717"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Err)</Highlight></CodeLine>
<Link id="l06718" /><CodeLine lineNumber="6718"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l06719" /><CodeLine lineNumber="6719"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06720" /><CodeLine lineNumber="6720"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If we don&#39;t require privatization of device pointers, we emit the body</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06721" /><CodeLine lineNumber="6721"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// in between the runtime calls. This avoids duplicating the body code.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06722" /><CodeLine lineNumber="6722"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l06723" /><CodeLine lineNumber="6723"><Highlight kind="normal">          BodyGenCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), BodyGenTy::NoPriv);</Highlight></CodeLine>
<Link id="l06724" /><CodeLine lineNumber="6724"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l06725" /><CodeLine lineNumber="6725"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.takeError();</Highlight></CodeLine>
<Link id="l06726" /><CodeLine lineNumber="6726"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l06727" /><CodeLine lineNumber="6727"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06728" /><CodeLine lineNumber="6728"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCond)</Highlight></CodeLine>
<Link id="l06729" /><CodeLine lineNumber="6729"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> emitIfClause(IfCond, EndThenGen, EndElseGen, AllocaIP);</Highlight></CodeLine>
<Link id="l06730" /><CodeLine lineNumber="6730"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EndThenGen(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l06731" /><CodeLine lineNumber="6731"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06732" /><CodeLine lineNumber="6732"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfCond)</Highlight></CodeLine>
<Link id="l06733" /><CodeLine lineNumber="6733"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> emitIfClause(IfCond, BeginThenGen, EndElseGen, AllocaIP);</Highlight></CodeLine>
<Link id="l06734" /><CodeLine lineNumber="6734"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> BeginThenGen(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l06735" /><CodeLine lineNumber="6735"><Highlight kind="normal">  &#125;();</Highlight></CodeLine>
<Link id="l06736" /><CodeLine lineNumber="6736"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06737" /><CodeLine lineNumber="6737"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Err)</Highlight></CodeLine>
<Link id="l06738" /><CodeLine lineNumber="6738"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l06739" /><CodeLine lineNumber="6739"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06740" /><CodeLine lineNumber="6740"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l06741" /><CodeLine lineNumber="6741"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06742" /><CodeLine lineNumber="6742"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06743" /><CodeLine lineNumber="6743"><Highlight kind="normal"><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a></Highlight></CodeLine>
<Link id="l06744" /><CodeLine lineNumber="6744"><Highlight kind="normal">OpenMPIRBuilder::createForStaticInitFunction(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IVSize, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IVSigned,</Highlight></CodeLine>
<Link id="l06745" /><CodeLine lineNumber="6745"><Highlight kind="normal">                                             </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsGPUDistribute) &#123;</Highlight></CodeLine>
<Link id="l06746" /><CodeLine lineNumber="6746"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IVSize == 32 || IVSize == 64) &amp;&amp;</Highlight></CodeLine>
<Link id="l06747" /><CodeLine lineNumber="6747"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;IV size is not compatible with the omp runtime&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06748" /><CodeLine lineNumber="6748"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>;</Highlight></CodeLine>
<Link id="l06749" /><CodeLine lineNumber="6749"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsGPUDistribute)</Highlight></CodeLine>
<Link id="l06750" /><CodeLine lineNumber="6750"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = IVSize == 32</Highlight></CodeLine>
<Link id="l06751" /><CodeLine lineNumber="6751"><Highlight kind="normal">               ? (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;distribute&#95;static&#95;init&#95;4</Highlight></CodeLine>
<Link id="l06752" /><CodeLine lineNumber="6752"><Highlight kind="normal">                           : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;distribute&#95;static&#95;init&#95;4u)</Highlight></CodeLine>
<Link id="l06753" /><CodeLine lineNumber="6753"><Highlight kind="normal">               : (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;distribute&#95;static&#95;init&#95;8</Highlight></CodeLine>
<Link id="l06754" /><CodeLine lineNumber="6754"><Highlight kind="normal">                           : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;distribute&#95;static&#95;init&#95;8u);</Highlight></CodeLine>
<Link id="l06755" /><CodeLine lineNumber="6755"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06756" /><CodeLine lineNumber="6756"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = IVSize == 32 ? (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;init&#95;4</Highlight></CodeLine>
<Link id="l06757" /><CodeLine lineNumber="6757"><Highlight kind="normal">                                    : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;init&#95;4u)</Highlight></CodeLine>
<Link id="l06758" /><CodeLine lineNumber="6758"><Highlight kind="normal">                        : (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;init&#95;8</Highlight></CodeLine>
<Link id="l06759" /><CodeLine lineNumber="6759"><Highlight kind="normal">                                    : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;for&#95;static&#95;init&#95;8u);</Highlight></CodeLine>
<Link id="l06760" /><CodeLine lineNumber="6760"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06761" /><CodeLine lineNumber="6761"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateRuntimeFunction(M, Name);</Highlight></CodeLine>
<Link id="l06762" /><CodeLine lineNumber="6762"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06763" /><CodeLine lineNumber="6763"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06764" /><CodeLine lineNumber="6764"><Highlight kind="normal"><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> OpenMPIRBuilder::createDispatchInitFunction(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IVSize,</Highlight></CodeLine>
<Link id="l06765" /><CodeLine lineNumber="6765"><Highlight kind="normal">                                                           </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IVSigned) &#123;</Highlight></CodeLine>
<Link id="l06766" /><CodeLine lineNumber="6766"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IVSize == 32 || IVSize == 64) &amp;&amp;</Highlight></CodeLine>
<Link id="l06767" /><CodeLine lineNumber="6767"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;IV size is not compatible with the omp runtime&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06768" /><CodeLine lineNumber="6768"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = IVSize == 32</Highlight></CodeLine>
<Link id="l06769" /><CodeLine lineNumber="6769"><Highlight kind="normal">                             ? (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;init&#95;4</Highlight></CodeLine>
<Link id="l06770" /><CodeLine lineNumber="6770"><Highlight kind="normal">                                         : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;init&#95;4u)</Highlight></CodeLine>
<Link id="l06771" /><CodeLine lineNumber="6771"><Highlight kind="normal">                             : (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;init&#95;8</Highlight></CodeLine>
<Link id="l06772" /><CodeLine lineNumber="6772"><Highlight kind="normal">                                         : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;init&#95;8u);</Highlight></CodeLine>
<Link id="l06773" /><CodeLine lineNumber="6773"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06774" /><CodeLine lineNumber="6774"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateRuntimeFunction(M, Name);</Highlight></CodeLine>
<Link id="l06775" /><CodeLine lineNumber="6775"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06776" /><CodeLine lineNumber="6776"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06777" /><CodeLine lineNumber="6777"><Highlight kind="normal"><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> OpenMPIRBuilder::createDispatchNextFunction(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IVSize,</Highlight></CodeLine>
<Link id="l06778" /><CodeLine lineNumber="6778"><Highlight kind="normal">                                                           </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IVSigned) &#123;</Highlight></CodeLine>
<Link id="l06779" /><CodeLine lineNumber="6779"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IVSize == 32 || IVSize == 64) &amp;&amp;</Highlight></CodeLine>
<Link id="l06780" /><CodeLine lineNumber="6780"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;IV size is not compatible with the omp runtime&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06781" /><CodeLine lineNumber="6781"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = IVSize == 32</Highlight></CodeLine>
<Link id="l06782" /><CodeLine lineNumber="6782"><Highlight kind="normal">                             ? (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;next&#95;4</Highlight></CodeLine>
<Link id="l06783" /><CodeLine lineNumber="6783"><Highlight kind="normal">                                         : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;next&#95;4u)</Highlight></CodeLine>
<Link id="l06784" /><CodeLine lineNumber="6784"><Highlight kind="normal">                             : (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;next&#95;8</Highlight></CodeLine>
<Link id="l06785" /><CodeLine lineNumber="6785"><Highlight kind="normal">                                         : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;next&#95;8u);</Highlight></CodeLine>
<Link id="l06786" /><CodeLine lineNumber="6786"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06787" /><CodeLine lineNumber="6787"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateRuntimeFunction(M, Name);</Highlight></CodeLine>
<Link id="l06788" /><CodeLine lineNumber="6788"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06789" /><CodeLine lineNumber="6789"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06790" /><CodeLine lineNumber="6790"><Highlight kind="normal"><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> OpenMPIRBuilder::createDispatchFiniFunction(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IVSize,</Highlight></CodeLine>
<Link id="l06791" /><CodeLine lineNumber="6791"><Highlight kind="normal">                                                           </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IVSigned) &#123;</Highlight></CodeLine>
<Link id="l06792" /><CodeLine lineNumber="6792"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((IVSize == 32 || IVSize == 64) &amp;&amp;</Highlight></CodeLine>
<Link id="l06793" /><CodeLine lineNumber="6793"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;IV size is not compatible with the omp runtime&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06794" /><CodeLine lineNumber="6794"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a4c503140c7f851151906d85b515330e9">RuntimeFunction</a> <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = IVSize == 32</Highlight></CodeLine>
<Link id="l06795" /><CodeLine lineNumber="6795"><Highlight kind="normal">                             ? (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;fini&#95;4</Highlight></CodeLine>
<Link id="l06796" /><CodeLine lineNumber="6796"><Highlight kind="normal">                                         : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;fini&#95;4u)</Highlight></CodeLine>
<Link id="l06797" /><CodeLine lineNumber="6797"><Highlight kind="normal">                             : (IVSigned ? omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;fini&#95;8</Highlight></CodeLine>
<Link id="l06798" /><CodeLine lineNumber="6798"><Highlight kind="normal">                                         : omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;fini&#95;8u);</Highlight></CodeLine>
<Link id="l06799" /><CodeLine lineNumber="6799"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06800" /><CodeLine lineNumber="6800"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateRuntimeFunction(M, Name);</Highlight></CodeLine>
<Link id="l06801" /><CodeLine lineNumber="6801"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06802" /><CodeLine lineNumber="6802"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06803" /><CodeLine lineNumber="6803"><Highlight kind="normal"><a href="/docs/api/classes/llvm/functioncallee">FunctionCallee</a> OpenMPIRBuilder::createDispatchDeinitFunction() &#123;</Highlight></CodeLine>
<Link id="l06804" /><CodeLine lineNumber="6804"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> getOrCreateRuntimeFunction(M, omp::OMPRTL&#95;&#95;&#95;kmpc&#95;dispatch&#95;deinit);</Highlight></CodeLine>
<Link id="l06805" /><CodeLine lineNumber="6805"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06806" /><CodeLine lineNumber="6806"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06807" /><CodeLine lineNumber="6807" lineLink="#a3ea33750ee7de55492a5083c347e2ddb"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/expected">Expected&lt;Function &#42;&gt;</a> <a href="#a3ea33750ee7de55492a5083c347e2ddb">createOutlinedFunction</a>(</Highlight></CodeLine>
<Link id="l06808" /><CodeLine lineNumber="6808"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder, <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder,</Highlight></CodeLine>
<Link id="l06809" /><CodeLine lineNumber="6809"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OpenMPIRBuilder::TargetKernelDefaultAttrs &amp;DefaultAttrs,</Highlight></CodeLine>
<Link id="l06810" /><CodeLine lineNumber="6810"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/stringref">StringRef</a> FuncName, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;Inputs,</Highlight></CodeLine>
<Link id="l06811" /><CodeLine lineNumber="6811"><Highlight kind="normal">    OpenMPIRBuilder::TargetBodyGenCallbackTy &amp;CBFunc,</Highlight></CodeLine>
<Link id="l06812" /><CodeLine lineNumber="6812"><Highlight kind="normal">    OpenMPIRBuilder::TargetGenArgAccessorsCallbackTy &amp;ArgAccessorFuncCB) &#123;</Highlight></CodeLine>
<Link id="l06813" /><CodeLine lineNumber="6813"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Type &#42;&gt;</a> ParameterTypes;</Highlight></CodeLine>
<Link id="l06814" /><CodeLine lineNumber="6814"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OMPBuilder.Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l06815" /><CodeLine lineNumber="6815"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add the &quot;implicit&quot; runtime argument we use to provide launch specific</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06816" /><CodeLine lineNumber="6816"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// information for target devices.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06817" /><CodeLine lineNumber="6817"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Int8PtrTy = <a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>());</Highlight></CodeLine>
<Link id="l06818" /><CodeLine lineNumber="6818"><Highlight kind="normal">    ParameterTypes.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Int8PtrTy);</Highlight></CodeLine>
<Link id="l06819" /><CodeLine lineNumber="6819"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06820" /><CodeLine lineNumber="6820"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// All parameters to target devices are passed as pointers</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06821" /><CodeLine lineNumber="6821"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// or i64. This assumes 64-bit address spaces/pointers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06822" /><CodeLine lineNumber="6822"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Arg : Inputs)</Highlight></CodeLine>
<Link id="l06823" /><CodeLine lineNumber="6823"><Highlight kind="normal">      ParameterTypes.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Arg-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()</Highlight></CodeLine>
<Link id="l06824" /><CodeLine lineNumber="6824"><Highlight kind="normal">                                   ? Arg-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()</Highlight></CodeLine>
<Link id="l06825" /><CodeLine lineNumber="6825"><Highlight kind="normal">                                   : <a href="/docs/api/classes/llvm/type/#a05186fa23e4d11b9855a9599ba87a4b7">Type::getInt64Ty</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>()));</Highlight></CodeLine>
<Link id="l06826" /><CodeLine lineNumber="6826"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06827" /><CodeLine lineNumber="6827"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Arg : Inputs)</Highlight></CodeLine>
<Link id="l06828" /><CodeLine lineNumber="6828"><Highlight kind="normal">      ParameterTypes.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Arg-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>());</Highlight></CodeLine>
<Link id="l06829" /><CodeLine lineNumber="6829"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06830" /><CodeLine lineNumber="6830"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06831" /><CodeLine lineNumber="6831"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> BB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l06832" /><CodeLine lineNumber="6832"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> M = BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#afc70e919c88c86159cc94cea29b6c210">getModule</a>();</Highlight></CodeLine>
<Link id="l06833" /><CodeLine lineNumber="6833"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FuncType = <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(), ParameterTypes,</Highlight></CodeLine>
<Link id="l06834" /><CodeLine lineNumber="6834"><Highlight kind="normal">                                    </Highlight><Highlight kind="comment">/&#42;isVarArg&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06835" /><CodeLine lineNumber="6835"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Func =</Highlight></CodeLine>
<Link id="l06836" /><CodeLine lineNumber="6836"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FuncType, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a>, FuncName, M);</Highlight></CodeLine>
<Link id="l06837" /><CodeLine lineNumber="6837"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06838" /><CodeLine lineNumber="6838"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Forward target-cpu and target-features function attributes from the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06839" /><CodeLine lineNumber="6839"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// original function to the new outlined function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06840" /><CodeLine lineNumber="6840"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;ParentFn = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l06841" /><CodeLine lineNumber="6841"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06842" /><CodeLine lineNumber="6842"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> TargetCpuAttr = ParentFn-&gt;<a href="/docs/api/classes/llvm/function/#a4c319db4fe05c27cfe55bd133a87414d">getFnAttribute</a>(</Highlight><Highlight kind="stringliteral">&quot;target-cpu&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06843" /><CodeLine lineNumber="6843"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TargetCpuAttr.isStringAttribute())</Highlight></CodeLine>
<Link id="l06844" /><CodeLine lineNumber="6844"><Highlight kind="normal">    Func-&gt;addFnAttr(TargetCpuAttr);</Highlight></CodeLine>
<Link id="l06845" /><CodeLine lineNumber="6845"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06846" /><CodeLine lineNumber="6846"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> TargetFeaturesAttr = ParentFn-&gt;<a href="/docs/api/classes/llvm/function/#a4c319db4fe05c27cfe55bd133a87414d">getFnAttribute</a>(</Highlight><Highlight kind="stringliteral">&quot;target-features&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06847" /><CodeLine lineNumber="6847"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TargetFeaturesAttr.isStringAttribute())</Highlight></CodeLine>
<Link id="l06848" /><CodeLine lineNumber="6848"><Highlight kind="normal">    Func-&gt;addFnAttr(TargetFeaturesAttr);</Highlight></CodeLine>
<Link id="l06849" /><CodeLine lineNumber="6849"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06850" /><CodeLine lineNumber="6850"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OMPBuilder.Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l06851" /><CodeLine lineNumber="6851"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;ExecMode =</Highlight></CodeLine>
<Link id="l06852" /><CodeLine lineNumber="6852"><Highlight kind="normal">        OMPBuilder.emitKernelExecutionMode(FuncName, DefaultAttrs.ExecFlags);</Highlight></CodeLine>
<Link id="l06853" /><CodeLine lineNumber="6853"><Highlight kind="normal">    OMPBuilder.emitUsed(</Highlight><Highlight kind="stringliteral">&quot;llvm.compiler.used&quot;</Highlight><Highlight kind="normal">, &#123;ExecMode&#125;);</Highlight></CodeLine>
<Link id="l06854" /><CodeLine lineNumber="6854"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06855" /><CodeLine lineNumber="6855"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06856" /><CodeLine lineNumber="6856"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Save insert point.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06857" /><CodeLine lineNumber="6857"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;::InsertPointGuard</a> IPG(Builder);</Highlight></CodeLine>
<Link id="l06858" /><CodeLine lineNumber="6858"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there&#39;s a DISubprogram associated with current function, then</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06859" /><CodeLine lineNumber="6859"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// generate one for the outlined function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06860" /><CodeLine lineNumber="6860"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/function">Function</a> &#42;ParentFunc = BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>()) &#123;</Highlight></CodeLine>
<Link id="l06861" /><CodeLine lineNumber="6861"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/disubprogram">DISubprogram</a> &#42;SP = ParentFunc-&gt;<a href="/docs/api/classes/llvm/dilocalscope/#a0e0b4a5906e0bc2a7fa033548c59a220">getSubprogram</a>()) &#123;</Highlight></CodeLine>
<Link id="l06862" /><CodeLine lineNumber="6862"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/dicompileunit">DICompileUnit</a> &#42;<a href="/docs/api/namespaces/cu">CU</a> = SP-&gt;getUnit();</Highlight></CodeLine>
<Link id="l06863" /><CodeLine lineNumber="6863"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/dibuilder">DIBuilder</a> DB(&#42;M, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/cu">CU</a>);</Highlight></CodeLine>
<Link id="l06864" /><CodeLine lineNumber="6864"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a90a3242eeb2a7d1afbb5ab5bc5bfb20d">getCurrentDebugLocation</a>();</Highlight></CodeLine>
<Link id="l06865" /><CodeLine lineNumber="6865"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>) &#123;</Highlight></CodeLine>
<Link id="l06866" /><CodeLine lineNumber="6866"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// TODO: We are using nullopt for arguments at the moment. This will</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06867" /><CodeLine lineNumber="6867"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// need to be updated when debug data is being generated for variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06868" /><CodeLine lineNumber="6868"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/disubroutinetype">DISubroutineType</a> &#42;Ty =</Highlight></CodeLine>
<Link id="l06869" /><CodeLine lineNumber="6869"><Highlight kind="normal">            DB.createSubroutineType(DB.getOrCreateTypeArray(&#123;&#125;));</Highlight></CodeLine>
<Link id="l06870" /><CodeLine lineNumber="6870"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/disubprogram/#aee46b4d49ad15932fe2706f1d308d4e9">DISubprogram::DISPFlags</a> SPFlags = DISubprogram::SPFlagDefinition |</Highlight></CodeLine>
<Link id="l06871" /><CodeLine lineNumber="6871"><Highlight kind="normal">                                          DISubprogram::SPFlagOptimized |</Highlight></CodeLine>
<Link id="l06872" /><CodeLine lineNumber="6872"><Highlight kind="normal">                                          DISubprogram::SPFlagLocalToUnit;</Highlight></CodeLine>
<Link id="l06873" /><CodeLine lineNumber="6873"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06874" /><CodeLine lineNumber="6874"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/disubprogram">DISubprogram</a> &#42;OutlinedSP = DB.createFunction(</Highlight></CodeLine>
<Link id="l06875" /><CodeLine lineNumber="6875"><Highlight kind="normal">            <a href="/docs/api/namespaces/cu">CU</a>, FuncName, FuncName, SP-&gt;getFile(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getLine(), Ty,</Highlight></CodeLine>
<Link id="l06876" /><CodeLine lineNumber="6876"><Highlight kind="normal">            <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getLine(), DINode::DIFlags::FlagArtificial, SPFlags);</Highlight></CodeLine>
<Link id="l06877" /><CodeLine lineNumber="6877"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06878" /><CodeLine lineNumber="6878"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Attach subprogram to the function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06879" /><CodeLine lineNumber="6879"><Highlight kind="normal">        Func-&gt;setSubprogram(OutlinedSP);</Highlight></CodeLine>
<Link id="l06880" /><CodeLine lineNumber="6880"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Update the CurrentDebugLocation in the builder so that right scope</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06881" /><CodeLine lineNumber="6881"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// is used for things inside outlined function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06882" /><CodeLine lineNumber="6882"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a63fc74646456a3bed261512f21efe29c">SetCurrentDebugLocation</a>(</Highlight></CodeLine>
<Link id="l06883" /><CodeLine lineNumber="6883"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DILocation::get</a>(Func-&gt;getContext(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getLine(), <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getCol(),</Highlight></CodeLine>
<Link id="l06884" /><CodeLine lineNumber="6884"><Highlight kind="normal">                            OutlinedSP, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getInlinedAt()));</Highlight></CodeLine>
<Link id="l06885" /><CodeLine lineNumber="6885"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l06886" /><CodeLine lineNumber="6886"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06887" /><CodeLine lineNumber="6887"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06888" /><CodeLine lineNumber="6888"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06889" /><CodeLine lineNumber="6889"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Generate the region into the function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06890" /><CodeLine lineNumber="6890"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;EntryBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>(), </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, Func);</Highlight></CodeLine>
<Link id="l06891" /><CodeLine lineNumber="6891"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBB);</Highlight></CodeLine>
<Link id="l06892" /><CodeLine lineNumber="6892"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06893" /><CodeLine lineNumber="6893"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Insert target init call in the device compilation pass.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06894" /><CodeLine lineNumber="6894"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OMPBuilder.Config.isTargetDevice())</Highlight></CodeLine>
<Link id="l06895" /><CodeLine lineNumber="6895"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(OMPBuilder.createTargetInit(Builder, DefaultAttrs));</Highlight></CodeLine>
<Link id="l06896" /><CodeLine lineNumber="6896"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06897" /><CodeLine lineNumber="6897"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;UserCodeEntryBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l06898" /><CodeLine lineNumber="6898"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06899" /><CodeLine lineNumber="6899"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// As we embed the user code in the middle of our target region after we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06900" /><CodeLine lineNumber="6900"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// generate entry code, we must move what allocas we can into the entry</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06901" /><CodeLine lineNumber="6901"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// block to avoid possible breaking optimisations for device</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06902" /><CodeLine lineNumber="6902"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OMPBuilder.Config.isTargetDevice())</Highlight></CodeLine>
<Link id="l06903" /><CodeLine lineNumber="6903"><Highlight kind="normal">    OMPBuilder.ConstantAllocaRaiseCandidates.emplace&#95;back(Func);</Highlight></CodeLine>
<Link id="l06904" /><CodeLine lineNumber="6904"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06905" /><CodeLine lineNumber="6905"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Insert target deinit call in the device compilation pass.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06906" /><CodeLine lineNumber="6906"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;OutlinedBodyBB =</Highlight></CodeLine>
<Link id="l06907" /><CodeLine lineNumber="6907"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;outlined.body&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06908" /><CodeLine lineNumber="6908"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">llvm::OpenMPIRBuilder::InsertPointOrErrorTy</a> AfterIP = CBFunc(</Highlight></CodeLine>
<Link id="l06909" /><CodeLine lineNumber="6909"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(),</Highlight></CodeLine>
<Link id="l06910" /><CodeLine lineNumber="6910"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a>(OutlinedBodyBB, OutlinedBodyBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>()));</Highlight></CodeLine>
<Link id="l06911" /><CodeLine lineNumber="6911"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l06912" /><CodeLine lineNumber="6912"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l06913" /><CodeLine lineNumber="6913"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l06914" /><CodeLine lineNumber="6914"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OMPBuilder.Config.isTargetDevice())</Highlight></CodeLine>
<Link id="l06915" /><CodeLine lineNumber="6915"><Highlight kind="normal">    OMPBuilder.createTargetDeinit(Builder);</Highlight></CodeLine>
<Link id="l06916" /><CodeLine lineNumber="6916"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06917" /><CodeLine lineNumber="6917"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Insert return instruction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06918" /><CodeLine lineNumber="6918"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l06919" /><CodeLine lineNumber="6919"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06920" /><CodeLine lineNumber="6920"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// New Alloca IP at entry point of created device function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06921" /><CodeLine lineNumber="6921"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a362b5e6097732cbc0d2fb555a1f73400">getFirstNonPHIIt</a>());</Highlight></CodeLine>
<Link id="l06922" /><CodeLine lineNumber="6922"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> AllocaIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l06923" /><CodeLine lineNumber="6923"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06924" /><CodeLine lineNumber="6924"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(UserCodeEntryBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a50909227135ef69932bff39b8ea3f572">getFirstNonPHIOrDbg</a>());</Highlight></CodeLine>
<Link id="l06925" /><CodeLine lineNumber="6925"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06926" /><CodeLine lineNumber="6926"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Skip the artificial dyn&#95;ptr on the device.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06927" /><CodeLine lineNumber="6927"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;ArgRange =</Highlight></CodeLine>
<Link id="l06928" /><CodeLine lineNumber="6928"><Highlight kind="normal">      OMPBuilder.Config.isTargetDevice()</Highlight></CodeLine>
<Link id="l06929" /><CodeLine lineNumber="6929"><Highlight kind="normal">          ? <a href="/docs/api/namespaces/llvm/#a341215803e83773a3e97860dc291f121">make&#95;range</a>(Func-&gt;arg&#95;begin() + 1, Func-&gt;arg&#95;end())</Highlight></CodeLine>
<Link id="l06930" /><CodeLine lineNumber="6930"><Highlight kind="normal">          : Func-&gt;args();</Highlight></CodeLine>
<Link id="l06931" /><CodeLine lineNumber="6931"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06932" /><CodeLine lineNumber="6932"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> ReplaceValue = &#91;&#93;(<a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/classes/input">Input</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;InputCopy, <a href="/docs/api/classes/llvm/function">Function</a> &#42;Func) &#123;</Highlight></CodeLine>
<Link id="l06933" /><CodeLine lineNumber="6933"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Things like GEP&#39;s can come in the form of Constants. Constants and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06934" /><CodeLine lineNumber="6934"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ConstantExpr&#39;s do not have access to the knowledge of what they&#39;re</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06935" /><CodeLine lineNumber="6935"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// contained in, so we must dig a little to find an instruction so we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06936" /><CodeLine lineNumber="6936"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// can tell if they&#39;re used inside of the function we&#39;re outlining. We</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06937" /><CodeLine lineNumber="6937"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// also replace the original constant expression with a new instruction</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06938" /><CodeLine lineNumber="6938"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// equivalent; an instruction as it allows easy modification in the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06939" /><CodeLine lineNumber="6939"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// following loop, as we can now know the constant (instruction) is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06940" /><CodeLine lineNumber="6940"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// owned by our target function and replaceUsesOfWith can now be invoked</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06941" /><CodeLine lineNumber="6941"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// on it (cannot do this with constants it seems). A brand new one also</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06942" /><CodeLine lineNumber="6942"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// allows us to be cautious as it is perhaps possible the old expression</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06943" /><CodeLine lineNumber="6943"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// was used inside of the function but exists and is used externally</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06944" /><CodeLine lineNumber="6944"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// (unlikely by the nature of a Constant, but still).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06945" /><CodeLine lineNumber="6945"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// NOTE: We cannot remove dead constants that have been rewritten to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06946" /><CodeLine lineNumber="6946"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// instructions at this stage, we run the risk of breaking later lowering</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06947" /><CodeLine lineNumber="6947"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// by doing so as we could still be in the process of lowering the module</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06948" /><CodeLine lineNumber="6948"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// from MLIR to LLVM-IR and the MLIR lowering may still require the original</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06949" /><CodeLine lineNumber="6949"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// constants we have created rewritten versions of.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06950" /><CodeLine lineNumber="6950"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Const = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Constant&gt;</a>(<a href="/docs/api/classes/input">Input</a>))</Highlight></CodeLine>
<Link id="l06951" /><CodeLine lineNumber="6951"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a60cf4cd57355563164d053dd470ac00f">convertUsersOfConstantsToInstructions</a>(Const, Func, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06952" /><CodeLine lineNumber="6952"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06953" /><CodeLine lineNumber="6953"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Collect all the instructions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06954" /><CodeLine lineNumber="6954"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/user">User</a> &#42;<a href="/docs/api/classes/llvm/user">User</a> : <a href="/docs/api/namespaces/llvm/#a3d2cdc4a0db233678e7141c9d6ea3419">make&#95;early&#95;inc&#95;range</a>(<a href="/docs/api/classes/input">Input</a>-&gt;users()))</Highlight></CodeLine>
<Link id="l06955" /><CodeLine lineNumber="6955"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Instr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(<a href="/docs/api/classes/llvm/user">User</a>))</Highlight></CodeLine>
<Link id="l06956" /><CodeLine lineNumber="6956"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Instr-&gt;getFunction() == Func)</Highlight></CodeLine>
<Link id="l06957" /><CodeLine lineNumber="6957"><Highlight kind="normal">          Instr-&gt;replaceUsesOfWith(<a href="/docs/api/classes/input">Input</a>, InputCopy);</Highlight></CodeLine>
<Link id="l06958" /><CodeLine lineNumber="6958"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l06959" /><CodeLine lineNumber="6959"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06960" /><CodeLine lineNumber="6960"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;Value &#42;, Value &#42;&gt;</a>&gt; DeferredReplacement;</Highlight></CodeLine>
<Link id="l06961" /><CodeLine lineNumber="6961"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06962" /><CodeLine lineNumber="6962"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Rewrite uses of input valus to parameters.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06963" /><CodeLine lineNumber="6963"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> InArg : <a href="/docs/api/namespaces/llvm/#a06041e3bf4b0a9e8984809413ddd9506">zip</a>(Inputs, ArgRange)) &#123;</Highlight></CodeLine>
<Link id="l06964" /><CodeLine lineNumber="6964"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/classes/input">Input</a> = std::get&lt;0&gt;(InArg);</Highlight></CodeLine>
<Link id="l06965" /><CodeLine lineNumber="6965"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/argument">Argument</a> &amp;Arg = std::get&lt;1&gt;(InArg);</Highlight></CodeLine>
<Link id="l06966" /><CodeLine lineNumber="6966"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;InputCopy = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06967" /><CodeLine lineNumber="6967"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06968" /><CodeLine lineNumber="6968"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">llvm::OpenMPIRBuilder::InsertPointOrErrorTy</a> AfterIP =</Highlight></CodeLine>
<Link id="l06969" /><CodeLine lineNumber="6969"><Highlight kind="normal">        ArgAccessorFuncCB(Arg, <a href="/docs/api/classes/input">Input</a>, InputCopy, AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l06970" /><CodeLine lineNumber="6970"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AfterIP)</Highlight></CodeLine>
<Link id="l06971" /><CodeLine lineNumber="6971"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AfterIP.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l06972" /><CodeLine lineNumber="6972"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(&#42;AfterIP);</Highlight></CodeLine>
<Link id="l06973" /><CodeLine lineNumber="6973"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06974" /><CodeLine lineNumber="6974"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// In certain cases a Global may be set up for replacement, however, this</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06975" /><CodeLine lineNumber="6975"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Global may be used in multiple arguments to the kernel, just segmented</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06976" /><CodeLine lineNumber="6976"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// apart, for example, if we have a global array, that is sectioned into</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06977" /><CodeLine lineNumber="6977"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// multiple mappings (technically not legal in OpenMP, but there is a case</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06978" /><CodeLine lineNumber="6978"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// in Fortran for Common Blocks where this is neccesary), we will end up</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06979" /><CodeLine lineNumber="6979"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// with GEP&#39;s into this array inside the kernel, that refer to the Global</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06980" /><CodeLine lineNumber="6980"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// but are technically seperate arguments to the kernel for all intents and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06981" /><CodeLine lineNumber="6981"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// purposes. If we have mapped a segment that requires a GEP into the 0-th</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06982" /><CodeLine lineNumber="6982"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// index, it will fold into an referal to the Global, if we then encounter</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06983" /><CodeLine lineNumber="6983"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// this folded GEP during replacement all of the references to the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06984" /><CodeLine lineNumber="6984"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Global in the kernel will be replaced with the argument we have generated</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06985" /><CodeLine lineNumber="6985"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// that corresponds to it, including any other GEP&#39;s that refer to the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06986" /><CodeLine lineNumber="6986"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Global that may be other arguments. This will invalidate all of the other</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06987" /><CodeLine lineNumber="6987"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// preceding mapped arguments that refer to the same global that may be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06988" /><CodeLine lineNumber="6988"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// seperate segments. To prevent this, we defer global processing until all</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06989" /><CodeLine lineNumber="6989"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// other processing has been performed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06990" /><CodeLine lineNumber="6990"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">llvm::isa&lt;llvm::GlobalValue&gt;</a>(std::get&lt;0&gt;(InArg)) ||</Highlight></CodeLine>
<Link id="l06991" /><CodeLine lineNumber="6991"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">llvm::isa&lt;llvm::GlobalObject&gt;</a>(std::get&lt;0&gt;(InArg)) ||</Highlight></CodeLine>
<Link id="l06992" /><CodeLine lineNumber="6992"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">llvm::isa&lt;llvm::GlobalVariable&gt;</a>(std::get&lt;0&gt;(InArg))) &#123;</Highlight></CodeLine>
<Link id="l06993" /><CodeLine lineNumber="6993"><Highlight kind="normal">      DeferredReplacement.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(std::make&#95;pair(<a href="/docs/api/classes/input">Input</a>, InputCopy));</Highlight></CodeLine>
<Link id="l06994" /><CodeLine lineNumber="6994"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06995" /><CodeLine lineNumber="6995"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06996" /><CodeLine lineNumber="6996"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06997" /><CodeLine lineNumber="6997"><Highlight kind="normal">    ReplaceValue(<a href="/docs/api/classes/input">Input</a>, InputCopy, Func);</Highlight></CodeLine>
<Link id="l06998" /><CodeLine lineNumber="6998"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06999" /><CodeLine lineNumber="6999"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07000" /><CodeLine lineNumber="7000"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Replace all of our deferred Input values, currently just Globals.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07001" /><CodeLine lineNumber="7001"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Deferred : DeferredReplacement)</Highlight></CodeLine>
<Link id="l07002" /><CodeLine lineNumber="7002"><Highlight kind="normal">    ReplaceValue(std::get&lt;0&gt;(Deferred), std::get&lt;1&gt;(Deferred), Func);</Highlight></CodeLine>
<Link id="l07003" /><CodeLine lineNumber="7003"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07004" /><CodeLine lineNumber="7004"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Func;</Highlight></CodeLine>
<Link id="l07005" /><CodeLine lineNumber="7005"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07006" /><CodeLine lineNumber="7006"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l07007" /><CodeLine lineNumber="7007"><Highlight kind="comment">/// Create an entry point for a target task with the following.</Highlight></CodeLine>
<Link id="l07008" /><CodeLine lineNumber="7008"><Highlight kind="comment">/// It&#39;ll have the following signature</Highlight></CodeLine>
<Link id="l07009" /><CodeLine lineNumber="7009"><Highlight kind="comment">/// void @.omp&#95;target&#95;task&#95;proxy&#95;func(i32 %thread.id, ptr %task)</Highlight></CodeLine>
<Link id="l07010" /><CodeLine lineNumber="7010"><Highlight kind="comment">/// This function is called from emitTargetTask once the</Highlight></CodeLine>
<Link id="l07011" /><CodeLine lineNumber="7011"><Highlight kind="comment">/// code to launch the target kernel has been outlined already.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07012" /><CodeLine lineNumber="7012" lineLink="#a3fb4884285f5bcb9a37d9378d1e33cd5"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/function">Function</a> &#42;<a href="#a3fb4884285f5bcb9a37d9378d1e33cd5">emitTargetTaskProxyFunction</a>(<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder,</Highlight></CodeLine>
<Link id="l07013" /><CodeLine lineNumber="7013"><Highlight kind="normal">                                             <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder,</Highlight></CodeLine>
<Link id="l07014" /><CodeLine lineNumber="7014"><Highlight kind="normal">                                             <a href="/docs/api/classes/llvm/callinst">CallInst</a> &#42;StaleCI) &#123;</Highlight></CodeLine>
<Link id="l07015" /><CodeLine lineNumber="7015"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/module">Module</a> &amp;M = OMPBuilder.M;</Highlight></CodeLine>
<Link id="l07016" /><CodeLine lineNumber="7016"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// KernelLaunchFunction is the target launch function, i.e.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07017" /><CodeLine lineNumber="7017"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the function that sets up kernel arguments and calls</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07018" /><CodeLine lineNumber="7018"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#95;&#95;tgt&#95;target&#95;kernel to launch the kernel on the device.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07019" /><CodeLine lineNumber="7019"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07020" /><CodeLine lineNumber="7020"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;KernelLaunchFunction = StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#a2b1ae7cf1bafdd43d1fee4c6ad0a2913">getCalledFunction</a>();</Highlight></CodeLine>
<Link id="l07021" /><CodeLine lineNumber="7021"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07022" /><CodeLine lineNumber="7022"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// StaleCI is the CallInst which is the call to the outlined</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07023" /><CodeLine lineNumber="7023"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// target kernel launch function. If there are values that the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07024" /><CodeLine lineNumber="7024"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// outlined function uses then these are aggregated into a structure</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07025" /><CodeLine lineNumber="7025"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// which is passed as the second argument. If not, then there&#39;s</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07026" /><CodeLine lineNumber="7026"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// only one argument, the threadID. So, StaleCI can be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07027" /><CodeLine lineNumber="7027"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07028" /><CodeLine lineNumber="7028"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// %structArg = alloca &#123; ptr, ptr &#125;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07029" /><CodeLine lineNumber="7029"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// %gep&#95; = getelementptr &#123; ptr, ptr &#125;, ptr %structArg, i32 0, i32 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07030" /><CodeLine lineNumber="7030"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// store ptr %20, ptr %gep&#95;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07031" /><CodeLine lineNumber="7031"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// %gep&#95;8 = getelementptr &#123; ptr, ptr &#125;, ptr %structArg, i32 0, i32 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07032" /><CodeLine lineNumber="7032"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// store ptr %21, ptr %gep&#95;8, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07033" /><CodeLine lineNumber="7033"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// call void @&#95;QQmain..omp&#95;par.1(i32 %global.tid.val6, ptr %structArg)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07034" /><CodeLine lineNumber="7034"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07035" /><CodeLine lineNumber="7035"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// OR</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07036" /><CodeLine lineNumber="7036"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07037" /><CodeLine lineNumber="7037"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// call void @&#95;QQmain..omp&#95;par.1(i32 %global.tid.val6)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07038" /><CodeLine lineNumber="7038"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> IP(StaleCI-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>(),</Highlight></CodeLine>
<Link id="l07039" /><CodeLine lineNumber="7039"><Highlight kind="normal">                                    StaleCI-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l07040" /><CodeLine lineNumber="7040"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx = StaleCI-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;getContext();</Highlight></CodeLine>
<Link id="l07041" /><CodeLine lineNumber="7041"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;ThreadIDTy = <a href="/docs/api/classes/llvm/type/#a30dd396c5b40cd86c1591872e574ccdf">Type::getInt32Ty</a>(Ctx);</Highlight></CodeLine>
<Link id="l07042" /><CodeLine lineNumber="7042"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;TaskPtrTy = OMPBuilder.TaskPtr;</Highlight></CodeLine>
<Link id="l07043" /><CodeLine lineNumber="7043"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;TaskTy = OMPBuilder.Task;</Highlight></CodeLine>
<Link id="l07044" /><CodeLine lineNumber="7044"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> ProxyFnTy =</Highlight></CodeLine>
<Link id="l07045" /><CodeLine lineNumber="7045"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(), &#123;ThreadIDTy, TaskPtrTy&#125;,</Highlight></CodeLine>
<Link id="l07046" /><CodeLine lineNumber="7046"><Highlight kind="normal">                        </Highlight><Highlight kind="comment">/&#42; isVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07047" /><CodeLine lineNumber="7047"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> ProxyFn = <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(ProxyFnTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a>,</Highlight></CodeLine>
<Link id="l07048" /><CodeLine lineNumber="7048"><Highlight kind="normal">                                  </Highlight><Highlight kind="stringliteral">&quot;.omp&#95;target&#95;task&#95;proxy&#95;func&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l07049" /><CodeLine lineNumber="7049"><Highlight kind="normal">                                  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#afc70e919c88c86159cc94cea29b6c210">getModule</a>());</Highlight></CodeLine>
<Link id="l07050" /><CodeLine lineNumber="7050"><Highlight kind="normal">  ProxyFn-&gt;getArg(0)-&gt;setName(</Highlight><Highlight kind="stringliteral">&quot;thread.id&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07051" /><CodeLine lineNumber="7051"><Highlight kind="normal">  ProxyFn-&gt;getArg(1)-&gt;setName(</Highlight><Highlight kind="stringliteral">&quot;task&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07052" /><CodeLine lineNumber="7052"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07053" /><CodeLine lineNumber="7053"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;EntryBB =</Highlight></CodeLine>
<Link id="l07054" /><CodeLine lineNumber="7054"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>(), </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, ProxyFn);</Highlight></CodeLine>
<Link id="l07055" /><CodeLine lineNumber="7055"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBB);</Highlight></CodeLine>
<Link id="l07056" /><CodeLine lineNumber="7056"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07057" /><CodeLine lineNumber="7057"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasShareds = StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#adde2ea00dd2613ee41bfe91908e4e68e">arg&#95;size</a>() &gt; 1;</Highlight></CodeLine>
<Link id="l07058" /><CodeLine lineNumber="7058"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: This is a temporary assert to prove to ourselves that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07059" /><CodeLine lineNumber="7059"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the outlined target launch function is always going to have</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07060" /><CodeLine lineNumber="7060"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// atmost two arguments if there is any data shared between</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07061" /><CodeLine lineNumber="7061"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// host and device.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07062" /><CodeLine lineNumber="7062"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!HasShareds || (StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#adde2ea00dd2613ee41bfe91908e4e68e">arg&#95;size</a>() == 2)) &amp;&amp;</Highlight></CodeLine>
<Link id="l07063" /><CodeLine lineNumber="7063"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;StaleCI with shareds should have exactly two arguments.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07064" /><CodeLine lineNumber="7064"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShareds) &#123;</Highlight></CodeLine>
<Link id="l07065" /><CodeLine lineNumber="7065"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArgStructAlloca = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AllocaInst&gt;</a>(StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#aabd76e6a8a23a5af1ce4d3c310d88bcd">getArgOperand</a>(1));</Highlight></CodeLine>
<Link id="l07066" /><CodeLine lineNumber="7066"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ArgStructAlloca &amp;&amp;</Highlight></CodeLine>
<Link id="l07067" /><CodeLine lineNumber="7067"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Unable to find the alloca instruction corresponding to arguments &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07068" /><CodeLine lineNumber="7068"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;for extracted function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07069" /><CodeLine lineNumber="7069"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArgStructType = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;StructType&gt;</a>(ArgStructAlloca-&gt;<a href="/docs/api/classes/llvm/allocainst/#a9b5ec84ea363eca9e35ddca20a5313af">getAllocatedType</a>());</Highlight></CodeLine>
<Link id="l07070" /><CodeLine lineNumber="7070"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07071" /><CodeLine lineNumber="7071"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/allocainst">AllocaInst</a> &#42;NewArgStructAlloca =</Highlight></CodeLine>
<Link id="l07072" /><CodeLine lineNumber="7072"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(ArgStructType, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;structArg&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07073" /><CodeLine lineNumber="7073"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;TaskT = ProxyFn-&gt;getArg(1);</Highlight></CodeLine>
<Link id="l07074" /><CodeLine lineNumber="7074"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;ThreadId = ProxyFn-&gt;getArg(0);</Highlight></CodeLine>
<Link id="l07075" /><CodeLine lineNumber="7075"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;SharedsSize =</Highlight></CodeLine>
<Link id="l07076" /><CodeLine lineNumber="7076"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(M.getDataLayout().getTypeStoreSize(ArgStructType));</Highlight></CodeLine>
<Link id="l07077" /><CodeLine lineNumber="7077"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07078" /><CodeLine lineNumber="7078"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Shareds = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(TaskTy, TaskT, 0);</Highlight></CodeLine>
<Link id="l07079" /><CodeLine lineNumber="7079"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/loadinst">LoadInst</a> &#42;LoadShared =</Highlight></CodeLine>
<Link id="l07080" /><CodeLine lineNumber="7080"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(Ctx), Shareds);</Highlight></CodeLine>
<Link id="l07081" /><CodeLine lineNumber="7081"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07082" /><CodeLine lineNumber="7082"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae9f2730f66215fdb82f4e41e45124811">CreateMemCpy</a>(</Highlight></CodeLine>
<Link id="l07083" /><CodeLine lineNumber="7083"><Highlight kind="normal">        NewArgStructAlloca, NewArgStructAlloca-&gt;<a href="/docs/api/classes/llvm/allocainst/#a42438d0a43720a6571c9138224481754">getAlign</a>(), LoadShared,</Highlight></CodeLine>
<Link id="l07084" /><CodeLine lineNumber="7084"><Highlight kind="normal">        LoadShared-&gt;<a href="/docs/api/classes/llvm/value/#a47f5c74e1b14ba4a61db057400644acc">getPointerAlignment</a>(M.getDataLayout()), SharedsSize);</Highlight></CodeLine>
<Link id="l07085" /><CodeLine lineNumber="7085"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07086" /><CodeLine lineNumber="7086"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(KernelLaunchFunction, &#123;ThreadId, NewArgStructAlloca&#125;);</Highlight></CodeLine>
<Link id="l07087" /><CodeLine lineNumber="7087"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07088" /><CodeLine lineNumber="7088"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l07089" /><CodeLine lineNumber="7089"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ProxyFn;</Highlight></CodeLine>
<Link id="l07090" /><CodeLine lineNumber="7090"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07091" /><CodeLine lineNumber="7091"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07092" /><CodeLine lineNumber="7092" lineLink="#aa33db5ef74d376fb331f9549fb3cd9b3"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error">Error</a> <a href="#aa33db5ef74d376fb331f9549fb3cd9b3">emitTargetOutlinedFunction</a>(</Highlight></CodeLine>
<Link id="l07093" /><CodeLine lineNumber="7093"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder, <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsOffloadEntry,</Highlight></CodeLine>
<Link id="l07094" /><CodeLine lineNumber="7094"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp;EntryInfo,</Highlight></CodeLine>
<Link id="l07095" /><CodeLine lineNumber="7095"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OpenMPIRBuilder::TargetKernelDefaultAttrs &amp;DefaultAttrs,</Highlight></CodeLine>
<Link id="l07096" /><CodeLine lineNumber="7096"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function">Function</a> &#42;&amp;OutlinedFn, <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;&amp;OutlinedFnID,</Highlight></CodeLine>
<Link id="l07097" /><CodeLine lineNumber="7097"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;Inputs,</Highlight></CodeLine>
<Link id="l07098" /><CodeLine lineNumber="7098"><Highlight kind="normal">    OpenMPIRBuilder::TargetBodyGenCallbackTy &amp;CBFunc,</Highlight></CodeLine>
<Link id="l07099" /><CodeLine lineNumber="7099"><Highlight kind="normal">    OpenMPIRBuilder::TargetGenArgAccessorsCallbackTy &amp;ArgAccessorFuncCB) &#123;</Highlight></CodeLine>
<Link id="l07100" /><CodeLine lineNumber="7100"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07101" /><CodeLine lineNumber="7101"><Highlight kind="normal">  OpenMPIRBuilder::FunctionGenCallback &amp;&amp;GenerateOutlinedFunction =</Highlight></CodeLine>
<Link id="l07102" /><CodeLine lineNumber="7102"><Highlight kind="normal">      &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/stringref">StringRef</a> EntryFnName) &#123;</Highlight></CodeLine>
<Link id="l07103" /><CodeLine lineNumber="7103"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a3ea33750ee7de55492a5083c347e2ddb">createOutlinedFunction</a>(OMPBuilder, Builder, DefaultAttrs,</Highlight></CodeLine>
<Link id="l07104" /><CodeLine lineNumber="7104"><Highlight kind="normal">                                      EntryFnName, Inputs, CBFunc,</Highlight></CodeLine>
<Link id="l07105" /><CodeLine lineNumber="7105"><Highlight kind="normal">                                      ArgAccessorFuncCB);</Highlight></CodeLine>
<Link id="l07106" /><CodeLine lineNumber="7106"><Highlight kind="normal">      &#125;;</Highlight></CodeLine>
<Link id="l07107" /><CodeLine lineNumber="7107"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07108" /><CodeLine lineNumber="7108"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.emitTargetRegionFunction(</Highlight></CodeLine>
<Link id="l07109" /><CodeLine lineNumber="7109"><Highlight kind="normal">      EntryInfo, GenerateOutlinedFunction, IsOffloadEntry, OutlinedFn,</Highlight></CodeLine>
<Link id="l07110" /><CodeLine lineNumber="7110"><Highlight kind="normal">      OutlinedFnID);</Highlight></CodeLine>
<Link id="l07111" /><CodeLine lineNumber="7111"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07112" /><CodeLine lineNumber="7112"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07113" /><CodeLine lineNumber="7113"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::emitTargetTask(</Highlight></CodeLine>
<Link id="l07114" /><CodeLine lineNumber="7114"><Highlight kind="normal">    TargetTaskBodyCallbackTy TaskBodyCB, <a href="/docs/api/classes/llvm/value">Value</a> &#42;DeviceID, <a href="/docs/api/classes/llvm/value">Value</a> &#42;RTLoc,</Highlight></CodeLine>
<Link id="l07115" /><CodeLine lineNumber="7115"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> AllocaIP,</Highlight></CodeLine>
<Link id="l07116" /><CodeLine lineNumber="7116"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;llvm::OpenMPIRBuilder::DependData&gt;</a> &amp;Dependencies,</Highlight></CodeLine>
<Link id="l07117" /><CodeLine lineNumber="7117"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasNoWait) &#123;</Highlight></CodeLine>
<Link id="l07118" /><CodeLine lineNumber="7118"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07119" /><CodeLine lineNumber="7119"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The following explains the code-gen scenario for the &#96;target&#96; directive. A</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07120" /><CodeLine lineNumber="7120"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// similar scneario is followed for other device-related directives (e.g.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07121" /><CodeLine lineNumber="7121"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#96;target enter data&#96;) but in similar fashion since we only need to emit task</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07122" /><CodeLine lineNumber="7122"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that encapsulates the proper runtime call.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07123" /><CodeLine lineNumber="7123"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07124" /><CodeLine lineNumber="7124"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// When we arrive at this function, the target region itself has been</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07125" /><CodeLine lineNumber="7125"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// outlined into the function OutlinedFn.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07126" /><CodeLine lineNumber="7126"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// So at ths point, for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07127" /><CodeLine lineNumber="7127"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// --------------------------------------------------</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07128" /><CodeLine lineNumber="7128"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   void user&#95;code&#95;that&#95;offloads(...) &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07129" /><CodeLine lineNumber="7129"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     omp target depend(..) map(from:a) map(to:b, c)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07130" /><CodeLine lineNumber="7130"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//        a = b + c</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07131" /><CodeLine lineNumber="7131"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07132" /><CodeLine lineNumber="7132"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07133" /><CodeLine lineNumber="7133"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// --------------------------------------------------</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07134" /><CodeLine lineNumber="7134"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07135" /><CodeLine lineNumber="7135"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// we have</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07136" /><CodeLine lineNumber="7136"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07137" /><CodeLine lineNumber="7137"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// --------------------------------------------------</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07138" /><CodeLine lineNumber="7138"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07139" /><CodeLine lineNumber="7139"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   void user&#95;code&#95;that&#95;offloads(...) &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07140" /><CodeLine lineNumber="7140"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %.offload&#95;baseptrs = alloca &#91;3 x ptr&#93;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07141" /><CodeLine lineNumber="7141"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %.offload&#95;ptrs = alloca &#91;3 x ptr&#93;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07142" /><CodeLine lineNumber="7142"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %.offload&#95;mappers = alloca &#91;3 x ptr&#93;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07143" /><CodeLine lineNumber="7143"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     ;; target region has been outlined and now we need to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07144" /><CodeLine lineNumber="7144"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     ;; offload to it via a target task.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07145" /><CodeLine lineNumber="7145"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07146" /><CodeLine lineNumber="7146"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   void outlined&#95;device&#95;function(ptr a, ptr b, ptr c) &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07147" /><CodeLine lineNumber="7147"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     &#42;a = &#42;b + &#42;c</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07148" /><CodeLine lineNumber="7148"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07149" /><CodeLine lineNumber="7149"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07150" /><CodeLine lineNumber="7150"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We have to now do the following</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07151" /><CodeLine lineNumber="7151"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// (i)   Make an offloading call to outlined&#95;device&#95;function using the OpenMP</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07152" /><CodeLine lineNumber="7152"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       RTL. See &#39;kernel&#95;launch&#95;function&#39; in the pseudo code below. This is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07153" /><CodeLine lineNumber="7153"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       emitted by emitKernelLaunch</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07154" /><CodeLine lineNumber="7154"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// (ii)  Create a task entry point function that calls kernel&#95;launch&#95;function</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07155" /><CodeLine lineNumber="7155"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       and is the entry point for the target task. See</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07156" /><CodeLine lineNumber="7156"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       &#39;@.omp&#95;target&#95;task&#95;proxy&#95;func in the pseudocode below.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07157" /><CodeLine lineNumber="7157"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// (iii) Create a task with the task entry point created in (ii)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07158" /><CodeLine lineNumber="7158"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07159" /><CodeLine lineNumber="7159"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// That is we create the following</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07160" /><CodeLine lineNumber="7160"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07161" /><CodeLine lineNumber="7161"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   void user&#95;code&#95;that&#95;offloads(...) &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07162" /><CodeLine lineNumber="7162"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %.offload&#95;baseptrs = alloca &#91;3 x ptr&#93;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07163" /><CodeLine lineNumber="7163"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %.offload&#95;ptrs = alloca &#91;3 x ptr&#93;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07164" /><CodeLine lineNumber="7164"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %.offload&#95;mappers = alloca &#91;3 x ptr&#93;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07165" /><CodeLine lineNumber="7165"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07166" /><CodeLine lineNumber="7166"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %structArg = alloca &#123; ptr, ptr, ptr &#125;, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07167" /><CodeLine lineNumber="7167"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %strucArg&#91;0&#93; = %.offload&#95;baseptrs</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07168" /><CodeLine lineNumber="7168"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %strucArg&#91;1&#93; = %.offload&#95;ptrs</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07169" /><CodeLine lineNumber="7169"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %strucArg&#91;2&#93; = %.offload&#95;mappers</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07170" /><CodeLine lineNumber="7170"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     proxy&#95;target&#95;task = @&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc(...,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07171" /><CodeLine lineNumber="7171"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//                                               @.omp&#95;target&#95;task&#95;proxy&#95;func)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07172" /><CodeLine lineNumber="7172"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     memcpy(proxy&#95;target&#95;task-&gt;shareds, %structArg, sizeof(structArg))</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07173" /><CodeLine lineNumber="7173"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     dependencies&#95;array = ...</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07174" /><CodeLine lineNumber="7174"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     ;; if nowait not present</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07175" /><CodeLine lineNumber="7175"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     call @&#95;&#95;kmpc&#95;omp&#95;wait&#95;deps(..., dependencies&#95;array)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07176" /><CodeLine lineNumber="7176"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     call @&#95;&#95;kmpc&#95;omp&#95;task&#95;begin&#95;if0(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07177" /><CodeLine lineNumber="7177"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     call @ @.omp&#95;target&#95;task&#95;proxy&#95;func(i32 thread&#95;id, ptr</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07178" /><CodeLine lineNumber="7178"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     %proxy&#95;target&#95;task) call @&#95;&#95;kmpc&#95;omp&#95;task&#95;complete&#95;if0(...)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07179" /><CodeLine lineNumber="7179"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07180" /><CodeLine lineNumber="7180"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07181" /><CodeLine lineNumber="7181"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   define internal void @.omp&#95;target&#95;task&#95;proxy&#95;func(i32 %thread.id,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07182" /><CodeLine lineNumber="7182"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//                                                     ptr %task) &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07183" /><CodeLine lineNumber="7183"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       %structArg = alloca &#123;ptr, ptr, ptr&#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07184" /><CodeLine lineNumber="7184"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       %shared&#95;data = load (getelementptr %task, 0, 0)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07185" /><CodeLine lineNumber="7185"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       mempcy(%structArg, %shared&#95;data, sizeof(structArg))</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07186" /><CodeLine lineNumber="7186"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       kernel&#95;launch&#95;function(%thread.id, %structArg)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07187" /><CodeLine lineNumber="7187"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07188" /><CodeLine lineNumber="7188"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07189" /><CodeLine lineNumber="7189"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   We need the proxy function because the signature of the task entry point</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07190" /><CodeLine lineNumber="7190"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   expected by kmpc&#95;omp&#95;task is always the same and will be different from</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07191" /><CodeLine lineNumber="7191"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   that of the kernel&#95;launch function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07192" /><CodeLine lineNumber="7192"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07193" /><CodeLine lineNumber="7193"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   kernel&#95;launch&#95;function is generated by emitKernelLaunch and has the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07194" /><CodeLine lineNumber="7194"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   always&#95;inline attribute.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07195" /><CodeLine lineNumber="7195"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   void kernel&#95;launch&#95;function(thread&#95;id,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07196" /><CodeLine lineNumber="7196"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//                               structArg) alwaysinline &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07197" /><CodeLine lineNumber="7197"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       %kernel&#95;args = alloca %struct.&#95;&#95;tgt&#95;kernel&#95;arguments, align 8</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07198" /><CodeLine lineNumber="7198"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       offload&#95;baseptrs = load(getelementptr structArg, 0, 0)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07199" /><CodeLine lineNumber="7199"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       offload&#95;ptrs = load(getelementptr structArg, 0, 1)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07200" /><CodeLine lineNumber="7200"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       offload&#95;mappers = load(getelementptr structArg, 0, 2)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07201" /><CodeLine lineNumber="7201"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       ; setup kernel&#95;args using offload&#95;baseptrs, offload&#95;ptrs and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07202" /><CodeLine lineNumber="7202"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       ; offload&#95;mappers</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07203" /><CodeLine lineNumber="7203"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       call i32 @&#95;&#95;tgt&#95;target&#95;kernel(...,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07204" /><CodeLine lineNumber="7204"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//                                     outlined&#95;device&#95;function,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07205" /><CodeLine lineNumber="7205"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//                                     ptr %kernel&#95;args)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07206" /><CodeLine lineNumber="7206"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07207" /><CodeLine lineNumber="7207"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   void outlined&#95;device&#95;function(ptr a, ptr b, ptr c) &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07208" /><CodeLine lineNumber="7208"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//      &#42;a = &#42;b + &#42;c</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07209" /><CodeLine lineNumber="7209"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07210" /><CodeLine lineNumber="7210"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07211" /><CodeLine lineNumber="7211"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;TargetTaskBodyBB =</Highlight></CodeLine>
<Link id="l07212" /><CodeLine lineNumber="7212"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;target.task.body&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07213" /><CodeLine lineNumber="7213"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;TargetTaskAllocaBB =</Highlight></CodeLine>
<Link id="l07214" /><CodeLine lineNumber="7214"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;target.task.alloca&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07215" /><CodeLine lineNumber="7215"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07216" /><CodeLine lineNumber="7216"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> TargetTaskAllocaIP(TargetTaskAllocaBB,</Highlight></CodeLine>
<Link id="l07217" /><CodeLine lineNumber="7217"><Highlight kind="normal">                                   TargetTaskAllocaBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l07218" /><CodeLine lineNumber="7218"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> TargetTaskBodyIP(TargetTaskBodyBB, TargetTaskBodyBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l07219" /><CodeLine lineNumber="7219"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07220" /><CodeLine lineNumber="7220"><Highlight kind="normal">  OutlineInfo OI;</Highlight></CodeLine>
<Link id="l07221" /><CodeLine lineNumber="7221"><Highlight kind="normal">  OI.EntryBB = TargetTaskAllocaBB;</Highlight></CodeLine>
<Link id="l07222" /><CodeLine lineNumber="7222"><Highlight kind="normal">  OI.OuterAllocaBB = AllocaIP.<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a3d072f8ac5e1b0724c4bb5a77adae9da">getBlock</a>();</Highlight></CodeLine>
<Link id="l07223" /><CodeLine lineNumber="7223"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07224" /><CodeLine lineNumber="7224"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add the thread ID argument.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07225" /><CodeLine lineNumber="7225"><Highlight kind="normal">  SmallVector&lt;Instruction &#42;, 4&gt; ToBeDeleted;</Highlight></CodeLine>
<Link id="l07226" /><CodeLine lineNumber="7226"><Highlight kind="normal">  OI.ExcludeArgsFromAggregate.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="#a35409dbaffc2cf38fefec12e3cf9094d">createFakeIntVal</a>(</Highlight></CodeLine>
<Link id="l07227" /><CodeLine lineNumber="7227"><Highlight kind="normal">      Builder, AllocaIP, ToBeDeleted, TargetTaskAllocaIP, </Highlight><Highlight kind="stringliteral">&quot;global.tid&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l07228" /><CodeLine lineNumber="7228"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07229" /><CodeLine lineNumber="7229"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(TargetTaskBodyIP);</Highlight></CodeLine>
<Link id="l07230" /><CodeLine lineNumber="7230"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07231" /><CodeLine lineNumber="7231"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = TaskBodyCB(DeviceID, RTLoc, TargetTaskAllocaIP))</Highlight></CodeLine>
<Link id="l07232" /><CodeLine lineNumber="7232"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l07233" /><CodeLine lineNumber="7233"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07234" /><CodeLine lineNumber="7234"><Highlight kind="normal">  OI.ExitBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>().<a href="/docs/api/classes/llvm/irbuilderbase/insertpoint/#a3d072f8ac5e1b0724c4bb5a77adae9da">getBlock</a>();</Highlight></CodeLine>
<Link id="l07235" /><CodeLine lineNumber="7235"><Highlight kind="normal">  OI.PostOutlineCB = &#91;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, ToBeDeleted, Dependencies, HasNoWait,</Highlight></CodeLine>
<Link id="l07236" /><CodeLine lineNumber="7236"><Highlight kind="normal">                      DeviceID&#93;(<a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &amp;OutlinedFn) </Highlight><Highlight kind="keyword">mutable</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l07237" /><CodeLine lineNumber="7237"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn.<a href="/docs/api/classes/llvm/value/#aba0055050d741f60b6e0523507a2c79f">getNumUses</a>() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l07238" /><CodeLine lineNumber="7238"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;there must be a single user for the outlined function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07239" /><CodeLine lineNumber="7239"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07240" /><CodeLine lineNumber="7240"><Highlight kind="normal">    CallInst &#42;StaleCI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;CallInst&gt;</a>(OutlinedFn.<a href="/docs/api/classes/llvm/value/#a46db903db2484e1ef5062d094d6b0854">user&#95;back</a>());</Highlight></CodeLine>
<Link id="l07241" /><CodeLine lineNumber="7241"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasShareds = StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#adde2ea00dd2613ee41bfe91908e4e68e">arg&#95;size</a>() &gt; 1;</Highlight></CodeLine>
<Link id="l07242" /><CodeLine lineNumber="7242"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07243" /><CodeLine lineNumber="7243"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ProxyFn = <a href="#a3fb4884285f5bcb9a37d9378d1e33cd5">emitTargetTaskProxyFunction</a>(&#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, Builder, StaleCI);</Highlight></CodeLine>
<Link id="l07244" /><CodeLine lineNumber="7244"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07245" /><CodeLine lineNumber="7245"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Proxy task entry function created: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;ProxyFn</Highlight></CodeLine>
<Link id="l07246" /><CodeLine lineNumber="7246"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07247" /><CodeLine lineNumber="7247"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07248" /><CodeLine lineNumber="7248"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(StaleCI);</Highlight></CodeLine>
<Link id="l07249" /><CodeLine lineNumber="7249"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07250" /><CodeLine lineNumber="7250"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Gather the arguments for emitting the runtime call.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07251" /><CodeLine lineNumber="7251"><Highlight kind="normal">    uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l07252" /><CodeLine lineNumber="7252"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;SrcLocStr =</Highlight></CodeLine>
<Link id="l07253" /><CodeLine lineNumber="7253"><Highlight kind="normal">        getOrCreateSrcLocStr(<a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a>(Builder), SrcLocStrSize);</Highlight></CodeLine>
<Link id="l07254" /><CodeLine lineNumber="7254"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l07255" /><CodeLine lineNumber="7255"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07256" /><CodeLine lineNumber="7256"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// @&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc or @&#95;&#95;kmpc&#95;omp&#95;target&#95;task&#95;alloc</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07257" /><CodeLine lineNumber="7257"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07258" /><CodeLine lineNumber="7258"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If &#96;HasNoWait == true&#96;, we call  @&#95;&#95;kmpc&#95;omp&#95;target&#95;task&#95;alloc to provide</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07259" /><CodeLine lineNumber="7259"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the DeviceID to the deferred task and also since</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07260" /><CodeLine lineNumber="7260"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// @&#95;&#95;kmpc&#95;omp&#95;target&#95;task&#95;alloc creates an untied/async task.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07261" /><CodeLine lineNumber="7261"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> NeedsTargetTask = HasNoWait &amp;&amp; DeviceID;</Highlight></CodeLine>
<Link id="l07262" /><CodeLine lineNumber="7262"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskAllocFn =</Highlight></CodeLine>
<Link id="l07263" /><CodeLine lineNumber="7263"><Highlight kind="normal">        !NeedsTargetTask</Highlight></CodeLine>
<Link id="l07264" /><CodeLine lineNumber="7264"><Highlight kind="normal">            ? getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc)</Highlight></CodeLine>
<Link id="l07265" /><CodeLine lineNumber="7265"><Highlight kind="normal">            : getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l07266" /><CodeLine lineNumber="7266"><Highlight kind="normal">                  OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;target&#95;task&#95;alloc);</Highlight></CodeLine>
<Link id="l07267" /><CodeLine lineNumber="7267"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07268" /><CodeLine lineNumber="7268"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Arguments - &#96;loc&#95;ref&#96; (Ident) and &#96;gtid&#96; (ThreadID)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07269" /><CodeLine lineNumber="7269"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// call.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07270" /><CodeLine lineNumber="7270"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadID = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l07271" /><CodeLine lineNumber="7271"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07272" /><CodeLine lineNumber="7272"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Argument - &#96;sizeof&#95;kmp&#95;task&#95;t&#96; (TaskSize)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07273" /><CodeLine lineNumber="7273"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Tasksize refers to the size in bytes of kmp&#95;task&#95;t data structure</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07274" /><CodeLine lineNumber="7274"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// including private vars accessed in task.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07275" /><CodeLine lineNumber="7275"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: add kmp&#95;task&#95;t&#95;with&#95;privates (privates)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07276" /><CodeLine lineNumber="7276"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TaskSize =</Highlight></CodeLine>
<Link id="l07277" /><CodeLine lineNumber="7277"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(Task));</Highlight></CodeLine>
<Link id="l07278" /><CodeLine lineNumber="7278"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07279" /><CodeLine lineNumber="7279"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Argument - &#96;sizeof&#95;shareds&#96; (SharedsSize)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07280" /><CodeLine lineNumber="7280"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// SharedsSize refers to the shareds array size in the kmp&#95;task&#95;t data</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07281" /><CodeLine lineNumber="7281"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// structure.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07282" /><CodeLine lineNumber="7282"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SharedsSize = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(0);</Highlight></CodeLine>
<Link id="l07283" /><CodeLine lineNumber="7283"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShareds) &#123;</Highlight></CodeLine>
<Link id="l07284" /><CodeLine lineNumber="7284"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArgStructAlloca = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AllocaInst&gt;</a>(StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#aabd76e6a8a23a5af1ce4d3c310d88bcd">getArgOperand</a>(1));</Highlight></CodeLine>
<Link id="l07285" /><CodeLine lineNumber="7285"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ArgStructAlloca &amp;&amp;</Highlight></CodeLine>
<Link id="l07286" /><CodeLine lineNumber="7286"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Unable to find the alloca instruction corresponding to arguments &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07287" /><CodeLine lineNumber="7287"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;for extracted function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07288" /><CodeLine lineNumber="7288"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArgStructType =</Highlight></CodeLine>
<Link id="l07289" /><CodeLine lineNumber="7289"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StructType&gt;</a>(ArgStructAlloca-&gt;<a href="/docs/api/classes/llvm/allocainst/#a9b5ec84ea363eca9e35ddca20a5313af">getAllocatedType</a>());</Highlight></CodeLine>
<Link id="l07290" /><CodeLine lineNumber="7290"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ArgStructType &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Unable to find struct type corresponding to &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07291" /><CodeLine lineNumber="7291"><Highlight kind="normal">                              </Highlight><Highlight kind="stringliteral">&quot;arguments for extracted function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07292" /><CodeLine lineNumber="7292"><Highlight kind="normal">      SharedsSize =</Highlight></CodeLine>
<Link id="l07293" /><CodeLine lineNumber="7293"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(ArgStructType));</Highlight></CodeLine>
<Link id="l07294" /><CodeLine lineNumber="7294"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07295" /><CodeLine lineNumber="7295"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07296" /><CodeLine lineNumber="7296"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Argument - &#96;flags&#96;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07297" /><CodeLine lineNumber="7297"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is tied iff (Flags &amp; 1) == 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07298" /><CodeLine lineNumber="7298"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is untied iff (Flags &amp; 1) == 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07299" /><CodeLine lineNumber="7299"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is final iff (Flags &amp; 2) == 2</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07300" /><CodeLine lineNumber="7300"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Task is not final iff (Flags &amp; 2) == 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07301" /><CodeLine lineNumber="7301"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// A target task is not final and is untied.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07302" /><CodeLine lineNumber="7302"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(0);</Highlight></CodeLine>
<Link id="l07303" /><CodeLine lineNumber="7303"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07304" /><CodeLine lineNumber="7304"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Emit the @&#95;&#95;kmpc&#95;omp&#95;task&#95;alloc runtime call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07305" /><CodeLine lineNumber="7305"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The runtime call returns a pointer to an area where the task captured</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07306" /><CodeLine lineNumber="7306"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// variables must be copied before the task is run (TaskData)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07307" /><CodeLine lineNumber="7307"><Highlight kind="normal">    CallInst &#42;TaskData = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07308" /><CodeLine lineNumber="7308"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07309" /><CodeLine lineNumber="7309"><Highlight kind="normal">    SmallVector&lt;llvm::Value &#42;&gt; TaskAllocArgs = &#123;</Highlight></CodeLine>
<Link id="l07310" /><CodeLine lineNumber="7310"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;loc&#95;ref=&#42;/</Highlight><Highlight kind="normal">Ident,        </Highlight><Highlight kind="comment">/&#42;gtid=&#42;/</Highlight><Highlight kind="normal">ThreadID,</Highlight></CodeLine>
<Link id="l07311" /><CodeLine lineNumber="7311"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;flags=&#42;/</Highlight><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>,</Highlight></CodeLine>
<Link id="l07312" /><CodeLine lineNumber="7312"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;sizeof&#95;task=&#42;/</Highlight><Highlight kind="normal">TaskSize, </Highlight><Highlight kind="comment">/&#42;sizeof&#95;shared=&#42;/</Highlight><Highlight kind="normal">SharedsSize,</Highlight></CodeLine>
<Link id="l07313" /><CodeLine lineNumber="7313"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;task&#95;func=&#42;/</Highlight><Highlight kind="normal">ProxyFn&#125;;</Highlight></CodeLine>
<Link id="l07314" /><CodeLine lineNumber="7314"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07315" /><CodeLine lineNumber="7315"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NeedsTargetTask) &#123;</Highlight></CodeLine>
<Link id="l07316" /><CodeLine lineNumber="7316"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DeviceID &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected non-empty device ID.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07317" /><CodeLine lineNumber="7317"><Highlight kind="normal">      TaskAllocArgs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DeviceID);</Highlight></CodeLine>
<Link id="l07318" /><CodeLine lineNumber="7318"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07319" /><CodeLine lineNumber="7319"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07320" /><CodeLine lineNumber="7320"><Highlight kind="normal">    TaskData = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskAllocFn, TaskAllocArgs);</Highlight></CodeLine>
<Link id="l07321" /><CodeLine lineNumber="7321"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07322" /><CodeLine lineNumber="7322"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShareds) &#123;</Highlight></CodeLine>
<Link id="l07323" /><CodeLine lineNumber="7323"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Shareds = StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#aabd76e6a8a23a5af1ce4d3c310d88bcd">getArgOperand</a>(1);</Highlight></CodeLine>
<Link id="l07324" /><CodeLine lineNumber="7324"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/arg/key/#a6b334a5f83504ebc99cc59f4f333ff98">Align</a> Alignment = TaskData-&gt;<a href="/docs/api/classes/llvm/value/#a47f5c74e1b14ba4a61db057400644acc">getPointerAlignment</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout());</Highlight></CodeLine>
<Link id="l07325" /><CodeLine lineNumber="7325"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;TaskShareds = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(VoidPtr, TaskData);</Highlight></CodeLine>
<Link id="l07326" /><CodeLine lineNumber="7326"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae9f2730f66215fdb82f4e41e45124811">CreateMemCpy</a>(TaskShareds, Alignment, Shareds, Alignment,</Highlight></CodeLine>
<Link id="l07327" /><CodeLine lineNumber="7327"><Highlight kind="normal">                           SharedsSize);</Highlight></CodeLine>
<Link id="l07328" /><CodeLine lineNumber="7328"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07329" /><CodeLine lineNumber="7329"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07330" /><CodeLine lineNumber="7330"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DepArray = <a href="#a9702d30c99a5459e9565631adf1fdf1b">emitTaskDependencies</a>(&#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, Dependencies);</Highlight></CodeLine>
<Link id="l07331" /><CodeLine lineNumber="7331"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07332" /><CodeLine lineNumber="7332"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ---------------------------------------------------------------</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07333" /><CodeLine lineNumber="7333"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// V5.2 13.8 target construct</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07334" /><CodeLine lineNumber="7334"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If the nowait clause is present, execution of the target task</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07335" /><CodeLine lineNumber="7335"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// may be deferred. If the nowait clause is not present, the target task is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07336" /><CodeLine lineNumber="7336"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// an included task.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07337" /><CodeLine lineNumber="7337"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ---------------------------------------------------------------</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07338" /><CodeLine lineNumber="7338"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The above means that the lack of a nowait on the target construct</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07339" /><CodeLine lineNumber="7339"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// translates to &#39;#pragma omp task if(0)&#39;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07340" /><CodeLine lineNumber="7340"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!NeedsTargetTask) &#123;</Highlight></CodeLine>
<Link id="l07341" /><CodeLine lineNumber="7341"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DepArray) &#123;</Highlight></CodeLine>
<Link id="l07342" /><CodeLine lineNumber="7342"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskWaitFn =</Highlight></CodeLine>
<Link id="l07343" /><CodeLine lineNumber="7343"><Highlight kind="normal">            getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;wait&#95;deps);</Highlight></CodeLine>
<Link id="l07344" /><CodeLine lineNumber="7344"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l07345" /><CodeLine lineNumber="7345"><Highlight kind="normal">            TaskWaitFn,</Highlight></CodeLine>
<Link id="l07346" /><CodeLine lineNumber="7346"><Highlight kind="normal">            &#123;</Highlight><Highlight kind="comment">/&#42;loc&#95;ref=&#42;/</Highlight><Highlight kind="normal">Ident, </Highlight><Highlight kind="comment">/&#42;gtid=&#42;/</Highlight><Highlight kind="normal">ThreadID,</Highlight></CodeLine>
<Link id="l07347" /><CodeLine lineNumber="7347"><Highlight kind="normal">             </Highlight><Highlight kind="comment">/&#42;ndeps=&#42;/</Highlight><Highlight kind="normal">Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(Dependencies.size()),</Highlight></CodeLine>
<Link id="l07348" /><CodeLine lineNumber="7348"><Highlight kind="normal">             </Highlight><Highlight kind="comment">/&#42;dep&#95;list=&#42;/</Highlight><Highlight kind="normal">DepArray,</Highlight></CodeLine>
<Link id="l07349" /><CodeLine lineNumber="7349"><Highlight kind="normal">             </Highlight><Highlight kind="comment">/&#42;ndeps&#95;noalias=&#42;/</Highlight><Highlight kind="normal">ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), 0),</Highlight></CodeLine>
<Link id="l07350" /><CodeLine lineNumber="7350"><Highlight kind="normal">             </Highlight><Highlight kind="comment">/&#42;noalias&#95;dep&#95;list=&#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07351" /><CodeLine lineNumber="7351"><Highlight kind="normal">             <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext()))&#125;);</Highlight></CodeLine>
<Link id="l07352" /><CodeLine lineNumber="7352"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l07353" /><CodeLine lineNumber="7353"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Included task.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07354" /><CodeLine lineNumber="7354"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskBeginFn =</Highlight></CodeLine>
<Link id="l07355" /><CodeLine lineNumber="7355"><Highlight kind="normal">          getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task&#95;begin&#95;if0);</Highlight></CodeLine>
<Link id="l07356" /><CodeLine lineNumber="7356"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskCompleteFn =</Highlight></CodeLine>
<Link id="l07357" /><CodeLine lineNumber="7357"><Highlight kind="normal">          getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task&#95;complete&#95;if0);</Highlight></CodeLine>
<Link id="l07358" /><CodeLine lineNumber="7358"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskBeginFn, &#123;Ident, ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l07359" /><CodeLine lineNumber="7359"><Highlight kind="normal">      CallInst &#42;CI = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ProxyFn, &#123;ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l07360" /><CodeLine lineNumber="7360"><Highlight kind="normal">      CI-&gt;<a href="/docs/api/classes/llvm/instruction/#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(StaleCI-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</Highlight></CodeLine>
<Link id="l07361" /><CodeLine lineNumber="7361"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskCompleteFn, &#123;Ident, ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l07362" /><CodeLine lineNumber="7362"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DepArray) &#123;</Highlight></CodeLine>
<Link id="l07363" /><CodeLine lineNumber="7363"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// HasNoWait - meaning the task may be deferred. Call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07364" /><CodeLine lineNumber="7364"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// &#95;&#95;kmpc&#95;omp&#95;task&#95;with&#95;deps if there are dependencies,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07365" /><CodeLine lineNumber="7365"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// else call &#95;&#95;kmpc&#95;omp&#95;task</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07366" /><CodeLine lineNumber="7366"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskFn =</Highlight></CodeLine>
<Link id="l07367" /><CodeLine lineNumber="7367"><Highlight kind="normal">          getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task&#95;with&#95;deps);</Highlight></CodeLine>
<Link id="l07368" /><CodeLine lineNumber="7368"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l07369" /><CodeLine lineNumber="7369"><Highlight kind="normal">          TaskFn,</Highlight></CodeLine>
<Link id="l07370" /><CodeLine lineNumber="7370"><Highlight kind="normal">          &#123;Ident, ThreadID, TaskData, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(Dependencies.size()),</Highlight></CodeLine>
<Link id="l07371" /><CodeLine lineNumber="7371"><Highlight kind="normal">           DepArray, ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), 0),</Highlight></CodeLine>
<Link id="l07372" /><CodeLine lineNumber="7372"><Highlight kind="normal">           <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext()))&#125;);</Highlight></CodeLine>
<Link id="l07373" /><CodeLine lineNumber="7373"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l07374" /><CodeLine lineNumber="7374"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Emit the @&#95;&#95;kmpc&#95;omp&#95;task runtime call to spawn the task</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07375" /><CodeLine lineNumber="7375"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;TaskFn = getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;omp&#95;task);</Highlight></CodeLine>
<Link id="l07376" /><CodeLine lineNumber="7376"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(TaskFn, &#123;Ident, ThreadID, TaskData&#125;);</Highlight></CodeLine>
<Link id="l07377" /><CodeLine lineNumber="7377"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07378" /><CodeLine lineNumber="7378"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07379" /><CodeLine lineNumber="7379"><Highlight kind="normal">    StaleCI-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l07380" /><CodeLine lineNumber="7380"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (Instruction &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">llvm::reverse</a>(ToBeDeleted))</Highlight></CodeLine>
<Link id="l07381" /><CodeLine lineNumber="7381"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l07382" /><CodeLine lineNumber="7382"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l07383" /><CodeLine lineNumber="7383"><Highlight kind="normal">  addOutlineInfo(std::move(OI));</Highlight></CodeLine>
<Link id="l07384" /><CodeLine lineNumber="7384"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07385" /><CodeLine lineNumber="7385"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Insert block after emitKernelLaunch = \\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07386" /><CodeLine lineNumber="7386"><Highlight kind="normal">                    &lt;&lt; &#42;(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()) &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07387" /><CodeLine lineNumber="7387"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Module after emitKernelLaunch = \\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07388" /><CodeLine lineNumber="7388"><Highlight kind="normal">                    &lt;&lt; &#42;(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>()-&gt;<a href="/docs/api/classes/llvm/globalvalue/#a739b30c811f1eece61b05320ddf44e5b">getParent</a>())</Highlight></CodeLine>
<Link id="l07389" /><CodeLine lineNumber="7389"><Highlight kind="normal">                    &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07390" /><CodeLine lineNumber="7390"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l07391" /><CodeLine lineNumber="7391"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07392" /><CodeLine lineNumber="7392"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07393" /><CodeLine lineNumber="7393"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitOffloadingArraysAndArgs(</Highlight></CodeLine>
<Link id="l07394" /><CodeLine lineNumber="7394"><Highlight kind="normal">    InsertPointTy AllocaIP, InsertPointTy CodeGenIP, TargetDataInfo &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>,</Highlight></CodeLine>
<Link id="l07395" /><CodeLine lineNumber="7395"><Highlight kind="normal">    TargetDataRTArgs &amp;RTArgs, MapInfosTy &amp;CombinedInfo, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsNonContiguous,</Highlight></CodeLine>
<Link id="l07396" /><CodeLine lineNumber="7396"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> ForEndCall, <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;</Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal">(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/value">Value</a> &#42;)&gt; DeviceAddrCB,</Highlight></CodeLine>
<Link id="l07397" /><CodeLine lineNumber="7397"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;<a href="/docs/api/classes/llvm/value">Value</a> &#42;(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">)&gt; CustomMapperCB) &#123;</Highlight></CodeLine>
<Link id="l07398" /><CodeLine lineNumber="7398"><Highlight kind="normal">  emitOffloadingArrays(AllocaIP, CodeGenIP, CombinedInfo, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>, IsNonContiguous,</Highlight></CodeLine>
<Link id="l07399" /><CodeLine lineNumber="7399"><Highlight kind="normal">                       DeviceAddrCB, CustomMapperCB);</Highlight></CodeLine>
<Link id="l07400" /><CodeLine lineNumber="7400"><Highlight kind="normal">  emitOffloadingArraysArgument(Builder, RTArgs, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>, ForEndCall);</Highlight></CodeLine>
<Link id="l07401" /><CodeLine lineNumber="7401"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07402" /><CodeLine lineNumber="7402"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07403" /><CodeLine lineNumber="7403"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07404" /><CodeLine lineNumber="7404" lineLink="#a9acb4faf91112542d5ecf41230e9b64a"><Highlight kind="normal"><a href="#a9acb4faf91112542d5ecf41230e9b64a">emitTargetCall</a>(<a href="/docs/api/classes/llvm/openmpirbuilder">OpenMPIRBuilder</a> &amp;OMPBuilder, <a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder,</Highlight></CodeLine>
<Link id="l07405" /><CodeLine lineNumber="7405"><Highlight kind="normal">               <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> AllocaIP,</Highlight></CodeLine>
<Link id="l07406" /><CodeLine lineNumber="7406"><Highlight kind="normal">               </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OpenMPIRBuilder::TargetKernelDefaultAttrs &amp;DefaultAttrs,</Highlight></CodeLine>
<Link id="l07407" /><CodeLine lineNumber="7407"><Highlight kind="normal">               </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OpenMPIRBuilder::TargetKernelRuntimeAttrs &amp;RuntimeAttrs,</Highlight></CodeLine>
<Link id="l07408" /><CodeLine lineNumber="7408"><Highlight kind="normal">               <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCond, <a href="/docs/api/classes/llvm/function">Function</a> &#42;OutlinedFn, <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;OutlinedFnID,</Highlight></CodeLine>
<Link id="l07409" /><CodeLine lineNumber="7409"><Highlight kind="normal">               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;Args,</Highlight></CodeLine>
<Link id="l07410" /><CodeLine lineNumber="7410"><Highlight kind="normal">               OpenMPIRBuilder::GenMapInfoCallbackTy GenMapInfoCB,</Highlight></CodeLine>
<Link id="l07411" /><CodeLine lineNumber="7411"><Highlight kind="normal">               <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;llvm::OpenMPIRBuilder::DependData&gt;</a> Dependencies = &#123;&#125;,</Highlight></CodeLine>
<Link id="l07412" /><CodeLine lineNumber="7412"><Highlight kind="normal">               </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasNoWait = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l07413" /><CodeLine lineNumber="7413"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Generate a function call to the host fallback implementation of the target</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07414" /><CodeLine lineNumber="7414"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// region. This is called by the host when no offload entry was generated for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07415" /><CodeLine lineNumber="7415"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the target region and when the offloading call fails at runtime.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07416" /><CodeLine lineNumber="7416"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;EmitTargetCallFallbackCB = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> IP)</Highlight></CodeLine>
<Link id="l07417" /><CodeLine lineNumber="7417"><Highlight kind="normal">      -&gt; <a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> &#123;</Highlight></CodeLine>
<Link id="l07418" /><CodeLine lineNumber="7418"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(IP);</Highlight></CodeLine>
<Link id="l07419" /><CodeLine lineNumber="7419"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(OutlinedFn, Args);</Highlight></CodeLine>
<Link id="l07420" /><CodeLine lineNumber="7420"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l07421" /><CodeLine lineNumber="7421"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l07422" /><CodeLine lineNumber="7422"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07423" /><CodeLine lineNumber="7423"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasDependencies = Dependencies.size() &gt; 0;</Highlight></CodeLine>
<Link id="l07424" /><CodeLine lineNumber="7424"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> RequiresOuterTargetTask = HasNoWait || HasDependencies;</Highlight></CodeLine>
<Link id="l07425" /><CodeLine lineNumber="7425"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07426" /><CodeLine lineNumber="7426"><Highlight kind="normal">  OpenMPIRBuilder::TargetKernelArgs KArgs;</Highlight></CodeLine>
<Link id="l07427" /><CodeLine lineNumber="7427"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07428" /><CodeLine lineNumber="7428"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> TaskBodyCB =</Highlight></CodeLine>
<Link id="l07429" /><CodeLine lineNumber="7429"><Highlight kind="normal">      &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/value">Value</a> &#42;DeviceID, <a href="/docs/api/classes/llvm/value">Value</a> &#42;RTLoc,</Highlight></CodeLine>
<Link id="l07430" /><CodeLine lineNumber="7430"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/irbuilderbase/insertpoint">IRBuilderBase::InsertPoint</a> TargetTaskAllocaIP) -&gt; <a href="/docs/api/classes/llvm/error">Error</a> &#123;</Highlight></CodeLine>
<Link id="l07431" /><CodeLine lineNumber="7431"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Assume no error was returned because EmitTargetCallFallbackCB doesn&#39;t</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07432" /><CodeLine lineNumber="7432"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// produce any.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07433" /><CodeLine lineNumber="7433"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">llvm::OpenMPIRBuilder::InsertPointTy</a> AfterIP = <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(&#91;&amp;&#93;() &#123;</Highlight></CodeLine>
<Link id="l07434" /><CodeLine lineNumber="7434"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// emitKernelLaunch makes the necessary runtime call to offload the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07435" /><CodeLine lineNumber="7435"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// kernel. We then outline all that code into a separate function</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07436" /><CodeLine lineNumber="7436"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// (&#39;kernel&#95;launch&#95;function&#39; in the pseudo code above). This function is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07437" /><CodeLine lineNumber="7437"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// then called by the target task proxy function (see</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07438" /><CodeLine lineNumber="7438"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// &#39;@.omp&#95;target&#95;task&#95;proxy&#95;func&#39; in the pseudo code above)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07439" /><CodeLine lineNumber="7439"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// &quot;@.omp&#95;target&#95;task&#95;proxy&#95;func&#39; is generated by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07440" /><CodeLine lineNumber="7440"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// emitTargetTaskProxyFunction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07441" /><CodeLine lineNumber="7441"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OutlinedFnID)</Highlight></CodeLine>
<Link id="l07442" /><CodeLine lineNumber="7442"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.emitKernelLaunch(Builder, OutlinedFnID,</Highlight></CodeLine>
<Link id="l07443" /><CodeLine lineNumber="7443"><Highlight kind="normal">                                           EmitTargetCallFallbackCB, KArgs,</Highlight></CodeLine>
<Link id="l07444" /><CodeLine lineNumber="7444"><Highlight kind="normal">                                           DeviceID, RTLoc, TargetTaskAllocaIP);</Highlight></CodeLine>
<Link id="l07445" /><CodeLine lineNumber="7445"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// When OutlinedFnID is set to nullptr, then it&#39;s not an offloading call.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07446" /><CodeLine lineNumber="7446"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// In this case, we execute the host implementation directly.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07447" /><CodeLine lineNumber="7447"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EmitTargetCallFallbackCB(OMPBuilder.Builder.saveIP());</Highlight></CodeLine>
<Link id="l07448" /><CodeLine lineNumber="7448"><Highlight kind="normal">    &#125;());</Highlight></CodeLine>
<Link id="l07449" /><CodeLine lineNumber="7449"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07450" /><CodeLine lineNumber="7450"><Highlight kind="normal">    OMPBuilder.Builder.restoreIP(AfterIP);</Highlight></CodeLine>
<Link id="l07451" /><CodeLine lineNumber="7451"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l07452" /><CodeLine lineNumber="7452"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l07453" /><CodeLine lineNumber="7453"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07454" /><CodeLine lineNumber="7454"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;EmitTargetCallElse =</Highlight></CodeLine>
<Link id="l07455" /><CodeLine lineNumber="7455"><Highlight kind="normal">      &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> AllocaIP,</Highlight></CodeLine>
<Link id="l07456" /><CodeLine lineNumber="7456"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> CodeGenIP) -&gt; <a href="/docs/api/classes/llvm/error">Error</a> &#123;</Highlight></CodeLine>
<Link id="l07457" /><CodeLine lineNumber="7457"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Assume no error was returned because EmitTargetCallFallbackCB doesn&#39;t</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07458" /><CodeLine lineNumber="7458"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// produce any.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07459" /><CodeLine lineNumber="7459"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> AfterIP = <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(&#91;&amp;&#93;() &#123;</Highlight></CodeLine>
<Link id="l07460" /><CodeLine lineNumber="7460"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RequiresOuterTargetTask) &#123;</Highlight></CodeLine>
<Link id="l07461" /><CodeLine lineNumber="7461"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Arguments that are intended to be directly forwarded to an</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07462" /><CodeLine lineNumber="7462"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// emitKernelLaunch call are pased as nullptr, since</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07463" /><CodeLine lineNumber="7463"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// OutlinedFnID=nullptr results in that call not being done.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07464" /><CodeLine lineNumber="7464"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.emitTargetTask(TaskBodyCB, </Highlight><Highlight kind="comment">/&#42;DeviceID=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l07465" /><CodeLine lineNumber="7465"><Highlight kind="normal">                                         </Highlight><Highlight kind="comment">/&#42;RTLoc=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, AllocaIP,</Highlight></CodeLine>
<Link id="l07466" /><CodeLine lineNumber="7466"><Highlight kind="normal">                                         Dependencies, HasNoWait);</Highlight></CodeLine>
<Link id="l07467" /><CodeLine lineNumber="7467"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l07468" /><CodeLine lineNumber="7468"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> EmitTargetCallFallbackCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l07469" /><CodeLine lineNumber="7469"><Highlight kind="normal">    &#125;());</Highlight></CodeLine>
<Link id="l07470" /><CodeLine lineNumber="7470"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07471" /><CodeLine lineNumber="7471"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AfterIP);</Highlight></CodeLine>
<Link id="l07472" /><CodeLine lineNumber="7472"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l07473" /><CodeLine lineNumber="7473"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l07474" /><CodeLine lineNumber="7474"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07475" /><CodeLine lineNumber="7475"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;EmitTargetCallThen =</Highlight></CodeLine>
<Link id="l07476" /><CodeLine lineNumber="7476"><Highlight kind="normal">      &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> AllocaIP,</Highlight></CodeLine>
<Link id="l07477" /><CodeLine lineNumber="7477"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> CodeGenIP) -&gt; <a href="/docs/api/classes/llvm/error">Error</a> &#123;</Highlight></CodeLine>
<Link id="l07478" /><CodeLine lineNumber="7478"><Highlight kind="normal">    OpenMPIRBuilder::TargetDataInfo <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>(</Highlight></CodeLine>
<Link id="l07479" /><CodeLine lineNumber="7479"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;RequiresDevicePointerInfo=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l07480" /><CodeLine lineNumber="7480"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;SeparateBeginEndCalls=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07481" /><CodeLine lineNumber="7481"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07482" /><CodeLine lineNumber="7482"><Highlight kind="normal">    OpenMPIRBuilder::MapInfosTy &amp;MapInfo = GenMapInfoCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l07483" /><CodeLine lineNumber="7483"><Highlight kind="normal">    OpenMPIRBuilder::TargetDataRTArgs RTArgs;</Highlight></CodeLine>
<Link id="l07484" /><CodeLine lineNumber="7484"><Highlight kind="normal">    OMPBuilder.emitOffloadingArraysAndArgs(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>,</Highlight></CodeLine>
<Link id="l07485" /><CodeLine lineNumber="7485"><Highlight kind="normal">                                           RTArgs, MapInfo,</Highlight></CodeLine>
<Link id="l07486" /><CodeLine lineNumber="7486"><Highlight kind="normal">                                           </Highlight><Highlight kind="comment">/&#42;IsNonContiguous=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l07487" /><CodeLine lineNumber="7487"><Highlight kind="normal">                                           </Highlight><Highlight kind="comment">/&#42;ForEndCall=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07488" /><CodeLine lineNumber="7488"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07489" /><CodeLine lineNumber="7489"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 3&gt;</a> NumTeamsC;</Highlight></CodeLine>
<Link id="l07490" /><CodeLine lineNumber="7490"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#91;<a href="/docs/api/files/lib/lib/target/lib/target/spirv/spirvmoduleanalysis-cpp/#a96647e6d55adc897b4c8e563f7b0168a">DefaultVal</a>, RuntimeVal&#93; :</Highlight></CodeLine>
<Link id="l07491" /><CodeLine lineNumber="7491"><Highlight kind="normal">         <a href="/docs/api/namespaces/llvm/#a19010bf2388f505d1262e23f9f87a813">zip&#95;equal</a>(DefaultAttrs.MaxTeams, RuntimeAttrs.MaxTeams))</Highlight></CodeLine>
<Link id="l07492" /><CodeLine lineNumber="7492"><Highlight kind="normal">      NumTeamsC.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(RuntimeVal ? RuntimeVal</Highlight></CodeLine>
<Link id="l07493" /><CodeLine lineNumber="7493"><Highlight kind="normal">                                     : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(<a href="/docs/api/files/lib/lib/target/lib/target/spirv/spirvmoduleanalysis-cpp/#a96647e6d55adc897b4c8e563f7b0168a">DefaultVal</a>));</Highlight></CodeLine>
<Link id="l07494" /><CodeLine lineNumber="7494"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07495" /><CodeLine lineNumber="7495"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Calculate number of threads: 0 if no clauses specified, otherwise it is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07496" /><CodeLine lineNumber="7496"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the minimum between optional THREAD&#95;LIMIT and NUM&#95;THREADS clauses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07497" /><CodeLine lineNumber="7497"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> InitMaxThreadsClause = &#91;&amp;Builder&#93;(<a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/classes/llvm/clause">Clause</a>) &#123;</Highlight></CodeLine>
<Link id="l07498" /><CodeLine lineNumber="7498"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/clause">Clause</a>)</Highlight></CodeLine>
<Link id="l07499" /><CodeLine lineNumber="7499"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/clause">Clause</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac79ca3c2d2d74cf33684397a91846564">CreateIntCast</a>(<a href="/docs/api/classes/llvm/clause">Clause</a>, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(),</Highlight></CodeLine>
<Link id="l07500" /><CodeLine lineNumber="7500"><Highlight kind="normal">                                       </Highlight><Highlight kind="comment">/&#42;isSigned=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07501" /><CodeLine lineNumber="7501"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/clause">Clause</a>;</Highlight></CodeLine>
<Link id="l07502" /><CodeLine lineNumber="7502"><Highlight kind="normal">    &#125;;</Highlight></CodeLine>
<Link id="l07503" /><CodeLine lineNumber="7503"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> CombineMaxThreadsClauses = &#91;&amp;Builder&#93;(<a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/classes/llvm/clause">Clause</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;&amp;<a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>) &#123;</Highlight></CodeLine>
<Link id="l07504" /><CodeLine lineNumber="7504"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/clause">Clause</a>)</Highlight></CodeLine>
<Link id="l07505" /><CodeLine lineNumber="7505"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> =</Highlight></CodeLine>
<Link id="l07506" /><CodeLine lineNumber="7506"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> ? Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a09b4daefdf5b73efba51ce7ae6cd45c5">CreateICmpULT</a>(Result, <a href="/docs/api/classes/llvm/clause">Clause</a>),</Highlight></CodeLine>
<Link id="l07507" /><CodeLine lineNumber="7507"><Highlight kind="normal">                                          Result, <a href="/docs/api/classes/llvm/clause">Clause</a>)</Highlight></CodeLine>
<Link id="l07508" /><CodeLine lineNumber="7508"><Highlight kind="normal">                   : <a href="/docs/api/classes/llvm/clause">Clause</a>;</Highlight></CodeLine>
<Link id="l07509" /><CodeLine lineNumber="7509"><Highlight kind="normal">    &#125;;</Highlight></CodeLine>
<Link id="l07510" /><CodeLine lineNumber="7510"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07511" /><CodeLine lineNumber="7511"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If a multi-dimensional THREAD&#95;LIMIT is set, it is the OMPX&#95;BARE case, so</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07512" /><CodeLine lineNumber="7512"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the NUM&#95;THREADS clause is overriden by THREAD&#95;LIMIT.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07513" /><CodeLine lineNumber="7513"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 3&gt;</a> NumThreadsC;</Highlight></CodeLine>
<Link id="l07514" /><CodeLine lineNumber="7514"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;MaxThreadsClause =</Highlight></CodeLine>
<Link id="l07515" /><CodeLine lineNumber="7515"><Highlight kind="normal">        RuntimeAttrs.TeamsThreadLimit.size() == 1</Highlight></CodeLine>
<Link id="l07516" /><CodeLine lineNumber="7516"><Highlight kind="normal">            ? InitMaxThreadsClause(RuntimeAttrs.MaxThreads)</Highlight></CodeLine>
<Link id="l07517" /><CodeLine lineNumber="7517"><Highlight kind="normal">            : nullptr;</Highlight></CodeLine>
<Link id="l07518" /><CodeLine lineNumber="7518"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07519" /><CodeLine lineNumber="7519"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#91;TeamsVal, TargetVal&#93; : <a href="/docs/api/namespaces/llvm/#a19010bf2388f505d1262e23f9f87a813">zip&#95;equal</a>(</Highlight></CodeLine>
<Link id="l07520" /><CodeLine lineNumber="7520"><Highlight kind="normal">             RuntimeAttrs.TeamsThreadLimit, RuntimeAttrs.TargetThreadLimit)) &#123;</Highlight></CodeLine>
<Link id="l07521" /><CodeLine lineNumber="7521"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;TeamsThreadLimitClause = InitMaxThreadsClause(TeamsVal);</Highlight></CodeLine>
<Link id="l07522" /><CodeLine lineNumber="7522"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/anonymous-dxiltranslatemetadata-cpp-/#a727514c8260cb30e2d8c17e735a46580a97b726142463c564db260b0b7a67c584">NumThreads</a> = InitMaxThreadsClause(TargetVal);</Highlight></CodeLine>
<Link id="l07523" /><CodeLine lineNumber="7523"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07524" /><CodeLine lineNumber="7524"><Highlight kind="normal">      CombineMaxThreadsClauses(TeamsThreadLimitClause, NumThreads);</Highlight></CodeLine>
<Link id="l07525" /><CodeLine lineNumber="7525"><Highlight kind="normal">      CombineMaxThreadsClauses(MaxThreadsClause, NumThreads);</Highlight></CodeLine>
<Link id="l07526" /><CodeLine lineNumber="7526"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07527" /><CodeLine lineNumber="7527"><Highlight kind="normal">      NumThreadsC.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NumThreads ? NumThreads : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(0));</Highlight></CodeLine>
<Link id="l07528" /><CodeLine lineNumber="7528"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07529" /><CodeLine lineNumber="7529"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07530" /><CodeLine lineNumber="7530"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumTargetItems = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs;</Highlight></CodeLine>
<Link id="l07531" /><CodeLine lineNumber="7531"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Use correct device ID</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07532" /><CodeLine lineNumber="7532"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;DeviceID = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/namespaces/llvm/omp/#a032f350e065d895f441c08affb57c2bea1e9b5a418e27440a8248a21894ff2932">OMP&#95;DEVICEID&#95;UNDEF</a>);</Highlight></CodeLine>
<Link id="l07533" /><CodeLine lineNumber="7533"><Highlight kind="normal">    uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l07534" /><CodeLine lineNumber="7534"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = OMPBuilder.getOrCreateDefaultSrcLocStr(SrcLocStrSize);</Highlight></CodeLine>
<Link id="l07535" /><CodeLine lineNumber="7535"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;RTLoc = OMPBuilder.getOrCreateIdent(SrcLocStr, SrcLocStrSize,</Highlight></CodeLine>
<Link id="l07536" /><CodeLine lineNumber="7536"><Highlight kind="normal">                                               <a href="/docs/api/namespaces/llvm/omp/#a0e821d8251c97d66ca185efe2f8ffde2">llvm::omp::IdentFlag</a>(0), 0);</Highlight></CodeLine>
<Link id="l07537" /><CodeLine lineNumber="7537"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07538" /><CodeLine lineNumber="7538"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount = RuntimeAttrs.LoopTripCount</Highlight></CodeLine>
<Link id="l07539" /><CodeLine lineNumber="7539"><Highlight kind="normal">                           ? Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac79ca3c2d2d74cf33684397a91846564">CreateIntCast</a>(RuntimeAttrs.LoopTripCount,</Highlight></CodeLine>
<Link id="l07540" /><CodeLine lineNumber="7540"><Highlight kind="normal">                                                   Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>(),</Highlight></CodeLine>
<Link id="l07541" /><CodeLine lineNumber="7541"><Highlight kind="normal">                                                   </Highlight><Highlight kind="comment">/&#42;isSigned=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l07542" /><CodeLine lineNumber="7542"><Highlight kind="normal">                           : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(0);</Highlight></CodeLine>
<Link id="l07543" /><CodeLine lineNumber="7543"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07544" /><CodeLine lineNumber="7544"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Use correct DynCGGroupMem</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07545" /><CodeLine lineNumber="7545"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;DynCGGroupMem = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(0);</Highlight></CodeLine>
<Link id="l07546" /><CodeLine lineNumber="7546"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07547" /><CodeLine lineNumber="7547"><Highlight kind="normal">    KArgs = OpenMPIRBuilder::TargetKernelArgs(NumTargetItems, RTArgs, TripCount,</Highlight></CodeLine>
<Link id="l07548" /><CodeLine lineNumber="7548"><Highlight kind="normal">                                              NumTeamsC, NumThreadsC,</Highlight></CodeLine>
<Link id="l07549" /><CodeLine lineNumber="7549"><Highlight kind="normal">                                              DynCGGroupMem, HasNoWait);</Highlight></CodeLine>
<Link id="l07550" /><CodeLine lineNumber="7550"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07551" /><CodeLine lineNumber="7551"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Assume no error was returned because TaskBodyCB and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07552" /><CodeLine lineNumber="7552"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// EmitTargetCallFallbackCB don&#39;t produce any.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07553" /><CodeLine lineNumber="7553"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> AfterIP = <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(&#91;&amp;&#93;() &#123;</Highlight></CodeLine>
<Link id="l07554" /><CodeLine lineNumber="7554"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// The presence of certain clauses on the target directive require the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07555" /><CodeLine lineNumber="7555"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// explicit generation of the target task.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07556" /><CodeLine lineNumber="7556"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RequiresOuterTargetTask)</Highlight></CodeLine>
<Link id="l07557" /><CodeLine lineNumber="7557"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.emitTargetTask(TaskBodyCB, DeviceID, RTLoc, AllocaIP,</Highlight></CodeLine>
<Link id="l07558" /><CodeLine lineNumber="7558"><Highlight kind="normal">                                         Dependencies, HasNoWait);</Highlight></CodeLine>
<Link id="l07559" /><CodeLine lineNumber="7559"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07560" /><CodeLine lineNumber="7560"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OMPBuilder.emitKernelLaunch(Builder, OutlinedFnID,</Highlight></CodeLine>
<Link id="l07561" /><CodeLine lineNumber="7561"><Highlight kind="normal">                                         EmitTargetCallFallbackCB, KArgs,</Highlight></CodeLine>
<Link id="l07562" /><CodeLine lineNumber="7562"><Highlight kind="normal">                                         DeviceID, RTLoc, AllocaIP);</Highlight></CodeLine>
<Link id="l07563" /><CodeLine lineNumber="7563"><Highlight kind="normal">    &#125;());</Highlight></CodeLine>
<Link id="l07564" /><CodeLine lineNumber="7564"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07565" /><CodeLine lineNumber="7565"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AfterIP);</Highlight></CodeLine>
<Link id="l07566" /><CodeLine lineNumber="7566"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l07567" /><CodeLine lineNumber="7567"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l07568" /><CodeLine lineNumber="7568"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07569" /><CodeLine lineNumber="7569"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we don&#39;t have an ID for the target region, it means an offload entry</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07570" /><CodeLine lineNumber="7570"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// wasn&#39;t created. In this case we just run the host fallback directly and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07571" /><CodeLine lineNumber="7571"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ignore any potential &#39;if&#39; clauses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07572" /><CodeLine lineNumber="7572"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!OutlinedFnID) &#123;</Highlight></CodeLine>
<Link id="l07573" /><CodeLine lineNumber="7573"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(EmitTargetCallElse(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()));</Highlight></CodeLine>
<Link id="l07574" /><CodeLine lineNumber="7574"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07575" /><CodeLine lineNumber="7575"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07576" /><CodeLine lineNumber="7576"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07577" /><CodeLine lineNumber="7577"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there&#39;s no &#39;if&#39; clause, only generate the kernel launch code path.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07578" /><CodeLine lineNumber="7578"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IfCond) &#123;</Highlight></CodeLine>
<Link id="l07579" /><CodeLine lineNumber="7579"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(EmitTargetCallThen(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()));</Highlight></CodeLine>
<Link id="l07580" /><CodeLine lineNumber="7580"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07581" /><CodeLine lineNumber="7581"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07582" /><CodeLine lineNumber="7582"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07583" /><CodeLine lineNumber="7583"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#aa1e1474f15df639f0d874b21f15666f7">cantFail</a>(OMPBuilder.emitIfClause(IfCond, EmitTargetCallThen,</Highlight></CodeLine>
<Link id="l07584" /><CodeLine lineNumber="7584"><Highlight kind="normal">                                   EmitTargetCallElse, AllocaIP));</Highlight></CodeLine>
<Link id="l07585" /><CodeLine lineNumber="7585"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07586" /><CodeLine lineNumber="7586"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07587" /><CodeLine lineNumber="7587"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> OpenMPIRBuilder::createTarget(</Highlight></CodeLine>
<Link id="l07588" /><CodeLine lineNumber="7588"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsOffloadEntry, InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l07589" /><CodeLine lineNumber="7589"><Highlight kind="normal">    InsertPointTy CodeGenIP, <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp;EntryInfo,</Highlight></CodeLine>
<Link id="l07590" /><CodeLine lineNumber="7590"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> TargetKernelDefaultAttrs &amp;DefaultAttrs,</Highlight></CodeLine>
<Link id="l07591" /><CodeLine lineNumber="7591"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> TargetKernelRuntimeAttrs &amp;RuntimeAttrs, <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfCond,</Highlight></CodeLine>
<Link id="l07592" /><CodeLine lineNumber="7592"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;Args, GenMapInfoCallbackTy GenMapInfoCB,</Highlight></CodeLine>
<Link id="l07593" /><CodeLine lineNumber="7593"><Highlight kind="normal">    OpenMPIRBuilder::TargetBodyGenCallbackTy CBFunc,</Highlight></CodeLine>
<Link id="l07594" /><CodeLine lineNumber="7594"><Highlight kind="normal">    OpenMPIRBuilder::TargetGenArgAccessorsCallbackTy ArgAccessorFuncCB,</Highlight></CodeLine>
<Link id="l07595" /><CodeLine lineNumber="7595"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;DependData&gt;</a> Dependencies, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasNowait) &#123;</Highlight></CodeLine>
<Link id="l07596" /><CodeLine lineNumber="7596"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07597" /><CodeLine lineNumber="7597"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l07598" /><CodeLine lineNumber="7598"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l07599" /><CodeLine lineNumber="7599"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07600" /><CodeLine lineNumber="7600"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l07601" /><CodeLine lineNumber="7601"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07602" /><CodeLine lineNumber="7602"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;OutlinedFn;</Highlight></CodeLine>
<Link id="l07603" /><CodeLine lineNumber="7603"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/omp/#a8c6f525466cc262e00c409c31f9a4272acb17869fe51048b5a5c4c6106551a255">Constant</a> &#42;OutlinedFnID = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07604" /><CodeLine lineNumber="7604"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The target region is outlined into its own function. The LLVM IR for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07605" /><CodeLine lineNumber="7605"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the target region itself is generated using the callbacks CBFunc</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07606" /><CodeLine lineNumber="7606"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and ArgAccessorFuncCB</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07607" /><CodeLine lineNumber="7607"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = <a href="#aa33db5ef74d376fb331f9549fb3cd9b3">emitTargetOutlinedFunction</a>(</Highlight></CodeLine>
<Link id="l07608" /><CodeLine lineNumber="7608"><Highlight kind="normal">          &#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, Builder, IsOffloadEntry, EntryInfo, DefaultAttrs, OutlinedFn,</Highlight></CodeLine>
<Link id="l07609" /><CodeLine lineNumber="7609"><Highlight kind="normal">          OutlinedFnID, Args, CBFunc, ArgAccessorFuncCB))</Highlight></CodeLine>
<Link id="l07610" /><CodeLine lineNumber="7610"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l07611" /><CodeLine lineNumber="7611"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07612" /><CodeLine lineNumber="7612"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we are not on the target device, then we need to generate code</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07613" /><CodeLine lineNumber="7613"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to make a remote call (offload) to the previously outlined function</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07614" /><CodeLine lineNumber="7614"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that represents the target region. Do that now.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07615" /><CodeLine lineNumber="7615"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Config.isTargetDevice())</Highlight></CodeLine>
<Link id="l07616" /><CodeLine lineNumber="7616"><Highlight kind="normal">    <a href="#a9acb4faf91112542d5ecf41230e9b64a">emitTargetCall</a>(&#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, Builder, AllocaIP, DefaultAttrs, RuntimeAttrs, IfCond,</Highlight></CodeLine>
<Link id="l07617" /><CodeLine lineNumber="7617"><Highlight kind="normal">                   OutlinedFn, OutlinedFnID, Args, GenMapInfoCB, Dependencies,</Highlight></CodeLine>
<Link id="l07618" /><CodeLine lineNumber="7618"><Highlight kind="normal">                   HasNowait);</Highlight></CodeLine>
<Link id="l07619" /><CodeLine lineNumber="7619"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l07620" /><CodeLine lineNumber="7620"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07621" /><CodeLine lineNumber="7621"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07622" /><CodeLine lineNumber="7622"><Highlight kind="normal">std::string OpenMPIRBuilder::getNameWithSeparators(<a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;StringRef&gt;</a> Parts,</Highlight></CodeLine>
<Link id="l07623" /><CodeLine lineNumber="7623"><Highlight kind="normal">                                                   <a href="/docs/api/classes/llvm/stringref">StringRef</a> FirstSeparator,</Highlight></CodeLine>
<Link id="l07624" /><CodeLine lineNumber="7624"><Highlight kind="normal">                                                   <a href="/docs/api/classes/llvm/stringref">StringRef</a> Separator) &#123;</Highlight></CodeLine>
<Link id="l07625" /><CodeLine lineNumber="7625"><Highlight kind="normal">  SmallString&lt;128&gt; Buffer;</Highlight></CodeLine>
<Link id="l07626" /><CodeLine lineNumber="7626"><Highlight kind="normal">  llvm::raw&#95;svector&#95;ostream OS(Buffer);</Highlight></CodeLine>
<Link id="l07627" /><CodeLine lineNumber="7627"><Highlight kind="normal">  StringRef Sep = FirstSeparator;</Highlight></CodeLine>
<Link id="l07628" /><CodeLine lineNumber="7628"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (StringRef Part : Parts) &#123;</Highlight></CodeLine>
<Link id="l07629" /><CodeLine lineNumber="7629"><Highlight kind="normal">    OS &lt;&lt; Sep &lt;&lt; Part;</Highlight></CodeLine>
<Link id="l07630" /><CodeLine lineNumber="7630"><Highlight kind="normal">    Sep = Separator;</Highlight></CodeLine>
<Link id="l07631" /><CodeLine lineNumber="7631"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07632" /><CodeLine lineNumber="7632"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OS.<a href="/docs/api/classes/llvm/stringref/#a223dd14e7d12bc5cea01889b972a98b2">str</a>().str();</Highlight></CodeLine>
<Link id="l07633" /><CodeLine lineNumber="7633"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07634" /><CodeLine lineNumber="7634"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07635" /><CodeLine lineNumber="7635"><Highlight kind="normal">std::string</Highlight></CodeLine>
<Link id="l07636" /><CodeLine lineNumber="7636" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">OpenMPIRBuilder::createPlatformSpecificName</a>(<a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;StringRef&gt;</a> Parts)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l07637" /><CodeLine lineNumber="7637"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OpenMPIRBuilder::getNameWithSeparators(Parts, Config.firstSeparator(),</Highlight></CodeLine>
<Link id="l07638" /><CodeLine lineNumber="7638"><Highlight kind="normal">                                                Config.separator());</Highlight></CodeLine>
<Link id="l07639" /><CodeLine lineNumber="7639"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07640" /><CodeLine lineNumber="7640"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07641" /><CodeLine lineNumber="7641"><Highlight kind="normal"><a href="/docs/api/classes/llvm/globalvariable">GlobalVariable</a> &#42;</Highlight></CodeLine>
<Link id="l07642" /><CodeLine lineNumber="7642" lineLink="/docs/api/classes/llvm/openmpirbuilder/#aa5ef00e5a7487cc6c5bfed0f301fa1cc"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aa5ef00e5a7487cc6c5bfed0f301fa1cc">OpenMPIRBuilder::getOrCreateInternalVariable</a>(<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/stringref">StringRef</a> &amp;Name,</Highlight></CodeLine>
<Link id="l07643" /><CodeLine lineNumber="7643"><Highlight kind="normal">                                             </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/nvptxas/#ad7d00b71af84502be65ae2de3f8d91dc">AddressSpace</a>) &#123;</Highlight></CodeLine>
<Link id="l07644" /><CodeLine lineNumber="7644"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Elem = &#42;InternalVars.try&#95;emplace(Name, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">).first;</Highlight></CodeLine>
<Link id="l07645" /><CodeLine lineNumber="7645"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Elem.second) &#123;</Highlight></CodeLine>
<Link id="l07646" /><CodeLine lineNumber="7646"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Elem.second-&gt;getValueType() == Ty &amp;&amp;</Highlight></CodeLine>
<Link id="l07647" /><CodeLine lineNumber="7647"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;OMP internal variable has different type than requested&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07648" /><CodeLine lineNumber="7648"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l07649" /><CodeLine lineNumber="7649"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: investigate the appropriate linkage type used for the global</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07650" /><CodeLine lineNumber="7650"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// variable for possibly changing that to internal or private, or maybe</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07651" /><CodeLine lineNumber="7651"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// create different versions of the function for different OMP internal</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07652" /><CodeLine lineNumber="7652"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07653" /><CodeLine lineNumber="7653"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Linkage = this-&gt;M.<a href="/docs/api/classes/llvm/module/#a6b882824580b4666f692474ecbae56ad">getTargetTriple</a>().rfind(</Highlight><Highlight kind="stringliteral">&quot;wasm32&quot;</Highlight><Highlight kind="normal">) == 0</Highlight></CodeLine>
<Link id="l07654" /><CodeLine lineNumber="7654"><Highlight kind="normal">                       ? <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a></Highlight></CodeLine>
<Link id="l07655" /><CodeLine lineNumber="7655"><Highlight kind="normal">                       : <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca08c6a63ca3d9cdb39fb584655bf5c501">GlobalValue::CommonLinkage</a>;</Highlight></CodeLine>
<Link id="l07656" /><CodeLine lineNumber="7656"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/structs/llvm/omp/gv">GV</a> = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/globalvariable">GlobalVariable</a>(M, Ty, </Highlight><Highlight kind="comment">/&#42;IsConstant=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, Linkage,</Highlight></CodeLine>
<Link id="l07657" /><CodeLine lineNumber="7657"><Highlight kind="normal">                                  <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(Ty), Elem.first(),</Highlight></CodeLine>
<Link id="l07658" /><CodeLine lineNumber="7658"><Highlight kind="normal">                                  </Highlight><Highlight kind="comment">/&#42;InsertBefore=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l07659" /><CodeLine lineNumber="7659"><Highlight kind="normal">                                  <a href="/docs/api/classes/llvm/globalvalue/#a05c6b3b9372b56d130e005db4837da62a7483b56cbb22b39c485b4648ea3374b0">GlobalValue::NotThreadLocal</a>, <a href="/docs/api/namespaces/llvm/nvptxas/#ad7d00b71af84502be65ae2de3f8d91dc">AddressSpace</a>);</Highlight></CodeLine>
<Link id="l07660" /><CodeLine lineNumber="7660"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/datalayout">DataLayout</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = M.getDataLayout();</Highlight></CodeLine>
<Link id="l07661" /><CodeLine lineNumber="7661"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/align">llvm::Align</a> TypeAlign = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getABITypeAlign(Ty);</Highlight></CodeLine>
<Link id="l07662" /><CodeLine lineNumber="7662"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/align">llvm::Align</a> PtrAlign = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getPointerABIAlignment(<a href="/docs/api/namespaces/llvm/nvptxas/#ad7d00b71af84502be65ae2de3f8d91dc">AddressSpace</a>);</Highlight></CodeLine>
<Link id="l07663" /><CodeLine lineNumber="7663"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/omp/gv">GV</a>-&gt;setAlignment(std::max(TypeAlign, PtrAlign));</Highlight></CodeLine>
<Link id="l07664" /><CodeLine lineNumber="7664"><Highlight kind="normal">    Elem.second = <a href="/docs/api/structs/llvm/omp/gv">GV</a>;</Highlight></CodeLine>
<Link id="l07665" /><CodeLine lineNumber="7665"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07666" /><CodeLine lineNumber="7666"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07667" /><CodeLine lineNumber="7667"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Elem.second;</Highlight></CodeLine>
<Link id="l07668" /><CodeLine lineNumber="7668"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07669" /><CodeLine lineNumber="7669"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07670" /><CodeLine lineNumber="7670"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::getOMPCriticalRegionLock(<a href="/docs/api/classes/llvm/stringref">StringRef</a> CriticalName) &#123;</Highlight></CodeLine>
<Link id="l07671" /><CodeLine lineNumber="7671"><Highlight kind="normal">  std::string Prefix = <a href="/docs/api/classes/llvm/twine">Twine</a>(</Highlight><Highlight kind="stringliteral">&quot;gomp&#95;critical&#95;user&#95;&quot;</Highlight><Highlight kind="normal">, CriticalName).<a href="/docs/api/classes/llvm/twine/#a4c1c1093a7749409c70838678514cc7c">str</a>();</Highlight></CodeLine>
<Link id="l07672" /><CodeLine lineNumber="7672"><Highlight kind="normal">  std::string Name = getNameWithSeparators(&#123;Prefix, </Highlight><Highlight kind="stringliteral">&quot;var&quot;</Highlight><Highlight kind="normal">&#125;, </Highlight><Highlight kind="stringliteral">&quot;.&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07673" /><CodeLine lineNumber="7673"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aa5ef00e5a7487cc6c5bfed0f301fa1cc">getOrCreateInternalVariable</a>(KmpCriticalNameTy, Name);</Highlight></CodeLine>
<Link id="l07674" /><CodeLine lineNumber="7674"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07675" /><CodeLine lineNumber="7675"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07676" /><CodeLine lineNumber="7676"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::getSizeInBytes(<a href="/docs/api/classes/llvm/value">Value</a> &#42;BasePtr) &#123;</Highlight></CodeLine>
<Link id="l07677" /><CodeLine lineNumber="7677"><Highlight kind="normal">  LLVMContext &amp;Ctx = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>();</Highlight></CodeLine>
<Link id="l07678" /><CodeLine lineNumber="7678"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/#a73b761f8d40500a5a28889569526b260abbb93ef26e3c101ff11cdd21cab08a94">Null</a> =</Highlight></CodeLine>
<Link id="l07679" /><CodeLine lineNumber="7679"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/codeview/#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getContext()));</Highlight></CodeLine>
<Link id="l07680" /><CodeLine lineNumber="7680"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SizeGep =</Highlight></CodeLine>
<Link id="l07681" /><CodeLine lineNumber="7681"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(<a href="/docs/api/namespaces/llvm/codeview/#aa8c11d016a2dd473a4cf0ed1da777f5ea67f23a49a4828b272554feea07834f7d">BasePtr</a>-&gt;getType(), <a href="/docs/api/namespaces/llvm/#a73b761f8d40500a5a28889569526b260abbb93ef26e3c101ff11cdd21cab08a94">Null</a>, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(1));</Highlight></CodeLine>
<Link id="l07682" /><CodeLine lineNumber="7682"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SizePtrToInt = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aae2c1bf70058f3665edaec525457030c">CreatePtrToInt</a>(SizeGep, <a href="/docs/api/classes/llvm/type/#a05186fa23e4d11b9855a9599ba87a4b7">Type::getInt64Ty</a>(Ctx));</Highlight></CodeLine>
<Link id="l07683" /><CodeLine lineNumber="7683"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SizePtrToInt;</Highlight></CodeLine>
<Link id="l07684" /><CodeLine lineNumber="7684"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07685" /><CodeLine lineNumber="7685"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07686" /><CodeLine lineNumber="7686"><Highlight kind="normal"><a href="/docs/api/classes/llvm/globalvariable">GlobalVariable</a> &#42;</Highlight></CodeLine>
<Link id="l07687" /><CodeLine lineNumber="7687"><Highlight kind="normal">OpenMPIRBuilder::createOffloadMaptypes(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;Mappings,</Highlight></CodeLine>
<Link id="l07688" /><CodeLine lineNumber="7688"><Highlight kind="normal">                                       std::string VarName) &#123;</Highlight></CodeLine>
<Link id="l07689" /><CodeLine lineNumber="7689"><Highlight kind="normal">  llvm::Constant &#42;MaptypesArrayInit =</Highlight></CodeLine>
<Link id="l07690" /><CodeLine lineNumber="7690"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constantdataarray/#a4a1000e5803e731e9dcc572042a98a0b">llvm::ConstantDataArray::get</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), Mappings);</Highlight></CodeLine>
<Link id="l07691" /><CodeLine lineNumber="7691"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;MaptypesArrayGlobal = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> llvm::GlobalVariable(</Highlight></CodeLine>
<Link id="l07692" /><CodeLine lineNumber="7692"><Highlight kind="normal">      M, MaptypesArrayInit-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>(),</Highlight></CodeLine>
<Link id="l07693" /><CodeLine lineNumber="7693"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;isConstant=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">llvm::GlobalValue::PrivateLinkage</a>, MaptypesArrayInit,</Highlight></CodeLine>
<Link id="l07694" /><CodeLine lineNumber="7694"><Highlight kind="normal">      VarName);</Highlight></CodeLine>
<Link id="l07695" /><CodeLine lineNumber="7695"><Highlight kind="normal">  MaptypesArrayGlobal-&gt;setUnnamedAddr(<a href="/docs/api/classes/llvm/globalvalue/#ae8df4be75bfc50b1eadd74e85c25fa45a4cc6684df7b4a92b1dec6fce3264fac8">llvm::GlobalValue::UnnamedAddr::Global</a>);</Highlight></CodeLine>
<Link id="l07696" /><CodeLine lineNumber="7696"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> MaptypesArrayGlobal;</Highlight></CodeLine>
<Link id="l07697" /><CodeLine lineNumber="7697"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07698" /><CodeLine lineNumber="7698"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07699" /><CodeLine lineNumber="7699"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::createMapperAllocas(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l07700" /><CodeLine lineNumber="7700"><Highlight kind="normal">                                          InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l07701" /><CodeLine lineNumber="7701"><Highlight kind="normal">                                          </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumOperands,</Highlight></CodeLine>
<Link id="l07702" /><CodeLine lineNumber="7702"><Highlight kind="normal">                                          </Highlight><Highlight kind="keyword">struct</Highlight><Highlight kind="normal"> MapperAllocas &amp;MapperAllocas) &#123;</Highlight></CodeLine>
<Link id="l07703" /><CodeLine lineNumber="7703"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l07704" /><CodeLine lineNumber="7704"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07705" /><CodeLine lineNumber="7705"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07706" /><CodeLine lineNumber="7706"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArrI8PtrTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Int8Ptr, NumOperands);</Highlight></CodeLine>
<Link id="l07707" /><CodeLine lineNumber="7707"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArrI64Ty = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872ada475947399b8ab4d13d40fea50f950c">Int64</a>, NumOperands);</Highlight></CodeLine>
<Link id="l07708" /><CodeLine lineNumber="7708"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l07709" /><CodeLine lineNumber="7709"><Highlight kind="normal">  AllocaInst &#42;ArgsBase = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l07710" /><CodeLine lineNumber="7710"><Highlight kind="normal">      ArrI8PtrTy, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.offload&#95;baseptrs&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07711" /><CodeLine lineNumber="7711"><Highlight kind="normal">  AllocaInst &#42;<a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(ArrI8PtrTy, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l07712" /><CodeLine lineNumber="7712"><Highlight kind="normal">                                          </Highlight><Highlight kind="stringliteral">&quot;.offload&#95;ptrs&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07713" /><CodeLine lineNumber="7713"><Highlight kind="normal">  AllocaInst &#42;ArgSizes = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l07714" /><CodeLine lineNumber="7714"><Highlight kind="normal">      ArrI64Ty, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.offload&#95;sizes&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07715" /><CodeLine lineNumber="7715"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(Loc.IP);</Highlight></CodeLine>
<Link id="l07716" /><CodeLine lineNumber="7716"><Highlight kind="normal">  MapperAllocas.ArgsBase = ArgsBase;</Highlight></CodeLine>
<Link id="l07717" /><CodeLine lineNumber="7717"><Highlight kind="normal">  MapperAllocas.Args = <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>;</Highlight></CodeLine>
<Link id="l07718" /><CodeLine lineNumber="7718"><Highlight kind="normal">  MapperAllocas.ArgSizes = ArgSizes;</Highlight></CodeLine>
<Link id="l07719" /><CodeLine lineNumber="7719"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07720" /><CodeLine lineNumber="7720"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07721" /><CodeLine lineNumber="7721"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitMapperCall(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l07722" /><CodeLine lineNumber="7722"><Highlight kind="normal">                                     <a href="/docs/api/classes/llvm/function">Function</a> &#42;MapperFunc, <a href="/docs/api/classes/llvm/value">Value</a> &#42;SrcLocInfo,</Highlight></CodeLine>
<Link id="l07723" /><CodeLine lineNumber="7723"><Highlight kind="normal">                                     <a href="/docs/api/classes/llvm/value">Value</a> &#42;MaptypesArg, <a href="/docs/api/classes/llvm/value">Value</a> &#42;MapnamesArg,</Highlight></CodeLine>
<Link id="l07724" /><CodeLine lineNumber="7724"><Highlight kind="normal">                                     </Highlight><Highlight kind="keyword">struct</Highlight><Highlight kind="normal"> MapperAllocas &amp;MapperAllocas,</Highlight></CodeLine>
<Link id="l07725" /><CodeLine lineNumber="7725"><Highlight kind="normal">                                     int64&#95;t DeviceID, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumOperands) &#123;</Highlight></CodeLine>
<Link id="l07726" /><CodeLine lineNumber="7726"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l07727" /><CodeLine lineNumber="7727"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07728" /><CodeLine lineNumber="7728"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07729" /><CodeLine lineNumber="7729"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArrI8PtrTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Int8Ptr, NumOperands);</Highlight></CodeLine>
<Link id="l07730" /><CodeLine lineNumber="7730"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;ArrI64Ty = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872ada475947399b8ab4d13d40fea50f950c">Int64</a>, NumOperands);</Highlight></CodeLine>
<Link id="l07731" /><CodeLine lineNumber="7731"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ArgsBaseGEP =</Highlight></CodeLine>
<Link id="l07732" /><CodeLine lineNumber="7732"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(ArrI8PtrTy, MapperAllocas.ArgsBase,</Highlight></CodeLine>
<Link id="l07733" /><CodeLine lineNumber="7733"><Highlight kind="normal">                                &#123;Builder.getInt32(0), Builder.getInt32(0)&#125;);</Highlight></CodeLine>
<Link id="l07734" /><CodeLine lineNumber="7734"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ArgsGEP =</Highlight></CodeLine>
<Link id="l07735" /><CodeLine lineNumber="7735"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(ArrI8PtrTy, MapperAllocas.Args,</Highlight></CodeLine>
<Link id="l07736" /><CodeLine lineNumber="7736"><Highlight kind="normal">                                &#123;Builder.getInt32(0), Builder.getInt32(0)&#125;);</Highlight></CodeLine>
<Link id="l07737" /><CodeLine lineNumber="7737"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ArgSizesGEP =</Highlight></CodeLine>
<Link id="l07738" /><CodeLine lineNumber="7738"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(ArrI64Ty, MapperAllocas.ArgSizes,</Highlight></CodeLine>
<Link id="l07739" /><CodeLine lineNumber="7739"><Highlight kind="normal">                                &#123;Builder.getInt32(0), Builder.getInt32(0)&#125;);</Highlight></CodeLine>
<Link id="l07740" /><CodeLine lineNumber="7740"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;NullPtr =</Highlight></CodeLine>
<Link id="l07741" /><CodeLine lineNumber="7741"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(Int8Ptr-&gt;getContext()));</Highlight></CodeLine>
<Link id="l07742" /><CodeLine lineNumber="7742"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(MapperFunc,</Highlight></CodeLine>
<Link id="l07743" /><CodeLine lineNumber="7743"><Highlight kind="normal">                     &#123;SrcLocInfo, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(DeviceID),</Highlight></CodeLine>
<Link id="l07744" /><CodeLine lineNumber="7744"><Highlight kind="normal">                      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(NumOperands), ArgsBaseGEP, ArgsGEP,</Highlight></CodeLine>
<Link id="l07745" /><CodeLine lineNumber="7745"><Highlight kind="normal">                      ArgSizesGEP, MaptypesArg, MapnamesArg, NullPtr&#125;);</Highlight></CodeLine>
<Link id="l07746" /><CodeLine lineNumber="7746"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07747" /><CodeLine lineNumber="7747"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07748" /><CodeLine lineNumber="7748"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitOffloadingArraysArgument(<a href="/docs/api/classes/llvm/irbuilderbase">IRBuilderBase</a> &amp;Builder,</Highlight></CodeLine>
<Link id="l07749" /><CodeLine lineNumber="7749"><Highlight kind="normal">                                                   TargetDataRTArgs &amp;RTArgs,</Highlight></CodeLine>
<Link id="l07750" /><CodeLine lineNumber="7750"><Highlight kind="normal">                                                   TargetDataInfo &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>,</Highlight></CodeLine>
<Link id="l07751" /><CodeLine lineNumber="7751"><Highlight kind="normal">                                                   </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> ForEndCall) &#123;</Highlight></CodeLine>
<Link id="l07752" /><CodeLine lineNumber="7752"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!ForEndCall || <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.separateBeginEndCalls()) &amp;&amp;</Highlight></CodeLine>
<Link id="l07753" /><CodeLine lineNumber="7753"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;expected region end call to runtime only when end call is separate&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07754" /><CodeLine lineNumber="7754"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> UnqualPtrTy = <a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l07755" /><CodeLine lineNumber="7755"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> VoidPtrTy = UnqualPtrTy;</Highlight></CodeLine>
<Link id="l07756" /><CodeLine lineNumber="7756"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> VoidPtrPtrTy = UnqualPtrTy;</Highlight></CodeLine>
<Link id="l07757" /><CodeLine lineNumber="7757"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Int64Ty = <a href="/docs/api/classes/llvm/type/#a05186fa23e4d11b9855a9599ba87a4b7">Type::getInt64Ty</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext());</Highlight></CodeLine>
<Link id="l07758" /><CodeLine lineNumber="7758"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Int64PtrTy = UnqualPtrTy;</Highlight></CodeLine>
<Link id="l07759" /><CodeLine lineNumber="7759"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07760" /><CodeLine lineNumber="7760"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs) &#123;</Highlight></CodeLine>
<Link id="l07761" /><CodeLine lineNumber="7761"><Highlight kind="normal">    RTArgs.BasePointersArray = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(VoidPtrPtrTy);</Highlight></CodeLine>
<Link id="l07762" /><CodeLine lineNumber="7762"><Highlight kind="normal">    RTArgs.PointersArray = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(VoidPtrPtrTy);</Highlight></CodeLine>
<Link id="l07763" /><CodeLine lineNumber="7763"><Highlight kind="normal">    RTArgs.SizesArray = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(Int64PtrTy);</Highlight></CodeLine>
<Link id="l07764" /><CodeLine lineNumber="7764"><Highlight kind="normal">    RTArgs.MapTypesArray = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(Int64PtrTy);</Highlight></CodeLine>
<Link id="l07765" /><CodeLine lineNumber="7765"><Highlight kind="normal">    RTArgs.MapNamesArray = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(VoidPtrPtrTy);</Highlight></CodeLine>
<Link id="l07766" /><CodeLine lineNumber="7766"><Highlight kind="normal">    RTArgs.MappersArray = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(VoidPtrPtrTy);</Highlight></CodeLine>
<Link id="l07767" /><CodeLine lineNumber="7767"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07768" /><CodeLine lineNumber="7768"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07769" /><CodeLine lineNumber="7769"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07770" /><CodeLine lineNumber="7770"><Highlight kind="normal">  RTArgs.BasePointersArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l07771" /><CodeLine lineNumber="7771"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(VoidPtrTy, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs),</Highlight></CodeLine>
<Link id="l07772" /><CodeLine lineNumber="7772"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.BasePointersArray,</Highlight></CodeLine>
<Link id="l07773" /><CodeLine lineNumber="7773"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;Idx0=&#42;/</Highlight><Highlight kind="normal">0, </Highlight><Highlight kind="comment">/&#42;Idx1=&#42;/</Highlight><Highlight kind="normal">0);</Highlight></CodeLine>
<Link id="l07774" /><CodeLine lineNumber="7774"><Highlight kind="normal">  RTArgs.PointersArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l07775" /><CodeLine lineNumber="7775"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(VoidPtrTy, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.PointersArray,</Highlight></CodeLine>
<Link id="l07776" /><CodeLine lineNumber="7776"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;Idx0=&#42;/</Highlight><Highlight kind="normal">0,</Highlight></CodeLine>
<Link id="l07777" /><CodeLine lineNumber="7777"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;Idx1=&#42;/</Highlight><Highlight kind="normal">0);</Highlight></CodeLine>
<Link id="l07778" /><CodeLine lineNumber="7778"><Highlight kind="normal">  RTArgs.SizesArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l07779" /><CodeLine lineNumber="7779"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Int64Ty, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.SizesArray,</Highlight></CodeLine>
<Link id="l07780" /><CodeLine lineNumber="7780"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;Idx0=&#42;/</Highlight><Highlight kind="normal">0, </Highlight><Highlight kind="comment">/&#42;Idx1=&#42;/</Highlight><Highlight kind="normal">0);</Highlight></CodeLine>
<Link id="l07781" /><CodeLine lineNumber="7781"><Highlight kind="normal">  RTArgs.MapTypesArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l07782" /><CodeLine lineNumber="7782"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Int64Ty, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs),</Highlight></CodeLine>
<Link id="l07783" /><CodeLine lineNumber="7783"><Highlight kind="normal">      ForEndCall &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MapTypesArrayEnd ? <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MapTypesArrayEnd</Highlight></CodeLine>
<Link id="l07784" /><CodeLine lineNumber="7784"><Highlight kind="normal">                                                 : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MapTypesArray,</Highlight></CodeLine>
<Link id="l07785" /><CodeLine lineNumber="7785"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;Idx0=&#42;/</Highlight><Highlight kind="normal">0,</Highlight></CodeLine>
<Link id="l07786" /><CodeLine lineNumber="7786"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;Idx1=&#42;/</Highlight><Highlight kind="normal">0);</Highlight></CodeLine>
<Link id="l07787" /><CodeLine lineNumber="7787"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07788" /><CodeLine lineNumber="7788"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Only emit the mapper information arrays if debug information is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07789" /><CodeLine lineNumber="7789"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// requested.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07790" /><CodeLine lineNumber="7790"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.EmitDebug)</Highlight></CodeLine>
<Link id="l07791" /><CodeLine lineNumber="7791"><Highlight kind="normal">    RTArgs.MapNamesArray = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(VoidPtrPtrTy);</Highlight></CodeLine>
<Link id="l07792" /><CodeLine lineNumber="7792"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07793" /><CodeLine lineNumber="7793"><Highlight kind="normal">    RTArgs.MapNamesArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l07794" /><CodeLine lineNumber="7794"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(VoidPtrTy, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MapNamesArray,</Highlight></CodeLine>
<Link id="l07795" /><CodeLine lineNumber="7795"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;Idx0=&#42;/</Highlight><Highlight kind="normal">0,</Highlight></CodeLine>
<Link id="l07796" /><CodeLine lineNumber="7796"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;Idx1=&#42;/</Highlight><Highlight kind="normal">0);</Highlight></CodeLine>
<Link id="l07797" /><CodeLine lineNumber="7797"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there is no user-defined mapper, set the mapper array to nullptr to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07798" /><CodeLine lineNumber="7798"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// avoid an unnecessary data privatization</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07799" /><CodeLine lineNumber="7799"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.HasMapper)</Highlight></CodeLine>
<Link id="l07800" /><CodeLine lineNumber="7800"><Highlight kind="normal">    RTArgs.MappersArray = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(VoidPtrPtrTy);</Highlight></CodeLine>
<Link id="l07801" /><CodeLine lineNumber="7801"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07802" /><CodeLine lineNumber="7802"><Highlight kind="normal">    RTArgs.MappersArray =</Highlight></CodeLine>
<Link id="l07803" /><CodeLine lineNumber="7803"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a3ef26a11123d639b64307cc3c1b869b9">CreatePointerCast</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MappersArray, VoidPtrPtrTy);</Highlight></CodeLine>
<Link id="l07804" /><CodeLine lineNumber="7804"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07805" /><CodeLine lineNumber="7805"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07806" /><CodeLine lineNumber="7806"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitNonContiguousDescriptor(InsertPointTy AllocaIP,</Highlight></CodeLine>
<Link id="l07807" /><CodeLine lineNumber="7807"><Highlight kind="normal">                                                  InsertPointTy CodeGenIP,</Highlight></CodeLine>
<Link id="l07808" /><CodeLine lineNumber="7808"><Highlight kind="normal">                                                  MapInfosTy &amp;CombinedInfo,</Highlight></CodeLine>
<Link id="l07809" /><CodeLine lineNumber="7809"><Highlight kind="normal">                                                  TargetDataInfo &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>) &#123;</Highlight></CodeLine>
<Link id="l07810" /><CodeLine lineNumber="7810"><Highlight kind="normal">  MapInfosTy::StructNonContiguousInfo &amp;NonContigInfo =</Highlight></CodeLine>
<Link id="l07811" /><CodeLine lineNumber="7811"><Highlight kind="normal">      CombinedInfo.NonContigInfo;</Highlight></CodeLine>
<Link id="l07812" /><CodeLine lineNumber="7812"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07813" /><CodeLine lineNumber="7813"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build an array of struct descriptor&#95;dim and then assign it to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07814" /><CodeLine lineNumber="7814"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// offload&#95;args.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07815" /><CodeLine lineNumber="7815"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07816" /><CodeLine lineNumber="7816"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// struct descriptor&#95;dim &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07817" /><CodeLine lineNumber="7817"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  uint64&#95;t offset;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07818" /><CodeLine lineNumber="7818"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  uint64&#95;t count;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07819" /><CodeLine lineNumber="7819"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  uint64&#95;t stride</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07820" /><CodeLine lineNumber="7820"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#125;;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07821" /><CodeLine lineNumber="7821"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;Int64Ty = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>();</Highlight></CodeLine>
<Link id="l07822" /><CodeLine lineNumber="7822"><Highlight kind="normal">  StructType &#42;DimTy = <a href="/docs/api/classes/llvm/structtype/#a82648246c07eb8a33f628eea28cb988c">StructType::create</a>(</Highlight></CodeLine>
<Link id="l07823" /><CodeLine lineNumber="7823"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), <a href="/docs/api/namespaces/llvm/#ab9c6b351507d3c0730f4290919d43a12">ArrayRef&lt;Type &#42;&gt;</a>(&#123;Int64Ty, Int64Ty, Int64Ty&#125;),</Highlight></CodeLine>
<Link id="l07824" /><CodeLine lineNumber="7824"><Highlight kind="normal">      </Highlight><Highlight kind="stringliteral">&quot;struct.descriptor&#95;dim&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07825" /><CodeLine lineNumber="7825"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07826" /><CodeLine lineNumber="7826"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">enum</Highlight><Highlight kind="normal"> &#123; OffsetFD = 0, CountFD, StrideFD &#125;;</Highlight></CodeLine>
<Link id="l07827" /><CodeLine lineNumber="7827"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We need two index variable here since the size of &quot;Dims&quot; is the same as</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07828" /><CodeLine lineNumber="7828"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the size of Components, however, the size of offset, count, and stride is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07829" /><CodeLine lineNumber="7829"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// equal to the size of base declaration that is non-contiguous.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07830" /><CodeLine lineNumber="7830"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, L = 0, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = NonContigInfo.Dims.size(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l07831" /><CodeLine lineNumber="7831"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Skip emitting ir if dimension size is 1 since it cannot be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07832" /><CodeLine lineNumber="7832"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// non-contiguous.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07833" /><CodeLine lineNumber="7833"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NonContigInfo.Dims&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; == 1)</Highlight></CodeLine>
<Link id="l07834" /><CodeLine lineNumber="7834"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07835" /><CodeLine lineNumber="7835"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l07836" /><CodeLine lineNumber="7836"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bacb17ff5177bb277ed8dd79480aad9c27">ArrayType</a> &#42;ArrayTy = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(DimTy, NonContigInfo.Dims&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;);</Highlight></CodeLine>
<Link id="l07837" /><CodeLine lineNumber="7837"><Highlight kind="normal">    AllocaInst &#42;DimsAddr =</Highlight></CodeLine>
<Link id="l07838" /><CodeLine lineNumber="7838"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(ArrayTy, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;dims&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07839" /><CodeLine lineNumber="7839"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l07840" /><CodeLine lineNumber="7840"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a> = 0, EE = NonContigInfo.Dims&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;; <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a> &lt; EE; ++<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>) &#123;</Highlight></CodeLine>
<Link id="l07841" /><CodeLine lineNumber="7841"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> RevIdx = EE - <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a> - 1;</Highlight></CodeLine>
<Link id="l07842" /><CodeLine lineNumber="7842"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DimsLVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l07843" /><CodeLine lineNumber="7843"><Highlight kind="normal">          DimsAddr-&gt;<a href="/docs/api/classes/llvm/allocainst/#a9b5ec84ea363eca9e35ddca20a5313af">getAllocatedType</a>(), DimsAddr,</Highlight></CodeLine>
<Link id="l07844" /><CodeLine lineNumber="7844"><Highlight kind="normal">          &#123;Builder.getInt64(0), Builder.getInt64(II)&#125;);</Highlight></CodeLine>
<Link id="l07845" /><CodeLine lineNumber="7845"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Offset</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07846" /><CodeLine lineNumber="7846"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OffsetLVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(DimTy, DimsLVal, OffsetFD);</Highlight></CodeLine>
<Link id="l07847" /><CodeLine lineNumber="7847"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(</Highlight></CodeLine>
<Link id="l07848" /><CodeLine lineNumber="7848"><Highlight kind="normal">          NonContigInfo.Offsets&#91;L&#93;&#91;RevIdx&#93;, OffsetLVal,</Highlight></CodeLine>
<Link id="l07849" /><CodeLine lineNumber="7849"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(OffsetLVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()));</Highlight></CodeLine>
<Link id="l07850" /><CodeLine lineNumber="7850"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Count</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07851" /><CodeLine lineNumber="7851"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CountLVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(DimTy, DimsLVal, CountFD);</Highlight></CodeLine>
<Link id="l07852" /><CodeLine lineNumber="7852"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(</Highlight></CodeLine>
<Link id="l07853" /><CodeLine lineNumber="7853"><Highlight kind="normal">          NonContigInfo.Counts&#91;L&#93;&#91;RevIdx&#93;, CountLVal,</Highlight></CodeLine>
<Link id="l07854" /><CodeLine lineNumber="7854"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(CountLVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()));</Highlight></CodeLine>
<Link id="l07855" /><CodeLine lineNumber="7855"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Stride</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07856" /><CodeLine lineNumber="7856"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;StrideLVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a4e95ff363c20e1f51b673230538e10fd">CreateStructGEP</a>(DimTy, DimsLVal, StrideFD);</Highlight></CodeLine>
<Link id="l07857" /><CodeLine lineNumber="7857"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(</Highlight></CodeLine>
<Link id="l07858" /><CodeLine lineNumber="7858"><Highlight kind="normal">          NonContigInfo.Strides&#91;L&#93;&#91;RevIdx&#93;, StrideLVal,</Highlight></CodeLine>
<Link id="l07859" /><CodeLine lineNumber="7859"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(CountLVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()));</Highlight></CodeLine>
<Link id="l07860" /><CodeLine lineNumber="7860"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07861" /><CodeLine lineNumber="7861"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// args&#91;I&#93; = &amp;dims</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07862" /><CodeLine lineNumber="7862"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l07863" /><CodeLine lineNumber="7863"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a68789c8159cee17d42d86c4b7fcce324">CreatePointerBitCastOrAddrSpaceCast</a>(</Highlight></CodeLine>
<Link id="l07864" /><CodeLine lineNumber="7864"><Highlight kind="normal">        DimsAddr, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l07865" /><CodeLine lineNumber="7865"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l07866" /><CodeLine lineNumber="7866"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs),</Highlight></CodeLine>
<Link id="l07867" /><CodeLine lineNumber="7867"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.PointersArray, 0, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l07868" /><CodeLine lineNumber="7868"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(</Highlight></CodeLine>
<Link id="l07869" /><CodeLine lineNumber="7869"><Highlight kind="normal">        DAddr, <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>()));</Highlight></CodeLine>
<Link id="l07870" /><CodeLine lineNumber="7870"><Highlight kind="normal">    ++<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>;</Highlight></CodeLine>
<Link id="l07871" /><CodeLine lineNumber="7871"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07872" /><CodeLine lineNumber="7872"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07873" /><CodeLine lineNumber="7873"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07874" /><CodeLine lineNumber="7874"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitUDMapperArrayInitOrDel(</Highlight></CodeLine>
<Link id="l07875" /><CodeLine lineNumber="7875"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function">Function</a> &#42;MapperFn, <a href="/docs/api/classes/llvm/value">Value</a> &#42;MapperHandle, <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Begin,</Highlight></CodeLine>
<Link id="l07876" /><CodeLine lineNumber="7876"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;MapType, <a href="/docs/api/classes/llvm/value">Value</a> &#42;MapName, <a href="/docs/api/classes/llvm/typesize">TypeSize</a> ElementSize,</Highlight></CodeLine>
<Link id="l07877" /><CodeLine lineNumber="7877"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ExitBB, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsInit) &#123;</Highlight></CodeLine>
<Link id="l07878" /><CodeLine lineNumber="7878"><Highlight kind="normal">  StringRef <a href="/docs/api/namespaces/llvm/cl/#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a> = IsInit ? </Highlight><Highlight kind="stringliteral">&quot;.init&quot;</Highlight><Highlight kind="normal"> : </Highlight><Highlight kind="stringliteral">&quot;.del&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07879" /><CodeLine lineNumber="7879"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07880" /><CodeLine lineNumber="7880"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Evaluate if this is an array section.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07881" /><CodeLine lineNumber="7881"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;BodyBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(</Highlight></CodeLine>
<Link id="l07882" /><CodeLine lineNumber="7882"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;</Highlight><Highlight kind="stringliteral">&quot;omp.array&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>&#125;));</Highlight></CodeLine>
<Link id="l07883" /><CodeLine lineNumber="7883"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/namespaces/llvm/logicalview/#a738fb172d3b98e08a4325dc7ca5588b8a7515d3a3055b2139844aa9e06fce46cf">IsArray</a> =</Highlight></CodeLine>
<Link id="l07884" /><CodeLine lineNumber="7884"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a3280551f1232a760cb7b21e85fdd5eca">CreateICmpSGT</a>(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(1), </Highlight><Highlight kind="stringliteral">&quot;omp.arrayinit.isarray&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07885" /><CodeLine lineNumber="7885"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DeleteBit = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(</Highlight></CodeLine>
<Link id="l07886" /><CodeLine lineNumber="7886"><Highlight kind="normal">      MapType,</Highlight></CodeLine>
<Link id="l07887" /><CodeLine lineNumber="7887"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l07888" /><CodeLine lineNumber="7888"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l07889" /><CodeLine lineNumber="7889"><Highlight kind="normal">              OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;DELETE)));</Highlight></CodeLine>
<Link id="l07890" /><CodeLine lineNumber="7890"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;DeleteCond;</Highlight></CodeLine>
<Link id="l07891" /><CodeLine lineNumber="7891"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l07892" /><CodeLine lineNumber="7892"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsInit) &#123;</Highlight></CodeLine>
<Link id="l07893" /><CodeLine lineNumber="7893"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// base != begin?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07894" /><CodeLine lineNumber="7894"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BaseIsBegin = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a6ef1729b04a4fbd6c6f27787cdd0e813">CreateICmpNE</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, Begin);</Highlight></CodeLine>
<Link id="l07895" /><CodeLine lineNumber="7895"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// IsPtrAndObj?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07896" /><CodeLine lineNumber="7896"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PtrAndObjBit = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(</Highlight></CodeLine>
<Link id="l07897" /><CodeLine lineNumber="7897"><Highlight kind="normal">        MapType,</Highlight></CodeLine>
<Link id="l07898" /><CodeLine lineNumber="7898"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l07899" /><CodeLine lineNumber="7899"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l07900" /><CodeLine lineNumber="7900"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;PTR&#95;AND&#95;OBJ)));</Highlight></CodeLine>
<Link id="l07901" /><CodeLine lineNumber="7901"><Highlight kind="normal">    PtrAndObjBit = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aafd864f39fd28e235eea03ae424ab8e0">CreateIsNotNull</a>(PtrAndObjBit);</Highlight></CodeLine>
<Link id="l07902" /><CodeLine lineNumber="7902"><Highlight kind="normal">    BaseIsBegin = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(BaseIsBegin, PtrAndObjBit);</Highlight></CodeLine>
<Link id="l07903" /><CodeLine lineNumber="7903"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab61be8e3cf17e9848aeeeabacfa1b09a">CreateOr</a>(IsArray, BaseIsBegin);</Highlight></CodeLine>
<Link id="l07904" /><CodeLine lineNumber="7904"><Highlight kind="normal">    DeleteCond = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac9843b4f9f9cb144c608c48785a394a8">CreateIsNull</a>(</Highlight></CodeLine>
<Link id="l07905" /><CodeLine lineNumber="7905"><Highlight kind="normal">        DeleteBit,</Highlight></CodeLine>
<Link id="l07906" /><CodeLine lineNumber="7906"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;</Highlight><Highlight kind="stringliteral">&quot;omp.array&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>, </Highlight><Highlight kind="stringliteral">&quot;.delete&quot;</Highlight><Highlight kind="normal">&#125;));</Highlight></CodeLine>
<Link id="l07907" /><CodeLine lineNumber="7907"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l07908" /><CodeLine lineNumber="7908"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = <a href="/docs/api/namespaces/llvm/logicalview/#a738fb172d3b98e08a4325dc7ca5588b8a7515d3a3055b2139844aa9e06fce46cf">IsArray</a>;</Highlight></CodeLine>
<Link id="l07909" /><CodeLine lineNumber="7909"><Highlight kind="normal">    DeleteCond = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aafd864f39fd28e235eea03ae424ab8e0">CreateIsNotNull</a>(</Highlight></CodeLine>
<Link id="l07910" /><CodeLine lineNumber="7910"><Highlight kind="normal">        DeleteBit,</Highlight></CodeLine>
<Link id="l07911" /><CodeLine lineNumber="7911"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;</Highlight><Highlight kind="stringliteral">&quot;omp.array&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#afcbd4ecc474e2d218391d6d3027b086aa7861ef1db44eac8ea7a373cd7c53a7c5">Prefix</a>, </Highlight><Highlight kind="stringliteral">&quot;.delete&quot;</Highlight><Highlight kind="normal">&#125;));</Highlight></CodeLine>
<Link id="l07912" /><CodeLine lineNumber="7912"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07913" /><CodeLine lineNumber="7913"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, DeleteCond);</Highlight></CodeLine>
<Link id="l07914" /><CodeLine lineNumber="7914"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, BodyBB, ExitBB);</Highlight></CodeLine>
<Link id="l07915" /><CodeLine lineNumber="7915"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07916" /><CodeLine lineNumber="7916"><Highlight kind="normal">  emitBlock(BodyBB, MapperFn);</Highlight></CodeLine>
<Link id="l07917" /><CodeLine lineNumber="7917"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Get the array size by multiplying element size and element number (i.e., \\p</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07918" /><CodeLine lineNumber="7918"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Size).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07919" /><CodeLine lineNumber="7919"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ArraySize = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a06efffc299a3f7efaec1892c9ac4a86f">CreateNUWMul</a>(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(ElementSize));</Highlight></CodeLine>
<Link id="l07920" /><CodeLine lineNumber="7920"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remove OMP&#95;MAP&#95;TO and OMP&#95;MAP&#95;FROM from the map type, so that it achieves</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07921" /><CodeLine lineNumber="7921"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// memory allocation/deletion purpose only.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07922" /><CodeLine lineNumber="7922"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MapTypeArg = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(</Highlight></CodeLine>
<Link id="l07923" /><CodeLine lineNumber="7923"><Highlight kind="normal">      MapType,</Highlight></CodeLine>
<Link id="l07924" /><CodeLine lineNumber="7924"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l07925" /><CodeLine lineNumber="7925"><Highlight kind="normal">          ~</Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l07926" /><CodeLine lineNumber="7926"><Highlight kind="normal">              OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;TO |</Highlight></CodeLine>
<Link id="l07927" /><CodeLine lineNumber="7927"><Highlight kind="normal">              OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;FROM)));</Highlight></CodeLine>
<Link id="l07928" /><CodeLine lineNumber="7928"><Highlight kind="normal">  MapTypeArg = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab61be8e3cf17e9848aeeeabacfa1b09a">CreateOr</a>(</Highlight></CodeLine>
<Link id="l07929" /><CodeLine lineNumber="7929"><Highlight kind="normal">      MapTypeArg,</Highlight></CodeLine>
<Link id="l07930" /><CodeLine lineNumber="7930"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l07931" /><CodeLine lineNumber="7931"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l07932" /><CodeLine lineNumber="7932"><Highlight kind="normal">              OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;IMPLICIT)));</Highlight></CodeLine>
<Link id="l07933" /><CodeLine lineNumber="7933"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07934" /><CodeLine lineNumber="7934"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Call the runtime API &#95;&#95;tgt&#95;push&#95;mapper&#95;component to fill up the runtime</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07935" /><CodeLine lineNumber="7935"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// data structure.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07936" /><CodeLine lineNumber="7936"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OffloadingArgs&#91;&#93; = &#123;MapperHandle, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,       Begin,</Highlight></CodeLine>
<Link id="l07937" /><CodeLine lineNumber="7937"><Highlight kind="normal">                             ArraySize,    MapTypeArg, MapName&#125;;</Highlight></CodeLine>
<Link id="l07938" /><CodeLine lineNumber="7938"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l07939" /><CodeLine lineNumber="7939"><Highlight kind="normal">      getOrCreateRuntimeFunction(M, OMPRTL&#95;&#95;&#95;tgt&#95;push&#95;mapper&#95;component),</Highlight></CodeLine>
<Link id="l07940" /><CodeLine lineNumber="7940"><Highlight kind="normal">      OffloadingArgs);</Highlight></CodeLine>
<Link id="l07941" /><CodeLine lineNumber="7941"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07942" /><CodeLine lineNumber="7942"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07943" /><CodeLine lineNumber="7943"><Highlight kind="normal"><a href="/docs/api/classes/llvm/function">Function</a> &#42;OpenMPIRBuilder::emitUserDefinedMapper(</Highlight></CodeLine>
<Link id="l07944" /><CodeLine lineNumber="7944"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;MapInfosTy &amp;(InsertPointTy CodeGenIP, <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;PtrPHI,</Highlight></CodeLine>
<Link id="l07945" /><CodeLine lineNumber="7945"><Highlight kind="normal">                              <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;BeginArg)&gt;</Highlight></CodeLine>
<Link id="l07946" /><CodeLine lineNumber="7946"><Highlight kind="normal">        GenMapInfoCB,</Highlight></CodeLine>
<Link id="l07947" /><CodeLine lineNumber="7947"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;ElemTy, <a href="/docs/api/classes/llvm/stringref">StringRef</a> FuncName,</Highlight></CodeLine>
<Link id="l07948" /><CodeLine lineNumber="7948"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;</Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal">(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/function">Function</a> &#42;&#42;)&gt; CustomMapperCB) &#123;</Highlight></CodeLine>
<Link id="l07949" /><CodeLine lineNumber="7949"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;Type &#42;&gt;</a> Params;</Highlight></CodeLine>
<Link id="l07950" /><CodeLine lineNumber="7950"><Highlight kind="normal">  Params.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l07951" /><CodeLine lineNumber="7951"><Highlight kind="normal">  Params.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l07952" /><CodeLine lineNumber="7952"><Highlight kind="normal">  Params.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l07953" /><CodeLine lineNumber="7953"><Highlight kind="normal">  Params.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>());</Highlight></CodeLine>
<Link id="l07954" /><CodeLine lineNumber="7954"><Highlight kind="normal">  Params.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>());</Highlight></CodeLine>
<Link id="l07955" /><CodeLine lineNumber="7955"><Highlight kind="normal">  Params.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l07956" /><CodeLine lineNumber="7956"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07957" /><CodeLine lineNumber="7957"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;FnTy =</Highlight></CodeLine>
<Link id="l07958" /><CodeLine lineNumber="7958"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/functiontype/#af8be7844c269f201ebcee1e15048c378">FunctionType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad0243f1634f75e231041023ffaa8501a">getVoidTy</a>(), Params, </Highlight><Highlight kind="comment">/&#42; IsVarArg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07959" /><CodeLine lineNumber="7959"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07960" /><CodeLine lineNumber="7960"><Highlight kind="normal">  SmallString&lt;64&gt; TyStr;</Highlight></CodeLine>
<Link id="l07961" /><CodeLine lineNumber="7961"><Highlight kind="normal">  raw&#95;svector&#95;ostream Out(TyStr);</Highlight></CodeLine>
<Link id="l07962" /><CodeLine lineNumber="7962"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;MapperFn =</Highlight></CodeLine>
<Link id="l07963" /><CodeLine lineNumber="7963"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/function/#a05d7aedbbdc0fd24e8bc27edfe9c603f">Function::Create</a>(FnTy, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a>, FuncName, M);</Highlight></CodeLine>
<Link id="l07964" /><CodeLine lineNumber="7964"><Highlight kind="normal">  MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(Attribute::NoInline);</Highlight></CodeLine>
<Link id="l07965" /><CodeLine lineNumber="7965"><Highlight kind="normal">  MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(Attribute::NoUnwind);</Highlight></CodeLine>
<Link id="l07966" /><CodeLine lineNumber="7966"><Highlight kind="normal">  MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(0, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l07967" /><CodeLine lineNumber="7967"><Highlight kind="normal">  MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(1, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l07968" /><CodeLine lineNumber="7968"><Highlight kind="normal">  MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(2, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l07969" /><CodeLine lineNumber="7969"><Highlight kind="normal">  MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(3, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l07970" /><CodeLine lineNumber="7970"><Highlight kind="normal">  MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(4, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l07971" /><CodeLine lineNumber="7971"><Highlight kind="normal">  MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aa5087b607af833220d9ebab0c88c83c1">addParamAttr</a>(5, Attribute::NoUndef);</Highlight></CodeLine>
<Link id="l07972" /><CodeLine lineNumber="7972"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07973" /><CodeLine lineNumber="7973"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Start the mapper function code generation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07974" /><CodeLine lineNumber="7974"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EntryBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;entry&quot;</Highlight><Highlight kind="normal">, MapperFn);</Highlight></CodeLine>
<Link id="l07975" /><CodeLine lineNumber="7975"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> SavedIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l07976" /><CodeLine lineNumber="7976"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(EntryBB);</Highlight></CodeLine>
<Link id="l07977" /><CodeLine lineNumber="7977"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07978" /><CodeLine lineNumber="7978"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MapperHandle = MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0);</Highlight></CodeLine>
<Link id="l07979" /><CodeLine lineNumber="7979"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BaseIn = MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1);</Highlight></CodeLine>
<Link id="l07980" /><CodeLine lineNumber="7980"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BeginIn = MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(2);</Highlight></CodeLine>
<Link id="l07981" /><CodeLine lineNumber="7981"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(3);</Highlight></CodeLine>
<Link id="l07982" /><CodeLine lineNumber="7982"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MapType = MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(4);</Highlight></CodeLine>
<Link id="l07983" /><CodeLine lineNumber="7983"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MapName = MapperFn-&gt;<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(5);</Highlight></CodeLine>
<Link id="l07984" /><CodeLine lineNumber="7984"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07985" /><CodeLine lineNumber="7985"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Compute the starting and end addresses of array elements.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07986" /><CodeLine lineNumber="7986"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Prepare common arguments for array initiation and deletion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07987" /><CodeLine lineNumber="7987"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Convert the size in bytes into the number of array elements.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07988" /><CodeLine lineNumber="7988"><Highlight kind="normal">  TypeSize ElementSize = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getTypeStoreSize(ElemTy);</Highlight></CodeLine>
<Link id="l07989" /><CodeLine lineNumber="7989"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aaf8e54fa8e1a081048b4b86ae30ce0ea">CreateExactUDiv</a>(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(ElementSize));</Highlight></CodeLine>
<Link id="l07990" /><CodeLine lineNumber="7990"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PtrBegin = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(BeginIn, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l07991" /><CodeLine lineNumber="7991"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PtrEnd = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73e0482b96d9d0cdfcc90c0a34f5b0db">CreateGEP</a>(ElemTy, PtrBegin, <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</Highlight></CodeLine>
<Link id="l07992" /><CodeLine lineNumber="7992"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07993" /><CodeLine lineNumber="7993"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit array initiation if this is an array section and \\p MapType indicates</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07994" /><CodeLine lineNumber="7994"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that memory allocation is required.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07995" /><CodeLine lineNumber="7995"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;HeadBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.arraymap.head&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07996" /><CodeLine lineNumber="7996"><Highlight kind="normal">  emitUDMapperArrayInitOrDel(MapperFn, MapperHandle, BaseIn, BeginIn, <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>,</Highlight></CodeLine>
<Link id="l07997" /><CodeLine lineNumber="7997"><Highlight kind="normal">                             MapType, MapName, ElementSize, HeadBB,</Highlight></CodeLine>
<Link id="l07998" /><CodeLine lineNumber="7998"><Highlight kind="normal">                             </Highlight><Highlight kind="comment">/&#42;IsInit=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07999" /><CodeLine lineNumber="7999"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08000" /><CodeLine lineNumber="8000"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit a for loop to iterate through SizeArg of elements and map all of them.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08001" /><CodeLine lineNumber="8001"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08002" /><CodeLine lineNumber="8002"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the loop header block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08003" /><CodeLine lineNumber="8003"><Highlight kind="normal">  emitBlock(HeadBB, MapperFn);</Highlight></CodeLine>
<Link id="l08004" /><CodeLine lineNumber="8004"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;BodyBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.arraymap.body&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08005" /><CodeLine lineNumber="8005"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;DoneBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.done&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08006" /><CodeLine lineNumber="8006"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Evaluate whether the initial condition is satisfied.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08007" /><CodeLine lineNumber="8007"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IsEmpty =</Highlight></CodeLine>
<Link id="l08008" /><CodeLine lineNumber="8008"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(PtrBegin, PtrEnd, </Highlight><Highlight kind="stringliteral">&quot;omp.arraymap.isempty&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08009" /><CodeLine lineNumber="8009"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(IsEmpty, DoneBB, BodyBB);</Highlight></CodeLine>
<Link id="l08010" /><CodeLine lineNumber="8010"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08011" /><CodeLine lineNumber="8011"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the loop body block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08012" /><CodeLine lineNumber="8012"><Highlight kind="normal">  emitBlock(BodyBB, MapperFn);</Highlight></CodeLine>
<Link id="l08013" /><CodeLine lineNumber="8013"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;LastBB = BodyBB;</Highlight></CodeLine>
<Link id="l08014" /><CodeLine lineNumber="8014"><Highlight kind="normal">  PHINode &#42;PtrPHI =</Highlight></CodeLine>
<Link id="l08015" /><CodeLine lineNumber="8015"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a876fb556ecea804faa2cd8ad1e498ec3">CreatePHI</a>(PtrBegin-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>(), 2, </Highlight><Highlight kind="stringliteral">&quot;omp.arraymap.ptrcurrent&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08016" /><CodeLine lineNumber="8016"><Highlight kind="normal">  PtrPHI-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(PtrBegin, HeadBB);</Highlight></CodeLine>
<Link id="l08017" /><CodeLine lineNumber="8017"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08018" /><CodeLine lineNumber="8018"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Get map clause information. Fill up the arrays with all mapped variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08019" /><CodeLine lineNumber="8019"><Highlight kind="normal">  MapInfosTy &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a> = GenMapInfoCB(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>(), PtrPHI, BeginIn);</Highlight></CodeLine>
<Link id="l08020" /><CodeLine lineNumber="8020"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08021" /><CodeLine lineNumber="8021"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Call the runtime API &#95;&#95;tgt&#95;mapper&#95;num&#95;components to get the number of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08022" /><CodeLine lineNumber="8022"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// pre-existing components.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08023" /><CodeLine lineNumber="8023"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OffloadingArgs&#91;&#93; = &#123;MapperHandle&#125;;</Highlight></CodeLine>
<Link id="l08024" /><CodeLine lineNumber="8024"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PreviousSize = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l08025" /><CodeLine lineNumber="8025"><Highlight kind="normal">      getOrCreateRuntimeFunction(M, OMPRTL&#95;&#95;&#95;tgt&#95;mapper&#95;num&#95;components),</Highlight></CodeLine>
<Link id="l08026" /><CodeLine lineNumber="8026"><Highlight kind="normal">      OffloadingArgs);</Highlight></CodeLine>
<Link id="l08027" /><CodeLine lineNumber="8027"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ShiftedPreviousSize =</Highlight></CodeLine>
<Link id="l08028" /><CodeLine lineNumber="8028"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b6a3be6451cf6a789d9305d90751c40">CreateShl</a>(PreviousSize, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(<a href="/docs/api/classes/llvm/openmpirbuilder/#ac86b562509588cbc00fbdc441c615bd3">getFlagMemberOffset</a>()));</Highlight></CodeLine>
<Link id="l08029" /><CodeLine lineNumber="8029"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08030" /><CodeLine lineNumber="8030"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Fill up the runtime mapper handle for all components.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08031" /><CodeLine lineNumber="8031"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.BasePointers.size(); ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l08032" /><CodeLine lineNumber="8032"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CurBaseArg =</Highlight></CodeLine>
<Link id="l08033" /><CodeLine lineNumber="8033"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.BasePointers&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l08034" /><CodeLine lineNumber="8034"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CurBeginArg =</Highlight></CodeLine>
<Link id="l08035" /><CodeLine lineNumber="8035"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.Pointers&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l08036" /><CodeLine lineNumber="8036"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CurSizeArg = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.Sizes&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</Highlight></CodeLine>
<Link id="l08037" /><CodeLine lineNumber="8037"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CurNameArg = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.Names.size()</Highlight></CodeLine>
<Link id="l08038" /><CodeLine lineNumber="8038"><Highlight kind="normal">                            ? <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.Names&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;</Highlight></CodeLine>
<Link id="l08039" /><CodeLine lineNumber="8039"><Highlight kind="normal">                            : <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>());</Highlight></CodeLine>
<Link id="l08040" /><CodeLine lineNumber="8040"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08041" /><CodeLine lineNumber="8041"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Extract the MEMBER&#95;OF field from the map type.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08042" /><CodeLine lineNumber="8042"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OriMapType = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l08043" /><CodeLine lineNumber="8043"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08044" /><CodeLine lineNumber="8044"><Highlight kind="normal">            <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.Types&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;));</Highlight></CodeLine>
<Link id="l08045" /><CodeLine lineNumber="8045"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MemberMapType =</Highlight></CodeLine>
<Link id="l08046" /><CodeLine lineNumber="8046"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a706649daecd068a72d8e06df2fd83549">CreateNUWAdd</a>(OriMapType, ShiftedPreviousSize);</Highlight></CodeLine>
<Link id="l08047" /><CodeLine lineNumber="8047"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08048" /><CodeLine lineNumber="8048"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Combine the map type inherited from user-defined mapper with that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08049" /><CodeLine lineNumber="8049"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// specified in the program. According to the OMP&#95;MAP&#95;TO and OMP&#95;MAP&#95;FROM</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08050" /><CodeLine lineNumber="8050"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// bits of the \\a MapType, which is the input argument of the mapper</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08051" /><CodeLine lineNumber="8051"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// function, the following code will set the OMP&#95;MAP&#95;TO and OMP&#95;MAP&#95;FROM</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08052" /><CodeLine lineNumber="8052"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// bits of MemberMapType.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08053" /><CodeLine lineNumber="8053"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// &#91;OpenMP 5.0&#93;, 1.2.6. map-type decay.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08054" /><CodeLine lineNumber="8054"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//        | alloc |  to   | from  | tofrom | release | delete</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08055" /><CodeLine lineNumber="8055"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ----------------------------------------------------------</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08056" /><CodeLine lineNumber="8056"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// alloc  | alloc | alloc | alloc | alloc  | release | delete</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08057" /><CodeLine lineNumber="8057"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// to     | alloc |  to   | alloc |   to   | release | delete</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08058" /><CodeLine lineNumber="8058"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// from   | alloc | alloc | from  |  from  | release | delete</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08059" /><CodeLine lineNumber="8059"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// tofrom | alloc |  to   | from  | tofrom | release | delete</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08060" /><CodeLine lineNumber="8060"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;LeftToFrom = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(</Highlight></CodeLine>
<Link id="l08061" /><CodeLine lineNumber="8061"><Highlight kind="normal">        MapType,</Highlight></CodeLine>
<Link id="l08062" /><CodeLine lineNumber="8062"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l08063" /><CodeLine lineNumber="8063"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08064" /><CodeLine lineNumber="8064"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;TO |</Highlight></CodeLine>
<Link id="l08065" /><CodeLine lineNumber="8065"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;FROM)));</Highlight></CodeLine>
<Link id="l08066" /><CodeLine lineNumber="8066"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;AllocBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.type.alloc&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08067" /><CodeLine lineNumber="8067"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;AllocElseBB =</Highlight></CodeLine>
<Link id="l08068" /><CodeLine lineNumber="8068"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.type.alloc.else&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08069" /><CodeLine lineNumber="8069"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ToBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.type.to&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08070" /><CodeLine lineNumber="8070"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ToElseBB =</Highlight></CodeLine>
<Link id="l08071" /><CodeLine lineNumber="8071"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.type.to.else&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08072" /><CodeLine lineNumber="8072"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;FromBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.type.from&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08073" /><CodeLine lineNumber="8073"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;EndBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.type.end&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08074" /><CodeLine lineNumber="8074"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IsAlloc = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac9843b4f9f9cb144c608c48785a394a8">CreateIsNull</a>(LeftToFrom);</Highlight></CodeLine>
<Link id="l08075" /><CodeLine lineNumber="8075"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(IsAlloc, AllocBB, AllocElseBB);</Highlight></CodeLine>
<Link id="l08076" /><CodeLine lineNumber="8076"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// In case of alloc, clear OMP&#95;MAP&#95;TO and OMP&#95;MAP&#95;FROM.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08077" /><CodeLine lineNumber="8077"><Highlight kind="normal">    emitBlock(AllocBB, MapperFn);</Highlight></CodeLine>
<Link id="l08078" /><CodeLine lineNumber="8078"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;AllocMapType = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(</Highlight></CodeLine>
<Link id="l08079" /><CodeLine lineNumber="8079"><Highlight kind="normal">        MemberMapType,</Highlight></CodeLine>
<Link id="l08080" /><CodeLine lineNumber="8080"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l08081" /><CodeLine lineNumber="8081"><Highlight kind="normal">            ~</Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08082" /><CodeLine lineNumber="8082"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;TO |</Highlight></CodeLine>
<Link id="l08083" /><CodeLine lineNumber="8083"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;FROM)));</Highlight></CodeLine>
<Link id="l08084" /><CodeLine lineNumber="8084"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(EndBB);</Highlight></CodeLine>
<Link id="l08085" /><CodeLine lineNumber="8085"><Highlight kind="normal">    emitBlock(AllocElseBB, MapperFn);</Highlight></CodeLine>
<Link id="l08086" /><CodeLine lineNumber="8086"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IsTo = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(</Highlight></CodeLine>
<Link id="l08087" /><CodeLine lineNumber="8087"><Highlight kind="normal">        LeftToFrom,</Highlight></CodeLine>
<Link id="l08088" /><CodeLine lineNumber="8088"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l08089" /><CodeLine lineNumber="8089"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08090" /><CodeLine lineNumber="8090"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;TO)));</Highlight></CodeLine>
<Link id="l08091" /><CodeLine lineNumber="8091"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(IsTo, ToBB, ToElseBB);</Highlight></CodeLine>
<Link id="l08092" /><CodeLine lineNumber="8092"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// In case of to, clear OMP&#95;MAP&#95;FROM.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08093" /><CodeLine lineNumber="8093"><Highlight kind="normal">    emitBlock(ToBB, MapperFn);</Highlight></CodeLine>
<Link id="l08094" /><CodeLine lineNumber="8094"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ToMapType = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(</Highlight></CodeLine>
<Link id="l08095" /><CodeLine lineNumber="8095"><Highlight kind="normal">        MemberMapType,</Highlight></CodeLine>
<Link id="l08096" /><CodeLine lineNumber="8096"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l08097" /><CodeLine lineNumber="8097"><Highlight kind="normal">            ~</Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08098" /><CodeLine lineNumber="8098"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;FROM)));</Highlight></CodeLine>
<Link id="l08099" /><CodeLine lineNumber="8099"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(EndBB);</Highlight></CodeLine>
<Link id="l08100" /><CodeLine lineNumber="8100"><Highlight kind="normal">    emitBlock(ToElseBB, MapperFn);</Highlight></CodeLine>
<Link id="l08101" /><CodeLine lineNumber="8101"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IsFrom = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(</Highlight></CodeLine>
<Link id="l08102" /><CodeLine lineNumber="8102"><Highlight kind="normal">        LeftToFrom,</Highlight></CodeLine>
<Link id="l08103" /><CodeLine lineNumber="8103"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l08104" /><CodeLine lineNumber="8104"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08105" /><CodeLine lineNumber="8105"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;FROM)));</Highlight></CodeLine>
<Link id="l08106" /><CodeLine lineNumber="8106"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(IsFrom, FromBB, EndBB);</Highlight></CodeLine>
<Link id="l08107" /><CodeLine lineNumber="8107"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// In case of from, clear OMP&#95;MAP&#95;TO.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08108" /><CodeLine lineNumber="8108"><Highlight kind="normal">    emitBlock(FromBB, MapperFn);</Highlight></CodeLine>
<Link id="l08109" /><CodeLine lineNumber="8109"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;FromMapType = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(</Highlight></CodeLine>
<Link id="l08110" /><CodeLine lineNumber="8110"><Highlight kind="normal">        MemberMapType,</Highlight></CodeLine>
<Link id="l08111" /><CodeLine lineNumber="8111"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a73f286a780fbb8c82c0a8574540719ea">getInt64</a>(</Highlight></CodeLine>
<Link id="l08112" /><CodeLine lineNumber="8112"><Highlight kind="normal">            ~</Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08113" /><CodeLine lineNumber="8113"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;TO)));</Highlight></CodeLine>
<Link id="l08114" /><CodeLine lineNumber="8114"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// In case of tofrom, do nothing.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08115" /><CodeLine lineNumber="8115"><Highlight kind="normal">    emitBlock(EndBB, MapperFn);</Highlight></CodeLine>
<Link id="l08116" /><CodeLine lineNumber="8116"><Highlight kind="normal">    LastBB = EndBB;</Highlight></CodeLine>
<Link id="l08117" /><CodeLine lineNumber="8117"><Highlight kind="normal">    PHINode &#42;CurMapType =</Highlight></CodeLine>
<Link id="l08118" /><CodeLine lineNumber="8118"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a876fb556ecea804faa2cd8ad1e498ec3">CreatePHI</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>(), 4, </Highlight><Highlight kind="stringliteral">&quot;omp.maptype&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08119" /><CodeLine lineNumber="8119"><Highlight kind="normal">    CurMapType-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(AllocMapType, AllocBB);</Highlight></CodeLine>
<Link id="l08120" /><CodeLine lineNumber="8120"><Highlight kind="normal">    CurMapType-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(ToMapType, ToBB);</Highlight></CodeLine>
<Link id="l08121" /><CodeLine lineNumber="8121"><Highlight kind="normal">    CurMapType-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(FromMapType, FromBB);</Highlight></CodeLine>
<Link id="l08122" /><CodeLine lineNumber="8122"><Highlight kind="normal">    CurMapType-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(MemberMapType, ToElseBB);</Highlight></CodeLine>
<Link id="l08123" /><CodeLine lineNumber="8123"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08124" /><CodeLine lineNumber="8124"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OffloadingArgs&#91;&#93; = &#123;MapperHandle, CurBaseArg, CurBeginArg,</Highlight></CodeLine>
<Link id="l08125" /><CodeLine lineNumber="8125"><Highlight kind="normal">                               CurSizeArg,   CurMapType, CurNameArg&#125;;</Highlight></CodeLine>
<Link id="l08126" /><CodeLine lineNumber="8126"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;ChildMapperFn = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08127" /><CodeLine lineNumber="8127"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CustomMapperCB &amp;&amp; CustomMapperCB(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, &amp;ChildMapperFn)) &#123;</Highlight></CodeLine>
<Link id="l08128" /><CodeLine lineNumber="8128"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Call the corresponding mapper function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08129" /><CodeLine lineNumber="8129"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(ChildMapperFn, OffloadingArgs)-&gt;<a href="/docs/api/classes/llvm/callbase/#a0b6cef2a78857b0236b1c3a2a6eb857e">setDoesNotThrow</a>();</Highlight></CodeLine>
<Link id="l08130" /><CodeLine lineNumber="8130"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08131" /><CodeLine lineNumber="8131"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Call the runtime API &#95;&#95;tgt&#95;push&#95;mapper&#95;component to fill up the runtime</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08132" /><CodeLine lineNumber="8132"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// data structure.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08133" /><CodeLine lineNumber="8133"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l08134" /><CodeLine lineNumber="8134"><Highlight kind="normal">          getOrCreateRuntimeFunction(M, OMPRTL&#95;&#95;&#95;tgt&#95;push&#95;mapper&#95;component),</Highlight></CodeLine>
<Link id="l08135" /><CodeLine lineNumber="8135"><Highlight kind="normal">          OffloadingArgs);</Highlight></CodeLine>
<Link id="l08136" /><CodeLine lineNumber="8136"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08137" /><CodeLine lineNumber="8137"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08138" /><CodeLine lineNumber="8138"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08139" /><CodeLine lineNumber="8139"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update the pointer to point to the next element that needs to be mapped,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08140" /><CodeLine lineNumber="8140"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and check whether we have mapped all elements.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08141" /><CodeLine lineNumber="8141"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PtrNext = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1ac3f0b68c9c78c4f9e1eb09cd415db8">CreateConstGEP1&#95;32</a>(ElemTy, PtrPHI, </Highlight><Highlight kind="comment">/&#42;Idx0=&#42;/</Highlight><Highlight kind="normal">1,</Highlight></CodeLine>
<Link id="l08142" /><CodeLine lineNumber="8142"><Highlight kind="normal">                                              </Highlight><Highlight kind="stringliteral">&quot;omp.arraymap.next&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08143" /><CodeLine lineNumber="8143"><Highlight kind="normal">  PtrPHI-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(PtrNext, LastBB);</Highlight></CodeLine>
<Link id="l08144" /><CodeLine lineNumber="8144"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;IsDone = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8c75539a39f167f352b37ccdd788a7e4">CreateICmpEQ</a>(PtrNext, PtrEnd, </Highlight><Highlight kind="stringliteral">&quot;omp.arraymap.isdone&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08145" /><CodeLine lineNumber="8145"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ExitBB = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp.arraymap.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08146" /><CodeLine lineNumber="8146"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(IsDone, ExitBB, BodyBB);</Highlight></CodeLine>
<Link id="l08147" /><CodeLine lineNumber="8147"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08148" /><CodeLine lineNumber="8148"><Highlight kind="normal">  emitBlock(ExitBB, MapperFn);</Highlight></CodeLine>
<Link id="l08149" /><CodeLine lineNumber="8149"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit array deletion if this is an array section and \\p MapType indicates</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08150" /><CodeLine lineNumber="8150"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that deletion is required.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08151" /><CodeLine lineNumber="8151"><Highlight kind="normal">  emitUDMapperArrayInitOrDel(MapperFn, MapperHandle, BaseIn, BeginIn, <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>,</Highlight></CodeLine>
<Link id="l08152" /><CodeLine lineNumber="8152"><Highlight kind="normal">                             MapType, MapName, ElementSize, DoneBB,</Highlight></CodeLine>
<Link id="l08153" /><CodeLine lineNumber="8153"><Highlight kind="normal">                             </Highlight><Highlight kind="comment">/&#42;IsInit=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08154" /><CodeLine lineNumber="8154"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08155" /><CodeLine lineNumber="8155"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the function exit block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08156" /><CodeLine lineNumber="8156"><Highlight kind="normal">  emitBlock(DoneBB, MapperFn, </Highlight><Highlight kind="comment">/&#42;IsFinished=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08157" /><CodeLine lineNumber="8157"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08158" /><CodeLine lineNumber="8158"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa6536556982b7e6e2e5884e471f3ce6b">CreateRetVoid</a>();</Highlight></CodeLine>
<Link id="l08159" /><CodeLine lineNumber="8159"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(SavedIP);</Highlight></CodeLine>
<Link id="l08160" /><CodeLine lineNumber="8160"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> MapperFn;</Highlight></CodeLine>
<Link id="l08161" /><CodeLine lineNumber="8161"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08162" /><CodeLine lineNumber="8162"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08163" /><CodeLine lineNumber="8163"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitOffloadingArrays(</Highlight></CodeLine>
<Link id="l08164" /><CodeLine lineNumber="8164"><Highlight kind="normal">    InsertPointTy AllocaIP, InsertPointTy CodeGenIP, MapInfosTy &amp;CombinedInfo,</Highlight></CodeLine>
<Link id="l08165" /><CodeLine lineNumber="8165"><Highlight kind="normal">    TargetDataInfo &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsNonContiguous,</Highlight></CodeLine>
<Link id="l08166" /><CodeLine lineNumber="8166"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;</Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal">(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/value">Value</a> &#42;)&gt; DeviceAddrCB,</Highlight></CodeLine>
<Link id="l08167" /><CodeLine lineNumber="8167"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">function&#95;ref</a>&lt;<a href="/docs/api/classes/llvm/value">Value</a> &#42;(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">)&gt; CustomMapperCB) &#123;</Highlight></CodeLine>
<Link id="l08168" /><CodeLine lineNumber="8168"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08169" /><CodeLine lineNumber="8169"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Reset the array information.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08170" /><CodeLine lineNumber="8170"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.clearArrayInfo();</Highlight></CodeLine>
<Link id="l08171" /><CodeLine lineNumber="8171"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs = CombinedInfo.BasePointers.<a href="/docs/api/classes/llvm/function/#a969eb757b1e43b455d4a8d0f603e695b">size</a>();</Highlight></CodeLine>
<Link id="l08172" /><CodeLine lineNumber="8172"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08173" /><CodeLine lineNumber="8173"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs == 0)</Highlight></CodeLine>
<Link id="l08174" /><CodeLine lineNumber="8174"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08175" /><CodeLine lineNumber="8175"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08176" /><CodeLine lineNumber="8176"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l08177" /><CodeLine lineNumber="8177"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Detect if we have any capture size requiring runtime evaluation of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08178" /><CodeLine lineNumber="8178"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// size so that a constant array could be eventually used.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08179" /><CodeLine lineNumber="8179"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bacb17ff5177bb277ed8dd79480aad9c27">ArrayType</a> &#42;PointerArrayType =</Highlight></CodeLine>
<Link id="l08180" /><CodeLine lineNumber="8180"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>(), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs);</Highlight></CodeLine>
<Link id="l08181" /><CodeLine lineNumber="8181"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08182" /><CodeLine lineNumber="8182"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.BasePointersArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l08183" /><CodeLine lineNumber="8183"><Highlight kind="normal">      PointerArrayType, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.offload&#95;baseptrs&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08184" /><CodeLine lineNumber="8184"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08185" /><CodeLine lineNumber="8185"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.PointersArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l08186" /><CodeLine lineNumber="8186"><Highlight kind="normal">      PointerArrayType, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.offload&#95;ptrs&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08187" /><CodeLine lineNumber="8187"><Highlight kind="normal">  AllocaInst &#42;MappersArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l08188" /><CodeLine lineNumber="8188"><Highlight kind="normal">      PointerArrayType, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.offload&#95;mappers&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08189" /><CodeLine lineNumber="8189"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MappersArray = MappersArray;</Highlight></CodeLine>
<Link id="l08190" /><CodeLine lineNumber="8190"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08191" /><CodeLine lineNumber="8191"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we don&#39;t have any VLA types or other types that require runtime</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08192" /><CodeLine lineNumber="8192"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// evaluation, we can use a constant array for the map sizes, otherwise we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08193" /><CodeLine lineNumber="8193"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// need to fill up the arrays as we do for the pointers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08194" /><CodeLine lineNumber="8194"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;Int64Ty = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64748b5a9f8d8dd4499f84312e2c1336">getInt64Ty</a>();</Highlight></CodeLine>
<Link id="l08195" /><CodeLine lineNumber="8195"><Highlight kind="normal">  SmallVector&lt;Constant &#42;&gt; ConstSizes(CombinedInfo.Sizes.size(),</Highlight></CodeLine>
<Link id="l08196" /><CodeLine lineNumber="8196"><Highlight kind="normal">                                     ConstantInt::get(Int64Ty, 0));</Highlight></CodeLine>
<Link id="l08197" /><CodeLine lineNumber="8197"><Highlight kind="normal">  SmallBitVector RuntimeSizes(CombinedInfo.Sizes.size());</Highlight></CodeLine>
<Link id="l08198" /><CodeLine lineNumber="8198"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = CombinedInfo.Sizes.size(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l08199" /><CodeLine lineNumber="8199"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Constant&gt;</a>(CombinedInfo.Sizes&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;)) &#123;</Highlight></CodeLine>
<Link id="l08200" /><CodeLine lineNumber="8200"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;ConstantExpr&gt;</a>(CI) &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;GlobalValue&gt;</a>(CI)) &#123;</Highlight></CodeLine>
<Link id="l08201" /><CodeLine lineNumber="8201"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsNonContiguous &amp;&amp;</Highlight></CodeLine>
<Link id="l08202" /><CodeLine lineNumber="8202"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08203" /><CodeLine lineNumber="8203"><Highlight kind="normal">                CombinedInfo.Types&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; &amp;</Highlight></CodeLine>
<Link id="l08204" /><CodeLine lineNumber="8204"><Highlight kind="normal">                OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;NON&#95;CONTIG))</Highlight></CodeLine>
<Link id="l08205" /><CodeLine lineNumber="8205"><Highlight kind="normal">          ConstSizes&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; =</Highlight></CodeLine>
<Link id="l08206" /><CodeLine lineNumber="8206"><Highlight kind="normal">              ConstantInt::get(Int64Ty, CombinedInfo.NonContigInfo.Dims&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;);</Highlight></CodeLine>
<Link id="l08207" /><CodeLine lineNumber="8207"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08208" /><CodeLine lineNumber="8208"><Highlight kind="normal">          ConstSizes&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; = CI;</Highlight></CodeLine>
<Link id="l08209" /><CodeLine lineNumber="8209"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08210" /><CodeLine lineNumber="8210"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l08211" /><CodeLine lineNumber="8211"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08212" /><CodeLine lineNumber="8212"><Highlight kind="normal">    RuntimeSizes.set(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l08213" /><CodeLine lineNumber="8213"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08214" /><CodeLine lineNumber="8214"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08215" /><CodeLine lineNumber="8215"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RuntimeSizes.all()) &#123;</Highlight></CodeLine>
<Link id="l08216" /><CodeLine lineNumber="8216"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bacb17ff5177bb277ed8dd79480aad9c27">ArrayType</a> &#42;SizeArrayType = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Int64Ty, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs);</Highlight></CodeLine>
<Link id="l08217" /><CodeLine lineNumber="8217"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.SizesArray = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l08218" /><CodeLine lineNumber="8218"><Highlight kind="normal">        SizeArrayType, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.offload&#95;sizes&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08219" /><CodeLine lineNumber="8219"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l08220" /><CodeLine lineNumber="8220"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08221" /><CodeLine lineNumber="8221"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;SizesArrayInit = <a href="/docs/api/classes/llvm/constantarray/#a0900dacdc7ad8e3ea0cc92993c7fd422">ConstantArray::get</a>(</Highlight></CodeLine>
<Link id="l08222" /><CodeLine lineNumber="8222"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Int64Ty, ConstSizes.size()), ConstSizes);</Highlight></CodeLine>
<Link id="l08223" /><CodeLine lineNumber="8223"><Highlight kind="normal">    std::string <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a> = <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;</Highlight><Highlight kind="stringliteral">&quot;offload&#95;sizes&quot;</Highlight><Highlight kind="normal">&#125;);</Highlight></CodeLine>
<Link id="l08224" /><CodeLine lineNumber="8224"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;SizesArrayGbl =</Highlight></CodeLine>
<Link id="l08225" /><CodeLine lineNumber="8225"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> GlobalVariable(M, SizesArrayInit-&gt;getType(), </Highlight><Highlight kind="comment">/&#42;isConstant=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l08226" /><CodeLine lineNumber="8226"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">GlobalValue::PrivateLinkage</a>, SizesArrayInit, Name);</Highlight></CodeLine>
<Link id="l08227" /><CodeLine lineNumber="8227"><Highlight kind="normal">    SizesArrayGbl-&gt;setUnnamedAddr(<a href="/docs/api/classes/llvm/globalvalue/#ae8df4be75bfc50b1eadd74e85c25fa45a4cc6684df7b4a92b1dec6fce3264fac8">GlobalValue::UnnamedAddr::Global</a>);</Highlight></CodeLine>
<Link id="l08228" /><CodeLine lineNumber="8228"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08229" /><CodeLine lineNumber="8229"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!RuntimeSizes.any()) &#123;</Highlight></CodeLine>
<Link id="l08230" /><CodeLine lineNumber="8230"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.SizesArray = SizesArrayGbl;</Highlight></CodeLine>
<Link id="l08231" /><CodeLine lineNumber="8231"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08232" /><CodeLine lineNumber="8232"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IndexSize = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getIndexSizeInBits(0);</Highlight></CodeLine>
<Link id="l08233" /><CodeLine lineNumber="8233"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/arg/key/#a6b334a5f83504ebc99cc59f4f333ff98">Align</a> OffloadSizeAlign = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getABIIntegerTypeAlignment(64);</Highlight></CodeLine>
<Link id="l08234" /><CodeLine lineNumber="8234"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bacb17ff5177bb277ed8dd79480aad9c27">ArrayType</a> &#42;SizeArrayType = <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Int64Ty, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs);</Highlight></CodeLine>
<Link id="l08235" /><CodeLine lineNumber="8235"><Highlight kind="normal">      AllocaInst &#42;Buffer = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(</Highlight></CodeLine>
<Link id="l08236" /><CodeLine lineNumber="8236"><Highlight kind="normal">          SizeArrayType, </Highlight><Highlight kind="comment">/&#42; ArraySize = &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;.offload&#95;sizes&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08237" /><CodeLine lineNumber="8237"><Highlight kind="normal">      Buffer-&gt;<a href="/docs/api/classes/llvm/allocainst/#af3bb24b322533dbe8a63c84b18568fe1">setAlignment</a>(OffloadSizeAlign);</Highlight></CodeLine>
<Link id="l08238" /><CodeLine lineNumber="8238"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l08239" /><CodeLine lineNumber="8239"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ae9f2730f66215fdb82f4e41e45124811">CreateMemCpy</a>(</Highlight></CodeLine>
<Link id="l08240" /><CodeLine lineNumber="8240"><Highlight kind="normal">          Buffer, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(Buffer-&gt;<a href="/docs/api/classes/llvm/allocainst/#a5d19f3955a23e8eb2a974efcc8fb19da">getType</a>()),</Highlight></CodeLine>
<Link id="l08241" /><CodeLine lineNumber="8241"><Highlight kind="normal">          SizesArrayGbl, OffloadSizeAlign,</Highlight></CodeLine>
<Link id="l08242" /><CodeLine lineNumber="8242"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a95df4f20c933779306b9a936b88b99a5">getIntN</a>(</Highlight></CodeLine>
<Link id="l08243" /><CodeLine lineNumber="8243"><Highlight kind="normal">              IndexSize,</Highlight></CodeLine>
<Link id="l08244" /><CodeLine lineNumber="8244"><Highlight kind="normal">              Buffer-&gt;<a href="/docs/api/classes/llvm/allocainst/#ad92f6c67d55ced3de1569ee791c38679">getAllocationSize</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout())-&gt;getFixedValue()));</Highlight></CodeLine>
<Link id="l08245" /><CodeLine lineNumber="8245"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08246" /><CodeLine lineNumber="8246"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.SizesArray = Buffer;</Highlight></CodeLine>
<Link id="l08247" /><CodeLine lineNumber="8247"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08248" /><CodeLine lineNumber="8248"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l08249" /><CodeLine lineNumber="8249"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08250" /><CodeLine lineNumber="8250"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08251" /><CodeLine lineNumber="8251"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The map types are always constant so we don&#39;t need to generate code to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08252" /><CodeLine lineNumber="8252"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// fill arrays. Instead, we create an array constant.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08253" /><CodeLine lineNumber="8253"><Highlight kind="normal">  SmallVector&lt;uint64&#95;t, 4&gt; Mapping;</Highlight></CodeLine>
<Link id="l08254" /><CodeLine lineNumber="8254"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> mapFlag : CombinedInfo.Types)</Highlight></CodeLine>
<Link id="l08255" /><CodeLine lineNumber="8255"><Highlight kind="normal">    Mapping.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight></CodeLine>
<Link id="l08256" /><CodeLine lineNumber="8256"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08257" /><CodeLine lineNumber="8257"><Highlight kind="normal">            mapFlag));</Highlight></CodeLine>
<Link id="l08258" /><CodeLine lineNumber="8258"><Highlight kind="normal">  std::string MaptypesName = <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;</Highlight><Highlight kind="stringliteral">&quot;offload&#95;maptypes&quot;</Highlight><Highlight kind="normal">&#125;);</Highlight></CodeLine>
<Link id="l08259" /><CodeLine lineNumber="8259"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;MapTypesArrayGbl = createOffloadMaptypes(Mapping, MaptypesName);</Highlight></CodeLine>
<Link id="l08260" /><CodeLine lineNumber="8260"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MapTypesArray = MapTypesArrayGbl;</Highlight></CodeLine>
<Link id="l08261" /><CodeLine lineNumber="8261"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08262" /><CodeLine lineNumber="8262"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The information types are only built if provided.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08263" /><CodeLine lineNumber="8263"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CombinedInfo.Names.empty()) &#123;</Highlight></CodeLine>
<Link id="l08264" /><CodeLine lineNumber="8264"><Highlight kind="normal">    std::string MapnamesName = <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;</Highlight><Highlight kind="stringliteral">&quot;offload&#95;mapnames&quot;</Highlight><Highlight kind="normal">&#125;);</Highlight></CodeLine>
<Link id="l08265" /><CodeLine lineNumber="8265"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;MapNamesArrayGbl =</Highlight></CodeLine>
<Link id="l08266" /><CodeLine lineNumber="8266"><Highlight kind="normal">        createOffloadMapnames(CombinedInfo.Names, MapnamesName);</Highlight></CodeLine>
<Link id="l08267" /><CodeLine lineNumber="8267"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MapNamesArray = MapNamesArrayGbl;</Highlight></CodeLine>
<Link id="l08268" /><CodeLine lineNumber="8268"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.EmitDebug = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08269" /><CodeLine lineNumber="8269"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08270" /><CodeLine lineNumber="8270"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MapNamesArray =</Highlight></CodeLine>
<Link id="l08271" /><CodeLine lineNumber="8271"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa2ed385be8984b4306762990278eb13d">getContext</a>()));</Highlight></CodeLine>
<Link id="l08272" /><CodeLine lineNumber="8272"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.EmitDebug = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08273" /><CodeLine lineNumber="8273"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08274" /><CodeLine lineNumber="8274"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08275" /><CodeLine lineNumber="8275"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there&#39;s a present map type modifier, it must not be applied to the end</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08276" /><CodeLine lineNumber="8276"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// of a region, so generate a separate map type array in that case.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08277" /><CodeLine lineNumber="8277"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.separateBeginEndCalls()) &#123;</Highlight></CodeLine>
<Link id="l08278" /><CodeLine lineNumber="8278"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> EndMapTypesDiffer = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08279" /><CodeLine lineNumber="8279"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (uint64&#95;t &amp;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> : Mapping) &#123;</Highlight></CodeLine>
<Link id="l08280" /><CodeLine lineNumber="8280"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &amp; </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l08281" /><CodeLine lineNumber="8281"><Highlight kind="normal">                     OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;PRESENT)) &#123;</Highlight></CodeLine>
<Link id="l08282" /><CodeLine lineNumber="8282"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &amp;= ~static&#95;cast&lt;std::underlying&#95;type&#95;t&lt;OpenMPOffloadMappingFlags&gt;&gt;(</Highlight></CodeLine>
<Link id="l08283" /><CodeLine lineNumber="8283"><Highlight kind="normal">            OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;PRESENT);</Highlight></CodeLine>
<Link id="l08284" /><CodeLine lineNumber="8284"><Highlight kind="normal">        EndMapTypesDiffer = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08285" /><CodeLine lineNumber="8285"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l08286" /><CodeLine lineNumber="8286"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08287" /><CodeLine lineNumber="8287"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EndMapTypesDiffer) &#123;</Highlight></CodeLine>
<Link id="l08288" /><CodeLine lineNumber="8288"><Highlight kind="normal">      MapTypesArrayGbl = createOffloadMaptypes(Mapping, MaptypesName);</Highlight></CodeLine>
<Link id="l08289" /><CodeLine lineNumber="8289"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.MapTypesArrayEnd = MapTypesArrayGbl;</Highlight></CodeLine>
<Link id="l08290" /><CodeLine lineNumber="8290"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08291" /><CodeLine lineNumber="8291"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08292" /><CodeLine lineNumber="8292"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08293" /><CodeLine lineNumber="8293"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/pdb/#a33e853ec74d48b1340d1d4bae772d30bae385c38bb67ea909198e13ee23c21028">PointerType</a> &#42;PtrTy = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab73bb6948312ca0f98055c6a74c37045">getPtrTy</a>();</Highlight></CodeLine>
<Link id="l08294" /><CodeLine lineNumber="8294"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l08295" /><CodeLine lineNumber="8295"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BPVal = CombinedInfo.BasePointers&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</Highlight></CodeLine>
<Link id="l08296" /><CodeLine lineNumber="8296"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;BP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l08297" /><CodeLine lineNumber="8297"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(PtrTy, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.BasePointersArray,</Highlight></CodeLine>
<Link id="l08298" /><CodeLine lineNumber="8298"><Highlight kind="normal">        0, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l08299" /><CodeLine lineNumber="8299"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(BPVal, BP,</Highlight></CodeLine>
<Link id="l08300" /><CodeLine lineNumber="8300"><Highlight kind="normal">                               <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(PtrTy));</Highlight></CodeLine>
<Link id="l08301" /><CodeLine lineNumber="8301"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08302" /><CodeLine lineNumber="8302"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.requiresDevicePointerInfo()) &#123;</Highlight></CodeLine>
<Link id="l08303" /><CodeLine lineNumber="8303"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CombinedInfo.DevicePointers&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; == DeviceInfoTy::Pointer) &#123;</Highlight></CodeLine>
<Link id="l08304" /><CodeLine lineNumber="8304"><Highlight kind="normal">        CodeGenIP = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l08305" /><CodeLine lineNumber="8305"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l08306" /><CodeLine lineNumber="8306"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.DevicePtrInfoMap&#91;BPVal&#93; = &#123;BP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(PtrTy)&#125;;</Highlight></CodeLine>
<Link id="l08307" /><CodeLine lineNumber="8307"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(CodeGenIP);</Highlight></CodeLine>
<Link id="l08308" /><CodeLine lineNumber="8308"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DeviceAddrCB)</Highlight></CodeLine>
<Link id="l08309" /><CodeLine lineNumber="8309"><Highlight kind="normal">          DeviceAddrCB(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.DevicePtrInfoMap&#91;BPVal&#93;.second);</Highlight></CodeLine>
<Link id="l08310" /><CodeLine lineNumber="8310"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CombinedInfo.DevicePointers&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; == DeviceInfoTy::Address) &#123;</Highlight></CodeLine>
<Link id="l08311" /><CodeLine lineNumber="8311"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.DevicePtrInfoMap&#91;BPVal&#93; = &#123;BP, BP&#125;;</Highlight></CodeLine>
<Link id="l08312" /><CodeLine lineNumber="8312"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DeviceAddrCB)</Highlight></CodeLine>
<Link id="l08313" /><CodeLine lineNumber="8313"><Highlight kind="normal">          DeviceAddrCB(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, BP);</Highlight></CodeLine>
<Link id="l08314" /><CodeLine lineNumber="8314"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l08315" /><CodeLine lineNumber="8315"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08316" /><CodeLine lineNumber="8316"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08317" /><CodeLine lineNumber="8317"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PVal = CombinedInfo.Pointers&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</Highlight></CodeLine>
<Link id="l08318" /><CodeLine lineNumber="8318"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l08319" /><CodeLine lineNumber="8319"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(PtrTy, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.PointersArray, 0,</Highlight></CodeLine>
<Link id="l08320" /><CodeLine lineNumber="8320"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l08321" /><CodeLine lineNumber="8321"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Check alignment correct.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08322" /><CodeLine lineNumber="8322"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(PVal, <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>,</Highlight></CodeLine>
<Link id="l08323" /><CodeLine lineNumber="8323"><Highlight kind="normal">                               <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(PtrTy));</Highlight></CodeLine>
<Link id="l08324" /><CodeLine lineNumber="8324"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08325" /><CodeLine lineNumber="8325"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RuntimeSizes.test(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &#123;</Highlight></CodeLine>
<Link id="l08326" /><CodeLine lineNumber="8326"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;S = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa85037712ab4c5044582974769aa4b62">CreateConstInBoundsGEP2&#95;32</a>(</Highlight></CodeLine>
<Link id="l08327" /><CodeLine lineNumber="8327"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">ArrayType::get</a>(Int64Ty, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.RTArgs.SizesArray,</Highlight></CodeLine>
<Link id="l08328" /><CodeLine lineNumber="8328"><Highlight kind="normal">          </Highlight><Highlight kind="comment">/&#42;Idx0=&#42;/</Highlight><Highlight kind="normal">0,</Highlight></CodeLine>
<Link id="l08329" /><CodeLine lineNumber="8329"><Highlight kind="normal">          </Highlight><Highlight kind="comment">/&#42;Idx1=&#42;/</Highlight><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l08330" /><CodeLine lineNumber="8330"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac79ca3c2d2d74cf33684397a91846564">CreateIntCast</a>(CombinedInfo.Sizes&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;,</Highlight></CodeLine>
<Link id="l08331" /><CodeLine lineNumber="8331"><Highlight kind="normal">                                                       Int64Ty,</Highlight></CodeLine>
<Link id="l08332" /><CodeLine lineNumber="8332"><Highlight kind="normal">                                                       </Highlight><Highlight kind="comment">/&#42;isSigned=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l08333" /><CodeLine lineNumber="8333"><Highlight kind="normal">                                 S, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(PtrTy));</Highlight></CodeLine>
<Link id="l08334" /><CodeLine lineNumber="8334"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08335" /><CodeLine lineNumber="8335"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Fill up the mapper array.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08336" /><CodeLine lineNumber="8336"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IndexSize = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getIndexSizeInBits(0);</Highlight></CodeLine>
<Link id="l08337" /><CodeLine lineNumber="8337"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MFunc = <a href="/docs/api/classes/llvm/constantpointernull/#a96f5c85e4022e369266541b2db3fda69">ConstantPointerNull::get</a>(PtrTy);</Highlight></CodeLine>
<Link id="l08338" /><CodeLine lineNumber="8338"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CustomMapperCB)</Highlight></CodeLine>
<Link id="l08339" /><CodeLine lineNumber="8339"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;CustomMFunc = CustomMapperCB(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</Highlight></CodeLine>
<Link id="l08340" /><CodeLine lineNumber="8340"><Highlight kind="normal">        MFunc = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a3ef26a11123d639b64307cc3c1b869b9">CreatePointerCast</a>(CustomMFunc, PtrTy);</Highlight></CodeLine>
<Link id="l08341" /><CodeLine lineNumber="8341"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;MAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a64b6c97b8faad5ec83f37d906fca7bc4">CreateInBoundsGEP</a>(</Highlight></CodeLine>
<Link id="l08342" /><CodeLine lineNumber="8342"><Highlight kind="normal">        MappersArray-&gt;<a href="/docs/api/classes/llvm/allocainst/#a9b5ec84ea363eca9e35ddca20a5313af">getAllocatedType</a>(), MappersArray,</Highlight></CodeLine>
<Link id="l08343" /><CodeLine lineNumber="8343"><Highlight kind="normal">        &#123;Builder.getIntN(IndexSize, 0), Builder.getIntN(IndexSize, I)&#125;);</Highlight></CodeLine>
<Link id="l08344" /><CodeLine lineNumber="8344"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ad4e4b11a1bf18be51b28b7fadfaa97d6">CreateAlignedStore</a>(</Highlight></CodeLine>
<Link id="l08345" /><CodeLine lineNumber="8345"><Highlight kind="normal">        MFunc, MAddr, <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getDataLayout().getPrefTypeAlign(MAddr-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()));</Highlight></CodeLine>
<Link id="l08346" /><CodeLine lineNumber="8346"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08347" /><CodeLine lineNumber="8347"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08348" /><CodeLine lineNumber="8348"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsNonContiguous || CombinedInfo.NonContigInfo.Offsets.empty() ||</Highlight></CodeLine>
<Link id="l08349" /><CodeLine lineNumber="8349"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>.NumberOfPtrs == 0)</Highlight></CodeLine>
<Link id="l08350" /><CodeLine lineNumber="8350"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08351" /><CodeLine lineNumber="8351"><Highlight kind="normal">  emitNonContiguousDescriptor(AllocaIP, CodeGenIP, CombinedInfo, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/cseinfo-cpp/#a75f8a8519c2c9b30e7c06dc5e256fffa">Info</a>);</Highlight></CodeLine>
<Link id="l08352" /><CodeLine lineNumber="8352"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08353" /><CodeLine lineNumber="8353"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08354" /><CodeLine lineNumber="8354"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitBranch(<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/classes/llvm/target">Target</a>) &#123;</Highlight></CodeLine>
<Link id="l08355" /><CodeLine lineNumber="8355"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CurBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l08356" /><CodeLine lineNumber="8356"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08357" /><CodeLine lineNumber="8357"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CurBB || CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()) &#123;</Highlight></CodeLine>
<Link id="l08358" /><CodeLine lineNumber="8358"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If there is no insert point or the previous block is already</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08359" /><CodeLine lineNumber="8359"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// terminated, don&#39;t touch it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08360" /><CodeLine lineNumber="8360"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08361" /><CodeLine lineNumber="8361"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Otherwise, create a fall-through branch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08362" /><CodeLine lineNumber="8362"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(<a href="/docs/api/namespaces/llvm/omp/#afeaad9a7fc12d9246c2e42578fddc718ac41a31890959544c6523af684561abe5">Target</a>);</Highlight></CodeLine>
<Link id="l08363" /><CodeLine lineNumber="8363"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08364" /><CodeLine lineNumber="8364"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08365" /><CodeLine lineNumber="8365"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abfaa2c91fd145d6b7e623cabd26ec1de">ClearInsertionPoint</a>();</Highlight></CodeLine>
<Link id="l08366" /><CodeLine lineNumber="8366"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08367" /><CodeLine lineNumber="8367"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08368" /><CodeLine lineNumber="8368"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::emitBlock(<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB, <a href="/docs/api/classes/llvm/function">Function</a> &#42;CurFn,</Highlight></CodeLine>
<Link id="l08369" /><CodeLine lineNumber="8369"><Highlight kind="normal">                                </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsFinished) &#123;</Highlight></CodeLine>
<Link id="l08370" /><CodeLine lineNumber="8370"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CurBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l08371" /><CodeLine lineNumber="8371"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08372" /><CodeLine lineNumber="8372"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Fall out of the current block (if necessary).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08373" /><CodeLine lineNumber="8373"><Highlight kind="normal">  emitBranch(BB);</Highlight></CodeLine>
<Link id="l08374" /><CodeLine lineNumber="8374"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08375" /><CodeLine lineNumber="8375"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsFinished &amp;&amp; BB-&gt;<a href="/docs/api/classes/llvm/value/#a9d7de807ebdfe1819df3ff6cb0f16158">use&#95;empty</a>()) &#123;</Highlight></CodeLine>
<Link id="l08376" /><CodeLine lineNumber="8376"><Highlight kind="normal">    BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a8dd327a937563afdb08250abc43820b0">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08377" /><CodeLine lineNumber="8377"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08378" /><CodeLine lineNumber="8378"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08379" /><CodeLine lineNumber="8379"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08380" /><CodeLine lineNumber="8380"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Place the block after the current block, if possible, or else at</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08381" /><CodeLine lineNumber="8381"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the end of the function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08382" /><CodeLine lineNumber="8382"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CurBB &amp;&amp; CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>())</Highlight></CodeLine>
<Link id="l08383" /><CodeLine lineNumber="8383"><Highlight kind="normal">    CurFn-&gt;<a href="/docs/api/classes/llvm/function/#aaab8110aafc070c83bc701b13d2260df">insert</a>(std::next(CurBB-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>()), BB);</Highlight></CodeLine>
<Link id="l08384" /><CodeLine lineNumber="8384"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08385" /><CodeLine lineNumber="8385"><Highlight kind="normal">    CurFn-&gt;<a href="/docs/api/classes/llvm/function/#aaab8110aafc070c83bc701b13d2260df">insert</a>(CurFn-&gt;<a href="/docs/api/classes/llvm/function/#ae4ca2261b8b901e415fda7feac5051ea">end</a>(), BB);</Highlight></CodeLine>
<Link id="l08386" /><CodeLine lineNumber="8386"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(BB);</Highlight></CodeLine>
<Link id="l08387" /><CodeLine lineNumber="8387"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08388" /><CodeLine lineNumber="8388"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08389" /><CodeLine lineNumber="8389"><Highlight kind="normal"><a href="/docs/api/classes/llvm/error">Error</a> OpenMPIRBuilder::emitIfClause(<a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, BodyGenCallbackTy ThenGen,</Highlight></CodeLine>
<Link id="l08390" /><CodeLine lineNumber="8390"><Highlight kind="normal">                                    BodyGenCallbackTy ElseGen,</Highlight></CodeLine>
<Link id="l08391" /><CodeLine lineNumber="8391"><Highlight kind="normal">                                    InsertPointTy AllocaIP) &#123;</Highlight></CodeLine>
<Link id="l08392" /><CodeLine lineNumber="8392"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If the condition constant folds and can be elided, try to avoid emitting</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08393" /><CodeLine lineNumber="8393"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the condition and the dead arm of the if/else.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08394" /><CodeLine lineNumber="8394"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>)) &#123;</Highlight></CodeLine>
<Link id="l08395" /><CodeLine lineNumber="8395"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> CondConstant = CI-&gt;getSExtValue();</Highlight></CodeLine>
<Link id="l08396" /><CodeLine lineNumber="8396"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CondConstant)</Highlight></CodeLine>
<Link id="l08397" /><CodeLine lineNumber="8397"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ThenGen(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l08398" /><CodeLine lineNumber="8398"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08399" /><CodeLine lineNumber="8399"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ElseGen(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>());</Highlight></CodeLine>
<Link id="l08400" /><CodeLine lineNumber="8400"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08401" /><CodeLine lineNumber="8401"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08402" /><CodeLine lineNumber="8402"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;CurFn = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l08403" /><CodeLine lineNumber="8403"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08404" /><CodeLine lineNumber="8404"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Otherwise, the condition did not fold, or we couldn&#39;t elide it.  Just</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08405" /><CodeLine lineNumber="8405"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// emit the conditional branch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08406" /><CodeLine lineNumber="8406"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ThenBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;if.then&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08407" /><CodeLine lineNumber="8407"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ElseBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;if.else&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08408" /><CodeLine lineNumber="8408"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ContBlock = <a href="/docs/api/classes/llvm/basicblock/#a4a5b798214be930cf8e133c032ba0129">BasicBlock::Create</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;if.end&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08409" /><CodeLine lineNumber="8409"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, ThenBlock, ElseBlock);</Highlight></CodeLine>
<Link id="l08410" /><CodeLine lineNumber="8410"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the &#39;then&#39; code.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08411" /><CodeLine lineNumber="8411"><Highlight kind="normal">  emitBlock(ThenBlock, CurFn);</Highlight></CodeLine>
<Link id="l08412" /><CodeLine lineNumber="8412"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = ThenGen(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()))</Highlight></CodeLine>
<Link id="l08413" /><CodeLine lineNumber="8413"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l08414" /><CodeLine lineNumber="8414"><Highlight kind="normal">  emitBranch(ContBlock);</Highlight></CodeLine>
<Link id="l08415" /><CodeLine lineNumber="8415"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the &#39;else&#39; code if present.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08416" /><CodeLine lineNumber="8416"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// There is no need to emit line number for unconditional branch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08417" /><CodeLine lineNumber="8417"><Highlight kind="normal">  emitBlock(ElseBlock, CurFn);</Highlight></CodeLine>
<Link id="l08418" /><CodeLine lineNumber="8418"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = ElseGen(AllocaIP, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>()))</Highlight></CodeLine>
<Link id="l08419" /><CodeLine lineNumber="8419"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l08420" /><CodeLine lineNumber="8420"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// There is no need to emit line number for unconditional branch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08421" /><CodeLine lineNumber="8421"><Highlight kind="normal">  emitBranch(ContBlock);</Highlight></CodeLine>
<Link id="l08422" /><CodeLine lineNumber="8422"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit the continuation block for code after the if.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08423" /><CodeLine lineNumber="8423"><Highlight kind="normal">  emitBlock(ContBlock, CurFn, </Highlight><Highlight kind="comment">/&#42;IsFinished=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08424" /><CodeLine lineNumber="8424"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/error/#a4dfd0813c3d0e0a30439b5a3e9196b59">Error::success</a>();</Highlight></CodeLine>
<Link id="l08425" /><CodeLine lineNumber="8425"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08426" /><CodeLine lineNumber="8426"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08427" /><CodeLine lineNumber="8427"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> OpenMPIRBuilder::checkAndEmitFlushAfterAtomic(</Highlight></CodeLine>
<Link id="l08428" /><CodeLine lineNumber="8428"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">llvm::AtomicOrdering</a> AO, AtomicKind AK) &#123;</Highlight></CodeLine>
<Link id="l08429" /><CodeLine lineNumber="8429"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!(AO == <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a56a57d29a3f9dda8671b4d6490a94b08">AtomicOrdering::NotAtomic</a> ||</Highlight></CodeLine>
<Link id="l08430" /><CodeLine lineNumber="8430"><Highlight kind="normal">           AO == <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a288d468c5e0969f26a310773eda65603">llvm::AtomicOrdering::Unordered</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l08431" /><CodeLine lineNumber="8431"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Unexpected Atomic Ordering.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08432" /><CodeLine lineNumber="8432"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08433" /><CodeLine lineNumber="8433"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Flush = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08434" /><CodeLine lineNumber="8434"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">llvm::AtomicOrdering</a> FlushAO = <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a14194d0b2e6c6680067975517cd58eac">AtomicOrdering::Monotonic</a>;</Highlight></CodeLine>
<Link id="l08435" /><CodeLine lineNumber="8435"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08436" /><CodeLine lineNumber="8436"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (AK) &#123;</Highlight></CodeLine>
<Link id="l08437" /><CodeLine lineNumber="8437"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a171c000a87a56f9b4c9b4e3f43c5facfa33af1aad55fa136e2ab54409f4b4891f">Read</a>:</Highlight></CodeLine>
<Link id="l08438" /><CodeLine lineNumber="8438"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AO == <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a993ca650a85e8e69b8f7eaa4809c4862">AtomicOrdering::Acquire</a> || AO == <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a960fbd067612ca87e16d5dfdb12fe40a">AtomicOrdering::AcquireRelease</a> ||</Highlight></CodeLine>
<Link id="l08439" /><CodeLine lineNumber="8439"><Highlight kind="normal">        AO == <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7ae3b0fa849dbd758b450f98fcfde936a2">AtomicOrdering::SequentiallyConsistent</a>) &#123;</Highlight></CodeLine>
<Link id="l08440" /><CodeLine lineNumber="8440"><Highlight kind="normal">      FlushAO = <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a993ca650a85e8e69b8f7eaa4809c4862">AtomicOrdering::Acquire</a>;</Highlight></CodeLine>
<Link id="l08441" /><CodeLine lineNumber="8441"><Highlight kind="normal">      Flush = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08442" /><CodeLine lineNumber="8442"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08443" /><CodeLine lineNumber="8443"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08444" /><CodeLine lineNumber="8444"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a171c000a87a56f9b4c9b4e3f43c5facfa738b693496ce85aba70051f0aa8722bd">Write</a>:</Highlight></CodeLine>
<Link id="l08445" /><CodeLine lineNumber="8445"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/mcid/#ab357441fcd1ea1f9b0d27c12700f6023a1328ed43be8173506f59f88c9bfd8b8c">Compare</a>:</Highlight></CodeLine>
<Link id="l08446" /><CodeLine lineNumber="8446"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Update:</Highlight></CodeLine>
<Link id="l08447" /><CodeLine lineNumber="8447"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AO == <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7ab8e7b465df7c5979dc731d06e84ce2cf">AtomicOrdering::Release</a> || AO == <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a960fbd067612ca87e16d5dfdb12fe40a">AtomicOrdering::AcquireRelease</a> ||</Highlight></CodeLine>
<Link id="l08448" /><CodeLine lineNumber="8448"><Highlight kind="normal">        AO == <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7ae3b0fa849dbd758b450f98fcfde936a2">AtomicOrdering::SequentiallyConsistent</a>) &#123;</Highlight></CodeLine>
<Link id="l08449" /><CodeLine lineNumber="8449"><Highlight kind="normal">      FlushAO = <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7ab8e7b465df7c5979dc731d06e84ce2cf">AtomicOrdering::Release</a>;</Highlight></CodeLine>
<Link id="l08450" /><CodeLine lineNumber="8450"><Highlight kind="normal">      Flush = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08451" /><CodeLine lineNumber="8451"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08452" /><CodeLine lineNumber="8452"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08453" /><CodeLine lineNumber="8453"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Capture:</Highlight></CodeLine>
<Link id="l08454" /><CodeLine lineNumber="8454"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (AO) &#123;</Highlight></CodeLine>
<Link id="l08455" /><CodeLine lineNumber="8455"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a993ca650a85e8e69b8f7eaa4809c4862">AtomicOrdering::Acquire</a>:</Highlight></CodeLine>
<Link id="l08456" /><CodeLine lineNumber="8456"><Highlight kind="normal">      FlushAO = <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a993ca650a85e8e69b8f7eaa4809c4862">AtomicOrdering::Acquire</a>;</Highlight></CodeLine>
<Link id="l08457" /><CodeLine lineNumber="8457"><Highlight kind="normal">      Flush = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08458" /><CodeLine lineNumber="8458"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08459" /><CodeLine lineNumber="8459"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7ab8e7b465df7c5979dc731d06e84ce2cf">AtomicOrdering::Release</a>:</Highlight></CodeLine>
<Link id="l08460" /><CodeLine lineNumber="8460"><Highlight kind="normal">      FlushAO = <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7ab8e7b465df7c5979dc731d06e84ce2cf">AtomicOrdering::Release</a>;</Highlight></CodeLine>
<Link id="l08461" /><CodeLine lineNumber="8461"><Highlight kind="normal">      Flush = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08462" /><CodeLine lineNumber="8462"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08463" /><CodeLine lineNumber="8463"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a960fbd067612ca87e16d5dfdb12fe40a">AtomicOrdering::AcquireRelease</a>:</Highlight></CodeLine>
<Link id="l08464" /><CodeLine lineNumber="8464"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7ae3b0fa849dbd758b450f98fcfde936a2">AtomicOrdering::SequentiallyConsistent</a>:</Highlight></CodeLine>
<Link id="l08465" /><CodeLine lineNumber="8465"><Highlight kind="normal">      FlushAO = <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7a960fbd067612ca87e16d5dfdb12fe40a">AtomicOrdering::AcquireRelease</a>;</Highlight></CodeLine>
<Link id="l08466" /><CodeLine lineNumber="8466"><Highlight kind="normal">      Flush = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08467" /><CodeLine lineNumber="8467"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08468" /><CodeLine lineNumber="8468"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l08469" /><CodeLine lineNumber="8469"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// do nothing - leave silently.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08470" /><CodeLine lineNumber="8470"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08471" /><CodeLine lineNumber="8471"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08472" /><CodeLine lineNumber="8472"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08473" /><CodeLine lineNumber="8473"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08474" /><CodeLine lineNumber="8474"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Flush) &#123;</Highlight></CodeLine>
<Link id="l08475" /><CodeLine lineNumber="8475"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Currently Flush RT call still doesn&#39;t take memory&#95;ordering, so for when</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08476" /><CodeLine lineNumber="8476"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// that happens, this tries to do the resolution of which atomic ordering</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08477" /><CodeLine lineNumber="8477"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// to use with but issue the flush call</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08478" /><CodeLine lineNumber="8478"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: pass &#96;FlushAO&#96; after memory ordering support is added</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08479" /><CodeLine lineNumber="8479"><Highlight kind="normal">    (void)FlushAO;</Highlight></CodeLine>
<Link id="l08480" /><CodeLine lineNumber="8480"><Highlight kind="normal">    emitFlush(Loc);</Highlight></CodeLine>
<Link id="l08481" /><CodeLine lineNumber="8481"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08482" /><CodeLine lineNumber="8482"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08483" /><CodeLine lineNumber="8483"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// for AO == AtomicOrdering::Monotonic and  all other case combinations</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08484" /><CodeLine lineNumber="8484"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// do nothing</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08485" /><CodeLine lineNumber="8485"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Flush;</Highlight></CodeLine>
<Link id="l08486" /><CodeLine lineNumber="8486"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08487" /><CodeLine lineNumber="8487"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08488" /><CodeLine lineNumber="8488"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a></Highlight></CodeLine>
<Link id="l08489" /><CodeLine lineNumber="8489"><Highlight kind="normal">OpenMPIRBuilder::createAtomicRead(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l08490" /><CodeLine lineNumber="8490"><Highlight kind="normal">                                  AtomicOpValue &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, AtomicOpValue &amp;V,</Highlight></CodeLine>
<Link id="l08491" /><CodeLine lineNumber="8491"><Highlight kind="normal">                                  <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> AO) &#123;</Highlight></CodeLine>
<Link id="l08492" /><CodeLine lineNumber="8492"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l08493" /><CodeLine lineNumber="8493"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l08494" /><CodeLine lineNumber="8494"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08495" /><CodeLine lineNumber="8495"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var-&gt;getType()-&gt;isPointerTy() &amp;&amp;</Highlight></CodeLine>
<Link id="l08496" /><CodeLine lineNumber="8496"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;OMP Atomic expects a pointer to target memory&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08497" /><CodeLine lineNumber="8497"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;XElemTy = <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy;</Highlight></CodeLine>
<Link id="l08498" /><CodeLine lineNumber="8498"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>() || XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() ||</Highlight></CodeLine>
<Link id="l08499" /><CodeLine lineNumber="8499"><Highlight kind="normal">          XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() || XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l08500" /><CodeLine lineNumber="8500"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;OMP atomic read expected a scalar type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08501" /><CodeLine lineNumber="8501"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08502" /><CodeLine lineNumber="8502"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;XRead = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08503" /><CodeLine lineNumber="8503"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08504" /><CodeLine lineNumber="8504"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()) &#123;</Highlight></CodeLine>
<Link id="l08505" /><CodeLine lineNumber="8505"><Highlight kind="normal">    LoadInst &#42;XLD =</Highlight></CodeLine>
<Link id="l08506" /><CodeLine lineNumber="8506"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(XElemTy, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.IsVolatile, </Highlight><Highlight kind="stringliteral">&quot;omp.atomic.read&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08507" /><CodeLine lineNumber="8507"><Highlight kind="normal">    XLD-&gt;<a href="/docs/api/classes/llvm/loadinst/#a6ae88dc44b078c80ce3a25401fd4b05b">setAtomic</a>(AO);</Highlight></CodeLine>
<Link id="l08508" /><CodeLine lineNumber="8508"><Highlight kind="normal">    XRead = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Value&gt;</a>(XLD);</Highlight></CodeLine>
<Link id="l08509" /><CodeLine lineNumber="8509"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>()) &#123;</Highlight></CodeLine>
<Link id="l08510" /><CodeLine lineNumber="8510"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// FIXME: Add checks to ensure &#95;&#95;atomic&#95;load is emitted iff the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08511" /><CodeLine lineNumber="8511"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// target does not support &#96;atomicrmw&#96; of the size of the struct</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08512" /><CodeLine lineNumber="8512"><Highlight kind="normal">    LoadInst &#42;OldVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(XElemTy, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, </Highlight><Highlight kind="stringliteral">&quot;omp.atomic.read&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08513" /><CodeLine lineNumber="8513"><Highlight kind="normal">    OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#a6ae88dc44b078c80ce3a25401fd4b05b">setAtomic</a>(AO);</Highlight></CodeLine>
<Link id="l08514" /><CodeLine lineNumber="8514"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> DataLayout &amp;LoadDL = OldVal-&gt;<a href="/docs/api/classes/llvm/instruction/#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a href="/docs/api/classes/llvm/module/#abcbe492bce3ccc16e0bbb50292576c5c">getDataLayout</a>();</Highlight></CodeLine>
<Link id="l08515" /><CodeLine lineNumber="8515"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LoadSize =</Highlight></CodeLine>
<Link id="l08516" /><CodeLine lineNumber="8516"><Highlight kind="normal">        LoadDL.<a href="/docs/api/classes/llvm/datalayout/#acfcd22eb38dbfe1acbf138754297437a">getTypeStoreSize</a>(OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#a2d1ff28d6923802e165905b8d1766e76">getPointerOperand</a>()-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>());</Highlight></CodeLine>
<Link id="l08517" /><CodeLine lineNumber="8517"><Highlight kind="normal">    OpenMPIRBuilder::AtomicInfo atomicInfo(</Highlight></CodeLine>
<Link id="l08518" /><CodeLine lineNumber="8518"><Highlight kind="normal">        &amp;Builder, XElemTy, LoadSize &#42; 8, LoadSize &#42; 8, OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(),</Highlight></CodeLine>
<Link id="l08519" /><CodeLine lineNumber="8519"><Highlight kind="normal">        OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(), </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="comment">/&#42; UseLibcall &#42;/</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var);</Highlight></CodeLine>
<Link id="l08520" /><CodeLine lineNumber="8520"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> AtomicLoadRes = atomicInfo.EmitAtomicLoadLibcall(AO);</Highlight></CodeLine>
<Link id="l08521" /><CodeLine lineNumber="8521"><Highlight kind="normal">    XRead = AtomicLoadRes.first;</Highlight></CodeLine>
<Link id="l08522" /><CodeLine lineNumber="8522"><Highlight kind="normal">    OldVal-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08523" /><CodeLine lineNumber="8523"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08524" /><CodeLine lineNumber="8524"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// We need to perform atomic op as integer</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08525" /><CodeLine lineNumber="8525"><Highlight kind="normal">    IntegerType &#42;IntCastTy =</Highlight></CodeLine>
<Link id="l08526" /><CodeLine lineNumber="8526"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>());</Highlight></CodeLine>
<Link id="l08527" /><CodeLine lineNumber="8527"><Highlight kind="normal">    LoadInst &#42;XLoad =</Highlight></CodeLine>
<Link id="l08528" /><CodeLine lineNumber="8528"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(IntCastTy, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.IsVolatile, </Highlight><Highlight kind="stringliteral">&quot;omp.atomic.load&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08529" /><CodeLine lineNumber="8529"><Highlight kind="normal">    XLoad-&gt;<a href="/docs/api/classes/llvm/loadinst/#a6ae88dc44b078c80ce3a25401fd4b05b">setAtomic</a>(AO);</Highlight></CodeLine>
<Link id="l08530" /><CodeLine lineNumber="8530"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>()) &#123;</Highlight></CodeLine>
<Link id="l08531" /><CodeLine lineNumber="8531"><Highlight kind="normal">      XRead = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(XLoad, XElemTy, </Highlight><Highlight kind="stringliteral">&quot;atomic.flt.cast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08532" /><CodeLine lineNumber="8532"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08533" /><CodeLine lineNumber="8533"><Highlight kind="normal">      XRead = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a53541ed6f92b18419f937f1f969aa0f6">CreateIntToPtr</a>(XLoad, XElemTy, </Highlight><Highlight kind="stringliteral">&quot;atomic.ptr.cast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08534" /><CodeLine lineNumber="8534"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08535" /><CodeLine lineNumber="8535"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08536" /><CodeLine lineNumber="8536"><Highlight kind="normal">  checkAndEmitFlushAfterAtomic(Loc, AO, AtomicKind::Read);</Highlight></CodeLine>
<Link id="l08537" /><CodeLine lineNumber="8537"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (XRead-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.Var-&gt;getType())</Highlight></CodeLine>
<Link id="l08538" /><CodeLine lineNumber="8538"><Highlight kind="normal">    XRead = <a href="#a91b7eb2a05d10c788413bec7977f3474">emitImplicitCast</a>(Builder, XRead, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.Var);</Highlight></CodeLine>
<Link id="l08539" /><CodeLine lineNumber="8539"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(XRead, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.Var, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.IsVolatile);</Highlight></CodeLine>
<Link id="l08540" /><CodeLine lineNumber="8540"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l08541" /><CodeLine lineNumber="8541"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08542" /><CodeLine lineNumber="8542"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08543" /><CodeLine lineNumber="8543"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a></Highlight></CodeLine>
<Link id="l08544" /><CodeLine lineNumber="8544"><Highlight kind="normal">OpenMPIRBuilder::createAtomicWrite(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l08545" /><CodeLine lineNumber="8545"><Highlight kind="normal">                                   AtomicOpValue &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Expr,</Highlight></CodeLine>
<Link id="l08546" /><CodeLine lineNumber="8546"><Highlight kind="normal">                                   <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> AO) &#123;</Highlight></CodeLine>
<Link id="l08547" /><CodeLine lineNumber="8547"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(Loc))</Highlight></CodeLine>
<Link id="l08548" /><CodeLine lineNumber="8548"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Loc.IP;</Highlight></CodeLine>
<Link id="l08549" /><CodeLine lineNumber="8549"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08550" /><CodeLine lineNumber="8550"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var-&gt;getType()-&gt;isPointerTy() &amp;&amp;</Highlight></CodeLine>
<Link id="l08551" /><CodeLine lineNumber="8551"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;OMP Atomic expects a pointer to target memory&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08552" /><CodeLine lineNumber="8552"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a88ee8e4eea43084bd8964682683da88caa1fa27779242b4902f7ae3bdd5c6d508">Type</a> &#42;XElemTy = <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy;</Highlight></CodeLine>
<Link id="l08553" /><CodeLine lineNumber="8553"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>() || XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() ||</Highlight></CodeLine>
<Link id="l08554" /><CodeLine lineNumber="8554"><Highlight kind="normal">          XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l08555" /><CodeLine lineNumber="8555"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;OMP atomic write expected a scalar type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08556" /><CodeLine lineNumber="8556"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08557" /><CodeLine lineNumber="8557"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>()) &#123;</Highlight></CodeLine>
<Link id="l08558" /><CodeLine lineNumber="8558"><Highlight kind="normal">    StoreInst &#42;XSt = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Expr, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.IsVolatile);</Highlight></CodeLine>
<Link id="l08559" /><CodeLine lineNumber="8559"><Highlight kind="normal">    XSt-&gt;<a href="/docs/api/classes/llvm/storeinst/#aff28bd42ac76fc3e1c0e4db7f9e06f2d">setAtomic</a>(AO);</Highlight></CodeLine>
<Link id="l08560" /><CodeLine lineNumber="8560"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08561" /><CodeLine lineNumber="8561"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// We need to bitcast and perform atomic op as integers</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08562" /><CodeLine lineNumber="8562"><Highlight kind="normal">    IntegerType &#42;IntCastTy =</Highlight></CodeLine>
<Link id="l08563" /><CodeLine lineNumber="8563"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>());</Highlight></CodeLine>
<Link id="l08564" /><CodeLine lineNumber="8564"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ExprCast =</Highlight></CodeLine>
<Link id="l08565" /><CodeLine lineNumber="8565"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(Expr, IntCastTy, </Highlight><Highlight kind="stringliteral">&quot;atomic.src.int.cast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08566" /><CodeLine lineNumber="8566"><Highlight kind="normal">    StoreInst &#42;XSt = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(ExprCast, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.IsVolatile);</Highlight></CodeLine>
<Link id="l08567" /><CodeLine lineNumber="8567"><Highlight kind="normal">    XSt-&gt;<a href="/docs/api/classes/llvm/storeinst/#aff28bd42ac76fc3e1c0e4db7f9e06f2d">setAtomic</a>(AO);</Highlight></CodeLine>
<Link id="l08568" /><CodeLine lineNumber="8568"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08569" /><CodeLine lineNumber="8569"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08570" /><CodeLine lineNumber="8570"><Highlight kind="normal">  checkAndEmitFlushAfterAtomic(Loc, AO, AtomicKind::Write);</Highlight></CodeLine>
<Link id="l08571" /><CodeLine lineNumber="8571"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l08572" /><CodeLine lineNumber="8572"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08573" /><CodeLine lineNumber="8573"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08574" /><CodeLine lineNumber="8574" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ae75c4b44f208011259ee93497c2cb411"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> <a href="/docs/api/classes/llvm/openmpirbuilder/#ae75c4b44f208011259ee93497c2cb411">OpenMPIRBuilder::createAtomicUpdate</a>(</Highlight></CodeLine>
<Link id="l08575" /><CodeLine lineNumber="8575"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP, AtomicOpValue &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>,</Highlight></CodeLine>
<Link id="l08576" /><CodeLine lineNumber="8576"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;Expr, <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> AO, <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615">AtomicRMWInst::BinOp</a> RMWOp,</Highlight></CodeLine>
<Link id="l08577" /><CodeLine lineNumber="8577"><Highlight kind="normal">    AtomicUpdateCallbackTy &amp;UpdateOp, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsXBinopExpr) &#123;</Highlight></CodeLine>
<Link id="l08578" /><CodeLine lineNumber="8578"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="#a756b28f370cd5a39bc0ee3e5333b9c9b">isConflictIP</a>(<a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP, AllocaIP) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;IPs must not be ambiguous&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08579" /><CodeLine lineNumber="8579"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l08580" /><CodeLine lineNumber="8580"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP;</Highlight></CodeLine>
<Link id="l08581" /><CodeLine lineNumber="8581"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08582" /><CodeLine lineNumber="8582"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</Highlight></CodeLine>
<Link id="l08583" /><CodeLine lineNumber="8583"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;XTy = <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var-&gt;getType();</Highlight></CodeLine>
<Link id="l08584" /><CodeLine lineNumber="8584"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(XTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l08585" /><CodeLine lineNumber="8585"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;OMP Atomic expects a pointer to target memory&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08586" /><CodeLine lineNumber="8586"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;XElemTy = <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy;</Highlight></CodeLine>
<Link id="l08587" /><CodeLine lineNumber="8587"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>() || XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() ||</Highlight></CodeLine>
<Link id="l08588" /><CodeLine lineNumber="8588"><Highlight kind="normal">            XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l08589" /><CodeLine lineNumber="8589"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;OMP atomic update expected a scalar type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08590" /><CodeLine lineNumber="8590"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((RMWOp != <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa1184a7e35e94d162a2d40f2b11beeb2">AtomicRMWInst::Max</a>) &amp;&amp; (RMWOp != <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a39edb6e51c1ad37244e8b32a2af4077d">AtomicRMWInst::Min</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l08591" /><CodeLine lineNumber="8591"><Highlight kind="normal">           (RMWOp != <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abe171d96ba8de66fb30e08c00211591e">AtomicRMWInst::UMax</a>) &amp;&amp; (RMWOp != <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa53854e09143f57d2ff2ad6ac89dc55d">AtomicRMWInst::UMin</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l08592" /><CodeLine lineNumber="8592"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;OpenMP atomic does not support LT or GT operations&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08593" /><CodeLine lineNumber="8593"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l08594" /><CodeLine lineNumber="8594"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08595" /><CodeLine lineNumber="8595"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/expected">Expected&lt;std::pair&lt;Value &#42;, Value &#42;&gt;</a>&gt; AtomicResult =</Highlight></CodeLine>
<Link id="l08596" /><CodeLine lineNumber="8596"><Highlight kind="normal">      emitAtomicUpdate(AllocaIP, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy, Expr, AO, RMWOp, UpdateOp,</Highlight></CodeLine>
<Link id="l08597" /><CodeLine lineNumber="8597"><Highlight kind="normal">                       <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.IsVolatile, IsXBinopExpr);</Highlight></CodeLine>
<Link id="l08598" /><CodeLine lineNumber="8598"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AtomicResult)</Highlight></CodeLine>
<Link id="l08599" /><CodeLine lineNumber="8599"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AtomicResult.takeError();</Highlight></CodeLine>
<Link id="l08600" /><CodeLine lineNumber="8600"><Highlight kind="normal">  checkAndEmitFlushAfterAtomic(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, AO, AtomicKind::Update);</Highlight></CodeLine>
<Link id="l08601" /><CodeLine lineNumber="8601"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l08602" /><CodeLine lineNumber="8602"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08603" /><CodeLine lineNumber="8603"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08604" /><CodeLine lineNumber="8604"><Highlight kind="normal"></Highlight><Highlight kind="comment">// FIXME: Duplicating AtomicExpand</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08605" /><CodeLine lineNumber="8605"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;OpenMPIRBuilder::emitRMWOpAsInstruction(<a href="/docs/api/classes/llvm/value">Value</a> &#42;Src1, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Src2,</Highlight></CodeLine>
<Link id="l08606" /><CodeLine lineNumber="8606"><Highlight kind="normal">                                               <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615">AtomicRMWInst::BinOp</a> RMWOp) &#123;</Highlight></CodeLine>
<Link id="l08607" /><CodeLine lineNumber="8607"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (RMWOp) &#123;</Highlight></CodeLine>
<Link id="l08608" /><CodeLine lineNumber="8608"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a0794c42b44989f9d9f1454d79ca0dd88">AtomicRMWInst::Add</a>:</Highlight></CodeLine>
<Link id="l08609" /><CodeLine lineNumber="8609"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aada1d6d8de104a5cd1cb9a02c676cc6c">CreateAdd</a>(Src1, Src2);</Highlight></CodeLine>
<Link id="l08610" /><CodeLine lineNumber="8610"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a5db6ca0c3e18acd87290f22ccb2ce564">AtomicRMWInst::Sub</a>:</Highlight></CodeLine>
<Link id="l08611" /><CodeLine lineNumber="8611"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a92c83e803f2cf22906da0aaec44ff6d7">CreateSub</a>(Src1, Src2);</Highlight></CodeLine>
<Link id="l08612" /><CodeLine lineNumber="8612"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a660a31179bfecd737a256372e5fd6122">AtomicRMWInst::And</a>:</Highlight></CodeLine>
<Link id="l08613" /><CodeLine lineNumber="8613"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(Src1, Src2);</Highlight></CodeLine>
<Link id="l08614" /><CodeLine lineNumber="8614"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615afdcdc631cf4fa6829fd7499cd06a306b">AtomicRMWInst::Nand</a>:</Highlight></CodeLine>
<Link id="l08615" /><CodeLine lineNumber="8615"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a7704bf68951054ffeb3efe605750e2d9">CreateNeg</a>(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aa4f2cec52a8e17a4c72319334fbef771">CreateAnd</a>(Src1, Src2));</Highlight></CodeLine>
<Link id="l08616" /><CodeLine lineNumber="8616"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a5954f59053121b87ebe0c5fe79942c6e">AtomicRMWInst::Or</a>:</Highlight></CodeLine>
<Link id="l08617" /><CodeLine lineNumber="8617"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab61be8e3cf17e9848aeeeabacfa1b09a">CreateOr</a>(Src1, Src2);</Highlight></CodeLine>
<Link id="l08618" /><CodeLine lineNumber="8618"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a71aab8ee954b6d71a4eed315e8f6556e">AtomicRMWInst::Xor</a>:</Highlight></CodeLine>
<Link id="l08619" /><CodeLine lineNumber="8619"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#add2225af2af25968f26ed4cb0db94dbe">CreateXor</a>(Src1, Src2);</Highlight></CodeLine>
<Link id="l08620" /><CodeLine lineNumber="8620"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615afc870a548088c5b7a93a34f648889d77">AtomicRMWInst::Xchg</a>:</Highlight></CodeLine>
<Link id="l08621" /><CodeLine lineNumber="8621"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a08ef06068dcd583c2476568dda59b324">AtomicRMWInst::FAdd</a>:</Highlight></CodeLine>
<Link id="l08622" /><CodeLine lineNumber="8622"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a92f66d4bc04fc8514bee80509f3e78d4">AtomicRMWInst::FSub</a>:</Highlight></CodeLine>
<Link id="l08623" /><CodeLine lineNumber="8623"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a497e8f347648b1b2823ee0338c95f65f">AtomicRMWInst::BAD&#95;BINOP</a>:</Highlight></CodeLine>
<Link id="l08624" /><CodeLine lineNumber="8624"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa1184a7e35e94d162a2d40f2b11beeb2">AtomicRMWInst::Max</a>:</Highlight></CodeLine>
<Link id="l08625" /><CodeLine lineNumber="8625"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a39edb6e51c1ad37244e8b32a2af4077d">AtomicRMWInst::Min</a>:</Highlight></CodeLine>
<Link id="l08626" /><CodeLine lineNumber="8626"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abe171d96ba8de66fb30e08c00211591e">AtomicRMWInst::UMax</a>:</Highlight></CodeLine>
<Link id="l08627" /><CodeLine lineNumber="8627"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa53854e09143f57d2ff2ad6ac89dc55d">AtomicRMWInst::UMin</a>:</Highlight></CodeLine>
<Link id="l08628" /><CodeLine lineNumber="8628"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615acce124326ba87b0127b36c412bf555fd">AtomicRMWInst::FMax</a>:</Highlight></CodeLine>
<Link id="l08629" /><CodeLine lineNumber="8629"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abd5e733a10a36f3572105b1a67538e18">AtomicRMWInst::FMin</a>:</Highlight></CodeLine>
<Link id="l08630" /><CodeLine lineNumber="8630"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a9334c9815ddc2b25804c6c03b68cc39b">AtomicRMWInst::UIncWrap</a>:</Highlight></CodeLine>
<Link id="l08631" /><CodeLine lineNumber="8631"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615ad3ed1a8c334bc3a50d59aaa57ee9e9f3">AtomicRMWInst::UDecWrap</a>:</Highlight></CodeLine>
<Link id="l08632" /><CodeLine lineNumber="8632"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a0f94e2ef083268e45d22a220f92567a4">AtomicRMWInst::USubCond</a>:</Highlight></CodeLine>
<Link id="l08633" /><CodeLine lineNumber="8633"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a7bf1abb23eccced685c706917aff605c">AtomicRMWInst::USubSat</a>:</Highlight></CodeLine>
<Link id="l08634" /><CodeLine lineNumber="8634"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unsupported atomic update operation&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08635" /><CodeLine lineNumber="8635"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08636" /><CodeLine lineNumber="8636"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unsupported atomic update operation&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08637" /><CodeLine lineNumber="8637"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08638" /><CodeLine lineNumber="8638"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08639" /><CodeLine lineNumber="8639"><Highlight kind="normal"><a href="/docs/api/classes/llvm/expected">Expected&lt;std::pair&lt;Value &#42;, Value &#42;&gt;</a>&gt; OpenMPIRBuilder::emitAtomicUpdate(</Highlight></CodeLine>
<Link id="l08640" /><CodeLine lineNumber="8640"><Highlight kind="normal">    InsertPointTy AllocaIP, <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, <a href="/docs/api/classes/llvm/type">Type</a> &#42;XElemTy, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Expr,</Highlight></CodeLine>
<Link id="l08641" /><CodeLine lineNumber="8641"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> AO, <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615">AtomicRMWInst::BinOp</a> RMWOp,</Highlight></CodeLine>
<Link id="l08642" /><CodeLine lineNumber="8642"><Highlight kind="normal">    AtomicUpdateCallbackTy &amp;UpdateOp, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> VolatileX, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsXBinopExpr) &#123;</Highlight></CodeLine>
<Link id="l08643" /><CodeLine lineNumber="8643"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: handle the case where XElemTy is not byte-sized or not a power of 2</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08644" /><CodeLine lineNumber="8644"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// or a complex datatype.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08645" /><CodeLine lineNumber="8645"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> emitRMWOp = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08646" /><CodeLine lineNumber="8646"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (RMWOp) &#123;</Highlight></CodeLine>
<Link id="l08647" /><CodeLine lineNumber="8647"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a0794c42b44989f9d9f1454d79ca0dd88">AtomicRMWInst::Add</a>:</Highlight></CodeLine>
<Link id="l08648" /><CodeLine lineNumber="8648"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a660a31179bfecd737a256372e5fd6122">AtomicRMWInst::And</a>:</Highlight></CodeLine>
<Link id="l08649" /><CodeLine lineNumber="8649"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615afdcdc631cf4fa6829fd7499cd06a306b">AtomicRMWInst::Nand</a>:</Highlight></CodeLine>
<Link id="l08650" /><CodeLine lineNumber="8650"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a5954f59053121b87ebe0c5fe79942c6e">AtomicRMWInst::Or</a>:</Highlight></CodeLine>
<Link id="l08651" /><CodeLine lineNumber="8651"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a71aab8ee954b6d71a4eed315e8f6556e">AtomicRMWInst::Xor</a>:</Highlight></CodeLine>
<Link id="l08652" /><CodeLine lineNumber="8652"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615afc870a548088c5b7a93a34f648889d77">AtomicRMWInst::Xchg</a>:</Highlight></CodeLine>
<Link id="l08653" /><CodeLine lineNumber="8653"><Highlight kind="normal">    emitRMWOp = XElemTy;</Highlight></CodeLine>
<Link id="l08654" /><CodeLine lineNumber="8654"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08655" /><CodeLine lineNumber="8655"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a5db6ca0c3e18acd87290f22ccb2ce564">AtomicRMWInst::Sub</a>:</Highlight></CodeLine>
<Link id="l08656" /><CodeLine lineNumber="8656"><Highlight kind="normal">    emitRMWOp = (IsXBinopExpr &amp;&amp; XElemTy);</Highlight></CodeLine>
<Link id="l08657" /><CodeLine lineNumber="8657"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08658" /><CodeLine lineNumber="8658"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l08659" /><CodeLine lineNumber="8659"><Highlight kind="normal">    emitRMWOp = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08660" /><CodeLine lineNumber="8660"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08661" /><CodeLine lineNumber="8661"><Highlight kind="normal">  emitRMWOp &amp;= XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>();</Highlight></CodeLine>
<Link id="l08662" /><CodeLine lineNumber="8662"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08663" /><CodeLine lineNumber="8663"><Highlight kind="normal">  std::pair&lt;Value &#42;, Value &#42;&gt; Res;</Highlight></CodeLine>
<Link id="l08664" /><CodeLine lineNumber="8664"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (emitRMWOp) &#123;</Highlight></CodeLine>
<Link id="l08665" /><CodeLine lineNumber="8665"><Highlight kind="normal">    Res.first = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab2a2c89b21cf14b2c729a898006cb438">CreateAtomicRMW</a>(RMWOp, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, Expr, llvm::MaybeAlign(), AO);</Highlight></CodeLine>
<Link id="l08666" /><CodeLine lineNumber="8666"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// not needed except in case of postfix captures. Generate anyway for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08667" /><CodeLine lineNumber="8667"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// consistency with the else part. Will be removed with any DCE pass.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08668" /><CodeLine lineNumber="8668"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// AtomicRMWInst::Xchg does not have a coressponding instruction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08669" /><CodeLine lineNumber="8669"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RMWOp == <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615afc870a548088c5b7a93a34f648889d77">AtomicRMWInst::Xchg</a>)</Highlight></CodeLine>
<Link id="l08670" /><CodeLine lineNumber="8670"><Highlight kind="normal">      Res.second = Res.first;</Highlight></CodeLine>
<Link id="l08671" /><CodeLine lineNumber="8671"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08672" /><CodeLine lineNumber="8672"><Highlight kind="normal">      Res.second = emitRMWOpAsInstruction(Res.first, Expr, RMWOp);</Highlight></CodeLine>
<Link id="l08673" /><CodeLine lineNumber="8673"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RMWOp == <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a497e8f347648b1b2823ee0338c95f65f">llvm::AtomicRMWInst::BinOp::BAD&#95;BINOP</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l08674" /><CodeLine lineNumber="8674"><Highlight kind="normal">             XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a81eef9d7336f7ee43be79630d8e8ec86">isStructTy</a>()) &#123;</Highlight></CodeLine>
<Link id="l08675" /><CodeLine lineNumber="8675"><Highlight kind="normal">    LoadInst &#42;OldVal =</Highlight></CodeLine>
<Link id="l08676" /><CodeLine lineNumber="8676"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(XElemTy, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.load&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08677" /><CodeLine lineNumber="8677"><Highlight kind="normal">    OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#a6ae88dc44b078c80ce3a25401fd4b05b">setAtomic</a>(AO);</Highlight></CodeLine>
<Link id="l08678" /><CodeLine lineNumber="8678"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> DataLayout &amp;LoadDL = OldVal-&gt;<a href="/docs/api/classes/llvm/instruction/#a4ba3a5be6c0e9b9e8a525de055836733">getModule</a>()-&gt;<a href="/docs/api/classes/llvm/module/#abcbe492bce3ccc16e0bbb50292576c5c">getDataLayout</a>();</Highlight></CodeLine>
<Link id="l08679" /><CodeLine lineNumber="8679"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LoadSize =</Highlight></CodeLine>
<Link id="l08680" /><CodeLine lineNumber="8680"><Highlight kind="normal">        LoadDL.<a href="/docs/api/classes/llvm/datalayout/#acfcd22eb38dbfe1acbf138754297437a">getTypeStoreSize</a>(OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#a2d1ff28d6923802e165905b8d1766e76">getPointerOperand</a>()-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>());</Highlight></CodeLine>
<Link id="l08681" /><CodeLine lineNumber="8681"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08682" /><CodeLine lineNumber="8682"><Highlight kind="normal">    OpenMPIRBuilder::AtomicInfo atomicInfo(</Highlight></CodeLine>
<Link id="l08683" /><CodeLine lineNumber="8683"><Highlight kind="normal">        &amp;Builder, XElemTy, LoadSize &#42; 8, LoadSize &#42; 8, OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(),</Highlight></CodeLine>
<Link id="l08684" /><CodeLine lineNumber="8684"><Highlight kind="normal">        OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#af51c113a039c82f6870df5dc9666b5e3">getAlign</a>(), </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="comment">/&#42; UseLibcall &#42;/</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>);</Highlight></CodeLine>
<Link id="l08685" /><CodeLine lineNumber="8685"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> AtomicLoadRes = atomicInfo.EmitAtomicLoadLibcall(AO);</Highlight></CodeLine>
<Link id="l08686" /><CodeLine lineNumber="8686"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CurBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l08687" /><CodeLine lineNumber="8687"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;CurBBTI = CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l08688" /><CodeLine lineNumber="8688"><Highlight kind="normal">    CurBBTI = CurBBTI ? CurBBTI : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a39acc29443d48968a798fb22a76fa4c0">CreateUnreachable</a>();</Highlight></CodeLine>
<Link id="l08689" /><CodeLine lineNumber="8689"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ExitBB =</Highlight></CodeLine>
<Link id="l08690" /><CodeLine lineNumber="8690"><Highlight kind="normal">        CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(CurBBTI, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08691" /><CodeLine lineNumber="8691"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ContBB = CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>(),</Highlight></CodeLine>
<Link id="l08692" /><CodeLine lineNumber="8692"><Highlight kind="normal">                                                <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.cont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08693" /><CodeLine lineNumber="8693"><Highlight kind="normal">    ContBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08694" /><CodeLine lineNumber="8694"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l08695" /><CodeLine lineNumber="8695"><Highlight kind="normal">    AllocaInst &#42;NewAtomicAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(XElemTy);</Highlight></CodeLine>
<Link id="l08696" /><CodeLine lineNumber="8696"><Highlight kind="normal">    NewAtomicAddr-&gt;<a href="/docs/api/classes/llvm/value/#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;x.new.val&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08697" /><CodeLine lineNumber="8697"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ContBB);</Highlight></CodeLine>
<Link id="l08698" /><CodeLine lineNumber="8698"><Highlight kind="normal">    llvm::PHINode &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a876fb556ecea804faa2cd8ad1e498ec3">CreatePHI</a>(OldVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>(), 2);</Highlight></CodeLine>
<Link id="l08699" /><CodeLine lineNumber="8699"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(AtomicLoadRes.first, CurBB);</Highlight></CodeLine>
<Link id="l08700" /><CodeLine lineNumber="8700"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OldExprVal = <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>;</Highlight></CodeLine>
<Link id="l08701" /><CodeLine lineNumber="8701"><Highlight kind="normal">    Expected&lt;Value &#42;&gt; CBResult = UpdateOp(OldExprVal, Builder);</Highlight></CodeLine>
<Link id="l08702" /><CodeLine lineNumber="8702"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CBResult)</Highlight></CodeLine>
<Link id="l08703" /><CodeLine lineNumber="8703"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> CBResult.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l08704" /><CodeLine lineNumber="8704"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Upd = &#42;CBResult;</Highlight></CodeLine>
<Link id="l08705" /><CodeLine lineNumber="8705"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Upd, NewAtomicAddr);</Highlight></CodeLine>
<Link id="l08706" /><CodeLine lineNumber="8706"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> <a href="/docs/api/namespaces/llvm/remarks/#aeb5853e98ae4d9ab7cb002879736527fae139a585510a502bbf1841cf589f5086">Failure</a> =</Highlight></CodeLine>
<Link id="l08707" /><CodeLine lineNumber="8707"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/atomiccmpxchginst/#a7ce03ab5b2a6006ebcdfe804e4c8f1a1">llvm::AtomicCmpXchgInst::getStrongestFailureOrdering</a>(AO);</Highlight></CodeLine>
<Link id="l08708" /><CodeLine lineNumber="8708"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = atomicInfo.EmitAtomicCompareExchangeLibcall(</Highlight></CodeLine>
<Link id="l08709" /><CodeLine lineNumber="8709"><Highlight kind="normal">        AtomicLoadRes.second, NewAtomicAddr, AO, Failure);</Highlight></CodeLine>
<Link id="l08710" /><CodeLine lineNumber="8710"><Highlight kind="normal">    LoadInst &#42;PHILoad = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(XElemTy, <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.first);</Highlight></CodeLine>
<Link id="l08711" /><CodeLine lineNumber="8711"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;addIncoming(PHILoad, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>());</Highlight></CodeLine>
<Link id="l08712" /><CodeLine lineNumber="8712"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(<a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.second, ExitBB, ContBB);</Highlight></CodeLine>
<Link id="l08713" /><CodeLine lineNumber="8713"><Highlight kind="normal">    OldVal-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08714" /><CodeLine lineNumber="8714"><Highlight kind="normal">    Res.first = OldExprVal;</Highlight></CodeLine>
<Link id="l08715" /><CodeLine lineNumber="8715"><Highlight kind="normal">    Res.second = Upd;</Highlight></CodeLine>
<Link id="l08716" /><CodeLine lineNumber="8716"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08717" /><CodeLine lineNumber="8717"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UnreachableInst &#42;ExitTI =</Highlight></CodeLine>
<Link id="l08718" /><CodeLine lineNumber="8718"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;UnreachableInst&gt;</a>(ExitBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>())) &#123;</Highlight></CodeLine>
<Link id="l08719" /><CodeLine lineNumber="8719"><Highlight kind="normal">      CurBBTI-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08720" /><CodeLine lineNumber="8720"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ExitBB);</Highlight></CodeLine>
<Link id="l08721" /><CodeLine lineNumber="8721"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08722" /><CodeLine lineNumber="8722"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ExitTI);</Highlight></CodeLine>
<Link id="l08723" /><CodeLine lineNumber="8723"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08724" /><CodeLine lineNumber="8724"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08725" /><CodeLine lineNumber="8725"><Highlight kind="normal">    IntegerType &#42;IntCastTy =</Highlight></CodeLine>
<Link id="l08726" /><CodeLine lineNumber="8726"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext(), XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a9f382207d841377156d4c7868b66b9a5">getScalarSizeInBits</a>());</Highlight></CodeLine>
<Link id="l08727" /><CodeLine lineNumber="8727"><Highlight kind="normal">    LoadInst &#42;OldVal =</Highlight></CodeLine>
<Link id="l08728" /><CodeLine lineNumber="8728"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(IntCastTy, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.load&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08729" /><CodeLine lineNumber="8729"><Highlight kind="normal">    OldVal-&gt;<a href="/docs/api/classes/llvm/loadinst/#a6ae88dc44b078c80ce3a25401fd4b05b">setAtomic</a>(AO);</Highlight></CodeLine>
<Link id="l08730" /><CodeLine lineNumber="8730"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// CurBB</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08731" /><CodeLine lineNumber="8731"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// |     /---\\</Highlight></CodeLine>
<Link id="l08732" /><CodeLine lineNumber="8732"><Highlight kind="comment">    // ContBB    |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08733" /><CodeLine lineNumber="8733"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// |     \\---/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08734" /><CodeLine lineNumber="8734"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ExitBB</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08735" /><CodeLine lineNumber="8735"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;CurBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l08736" /><CodeLine lineNumber="8736"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/sandboxir/#a75d3582b0f0bc7a5123de92ada301e97">Instruction</a> &#42;CurBBTI = CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l08737" /><CodeLine lineNumber="8737"><Highlight kind="normal">    CurBBTI = CurBBTI ? CurBBTI : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a39acc29443d48968a798fb22a76fa4c0">CreateUnreachable</a>();</Highlight></CodeLine>
<Link id="l08738" /><CodeLine lineNumber="8738"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ExitBB =</Highlight></CodeLine>
<Link id="l08739" /><CodeLine lineNumber="8739"><Highlight kind="normal">        CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(CurBBTI, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08740" /><CodeLine lineNumber="8740"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/isd/#a22ea9cec080dd5f4f47ba234c2f59110a8472e46f9e4db168c5610ecdfb05dbaf">BasicBlock</a> &#42;ContBB = CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>(),</Highlight></CodeLine>
<Link id="l08741" /><CodeLine lineNumber="8741"><Highlight kind="normal">                                                <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.cont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08742" /><CodeLine lineNumber="8742"><Highlight kind="normal">    ContBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08743" /><CodeLine lineNumber="8743"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ac8778dcbd35e8ae5902050117feb57a0">restoreIP</a>(AllocaIP);</Highlight></CodeLine>
<Link id="l08744" /><CodeLine lineNumber="8744"><Highlight kind="normal">    AllocaInst &#42;NewAtomicAddr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a1b30cd686a320a8e5cb4532fd3a552a8">CreateAlloca</a>(XElemTy);</Highlight></CodeLine>
<Link id="l08745" /><CodeLine lineNumber="8745"><Highlight kind="normal">    NewAtomicAddr-&gt;<a href="/docs/api/classes/llvm/value/#a35ee267850af7c235474a8c46c7ac5af">setName</a>(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;x.new.val&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08746" /><CodeLine lineNumber="8746"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ContBB);</Highlight></CodeLine>
<Link id="l08747" /><CodeLine lineNumber="8747"><Highlight kind="normal">    llvm::PHINode &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a876fb556ecea804faa2cd8ad1e498ec3">CreatePHI</a>(OldVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>(), 2);</Highlight></CodeLine>
<Link id="l08748" /><CodeLine lineNumber="8748"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(OldVal, CurBB);</Highlight></CodeLine>
<Link id="l08749" /><CodeLine lineNumber="8749"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsIntTy = XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>();</Highlight></CodeLine>
<Link id="l08750" /><CodeLine lineNumber="8750"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;OldExprVal = <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>;</Highlight></CodeLine>
<Link id="l08751" /><CodeLine lineNumber="8751"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsIntTy) &#123;</Highlight></CodeLine>
<Link id="l08752" /><CodeLine lineNumber="8752"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>()) &#123;</Highlight></CodeLine>
<Link id="l08753" /><CodeLine lineNumber="8753"><Highlight kind="normal">        OldExprVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, XElemTy,</Highlight></CodeLine>
<Link id="l08754" /><CodeLine lineNumber="8754"><Highlight kind="normal">                                           <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.fltCast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08755" /><CodeLine lineNumber="8755"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08756" /><CodeLine lineNumber="8756"><Highlight kind="normal">        OldExprVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a53541ed6f92b18419f937f1f969aa0f6">CreateIntToPtr</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, XElemTy,</Highlight></CodeLine>
<Link id="l08757" /><CodeLine lineNumber="8757"><Highlight kind="normal">                                            <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.ptrCast&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08758" /><CodeLine lineNumber="8758"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l08759" /><CodeLine lineNumber="8759"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08760" /><CodeLine lineNumber="8760"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08761" /><CodeLine lineNumber="8761"><Highlight kind="normal">    Expected&lt;Value &#42;&gt; CBResult = UpdateOp(OldExprVal, Builder);</Highlight></CodeLine>
<Link id="l08762" /><CodeLine lineNumber="8762"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CBResult)</Highlight></CodeLine>
<Link id="l08763" /><CodeLine lineNumber="8763"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> CBResult.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l08764" /><CodeLine lineNumber="8764"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;Upd = &#42;CBResult;</Highlight></CodeLine>
<Link id="l08765" /><CodeLine lineNumber="8765"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(Upd, NewAtomicAddr);</Highlight></CodeLine>
<Link id="l08766" /><CodeLine lineNumber="8766"><Highlight kind="normal">    LoadInst &#42;DesiredVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9b01712e5f196d6d3d021ef23aad50e4">CreateLoad</a>(IntCastTy, NewAtomicAddr);</Highlight></CodeLine>
<Link id="l08767" /><CodeLine lineNumber="8767"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> <a href="/docs/api/namespaces/llvm/remarks/#aeb5853e98ae4d9ab7cb002879736527fae139a585510a502bbf1841cf589f5086">Failure</a> =</Highlight></CodeLine>
<Link id="l08768" /><CodeLine lineNumber="8768"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/atomiccmpxchginst/#a7ce03ab5b2a6006ebcdfe804e4c8f1a1">llvm::AtomicCmpXchgInst::getStrongestFailureOrdering</a>(AO);</Highlight></CodeLine>
<Link id="l08769" /><CodeLine lineNumber="8769"><Highlight kind="normal">    AtomicCmpXchgInst &#42;<a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a199f6765de1f6b1a242aac556528f3b3">CreateAtomicCmpXchg</a>(</Highlight></CodeLine>
<Link id="l08770" /><CodeLine lineNumber="8770"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, DesiredVal, llvm::MaybeAlign(), AO, Failure);</Highlight></CodeLine>
<Link id="l08771" /><CodeLine lineNumber="8771"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>-&gt;setVolatile(VolatileX);</Highlight></CodeLine>
<Link id="l08772" /><CodeLine lineNumber="8772"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;PreviousVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a41cf66866b0b0e5a10038bfb77477419">CreateExtractValue</a>(Result, </Highlight><Highlight kind="comment">/&#42;Idxs=&#42;/</Highlight><Highlight kind="normal">0);</Highlight></CodeLine>
<Link id="l08773" /><CodeLine lineNumber="8773"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;SuccessFailureVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a41cf66866b0b0e5a10038bfb77477419">CreateExtractValue</a>(Result, </Highlight><Highlight kind="comment">/&#42;Idxs=&#42;/</Highlight><Highlight kind="normal">1);</Highlight></CodeLine>
<Link id="l08774" /><CodeLine lineNumber="8774"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;addIncoming(PreviousVal, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>());</Highlight></CodeLine>
<Link id="l08775" /><CodeLine lineNumber="8775"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(SuccessFailureVal, ExitBB, ContBB);</Highlight></CodeLine>
<Link id="l08776" /><CodeLine lineNumber="8776"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08777" /><CodeLine lineNumber="8777"><Highlight kind="normal">    Res.first = OldExprVal;</Highlight></CodeLine>
<Link id="l08778" /><CodeLine lineNumber="8778"><Highlight kind="normal">    Res.second = Upd;</Highlight></CodeLine>
<Link id="l08779" /><CodeLine lineNumber="8779"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08780" /><CodeLine lineNumber="8780"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// set Insertion point in exit block</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08781" /><CodeLine lineNumber="8781"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UnreachableInst &#42;ExitTI =</Highlight></CodeLine>
<Link id="l08782" /><CodeLine lineNumber="8782"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;UnreachableInst&gt;</a>(ExitBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>())) &#123;</Highlight></CodeLine>
<Link id="l08783" /><CodeLine lineNumber="8783"><Highlight kind="normal">      CurBBTI-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08784" /><CodeLine lineNumber="8784"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ExitBB);</Highlight></CodeLine>
<Link id="l08785" /><CodeLine lineNumber="8785"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08786" /><CodeLine lineNumber="8786"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ExitTI);</Highlight></CodeLine>
<Link id="l08787" /><CodeLine lineNumber="8787"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08788" /><CodeLine lineNumber="8788"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08789" /><CodeLine lineNumber="8789"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08790" /><CodeLine lineNumber="8790"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Res;</Highlight></CodeLine>
<Link id="l08791" /><CodeLine lineNumber="8791"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08792" /><CodeLine lineNumber="8792"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08793" /><CodeLine lineNumber="8793" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a6cc340cf5dc46cf45eb6f784577cadbd"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a> <a href="/docs/api/classes/llvm/openmpirbuilder/#a6cc340cf5dc46cf45eb6f784577cadbd">OpenMPIRBuilder::createAtomicCapture</a>(</Highlight></CodeLine>
<Link id="l08794" /><CodeLine lineNumber="8794"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP, AtomicOpValue &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>,</Highlight></CodeLine>
<Link id="l08795" /><CodeLine lineNumber="8795"><Highlight kind="normal">    AtomicOpValue &amp;V, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Expr, <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> AO,</Highlight></CodeLine>
<Link id="l08796" /><CodeLine lineNumber="8796"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615">AtomicRMWInst::BinOp</a> RMWOp, AtomicUpdateCallbackTy &amp;UpdateOp,</Highlight></CodeLine>
<Link id="l08797" /><CodeLine lineNumber="8797"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> UpdateExpr, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsPostfixUpdate, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsXBinopExpr) &#123;</Highlight></CodeLine>
<Link id="l08798" /><CodeLine lineNumber="8798"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l08799" /><CodeLine lineNumber="8799"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP;</Highlight></CodeLine>
<Link id="l08800" /><CodeLine lineNumber="8800"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08801" /><CodeLine lineNumber="8801"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</Highlight></CodeLine>
<Link id="l08802" /><CodeLine lineNumber="8802"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;XTy = <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var-&gt;getType();</Highlight></CodeLine>
<Link id="l08803" /><CodeLine lineNumber="8803"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(XTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l08804" /><CodeLine lineNumber="8804"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;OMP Atomic expects a pointer to target memory&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08805" /><CodeLine lineNumber="8805"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;XElemTy = <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy;</Highlight></CodeLine>
<Link id="l08806" /><CodeLine lineNumber="8806"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#aac5759c83abd6a4af236401a7cfe7a0f">isFloatingPointTy</a>() || XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() ||</Highlight></CodeLine>
<Link id="l08807" /><CodeLine lineNumber="8807"><Highlight kind="normal">            XElemTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l08808" /><CodeLine lineNumber="8808"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;OMP atomic capture expected a scalar type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08809" /><CodeLine lineNumber="8809"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((RMWOp != <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa1184a7e35e94d162a2d40f2b11beeb2">AtomicRMWInst::Max</a>) &amp;&amp; (RMWOp != <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a39edb6e51c1ad37244e8b32a2af4077d">AtomicRMWInst::Min</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l08810" /><CodeLine lineNumber="8810"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;OpenMP atomic does not support LT or GT operations&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08811" /><CodeLine lineNumber="8811"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l08812" /><CodeLine lineNumber="8812"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08813" /><CodeLine lineNumber="8813"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If UpdateExpr is &#39;x&#39; updated with some &#96;expr&#96; not based on &#39;x&#39;,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08814" /><CodeLine lineNumber="8814"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#39;x&#39; is simply atomically rewritten with &#39;expr&#39;.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08815" /><CodeLine lineNumber="8815"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615">AtomicRMWInst::BinOp</a> AtomicOp = (UpdateExpr ? RMWOp : <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615afc870a548088c5b7a93a34f648889d77">AtomicRMWInst::Xchg</a>);</Highlight></CodeLine>
<Link id="l08816" /><CodeLine lineNumber="8816"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/expected">Expected&lt;std::pair&lt;Value &#42;, Value &#42;&gt;</a>&gt; AtomicResult =</Highlight></CodeLine>
<Link id="l08817" /><CodeLine lineNumber="8817"><Highlight kind="normal">      emitAtomicUpdate(AllocaIP, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy, Expr, AO, AtomicOp, UpdateOp,</Highlight></CodeLine>
<Link id="l08818" /><CodeLine lineNumber="8818"><Highlight kind="normal">                       <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.IsVolatile, IsXBinopExpr);</Highlight></CodeLine>
<Link id="l08819" /><CodeLine lineNumber="8819"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AtomicResult)</Highlight></CodeLine>
<Link id="l08820" /><CodeLine lineNumber="8820"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AtomicResult.<a href="/docs/api/classes/llvm/expected/#a94789df4ebd03dc008e8adebaa66ac1f">takeError</a>();</Highlight></CodeLine>
<Link id="l08821" /><CodeLine lineNumber="8821"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;CapturedVal =</Highlight></CodeLine>
<Link id="l08822" /><CodeLine lineNumber="8822"><Highlight kind="normal">      (IsPostfixUpdate ? AtomicResult-&gt;first : AtomicResult-&gt;second);</Highlight></CodeLine>
<Link id="l08823" /><CodeLine lineNumber="8823"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CapturedVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != V.Var-&gt;getType())</Highlight></CodeLine>
<Link id="l08824" /><CodeLine lineNumber="8824"><Highlight kind="normal">    CapturedVal = <a href="#a91b7eb2a05d10c788413bec7977f3474">emitImplicitCast</a>(Builder, CapturedVal, V.Var);</Highlight></CodeLine>
<Link id="l08825" /><CodeLine lineNumber="8825"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(CapturedVal, V.Var, V.IsVolatile);</Highlight></CodeLine>
<Link id="l08826" /><CodeLine lineNumber="8826"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08827" /><CodeLine lineNumber="8827"><Highlight kind="normal">  checkAndEmitFlushAfterAtomic(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, AO, AtomicKind::Capture);</Highlight></CodeLine>
<Link id="l08828" /><CodeLine lineNumber="8828"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l08829" /><CodeLine lineNumber="8829"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08830" /><CodeLine lineNumber="8830"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08831" /><CodeLine lineNumber="8831" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a6c4eeba23c6f192892487de272e8ce72"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> <a href="/docs/api/classes/llvm/openmpirbuilder/#a6c4eeba23c6f192892487de272e8ce72">OpenMPIRBuilder::createAtomicCompare</a>(</Highlight></CodeLine>
<Link id="l08832" /><CodeLine lineNumber="8832"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, AtomicOpValue &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, AtomicOpValue &amp;V,</Highlight></CodeLine>
<Link id="l08833" /><CodeLine lineNumber="8833"><Highlight kind="normal">    AtomicOpValue &amp;R, <a href="/docs/api/classes/llvm/value">Value</a> &#42;E, <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>, <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> AO,</Highlight></CodeLine>
<Link id="l08834" /><CodeLine lineNumber="8834"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#acb593a387130148478f3c30af0d322df">omp::OMPAtomicCompareOp</a> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsXBinopExpr, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsPostfixUpdate,</Highlight></CodeLine>
<Link id="l08835" /><CodeLine lineNumber="8835"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsFailOnly) &#123;</Highlight></CodeLine>
<Link id="l08836" /><CodeLine lineNumber="8836"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08837" /><CodeLine lineNumber="8837"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> Failure = <a href="/docs/api/classes/llvm/atomiccmpxchginst/#a7ce03ab5b2a6006ebcdfe804e4c8f1a1">AtomicCmpXchgInst::getStrongestFailureOrdering</a>(AO);</Highlight></CodeLine>
<Link id="l08838" /><CodeLine lineNumber="8838"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a6c4eeba23c6f192892487de272e8ce72">createAtomicCompare</a>(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, V, R, E, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>, AO, <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>, IsXBinopExpr,</Highlight></CodeLine>
<Link id="l08839" /><CodeLine lineNumber="8839"><Highlight kind="normal">                             IsPostfixUpdate, IsFailOnly, Failure);</Highlight></CodeLine>
<Link id="l08840" /><CodeLine lineNumber="8840"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l08841" /><CodeLine lineNumber="8841"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08842" /><CodeLine lineNumber="8842" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ab84af206a9a08b9bf97eaadc87874c6c"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">OpenMPIRBuilder::InsertPointTy</a> <a href="/docs/api/classes/llvm/openmpirbuilder/#a6c4eeba23c6f192892487de272e8ce72">OpenMPIRBuilder::createAtomicCompare</a>(</Highlight></CodeLine>
<Link id="l08843" /><CodeLine lineNumber="8843"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/openmpirbuilder/locationdescription">LocationDescription</a> &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>, AtomicOpValue &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>, AtomicOpValue &amp;V,</Highlight></CodeLine>
<Link id="l08844" /><CodeLine lineNumber="8844"><Highlight kind="normal">    AtomicOpValue &amp;R, <a href="/docs/api/classes/llvm/value">Value</a> &#42;E, <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>, <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> AO,</Highlight></CodeLine>
<Link id="l08845" /><CodeLine lineNumber="8845"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#acb593a387130148478f3c30af0d322df">omp::OMPAtomicCompareOp</a> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsXBinopExpr, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsPostfixUpdate,</Highlight></CodeLine>
<Link id="l08846" /><CodeLine lineNumber="8846"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsFailOnly, <a href="/docs/api/namespaces/llvm/#a9bccbe67aaab722783ca4e7c504aaaa7">AtomicOrdering</a> Failure) &#123;</Highlight></CodeLine>
<Link id="l08847" /><CodeLine lineNumber="8847"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08848" /><CodeLine lineNumber="8848"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l08849" /><CodeLine lineNumber="8849"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/loc">Loc</a>.IP;</Highlight></CodeLine>
<Link id="l08850" /><CodeLine lineNumber="8850"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08851" /><CodeLine lineNumber="8851"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var-&gt;getType()-&gt;isPointerTy() &amp;&amp;</Highlight></CodeLine>
<Link id="l08852" /><CodeLine lineNumber="8852"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;OMP atomic expects a pointer to target memory&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08853" /><CodeLine lineNumber="8853"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// compare capture</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08854" /><CodeLine lineNumber="8854"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (V.Var) &#123;</Highlight></CodeLine>
<Link id="l08855" /><CodeLine lineNumber="8855"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V.Var-&gt;getType()-&gt;isPointerTy() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;v.var must be of pointer type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08856" /><CodeLine lineNumber="8856"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V.ElemTy == <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;x and v must be of same type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08857" /><CodeLine lineNumber="8857"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l08858" /><CodeLine lineNumber="8858"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08859" /><CodeLine lineNumber="8859"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsInteger = E-&gt;getType()-&gt;isIntegerTy();</Highlight></CodeLine>
<Link id="l08860" /><CodeLine lineNumber="8860"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08861" /><CodeLine lineNumber="8861"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::EQ) &#123;</Highlight></CodeLine>
<Link id="l08862" /><CodeLine lineNumber="8862"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/atomiccmpxchginst">AtomicCmpXchgInst</a> &#42;Result = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08863" /><CodeLine lineNumber="8863"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsInteger) &#123;</Highlight></CodeLine>
<Link id="l08864" /><CodeLine lineNumber="8864"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/integertype">IntegerType</a> &#42;IntCastTy =</Highlight></CodeLine>
<Link id="l08865" /><CodeLine lineNumber="8865"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(M.getContext(), <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy-&gt;getScalarSizeInBits());</Highlight></CodeLine>
<Link id="l08866" /><CodeLine lineNumber="8866"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;EBCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(E, IntCastTy);</Highlight></CodeLine>
<Link id="l08867" /><CodeLine lineNumber="8867"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;DBCast = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>, IntCastTy);</Highlight></CodeLine>
<Link id="l08868" /><CodeLine lineNumber="8868"><Highlight kind="normal">      Result = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a199f6765de1f6b1a242aac556528f3b3">CreateAtomicCmpXchg</a>(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, EBCast, DBCast, <a href="/docs/api/structs/llvm/maybealign">MaybeAlign</a>(),</Highlight></CodeLine>
<Link id="l08869" /><CodeLine lineNumber="8869"><Highlight kind="normal">                                           AO, Failure);</Highlight></CodeLine>
<Link id="l08870" /><CodeLine lineNumber="8870"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08871" /><CodeLine lineNumber="8871"><Highlight kind="normal">      Result =</Highlight></CodeLine>
<Link id="l08872" /><CodeLine lineNumber="8872"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a199f6765de1f6b1a242aac556528f3b3">CreateAtomicCmpXchg</a>(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, E, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>, <a href="/docs/api/structs/llvm/maybealign">MaybeAlign</a>(), AO, Failure);</Highlight></CodeLine>
<Link id="l08873" /><CodeLine lineNumber="8873"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08874" /><CodeLine lineNumber="8874"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08875" /><CodeLine lineNumber="8875"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (V.Var) &#123;</Highlight></CodeLine>
<Link id="l08876" /><CodeLine lineNumber="8876"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;OldValue = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a41cf66866b0b0e5a10038bfb77477419">CreateExtractValue</a>(Result, </Highlight><Highlight kind="comment">/&#42;Idxs=&#42;/</Highlight><Highlight kind="normal">0);</Highlight></CodeLine>
<Link id="l08877" /><CodeLine lineNumber="8877"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsInteger)</Highlight></CodeLine>
<Link id="l08878" /><CodeLine lineNumber="8878"><Highlight kind="normal">        OldValue = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a932f08e32ea37a7019902ee467beb268">CreateBitCast</a>(OldValue, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.ElemTy);</Highlight></CodeLine>
<Link id="l08879" /><CodeLine lineNumber="8879"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OldValue-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() == V.ElemTy &amp;&amp;</Highlight></CodeLine>
<Link id="l08880" /><CodeLine lineNumber="8880"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;OldValue and V must be of same type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08881" /><CodeLine lineNumber="8881"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsPostfixUpdate) &#123;</Highlight></CodeLine>
<Link id="l08882" /><CodeLine lineNumber="8882"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(OldValue, V.Var, V.IsVolatile);</Highlight></CodeLine>
<Link id="l08883" /><CodeLine lineNumber="8883"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08884" /><CodeLine lineNumber="8884"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;SuccessOrFail = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a41cf66866b0b0e5a10038bfb77477419">CreateExtractValue</a>(Result, </Highlight><Highlight kind="comment">/&#42;Idxs=&#42;/</Highlight><Highlight kind="normal">1);</Highlight></CodeLine>
<Link id="l08885" /><CodeLine lineNumber="8885"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsFailOnly) &#123;</Highlight></CodeLine>
<Link id="l08886" /><CodeLine lineNumber="8886"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// CurBB----</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08887" /><CodeLine lineNumber="8887"><Highlight kind="normal">          </Highlight><Highlight kind="comment">//   |     |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08888" /><CodeLine lineNumber="8888"><Highlight kind="normal">          </Highlight><Highlight kind="comment">//   v     |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08889" /><CodeLine lineNumber="8889"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// ContBB  |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08890" /><CodeLine lineNumber="8890"><Highlight kind="normal">          </Highlight><Highlight kind="comment">//   |     |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08891" /><CodeLine lineNumber="8891"><Highlight kind="normal">          </Highlight><Highlight kind="comment">//   v     |</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08892" /><CodeLine lineNumber="8892"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// ExitBB &lt;-</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08893" /><CodeLine lineNumber="8893"><Highlight kind="normal">          </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08894" /><CodeLine lineNumber="8894"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// where ContBB only contains the store of old value to &#39;v&#39;.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08895" /><CodeLine lineNumber="8895"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;CurBB = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>();</Highlight></CodeLine>
<Link id="l08896" /><CodeLine lineNumber="8896"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;CurBBTI = CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l08897" /><CodeLine lineNumber="8897"><Highlight kind="normal">          CurBBTI = CurBBTI ? CurBBTI : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a39acc29443d48968a798fb22a76fa4c0">CreateUnreachable</a>();</Highlight></CodeLine>
<Link id="l08898" /><CodeLine lineNumber="8898"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ExitBB = CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(</Highlight></CodeLine>
<Link id="l08899" /><CodeLine lineNumber="8899"><Highlight kind="normal">              CurBBTI, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08900" /><CodeLine lineNumber="8900"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ContBB = CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a52c990590792c91dd20b6d45acebe359">splitBasicBlock</a>(</Highlight></CodeLine>
<Link id="l08901" /><CodeLine lineNumber="8901"><Highlight kind="normal">              CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>(), <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.atomic.cont&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08902" /><CodeLine lineNumber="8902"><Highlight kind="normal">          ContBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08903" /><CodeLine lineNumber="8903"><Highlight kind="normal">          CurBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08904" /><CodeLine lineNumber="8904"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08905" /><CodeLine lineNumber="8905"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a972c30f044db799668bdcace5544edeb">CreateCondBr</a>(SuccessOrFail, ExitBB, ContBB);</Highlight></CodeLine>
<Link id="l08906" /><CodeLine lineNumber="8906"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08907" /><CodeLine lineNumber="8907"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ContBB);</Highlight></CodeLine>
<Link id="l08908" /><CodeLine lineNumber="8908"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(OldValue, V.Var);</Highlight></CodeLine>
<Link id="l08909" /><CodeLine lineNumber="8909"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#abab736a0141f903dc32a6f48828ad908">CreateBr</a>(ExitBB);</Highlight></CodeLine>
<Link id="l08910" /><CodeLine lineNumber="8910"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08911" /><CodeLine lineNumber="8911"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/unreachableinst">UnreachableInst</a> &#42;ExitTI =</Highlight></CodeLine>
<Link id="l08912" /><CodeLine lineNumber="8912"><Highlight kind="normal">                  <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;UnreachableInst&gt;</a>(ExitBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>())) &#123;</Highlight></CodeLine>
<Link id="l08913" /><CodeLine lineNumber="8913"><Highlight kind="normal">            CurBBTI-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l08914" /><CodeLine lineNumber="8914"><Highlight kind="normal">            Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ExitBB);</Highlight></CodeLine>
<Link id="l08915" /><CodeLine lineNumber="8915"><Highlight kind="normal">          &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08916" /><CodeLine lineNumber="8916"><Highlight kind="normal">            Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ExitTI);</Highlight></CodeLine>
<Link id="l08917" /><CodeLine lineNumber="8917"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l08918" /><CodeLine lineNumber="8918"><Highlight kind="normal">        &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08919" /><CodeLine lineNumber="8919"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/value">Value</a> &#42;CapturedValue =</Highlight></CodeLine>
<Link id="l08920" /><CodeLine lineNumber="8920"><Highlight kind="normal">              Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(SuccessOrFail, E, OldValue);</Highlight></CodeLine>
<Link id="l08921" /><CodeLine lineNumber="8921"><Highlight kind="normal">          Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(CapturedValue, V.Var, V.IsVolatile);</Highlight></CodeLine>
<Link id="l08922" /><CodeLine lineNumber="8922"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l08923" /><CodeLine lineNumber="8923"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l08924" /><CodeLine lineNumber="8924"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08925" /><CodeLine lineNumber="8925"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The comparison result has to be stored.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08926" /><CodeLine lineNumber="8926"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (R.Var) &#123;</Highlight></CodeLine>
<Link id="l08927" /><CodeLine lineNumber="8927"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(R.Var-&gt;getType()-&gt;isPointerTy() &amp;&amp;</Highlight></CodeLine>
<Link id="l08928" /><CodeLine lineNumber="8928"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;r.var must be of pointer type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08929" /><CodeLine lineNumber="8929"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(R.ElemTy-&gt;isIntegerTy() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;r must be of integral type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08930" /><CodeLine lineNumber="8930"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08931" /><CodeLine lineNumber="8931"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;SuccessFailureVal = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a41cf66866b0b0e5a10038bfb77477419">CreateExtractValue</a>(Result, </Highlight><Highlight kind="comment">/&#42;Idxs=&#42;/</Highlight><Highlight kind="normal">1);</Highlight></CodeLine>
<Link id="l08932" /><CodeLine lineNumber="8932"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;ResultCast = R.IsSigned</Highlight></CodeLine>
<Link id="l08933" /><CodeLine lineNumber="8933"><Highlight kind="normal">                              ? Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5253081f40ffcad9c0e8ba6a5c437006">CreateSExt</a>(SuccessFailureVal, R.ElemTy)</Highlight></CodeLine>
<Link id="l08934" /><CodeLine lineNumber="8934"><Highlight kind="normal">                              : Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a9e6950f7f17700d5c0d61ad0b846ec5c">CreateZExt</a>(SuccessFailureVal, R.ElemTy);</Highlight></CodeLine>
<Link id="l08935" /><CodeLine lineNumber="8935"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(ResultCast, R.Var, R.IsVolatile);</Highlight></CodeLine>
<Link id="l08936" /><CodeLine lineNumber="8936"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08937" /><CodeLine lineNumber="8937"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08938" /><CodeLine lineNumber="8938"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::MAX || <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::MIN) &amp;&amp;</Highlight></CodeLine>
<Link id="l08939" /><CodeLine lineNumber="8939"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Op should be either max or min at this point&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08940" /><CodeLine lineNumber="8940"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!IsFailOnly &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;IsFailOnly is only valid when the comparison is ==&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l08941" /><CodeLine lineNumber="8941"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08942" /><CodeLine lineNumber="8942"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Reverse the ordop as the OpenMP forms are different from LLVM forms.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08943" /><CodeLine lineNumber="8943"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Let&#39;s take max as example.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08944" /><CodeLine lineNumber="8944"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// OpenMP form:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08945" /><CodeLine lineNumber="8945"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// x = x &gt; expr ? expr : x;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08946" /><CodeLine lineNumber="8946"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// LLVM form:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08947" /><CodeLine lineNumber="8947"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// &#42;ptr = &#42;ptr &gt; val ? &#42;ptr : val;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08948" /><CodeLine lineNumber="8948"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// We need to transform to LLVM form.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08949" /><CodeLine lineNumber="8949"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// x = x &lt;= expr ? x : expr;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08950" /><CodeLine lineNumber="8950"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615">AtomicRMWInst::BinOp</a> NewOp;</Highlight></CodeLine>
<Link id="l08951" /><CodeLine lineNumber="8951"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsXBinopExpr) &#123;</Highlight></CodeLine>
<Link id="l08952" /><CodeLine lineNumber="8952"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsInteger) &#123;</Highlight></CodeLine>
<Link id="l08953" /><CodeLine lineNumber="8953"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.IsSigned)</Highlight></CodeLine>
<Link id="l08954" /><CodeLine lineNumber="8954"><Highlight kind="normal">          NewOp = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::MAX ? <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a39edb6e51c1ad37244e8b32a2af4077d">AtomicRMWInst::Min</a></Highlight></CodeLine>
<Link id="l08955" /><CodeLine lineNumber="8955"><Highlight kind="normal">                                                : <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa1184a7e35e94d162a2d40f2b11beeb2">AtomicRMWInst::Max</a>;</Highlight></CodeLine>
<Link id="l08956" /><CodeLine lineNumber="8956"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08957" /><CodeLine lineNumber="8957"><Highlight kind="normal">          NewOp = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::MAX ? <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa53854e09143f57d2ff2ad6ac89dc55d">AtomicRMWInst::UMin</a></Highlight></CodeLine>
<Link id="l08958" /><CodeLine lineNumber="8958"><Highlight kind="normal">                                                : <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abe171d96ba8de66fb30e08c00211591e">AtomicRMWInst::UMax</a>;</Highlight></CodeLine>
<Link id="l08959" /><CodeLine lineNumber="8959"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08960" /><CodeLine lineNumber="8960"><Highlight kind="normal">        NewOp = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::MAX ? <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abd5e733a10a36f3572105b1a67538e18">AtomicRMWInst::FMin</a></Highlight></CodeLine>
<Link id="l08961" /><CodeLine lineNumber="8961"><Highlight kind="normal">                                              : <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615acce124326ba87b0127b36c412bf555fd">AtomicRMWInst::FMax</a>;</Highlight></CodeLine>
<Link id="l08962" /><CodeLine lineNumber="8962"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l08963" /><CodeLine lineNumber="8963"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08964" /><CodeLine lineNumber="8964"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsInteger) &#123;</Highlight></CodeLine>
<Link id="l08965" /><CodeLine lineNumber="8965"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.IsSigned)</Highlight></CodeLine>
<Link id="l08966" /><CodeLine lineNumber="8966"><Highlight kind="normal">          NewOp = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::MAX ? <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa1184a7e35e94d162a2d40f2b11beeb2">AtomicRMWInst::Max</a></Highlight></CodeLine>
<Link id="l08967" /><CodeLine lineNumber="8967"><Highlight kind="normal">                                                : <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a39edb6e51c1ad37244e8b32a2af4077d">AtomicRMWInst::Min</a>;</Highlight></CodeLine>
<Link id="l08968" /><CodeLine lineNumber="8968"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08969" /><CodeLine lineNumber="8969"><Highlight kind="normal">          NewOp = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::MAX ? <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abe171d96ba8de66fb30e08c00211591e">AtomicRMWInst::UMax</a></Highlight></CodeLine>
<Link id="l08970" /><CodeLine lineNumber="8970"><Highlight kind="normal">                                                : <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa53854e09143f57d2ff2ad6ac89dc55d">AtomicRMWInst::UMin</a>;</Highlight></CodeLine>
<Link id="l08971" /><CodeLine lineNumber="8971"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08972" /><CodeLine lineNumber="8972"><Highlight kind="normal">        NewOp = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> == OMPAtomicCompareOp::MAX ? <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615acce124326ba87b0127b36c412bf555fd">AtomicRMWInst::FMax</a></Highlight></CodeLine>
<Link id="l08973" /><CodeLine lineNumber="8973"><Highlight kind="normal">                                              : <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abd5e733a10a36f3572105b1a67538e18">AtomicRMWInst::FMin</a>;</Highlight></CodeLine>
<Link id="l08974" /><CodeLine lineNumber="8974"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l08975" /><CodeLine lineNumber="8975"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l08976" /><CodeLine lineNumber="8976"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l08977" /><CodeLine lineNumber="8977"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/atomicrmwinst">AtomicRMWInst</a> &#42;OldValue =</Highlight></CodeLine>
<Link id="l08978" /><CodeLine lineNumber="8978"><Highlight kind="normal">        Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab2a2c89b21cf14b2c729a898006cb438">CreateAtomicRMW</a>(NewOp, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Var, E, <a href="/docs/api/structs/llvm/maybealign">MaybeAlign</a>(), AO);</Highlight></CodeLine>
<Link id="l08979" /><CodeLine lineNumber="8979"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (V.Var) &#123;</Highlight></CodeLine>
<Link id="l08980" /><CodeLine lineNumber="8980"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;CapturedValue = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08981" /><CodeLine lineNumber="8981"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsPostfixUpdate) &#123;</Highlight></CodeLine>
<Link id="l08982" /><CodeLine lineNumber="8982"><Highlight kind="normal">        CapturedValue = OldValue;</Highlight></CodeLine>
<Link id="l08983" /><CodeLine lineNumber="8983"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l08984" /><CodeLine lineNumber="8984"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred;</Highlight></CodeLine>
<Link id="l08985" /><CodeLine lineNumber="8985"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (NewOp) &#123;</Highlight></CodeLine>
<Link id="l08986" /><CodeLine lineNumber="8986"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa1184a7e35e94d162a2d40f2b11beeb2">AtomicRMWInst::Max</a>:</Highlight></CodeLine>
<Link id="l08987" /><CodeLine lineNumber="8987"><Highlight kind="normal">          Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba720a42e85f7e981afd61e28473b0000a">CmpInst::ICMP&#95;SGT</a>;</Highlight></CodeLine>
<Link id="l08988" /><CodeLine lineNumber="8988"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08989" /><CodeLine lineNumber="8989"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abe171d96ba8de66fb30e08c00211591e">AtomicRMWInst::UMax</a>:</Highlight></CodeLine>
<Link id="l08990" /><CodeLine lineNumber="8990"><Highlight kind="normal">          Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba607cecdc5172814382033e001ed11fad">CmpInst::ICMP&#95;UGT</a>;</Highlight></CodeLine>
<Link id="l08991" /><CodeLine lineNumber="8991"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08992" /><CodeLine lineNumber="8992"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615acce124326ba87b0127b36c412bf555fd">AtomicRMWInst::FMax</a>:</Highlight></CodeLine>
<Link id="l08993" /><CodeLine lineNumber="8993"><Highlight kind="normal">          Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba4c399f525bbcf03d72af4b303e6eeca8">CmpInst::FCMP&#95;OGT</a>;</Highlight></CodeLine>
<Link id="l08994" /><CodeLine lineNumber="8994"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08995" /><CodeLine lineNumber="8995"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615a39edb6e51c1ad37244e8b32a2af4077d">AtomicRMWInst::Min</a>:</Highlight></CodeLine>
<Link id="l08996" /><CodeLine lineNumber="8996"><Highlight kind="normal">          Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c">CmpInst::ICMP&#95;SLT</a>;</Highlight></CodeLine>
<Link id="l08997" /><CodeLine lineNumber="8997"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l08998" /><CodeLine lineNumber="8998"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615aa53854e09143f57d2ff2ad6ac89dc55d">AtomicRMWInst::UMin</a>:</Highlight></CodeLine>
<Link id="l08999" /><CodeLine lineNumber="8999"><Highlight kind="normal">          Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">CmpInst::ICMP&#95;ULT</a>;</Highlight></CodeLine>
<Link id="l09000" /><CodeLine lineNumber="9000"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09001" /><CodeLine lineNumber="9001"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst/#a461cfbbb5c7a57ab73210498923cf615abd5e733a10a36f3572105b1a67538e18">AtomicRMWInst::FMin</a>:</Highlight></CodeLine>
<Link id="l09002" /><CodeLine lineNumber="9002"><Highlight kind="normal">          Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba326bee0a4a424cef21c1cf8adb8b8dd8">CmpInst::FCMP&#95;OLT</a>;</Highlight></CodeLine>
<Link id="l09003" /><CodeLine lineNumber="9003"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09004" /><CodeLine lineNumber="9004"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l09005" /><CodeLine lineNumber="9005"><Highlight kind="normal">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;unexpected comparison op&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09006" /><CodeLine lineNumber="9006"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l09007" /><CodeLine lineNumber="9007"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;NonAtomicCmp = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a843d43d070f0b1c6a133403edce488ef">CreateCmp</a>(Pred, OldValue, E);</Highlight></CodeLine>
<Link id="l09008" /><CodeLine lineNumber="9008"><Highlight kind="normal">        CapturedValue = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(NonAtomicCmp, E, OldValue);</Highlight></CodeLine>
<Link id="l09009" /><CodeLine lineNumber="9009"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l09010" /><CodeLine lineNumber="9010"><Highlight kind="normal">      Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#aabfc20af4dcf7d94262824dcac2e7bed">CreateStore</a>(CapturedValue, V.Var, V.IsVolatile);</Highlight></CodeLine>
<Link id="l09011" /><CodeLine lineNumber="9011"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09012" /><CodeLine lineNumber="9012"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09013" /><CodeLine lineNumber="9013"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09014" /><CodeLine lineNumber="9014"><Highlight kind="normal">  checkAndEmitFlushAfterAtomic(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, AO, AtomicKind::Compare);</Highlight></CodeLine>
<Link id="l09015" /><CodeLine lineNumber="9015"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09016" /><CodeLine lineNumber="9016"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l09017" /><CodeLine lineNumber="9017"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09018" /><CodeLine lineNumber="9018"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09019" /><CodeLine lineNumber="9019"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#af24d1c61cec57095ced3b08a6dd99ee8">OpenMPIRBuilder::InsertPointOrErrorTy</a></Highlight></CodeLine>
<Link id="l09020" /><CodeLine lineNumber="9020"><Highlight kind="normal">OpenMPIRBuilder::createTeams(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LocationDescription &amp;<a href="/docs/api/namespaces/llvm/loc">Loc</a>,</Highlight></CodeLine>
<Link id="l09021" /><CodeLine lineNumber="9021"><Highlight kind="normal">                             BodyGenCallbackTy BodyGenCB, <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumTeamsLower,</Highlight></CodeLine>
<Link id="l09022" /><CodeLine lineNumber="9022"><Highlight kind="normal">                             <a href="/docs/api/classes/llvm/value">Value</a> &#42;NumTeamsUpper, <a href="/docs/api/classes/llvm/value">Value</a> &#42;ThreadLimit,</Highlight></CodeLine>
<Link id="l09023" /><CodeLine lineNumber="9023"><Highlight kind="normal">                             <a href="/docs/api/classes/llvm/value">Value</a> &#42;IfExpr) &#123;</Highlight></CodeLine>
<Link id="l09024" /><CodeLine lineNumber="9024"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!updateToLocation(<a href="/docs/api/namespaces/llvm/loc">Loc</a>))</Highlight></CodeLine>
<Link id="l09025" /><CodeLine lineNumber="9025"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a>();</Highlight></CodeLine>
<Link id="l09026" /><CodeLine lineNumber="9026"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09027" /><CodeLine lineNumber="9027"><Highlight kind="normal">  uint32&#95;t SrcLocStrSize;</Highlight></CodeLine>
<Link id="l09028" /><CodeLine lineNumber="9028"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;SrcLocStr = getOrCreateSrcLocStr(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l09029" /><CodeLine lineNumber="9029"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Ident = getOrCreateIdent(SrcLocStr, SrcLocStrSize);</Highlight></CodeLine>
<Link id="l09030" /><CodeLine lineNumber="9030"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/function">Function</a> &#42;CurrentFunction = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a1b4bf7c97cdc8159fd73d48063f0b250">getParent</a>();</Highlight></CodeLine>
<Link id="l09031" /><CodeLine lineNumber="9031"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09032" /><CodeLine lineNumber="9032"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Outer allocation basicblock is the entry block of the current function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09033" /><CodeLine lineNumber="9033"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &amp;OuterAllocaBB = CurrentFunction-&gt;<a href="/docs/api/classes/llvm/function/#a169f0c26ef46161741fdd120a806f853">getEntryBlock</a>();</Highlight></CodeLine>
<Link id="l09034" /><CodeLine lineNumber="9034"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (&amp;OuterAllocaBB == Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a60a6d6c205f483fa96597a960f3c093b">GetInsertBlock</a>()) &#123;</Highlight></CodeLine>
<Link id="l09035" /><CodeLine lineNumber="9035"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BodyBB = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;teams.entry&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09036" /><CodeLine lineNumber="9036"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(BodyBB, BodyBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l09037" /><CodeLine lineNumber="9037"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09038" /><CodeLine lineNumber="9038"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09039" /><CodeLine lineNumber="9039"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The current basic block is split into four basic blocks. After outlining,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09040" /><CodeLine lineNumber="9040"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// they will be mapped as follows:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09041" /><CodeLine lineNumber="9041"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#96;&#96;&#96;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09042" /><CodeLine lineNumber="9042"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// def current&#95;fn() &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09043" /><CodeLine lineNumber="9043"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   current&#95;basic&#95;block:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09044" /><CodeLine lineNumber="9044"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     br label %teams.exit</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09045" /><CodeLine lineNumber="9045"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   teams.exit:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09046" /><CodeLine lineNumber="9046"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     ; instructions after teams</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09047" /><CodeLine lineNumber="9047"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09048" /><CodeLine lineNumber="9048"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09049" /><CodeLine lineNumber="9049"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// def outlined&#95;fn() &#123;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09050" /><CodeLine lineNumber="9050"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   teams.alloca:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09051" /><CodeLine lineNumber="9051"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     br label %teams.body</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09052" /><CodeLine lineNumber="9052"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   teams.body:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09053" /><CodeLine lineNumber="9053"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//     ; instructions within teams body</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09054" /><CodeLine lineNumber="9054"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#125;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09055" /><CodeLine lineNumber="9055"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// &#96;&#96;&#96;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09056" /><CodeLine lineNumber="9056"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ExitBB = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;teams.exit&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09057" /><CodeLine lineNumber="9057"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BodyBB = <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;teams.body&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09058" /><CodeLine lineNumber="9058"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;AllocaBB =</Highlight></CodeLine>
<Link id="l09059" /><CodeLine lineNumber="9059"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a85ee70791795fa2ddb07694182f783b2">splitBB</a>(Builder, </Highlight><Highlight kind="comment">/&#42;CreateBranch=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;teams.alloca&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09060" /><CodeLine lineNumber="9060"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09061" /><CodeLine lineNumber="9061"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> SubClausesPresent =</Highlight></CodeLine>
<Link id="l09062" /><CodeLine lineNumber="9062"><Highlight kind="normal">      (NumTeamsLower || NumTeamsUpper || ThreadLimit || IfExpr);</Highlight></CodeLine>
<Link id="l09063" /><CodeLine lineNumber="9063"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Push num&#95;teams</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09064" /><CodeLine lineNumber="9064"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Config.isTargetDevice() &amp;&amp; SubClausesPresent) &#123;</Highlight></CodeLine>
<Link id="l09065" /><CodeLine lineNumber="9065"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((NumTeamsLower == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal"> || NumTeamsUpper != </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">) &amp;&amp;</Highlight></CodeLine>
<Link id="l09066" /><CodeLine lineNumber="9066"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;if lowerbound is non-null, then upperbound must also be non-null &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09067" /><CodeLine lineNumber="9067"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;for bounds on num&#95;teams&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09068" /><CodeLine lineNumber="9068"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09069" /><CodeLine lineNumber="9069"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumTeamsUpper == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l09070" /><CodeLine lineNumber="9070"><Highlight kind="normal">      NumTeamsUpper = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(0);</Highlight></CodeLine>
<Link id="l09071" /><CodeLine lineNumber="9071"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09072" /><CodeLine lineNumber="9072"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumTeamsLower == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l09073" /><CodeLine lineNumber="9073"><Highlight kind="normal">      NumTeamsLower = NumTeamsUpper;</Highlight></CodeLine>
<Link id="l09074" /><CodeLine lineNumber="9074"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09075" /><CodeLine lineNumber="9075"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfExpr) &#123;</Highlight></CodeLine>
<Link id="l09076" /><CodeLine lineNumber="9076"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IfExpr-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#ac6d28a9b11139182134a9618028a0d07">isIntegerTy</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l09077" /><CodeLine lineNumber="9077"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;argument to if clause must be an integer value&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09078" /><CodeLine lineNumber="9078"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09079" /><CodeLine lineNumber="9079"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// upper = ifexpr ? upper : 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09080" /><CodeLine lineNumber="9080"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IfExpr-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64iseldagtodag-cpp/#a2098a5fa6ada61b6c4a1f210ad84e4a1a3cc05cd6e06dd1976f88ed7d808ac0a1">Int1</a>)</Highlight></CodeLine>
<Link id="l09081" /><CodeLine lineNumber="9081"><Highlight kind="normal">        IfExpr = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a6ef1729b04a4fbd6c6f27787cdd0e813">CreateICmpNE</a>(IfExpr,</Highlight></CodeLine>
<Link id="l09082" /><CodeLine lineNumber="9082"><Highlight kind="normal">                                      ConstantInt::get(IfExpr-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>(), 0));</Highlight></CodeLine>
<Link id="l09083" /><CodeLine lineNumber="9083"><Highlight kind="normal">      NumTeamsUpper = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(</Highlight></CodeLine>
<Link id="l09084" /><CodeLine lineNumber="9084"><Highlight kind="normal">          IfExpr, NumTeamsUpper, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(1), </Highlight><Highlight kind="stringliteral">&quot;numTeamsUpper&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09085" /><CodeLine lineNumber="9085"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09086" /><CodeLine lineNumber="9086"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// lower = ifexpr ? lower : 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09087" /><CodeLine lineNumber="9087"><Highlight kind="normal">      NumTeamsLower = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a49b228f797f9b3563256da446100c3ac">CreateSelect</a>(</Highlight></CodeLine>
<Link id="l09088" /><CodeLine lineNumber="9088"><Highlight kind="normal">          IfExpr, NumTeamsLower, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(1), </Highlight><Highlight kind="stringliteral">&quot;numTeamsLower&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09089" /><CodeLine lineNumber="9089"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09090" /><CodeLine lineNumber="9090"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09091" /><CodeLine lineNumber="9091"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ThreadLimit == </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l09092" /><CodeLine lineNumber="9092"><Highlight kind="normal">      ThreadLimit = Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(0);</Highlight></CodeLine>
<Link id="l09093" /><CodeLine lineNumber="9093"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09094" /><CodeLine lineNumber="9094"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;ThreadNum = getOrCreateThreadID(Ident);</Highlight></CodeLine>
<Link id="l09095" /><CodeLine lineNumber="9095"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(</Highlight></CodeLine>
<Link id="l09096" /><CodeLine lineNumber="9096"><Highlight kind="normal">        getOrCreateRuntimeFunctionPtr(OMPRTL&#95;&#95;&#95;kmpc&#95;push&#95;num&#95;teams&#95;51),</Highlight></CodeLine>
<Link id="l09097" /><CodeLine lineNumber="9097"><Highlight kind="normal">        &#123;Ident, ThreadNum, NumTeamsLower, NumTeamsUpper, ThreadLimit&#125;);</Highlight></CodeLine>
<Link id="l09098" /><CodeLine lineNumber="9098"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09099" /><CodeLine lineNumber="9099"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Generate the body of teams.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09100" /><CodeLine lineNumber="9100"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> AllocaIP(AllocaBB, AllocaBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l09101" /><CodeLine lineNumber="9101"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> CodeGenIP(BodyBB, BodyBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l09102" /><CodeLine lineNumber="9102"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ac226f3d2b9ca090171a8e0a8cb92c343a902b0d55fddef6f8d651fe1035b7d4bd">Error</a> Err = BodyGenCB(AllocaIP, CodeGenIP))</Highlight></CodeLine>
<Link id="l09103" /><CodeLine lineNumber="9103"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Err;</Highlight></CodeLine>
<Link id="l09104" /><CodeLine lineNumber="9104"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09105" /><CodeLine lineNumber="9105"><Highlight kind="normal">  OutlineInfo OI;</Highlight></CodeLine>
<Link id="l09106" /><CodeLine lineNumber="9106"><Highlight kind="normal">  OI.EntryBB = AllocaBB;</Highlight></CodeLine>
<Link id="l09107" /><CodeLine lineNumber="9107"><Highlight kind="normal">  OI.ExitBB = ExitBB;</Highlight></CodeLine>
<Link id="l09108" /><CodeLine lineNumber="9108"><Highlight kind="normal">  OI.OuterAllocaBB = &amp;OuterAllocaBB;</Highlight></CodeLine>
<Link id="l09109" /><CodeLine lineNumber="9109"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09110" /><CodeLine lineNumber="9110"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Insert fake values for global tid and bound tid.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09111" /><CodeLine lineNumber="9111"><Highlight kind="normal">  SmallVector&lt;Instruction &#42;, 8&gt; ToBeDeleted;</Highlight></CodeLine>
<Link id="l09112" /><CodeLine lineNumber="9112"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#aafc1886793b898052f87edd7e9fdbaa3">InsertPointTy</a> OuterAllocaIP(&amp;OuterAllocaBB, OuterAllocaBB.<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l09113" /><CodeLine lineNumber="9113"><Highlight kind="normal">  OI.ExcludeArgsFromAggregate.push&#95;back(<a href="#a35409dbaffc2cf38fefec12e3cf9094d">createFakeIntVal</a>(</Highlight></CodeLine>
<Link id="l09114" /><CodeLine lineNumber="9114"><Highlight kind="normal">      Builder, OuterAllocaIP, ToBeDeleted, AllocaIP, </Highlight><Highlight kind="stringliteral">&quot;gid&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l09115" /><CodeLine lineNumber="9115"><Highlight kind="normal">  OI.ExcludeArgsFromAggregate.push&#95;back(<a href="#a35409dbaffc2cf38fefec12e3cf9094d">createFakeIntVal</a>(</Highlight></CodeLine>
<Link id="l09116" /><CodeLine lineNumber="9116"><Highlight kind="normal">      Builder, OuterAllocaIP, ToBeDeleted, AllocaIP, </Highlight><Highlight kind="stringliteral">&quot;tid&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l09117" /><CodeLine lineNumber="9117"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09118" /><CodeLine lineNumber="9118"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> HostPostOutlineCB = &#91;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">, Ident,</Highlight></CodeLine>
<Link id="l09119" /><CodeLine lineNumber="9119"><Highlight kind="normal">                            ToBeDeleted&#93;(<a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &amp;OutlinedFn) </Highlight><Highlight kind="keyword">mutable</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l09120" /><CodeLine lineNumber="9120"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The stale call instruction will be replaced with a new call instruction</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09121" /><CodeLine lineNumber="9121"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// for runtime call with the outlined function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09122" /><CodeLine lineNumber="9122"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09123" /><CodeLine lineNumber="9123"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutlinedFn.<a href="/docs/api/classes/llvm/value/#aba0055050d741f60b6e0523507a2c79f">getNumUses</a>() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l09124" /><CodeLine lineNumber="9124"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;there must be a single user for the outlined function&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09125" /><CodeLine lineNumber="9125"><Highlight kind="normal">    CallInst &#42;StaleCI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;CallInst&gt;</a>(OutlinedFn.<a href="/docs/api/classes/llvm/value/#a46db903db2484e1ef5062d094d6b0854">user&#95;back</a>());</Highlight></CodeLine>
<Link id="l09126" /><CodeLine lineNumber="9126"><Highlight kind="normal">    ToBeDeleted.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(StaleCI);</Highlight></CodeLine>
<Link id="l09127" /><CodeLine lineNumber="9127"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09128" /><CodeLine lineNumber="9128"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((OutlinedFn.<a href="/docs/api/classes/llvm/function/#ac6baa801e4aea800984e760d5460662f">arg&#95;size</a>() == 2 || OutlinedFn.<a href="/docs/api/classes/llvm/function/#ac6baa801e4aea800984e760d5460662f">arg&#95;size</a>() == 3) &amp;&amp;</Highlight></CodeLine>
<Link id="l09129" /><CodeLine lineNumber="9129"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Outlined function must have two or three arguments only&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09130" /><CodeLine lineNumber="9130"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09131" /><CodeLine lineNumber="9131"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasShared = OutlinedFn.<a href="/docs/api/classes/llvm/function/#ac6baa801e4aea800984e760d5460662f">arg&#95;size</a>() == 3;</Highlight></CodeLine>
<Link id="l09132" /><CodeLine lineNumber="9132"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09133" /><CodeLine lineNumber="9133"><Highlight kind="normal">    OutlinedFn.<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(0)-&gt;<a href="/docs/api/classes/llvm/value/#a35ee267850af7c235474a8c46c7ac5af">setName</a>(</Highlight><Highlight kind="stringliteral">&quot;global.tid.ptr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09134" /><CodeLine lineNumber="9134"><Highlight kind="normal">    OutlinedFn.<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(1)-&gt;<a href="/docs/api/classes/llvm/value/#a35ee267850af7c235474a8c46c7ac5af">setName</a>(</Highlight><Highlight kind="stringliteral">&quot;bound.tid.ptr&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09135" /><CodeLine lineNumber="9135"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShared)</Highlight></CodeLine>
<Link id="l09136" /><CodeLine lineNumber="9136"><Highlight kind="normal">      OutlinedFn.<a href="/docs/api/classes/llvm/function/#aecf2b6d6f052a378dd8f69fd1bb700b1">getArg</a>(2)-&gt;<a href="/docs/api/classes/llvm/value/#a35ee267850af7c235474a8c46c7ac5af">setName</a>(</Highlight><Highlight kind="stringliteral">&quot;data&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09137" /><CodeLine lineNumber="9137"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09138" /><CodeLine lineNumber="9138"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Call to the runtime function for teams in the current function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09139" /><CodeLine lineNumber="9139"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(StaleCI &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Error while outlining - no CallInst user found for the &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09140" /><CodeLine lineNumber="9140"><Highlight kind="normal">                      </Highlight><Highlight kind="stringliteral">&quot;outlined function.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09141" /><CodeLine lineNumber="9141"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(StaleCI);</Highlight></CodeLine>
<Link id="l09142" /><CodeLine lineNumber="9142"><Highlight kind="normal">    SmallVector&lt;Value &#42;&gt; <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a> = &#123;</Highlight></CodeLine>
<Link id="l09143" /><CodeLine lineNumber="9143"><Highlight kind="normal">        Ident, Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a8246a9e9405ffe2a9d8d020a949c8e96">getInt32</a>(StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#adde2ea00dd2613ee41bfe91908e4e68e">arg&#95;size</a>() - 2), &amp;OutlinedFn&#125;;</Highlight></CodeLine>
<Link id="l09144" /><CodeLine lineNumber="9144"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasShared)</Highlight></CodeLine>
<Link id="l09145" /><CodeLine lineNumber="9145"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/amdgpu/hsamd/kernel/key/#a1958a762261549463a280bac3274d6d5">Args</a>.push&#95;back(StaleCI-&gt;<a href="/docs/api/classes/llvm/callbase/#aabd76e6a8a23a5af1ce4d3c310d88bcd">getArgOperand</a>(2));</Highlight></CodeLine>
<Link id="l09146" /><CodeLine lineNumber="9146"><Highlight kind="normal">    Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ab086c5b9f9563eda0cdd703f454e041e">CreateCall</a>(getOrCreateRuntimeFunctionPtr(</Highlight></CodeLine>
<Link id="l09147" /><CodeLine lineNumber="9147"><Highlight kind="normal">                           omp::RuntimeFunction::OMPRTL&#95;&#95;&#95;kmpc&#95;fork&#95;teams),</Highlight></CodeLine>
<Link id="l09148" /><CodeLine lineNumber="9148"><Highlight kind="normal">                       Args);</Highlight></CodeLine>
<Link id="l09149" /><CodeLine lineNumber="9149"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09150" /><CodeLine lineNumber="9150"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (Instruction &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">llvm::reverse</a>(ToBeDeleted))</Highlight></CodeLine>
<Link id="l09151" /><CodeLine lineNumber="9151"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l09152" /><CodeLine lineNumber="9152"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l09153" /><CodeLine lineNumber="9153"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09154" /><CodeLine lineNumber="9154"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Config.isTargetDevice())</Highlight></CodeLine>
<Link id="l09155" /><CodeLine lineNumber="9155"><Highlight kind="normal">    OI.PostOutlineCB = HostPostOutlineCB;</Highlight></CodeLine>
<Link id="l09156" /><CodeLine lineNumber="9156"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09157" /><CodeLine lineNumber="9157"><Highlight kind="normal">  addOutlineInfo(std::move(OI));</Highlight></CodeLine>
<Link id="l09158" /><CodeLine lineNumber="9158"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09159" /><CodeLine lineNumber="9159"><Highlight kind="normal">  Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#ace45cae6925c65e9d6916e09dd5b17cc">SetInsertPoint</a>(ExitBB, ExitBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#a0ed5f3ab3c2e4196ee0cffffa080c062">begin</a>());</Highlight></CodeLine>
<Link id="l09160" /><CodeLine lineNumber="9160"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09161" /><CodeLine lineNumber="9161"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a79479229269c1abc7dba0840d19b97cf">saveIP</a>();</Highlight></CodeLine>
<Link id="l09162" /><CodeLine lineNumber="9162"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09163" /><CodeLine lineNumber="9163"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09164" /><CodeLine lineNumber="9164"><Highlight kind="normal"><a href="/docs/api/classes/llvm/globalvariable">GlobalVariable</a> &#42;</Highlight></CodeLine>
<Link id="l09165" /><CodeLine lineNumber="9165"><Highlight kind="normal">OpenMPIRBuilder::createOffloadMapnames(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;llvm::Constant &#42;&gt;</a> &amp;Names,</Highlight></CodeLine>
<Link id="l09166" /><CodeLine lineNumber="9166"><Highlight kind="normal">                                       std::string VarName) &#123;</Highlight></CodeLine>
<Link id="l09167" /><CodeLine lineNumber="9167"><Highlight kind="normal">  llvm::Constant &#42;MapNamesArrayInit = <a href="/docs/api/classes/llvm/constantarray/#a0900dacdc7ad8e3ea0cc92993c7fd422">llvm::ConstantArray::get</a>(</Highlight></CodeLine>
<Link id="l09168" /><CodeLine lineNumber="9168"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/arraytype/#a309fed0882f9d27038ff2df2afed7a00">llvm::ArrayType::get</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">llvm::PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext()),</Highlight></CodeLine>
<Link id="l09169" /><CodeLine lineNumber="9169"><Highlight kind="normal">                           <a href="/docs/api/namespaces/anonymous-textstubv5-cpp-/#ad2f3f81faa370c8bf9a1f81612c90adfa638c40d9df2fbeba253de8cd53d19afd">Names</a>.size()),</Highlight></CodeLine>
<Link id="l09170" /><CodeLine lineNumber="9170"><Highlight kind="normal">      Names);</Highlight></CodeLine>
<Link id="l09171" /><CodeLine lineNumber="9171"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;MapNamesArrayGlobal = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> llvm::GlobalVariable(</Highlight></CodeLine>
<Link id="l09172" /><CodeLine lineNumber="9172"><Highlight kind="normal">      M, MapNamesArrayInit-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>(),</Highlight></CodeLine>
<Link id="l09173" /><CodeLine lineNumber="9173"><Highlight kind="normal">      </Highlight><Highlight kind="comment">/&#42;isConstant=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca04ed141708c0fd16723d212502b046ae">llvm::GlobalValue::PrivateLinkage</a>, MapNamesArrayInit,</Highlight></CodeLine>
<Link id="l09174" /><CodeLine lineNumber="9174"><Highlight kind="normal">      VarName);</Highlight></CodeLine>
<Link id="l09175" /><CodeLine lineNumber="9175"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> MapNamesArrayGlobal;</Highlight></CodeLine>
<Link id="l09176" /><CodeLine lineNumber="9176"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09177" /><CodeLine lineNumber="9177"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09178" /><CodeLine lineNumber="9178"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Create all simple and struct types exposed by the runtime and remember</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09179" /><CodeLine lineNumber="9179"><Highlight kind="normal"></Highlight><Highlight kind="comment">// the llvm::PointerTypes of them for easy access later.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09180" /><CodeLine lineNumber="9180"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::initializeTypes(<a href="/docs/api/classes/llvm/module">Module</a> &amp;M) &#123;</Highlight></CodeLine>
<Link id="l09181" /><CodeLine lineNumber="9181"><Highlight kind="normal">  LLVMContext &amp;Ctx = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l09182" /><CodeLine lineNumber="9182"><Highlight kind="normal">  StructType &#42;<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>;</Highlight></CodeLine>
<Link id="l09183" /><CodeLine lineNumber="9183"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;TYPE(VarName, InitValue) VarName = InitValue;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09184" /><CodeLine lineNumber="9184"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;ARRAY&#95;TYPE(VarName, ElemTy, ArraySize)                             \\</Highlight></CodeLine>
<Link id="l09185" /><CodeLine lineNumber="9185"><Highlight kind="preprocessor">  VarName##Ty = ArrayType::get(ElemTy, ArraySize);                             \\</Highlight></CodeLine>
<Link id="l09186" /><CodeLine lineNumber="9186"><Highlight kind="preprocessor">  VarName##PtrTy = PointerType::getUnqual(Ctx);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09187" /><CodeLine lineNumber="9187"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;FUNCTION&#95;TYPE(VarName, IsVarArg, ReturnType, ...)                  \\</Highlight></CodeLine>
<Link id="l09188" /><CodeLine lineNumber="9188"><Highlight kind="preprocessor">  VarName = FunctionType::get(ReturnType, &#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;, IsVarArg);            \\</Highlight></CodeLine>
<Link id="l09189" /><CodeLine lineNumber="9189"><Highlight kind="preprocessor">  VarName##Ptr = PointerType::getUnqual(Ctx);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09190" /><CodeLine lineNumber="9190"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define OMP&#95;STRUCT&#95;TYPE(VarName, StructName, Packed, ...)                      \\</Highlight></CodeLine>
<Link id="l09191" /><CodeLine lineNumber="9191"><Highlight kind="preprocessor">  T = StructType::getTypeByName(Ctx, StructName);                              \\</Highlight></CodeLine>
<Link id="l09192" /><CodeLine lineNumber="9192"><Highlight kind="preprocessor">  if (!T)                                                                      \\</Highlight></CodeLine>
<Link id="l09193" /><CodeLine lineNumber="9193"><Highlight kind="preprocessor">    T = StructType::create(Ctx, &#123;&#95;&#95;VA&#95;ARGS&#95;&#95;&#125;, StructName, Packed);            \\</Highlight></CodeLine>
<Link id="l09194" /><CodeLine lineNumber="9194"><Highlight kind="preprocessor">  VarName = T;                                                                 \\</Highlight></CodeLine>
<Link id="l09195" /><CodeLine lineNumber="9195"><Highlight kind="preprocessor">  VarName##Ptr = PointerType::getUnqual(Ctx);</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09196" /><CodeLine lineNumber="9196"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;llvm/Frontend/OpenMP/OMPKinds.def&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09197" /><CodeLine lineNumber="9197"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09198" /><CodeLine lineNumber="9198"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09199" /><CodeLine lineNumber="9199"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::OutlineInfo::collectBlocks(</Highlight></CodeLine>
<Link id="l09200" /><CodeLine lineNumber="9200"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;BasicBlock &#42;&gt;</a> &amp;BlockSet,</Highlight></CodeLine>
<Link id="l09201" /><CodeLine lineNumber="9201"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;BasicBlock &#42;&gt;</a> &amp;BlockVector) &#123;</Highlight></CodeLine>
<Link id="l09202" /><CodeLine lineNumber="9202"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 32&gt;</a> Worklist;</Highlight></CodeLine>
<Link id="l09203" /><CodeLine lineNumber="9203"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/anonymous-spirvstructurizer-cpp-/#aa4ac0cf7354cfba97c5050380cb0d29f">BlockSet</a>.insert(EntryBB);</Highlight></CodeLine>
<Link id="l09204" /><CodeLine lineNumber="9204"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/anonymous-spirvstructurizer-cpp-/#aa4ac0cf7354cfba97c5050380cb0d29f">BlockSet</a>.insert(ExitBB);</Highlight></CodeLine>
<Link id="l09205" /><CodeLine lineNumber="9205"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09206" /><CodeLine lineNumber="9206"><Highlight kind="normal">  Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(EntryBB);</Highlight></CodeLine>
<Link id="l09207" /><CodeLine lineNumber="9207"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (!Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</Highlight></CodeLine>
<Link id="l09208" /><CodeLine lineNumber="9208"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB = Worklist.<a href="/docs/api/classes/llvm/smallvectorimpl/#a0c8ffe664a36e30d49c84d0aded2fe08">pop&#95;back&#95;val</a>();</Highlight></CodeLine>
<Link id="l09209" /><CodeLine lineNumber="9209"><Highlight kind="normal">    <a href="/docs/api/namespaces/anonymous-webassemblyfixirreduciblecontrolflow-cpp-/#a3e92ddb387e221cd76d85d4f508b1716">BlockVector</a>.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(BB);</Highlight></CodeLine>
<Link id="l09210" /><CodeLine lineNumber="9210"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;SuccBB : <a href="/docs/api/namespaces/llvm/#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(BB))</Highlight></CodeLine>
<Link id="l09211" /><CodeLine lineNumber="9211"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/anonymous-spirvstructurizer-cpp-/#aa4ac0cf7354cfba97c5050380cb0d29f">BlockSet</a>.insert(SuccBB).second)</Highlight></CodeLine>
<Link id="l09212" /><CodeLine lineNumber="9212"><Highlight kind="normal">        Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(SuccBB);</Highlight></CodeLine>
<Link id="l09213" /><CodeLine lineNumber="9213"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09214" /><CodeLine lineNumber="9214"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09215" /><CodeLine lineNumber="9215"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09216" /><CodeLine lineNumber="9216"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::createOffloadEntry(<a href="/docs/api/classes/llvm/constant">Constant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>, <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;Addr,</Highlight></CodeLine>
<Link id="l09217" /><CodeLine lineNumber="9217"><Highlight kind="normal">                                         uint64&#95;t <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, int32&#95;t <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>,</Highlight></CodeLine>
<Link id="l09218" /><CodeLine lineNumber="9218"><Highlight kind="normal">                                         <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57c">GlobalValue::LinkageTypes</a>,</Highlight></CodeLine>
<Link id="l09219" /><CodeLine lineNumber="9219"><Highlight kind="normal">                                         <a href="/docs/api/classes/llvm/stringref">StringRef</a> Name) &#123;</Highlight></CodeLine>
<Link id="l09220" /><CodeLine lineNumber="9220"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Config.isGPU()) &#123;</Highlight></CodeLine>
<Link id="l09221" /><CodeLine lineNumber="9221"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/offloading/#a4b79b6c874e2b55eb4dda2ae96867f84">llvm::offloading::emitOffloadingEntry</a>(</Highlight></CodeLine>
<Link id="l09222" /><CodeLine lineNumber="9222"><Highlight kind="normal">        M, <a href="/docs/api/namespaces/llvm/object/#a92b4561998310fbcfbeaeb7c449bad6aaf8060971587bf244fd04e657d00529ff">object::OffloadKind::OFK&#95;OpenMP</a>, <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>,</Highlight></CodeLine>
<Link id="l09223" /><CodeLine lineNumber="9223"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/graphprogram/#a0ad4685976f8c4d4a697a53fbe05d10b">Name</a>.empty() ? Addr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : Name, <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>, </Highlight><Highlight kind="comment">/&#42;Data=&#42;/</Highlight><Highlight kind="normal">0,</Highlight></CodeLine>
<Link id="l09224" /><CodeLine lineNumber="9224"><Highlight kind="normal">        </Highlight><Highlight kind="stringliteral">&quot;omp&#95;offloading&#95;entries&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09225" /><CodeLine lineNumber="9225"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09226" /><CodeLine lineNumber="9226"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09227" /><CodeLine lineNumber="9227"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Add support for global variables on the device after declare target</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09228" /><CodeLine lineNumber="9228"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// support.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09229" /><CodeLine lineNumber="9229"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/codeview/#adfebd8c4ae29ccd84c600c1e65d6b807a86408593c34af77fdd90df932f8b5261">Function</a> &#42;Fn = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Function&gt;</a>(Addr);</Highlight></CodeLine>
<Link id="l09230" /><CodeLine lineNumber="9230"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Fn)</Highlight></CodeLine>
<Link id="l09231" /><CodeLine lineNumber="9231"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09232" /><CodeLine lineNumber="9232"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09233" /><CodeLine lineNumber="9233"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add a function attribute for the kernel.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09234" /><CodeLine lineNumber="9234"><Highlight kind="normal">  Fn-&gt;<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(</Highlight><Highlight kind="stringliteral">&quot;kernel&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09235" /><CodeLine lineNumber="9235"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a>.isAMDGCN())</Highlight></CodeLine>
<Link id="l09236" /><CodeLine lineNumber="9236"><Highlight kind="normal">    Fn-&gt;<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(</Highlight><Highlight kind="stringliteral">&quot;uniform-work-group-size&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;true&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09237" /><CodeLine lineNumber="9237"><Highlight kind="normal">  Fn-&gt;<a href="/docs/api/classes/llvm/function/#a01875e4204852069dd4b7938cab4140b">addFnAttr</a>(Attribute::MustProgress);</Highlight></CodeLine>
<Link id="l09238" /><CodeLine lineNumber="9238"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09239" /><CodeLine lineNumber="9239"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09240" /><CodeLine lineNumber="9240"><Highlight kind="normal"></Highlight><Highlight kind="comment">// We only generate metadata for function that contain target regions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09241" /><CodeLine lineNumber="9241"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OpenMPIRBuilder::createOffloadEntriesAndInfoMetadata(</Highlight></CodeLine>
<Link id="l09242" /><CodeLine lineNumber="9242"><Highlight kind="normal">    EmitMetadataErrorReportFunctionTy &amp;ErrorFn) &#123;</Highlight></CodeLine>
<Link id="l09243" /><CodeLine lineNumber="9243"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09244" /><CodeLine lineNumber="9244"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there are no entries, we don&#39;t need to do anything.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09245" /><CodeLine lineNumber="9245"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OffloadInfoManager.empty())</Highlight></CodeLine>
<Link id="l09246" /><CodeLine lineNumber="9246"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09247" /><CodeLine lineNumber="9247"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09248" /><CodeLine lineNumber="9248"><Highlight kind="normal">  LLVMContext &amp;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext();</Highlight></CodeLine>
<Link id="l09249" /><CodeLine lineNumber="9249"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector</a>&lt;std::pair&lt;</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OffloadEntriesInfoManager::OffloadEntryInfo &#42;,</Highlight></CodeLine>
<Link id="l09250" /><CodeLine lineNumber="9250"><Highlight kind="normal">                        TargetRegionEntryInfo&gt;,</Highlight></CodeLine>
<Link id="l09251" /><CodeLine lineNumber="9251"><Highlight kind="normal">              16&gt;</Highlight></CodeLine>
<Link id="l09252" /><CodeLine lineNumber="9252"><Highlight kind="normal">      OrderedEntries(OffloadInfoManager.size());</Highlight></CodeLine>
<Link id="l09253" /><CodeLine lineNumber="9253"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09254" /><CodeLine lineNumber="9254"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Auxiliary methods to create metadata values and strings.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09255" /><CodeLine lineNumber="9255"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;GetMDInt = &#91;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal">&#93;(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>) &#123;</Highlight></CodeLine>
<Link id="l09256" /><CodeLine lineNumber="9256"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/constantasmetadata/#a4c720c398a263087e00d7358b05636d5">ConstantAsMetadata::get</a>(ConstantInt::get(Builder.<a href="/docs/api/classes/llvm/irbuilderbase/#a5852dc0d180581d34902e8abcbf7e930">getInt32Ty</a>(), V));</Highlight></CodeLine>
<Link id="l09257" /><CodeLine lineNumber="9257"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l09258" /><CodeLine lineNumber="9258"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09259" /><CodeLine lineNumber="9259"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;GetMDString = &#91;&amp;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>&#93;(StringRef <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>) &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/mdstring/#affbb7e2e9ad8d18114816f2443d672b9">MDString::get</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, V); &#125;;</Highlight></CodeLine>
<Link id="l09260" /><CodeLine lineNumber="9260"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09261" /><CodeLine lineNumber="9261"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create the offloading info metadata node.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09262" /><CodeLine lineNumber="9262"><Highlight kind="normal">  NamedMDNode &#42;MD = <a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getOrInsertNamedMetadata(</Highlight><Highlight kind="stringliteral">&quot;omp&#95;offload.info&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09263" /><CodeLine lineNumber="9263"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;TargetRegionMetadataEmitter =</Highlight></CodeLine>
<Link id="l09264" /><CodeLine lineNumber="9264"><Highlight kind="normal">      &#91;&amp;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, MD, &amp;OrderedEntries, &amp;GetMDInt, &amp;GetMDString&#93;(</Highlight></CodeLine>
<Link id="l09265" /><CodeLine lineNumber="9265"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> TargetRegionEntryInfo &amp;EntryInfo,</Highlight></CodeLine>
<Link id="l09266" /><CodeLine lineNumber="9266"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OffloadEntriesInfoManager::OffloadEntryInfoTargetRegion &amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>) &#123;</Highlight></CodeLine>
<Link id="l09267" /><CodeLine lineNumber="9267"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Generate metadata for target regions. Each entry of this metadata</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09268" /><CodeLine lineNumber="9268"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// contains:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09269" /><CodeLine lineNumber="9269"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 0 -&gt; Kind of this type of metadata (0).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09270" /><CodeLine lineNumber="9270"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 1 -&gt; Device ID of the file where the entry was identified.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09271" /><CodeLine lineNumber="9271"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 2 -&gt; File ID of the file where the entry was identified.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09272" /><CodeLine lineNumber="9272"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 3 -&gt; Mangled name of the function where the entry was</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09273" /><CodeLine lineNumber="9273"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// identified.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09274" /><CodeLine lineNumber="9274"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 4 -&gt; Line in the file where the entry was identified.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09275" /><CodeLine lineNumber="9275"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 5 -&gt; Count of regions at this DeviceID/FilesID/Line.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09276" /><CodeLine lineNumber="9276"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 6 -&gt; Order the entry was created.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09277" /><CodeLine lineNumber="9277"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// The first element of the metadata node is the kind.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09278" /><CodeLine lineNumber="9278"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/directx/dxiltranslatemetadata-cpp/#a26b689be9525270658579553e0adfec1">Metadata</a> &#42;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l09279" /><CodeLine lineNumber="9279"><Highlight kind="normal">            GetMDInt(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.getKind()),      GetMDInt(EntryInfo.DeviceID),</Highlight></CodeLine>
<Link id="l09280" /><CodeLine lineNumber="9280"><Highlight kind="normal">            GetMDInt(EntryInfo.FileID), GetMDString(EntryInfo.ParentName),</Highlight></CodeLine>
<Link id="l09281" /><CodeLine lineNumber="9281"><Highlight kind="normal">            GetMDInt(EntryInfo.Line),   GetMDInt(EntryInfo.Count),</Highlight></CodeLine>
<Link id="l09282" /><CodeLine lineNumber="9282"><Highlight kind="normal">            GetMDInt(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.getOrder())&#125;;</Highlight></CodeLine>
<Link id="l09283" /><CodeLine lineNumber="9283"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09284" /><CodeLine lineNumber="9284"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Save this entry in the right position of the ordered entries array.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09285" /><CodeLine lineNumber="9285"><Highlight kind="normal">        OrderedEntries&#91;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.getOrder()&#93; = std::make&#95;pair(&amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>, EntryInfo);</Highlight></CodeLine>
<Link id="l09286" /><CodeLine lineNumber="9286"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09287" /><CodeLine lineNumber="9287"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Add metadata to the named metadata node.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09288" /><CodeLine lineNumber="9288"><Highlight kind="normal">        MD-&gt;addOperand(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</Highlight></CodeLine>
<Link id="l09289" /><CodeLine lineNumber="9289"><Highlight kind="normal">      &#125;;</Highlight></CodeLine>
<Link id="l09290" /><CodeLine lineNumber="9290"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09291" /><CodeLine lineNumber="9291"><Highlight kind="normal">  OffloadInfoManager.actOnTargetRegionEntriesInfo(TargetRegionMetadataEmitter);</Highlight></CodeLine>
<Link id="l09292" /><CodeLine lineNumber="9292"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09293" /><CodeLine lineNumber="9293"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create function that emits metadata for each device global variable entry;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09294" /><CodeLine lineNumber="9294"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;DeviceGlobalVarMetadataEmitter =</Highlight></CodeLine>
<Link id="l09295" /><CodeLine lineNumber="9295"><Highlight kind="normal">      &#91;&amp;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, &amp;OrderedEntries, &amp;GetMDInt, &amp;GetMDString, MD&#93;(</Highlight></CodeLine>
<Link id="l09296" /><CodeLine lineNumber="9296"><Highlight kind="normal">          StringRef MangledName,</Highlight></CodeLine>
<Link id="l09297" /><CodeLine lineNumber="9297"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OffloadEntriesInfoManager::OffloadEntryInfoDeviceGlobalVar &amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>) &#123;</Highlight></CodeLine>
<Link id="l09298" /><CodeLine lineNumber="9298"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Generate metadata for global variables. Each entry of this metadata</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09299" /><CodeLine lineNumber="9299"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// contains:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09300" /><CodeLine lineNumber="9300"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 0 -&gt; Kind of this type of metadata (1).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09301" /><CodeLine lineNumber="9301"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 1 -&gt; Mangled name of the variable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09302" /><CodeLine lineNumber="9302"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 2 -&gt; Declare target kind.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09303" /><CodeLine lineNumber="9303"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// - Entry 3 -&gt; Order the entry was created.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09304" /><CodeLine lineNumber="9304"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// The first element of the metadata node is the kind.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09305" /><CodeLine lineNumber="9305"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/directx/dxiltranslatemetadata-cpp/#a26b689be9525270658579553e0adfec1">Metadata</a> &#42;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>&#91;&#93; = &#123;GetMDInt(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.getKind()), GetMDString(MangledName),</Highlight></CodeLine>
<Link id="l09306" /><CodeLine lineNumber="9306"><Highlight kind="normal">                           GetMDInt(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.getFlags()), GetMDInt(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.getOrder())&#125;;</Highlight></CodeLine>
<Link id="l09307" /><CodeLine lineNumber="9307"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09308" /><CodeLine lineNumber="9308"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Save this entry in the right position of the ordered entries array.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09309" /><CodeLine lineNumber="9309"><Highlight kind="normal">        TargetRegionEntryInfo varInfo(MangledName, 0, 0, 0);</Highlight></CodeLine>
<Link id="l09310" /><CodeLine lineNumber="9310"><Highlight kind="normal">        OrderedEntries&#91;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.getOrder()&#93; = std::make&#95;pair(&amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>, varInfo);</Highlight></CodeLine>
<Link id="l09311" /><CodeLine lineNumber="9311"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09312" /><CodeLine lineNumber="9312"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Add metadata to the named metadata node.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09313" /><CodeLine lineNumber="9313"><Highlight kind="normal">        MD-&gt;addOperand(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">MDNode::get</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</Highlight></CodeLine>
<Link id="l09314" /><CodeLine lineNumber="9314"><Highlight kind="normal">      &#125;;</Highlight></CodeLine>
<Link id="l09315" /><CodeLine lineNumber="9315"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09316" /><CodeLine lineNumber="9316"><Highlight kind="normal">  OffloadInfoManager.actOnDeviceGlobalVarEntriesInfo(</Highlight></CodeLine>
<Link id="l09317" /><CodeLine lineNumber="9317"><Highlight kind="normal">      DeviceGlobalVarMetadataEmitter);</Highlight></CodeLine>
<Link id="l09318" /><CodeLine lineNumber="9318"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09319" /><CodeLine lineNumber="9319"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> : OrderedEntries) &#123;</Highlight></CodeLine>
<Link id="l09320" /><CodeLine lineNumber="9320"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.first &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;All ordered entries must exist!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09321" /><CodeLine lineNumber="9321"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CE =</Highlight></CodeLine>
<Link id="l09322" /><CodeLine lineNumber="9322"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;OffloadEntriesInfoManager::OffloadEntryInfoTargetRegion&gt;</a>(</Highlight></CodeLine>
<Link id="l09323" /><CodeLine lineNumber="9323"><Highlight kind="normal">                <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.first)) &#123;</Highlight></CodeLine>
<Link id="l09324" /><CodeLine lineNumber="9324"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getID() || !<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress()) &#123;</Highlight></CodeLine>
<Link id="l09325" /><CodeLine lineNumber="9325"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Do not blame the entry if the parent funtion is not emitted.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09326" /><CodeLine lineNumber="9326"><Highlight kind="normal">        TargetRegionEntryInfo EntryInfo = <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.second;</Highlight></CodeLine>
<Link id="l09327" /><CodeLine lineNumber="9327"><Highlight kind="normal">        StringRef FnName = EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a89525afb0a8095beeb2dc7b083491942">ParentName</a>;</Highlight></CodeLine>
<Link id="l09328" /><CodeLine lineNumber="9328"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getNamedValue(FnName))</Highlight></CodeLine>
<Link id="l09329" /><CodeLine lineNumber="9329"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09330" /><CodeLine lineNumber="9330"><Highlight kind="normal">        ErrorFn(EMIT&#95;MD&#95;TARGET&#95;REGION&#95;ERROR, EntryInfo);</Highlight></CodeLine>
<Link id="l09331" /><CodeLine lineNumber="9331"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09332" /><CodeLine lineNumber="9332"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l09333" /><CodeLine lineNumber="9333"><Highlight kind="normal">      createOffloadEntry(<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getID(), <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress(),</Highlight></CodeLine>
<Link id="l09334" /><CodeLine lineNumber="9334"><Highlight kind="normal">                         </Highlight><Highlight kind="comment">/&#42;Size=&#42;/</Highlight><Highlight kind="normal">0, <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getFlags(),</Highlight></CodeLine>
<Link id="l09335" /><CodeLine lineNumber="9335"><Highlight kind="normal">                         <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f">GlobalValue::WeakAnyLinkage</a>);</Highlight></CodeLine>
<Link id="l09336" /><CodeLine lineNumber="9336"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CE = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast</a>&lt;</Highlight></CodeLine>
<Link id="l09337" /><CodeLine lineNumber="9337"><Highlight kind="normal">                   OffloadEntriesInfoManager::OffloadEntryInfoDeviceGlobalVar&gt;(</Highlight></CodeLine>
<Link id="l09338" /><CodeLine lineNumber="9338"><Highlight kind="normal">                   <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.first)) &#123;</Highlight></CodeLine>
<Link id="l09339" /><CodeLine lineNumber="9339"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryKind</a> <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> =</Highlight></CodeLine>
<Link id="l09340" /><CodeLine lineNumber="9340"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryKind</a></Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l09341" /><CodeLine lineNumber="9341"><Highlight kind="normal">              <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getFlags());</Highlight></CodeLine>
<Link id="l09342" /><CodeLine lineNumber="9342"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>) &#123;</Highlight></CodeLine>
<Link id="l09343" /><CodeLine lineNumber="9343"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534a1b9b415348a31bfeaa94e778e0421ddf">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryEnter</a>:</Highlight></CodeLine>
<Link id="l09344" /><CodeLine lineNumber="9344"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534acf96797e65a60ff4302eb2bbdbbd8880">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryTo</a>:</Highlight></CodeLine>
<Link id="l09345" /><CodeLine lineNumber="9345"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice() &amp;&amp; Config.hasRequiresUnifiedSharedMemory())</Highlight></CodeLine>
<Link id="l09346" /><CodeLine lineNumber="9346"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09347" /><CodeLine lineNumber="9347"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress()) &#123;</Highlight></CodeLine>
<Link id="l09348" /><CodeLine lineNumber="9348"><Highlight kind="normal">          ErrorFn(EMIT&#95;MD&#95;DECLARE&#95;TARGET&#95;ERROR, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>.second);</Highlight></CodeLine>
<Link id="l09349" /><CodeLine lineNumber="9349"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09350" /><CodeLine lineNumber="9350"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l09351" /><CodeLine lineNumber="9351"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// The vaiable has no definition - no need to add the entry.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09352" /><CodeLine lineNumber="9352"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getVarSize() == 0)</Highlight></CodeLine>
<Link id="l09353" /><CodeLine lineNumber="9353"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09354" /><CodeLine lineNumber="9354"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09355" /><CodeLine lineNumber="9355"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534abe3a7916fb5f7a79d6aea6c0356e71a6">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryLink</a>:</Highlight></CodeLine>
<Link id="l09356" /><CodeLine lineNumber="9356"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(((Config.isTargetDevice() &amp;&amp; !<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress()) ||</Highlight></CodeLine>
<Link id="l09357" /><CodeLine lineNumber="9357"><Highlight kind="normal">                (!Config.isTargetDevice() &amp;&amp; <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress())) &amp;&amp;</Highlight></CodeLine>
<Link id="l09358" /><CodeLine lineNumber="9358"><Highlight kind="normal">               </Highlight><Highlight kind="stringliteral">&quot;Declaret target link address is set.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09359" /><CodeLine lineNumber="9359"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice())</Highlight></CodeLine>
<Link id="l09360" /><CodeLine lineNumber="9360"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09361" /><CodeLine lineNumber="9361"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress()) &#123;</Highlight></CodeLine>
<Link id="l09362" /><CodeLine lineNumber="9362"><Highlight kind="normal">          ErrorFn(EMIT&#95;MD&#95;GLOBAL&#95;VAR&#95;LINK&#95;ERROR, TargetRegionEntryInfo());</Highlight></CodeLine>
<Link id="l09363" /><CodeLine lineNumber="9363"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09364" /><CodeLine lineNumber="9364"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l09365" /><CodeLine lineNumber="9365"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09366" /><CodeLine lineNumber="9366"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l09367" /><CodeLine lineNumber="9367"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09368" /><CodeLine lineNumber="9368"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l09369" /><CodeLine lineNumber="9369"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09370" /><CodeLine lineNumber="9370"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Hidden or internal symbols on the device are not externally visible.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09371" /><CodeLine lineNumber="9371"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// We should not attempt to register them by creating an offloading</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09372" /><CodeLine lineNumber="9372"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// entry. Indirect variables are handled separately on the device.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09373" /><CodeLine lineNumber="9373"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;GV = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;GlobalValue&gt;</a>(<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress()))</Highlight></CodeLine>
<Link id="l09374" /><CodeLine lineNumber="9374"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((GV-&gt;hasLocalLinkage() || GV-&gt;hasHiddenVisibility()) &amp;&amp;</Highlight></CodeLine>
<Link id="l09375" /><CodeLine lineNumber="9375"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> != <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534aba847264872ebbdaf660316167b89e15">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryIndirect</a>)</Highlight></CodeLine>
<Link id="l09376" /><CodeLine lineNumber="9376"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09377" /><CodeLine lineNumber="9377"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09378" /><CodeLine lineNumber="9378"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Indirect globals need to use a special name that doesn&#39;t match the name</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09379" /><CodeLine lineNumber="9379"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// of the associated host global.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09380" /><CodeLine lineNumber="9380"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a> == <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534aba847264872ebbdaf660316167b89e15">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryIndirect</a>)</Highlight></CodeLine>
<Link id="l09381" /><CodeLine lineNumber="9381"><Highlight kind="normal">        createOffloadEntry(<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress(), <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress(), <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getVarSize(),</Highlight></CodeLine>
<Link id="l09382" /><CodeLine lineNumber="9382"><Highlight kind="normal">                           <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>, <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getLinkage(), <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getVarName());</Highlight></CodeLine>
<Link id="l09383" /><CodeLine lineNumber="9383"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09384" /><CodeLine lineNumber="9384"><Highlight kind="normal">        createOffloadEntry(<a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress(), <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getAddress(), <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getVarSize(),</Highlight></CodeLine>
<Link id="l09385" /><CodeLine lineNumber="9385"><Highlight kind="normal">                           <a href="/docs/api/namespaces/llvm/omp/#a16d7c5f77008a84ae20bf4a5c41e51f0a4ea7801f17a4e5485e8b050c052fb443">Flags</a>, <a href="/docs/api/namespaces/llvm/wineh/#a1c8d8103d6b914c2ade85873cb97f6d9a7a86131338bf955e0a56311f264aa6aa">CE</a>-&gt;getLinkage());</Highlight></CodeLine>
<Link id="l09386" /><CodeLine lineNumber="9386"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09387" /><CodeLine lineNumber="9387"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l09388" /><CodeLine lineNumber="9388"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unsupported entry kind.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09389" /><CodeLine lineNumber="9389"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09390" /><CodeLine lineNumber="9390"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09391" /><CodeLine lineNumber="9391"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09392" /><CodeLine lineNumber="9392"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit requires directive globals to a special entry so the runtime can</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09393" /><CodeLine lineNumber="9393"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// register them when the device image is loaded.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09394" /><CodeLine lineNumber="9394"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: This reduces the offloading entries to a 32-bit integer. Offloading</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09395" /><CodeLine lineNumber="9395"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//       entries should be redesigned to better suit this use-case.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09396" /><CodeLine lineNumber="9396"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.hasRequiresFlags() &amp;&amp; !Config.isTargetDevice())</Highlight></CodeLine>
<Link id="l09397" /><CodeLine lineNumber="9397"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/offloading/#a4b79b6c874e2b55eb4dda2ae96867f84">offloading::emitOffloadingEntry</a>(</Highlight></CodeLine>
<Link id="l09398" /><CodeLine lineNumber="9398"><Highlight kind="normal">        M, <a href="/docs/api/namespaces/llvm/object/#a92b4561998310fbcfbeaeb7c449bad6aaf8060971587bf244fd04e657d00529ff">object::OffloadKind::OFK&#95;OpenMP</a>,</Highlight></CodeLine>
<Link id="l09399" /><CodeLine lineNumber="9399"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/constant/#aa6574d526b3e38a28f688a7bb4325c2c">Constant::getNullValue</a>(<a href="/docs/api/classes/llvm/pointertype/#af8a1dbdbfd89aa4899b3c0d39495d0dd">PointerType::getUnqual</a>(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>.getContext())),</Highlight></CodeLine>
<Link id="l09400" /><CodeLine lineNumber="9400"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;Name=&#42;/</Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l09401" /><CodeLine lineNumber="9401"><Highlight kind="normal">        </Highlight><Highlight kind="comment">/&#42;Size=&#42;/</Highlight><Highlight kind="normal">0, <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534ab16880c5ddd7886e422bf6dc1e670cca">OffloadEntriesInfoManager::OMPTargetGlobalRegisterRequires</a>,</Highlight></CodeLine>
<Link id="l09402" /><CodeLine lineNumber="9402"><Highlight kind="normal">        Config.getRequiresFlags(), </Highlight><Highlight kind="stringliteral">&quot;omp&#95;offloading&#95;entries&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09403" /><CodeLine lineNumber="9403"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09404" /><CodeLine lineNumber="9404"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09405" /><CodeLine lineNumber="9405" lineLink="/docs/api/structs/llvm/targetregionentryinfo/#a0a267f191642077971aa8eeba25ea6f5"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo/#a0a267f191642077971aa8eeba25ea6f5">TargetRegionEntryInfo::getTargetRegionEntryFnName</a>(</Highlight></CodeLine>
<Link id="l09406" /><CodeLine lineNumber="9406"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;char&gt;</a> &amp;Name, <a href="/docs/api/classes/llvm/stringref">StringRef</a> <a href="/docs/api/structs/llvm/targetregionentryinfo/#a89525afb0a8095beeb2dc7b083491942">ParentName</a>, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo/#a50a8eeba86c83f02b7e129b7880ec654">DeviceID</a>,</Highlight></CodeLine>
<Link id="l09407" /><CodeLine lineNumber="9407"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo/#a80293a526ecd17ee44ce5b982dff1ca1">FileID</a>, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo/#a70f195e58ff3b0960a5c0884449d092a">Line</a>, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo/#a8cc8999b43ab73c1f7f8618f7735f3cd">Count</a>) &#123;</Highlight></CodeLine>
<Link id="l09408" /><CodeLine lineNumber="9408"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/raw-svector-ostream">raw&#95;svector&#95;ostream</a> OS(Name);</Highlight></CodeLine>
<Link id="l09409" /><CodeLine lineNumber="9409"><Highlight kind="normal">  OS &lt;&lt; <a href="/docs/api/structs/llvm/targetregionentryinfo/#a3e78748236396089e6a27766e44407f9">KernelNamePrefix</a> &lt;&lt; <a href="/docs/api/namespaces/llvm/#a939bc2108d47080767f0c06ba56caec7">llvm::format</a>(</Highlight><Highlight kind="stringliteral">&quot;%x&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/structs/llvm/targetregionentryinfo/#a50a8eeba86c83f02b7e129b7880ec654">DeviceID</a>)</Highlight></CodeLine>
<Link id="l09410" /><CodeLine lineNumber="9410"><Highlight kind="normal">     &lt;&lt; <a href="/docs/api/namespaces/llvm/#a939bc2108d47080767f0c06ba56caec7">llvm::format</a>(</Highlight><Highlight kind="stringliteral">&quot;&#95;%x&#95;&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/structs/llvm/targetregionentryinfo/#a80293a526ecd17ee44ce5b982dff1ca1">FileID</a>) &lt;&lt; <a href="/docs/api/structs/llvm/targetregionentryinfo/#a89525afb0a8095beeb2dc7b083491942">ParentName</a> &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;&#95;l&quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/structs/llvm/targetregionentryinfo/#a70f195e58ff3b0960a5c0884449d092a">Line</a>;</Highlight></CodeLine>
<Link id="l09411" /><CodeLine lineNumber="9411"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/llvm/targetregionentryinfo/#a8cc8999b43ab73c1f7f8618f7735f3cd">Count</a>)</Highlight></CodeLine>
<Link id="l09412" /><CodeLine lineNumber="9412"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;&#95;&quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/structs/llvm/targetregionentryinfo/#a8cc8999b43ab73c1f7f8618f7735f3cd">Count</a>;</Highlight></CodeLine>
<Link id="l09413" /><CodeLine lineNumber="9413"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09414" /><CodeLine lineNumber="9414"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09415" /><CodeLine lineNumber="9415" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#a6827980ed8b61f42e680949ff4511b03"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a6827980ed8b61f42e680949ff4511b03">OffloadEntriesInfoManager::getTargetRegionEntryFnName</a>(</Highlight></CodeLine>
<Link id="l09416" /><CodeLine lineNumber="9416"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;char&gt;</a> &amp;Name, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp;EntryInfo) &#123;</Highlight></CodeLine>
<Link id="l09417" /><CodeLine lineNumber="9417"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NewCount = getTargetRegionEntryInfoCount(EntryInfo);</Highlight></CodeLine>
<Link id="l09418" /><CodeLine lineNumber="9418"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/targetregionentryinfo/#a0a267f191642077971aa8eeba25ea6f5">TargetRegionEntryInfo::getTargetRegionEntryFnName</a>(</Highlight></CodeLine>
<Link id="l09419" /><CodeLine lineNumber="9419"><Highlight kind="normal">      Name, EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a89525afb0a8095beeb2dc7b083491942">ParentName</a>, EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a50a8eeba86c83f02b7e129b7880ec654">DeviceID</a>, EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a80293a526ecd17ee44ce5b982dff1ca1">FileID</a>,</Highlight></CodeLine>
<Link id="l09420" /><CodeLine lineNumber="9420"><Highlight kind="normal">      EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a70f195e58ff3b0960a5c0884449d092a">Line</a>, NewCount);</Highlight></CodeLine>
<Link id="l09421" /><CodeLine lineNumber="9421"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09422" /><CodeLine lineNumber="9422"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09423" /><CodeLine lineNumber="9423"><Highlight kind="normal"><a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a></Highlight></CodeLine>
<Link id="l09424" /><CodeLine lineNumber="9424"><Highlight kind="normal">OpenMPIRBuilder::getTargetEntryUniqueInfo(FileIdentifierInfoCallbackTy CallBack,</Highlight></CodeLine>
<Link id="l09425" /><CodeLine lineNumber="9425"><Highlight kind="normal">                                          <a href="/docs/api/classes/llvm/stringref">StringRef</a> ParentName) &#123;</Highlight></CodeLine>
<Link id="l09426" /><CodeLine lineNumber="9426"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/sys/fs/uniqueid">sys::fs::UniqueID</a> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>;</Highlight></CodeLine>
<Link id="l09427" /><CodeLine lineNumber="9427"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FileIDInfo = CallBack();</Highlight></CodeLine>
<Link id="l09428" /><CodeLine lineNumber="9428"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> EC = <a href="/docs/api/namespaces/llvm/sys/fs/#a7e0dd3b9d03107bf25def8333283d822">sys::fs::getUniqueID</a>(std::get&lt;0&gt;(FileIDInfo), <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>)) &#123;</Highlight></CodeLine>
<Link id="l09429" /><CodeLine lineNumber="9429"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a7f2a3d4dcfee70225988aec53ff1e173">report&#95;fatal&#95;error</a>((</Highlight><Highlight kind="stringliteral">&quot;Unable to get unique ID for file, during &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09430" /><CodeLine lineNumber="9430"><Highlight kind="normal">                        </Highlight><Highlight kind="stringliteral">&quot;getTargetEntryUniqueInfo, error message: &quot;</Highlight><Highlight kind="normal"> +</Highlight></CodeLine>
<Link id="l09431" /><CodeLine lineNumber="9431"><Highlight kind="normal">                        EC.message())</Highlight></CodeLine>
<Link id="l09432" /><CodeLine lineNumber="9432"><Highlight kind="normal">                           .c&#95;str());</Highlight></CodeLine>
<Link id="l09433" /><CodeLine lineNumber="9433"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09434" /><CodeLine lineNumber="9434"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09435" /><CodeLine lineNumber="9435"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a>(ParentName, <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>.getDevice(), <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>.getFile(),</Highlight></CodeLine>
<Link id="l09436" /><CodeLine lineNumber="9436"><Highlight kind="normal">                               std::get&lt;1&gt;(FileIDInfo));</Highlight></CodeLine>
<Link id="l09437" /><CodeLine lineNumber="9437"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09438" /><CodeLine lineNumber="9438"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09439" /><CodeLine lineNumber="9439" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ac86b562509588cbc00fbdc441c615bd3"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#ac86b562509588cbc00fbdc441c615bd3">OpenMPIRBuilder::getFlagMemberOffset</a>() &#123;</Highlight></CodeLine>
<Link id="l09440" /><CodeLine lineNumber="9440"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = 0;</Highlight></CodeLine>
<Link id="l09441" /><CodeLine lineNumber="9441"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (uint64&#95;t Remain =</Highlight></CodeLine>
<Link id="l09442" /><CodeLine lineNumber="9442"><Highlight kind="normal">           </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;omp::OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l09443" /><CodeLine lineNumber="9443"><Highlight kind="normal">               <a href="/docs/api/namespaces/llvm/omp/#a02d7a52c47f2d71a111aef9d4fb70ecbaa450a4e59275b4081714a7a28f217e6c">omp::OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;MEMBER&#95;OF</a>);</Highlight></CodeLine>
<Link id="l09444" /><CodeLine lineNumber="9444"><Highlight kind="normal">       !(Remain &amp; 1); Remain = Remain &gt;&gt; 1)</Highlight></CodeLine>
<Link id="l09445" /><CodeLine lineNumber="9445"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>++;</Highlight></CodeLine>
<Link id="l09446" /><CodeLine lineNumber="9446"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</Highlight></CodeLine>
<Link id="l09447" /><CodeLine lineNumber="9447"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09448" /><CodeLine lineNumber="9448"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09449" /><CodeLine lineNumber="9449"><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/omp/#a02d7a52c47f2d71a111aef9d4fb70ecb">omp::OpenMPOffloadMappingFlags</a></Highlight></CodeLine>
<Link id="l09450" /><CodeLine lineNumber="9450" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a4f82182a8cc23f854efdbd453f685086"><Highlight kind="normal"><a href="/docs/api/classes/llvm/openmpirbuilder/#a4f82182a8cc23f854efdbd453f685086">OpenMPIRBuilder::getMemberOfFlag</a>(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Position) &#123;</Highlight></CodeLine>
<Link id="l09451" /><CodeLine lineNumber="9451"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Rotate by getFlagMemberOffset() bits.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09452" /><CodeLine lineNumber="9452"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/omp/#a02d7a52c47f2d71a111aef9d4fb70ecb">omp::OpenMPOffloadMappingFlags</a></Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(((uint64&#95;t)Position + 1)</Highlight></CodeLine>
<Link id="l09453" /><CodeLine lineNumber="9453"><Highlight kind="normal">                                                     &lt;&lt; <a href="/docs/api/classes/llvm/openmpirbuilder/#ac86b562509588cbc00fbdc441c615bd3">getFlagMemberOffset</a>());</Highlight></CodeLine>
<Link id="l09454" /><CodeLine lineNumber="9454"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09455" /><CodeLine lineNumber="9455"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09456" /><CodeLine lineNumber="9456" lineLink="/docs/api/classes/llvm/openmpirbuilder/#abeea5a3df7d0266470cd04bb721db70e"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#abeea5a3df7d0266470cd04bb721db70e">OpenMPIRBuilder::setCorrectMemberOfFlag</a>(</Highlight></CodeLine>
<Link id="l09457" /><CodeLine lineNumber="9457"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a02d7a52c47f2d71a111aef9d4fb70ecb">omp::OpenMPOffloadMappingFlags</a> &amp;Flags,</Highlight></CodeLine>
<Link id="l09458" /><CodeLine lineNumber="9458"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/omp/#a02d7a52c47f2d71a111aef9d4fb70ecb">omp::OpenMPOffloadMappingFlags</a> MemberOfFlag) &#123;</Highlight></CodeLine>
<Link id="l09459" /><CodeLine lineNumber="9459"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If the entry is PTR&#95;AND&#95;OBJ but has not been marked with the special</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09460" /><CodeLine lineNumber="9460"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// placeholder value 65535 in the MEMBER&#95;OF field, then it should not be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09461" /><CodeLine lineNumber="9461"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// marked as MEMBER&#95;OF.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09462" /><CodeLine lineNumber="9462"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;omp::OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l09463" /><CodeLine lineNumber="9463"><Highlight kind="normal">          Flags &amp; <a href="/docs/api/namespaces/llvm/omp/#a02d7a52c47f2d71a111aef9d4fb70ecba67bb5754d8a930a0abad5e820064be2d">omp::OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;PTR&#95;AND&#95;OBJ</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l09464" /><CodeLine lineNumber="9464"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal">std::underlying&#95;type&#95;t&lt;omp::OpenMPOffloadMappingFlags&gt;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l09465" /><CodeLine lineNumber="9465"><Highlight kind="normal">          (Flags &amp; <a href="/docs/api/namespaces/llvm/omp/#a02d7a52c47f2d71a111aef9d4fb70ecbaa450a4e59275b4081714a7a28f217e6c">omp::OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;MEMBER&#95;OF</a>) !=</Highlight></CodeLine>
<Link id="l09466" /><CodeLine lineNumber="9466"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/omp/#a02d7a52c47f2d71a111aef9d4fb70ecbaa450a4e59275b4081714a7a28f217e6c">omp::OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;MEMBER&#95;OF</a>))</Highlight></CodeLine>
<Link id="l09467" /><CodeLine lineNumber="9467"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09468" /><CodeLine lineNumber="9468"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09469" /><CodeLine lineNumber="9469"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Reset the placeholder value to prepare the flag for the assignment of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09470" /><CodeLine lineNumber="9470"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// proper MEMBER&#95;OF value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09471" /><CodeLine lineNumber="9471"><Highlight kind="normal">  Flags &amp;= <a href="/docs/api/namespaces/llvm/omp">~omp</a>::OpenMPOffloadMappingFlags::OMP&#95;MAP&#95;MEMBER&#95;OF;</Highlight></CodeLine>
<Link id="l09472" /><CodeLine lineNumber="9472"><Highlight kind="normal">  Flags |= MemberOfFlag;</Highlight></CodeLine>
<Link id="l09473" /><CodeLine lineNumber="9473"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09474" /><CodeLine lineNumber="9474"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09475" /><CodeLine lineNumber="9475" lineLink="/docs/api/classes/llvm/openmpirbuilder/#afdc1b8675a946ce055c64607ba75af3a"><Highlight kind="normal"><a href="/docs/api/classes/llvm/constant">Constant</a> &#42;<a href="/docs/api/classes/llvm/openmpirbuilder/#afdc1b8675a946ce055c64607ba75af3a">OpenMPIRBuilder::getAddrOfDeclareTargetVar</a>(</Highlight></CodeLine>
<Link id="l09476" /><CodeLine lineNumber="9476"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryKind</a> CaptureClause,</Highlight></CodeLine>
<Link id="l09477" /><CodeLine lineNumber="9477"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a2dc9d099b77ee3b8db3b00ad9273823d">OffloadEntriesInfoManager::OMPTargetDeviceClauseKind</a> DeviceClause,</Highlight></CodeLine>
<Link id="l09478" /><CodeLine lineNumber="9478"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsDeclaration, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsExternallyVisible,</Highlight></CodeLine>
<Link id="l09479" /><CodeLine lineNumber="9479"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> EntryInfo, <a href="/docs/api/classes/llvm/stringref">StringRef</a> MangledName,</Highlight></CodeLine>
<Link id="l09480" /><CodeLine lineNumber="9480"><Highlight kind="normal">    std::vector&lt;GlobalVariable &#42;&gt; &amp;GeneratedRefs, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> OpenMPSIMD,</Highlight></CodeLine>
<Link id="l09481" /><CodeLine lineNumber="9481"><Highlight kind="normal">    std::vector&lt;Triple&gt; TargetTriple, <a href="/docs/api/classes/llvm/type">Type</a> &#42;LlvmPtrTy,</Highlight></CodeLine>
<Link id="l09482" /><CodeLine lineNumber="9482"><Highlight kind="normal">    std::function&lt;<a href="/docs/api/classes/llvm/constant">Constant</a> &#42;()&gt; GlobalInitializer,</Highlight></CodeLine>
<Link id="l09483" /><CodeLine lineNumber="9483"><Highlight kind="normal">    std::function&lt;<a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57c">GlobalValue::LinkageTypes</a>()&gt; VariableLinkage) &#123;</Highlight></CodeLine>
<Link id="l09484" /><CodeLine lineNumber="9484"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: convert this to utilise the IRBuilder Config rather than</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09485" /><CodeLine lineNumber="9485"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// a passed down argument.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09486" /><CodeLine lineNumber="9486"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OpenMPSIMD)</Highlight></CodeLine>
<Link id="l09487" /><CodeLine lineNumber="9487"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09488" /><CodeLine lineNumber="9488"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09489" /><CodeLine lineNumber="9489"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CaptureClause == <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534abe3a7916fb5f7a79d6aea6c0356e71a6">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryLink</a> ||</Highlight></CodeLine>
<Link id="l09490" /><CodeLine lineNumber="9490"><Highlight kind="normal">      ((CaptureClause == <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534acf96797e65a60ff4302eb2bbdbbd8880">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryTo</a> ||</Highlight></CodeLine>
<Link id="l09491" /><CodeLine lineNumber="9491"><Highlight kind="normal">        CaptureClause ==</Highlight></CodeLine>
<Link id="l09492" /><CodeLine lineNumber="9492"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534a1b9b415348a31bfeaa94e778e0421ddf">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryEnter</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l09493" /><CodeLine lineNumber="9493"><Highlight kind="normal">       Config.hasRequiresUnifiedSharedMemory())) &#123;</Highlight></CodeLine>
<Link id="l09494" /><CodeLine lineNumber="9494"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallstring">SmallString&lt;64&gt;</a> PtrName;</Highlight></CodeLine>
<Link id="l09495" /><CodeLine lineNumber="9495"><Highlight kind="normal">    &#123;</Highlight></CodeLine>
<Link id="l09496" /><CodeLine lineNumber="9496"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/raw-svector-ostream">raw&#95;svector&#95;ostream</a> OS(PtrName);</Highlight></CodeLine>
<Link id="l09497" /><CodeLine lineNumber="9497"><Highlight kind="normal">      OS &lt;&lt; MangledName;</Highlight></CodeLine>
<Link id="l09498" /><CodeLine lineNumber="9498"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsExternallyVisible)</Highlight></CodeLine>
<Link id="l09499" /><CodeLine lineNumber="9499"><Highlight kind="normal">        OS &lt;&lt; <a href="/docs/api/namespaces/llvm/#a939bc2108d47080767f0c06ba56caec7">format</a>(</Highlight><Highlight kind="stringliteral">&quot;&#95;%x&quot;</Highlight><Highlight kind="normal">, EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a80293a526ecd17ee44ce5b982dff1ca1">FileID</a>);</Highlight></CodeLine>
<Link id="l09500" /><CodeLine lineNumber="9500"><Highlight kind="normal">      OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;&#95;decl&#95;tgt&#95;ref&#95;ptr&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09501" /><CodeLine lineNumber="9501"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09502" /><CodeLine lineNumber="9502"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09503" /><CodeLine lineNumber="9503"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = M.getNamedValue(PtrName);</Highlight></CodeLine>
<Link id="l09504" /><CodeLine lineNumber="9504"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09505" /><CodeLine lineNumber="9505"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>) &#123;</Highlight></CodeLine>
<Link id="l09506" /><CodeLine lineNumber="9506"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;<a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> = M.getNamedValue(MangledName);</Highlight></CodeLine>
<Link id="l09507" /><CodeLine lineNumber="9507"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a> = <a href="/docs/api/classes/llvm/openmpirbuilder/#aa5ef00e5a7487cc6c5bfed0f301fa1cc">getOrCreateInternalVariable</a>(LlvmPtrTy, PtrName);</Highlight></CodeLine>
<Link id="l09508" /><CodeLine lineNumber="9508"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09509" /><CodeLine lineNumber="9509"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/structs/llvm/omp/gv">GV</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;GlobalVariable&gt;</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</Highlight></CodeLine>
<Link id="l09510" /><CodeLine lineNumber="9510"><Highlight kind="normal">      <a href="/docs/api/structs/llvm/omp/gv">GV</a>-&gt;setLinkage(<a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f">GlobalValue::WeakAnyLinkage</a>);</Highlight></CodeLine>
<Link id="l09511" /><CodeLine lineNumber="9511"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09512" /><CodeLine lineNumber="9512"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l09513" /><CodeLine lineNumber="9513"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (GlobalInitializer)</Highlight></CodeLine>
<Link id="l09514" /><CodeLine lineNumber="9514"><Highlight kind="normal">          <a href="/docs/api/structs/llvm/omp/gv">GV</a>-&gt;setInitializer(GlobalInitializer());</Highlight></CodeLine>
<Link id="l09515" /><CodeLine lineNumber="9515"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09516" /><CodeLine lineNumber="9516"><Highlight kind="normal">          <a href="/docs/api/structs/llvm/omp/gv">GV</a>-&gt;setInitializer(<a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a>);</Highlight></CodeLine>
<Link id="l09517" /><CodeLine lineNumber="9517"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l09518" /><CodeLine lineNumber="9518"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09519" /><CodeLine lineNumber="9519"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/openmpirbuilder/#ae327be8503a76bd4dccfff4713a38553">registerTargetGlobalVariable</a>(</Highlight></CodeLine>
<Link id="l09520" /><CodeLine lineNumber="9520"><Highlight kind="normal">          CaptureClause, DeviceClause, IsDeclaration, IsExternallyVisible,</Highlight></CodeLine>
<Link id="l09521" /><CodeLine lineNumber="9521"><Highlight kind="normal">          EntryInfo, MangledName, GeneratedRefs, OpenMPSIMD, TargetTriple,</Highlight></CodeLine>
<Link id="l09522" /><CodeLine lineNumber="9522"><Highlight kind="normal">          GlobalInitializer, VariableLinkage, LlvmPtrTy, <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Constant&gt;</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>));</Highlight></CodeLine>
<Link id="l09523" /><CodeLine lineNumber="9523"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09524" /><CodeLine lineNumber="9524"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09525" /><CodeLine lineNumber="9525"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Constant&gt;</a>(<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a11dbf501abf829b3ab7049c2d3a8a053">Ptr</a>);</Highlight></CodeLine>
<Link id="l09526" /><CodeLine lineNumber="9526"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09527" /><CodeLine lineNumber="9527"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09528" /><CodeLine lineNumber="9528"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09529" /><CodeLine lineNumber="9529"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09530" /><CodeLine lineNumber="9530"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09531" /><CodeLine lineNumber="9531" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ae327be8503a76bd4dccfff4713a38553"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#ae327be8503a76bd4dccfff4713a38553">OpenMPIRBuilder::registerTargetGlobalVariable</a>(</Highlight></CodeLine>
<Link id="l09532" /><CodeLine lineNumber="9532"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryKind</a> CaptureClause,</Highlight></CodeLine>
<Link id="l09533" /><CodeLine lineNumber="9533"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a2dc9d099b77ee3b8db3b00ad9273823d">OffloadEntriesInfoManager::OMPTargetDeviceClauseKind</a> DeviceClause,</Highlight></CodeLine>
<Link id="l09534" /><CodeLine lineNumber="9534"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsDeclaration, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsExternallyVisible,</Highlight></CodeLine>
<Link id="l09535" /><CodeLine lineNumber="9535"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> EntryInfo, <a href="/docs/api/classes/llvm/stringref">StringRef</a> MangledName,</Highlight></CodeLine>
<Link id="l09536" /><CodeLine lineNumber="9536"><Highlight kind="normal">    std::vector&lt;GlobalVariable &#42;&gt; &amp;GeneratedRefs, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> OpenMPSIMD,</Highlight></CodeLine>
<Link id="l09537" /><CodeLine lineNumber="9537"><Highlight kind="normal">    std::vector&lt;Triple&gt; TargetTriple,</Highlight></CodeLine>
<Link id="l09538" /><CodeLine lineNumber="9538"><Highlight kind="normal">    std::function&lt;<a href="/docs/api/classes/llvm/constant">Constant</a> &#42;()&gt; GlobalInitializer,</Highlight></CodeLine>
<Link id="l09539" /><CodeLine lineNumber="9539"><Highlight kind="normal">    std::function&lt;<a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57c">GlobalValue::LinkageTypes</a>()&gt; VariableLinkage, <a href="/docs/api/classes/llvm/type">Type</a> &#42;LlvmPtrTy,</Highlight></CodeLine>
<Link id="l09540" /><CodeLine lineNumber="9540"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;Addr) &#123;</Highlight></CodeLine>
<Link id="l09541" /><CodeLine lineNumber="9541"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DeviceClause != <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a2dc9d099b77ee3b8db3b00ad9273823da168f6569c38da7979aa5e36d0a21b871">OffloadEntriesInfoManager::OMPTargetDeviceClauseAny</a> ||</Highlight></CodeLine>
<Link id="l09542" /><CodeLine lineNumber="9542"><Highlight kind="normal">      (TargetTriple.empty() &amp;&amp; !Config.isTargetDevice()))</Highlight></CodeLine>
<Link id="l09543" /><CodeLine lineNumber="9543"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09544" /><CodeLine lineNumber="9544"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09545" /><CodeLine lineNumber="9545"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryKind</a> Flags;</Highlight></CodeLine>
<Link id="l09546" /><CodeLine lineNumber="9546"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/stringref">StringRef</a> VarName;</Highlight></CodeLine>
<Link id="l09547" /><CodeLine lineNumber="9547"><Highlight kind="normal">  int64&#95;t VarSize;</Highlight></CodeLine>
<Link id="l09548" /><CodeLine lineNumber="9548"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57c">GlobalValue::LinkageTypes</a> Linkage;</Highlight></CodeLine>
<Link id="l09549" /><CodeLine lineNumber="9549"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09550" /><CodeLine lineNumber="9550"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((CaptureClause == <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534acf96797e65a60ff4302eb2bbdbbd8880">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryTo</a> ||</Highlight></CodeLine>
<Link id="l09551" /><CodeLine lineNumber="9551"><Highlight kind="normal">       CaptureClause ==</Highlight></CodeLine>
<Link id="l09552" /><CodeLine lineNumber="9552"><Highlight kind="normal">           <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534a1b9b415348a31bfeaa94e778e0421ddf">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryEnter</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l09553" /><CodeLine lineNumber="9553"><Highlight kind="normal">      !Config.hasRequiresUnifiedSharedMemory()) &#123;</Highlight></CodeLine>
<Link id="l09554" /><CodeLine lineNumber="9554"><Highlight kind="normal">    Flags = <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534acf96797e65a60ff4302eb2bbdbbd8880">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryTo</a>;</Highlight></CodeLine>
<Link id="l09555" /><CodeLine lineNumber="9555"><Highlight kind="normal">    VarName = MangledName;</Highlight></CodeLine>
<Link id="l09556" /><CodeLine lineNumber="9556"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;LlvmVal = M.getNamedValue(VarName);</Highlight></CodeLine>
<Link id="l09557" /><CodeLine lineNumber="9557"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09558" /><CodeLine lineNumber="9558"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsDeclaration)</Highlight></CodeLine>
<Link id="l09559" /><CodeLine lineNumber="9559"><Highlight kind="normal">      VarSize = <a href="/docs/api/namespaces/llvm/#a9dda4472ee0b7ea92ab49eedf6e13d50">divideCeil</a>(</Highlight></CodeLine>
<Link id="l09560" /><CodeLine lineNumber="9560"><Highlight kind="normal">          M.getDataLayout().getTypeSizeInBits(LlvmVal-&gt;<a href="/docs/api/classes/llvm/globalvalue/#af1dd2acfc2950742e41a64a342b15c80">getValueType</a>()), 8);</Highlight></CodeLine>
<Link id="l09561" /><CodeLine lineNumber="9561"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09562" /><CodeLine lineNumber="9562"><Highlight kind="normal">      VarSize = 0;</Highlight></CodeLine>
<Link id="l09563" /><CodeLine lineNumber="9563"><Highlight kind="normal">    Linkage = (VariableLinkage) ? VariableLinkage() : LlvmVal-&gt;<a href="/docs/api/classes/llvm/globalvalue/#a3547d58a060ee2e4a29cbea85bef91af">getLinkage</a>();</Highlight></CodeLine>
<Link id="l09564" /><CodeLine lineNumber="9564"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09565" /><CodeLine lineNumber="9565"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This is a workaround carried over from Clang which prevents undesired</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09566" /><CodeLine lineNumber="9566"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// optimisation of internal variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09567" /><CodeLine lineNumber="9567"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice() &amp;&amp;</Highlight></CodeLine>
<Link id="l09568" /><CodeLine lineNumber="9568"><Highlight kind="normal">        (!IsExternallyVisible || Linkage == <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57caf2b592edf18170e7aff4e8f3bae3360c">GlobalValue::LinkOnceODRLinkage</a>)) &#123;</Highlight></CodeLine>
<Link id="l09569" /><CodeLine lineNumber="9569"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Do not create a &quot;ref-variable&quot; if the original is not also available</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09570" /><CodeLine lineNumber="9570"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// on the host.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09571" /><CodeLine lineNumber="9571"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!OffloadInfoManager.hasDeviceGlobalVarEntryInfo(VarName))</Highlight></CodeLine>
<Link id="l09572" /><CodeLine lineNumber="9572"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09573" /><CodeLine lineNumber="9573"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09574" /><CodeLine lineNumber="9574"><Highlight kind="normal">      std::string RefName = <a href="/docs/api/classes/llvm/openmpirbuilder/#a488c861f8a68e5f78ceca8b57acd8be5">createPlatformSpecificName</a>(&#123;VarName, </Highlight><Highlight kind="stringliteral">&quot;ref&quot;</Highlight><Highlight kind="normal">&#125;);</Highlight></CodeLine>
<Link id="l09575" /><CodeLine lineNumber="9575"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09576" /><CodeLine lineNumber="9576"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!M.getNamedValue(RefName)) &#123;</Highlight></CodeLine>
<Link id="l09577" /><CodeLine lineNumber="9577"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;AddrRef =</Highlight></CodeLine>
<Link id="l09578" /><CodeLine lineNumber="9578"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/openmpirbuilder/#aa5ef00e5a7487cc6c5bfed0f301fa1cc">getOrCreateInternalVariable</a>(Addr-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>(), RefName);</Highlight></CodeLine>
<Link id="l09579" /><CodeLine lineNumber="9579"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;GvAddrRef = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;GlobalVariable&gt;</a>(AddrRef);</Highlight></CodeLine>
<Link id="l09580" /><CodeLine lineNumber="9580"><Highlight kind="normal">        GvAddrRef-&gt;setConstant(</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09581" /><CodeLine lineNumber="9581"><Highlight kind="normal">        GvAddrRef-&gt;setLinkage(<a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca1511edd03e02d1f3dd277a3c6abf6ad5">GlobalValue::InternalLinkage</a>);</Highlight></CodeLine>
<Link id="l09582" /><CodeLine lineNumber="9582"><Highlight kind="normal">        GvAddrRef-&gt;setInitializer(Addr);</Highlight></CodeLine>
<Link id="l09583" /><CodeLine lineNumber="9583"><Highlight kind="normal">        GeneratedRefs.push&#95;back(GvAddrRef);</Highlight></CodeLine>
<Link id="l09584" /><CodeLine lineNumber="9584"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l09585" /><CodeLine lineNumber="9585"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09586" /><CodeLine lineNumber="9586"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l09587" /><CodeLine lineNumber="9587"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CaptureClause == <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534abe3a7916fb5f7a79d6aea6c0356e71a6">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryLink</a>)</Highlight></CodeLine>
<Link id="l09588" /><CodeLine lineNumber="9588"><Highlight kind="normal">      Flags = <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534abe3a7916fb5f7a79d6aea6c0356e71a6">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryLink</a>;</Highlight></CodeLine>
<Link id="l09589" /><CodeLine lineNumber="9589"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09590" /><CodeLine lineNumber="9590"><Highlight kind="normal">      Flags = <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534acf96797e65a60ff4302eb2bbdbbd8880">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryTo</a>;</Highlight></CodeLine>
<Link id="l09591" /><CodeLine lineNumber="9591"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09592" /><CodeLine lineNumber="9592"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l09593" /><CodeLine lineNumber="9593"><Highlight kind="normal">      VarName = (Addr) ? Addr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09594" /><CodeLine lineNumber="9594"><Highlight kind="normal">      Addr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09595" /><CodeLine lineNumber="9595"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l09596" /><CodeLine lineNumber="9596"><Highlight kind="normal">      Addr = <a href="/docs/api/classes/llvm/openmpirbuilder/#afdc1b8675a946ce055c64607ba75af3a">getAddrOfDeclareTargetVar</a>(</Highlight></CodeLine>
<Link id="l09597" /><CodeLine lineNumber="9597"><Highlight kind="normal">          CaptureClause, DeviceClause, IsDeclaration, IsExternallyVisible,</Highlight></CodeLine>
<Link id="l09598" /><CodeLine lineNumber="9598"><Highlight kind="normal">          EntryInfo, MangledName, GeneratedRefs, OpenMPSIMD, TargetTriple,</Highlight></CodeLine>
<Link id="l09599" /><CodeLine lineNumber="9599"><Highlight kind="normal">          LlvmPtrTy, GlobalInitializer, VariableLinkage);</Highlight></CodeLine>
<Link id="l09600" /><CodeLine lineNumber="9600"><Highlight kind="normal">      VarName = (Addr) ? Addr-&gt;<a href="/docs/api/classes/llvm/value/#adb5c319f5905c1d3ca9eb5df546388c5">getName</a>() : </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09601" /><CodeLine lineNumber="9601"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09602" /><CodeLine lineNumber="9602"><Highlight kind="normal">    VarSize = M.getDataLayout().getPointerSize();</Highlight></CodeLine>
<Link id="l09603" /><CodeLine lineNumber="9603"><Highlight kind="normal">    Linkage = <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57ca8d13a9bcecfac72febceb1103afa048f">GlobalValue::WeakAnyLinkage</a>;</Highlight></CodeLine>
<Link id="l09604" /><CodeLine lineNumber="9604"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09605" /><CodeLine lineNumber="9605"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09606" /><CodeLine lineNumber="9606"><Highlight kind="normal">  OffloadInfoManager.registerDeviceGlobalVarEntryInfo(VarName, Addr, VarSize,</Highlight></CodeLine>
<Link id="l09607" /><CodeLine lineNumber="9607"><Highlight kind="normal">                                                      Flags, Linkage);</Highlight></CodeLine>
<Link id="l09608" /><CodeLine lineNumber="9608"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09609" /><CodeLine lineNumber="9609"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l09610" /><CodeLine lineNumber="9610"><Highlight kind="comment">/// Loads all the offload entries information from the host IR</Highlight></CodeLine>
<Link id="l09611" /><CodeLine lineNumber="9611"><Highlight kind="comment">/// metadata.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09612" /><CodeLine lineNumber="9612" lineLink="/docs/api/classes/llvm/openmpirbuilder/#a2242b144e54fa6203dae5c5b27fff17c"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a2242b144e54fa6203dae5c5b27fff17c">OpenMPIRBuilder::loadOffloadInfoMetadata</a>(<a href="/docs/api/classes/llvm/module">Module</a> &amp;M) &#123;</Highlight></CodeLine>
<Link id="l09613" /><CodeLine lineNumber="9613"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we are in target mode, load the metadata from the host IR. This code has</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09614" /><CodeLine lineNumber="9614"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to match the metadata creation in createOffloadEntriesAndInfoMetadata().</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09615" /><CodeLine lineNumber="9615"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09616" /><CodeLine lineNumber="9616"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/namedmdnode">NamedMDNode</a> &#42;MD = M.getNamedMetadata(<a href="/docs/api/classes/llvm/openmpirbuilder/#aefadc356da16598ff8c210dafbf4a2b7">ompOffloadInfoName</a>);</Highlight></CodeLine>
<Link id="l09617" /><CodeLine lineNumber="9617"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!MD)</Highlight></CodeLine>
<Link id="l09618" /><CodeLine lineNumber="9618"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09619" /><CodeLine lineNumber="9619"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09620" /><CodeLine lineNumber="9620"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/mdnode">MDNode</a> &#42;MN : MD-&gt;<a href="/docs/api/classes/llvm/namedmdnode/#adc55e223d70c06a924fd5cb248052d9d">operands</a>()) &#123;</Highlight></CodeLine>
<Link id="l09621" /><CodeLine lineNumber="9621"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;GetMDInt = &#91;MN&#93;(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Idx) &#123;</Highlight></CodeLine>
<Link id="l09622" /><CodeLine lineNumber="9622"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;V = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ConstantAsMetadata&gt;</a>(MN-&gt;getOperand(Idx));</Highlight></CodeLine>
<Link id="l09623" /><CodeLine lineNumber="9623"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ConstantInt&gt;</a>(V-&gt;getValue())-&gt;getZExtValue();</Highlight></CodeLine>
<Link id="l09624" /><CodeLine lineNumber="9624"><Highlight kind="normal">    &#125;;</Highlight></CodeLine>
<Link id="l09625" /><CodeLine lineNumber="9625"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09626" /><CodeLine lineNumber="9626"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;&amp;GetMDString = &#91;MN&#93;(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Idx) &#123;</Highlight></CodeLine>
<Link id="l09627" /><CodeLine lineNumber="9627"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;V = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;MDString&gt;</a>(MN-&gt;getOperand(Idx));</Highlight></CodeLine>
<Link id="l09628" /><CodeLine lineNumber="9628"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> V-&gt;getString();</Highlight></CodeLine>
<Link id="l09629" /><CodeLine lineNumber="9629"><Highlight kind="normal">    &#125;;</Highlight></CodeLine>
<Link id="l09630" /><CodeLine lineNumber="9630"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09631" /><CodeLine lineNumber="9631"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (GetMDInt(0)) &#123;</Highlight></CodeLine>
<Link id="l09632" /><CodeLine lineNumber="9632"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l09633" /><CodeLine lineNumber="9633"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unexpected metadata!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09634" /><CodeLine lineNumber="9634"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09635" /><CodeLine lineNumber="9635"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OffloadEntriesInfoManager::OffloadEntryInfo::</Highlight></CodeLine>
<Link id="l09636" /><CodeLine lineNumber="9636"><Highlight kind="normal">        OffloadingEntryInfoTargetRegion: &#123;</Highlight></CodeLine>
<Link id="l09637" /><CodeLine lineNumber="9637"><Highlight kind="normal">      <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> EntryInfo(</Highlight><Highlight kind="comment">/&#42;ParentName=&#42;/</Highlight><Highlight kind="normal">GetMDString(3),</Highlight></CodeLine>
<Link id="l09638" /><CodeLine lineNumber="9638"><Highlight kind="normal">                                      </Highlight><Highlight kind="comment">/&#42;DeviceID=&#42;/</Highlight><Highlight kind="normal">GetMDInt(1),</Highlight></CodeLine>
<Link id="l09639" /><CodeLine lineNumber="9639"><Highlight kind="normal">                                      </Highlight><Highlight kind="comment">/&#42;FileID=&#42;/</Highlight><Highlight kind="normal">GetMDInt(2),</Highlight></CodeLine>
<Link id="l09640" /><CodeLine lineNumber="9640"><Highlight kind="normal">                                      </Highlight><Highlight kind="comment">/&#42;Line=&#42;/</Highlight><Highlight kind="normal">GetMDInt(4),</Highlight></CodeLine>
<Link id="l09641" /><CodeLine lineNumber="9641"><Highlight kind="normal">                                      </Highlight><Highlight kind="comment">/&#42;Count=&#42;/</Highlight><Highlight kind="normal">GetMDInt(5));</Highlight></CodeLine>
<Link id="l09642" /><CodeLine lineNumber="9642"><Highlight kind="normal">      OffloadInfoManager.initializeTargetRegionEntryInfo(EntryInfo,</Highlight></CodeLine>
<Link id="l09643" /><CodeLine lineNumber="9643"><Highlight kind="normal">                                                         </Highlight><Highlight kind="comment">/&#42;Order=&#42;/</Highlight><Highlight kind="normal">GetMDInt(6));</Highlight></CodeLine>
<Link id="l09644" /><CodeLine lineNumber="9644"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09645" /><CodeLine lineNumber="9645"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09646" /><CodeLine lineNumber="9646"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> OffloadEntriesInfoManager::OffloadEntryInfo::</Highlight></CodeLine>
<Link id="l09647" /><CodeLine lineNumber="9647"><Highlight kind="normal">        OffloadingEntryInfoDeviceGlobalVar:</Highlight></CodeLine>
<Link id="l09648" /><CodeLine lineNumber="9648"><Highlight kind="normal">      OffloadInfoManager.initializeDeviceGlobalVarEntryInfo(</Highlight></CodeLine>
<Link id="l09649" /><CodeLine lineNumber="9649"><Highlight kind="normal">          </Highlight><Highlight kind="comment">/&#42;MangledName=&#42;/</Highlight><Highlight kind="normal">GetMDString(1),</Highlight></CodeLine>
<Link id="l09650" /><CodeLine lineNumber="9650"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryKind</a></Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight></CodeLine>
<Link id="l09651" /><CodeLine lineNumber="9651"><Highlight kind="normal">              </Highlight><Highlight kind="comment">/&#42;Flags=&#42;/</Highlight><Highlight kind="normal">GetMDInt(2)),</Highlight></CodeLine>
<Link id="l09652" /><CodeLine lineNumber="9652"><Highlight kind="normal">          </Highlight><Highlight kind="comment">/&#42;Order=&#42;/</Highlight><Highlight kind="normal">GetMDInt(3));</Highlight></CodeLine>
<Link id="l09653" /><CodeLine lineNumber="9653"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09654" /><CodeLine lineNumber="9654"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09655" /><CodeLine lineNumber="9655"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09656" /><CodeLine lineNumber="9656"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09657" /><CodeLine lineNumber="9657"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09658" /><CodeLine lineNumber="9658" lineLink="/docs/api/classes/llvm/openmpirbuilder/#ac6293b7ea84a4deac85481dd10dad437"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/openmpirbuilder/#a2242b144e54fa6203dae5c5b27fff17c">OpenMPIRBuilder::loadOffloadInfoMetadata</a>(<a href="/docs/api/classes/llvm/stringref">StringRef</a> HostFilePath) &#123;</Highlight></CodeLine>
<Link id="l09659" /><CodeLine lineNumber="9659"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HostFilePath.<a href="/docs/api/classes/llvm/stringref/#a2dc80c585ad5882da8cae7b5968f7e74">empty</a>())</Highlight></CodeLine>
<Link id="l09660" /><CodeLine lineNumber="9660"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09661" /><CodeLine lineNumber="9661"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09662" /><CodeLine lineNumber="9662"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Buf = <a href="/docs/api/classes/llvm/memorybuffer/#aa98611beefe78f907beeee7305cc8174">MemoryBuffer::getFile</a>(HostFilePath);</Highlight></CodeLine>
<Link id="l09663" /><CodeLine lineNumber="9663"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (std::error&#95;code Err = Buf.getError()) &#123;</Highlight></CodeLine>
<Link id="l09664" /><CodeLine lineNumber="9664"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a7f2a3d4dcfee70225988aec53ff1e173">report&#95;fatal&#95;error</a>((</Highlight><Highlight kind="stringliteral">&quot;error opening host file from host file path inside of &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09665" /><CodeLine lineNumber="9665"><Highlight kind="normal">                        </Highlight><Highlight kind="stringliteral">&quot;OpenMPIRBuilder: &quot;</Highlight><Highlight kind="normal"> +</Highlight></CodeLine>
<Link id="l09666" /><CodeLine lineNumber="9666"><Highlight kind="normal">                        Err.message())</Highlight></CodeLine>
<Link id="l09667" /><CodeLine lineNumber="9667"><Highlight kind="normal">                           .c&#95;str());</Highlight></CodeLine>
<Link id="l09668" /><CodeLine lineNumber="9668"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09669" /><CodeLine lineNumber="9669"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09670" /><CodeLine lineNumber="9670"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> Ctx;</Highlight></CodeLine>
<Link id="l09671" /><CodeLine lineNumber="9671"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> M = <a href="/docs/api/namespaces/llvm/#a4891d521956b735baba56d4dc193f5cd">expectedToErrorOrAndEmitErrors</a>(</Highlight></CodeLine>
<Link id="l09672" /><CodeLine lineNumber="9672"><Highlight kind="normal">      Ctx, <a href="/docs/api/namespaces/llvm/#a170525c5f5e06bd2555d40a0499b8b6d">parseBitcodeFile</a>(Buf.get()-&gt;getMemBufferRef(), Ctx));</Highlight></CodeLine>
<Link id="l09673" /><CodeLine lineNumber="9673"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (std::error&#95;code Err = M.getError()) &#123;</Highlight></CodeLine>
<Link id="l09674" /><CodeLine lineNumber="9674"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a7f2a3d4dcfee70225988aec53ff1e173">report&#95;fatal&#95;error</a>(</Highlight></CodeLine>
<Link id="l09675" /><CodeLine lineNumber="9675"><Highlight kind="normal">        (</Highlight><Highlight kind="stringliteral">&quot;error parsing host file inside of OpenMPIRBuilder: &quot;</Highlight><Highlight kind="normal"> + Err.message())</Highlight></CodeLine>
<Link id="l09676" /><CodeLine lineNumber="9676"><Highlight kind="normal">            .c&#95;str());</Highlight></CodeLine>
<Link id="l09677" /><CodeLine lineNumber="9677"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09678" /><CodeLine lineNumber="9678"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09679" /><CodeLine lineNumber="9679"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/openmpirbuilder/#a2242b144e54fa6203dae5c5b27fff17c">loadOffloadInfoMetadata</a>(&#42;M.get());</Highlight></CodeLine>
<Link id="l09680" /><CodeLine lineNumber="9680"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09681" /><CodeLine lineNumber="9681"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09682" /><CodeLine lineNumber="9682"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09683" /><CodeLine lineNumber="9683"><Highlight kind="normal"></Highlight><Highlight kind="comment">// OffloadEntriesInfoManager</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09684" /><CodeLine lineNumber="9684"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09685" /><CodeLine lineNumber="9685"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09686" /><CodeLine lineNumber="9686" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#af1c69166900a3ea831da7b0bda28554e"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#af1c69166900a3ea831da7b0bda28554e">OffloadEntriesInfoManager::empty</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l09687" /><CodeLine lineNumber="9687"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OffloadEntriesTargetRegion.empty() &amp;&amp;</Highlight></CodeLine>
<Link id="l09688" /><CodeLine lineNumber="9688"><Highlight kind="normal">         OffloadEntriesDeviceGlobalVar.empty();</Highlight></CodeLine>
<Link id="l09689" /><CodeLine lineNumber="9689"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09690" /><CodeLine lineNumber="9690"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09691" /><CodeLine lineNumber="9691"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> OffloadEntriesInfoManager::getTargetRegionEntryInfoCount(</Highlight></CodeLine>
<Link id="l09692" /><CodeLine lineNumber="9692"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp;EntryInfo)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l09693" /><CodeLine lineNumber="9693"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> It = OffloadEntriesTargetRegionCount.find(</Highlight></CodeLine>
<Link id="l09694" /><CodeLine lineNumber="9694"><Highlight kind="normal">      getTargetRegionEntryCountKey(EntryInfo));</Highlight></CodeLine>
<Link id="l09695" /><CodeLine lineNumber="9695"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (It == OffloadEntriesTargetRegionCount.end())</Highlight></CodeLine>
<Link id="l09696" /><CodeLine lineNumber="9696"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 0;</Highlight></CodeLine>
<Link id="l09697" /><CodeLine lineNumber="9697"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> It-&gt;second;</Highlight></CodeLine>
<Link id="l09698" /><CodeLine lineNumber="9698"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09699" /><CodeLine lineNumber="9699"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09700" /><CodeLine lineNumber="9700"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OffloadEntriesInfoManager::incrementTargetRegionEntryInfoCount(</Highlight></CodeLine>
<Link id="l09701" /><CodeLine lineNumber="9701"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp;EntryInfo) &#123;</Highlight></CodeLine>
<Link id="l09702" /><CodeLine lineNumber="9702"><Highlight kind="normal">  OffloadEntriesTargetRegionCount&#91;getTargetRegionEntryCountKey(EntryInfo)&#93; =</Highlight></CodeLine>
<Link id="l09703" /><CodeLine lineNumber="9703"><Highlight kind="normal">      EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a8cc8999b43ab73c1f7f8618f7735f3cd">Count</a> + 1;</Highlight></CodeLine>
<Link id="l09704" /><CodeLine lineNumber="9704"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09705" /><CodeLine lineNumber="9705"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l09706" /><CodeLine lineNumber="9706"><Highlight kind="comment">/// Initialize target region entry.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09707" /><CodeLine lineNumber="9707" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#ab05d360f14a80b1fc10d1632aa0f1433"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab05d360f14a80b1fc10d1632aa0f1433">OffloadEntriesInfoManager::initializeTargetRegionEntryInfo</a>(</Highlight></CodeLine>
<Link id="l09708" /><CodeLine lineNumber="9708"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> &amp;EntryInfo, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Order) &#123;</Highlight></CodeLine>
<Link id="l09709" /><CodeLine lineNumber="9709"><Highlight kind="normal">  OffloadEntriesTargetRegion&#91;EntryInfo&#93; =</Highlight></CodeLine>
<Link id="l09710" /><CodeLine lineNumber="9710"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/offloadentriesinfomanager/offloadentryinfotargetregion">OffloadEntryInfoTargetRegion</a>(Order, </Highlight><Highlight kind="comment">/&#42;Addr=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;ID=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l09711" /><CodeLine lineNumber="9711"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a4e85049eada7d6cc3bedde1433ce4a7ba1e2537a111117d2cebad779b6de1856b">OMPTargetRegionEntryTargetRegion</a>);</Highlight></CodeLine>
<Link id="l09712" /><CodeLine lineNumber="9712"><Highlight kind="normal">  ++OffloadingEntriesNum;</Highlight></CodeLine>
<Link id="l09713" /><CodeLine lineNumber="9713"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09714" /><CodeLine lineNumber="9714"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09715" /><CodeLine lineNumber="9715" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#a9736eb60d11b4a8d644d3e32346e7f56"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a9736eb60d11b4a8d644d3e32346e7f56">OffloadEntriesInfoManager::registerTargetRegionEntryInfo</a>(</Highlight></CodeLine>
<Link id="l09716" /><CodeLine lineNumber="9716"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> EntryInfo, <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;Addr, <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>,</Highlight></CodeLine>
<Link id="l09717" /><CodeLine lineNumber="9717"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a4e85049eada7d6cc3bedde1433ce4a7b">OMPTargetRegionEntryKind</a> Flags) &#123;</Highlight></CodeLine>
<Link id="l09718" /><CodeLine lineNumber="9718"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a8cc8999b43ab73c1f7f8618f7735f3cd">Count</a> == 0 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;expected default EntryInfo&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09719" /><CodeLine lineNumber="9719"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09720" /><CodeLine lineNumber="9720"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update the EntryInfo with the next available count for this location.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09721" /><CodeLine lineNumber="9721"><Highlight kind="normal">  EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a8cc8999b43ab73c1f7f8618f7735f3cd">Count</a> = getTargetRegionEntryInfoCount(EntryInfo);</Highlight></CodeLine>
<Link id="l09722" /><CodeLine lineNumber="9722"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09723" /><CodeLine lineNumber="9723"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we are emitting code for a target, the entry is already initialized,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09724" /><CodeLine lineNumber="9724"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// only has to be registered.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09725" /><CodeLine lineNumber="9725"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OMPBuilder-&gt;Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l09726" /><CodeLine lineNumber="9726"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This could happen if the device compilation is invoked standalone.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09727" /><CodeLine lineNumber="9727"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a8a88ec295fa5c83572df98cfaff271ed">hasTargetRegionEntryInfo</a>(EntryInfo)) &#123;</Highlight></CodeLine>
<Link id="l09728" /><CodeLine lineNumber="9728"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09729" /><CodeLine lineNumber="9729"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09730" /><CodeLine lineNumber="9730"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Entry = OffloadEntriesTargetRegion&#91;EntryInfo&#93;;</Highlight></CodeLine>
<Link id="l09731" /><CodeLine lineNumber="9731"><Highlight kind="normal">    Entry.setAddress(Addr);</Highlight></CodeLine>
<Link id="l09732" /><CodeLine lineNumber="9732"><Highlight kind="normal">    Entry.setID(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>);</Highlight></CodeLine>
<Link id="l09733" /><CodeLine lineNumber="9733"><Highlight kind="normal">    Entry.setFlags(Flags);</Highlight></CodeLine>
<Link id="l09734" /><CodeLine lineNumber="9734"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l09735" /><CodeLine lineNumber="9735"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Flags == <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a4e85049eada7d6cc3bedde1433ce4a7ba1e2537a111117d2cebad779b6de1856b">OffloadEntriesInfoManager::OMPTargetRegionEntryTargetRegion</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l09736" /><CodeLine lineNumber="9736"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a8a88ec295fa5c83572df98cfaff271ed">hasTargetRegionEntryInfo</a>(EntryInfo, </Highlight><Highlight kind="comment">/&#42;IgnoreAddressId&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">))</Highlight></CodeLine>
<Link id="l09737" /><CodeLine lineNumber="9737"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09738" /><CodeLine lineNumber="9738"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a8a88ec295fa5c83572df98cfaff271ed">hasTargetRegionEntryInfo</a>(EntryInfo) &amp;&amp;</Highlight></CodeLine>
<Link id="l09739" /><CodeLine lineNumber="9739"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Target region entry already registered!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09740" /><CodeLine lineNumber="9740"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/offloadentriesinfomanager/offloadentryinfotargetregion">OffloadEntryInfoTargetRegion</a> Entry(OffloadingEntriesNum, Addr, <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>, Flags);</Highlight></CodeLine>
<Link id="l09741" /><CodeLine lineNumber="9741"><Highlight kind="normal">    OffloadEntriesTargetRegion&#91;EntryInfo&#93; = Entry;</Highlight></CodeLine>
<Link id="l09742" /><CodeLine lineNumber="9742"><Highlight kind="normal">    ++OffloadingEntriesNum;</Highlight></CodeLine>
<Link id="l09743" /><CodeLine lineNumber="9743"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09744" /><CodeLine lineNumber="9744"><Highlight kind="normal">  incrementTargetRegionEntryInfoCount(EntryInfo);</Highlight></CodeLine>
<Link id="l09745" /><CodeLine lineNumber="9745"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09746" /><CodeLine lineNumber="9746"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09747" /><CodeLine lineNumber="9747" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#a8a88ec295fa5c83572df98cfaff271ed"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a8a88ec295fa5c83572df98cfaff271ed">OffloadEntriesInfoManager::hasTargetRegionEntryInfo</a>(</Highlight></CodeLine>
<Link id="l09748" /><CodeLine lineNumber="9748"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/targetregionentryinfo">TargetRegionEntryInfo</a> EntryInfo, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IgnoreAddressId)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l09749" /><CodeLine lineNumber="9749"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09750" /><CodeLine lineNumber="9750"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update the EntryInfo with the next available count for this location.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09751" /><CodeLine lineNumber="9751"><Highlight kind="normal">  EntryInfo.<a href="/docs/api/structs/llvm/targetregionentryinfo/#a8cc8999b43ab73c1f7f8618f7735f3cd">Count</a> = getTargetRegionEntryInfoCount(EntryInfo);</Highlight></CodeLine>
<Link id="l09752" /><CodeLine lineNumber="9752"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09753" /><CodeLine lineNumber="9753"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> It = OffloadEntriesTargetRegion.find(EntryInfo);</Highlight></CodeLine>
<Link id="l09754" /><CodeLine lineNumber="9754"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (It == OffloadEntriesTargetRegion.end()) &#123;</Highlight></CodeLine>
<Link id="l09755" /><CodeLine lineNumber="9755"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09756" /><CodeLine lineNumber="9756"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09757" /><CodeLine lineNumber="9757"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Fail if this entry is already registered.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09758" /><CodeLine lineNumber="9758"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IgnoreAddressId &amp;&amp; (It-&gt;second.getAddress() || It-&gt;second.getID()))</Highlight></CodeLine>
<Link id="l09759" /><CodeLine lineNumber="9759"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09760" /><CodeLine lineNumber="9760"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09761" /><CodeLine lineNumber="9761"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09762" /><CodeLine lineNumber="9762"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09763" /><CodeLine lineNumber="9763" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#aa87d491241b8ff7bdec84f22843c6ab5"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#aa87d491241b8ff7bdec84f22843c6ab5">OffloadEntriesInfoManager::actOnTargetRegionEntriesInfo</a>(</Highlight></CodeLine>
<Link id="l09764" /><CodeLine lineNumber="9764"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ac115d36d95b2d0b214799c15f2df8cbf">OffloadTargetRegionEntryInfoActTy</a> &amp;Action) &#123;</Highlight></CodeLine>
<Link id="l09765" /><CodeLine lineNumber="9765"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Scan all target region entries and perform the provided action.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09766" /><CodeLine lineNumber="9766"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;It : OffloadEntriesTargetRegion) &#123;</Highlight></CodeLine>
<Link id="l09767" /><CodeLine lineNumber="9767"><Highlight kind="normal">    Action(It.first, It.second);</Highlight></CodeLine>
<Link id="l09768" /><CodeLine lineNumber="9768"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09769" /><CodeLine lineNumber="9769"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09770" /><CodeLine lineNumber="9770"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09771" /><CodeLine lineNumber="9771" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#a4503192ffc49753d6b8ec734f2927742"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a4503192ffc49753d6b8ec734f2927742">OffloadEntriesInfoManager::initializeDeviceGlobalVarEntryInfo</a>(</Highlight></CodeLine>
<Link id="l09772" /><CodeLine lineNumber="9772"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/stringref">StringRef</a> Name, <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534">OMPTargetGlobalVarEntryKind</a> Flags, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> Order) &#123;</Highlight></CodeLine>
<Link id="l09773" /><CodeLine lineNumber="9773"><Highlight kind="normal">  OffloadEntriesDeviceGlobalVar.try&#95;emplace(Name, Order, Flags);</Highlight></CodeLine>
<Link id="l09774" /><CodeLine lineNumber="9774"><Highlight kind="normal">  ++OffloadingEntriesNum;</Highlight></CodeLine>
<Link id="l09775" /><CodeLine lineNumber="9775"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09776" /><CodeLine lineNumber="9776"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09777" /><CodeLine lineNumber="9777" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#a4229a8d4526cc8fc7d5e043727b07128"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a4229a8d4526cc8fc7d5e043727b07128">OffloadEntriesInfoManager::registerDeviceGlobalVarEntryInfo</a>(</Highlight></CodeLine>
<Link id="l09778" /><CodeLine lineNumber="9778"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/stringref">StringRef</a> VarName, <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;Addr, int64&#95;t VarSize,</Highlight></CodeLine>
<Link id="l09779" /><CodeLine lineNumber="9779"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534">OMPTargetGlobalVarEntryKind</a> Flags, <a href="/docs/api/classes/llvm/globalvalue/#aedfa75f0c85c4aa85b257f066fbea57c">GlobalValue::LinkageTypes</a> Linkage) &#123;</Highlight></CodeLine>
<Link id="l09780" /><CodeLine lineNumber="9780"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (OMPBuilder-&gt;Config.isTargetDevice()) &#123;</Highlight></CodeLine>
<Link id="l09781" /><CodeLine lineNumber="9781"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This could happen if the device compilation is invoked standalone.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09782" /><CodeLine lineNumber="9782"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/classes/llvm/offloadentriesinfomanager/#aca32e410f9038aada8d559cee9754d95">hasDeviceGlobalVarEntryInfo</a>(VarName))</Highlight></CodeLine>
<Link id="l09783" /><CodeLine lineNumber="9783"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09784" /><CodeLine lineNumber="9784"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Entry = OffloadEntriesDeviceGlobalVar&#91;VarName&#93;;</Highlight></CodeLine>
<Link id="l09785" /><CodeLine lineNumber="9785"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Entry.getAddress() &amp;&amp; <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#aca32e410f9038aada8d559cee9754d95">hasDeviceGlobalVarEntryInfo</a>(VarName)) &#123;</Highlight></CodeLine>
<Link id="l09786" /><CodeLine lineNumber="9786"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Entry.getVarSize() == 0) &#123;</Highlight></CodeLine>
<Link id="l09787" /><CodeLine lineNumber="9787"><Highlight kind="normal">        Entry.setVarSize(VarSize);</Highlight></CodeLine>
<Link id="l09788" /><CodeLine lineNumber="9788"><Highlight kind="normal">        Entry.setLinkage(Linkage);</Highlight></CodeLine>
<Link id="l09789" /><CodeLine lineNumber="9789"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l09790" /><CodeLine lineNumber="9790"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09791" /><CodeLine lineNumber="9791"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09792" /><CodeLine lineNumber="9792"><Highlight kind="normal">    Entry.setVarSize(VarSize);</Highlight></CodeLine>
<Link id="l09793" /><CodeLine lineNumber="9793"><Highlight kind="normal">    Entry.setLinkage(Linkage);</Highlight></CodeLine>
<Link id="l09794" /><CodeLine lineNumber="9794"><Highlight kind="normal">    Entry.setAddress(Addr);</Highlight></CodeLine>
<Link id="l09795" /><CodeLine lineNumber="9795"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l09796" /><CodeLine lineNumber="9796"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/offloadentriesinfomanager/#aca32e410f9038aada8d559cee9754d95">hasDeviceGlobalVarEntryInfo</a>(VarName)) &#123;</Highlight></CodeLine>
<Link id="l09797" /><CodeLine lineNumber="9797"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Entry = OffloadEntriesDeviceGlobalVar&#91;VarName&#93;;</Highlight></CodeLine>
<Link id="l09798" /><CodeLine lineNumber="9798"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Entry.isValid() &amp;&amp; Entry.getFlags() == Flags &amp;&amp;</Highlight></CodeLine>
<Link id="l09799" /><CodeLine lineNumber="9799"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Entry not initialized!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09800" /><CodeLine lineNumber="9800"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Entry.getVarSize() == 0) &#123;</Highlight></CodeLine>
<Link id="l09801" /><CodeLine lineNumber="9801"><Highlight kind="normal">        Entry.setVarSize(VarSize);</Highlight></CodeLine>
<Link id="l09802" /><CodeLine lineNumber="9802"><Highlight kind="normal">        Entry.setLinkage(Linkage);</Highlight></CodeLine>
<Link id="l09803" /><CodeLine lineNumber="9803"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l09804" /><CodeLine lineNumber="9804"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09805" /><CodeLine lineNumber="9805"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l09806" /><CodeLine lineNumber="9806"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Flags == <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#ab9575c71365de4083a7be6ef6572d534aba847264872ebbdaf660316167b89e15">OffloadEntriesInfoManager::OMPTargetGlobalVarEntryIndirect</a>)</Highlight></CodeLine>
<Link id="l09807" /><CodeLine lineNumber="9807"><Highlight kind="normal">      OffloadEntriesDeviceGlobalVar.try&#95;emplace(VarName, OffloadingEntriesNum,</Highlight></CodeLine>
<Link id="l09808" /><CodeLine lineNumber="9808"><Highlight kind="normal">                                                Addr, VarSize, Flags, Linkage,</Highlight></CodeLine>
<Link id="l09809" /><CodeLine lineNumber="9809"><Highlight kind="normal">                                                VarName.str());</Highlight></CodeLine>
<Link id="l09810" /><CodeLine lineNumber="9810"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09811" /><CodeLine lineNumber="9811"><Highlight kind="normal">      OffloadEntriesDeviceGlobalVar.try&#95;emplace(</Highlight></CodeLine>
<Link id="l09812" /><CodeLine lineNumber="9812"><Highlight kind="normal">          VarName, OffloadingEntriesNum, Addr, VarSize, Flags, Linkage, </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09813" /><CodeLine lineNumber="9813"><Highlight kind="normal">    ++OffloadingEntriesNum;</Highlight></CodeLine>
<Link id="l09814" /><CodeLine lineNumber="9814"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09815" /><CodeLine lineNumber="9815"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09816" /><CodeLine lineNumber="9816"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09817" /><CodeLine lineNumber="9817" lineLink="/docs/api/classes/llvm/offloadentriesinfomanager/#a453a107a33d0d865ed6e021fc6cdcc20"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a453a107a33d0d865ed6e021fc6cdcc20">OffloadEntriesInfoManager::actOnDeviceGlobalVarEntriesInfo</a>(</Highlight></CodeLine>
<Link id="l09818" /><CodeLine lineNumber="9818"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/offloadentriesinfomanager/#a0035f4c66082f93a65972a35db34f497">OffloadDeviceGlobalVarEntryInfoActTy</a> &amp;Action) &#123;</Highlight></CodeLine>
<Link id="l09819" /><CodeLine lineNumber="9819"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Scan all target region entries and perform the provided action.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09820" /><CodeLine lineNumber="9820"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;E : OffloadEntriesDeviceGlobalVar)</Highlight></CodeLine>
<Link id="l09821" /><CodeLine lineNumber="9821"><Highlight kind="normal">    Action(E.getKey(), E.getValue());</Highlight></CodeLine>
<Link id="l09822" /><CodeLine lineNumber="9822"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09823" /><CodeLine lineNumber="9823"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09824" /><CodeLine lineNumber="9824"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09825" /><CodeLine lineNumber="9825"><Highlight kind="normal"></Highlight><Highlight kind="comment">// CanonicalLoopInfo</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09826" /><CodeLine lineNumber="9826"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09827" /><CodeLine lineNumber="9827"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09828" /><CodeLine lineNumber="9828"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> CanonicalLoopInfo::collectControlBlocks(</Highlight></CodeLine>
<Link id="l09829" /><CodeLine lineNumber="9829"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;BasicBlock &#42;&gt;</a> &amp;BBs) &#123;</Highlight></CodeLine>
<Link id="l09830" /><CodeLine lineNumber="9830"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We only count those BBs as control block for which we do not need to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09831" /><CodeLine lineNumber="9831"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// reverse the CFG, i.e. not the loop body which can contain arbitrary control</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09832" /><CodeLine lineNumber="9832"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// flow. For consistency, this also means we do not add the Body block, which</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09833" /><CodeLine lineNumber="9833"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// is just the entry to the body code.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09834" /><CodeLine lineNumber="9834"><Highlight kind="normal">  BBs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(BBs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() + 6);</Highlight></CodeLine>
<Link id="l09835" /><CodeLine lineNumber="9835"><Highlight kind="normal">  BBs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(&#123;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>(), Header, <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, Latch, Exit, <a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>()&#125;);</Highlight></CodeLine>
<Link id="l09836" /><CodeLine lineNumber="9836"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09837" /><CodeLine lineNumber="9837"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09838" /><CodeLine lineNumber="9838" lineLink="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d"><Highlight kind="normal"><a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">CanonicalLoopInfo::getPreheader</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l09839" /><CodeLine lineNumber="9839"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/canonicalloopinfo/#a4b2b7074e300c251f7cb8913620b1d80">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Requires a valid canonical loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09840" /><CodeLine lineNumber="9840"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Pred : <a href="/docs/api/namespaces/llvm/#acb22fb04083152eee862457e42e8dc31">predecessors</a>(Header)) &#123;</Highlight></CodeLine>
<Link id="l09841" /><CodeLine lineNumber="9841"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Pred != Latch)</Highlight></CodeLine>
<Link id="l09842" /><CodeLine lineNumber="9842"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Pred;</Highlight></CodeLine>
<Link id="l09843" /><CodeLine lineNumber="9843"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09844" /><CodeLine lineNumber="9844"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Missing preheader&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09845" /><CodeLine lineNumber="9845"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09846" /><CodeLine lineNumber="9846"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09847" /><CodeLine lineNumber="9847"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> CanonicalLoopInfo::setTripCount(<a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount) &#123;</Highlight></CodeLine>
<Link id="l09848" /><CodeLine lineNumber="9848"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/canonicalloopinfo/#a4b2b7074e300c251f7cb8913620b1d80">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Requires a valid canonical loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09849" /><CodeLine lineNumber="9849"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09850" /><CodeLine lineNumber="9850"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;CmpI = &amp;<a href="/docs/api/classes/llvm/canonicalloopinfo/#acb5b5b136597312e0d5df6b746a7e6db">getCond</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a63cfb2a0dae69153fd961eb335949caa">front</a>();</Highlight></CodeLine>
<Link id="l09851" /><CodeLine lineNumber="9851"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CmpInst&gt;</a>(CmpI) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;First inst must compare IV with TripCount&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09852" /><CodeLine lineNumber="9852"><Highlight kind="normal">  CmpI-&gt;<a href="/docs/api/classes/llvm/user/#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, TripCount);</Highlight></CodeLine>
<Link id="l09853" /><CodeLine lineNumber="9853"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09854" /><CodeLine lineNumber="9854"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09855" /><CodeLine lineNumber="9855"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo/#a32ff799dcb39887a8d21322020f305ba">assertOK</a>();</Highlight></CodeLine>
<Link id="l09856" /><CodeLine lineNumber="9856"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09857" /><CodeLine lineNumber="9857"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09858" /><CodeLine lineNumber="9858"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09859" /><CodeLine lineNumber="9859"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> CanonicalLoopInfo::mapIndVar(</Highlight></CodeLine>
<Link id="l09860" /><CodeLine lineNumber="9860"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/function-ref">llvm::function&#95;ref</a>&lt;<a href="/docs/api/classes/llvm/value">Value</a> &#42;(<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;)&gt; Updater) &#123;</Highlight></CodeLine>
<Link id="l09861" /><CodeLine lineNumber="9861"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/canonicalloopinfo/#a4b2b7074e300c251f7cb8913620b1d80">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Requires a valid canonical loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09862" /><CodeLine lineNumber="9862"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09863" /><CodeLine lineNumber="9863"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;OldIV = <a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>();</Highlight></CodeLine>
<Link id="l09864" /><CodeLine lineNumber="9864"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09865" /><CodeLine lineNumber="9865"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Record all uses excluding those introduced by the updater. Uses by the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09866" /><CodeLine lineNumber="9866"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// CanonicalLoopInfo itself to keep track of the number of iterations are</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09867" /><CodeLine lineNumber="9867"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// excluded.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09868" /><CodeLine lineNumber="9868"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Use &#42;&gt;</a> ReplacableUses;</Highlight></CodeLine>
<Link id="l09869" /><CodeLine lineNumber="9869"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/use">Use</a> &amp;U : OldIV-&gt;<a href="/docs/api/classes/llvm/value/#abf855b7cd63a0cd7f73759e396f280c9">uses</a>()) &#123;</Highlight></CodeLine>
<Link id="l09870" /><CodeLine lineNumber="9870"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/classes/llvm/user">User</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(U.getUser());</Highlight></CodeLine>
<Link id="l09871" /><CodeLine lineNumber="9871"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/classes/llvm/user">User</a>)</Highlight></CodeLine>
<Link id="l09872" /><CodeLine lineNumber="9872"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09873" /><CodeLine lineNumber="9873"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/user">User</a>-&gt;getParent() == <a href="/docs/api/classes/llvm/canonicalloopinfo/#acb5b5b136597312e0d5df6b746a7e6db">getCond</a>())</Highlight></CodeLine>
<Link id="l09874" /><CodeLine lineNumber="9874"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09875" /><CodeLine lineNumber="9875"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/user">User</a>-&gt;getParent() == <a href="/docs/api/classes/llvm/canonicalloopinfo/#ac37a6cf77f6f82b6bb28af4d9c8626d0">getLatch</a>())</Highlight></CodeLine>
<Link id="l09876" /><CodeLine lineNumber="9876"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09877" /><CodeLine lineNumber="9877"><Highlight kind="normal">    ReplacableUses.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&amp;U);</Highlight></CodeLine>
<Link id="l09878" /><CodeLine lineNumber="9878"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l09879" /><CodeLine lineNumber="9879"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09880" /><CodeLine lineNumber="9880"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Run the updater that may introduce new uses</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09881" /><CodeLine lineNumber="9881"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> &#42;NewIV = Updater(OldIV);</Highlight></CodeLine>
<Link id="l09882" /><CodeLine lineNumber="9882"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09883" /><CodeLine lineNumber="9883"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Replace the old uses with the value returned by the updater.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09884" /><CodeLine lineNumber="9884"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (Use &#42;U : ReplacableUses)</Highlight></CodeLine>
<Link id="l09885" /><CodeLine lineNumber="9885"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>-&gt;set(NewIV);</Highlight></CodeLine>
<Link id="l09886" /><CodeLine lineNumber="9886"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09887" /><CodeLine lineNumber="9887"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09888" /><CodeLine lineNumber="9888"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/canonicalloopinfo/#a32ff799dcb39887a8d21322020f305ba">assertOK</a>();</Highlight></CodeLine>
<Link id="l09889" /><CodeLine lineNumber="9889"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09890" /><CodeLine lineNumber="9890"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09891" /><CodeLine lineNumber="9891"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09892" /><CodeLine lineNumber="9892" lineLink="/docs/api/classes/llvm/canonicalloopinfo/#a32ff799dcb39887a8d21322020f305ba"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/canonicalloopinfo/#a32ff799dcb39887a8d21322020f305ba">CanonicalLoopInfo::assertOK</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l09893" /><CodeLine lineNumber="9893"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09894" /><CodeLine lineNumber="9894"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// No constraints if this object currently does not describe a loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09895" /><CodeLine lineNumber="9895"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/classes/llvm/canonicalloopinfo/#a4b2b7074e300c251f7cb8913620b1d80">isValid</a>())</Highlight></CodeLine>
<Link id="l09896" /><CodeLine lineNumber="9896"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09897" /><CodeLine lineNumber="9897"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09898" /><CodeLine lineNumber="9898"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Preheader = <a href="/docs/api/classes/llvm/canonicalloopinfo/#ad50eb30e70ff2a9ea7f220547e2b6f6d">getPreheader</a>();</Highlight></CodeLine>
<Link id="l09899" /><CodeLine lineNumber="9899"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Body = <a href="/docs/api/classes/llvm/canonicalloopinfo/#a47521ec347ef7b522745bf89e2e2d19a">getBody</a>();</Highlight></CodeLine>
<Link id="l09900" /><CodeLine lineNumber="9900"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a> = <a href="/docs/api/classes/llvm/canonicalloopinfo/#a92d8bce979891dc43b6573e8cca2e58c">getAfter</a>();</Highlight></CodeLine>
<Link id="l09901" /><CodeLine lineNumber="9901"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09902" /><CodeLine lineNumber="9902"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Verify standard control-flow we use for OpenMP loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09903" /><CodeLine lineNumber="9903"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Preheader);</Highlight></CodeLine>
<Link id="l09904" /><CodeLine lineNumber="9904"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;BranchInst&gt;</a>(Preheader-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l09905" /><CodeLine lineNumber="9905"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Preheader must terminate with unconditional branch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09906" /><CodeLine lineNumber="9906"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Preheader-&gt;<a href="/docs/api/classes/llvm/basicblock/#a79c007dcf9fff57e1569e778d7885b5e">getSingleSuccessor</a>() == Header &amp;&amp;</Highlight></CodeLine>
<Link id="l09907" /><CodeLine lineNumber="9907"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Preheader must jump to header&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09908" /><CodeLine lineNumber="9908"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09909" /><CodeLine lineNumber="9909"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Header);</Highlight></CodeLine>
<Link id="l09910" /><CodeLine lineNumber="9910"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;BranchInst&gt;</a>(Header-&gt;getTerminator()) &amp;&amp;</Highlight></CodeLine>
<Link id="l09911" /><CodeLine lineNumber="9911"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Header must terminate with unconditional branch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09912" /><CodeLine lineNumber="9912"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Header-&gt;getSingleSuccessor() == Cond &amp;&amp;</Highlight></CodeLine>
<Link id="l09913" /><CodeLine lineNumber="9913"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Header must jump to exiting block&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09914" /><CodeLine lineNumber="9914"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09915" /><CodeLine lineNumber="9915"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Cond);</Highlight></CodeLine>
<Link id="l09916" /><CodeLine lineNumber="9916"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Cond-&gt;getSinglePredecessor() == Header &amp;&amp;</Highlight></CodeLine>
<Link id="l09917" /><CodeLine lineNumber="9917"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exiting block only reachable from header&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09918" /><CodeLine lineNumber="9918"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09919" /><CodeLine lineNumber="9919"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;BranchInst&gt;</a>(Cond-&gt;getTerminator()) &amp;&amp;</Highlight></CodeLine>
<Link id="l09920" /><CodeLine lineNumber="9920"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exiting block must terminate with conditional branch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09921" /><CodeLine lineNumber="9921"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmreflect-cpp/#ac934769d93af95250952646a3829df4c">size</a>(<a href="/docs/api/namespaces/llvm/#a26e2a938b431eaa6eca2beaa96410c9d">successors</a>(Cond)) == 2 &amp;&amp;</Highlight></CodeLine>
<Link id="l09922" /><CodeLine lineNumber="9922"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exiting block must have two successors&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09923" /><CodeLine lineNumber="9923"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BranchInst&gt;</a>(Cond-&gt;getTerminator())-&gt;getSuccessor(0) == Body &amp;&amp;</Highlight></CodeLine>
<Link id="l09924" /><CodeLine lineNumber="9924"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exiting block&#39;s first successor jump to the body&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09925" /><CodeLine lineNumber="9925"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BranchInst&gt;</a>(Cond-&gt;getTerminator())-&gt;getSuccessor(1) == Exit &amp;&amp;</Highlight></CodeLine>
<Link id="l09926" /><CodeLine lineNumber="9926"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exiting block&#39;s second successor must exit the loop&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09927" /><CodeLine lineNumber="9927"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09928" /><CodeLine lineNumber="9928"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Body);</Highlight></CodeLine>
<Link id="l09929" /><CodeLine lineNumber="9929"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Body-&gt;<a href="/docs/api/classes/llvm/basicblock/#a59fb91d1691350f7d1b8e8a114e3f2a4">getSinglePredecessor</a>() == Cond &amp;&amp;</Highlight></CodeLine>
<Link id="l09930" /><CodeLine lineNumber="9930"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Body only reachable from exiting block&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09931" /><CodeLine lineNumber="9931"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(Body-&gt;<a href="/docs/api/classes/llvm/basicblock/#a63cfb2a0dae69153fd961eb335949caa">front</a>()));</Highlight></CodeLine>
<Link id="l09932" /><CodeLine lineNumber="9932"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09933" /><CodeLine lineNumber="9933"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Latch);</Highlight></CodeLine>
<Link id="l09934" /><CodeLine lineNumber="9934"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;BranchInst&gt;</a>(Latch-&gt;getTerminator()) &amp;&amp;</Highlight></CodeLine>
<Link id="l09935" /><CodeLine lineNumber="9935"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Latch must terminate with unconditional branch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09936" /><CodeLine lineNumber="9936"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Latch-&gt;getSingleSuccessor() == Header &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Latch must jump to header&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09937" /><CodeLine lineNumber="9937"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: To support simple redirecting of the end of the body code that has</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09938" /><CodeLine lineNumber="9938"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// multiple; introduce another auxiliary basic block like preheader and after.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09939" /><CodeLine lineNumber="9939"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Latch-&gt;getSinglePredecessor() != </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09940" /><CodeLine lineNumber="9940"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(Latch-&gt;front()));</Highlight></CodeLine>
<Link id="l09941" /><CodeLine lineNumber="9941"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09942" /><CodeLine lineNumber="9942"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Exit);</Highlight></CodeLine>
<Link id="l09943" /><CodeLine lineNumber="9943"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;BranchInst&gt;</a>(Exit-&gt;getTerminator()) &amp;&amp;</Highlight></CodeLine>
<Link id="l09944" /><CodeLine lineNumber="9944"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exit block must terminate with unconditional branch&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09945" /><CodeLine lineNumber="9945"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Exit-&gt;getSingleSuccessor() == <a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l09946" /><CodeLine lineNumber="9946"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exit block must jump to after block&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09947" /><CodeLine lineNumber="9947"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09948" /><CodeLine lineNumber="9948"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a>);</Highlight></CodeLine>
<Link id="l09949" /><CodeLine lineNumber="9949"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a>-&gt;getSinglePredecessor() == Exit &amp;&amp;</Highlight></CodeLine>
<Link id="l09950" /><CodeLine lineNumber="9950"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;After block only reachable from exit block&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09951" /><CodeLine lineNumber="9951"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a>-&gt;empty() || !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/files/lib/lib/passes/standardinstrumentations-cpp/#a6f1bbcae7288f05872dcfe811d0388baa7bfcadb5535fe8aad5032762b7bfe159">After</a>-&gt;front()));</Highlight></CodeLine>
<Link id="l09952" /><CodeLine lineNumber="9952"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09953" /><CodeLine lineNumber="9953"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IndVar = <a href="/docs/api/classes/llvm/canonicalloopinfo/#af4131f5f461f1138483addfd7cd7f579">getIndVar</a>();</Highlight></CodeLine>
<Link id="l09954" /><CodeLine lineNumber="9954"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IndVar &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Canonical induction variable not found?&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09955" /><CodeLine lineNumber="9955"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;IntegerType&gt;</a>(IndVar-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l09956" /><CodeLine lineNumber="9956"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Induction variable must be an integer&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09957" /><CodeLine lineNumber="9957"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(IndVar)-&gt;<a href="/docs/api/files/lib/lib/analysis/basicaliasanalysis-cpp/#a1b8850f1ed44c12bc3501175a71c251c">getParent</a>() == Header &amp;&amp;</Highlight></CodeLine>
<Link id="l09958" /><CodeLine lineNumber="9958"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Induction variable must be a PHI in the loop header&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09959" /><CodeLine lineNumber="9959"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(IndVar)-&gt;getIncomingBlock(0) == Preheader);</Highlight></CodeLine>
<Link id="l09960" /><CodeLine lineNumber="9960"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</Highlight></CodeLine>
<Link id="l09961" /><CodeLine lineNumber="9961"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ConstantInt&gt;</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(IndVar)-&gt;getIncomingValue(0))-&gt;<a href="/docs/api/files/lib/lib/analysis/lint-cpp/#a45005634b54e2126cb3e6ec0dbc9ade4">isZero</a>());</Highlight></CodeLine>
<Link id="l09962" /><CodeLine lineNumber="9962"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(IndVar)-&gt;getIncomingBlock(1) == Latch);</Highlight></CodeLine>
<Link id="l09963" /><CodeLine lineNumber="9963"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09964" /><CodeLine lineNumber="9964"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;NextIndVar = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(IndVar)-&gt;getIncomingValue(1);</Highlight></CodeLine>
<Link id="l09965" /><CodeLine lineNumber="9965"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(NextIndVar)-&gt;<a href="/docs/api/files/lib/lib/analysis/basicaliasanalysis-cpp/#a1b8850f1ed44c12bc3501175a71c251c">getParent</a>() == Latch);</Highlight></CodeLine>
<Link id="l09966" /><CodeLine lineNumber="9966"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BinaryOperator&gt;</a>(NextIndVar)-&gt;<a href="/docs/api/files/lib/lib/transforms/lib/transforms/vectorize/vplanslp-cpp/#a06b4f19004df11b338ccc7e73bf47ab4">getOpcode</a>() == BinaryOperator::Add);</Highlight></CodeLine>
<Link id="l09967" /><CodeLine lineNumber="9967"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BinaryOperator&gt;</a>(NextIndVar)-&gt;getOperand(0) == IndVar);</Highlight></CodeLine>
<Link id="l09968" /><CodeLine lineNumber="9968"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ConstantInt&gt;</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;BinaryOperator&gt;</a>(NextIndVar)-&gt;getOperand(1))</Highlight></CodeLine>
<Link id="l09969" /><CodeLine lineNumber="9969"><Highlight kind="normal">             -&gt;isOne());</Highlight></CodeLine>
<Link id="l09970" /><CodeLine lineNumber="9970"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09971" /><CodeLine lineNumber="9971"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;TripCount = <a href="/docs/api/classes/llvm/canonicalloopinfo/#a01560f4a4ff7bfc8a96bd406b6f17ea2">getTripCount</a>();</Highlight></CodeLine>
<Link id="l09972" /><CodeLine lineNumber="9972"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(TripCount &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Loop trip count not found?&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09973" /><CodeLine lineNumber="9973"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IndVar-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() == TripCount-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l09974" /><CodeLine lineNumber="9974"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Trip count and induction variable must have the same type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09975" /><CodeLine lineNumber="9975"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09976" /><CodeLine lineNumber="9976"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;CmpI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;CmpInst&gt;</a>(&amp;Cond-&gt;front());</Highlight></CodeLine>
<Link id="l09977" /><CodeLine lineNumber="9977"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CmpI-&gt;getPredicate() == <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">CmpInst::ICMP&#95;ULT</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l09978" /><CodeLine lineNumber="9978"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exit condition must be a signed less-than comparison&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09979" /><CodeLine lineNumber="9979"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CmpI-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0) == IndVar &amp;&amp;</Highlight></CodeLine>
<Link id="l09980" /><CodeLine lineNumber="9980"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exit condition must compare the induction variable&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09981" /><CodeLine lineNumber="9981"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CmpI-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1) == TripCount &amp;&amp;</Highlight></CodeLine>
<Link id="l09982" /><CodeLine lineNumber="9982"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Exit condition must compare with the trip count&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l09983" /><CodeLine lineNumber="9983"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09984" /><CodeLine lineNumber="9984"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l09985" /><CodeLine lineNumber="9985"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l09986" /><CodeLine lineNumber="9986" lineLink="/docs/api/classes/llvm/canonicalloopinfo/#a9ce55b05f8ad85126fc92eeeb35457c7"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/canonicalloopinfo/#a9ce55b05f8ad85126fc92eeeb35457c7">CanonicalLoopInfo::invalidate</a>() &#123;</Highlight></CodeLine>
<Link id="l09987" /><CodeLine lineNumber="9987"><Highlight kind="normal">  Header = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09988" /><CodeLine lineNumber="9988"><Highlight kind="normal">  Cond = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09989" /><CodeLine lineNumber="9989"><Highlight kind="normal">  Latch = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09990" /><CodeLine lineNumber="9990"><Highlight kind="normal">  Exit = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l09991" /><CodeLine lineNumber="9991"><Highlight kind="normal">&#125;</Highlight></CodeLine>

</ProgramListing>

</DoxygenPage>
