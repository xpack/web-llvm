---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/files/lib/lib/support/lib/support/blake3/blake3-c
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - file

---

import Link from '@docusaurus/Link'

import CodeLine from '@xpack/docusaurus-plugin-doxygen/components/CodeLine'
import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import Highlight from '@xpack/docusaurus-plugin-doxygen/components/Highlight'
import IncludesList from '@xpack/docusaurus-plugin-doxygen/components/IncludesList'
import IncludesListItem from '@xpack/docusaurus-plugin-doxygen/components/IncludesListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import ProgramListing from '@xpack/docusaurus-plugin-doxygen/components/ProgramListing'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `blake3.c` File Reference

<DoxygenPage pluginConfig={pluginConfig}>



## Included Headers

<IncludesList>
<IncludesListItem
  filePath="assert.h"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="stdbool.h"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="string.h"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="blake3_impl.h"
  permalink="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h"
  isLocal="true" />
</IncludesList>

## Classes Index

<MembersIndex>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/output-t">output_t</a></>}>
</MembersIndexItem>

</MembersIndex>

## Functions Index

<MembersIndex>

<MembersIndexItem
  type={<>size&#95;t</>}
  name={<><a href="#a6f1fd4d6d509893d09c8b8eb1aa5291c">blake3&#95;compress&#95;subtree&#95;wide</a> (const uint8&#95;t &#42;input, size&#95;t input&#95;len, const uint32&#95;t key&#91;8&#93;, uint64&#95;t chunk&#95;counter, uint8&#95;t flags, uint8&#95;t &#42;out)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> size&#95;t</>}
  name={<><a href="#a4e0d6518720be3eb321cbccd3cd8768a">chunk&#95;state&#95;fill&#95;buf</a> (blake3&#95;chunk&#95;state &#42;self, const uint8&#95;t &#42;input, size&#95;t input&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#a4db94e2dcf16f8659a69b1636897baeb">chunk&#95;state&#95;init</a> (blake3&#95;chunk&#95;state &#42;self, const uint32&#95;t key&#91;8&#93;, uint8&#95;t flags)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> size&#95;t</>}
  name={<><a href="#a2c1ba208c88f9efdc6702769ecd006da">chunk&#95;state&#95;len</a> (const blake3&#95;chunk&#95;state &#42;self)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> uint8&#95;t</>}
  name={<><a href="#a792a24e99fd3fbeb39db66599ace7ae0">chunk&#95;state&#95;maybe&#95;start&#95;flag</a> (const blake3&#95;chunk&#95;state &#42;self)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <a href="/docs/api/structs/output-t">output&#95;t</a></>}
  name={<><a href="#acc3e5ba813b5fb930b49c67f1edadf41">chunk&#95;state&#95;output</a> (const blake3&#95;chunk&#95;state &#42;self)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#ac3fec0f8016731502a8a1ad30cea4f3d">chunk&#95;state&#95;reset</a> (blake3&#95;chunk&#95;state &#42;self, const uint32&#95;t key&#91;8&#93;, uint64&#95;t chunk&#95;counter)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#a1c4270490e141bac2a6053af9ef01f6b">chunk&#95;state&#95;update</a> (blake3&#95;chunk&#95;state &#42;self, const uint8&#95;t &#42;input, size&#95;t input&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> size&#95;t</>}
  name={<><a href="#a5b7c95b4370497f963cb03981f87613f">compress&#95;chunks&#95;parallel</a> (const uint8&#95;t &#42;input, size&#95;t input&#95;len, const uint32&#95;t key&#91;8&#93;, uint64&#95;t chunk&#95;counter, uint8&#95;t flags, uint8&#95;t &#42;out)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> size&#95;t</>}
  name={<><a href="#ab6b82b4dfe8b1cf5e6cdf18c4dd46097">compress&#95;parents&#95;parallel</a> (const uint8&#95;t &#42;child&#95;chaining&#95;values, size&#95;t num&#95;chaining&#95;values, const uint32&#95;t key&#91;8&#93;, uint8&#95;t flags, uint8&#95;t &#42;out)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#abd0aa960e3f0e3ebab8baccea1f3808a">compress&#95;subtree&#95;to&#95;parent&#95;node</a> (const uint8&#95;t &#42;input, size&#95;t input&#95;len, const uint32&#95;t key&#91;8&#93;, uint64&#95;t chunk&#95;counter, uint8&#95;t flags, uint8&#95;t out&#91;2 &#42;BLAKE3&#95;OUT&#95;LEN&#93;)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#a3b12f6c109442edaa63ab03ba8a6caec">hasher&#95;init&#95;base</a> (blake3&#95;hasher &#42;self, const uint32&#95;t key&#91;8&#93;, uint8&#95;t flags)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#a63183e27546bc2e072233e0268400e83">hasher&#95;merge&#95;cv&#95;stack</a> (blake3&#95;hasher &#42;self, uint64&#95;t total&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#ae7004860c25afdef231d29688cfdb2ff">hasher&#95;push&#95;cv</a> (blake3&#95;hasher &#42;self, uint8&#95;t new&#95;cv&#91;BLAKE3&#95;OUT&#95;LEN&#93;, uint64&#95;t chunk&#95;counter)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> size&#95;t</>}
  name={<><a href="#af1487a6d4f0aec866d05311a3e42ab30">left&#95;len</a> (size&#95;t content&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a6f1551c11ac8a08c294ee4bf7bf08623">llvm&#95;blake3&#95;hasher&#95;finalize</a> (const blake3&#95;hasher &#42;self, uint8&#95;t &#42;out, size&#95;t out&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#ab6b397feba4ec3af8a0b09c3d7c5bffb">llvm&#95;blake3&#95;hasher&#95;finalize&#95;seek</a> (const blake3&#95;hasher &#42;self, uint64&#95;t seek, uint8&#95;t &#42;out, size&#95;t out&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a3723853888e765d1049d9f3b9e48dfed">llvm&#95;blake3&#95;hasher&#95;init</a> (blake3&#95;hasher &#42;self)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#ad0b8fa0cf17c5aa764845fbd3739c85b">llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key</a> (blake3&#95;hasher &#42;self, const char &#42;context)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#acf30a68b4c258e1c1af255c60e880aac">llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key&#95;raw</a> (blake3&#95;hasher &#42;self, const void &#42;context, size&#95;t context&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#ac4c4231fe195d56ec58b572d0badc2e6">llvm&#95;blake3&#95;hasher&#95;init&#95;keyed</a> (blake3&#95;hasher &#42;self, const uint8&#95;t key&#91;BLAKE3&#95;KEY&#95;LEN&#93;)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a465d8d4d0fdcb5bf75858c000e3e54f0">llvm&#95;blake3&#95;hasher&#95;reset</a> (blake3&#95;hasher &#42;self)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a63f3b0c97048b549ce37f5e6a4da701d">llvm&#95;blake3&#95;hasher&#95;update</a> (blake3&#95;hasher &#42;self, const void &#42;input, size&#95;t input&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> char &#42;</>}
  name={<><a href="#ab9d435f061dc1e6e693d1d4886250754">llvm&#95;blake3&#95;version</a> (void)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <a href="/docs/api/structs/output-t">output&#95;t</a></>}
  name={<><a href="#a0fb8691f907fe586830601d486049e6e">make&#95;output</a> (const uint32&#95;t input&#95;cv&#91;8&#93;, const uint8&#95;t block&#91;BLAKE3&#95;BLOCK&#95;LEN&#93;, uint8&#95;t block&#95;len, uint64&#95;t counter, uint8&#95;t flags)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#a92376f69320e66a51477df2b47088249">output&#95;chaining&#95;value</a> (const output&#95;t &#42;self, uint8&#95;t cv&#91;32&#93;)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> void</>}
  name={<><a href="#a0a194eae24fe95b572091dc7e992744f">output&#95;root&#95;bytes</a> (const output&#95;t &#42;self, uint64&#95;t seek, uint8&#95;t &#42;out, size&#95;t out&#95;len)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <a href="/docs/api/structs/output-t">output&#95;t</a></>}
  name={<><a href="#ab18874614dade172d2726abc3e88d480">parent&#95;output</a> (const uint8&#95;t block&#91;BLAKE3&#95;BLOCK&#95;LEN&#93;, const uint32&#95;t key&#91;8&#93;, uint8&#95;t flags)</>}>
</MembersIndexItem>

</MembersIndex>


<SectionDefinition>

## Functions

### blake3&#95;compress&#95;subtree&#95;wide() {#a6f1fd4d6d509893d09c8b8eb1aa5291c}

<MemberDefinition
  prototype={<>static size&#95;t blake3&#95;compress&#95;subtree&#95;wide (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t &#42; input, size&#95;t input_len, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t key=[8], uint64&#95;t chunk_counter, uint8&#95;t flags, uint8&#95;t &#42; out)</>}
  labels = {["static"]}>

Definition at line <a href="#l00269">269</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### chunk&#95;state&#95;fill&#95;buf() {#a4e0d6518720be3eb321cbccd3cd8768a}

<MemberDefinition
  prototype={<>INLINE size&#95;t chunk&#95;state&#95;fill&#95;buf (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t &#42; input, size&#95;t input_len)</>}>

Definition at line <a href="#l00041">41</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### chunk&#95;state&#95;init() {#a4db94e2dcf16f8659a69b1636897baeb}

<MemberDefinition
  prototype={<>INLINE void chunk&#95;state&#95;init (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t key=[8], uint8&#95;t flags)</>}>

Definition at line <a href="#l00017">17</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### chunk&#95;state&#95;len() {#a2c1ba208c88f9efdc6702769ecd006da}

<MemberDefinition
  prototype={<>INLINE size&#95;t chunk&#95;state&#95;len (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42; self)</>}>

Definition at line <a href="#l00036">36</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### chunk&#95;state&#95;maybe&#95;start&#95;flag() {#a792a24e99fd3fbeb39db66599ace7ae0}

<MemberDefinition
  prototype={<>INLINE uint8&#95;t chunk&#95;state&#95;maybe&#95;start&#95;flag (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42; self)</>}>

Definition at line <a href="#l00053">53</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### chunk&#95;state&#95;output() {#acc3e5ba813b5fb930b49c67f1edadf41}

<MemberDefinition
  prototype={<>INLINE output&#95;t chunk&#95;state&#95;output (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42; self)</>}>

Definition at line <a href="#l00147">147</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### chunk&#95;state&#95;reset() {#ac3fec0f8016731502a8a1ad30cea4f3d}

<MemberDefinition
  prototype={<>INLINE void chunk&#95;state&#95;reset (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t key=[8], uint64&#95;t chunk_counter)</>}>

Definition at line <a href="#l00027">27</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### chunk&#95;state&#95;update() {#a1c4270490e141bac2a6053af9ef01f6b}

<MemberDefinition
  prototype={<>INLINE void chunk&#95;state&#95;update (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t &#42; input, size&#95;t input_len)</>}>

Definition at line <a href="#l00119">119</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### compress&#95;chunks&#95;parallel() {#a5b7c95b4370497f963cb03981f87613f}

<MemberDefinition
  prototype={<>INLINE size&#95;t compress&#95;chunks&#95;parallel (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t &#42; input, size&#95;t input_len, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t key=[8], uint64&#95;t chunk_counter, uint8&#95;t flags, uint8&#95;t &#42; out)</>}>

Definition at line <a href="#l00173">173</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### compress&#95;parents&#95;parallel() {#ab6b82b4dfe8b1cf5e6cdf18c4dd46097}

<MemberDefinition
  prototype={<>INLINE size&#95;t compress&#95;parents&#95;parallel (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t &#42; child_chaining_values, size&#95;t num_chaining_values, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t key=[8], uint8&#95;t flags, uint8&#95;t &#42; out)</>}>

Definition at line <a href="#l00217">217</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### compress&#95;subtree&#95;to&#95;parent&#95;node() {#abd0aa960e3f0e3ebab8baccea1f3808a}

<MemberDefinition
  prototype={<>INLINE void compress&#95;subtree&#95;to&#95;parent&#95;node (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t &#42; input, size&#95;t input_len, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t key=[8], uint64&#95;t chunk_counter, uint8&#95;t flags, uint8&#95;t out=[2 *BLAKE3_OUT_LEN])</>}>

Definition at line <a href="#l00338">338</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### hasher&#95;init&#95;base() {#a3b12f6c109442edaa63ab03ba8a6caec}

<MemberDefinition
  prototype={<>INLINE void hasher&#95;init&#95;base (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t key=[8], uint8&#95;t flags)</>}>

Definition at line <a href="#l00367">367</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### hasher&#95;merge&#95;cv&#95;stack() {#a63183e27546bc2e072233e0268400e83}

<MemberDefinition
  prototype={<>INLINE void hasher&#95;merge&#95;cv&#95;stack (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, uint64&#95;t total_len)</>}>

Definition at line <a href="#l00409">409</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### hasher&#95;push&#95;cv() {#ae7004860c25afdef231d29688cfdb2ff}

<MemberDefinition
  prototype={<>INLINE void hasher&#95;push&#95;cv (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, uint8&#95;t new_cv=[BLAKE3_OUT_LEN], uint64&#95;t chunk_counter)</>}>

Definition at line <a href="#l00452">452</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### left&#95;len() {#af1487a6d4f0aec866d05311a3e42ab30}

<MemberDefinition
  prototype={<>INLINE size&#95;t left&#95;len (size&#95;t content_len)</>}>

Definition at line <a href="#l00162">162</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;hasher&#95;finalize() {#a6f1551c11ac8a08c294ee4bf7bf08623}

<MemberDefinition
  prototype={<>void llvm&#95;blake3&#95;hasher&#95;finalize (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, uint8&#95;t &#42; out, size&#95;t out_len)</>}>

Definition at line <a href="#l00569">569</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;hasher&#95;finalize&#95;seek() {#ab6b397feba4ec3af8a0b09c3d7c5bffb}

<MemberDefinition
  prototype={<>void llvm&#95;blake3&#95;hasher&#95;finalize&#95;seek (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, uint64&#95;t seek, uint8&#95;t &#42; out, size&#95;t out_len)</>}>

Definition at line <a href="#l00578">578</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;hasher&#95;init() {#a3723853888e765d1049d9f3b9e48dfed}

<MemberDefinition
  prototype={<>void llvm&#95;blake3&#95;hasher&#95;init (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self)</>}>

Definition at line <a href="#l00374">374</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key() {#ad0b8fa0cf17c5aa764845fbd3739c85b}

<MemberDefinition
  prototype={<>void llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> char &#42; context)</>}>

Definition at line <a href="#l00395">395</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key&#95;raw() {#acf30a68b4c258e1c1af255c60e880aac}

<MemberDefinition
  prototype={<>void llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key&#95;raw (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> void &#42; context, size&#95;t context_len)</>}>

Definition at line <a href="#l00383">383</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;hasher&#95;init&#95;keyed() {#ac4c4231fe195d56ec58b572d0badc2e6}

<MemberDefinition
  prototype={<>void llvm&#95;blake3&#95;hasher&#95;init&#95;keyed (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t key=[BLAKE3_KEY_LEN])</>}>

Definition at line <a href="#l00376">376</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;hasher&#95;reset() {#a465d8d4d0fdcb5bf75858c000e3e54f0}

<MemberDefinition
  prototype={<>void llvm&#95;blake3&#95;hasher&#95;reset (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self)</>}>

Definition at line <a href="#l00622">622</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;hasher&#95;update() {#a63f3b0c97048b549ce37f5e6a4da701d}

<MemberDefinition
  prototype={<>void llvm&#95;blake3&#95;hasher&#95;update (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42; self, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> void &#42; input, size&#95;t input_len)</>}>

Definition at line <a href="#l00460">460</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### llvm&#95;blake3&#95;version() {#ab9d435f061dc1e6e693d1d4886250754}

<MemberDefinition
  prototype={<>const char &#42; llvm&#95;blake3&#95;version (void)</>}>

Definition at line <a href="#l00015">15</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### make&#95;output() {#a0fb8691f907fe586830601d486049e6e}

<MemberDefinition
  prototype={<>INLINE output&#95;t make&#95;output (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t input_cv=[8], <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t block=[BLAKE3_BLOCK_LEN], uint8&#95;t block_len, uint64&#95;t counter, uint8&#95;t flags)</>}>

Definition at line <a href="#l00069">69</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### output&#95;chaining&#95;value() {#a92376f69320e66a51477df2b47088249}

<MemberDefinition
  prototype={<>INLINE void output&#95;chaining&#95;value (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/structs/output-t">output&#95;t</a> &#42; self, uint8&#95;t cv=[32])</>}>

Definition at line <a href="#l00088">88</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### output&#95;root&#95;bytes() {#a0a194eae24fe95b572091dc7e992744f}

<MemberDefinition
  prototype={<>INLINE void output&#95;root&#95;bytes (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/structs/output-t">output&#95;t</a> &#42; self, uint64&#95;t seek, uint8&#95;t &#42; out, size&#95;t out_len)</>}>

Definition at line <a href="#l00096">96</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

### parent&#95;output() {#ab18874614dade172d2726abc3e88d480}

<MemberDefinition
  prototype={<>INLINE output&#95;t parent&#95;output (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint8&#95;t block=[BLAKE3_BLOCK_LEN], <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> uint32&#95;t key=[8], uint8&#95;t flags)</>}>

Definition at line <a href="#l00154">154</a> of file <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-c">blake3.c</a>.
</MemberDefinition>

</SectionDefinition>

## File Listing

The file content with the documentation metadata removed is:

<ProgramListing>

<Link id="l00001" /><CodeLine lineNumber="1"><Highlight kind="comment">/&#42;===-- blake3.c - BLAKE3 C Implementation ------------------------&#42;- C -&#42;-===&#42;\\</Highlight></CodeLine>
<Link id="l00002" /><CodeLine lineNumber="2"><Highlight kind="comment">|&#42;                                                                            &#42;|</Highlight></CodeLine>
<Link id="l00003" /><CodeLine lineNumber="3"><Highlight kind="comment">|&#42; Released into the public domain with CC0 1                               &#42;|</Highlight></CodeLine>
<Link id="l00004" /><CodeLine lineNumber="4"><Highlight kind="comment">|&#42; See &#39;llvm/lib/Support/BLAKE3/LICENSE&#39; for info.                            &#42;|</Highlight></CodeLine>
<Link id="l00005" /><CodeLine lineNumber="5"><Highlight kind="comment">|&#42; SPDX-License-Identifier: CC0-1.0                                           &#42;|</Highlight></CodeLine>
<Link id="l00006" /><CodeLine lineNumber="6"><Highlight kind="comment">|&#42;                                                                            &#42;|</Highlight></CodeLine>
<Link id="l00007" /><CodeLine lineNumber="7"><Highlight kind="comment">\\&#42;===----------------------------------------------------------------------===&#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00008" /><CodeLine lineNumber="8"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00009" /><CodeLine lineNumber="9"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;assert.h&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00010" /><CodeLine lineNumber="10"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;stdbool.h&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00011" /><CodeLine lineNumber="11"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;string.h&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00012" /><CodeLine lineNumber="12"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00013" /><CodeLine lineNumber="13"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h">blake3&#95;impl.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00014" /><CodeLine lineNumber="14"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00015" /><CodeLine lineNumber="15" lineLink="/docs/api/files/include/include/llvm-c/blake3-h/#ab9d435f061dc1e6e693d1d4886250754"><Highlight kind="normal"></Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">char</Highlight><Highlight kind="normal"> &#42;<a href="#ab9d435f061dc1e6e693d1d4886250754">llvm&#95;blake3&#95;version</a>(</Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal">) &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a98986aaaab2221d6639d3e60f3682a91">BLAKE3&#95;VERSION&#95;STRING</a>; &#125;</Highlight></CodeLine>
<Link id="l00016" /><CodeLine lineNumber="16"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00017" /><CodeLine lineNumber="17" lineLink="#a4db94e2dcf16f8659a69b1636897baeb"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a4db94e2dcf16f8659a69b1636897baeb">chunk&#95;state&#95;init</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42;self, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t key&#91;8&#93;,</Highlight></CodeLine>
<Link id="l00018" /><CodeLine lineNumber="18"><Highlight kind="normal">                             uint8&#95;t flags) &#123;</Highlight></CodeLine>
<Link id="l00019" /><CodeLine lineNumber="19"><Highlight kind="normal">  memcpy(self-&gt;cv, key, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a947bd80c6cdcbd362dd0760f3603abe6">BLAKE3&#95;KEY&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00020" /><CodeLine lineNumber="20"><Highlight kind="normal">  self-&gt;chunk&#95;counter = 0;</Highlight></CodeLine>
<Link id="l00021" /><CodeLine lineNumber="21"><Highlight kind="normal">  memset(self-&gt;buf, 0, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00022" /><CodeLine lineNumber="22"><Highlight kind="normal">  self-&gt;buf&#95;len = 0;</Highlight></CodeLine>
<Link id="l00023" /><CodeLine lineNumber="23"><Highlight kind="normal">  self-&gt;blocks&#95;compressed = 0;</Highlight></CodeLine>
<Link id="l00024" /><CodeLine lineNumber="24"><Highlight kind="normal">  self-&gt;flags = flags;</Highlight></CodeLine>
<Link id="l00025" /><CodeLine lineNumber="25"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00026" /><CodeLine lineNumber="26"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00027" /><CodeLine lineNumber="27" lineLink="#ac3fec0f8016731502a8a1ad30cea4f3d"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#ac3fec0f8016731502a8a1ad30cea4f3d">chunk&#95;state&#95;reset</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42;self, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t key&#91;8&#93;,</Highlight></CodeLine>
<Link id="l00028" /><CodeLine lineNumber="28"><Highlight kind="normal">                              uint64&#95;t chunk&#95;counter) &#123;</Highlight></CodeLine>
<Link id="l00029" /><CodeLine lineNumber="29"><Highlight kind="normal">  memcpy(self-&gt;cv, key, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a947bd80c6cdcbd362dd0760f3603abe6">BLAKE3&#95;KEY&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00030" /><CodeLine lineNumber="30"><Highlight kind="normal">  self-&gt;chunk&#95;counter = chunk&#95;counter;</Highlight></CodeLine>
<Link id="l00031" /><CodeLine lineNumber="31"><Highlight kind="normal">  self-&gt;blocks&#95;compressed = 0;</Highlight></CodeLine>
<Link id="l00032" /><CodeLine lineNumber="32"><Highlight kind="normal">  memset(self-&gt;buf, 0, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00033" /><CodeLine lineNumber="33"><Highlight kind="normal">  self-&gt;buf&#95;len = 0;</Highlight></CodeLine>
<Link id="l00034" /><CodeLine lineNumber="34"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00035" /><CodeLine lineNumber="35"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00036" /><CodeLine lineNumber="36" lineLink="#a2c1ba208c88f9efdc6702769ecd006da"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="#a2c1ba208c88f9efdc6702769ecd006da">chunk&#95;state&#95;len</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42;self) &#123;</Highlight></CodeLine>
<Link id="l00037" /><CodeLine lineNumber="37"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a> &#42; (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal">)self-&gt;blocks&#95;compressed) +</Highlight></CodeLine>
<Link id="l00038" /><CodeLine lineNumber="38"><Highlight kind="normal">         ((size&#95;t)self-&gt;buf&#95;len);</Highlight></CodeLine>
<Link id="l00039" /><CodeLine lineNumber="39"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00040" /><CodeLine lineNumber="40"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00041" /><CodeLine lineNumber="41" lineLink="#a4e0d6518720be3eb321cbccd3cd8768a"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="#a4e0d6518720be3eb321cbccd3cd8768a">chunk&#95;state&#95;fill&#95;buf</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42;self,</Highlight></CodeLine>
<Link id="l00042" /><CodeLine lineNumber="42"><Highlight kind="normal">                                   </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;input, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> input&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00043" /><CodeLine lineNumber="43"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> take = <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a> - ((size&#95;t)self-&gt;buf&#95;len);</Highlight></CodeLine>
<Link id="l00044" /><CodeLine lineNumber="44"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (take &gt; input&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00045" /><CodeLine lineNumber="45"><Highlight kind="normal">    take = input&#95;len;</Highlight></CodeLine>
<Link id="l00046" /><CodeLine lineNumber="46"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00047" /><CodeLine lineNumber="47"><Highlight kind="normal">  uint8&#95;t &#42;dest = self-&gt;buf + ((size&#95;t)self-&gt;buf&#95;len);</Highlight></CodeLine>
<Link id="l00048" /><CodeLine lineNumber="48"><Highlight kind="normal">  memcpy(dest, input, take);</Highlight></CodeLine>
<Link id="l00049" /><CodeLine lineNumber="49"><Highlight kind="normal">  self-&gt;buf&#95;len += (uint8&#95;t)take;</Highlight></CodeLine>
<Link id="l00050" /><CodeLine lineNumber="50"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> take;</Highlight></CodeLine>
<Link id="l00051" /><CodeLine lineNumber="51"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00052" /><CodeLine lineNumber="52"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00053" /><CodeLine lineNumber="53" lineLink="#a792a24e99fd3fbeb39db66599ace7ae0"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> uint8&#95;t <a href="#a792a24e99fd3fbeb39db66599ace7ae0">chunk&#95;state&#95;maybe&#95;start&#95;flag</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42;self) &#123;</Highlight></CodeLine>
<Link id="l00054" /><CodeLine lineNumber="54"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (self-&gt;blocks&#95;compressed == 0) &#123;</Highlight></CodeLine>
<Link id="l00055" /><CodeLine lineNumber="55"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cba1ee5b64a429be6a437f316619ccf377f">CHUNK&#95;START</a>;</Highlight></CodeLine>
<Link id="l00056" /><CodeLine lineNumber="56"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00057" /><CodeLine lineNumber="57"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 0;</Highlight></CodeLine>
<Link id="l00058" /><CodeLine lineNumber="58"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00059" /><CodeLine lineNumber="59"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00060" /><CodeLine lineNumber="60"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00061" /><CodeLine lineNumber="61" lineLink="/docs/api/structs/output-t"><Highlight kind="normal"></Highlight><Highlight kind="keyword">typedef</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00062" /><CodeLine lineNumber="62" lineLink="/docs/api/structs/output-t/#ac4f9eca5e279f34c50f6e70ad449a897"><Highlight kind="normal">  uint32&#95;t <a href="/docs/api/structs/output-t/#ac4f9eca5e279f34c50f6e70ad449a897">input&#95;cv</a>&#91;8&#93;;</Highlight></CodeLine>
<Link id="l00063" /><CodeLine lineNumber="63" lineLink="/docs/api/structs/output-t/#ab9a8543fae164eece122f39bcdaa0bf7"><Highlight kind="normal">  uint64&#95;t <a href="/docs/api/structs/output-t/#ab9a8543fae164eece122f39bcdaa0bf7">counter</a>;</Highlight></CodeLine>
<Link id="l00064" /><CodeLine lineNumber="64" lineLink="/docs/api/structs/output-t/#a67fd92399759962d96519544c737be99"><Highlight kind="normal">  uint8&#95;t <a href="/docs/api/structs/output-t/#a67fd92399759962d96519544c737be99">block</a>&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00065" /><CodeLine lineNumber="65" lineLink="/docs/api/structs/output-t/#a1e73cd9626b6c0a7960af035596dbf7c"><Highlight kind="normal">  uint8&#95;t <a href="/docs/api/structs/output-t/#a1e73cd9626b6c0a7960af035596dbf7c">block&#95;len</a>;</Highlight></CodeLine>
<Link id="l00066" /><CodeLine lineNumber="66" lineLink="/docs/api/structs/output-t/#abab5d28213b91ed5b976aa4eef0f6384"><Highlight kind="normal">  uint8&#95;t <a href="/docs/api/structs/output-t/#abab5d28213b91ed5b976aa4eef0f6384">flags</a>;</Highlight></CodeLine>
<Link id="l00067" /><CodeLine lineNumber="67"><Highlight kind="normal">&#125; <a href="/docs/api/structs/output-t">output&#95;t</a>;</Highlight></CodeLine>
<Link id="l00068" /><CodeLine lineNumber="68"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00069" /><CodeLine lineNumber="69" lineLink="#a0fb8691f907fe586830601d486049e6e"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <a href="/docs/api/structs/output-t">output&#95;t</a> <a href="#a0fb8691f907fe586830601d486049e6e">make&#95;output</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t input&#95;cv&#91;8&#93;,</Highlight></CodeLine>
<Link id="l00070" /><CodeLine lineNumber="70"><Highlight kind="normal">                            </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/unifyloopexits-cpp/#a4741a07a0e5675f89cfed122008e0a76">block</a>&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>&#93;,</Highlight></CodeLine>
<Link id="l00071" /><CodeLine lineNumber="71"><Highlight kind="normal">                            uint8&#95;t block&#95;len, uint64&#95;t counter,</Highlight></CodeLine>
<Link id="l00072" /><CodeLine lineNumber="72"><Highlight kind="normal">                            uint8&#95;t flags) &#123;</Highlight></CodeLine>
<Link id="l00073" /><CodeLine lineNumber="73"><Highlight kind="normal">  <a href="/docs/api/structs/output-t">output&#95;t</a> ret;</Highlight></CodeLine>
<Link id="l00074" /><CodeLine lineNumber="74"><Highlight kind="normal">  memcpy(ret.<a href="/docs/api/structs/output-t/#ac4f9eca5e279f34c50f6e70ad449a897">input&#95;cv</a>, input&#95;cv, 32);</Highlight></CodeLine>
<Link id="l00075" /><CodeLine lineNumber="75"><Highlight kind="normal">  memcpy(ret.<a href="/docs/api/structs/output-t/#a67fd92399759962d96519544c737be99">block</a>, <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/unifyloopexits-cpp/#a4741a07a0e5675f89cfed122008e0a76">block</a>, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00076" /><CodeLine lineNumber="76"><Highlight kind="normal">  ret.<a href="/docs/api/structs/output-t/#a1e73cd9626b6c0a7960af035596dbf7c">block&#95;len</a> = block&#95;len;</Highlight></CodeLine>
<Link id="l00077" /><CodeLine lineNumber="77"><Highlight kind="normal">  ret.<a href="/docs/api/structs/output-t/#ab9a8543fae164eece122f39bcdaa0bf7">counter</a> = counter;</Highlight></CodeLine>
<Link id="l00078" /><CodeLine lineNumber="78"><Highlight kind="normal">  ret.<a href="/docs/api/structs/output-t/#abab5d28213b91ed5b976aa4eef0f6384">flags</a> = flags;</Highlight></CodeLine>
<Link id="l00079" /><CodeLine lineNumber="79"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ret;</Highlight></CodeLine>
<Link id="l00080" /><CodeLine lineNumber="80"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00081" /><CodeLine lineNumber="81"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00082" /><CodeLine lineNumber="82"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Chaining values within a given chunk (specifically the compress&#95;in&#95;place</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00083" /><CodeLine lineNumber="83"><Highlight kind="normal"></Highlight><Highlight kind="comment">// interface) are represented as words. This avoids unnecessary bytes&lt;-&gt;words</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00084" /><CodeLine lineNumber="84"><Highlight kind="normal"></Highlight><Highlight kind="comment">// conversion overhead in the portable implementation. However, the hash&#95;many</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00085" /><CodeLine lineNumber="85"><Highlight kind="normal"></Highlight><Highlight kind="comment">// interface handles both user input and parent node blocks, so it accepts</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00086" /><CodeLine lineNumber="86"><Highlight kind="normal"></Highlight><Highlight kind="comment">// bytes. For that reason, chaining values in the CV stack are represented as</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00087" /><CodeLine lineNumber="87"><Highlight kind="normal"></Highlight><Highlight kind="comment">// bytes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00088" /><CodeLine lineNumber="88" lineLink="#a92376f69320e66a51477df2b47088249"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a92376f69320e66a51477df2b47088249">output&#95;chaining&#95;value</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/output-t">output&#95;t</a> &#42;self, uint8&#95;t cv&#91;32&#93;) &#123;</Highlight></CodeLine>
<Link id="l00089" /><CodeLine lineNumber="89"><Highlight kind="normal">  uint32&#95;t cv&#95;words&#91;8&#93;;</Highlight></CodeLine>
<Link id="l00090" /><CodeLine lineNumber="90"><Highlight kind="normal">  memcpy(cv&#95;words, self-&gt;<a href="/docs/api/structs/output-t/#ac4f9eca5e279f34c50f6e70ad449a897">input&#95;cv</a>, 32);</Highlight></CodeLine>
<Link id="l00091" /><CodeLine lineNumber="91"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720451c4882eb74f48bb24d1af5b7368">blake3&#95;compress&#95;in&#95;place</a>(cv&#95;words, self-&gt;<a href="/docs/api/structs/output-t/#a67fd92399759962d96519544c737be99">block</a>, self-&gt;<a href="/docs/api/structs/output-t/#a1e73cd9626b6c0a7960af035596dbf7c">block&#95;len</a>,</Highlight></CodeLine>
<Link id="l00092" /><CodeLine lineNumber="92"><Highlight kind="normal">                           self-&gt;<a href="/docs/api/structs/output-t/#ab9a8543fae164eece122f39bcdaa0bf7">counter</a>, self-&gt;<a href="/docs/api/structs/output-t/#abab5d28213b91ed5b976aa4eef0f6384">flags</a>);</Highlight></CodeLine>
<Link id="l00093" /><CodeLine lineNumber="93"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#aa2fffe259ee56abc321b02c9790a6dfa">store&#95;cv&#95;words</a>(cv, cv&#95;words);</Highlight></CodeLine>
<Link id="l00094" /><CodeLine lineNumber="94"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00095" /><CodeLine lineNumber="95"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00096" /><CodeLine lineNumber="96" lineLink="#a0a194eae24fe95b572091dc7e992744f"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a0a194eae24fe95b572091dc7e992744f">output&#95;root&#95;bytes</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/output-t">output&#95;t</a> &#42;self, uint64&#95;t seek, uint8&#95;t &#42;out,</Highlight></CodeLine>
<Link id="l00097" /><CodeLine lineNumber="97"><Highlight kind="normal">                              </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> out&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00098" /><CodeLine lineNumber="98"><Highlight kind="normal">  uint64&#95;t output&#95;block&#95;counter = seek / 64;</Highlight></CodeLine>
<Link id="l00099" /><CodeLine lineNumber="99"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> offset&#95;within&#95;block = seek % 64;</Highlight></CodeLine>
<Link id="l00100" /><CodeLine lineNumber="100"><Highlight kind="normal">  uint8&#95;t wide&#95;buf&#91;64&#93;;</Highlight></CodeLine>
<Link id="l00101" /><CodeLine lineNumber="101"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (out&#95;len &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l00102" /><CodeLine lineNumber="102"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a4a33a8bd63bbab7dc6625881ecf9cf4b">blake3&#95;compress&#95;xof</a>(self-&gt;<a href="/docs/api/structs/output-t/#ac4f9eca5e279f34c50f6e70ad449a897">input&#95;cv</a>, self-&gt;<a href="/docs/api/structs/output-t/#a67fd92399759962d96519544c737be99">block</a>, self-&gt;<a href="/docs/api/structs/output-t/#a1e73cd9626b6c0a7960af035596dbf7c">block&#95;len</a>,</Highlight></CodeLine>
<Link id="l00103" /><CodeLine lineNumber="103"><Highlight kind="normal">                        output&#95;block&#95;counter, self-&gt;<a href="/docs/api/structs/output-t/#abab5d28213b91ed5b976aa4eef0f6384">flags</a> | <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cbad41208b99e347d1726824779b11ea11b">ROOT</a>, wide&#95;buf);</Highlight></CodeLine>
<Link id="l00104" /><CodeLine lineNumber="104"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> available&#95;bytes = 64 - offset&#95;within&#95;block;</Highlight></CodeLine>
<Link id="l00105" /><CodeLine lineNumber="105"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> memcpy&#95;len;</Highlight></CodeLine>
<Link id="l00106" /><CodeLine lineNumber="106"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (out&#95;len &gt; available&#95;bytes) &#123;</Highlight></CodeLine>
<Link id="l00107" /><CodeLine lineNumber="107"><Highlight kind="normal">      memcpy&#95;len = available&#95;bytes;</Highlight></CodeLine>
<Link id="l00108" /><CodeLine lineNumber="108"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00109" /><CodeLine lineNumber="109"><Highlight kind="normal">      memcpy&#95;len = out&#95;len;</Highlight></CodeLine>
<Link id="l00110" /><CodeLine lineNumber="110"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00111" /><CodeLine lineNumber="111"><Highlight kind="normal">    memcpy(out, wide&#95;buf + offset&#95;within&#95;block, memcpy&#95;len);</Highlight></CodeLine>
<Link id="l00112" /><CodeLine lineNumber="112"><Highlight kind="normal">    out += memcpy&#95;len;</Highlight></CodeLine>
<Link id="l00113" /><CodeLine lineNumber="113"><Highlight kind="normal">    out&#95;len -= memcpy&#95;len;</Highlight></CodeLine>
<Link id="l00114" /><CodeLine lineNumber="114"><Highlight kind="normal">    output&#95;block&#95;counter += 1;</Highlight></CodeLine>
<Link id="l00115" /><CodeLine lineNumber="115"><Highlight kind="normal">    offset&#95;within&#95;block = 0;</Highlight></CodeLine>
<Link id="l00116" /><CodeLine lineNumber="116"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00117" /><CodeLine lineNumber="117"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00118" /><CodeLine lineNumber="118"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00119" /><CodeLine lineNumber="119" lineLink="#a1c4270490e141bac2a6053af9ef01f6b"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a1c4270490e141bac2a6053af9ef01f6b">chunk&#95;state&#95;update</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42;self, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;input,</Highlight></CodeLine>
<Link id="l00120" /><CodeLine lineNumber="120"><Highlight kind="normal">                               </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> input&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00121" /><CodeLine lineNumber="121"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (self-&gt;buf&#95;len &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l00122" /><CodeLine lineNumber="122"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> take = <a href="#a4e0d6518720be3eb321cbccd3cd8768a">chunk&#95;state&#95;fill&#95;buf</a>(self, input, input&#95;len);</Highlight></CodeLine>
<Link id="l00123" /><CodeLine lineNumber="123"><Highlight kind="normal">    input += take;</Highlight></CodeLine>
<Link id="l00124" /><CodeLine lineNumber="124"><Highlight kind="normal">    input&#95;len -= take;</Highlight></CodeLine>
<Link id="l00125" /><CodeLine lineNumber="125"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (input&#95;len &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l00126" /><CodeLine lineNumber="126"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720451c4882eb74f48bb24d1af5b7368">blake3&#95;compress&#95;in&#95;place</a>(</Highlight></CodeLine>
<Link id="l00127" /><CodeLine lineNumber="127"><Highlight kind="normal">          self-&gt;cv, self-&gt;buf, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>, self-&gt;chunk&#95;counter,</Highlight></CodeLine>
<Link id="l00128" /><CodeLine lineNumber="128"><Highlight kind="normal">          self-&gt;flags | <a href="#a792a24e99fd3fbeb39db66599ace7ae0">chunk&#95;state&#95;maybe&#95;start&#95;flag</a>(self));</Highlight></CodeLine>
<Link id="l00129" /><CodeLine lineNumber="129"><Highlight kind="normal">      self-&gt;blocks&#95;compressed += 1;</Highlight></CodeLine>
<Link id="l00130" /><CodeLine lineNumber="130"><Highlight kind="normal">      self-&gt;buf&#95;len = 0;</Highlight></CodeLine>
<Link id="l00131" /><CodeLine lineNumber="131"><Highlight kind="normal">      memset(self-&gt;buf, 0, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00132" /><CodeLine lineNumber="132"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00133" /><CodeLine lineNumber="133"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00134" /><CodeLine lineNumber="134"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00135" /><CodeLine lineNumber="135"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (input&#95;len &gt; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>) &#123;</Highlight></CodeLine>
<Link id="l00136" /><CodeLine lineNumber="136"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720451c4882eb74f48bb24d1af5b7368">blake3&#95;compress&#95;in&#95;place</a>(self-&gt;cv, input, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>,</Highlight></CodeLine>
<Link id="l00137" /><CodeLine lineNumber="137"><Highlight kind="normal">                             self-&gt;chunk&#95;counter,</Highlight></CodeLine>
<Link id="l00138" /><CodeLine lineNumber="138"><Highlight kind="normal">                             self-&gt;flags | <a href="#a792a24e99fd3fbeb39db66599ace7ae0">chunk&#95;state&#95;maybe&#95;start&#95;flag</a>(self));</Highlight></CodeLine>
<Link id="l00139" /><CodeLine lineNumber="139"><Highlight kind="normal">    self-&gt;blocks&#95;compressed += 1;</Highlight></CodeLine>
<Link id="l00140" /><CodeLine lineNumber="140"><Highlight kind="normal">    input += <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>;</Highlight></CodeLine>
<Link id="l00141" /><CodeLine lineNumber="141"><Highlight kind="normal">    input&#95;len -= <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>;</Highlight></CodeLine>
<Link id="l00142" /><CodeLine lineNumber="142"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00143" /><CodeLine lineNumber="143"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00144" /><CodeLine lineNumber="144"><Highlight kind="normal">  <a href="#a4e0d6518720be3eb321cbccd3cd8768a">chunk&#95;state&#95;fill&#95;buf</a>(self, input, input&#95;len);</Highlight></CodeLine>
<Link id="l00145" /><CodeLine lineNumber="145"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00146" /><CodeLine lineNumber="146"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00147" /><CodeLine lineNumber="147" lineLink="#acc3e5ba813b5fb930b49c67f1edadf41"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <a href="/docs/api/structs/output-t">output&#95;t</a> <a href="#acc3e5ba813b5fb930b49c67f1edadf41">chunk&#95;state&#95;output</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> &#42;self) &#123;</Highlight></CodeLine>
<Link id="l00148" /><CodeLine lineNumber="148"><Highlight kind="normal">  uint8&#95;t block&#95;flags =</Highlight></CodeLine>
<Link id="l00149" /><CodeLine lineNumber="149"><Highlight kind="normal">      self-&gt;flags | <a href="#a792a24e99fd3fbeb39db66599ace7ae0">chunk&#95;state&#95;maybe&#95;start&#95;flag</a>(self) | <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cbad611fba49fcf900148ebefa6649d82fd">CHUNK&#95;END</a>;</Highlight></CodeLine>
<Link id="l00150" /><CodeLine lineNumber="150"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a0fb8691f907fe586830601d486049e6e">make&#95;output</a>(self-&gt;cv, self-&gt;buf, self-&gt;buf&#95;len, self-&gt;chunk&#95;counter,</Highlight></CodeLine>
<Link id="l00151" /><CodeLine lineNumber="151"><Highlight kind="normal">                     block&#95;flags);</Highlight></CodeLine>
<Link id="l00152" /><CodeLine lineNumber="152"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00153" /><CodeLine lineNumber="153"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00154" /><CodeLine lineNumber="154" lineLink="#ab18874614dade172d2726abc3e88d480"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> <a href="/docs/api/structs/output-t">output&#95;t</a> <a href="#ab18874614dade172d2726abc3e88d480">parent&#95;output</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/unifyloopexits-cpp/#a4741a07a0e5675f89cfed122008e0a76">block</a>&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>&#93;,</Highlight></CodeLine>
<Link id="l00155" /><CodeLine lineNumber="155"><Highlight kind="normal">                              </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t key&#91;8&#93;, uint8&#95;t flags) &#123;</Highlight></CodeLine>
<Link id="l00156" /><CodeLine lineNumber="156"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a0fb8691f907fe586830601d486049e6e">make&#95;output</a>(key, <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/unifyloopexits-cpp/#a4741a07a0e5675f89cfed122008e0a76">block</a>, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>, 0, flags | <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cba283df3974c567b21c067198a24cd78e6">PARENT</a>);</Highlight></CodeLine>
<Link id="l00157" /><CodeLine lineNumber="157"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00158" /><CodeLine lineNumber="158"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00159" /><CodeLine lineNumber="159"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Given some input larger than one chunk, return the number of bytes that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00160" /><CodeLine lineNumber="160"><Highlight kind="normal"></Highlight><Highlight kind="comment">// should go in the left subtree. This is the largest power-of-2 number of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00161" /><CodeLine lineNumber="161"><Highlight kind="normal"></Highlight><Highlight kind="comment">// chunks that leaves at least 1 byte for the right subtree.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00162" /><CodeLine lineNumber="162" lineLink="#af1487a6d4f0aec866d05311a3e42ab30"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="#af1487a6d4f0aec866d05311a3e42ab30">left&#95;len</a>(</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> content&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00163" /><CodeLine lineNumber="163"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Subtract 1 to reserve at least one byte for the right side. content&#95;len</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00164" /><CodeLine lineNumber="164"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// should always be greater than BLAKE3&#95;CHUNK&#95;LEN.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00165" /><CodeLine lineNumber="165"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> full&#95;chunks = (content&#95;len - 1) / <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>;</Highlight></CodeLine>
<Link id="l00166" /><CodeLine lineNumber="166"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#aa512c33323d4cb6599016c57337832fe">round&#95;down&#95;to&#95;power&#95;of&#95;2</a>(full&#95;chunks) &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>;</Highlight></CodeLine>
<Link id="l00167" /><CodeLine lineNumber="167"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00168" /><CodeLine lineNumber="168"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00169" /><CodeLine lineNumber="169"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Use SIMD parallelism to hash up to MAX&#95;SIMD&#95;DEGREE chunks at the same time</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00170" /><CodeLine lineNumber="170"><Highlight kind="normal"></Highlight><Highlight kind="comment">// on a single thread. Write out the chunk chaining values and return the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00171" /><CodeLine lineNumber="171"><Highlight kind="normal"></Highlight><Highlight kind="comment">// number of chunks hashed. These chunks are never the root and never empty;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00172" /><CodeLine lineNumber="172"><Highlight kind="normal"></Highlight><Highlight kind="comment">// those cases use a different codepath.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00173" /><CodeLine lineNumber="173" lineLink="#a5b7c95b4370497f963cb03981f87613f"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="#a5b7c95b4370497f963cb03981f87613f">compress&#95;chunks&#95;parallel</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;input, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> input&#95;len,</Highlight></CodeLine>
<Link id="l00174" /><CodeLine lineNumber="174"><Highlight kind="normal">                                       </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t key&#91;8&#93;,</Highlight></CodeLine>
<Link id="l00175" /><CodeLine lineNumber="175"><Highlight kind="normal">                                       uint64&#95;t chunk&#95;counter, uint8&#95;t flags,</Highlight></CodeLine>
<Link id="l00176" /><CodeLine lineNumber="176"><Highlight kind="normal">                                       uint8&#95;t &#42;out) &#123;</Highlight></CodeLine>
<Link id="l00177" /><CodeLine lineNumber="177"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if defined(BLAKE3&#95;TESTING)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00178" /><CodeLine lineNumber="178"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(0 &lt; input&#95;len);</Highlight></CodeLine>
<Link id="l00179" /><CodeLine lineNumber="179"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(input&#95;len &lt;= <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a464a51e01f71c6dfc24ebba1126ff7dd">MAX&#95;SIMD&#95;DEGREE</a> &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00180" /><CodeLine lineNumber="180"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00181" /><CodeLine lineNumber="181"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00182" /><CodeLine lineNumber="182"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;chunks&#95;array&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a464a51e01f71c6dfc24ebba1126ff7dd">MAX&#95;SIMD&#95;DEGREE</a>&#93;;</Highlight></CodeLine>
<Link id="l00183" /><CodeLine lineNumber="183"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> input&#95;position = 0;</Highlight></CodeLine>
<Link id="l00184" /><CodeLine lineNumber="184"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> chunks&#95;array&#95;len = 0;</Highlight></CodeLine>
<Link id="l00185" /><CodeLine lineNumber="185"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (input&#95;len - input&#95;position &gt;= <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>) &#123;</Highlight></CodeLine>
<Link id="l00186" /><CodeLine lineNumber="186"><Highlight kind="normal">    chunks&#95;array&#91;chunks&#95;array&#95;len&#93; = &amp;input&#91;input&#95;position&#93;;</Highlight></CodeLine>
<Link id="l00187" /><CodeLine lineNumber="187"><Highlight kind="normal">    input&#95;position += <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>;</Highlight></CodeLine>
<Link id="l00188" /><CodeLine lineNumber="188"><Highlight kind="normal">    chunks&#95;array&#95;len += 1;</Highlight></CodeLine>
<Link id="l00189" /><CodeLine lineNumber="189"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00190" /><CodeLine lineNumber="190"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00191" /><CodeLine lineNumber="191"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a5ea78fa6f9e8732fc336ad0739d3e76e">blake3&#95;hash&#95;many</a>(chunks&#95;array, chunks&#95;array&#95;len,</Highlight></CodeLine>
<Link id="l00192" /><CodeLine lineNumber="192"><Highlight kind="normal">                   <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a> / <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>, key, chunk&#95;counter,</Highlight></CodeLine>
<Link id="l00193" /><CodeLine lineNumber="193"><Highlight kind="normal">                   </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, flags, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cba1ee5b64a429be6a437f316619ccf377f">CHUNK&#95;START</a>, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cbad611fba49fcf900148ebefa6649d82fd">CHUNK&#95;END</a>, out);</Highlight></CodeLine>
<Link id="l00194" /><CodeLine lineNumber="194"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00195" /><CodeLine lineNumber="195"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Hash the remaining partial chunk, if there is one. Note that the empty</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00196" /><CodeLine lineNumber="196"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// chunk (meaning the empty message) is a different codepath.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00197" /><CodeLine lineNumber="197"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (input&#95;len &gt; input&#95;position) &#123;</Highlight></CodeLine>
<Link id="l00198" /><CodeLine lineNumber="198"><Highlight kind="normal">    uint64&#95;t counter = chunk&#95;counter + (uint64&#95;t)chunks&#95;array&#95;len;</Highlight></CodeLine>
<Link id="l00199" /><CodeLine lineNumber="199"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> chunk&#95;state;</Highlight></CodeLine>
<Link id="l00200" /><CodeLine lineNumber="200"><Highlight kind="normal">    <a href="#a4db94e2dcf16f8659a69b1636897baeb">chunk&#95;state&#95;init</a>(&amp;chunk&#95;state, key, flags);</Highlight></CodeLine>
<Link id="l00201" /><CodeLine lineNumber="201"><Highlight kind="normal">    chunk&#95;state.chunk&#95;counter = counter;</Highlight></CodeLine>
<Link id="l00202" /><CodeLine lineNumber="202"><Highlight kind="normal">    <a href="#a1c4270490e141bac2a6053af9ef01f6b">chunk&#95;state&#95;update</a>(&amp;chunk&#95;state, &amp;input&#91;input&#95;position&#93;,</Highlight></CodeLine>
<Link id="l00203" /><CodeLine lineNumber="203"><Highlight kind="normal">                       input&#95;len - input&#95;position);</Highlight></CodeLine>
<Link id="l00204" /><CodeLine lineNumber="204"><Highlight kind="normal">    <a href="/docs/api/structs/output-t">output&#95;t</a> output = <a href="#acc3e5ba813b5fb930b49c67f1edadf41">chunk&#95;state&#95;output</a>(&amp;chunk&#95;state);</Highlight></CodeLine>
<Link id="l00205" /><CodeLine lineNumber="205"><Highlight kind="normal">    <a href="#a92376f69320e66a51477df2b47088249">output&#95;chaining&#95;value</a>(&amp;output, &amp;out&#91;chunks&#95;array&#95;len &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;);</Highlight></CodeLine>
<Link id="l00206" /><CodeLine lineNumber="206"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> chunks&#95;array&#95;len + 1;</Highlight></CodeLine>
<Link id="l00207" /><CodeLine lineNumber="207"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00208" /><CodeLine lineNumber="208"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> chunks&#95;array&#95;len;</Highlight></CodeLine>
<Link id="l00209" /><CodeLine lineNumber="209"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00210" /><CodeLine lineNumber="210"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00211" /><CodeLine lineNumber="211"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00212" /><CodeLine lineNumber="212"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Use SIMD parallelism to hash up to MAX&#95;SIMD&#95;DEGREE parents at the same time</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00213" /><CodeLine lineNumber="213"><Highlight kind="normal"></Highlight><Highlight kind="comment">// on a single thread. Write out the parent chaining values and return the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00214" /><CodeLine lineNumber="214"><Highlight kind="normal"></Highlight><Highlight kind="comment">// number of parents hashed. (If there&#39;s an odd input chaining value left over,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00215" /><CodeLine lineNumber="215"><Highlight kind="normal"></Highlight><Highlight kind="comment">// return it as an additional output.) These parents are never the root and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00216" /><CodeLine lineNumber="216"><Highlight kind="normal"></Highlight><Highlight kind="comment">// never empty; those cases use a different codepath.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00217" /><CodeLine lineNumber="217" lineLink="#ab6b82b4dfe8b1cf5e6cdf18c4dd46097"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="#ab6b82b4dfe8b1cf5e6cdf18c4dd46097">compress&#95;parents&#95;parallel</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;child&#95;chaining&#95;values,</Highlight></CodeLine>
<Link id="l00218" /><CodeLine lineNumber="218"><Highlight kind="normal">                                        </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> num&#95;chaining&#95;values,</Highlight></CodeLine>
<Link id="l00219" /><CodeLine lineNumber="219"><Highlight kind="normal">                                        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t key&#91;8&#93;, uint8&#95;t flags,</Highlight></CodeLine>
<Link id="l00220" /><CodeLine lineNumber="220"><Highlight kind="normal">                                        uint8&#95;t &#42;out) &#123;</Highlight></CodeLine>
<Link id="l00221" /><CodeLine lineNumber="221"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if defined(BLAKE3&#95;TESTING)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00222" /><CodeLine lineNumber="222"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(2 &lt;= num&#95;chaining&#95;values);</Highlight></CodeLine>
<Link id="l00223" /><CodeLine lineNumber="223"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(num&#95;chaining&#95;values &lt;= 2 &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8ee4a6d154e907312d4a54eb962388da">MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2</a>);</Highlight></CodeLine>
<Link id="l00224" /><CodeLine lineNumber="224"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00225" /><CodeLine lineNumber="225"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00226" /><CodeLine lineNumber="226"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;parents&#95;array&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8ee4a6d154e907312d4a54eb962388da">MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2</a>&#93;;</Highlight></CodeLine>
<Link id="l00227" /><CodeLine lineNumber="227"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> parents&#95;array&#95;len = 0;</Highlight></CodeLine>
<Link id="l00228" /><CodeLine lineNumber="228"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (num&#95;chaining&#95;values - (2 &#42; parents&#95;array&#95;len) &gt;= 2) &#123;</Highlight></CodeLine>
<Link id="l00229" /><CodeLine lineNumber="229"><Highlight kind="normal">    parents&#95;array&#91;parents&#95;array&#95;len&#93; =</Highlight></CodeLine>
<Link id="l00230" /><CodeLine lineNumber="230"><Highlight kind="normal">        &amp;child&#95;chaining&#95;values&#91;2 &#42; parents&#95;array&#95;len &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00231" /><CodeLine lineNumber="231"><Highlight kind="normal">    parents&#95;array&#95;len += 1;</Highlight></CodeLine>
<Link id="l00232" /><CodeLine lineNumber="232"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00233" /><CodeLine lineNumber="233"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00234" /><CodeLine lineNumber="234"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a5ea78fa6f9e8732fc336ad0739d3e76e">blake3&#95;hash&#95;many</a>(parents&#95;array, parents&#95;array&#95;len, 1, key,</Highlight></CodeLine>
<Link id="l00235" /><CodeLine lineNumber="235"><Highlight kind="normal">                   0, </Highlight><Highlight kind="comment">// Parents always use counter 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00236" /><CodeLine lineNumber="236"><Highlight kind="normal">                   </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, flags | <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cba283df3974c567b21c067198a24cd78e6">PARENT</a>,</Highlight></CodeLine>
<Link id="l00237" /><CodeLine lineNumber="237"><Highlight kind="normal">                   0, </Highlight><Highlight kind="comment">// Parents have no start flags.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00238" /><CodeLine lineNumber="238"><Highlight kind="normal">                   0, </Highlight><Highlight kind="comment">// Parents have no end flags.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00239" /><CodeLine lineNumber="239"><Highlight kind="normal">                   out);</Highlight></CodeLine>
<Link id="l00240" /><CodeLine lineNumber="240"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00241" /><CodeLine lineNumber="241"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there&#39;s an odd child left over, it becomes an output.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00242" /><CodeLine lineNumber="242"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (num&#95;chaining&#95;values &gt; 2 &#42; parents&#95;array&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00243" /><CodeLine lineNumber="243"><Highlight kind="normal">    memcpy(&amp;out&#91;parents&#95;array&#95;len &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;,</Highlight></CodeLine>
<Link id="l00244" /><CodeLine lineNumber="244"><Highlight kind="normal">           &amp;child&#95;chaining&#95;values&#91;2 &#42; parents&#95;array&#95;len &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;,</Highlight></CodeLine>
<Link id="l00245" /><CodeLine lineNumber="245"><Highlight kind="normal">           <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00246" /><CodeLine lineNumber="246"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> parents&#95;array&#95;len + 1;</Highlight></CodeLine>
<Link id="l00247" /><CodeLine lineNumber="247"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00248" /><CodeLine lineNumber="248"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> parents&#95;array&#95;len;</Highlight></CodeLine>
<Link id="l00249" /><CodeLine lineNumber="249"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00250" /><CodeLine lineNumber="250"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00251" /><CodeLine lineNumber="251"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00252" /><CodeLine lineNumber="252"><Highlight kind="normal"></Highlight><Highlight kind="comment">// The wide helper function returns (writes out) an array of chaining values</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00253" /><CodeLine lineNumber="253"><Highlight kind="normal"></Highlight><Highlight kind="comment">// and returns the length of that array. The number of chaining values returned</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00254" /><CodeLine lineNumber="254"><Highlight kind="normal"></Highlight><Highlight kind="comment">// is the dyanmically detected SIMD degree, at most MAX&#95;SIMD&#95;DEGREE. Or fewer,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00255" /><CodeLine lineNumber="255"><Highlight kind="normal"></Highlight><Highlight kind="comment">// if the input is shorter than that many chunks. The reason for maintaining a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00256" /><CodeLine lineNumber="256"><Highlight kind="normal"></Highlight><Highlight kind="comment">// wide array of chaining values going back up the tree, is to allow the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00257" /><CodeLine lineNumber="257"><Highlight kind="normal"></Highlight><Highlight kind="comment">// implementation to hash as many parents in parallel as possible.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00258" /><CodeLine lineNumber="258"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00259" /><CodeLine lineNumber="259"><Highlight kind="normal"></Highlight><Highlight kind="comment">// As a special case when the SIMD degree is 1, this function will still return</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00260" /><CodeLine lineNumber="260"><Highlight kind="normal"></Highlight><Highlight kind="comment">// at least 2 outputs. This guarantees that this function doesn&#39;t perform the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00261" /><CodeLine lineNumber="261"><Highlight kind="normal"></Highlight><Highlight kind="comment">// root compression. (If it did, it would use the wrong flags, and also we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00262" /><CodeLine lineNumber="262"><Highlight kind="normal"></Highlight><Highlight kind="comment">// wouldn&#39;t be able to implement exendable ouput.) Note that this function is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00263" /><CodeLine lineNumber="263"><Highlight kind="normal"></Highlight><Highlight kind="comment">// not used when the whole input is only 1 chunk long; that&#39;s a different</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00264" /><CodeLine lineNumber="264"><Highlight kind="normal"></Highlight><Highlight kind="comment">// codepath.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00265" /><CodeLine lineNumber="265"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00266" /><CodeLine lineNumber="266"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Why not just have the caller split the input on the first update(), instead</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00267" /><CodeLine lineNumber="267"><Highlight kind="normal"></Highlight><Highlight kind="comment">// of implementing this special rule? Because we don&#39;t want to limit SIMD or</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00268" /><CodeLine lineNumber="268"><Highlight kind="normal"></Highlight><Highlight kind="comment">// multi-threading parallelism for that update().</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00269" /><CodeLine lineNumber="269" lineLink="#a6f1fd4d6d509893d09c8b8eb1aa5291c"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="#a6f1fd4d6d509893d09c8b8eb1aa5291c">blake3&#95;compress&#95;subtree&#95;wide</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;input,</Highlight></CodeLine>
<Link id="l00270" /><CodeLine lineNumber="270"><Highlight kind="normal">                                           </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> input&#95;len,</Highlight></CodeLine>
<Link id="l00271" /><CodeLine lineNumber="271"><Highlight kind="normal">                                           </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t key&#91;8&#93;,</Highlight></CodeLine>
<Link id="l00272" /><CodeLine lineNumber="272"><Highlight kind="normal">                                           uint64&#95;t chunk&#95;counter,</Highlight></CodeLine>
<Link id="l00273" /><CodeLine lineNumber="273"><Highlight kind="normal">                                           uint8&#95;t flags, uint8&#95;t &#42;out) &#123;</Highlight></CodeLine>
<Link id="l00274" /><CodeLine lineNumber="274"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Note that the single chunk case does &#42;not&#42; bump the SIMD degree up to 2</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00275" /><CodeLine lineNumber="275"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// when it is 1 If this implementation adds multi-threading in the future,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00276" /><CodeLine lineNumber="276"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// this gives us the option of multi-threading even the 2-chunk case, which</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00277" /><CodeLine lineNumber="277"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// can help performance on smaller platforms.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00278" /><CodeLine lineNumber="278"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (input&#95;len &lt;= <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a6e3c3e900f34e7af779867b28b54336d">blake3&#95;simd&#95;degree</a>() &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>) &#123;</Highlight></CodeLine>
<Link id="l00279" /><CodeLine lineNumber="279"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a5b7c95b4370497f963cb03981f87613f">compress&#95;chunks&#95;parallel</a>(input, input&#95;len, key, chunk&#95;counter, flags,</Highlight></CodeLine>
<Link id="l00280" /><CodeLine lineNumber="280"><Highlight kind="normal">                                    out);</Highlight></CodeLine>
<Link id="l00281" /><CodeLine lineNumber="281"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00282" /><CodeLine lineNumber="282"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00283" /><CodeLine lineNumber="283"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// With more than simd&#95;degree chunks, we need to recurse. Start by dividing</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00284" /><CodeLine lineNumber="284"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the input into left and right subtrees. (Note that this is only optimal</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00285" /><CodeLine lineNumber="285"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// as long as the SIMD degree is a power of 2 If we ever get a SIMD degree</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00286" /><CodeLine lineNumber="286"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// of 3 or something, we&#39;ll need a more complicated strategy.)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00287" /><CodeLine lineNumber="287"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> left&#95;input&#95;len = <a href="#af1487a6d4f0aec866d05311a3e42ab30">left&#95;len</a>(input&#95;len);</Highlight></CodeLine>
<Link id="l00288" /><CodeLine lineNumber="288"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> right&#95;input&#95;len = input&#95;len - left&#95;input&#95;len;</Highlight></CodeLine>
<Link id="l00289" /><CodeLine lineNumber="289"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;right&#95;input = &amp;input&#91;left&#95;input&#95;len&#93;;</Highlight></CodeLine>
<Link id="l00290" /><CodeLine lineNumber="290"><Highlight kind="normal">  uint64&#95;t right&#95;chunk&#95;counter =</Highlight></CodeLine>
<Link id="l00291" /><CodeLine lineNumber="291"><Highlight kind="normal">      chunk&#95;counter + (uint64&#95;t)(left&#95;input&#95;len / <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00292" /><CodeLine lineNumber="292"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00293" /><CodeLine lineNumber="293"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Make space for the child outputs. Here we use MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2 to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00294" /><CodeLine lineNumber="294"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// account for the special case of returning 2 outputs when the SIMD degree</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00295" /><CodeLine lineNumber="295"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// is 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00296" /><CodeLine lineNumber="296"><Highlight kind="normal">  uint8&#95;t cv&#95;array&#91;2 &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8ee4a6d154e907312d4a54eb962388da">MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2</a> &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00297" /><CodeLine lineNumber="297"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> degree = <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a6e3c3e900f34e7af779867b28b54336d">blake3&#95;simd&#95;degree</a>();</Highlight></CodeLine>
<Link id="l00298" /><CodeLine lineNumber="298"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (left&#95;input&#95;len &gt; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a> &amp;&amp; degree == 1) &#123;</Highlight></CodeLine>
<Link id="l00299" /><CodeLine lineNumber="299"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The special case: We always use a degree of at least two, to make</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00300" /><CodeLine lineNumber="300"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// sure there are two outputs. Except, as noted above, at the chunk</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00301" /><CodeLine lineNumber="301"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// level, where we allow degree=1. (Note that the 1-chunk-input case is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00302" /><CodeLine lineNumber="302"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// a different codepath.)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00303" /><CodeLine lineNumber="303"><Highlight kind="normal">    degree = 2;</Highlight></CodeLine>
<Link id="l00304" /><CodeLine lineNumber="304"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00305" /><CodeLine lineNumber="305"><Highlight kind="normal">  uint8&#95;t &#42;right&#95;cvs = &amp;cv&#95;array&#91;degree &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00306" /><CodeLine lineNumber="306"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00307" /><CodeLine lineNumber="307"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Recurse! If this implementation adds multi-threading support in the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00308" /><CodeLine lineNumber="308"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// future, this is where it will go.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00309" /><CodeLine lineNumber="309"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> left&#95;n = <a href="#a6f1fd4d6d509893d09c8b8eb1aa5291c">blake3&#95;compress&#95;subtree&#95;wide</a>(input, left&#95;input&#95;len, key,</Highlight></CodeLine>
<Link id="l00310" /><CodeLine lineNumber="310"><Highlight kind="normal">                                               chunk&#95;counter, flags, cv&#95;array);</Highlight></CodeLine>
<Link id="l00311" /><CodeLine lineNumber="311"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> right&#95;n = <a href="#a6f1fd4d6d509893d09c8b8eb1aa5291c">blake3&#95;compress&#95;subtree&#95;wide</a>(</Highlight></CodeLine>
<Link id="l00312" /><CodeLine lineNumber="312"><Highlight kind="normal">      right&#95;input, right&#95;input&#95;len, key, right&#95;chunk&#95;counter, flags, right&#95;cvs);</Highlight></CodeLine>
<Link id="l00313" /><CodeLine lineNumber="313"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00314" /><CodeLine lineNumber="314"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The special case again. If simd&#95;degree=1, then we&#39;ll have left&#95;n=1 and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00315" /><CodeLine lineNumber="315"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// right&#95;n=1. Rather than compressing them into a single output, return</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00316" /><CodeLine lineNumber="316"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// them directly, to make sure we always have at least two outputs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00317" /><CodeLine lineNumber="317"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (left&#95;n == 1) &#123;</Highlight></CodeLine>
<Link id="l00318" /><CodeLine lineNumber="318"><Highlight kind="normal">    memcpy(out, cv&#95;array, 2 &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00319" /><CodeLine lineNumber="319"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 2;</Highlight></CodeLine>
<Link id="l00320" /><CodeLine lineNumber="320"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00321" /><CodeLine lineNumber="321"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00322" /><CodeLine lineNumber="322"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Otherwise, do one layer of parent node compression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00323" /><CodeLine lineNumber="323"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> num&#95;chaining&#95;values = left&#95;n + right&#95;n;</Highlight></CodeLine>
<Link id="l00324" /><CodeLine lineNumber="324"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#ab6b82b4dfe8b1cf5e6cdf18c4dd46097">compress&#95;parents&#95;parallel</a>(cv&#95;array, num&#95;chaining&#95;values, key, flags,</Highlight></CodeLine>
<Link id="l00325" /><CodeLine lineNumber="325"><Highlight kind="normal">                                   out);</Highlight></CodeLine>
<Link id="l00326" /><CodeLine lineNumber="326"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00327" /><CodeLine lineNumber="327"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00328" /><CodeLine lineNumber="328"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Hash a subtree with compress&#95;subtree&#95;wide(), and then condense the resulting</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00329" /><CodeLine lineNumber="329"><Highlight kind="normal"></Highlight><Highlight kind="comment">// list of chaining values down to a single parent node. Don&#39;t compress that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00330" /><CodeLine lineNumber="330"><Highlight kind="normal"></Highlight><Highlight kind="comment">// last parent node, however. Instead, return its message bytes (the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00331" /><CodeLine lineNumber="331"><Highlight kind="normal"></Highlight><Highlight kind="comment">// concatenated chaining values of its children). This is necessary when the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00332" /><CodeLine lineNumber="332"><Highlight kind="normal"></Highlight><Highlight kind="comment">// first call to update() supplies a complete subtree, because the topmost</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00333" /><CodeLine lineNumber="333"><Highlight kind="normal"></Highlight><Highlight kind="comment">// parent node of that subtree could end up being the root. It&#39;s also necessary</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00334" /><CodeLine lineNumber="334"><Highlight kind="normal"></Highlight><Highlight kind="comment">// for extended output in the general case.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00335" /><CodeLine lineNumber="335"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00336" /><CodeLine lineNumber="336"><Highlight kind="normal"></Highlight><Highlight kind="comment">// As with compress&#95;subtree&#95;wide(), this function is not used on inputs of 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00337" /><CodeLine lineNumber="337"><Highlight kind="normal"></Highlight><Highlight kind="comment">// chunk or less. That&#39;s a different codepath.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00338" /><CodeLine lineNumber="338" lineLink="#abd0aa960e3f0e3ebab8baccea1f3808a"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#abd0aa960e3f0e3ebab8baccea1f3808a">compress&#95;subtree&#95;to&#95;parent&#95;node</a>(</Highlight></CodeLine>
<Link id="l00339" /><CodeLine lineNumber="339"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;input, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> input&#95;len, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t key&#91;8&#93;,</Highlight></CodeLine>
<Link id="l00340" /><CodeLine lineNumber="340"><Highlight kind="normal">    uint64&#95;t chunk&#95;counter, uint8&#95;t flags, uint8&#95;t out&#91;2 &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;) &#123;</Highlight></CodeLine>
<Link id="l00341" /><CodeLine lineNumber="341"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if defined(BLAKE3&#95;TESTING)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00342" /><CodeLine lineNumber="342"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(input&#95;len &gt; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00343" /><CodeLine lineNumber="343"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00344" /><CodeLine lineNumber="344"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00345" /><CodeLine lineNumber="345"><Highlight kind="normal">  uint8&#95;t cv&#95;array&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8ee4a6d154e907312d4a54eb962388da">MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2</a> &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00346" /><CodeLine lineNumber="346"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> num&#95;cvs = <a href="#a6f1fd4d6d509893d09c8b8eb1aa5291c">blake3&#95;compress&#95;subtree&#95;wide</a>(input, input&#95;len, key,</Highlight></CodeLine>
<Link id="l00347" /><CodeLine lineNumber="347"><Highlight kind="normal">                                                chunk&#95;counter, flags, cv&#95;array);</Highlight></CodeLine>
<Link id="l00348" /><CodeLine lineNumber="348"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(num&#95;cvs &lt;= <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8ee4a6d154e907312d4a54eb962388da">MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2</a>);</Highlight></CodeLine>
<Link id="l00349" /><CodeLine lineNumber="349"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00350" /><CodeLine lineNumber="350"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If MAX&#95;SIMD&#95;DEGREE is greater than 2 and there&#39;s enough input,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00351" /><CodeLine lineNumber="351"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// compress&#95;subtree&#95;wide() returns more than 2 chaining values. Condense</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00352" /><CodeLine lineNumber="352"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// them into 2 by forming parent nodes repeatedly.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00353" /><CodeLine lineNumber="353"><Highlight kind="normal">  uint8&#95;t out&#95;array&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8ee4a6d154e907312d4a54eb962388da">MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2</a> &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a> / 2&#93;;</Highlight></CodeLine>
<Link id="l00354" /><CodeLine lineNumber="354"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The second half of this loop condition is always true, and we just</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00355" /><CodeLine lineNumber="355"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// asserted it above. But GCC can&#39;t tell that it&#39;s always true, and if NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00356" /><CodeLine lineNumber="356"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// is set on platforms where MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2 == 2, GCC emits spurious</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00357" /><CodeLine lineNumber="357"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// warnings here. GCC 8.5 is particularly sensitive, so if you&#39;re changing</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00358" /><CodeLine lineNumber="358"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// this code, test it against that version.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00359" /><CodeLine lineNumber="359"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (num&#95;cvs &gt; 2 &amp;&amp; num&#95;cvs &lt;= <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8ee4a6d154e907312d4a54eb962388da">MAX&#95;SIMD&#95;DEGREE&#95;OR&#95;2</a>) &#123;</Highlight></CodeLine>
<Link id="l00360" /><CodeLine lineNumber="360"><Highlight kind="normal">    num&#95;cvs =</Highlight></CodeLine>
<Link id="l00361" /><CodeLine lineNumber="361"><Highlight kind="normal">        <a href="#ab6b82b4dfe8b1cf5e6cdf18c4dd46097">compress&#95;parents&#95;parallel</a>(cv&#95;array, num&#95;cvs, key, flags, out&#95;array);</Highlight></CodeLine>
<Link id="l00362" /><CodeLine lineNumber="362"><Highlight kind="normal">    memcpy(cv&#95;array, out&#95;array, num&#95;cvs &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00363" /><CodeLine lineNumber="363"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00364" /><CodeLine lineNumber="364"><Highlight kind="normal">  memcpy(out, cv&#95;array, 2 &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00365" /><CodeLine lineNumber="365"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00366" /><CodeLine lineNumber="366"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00367" /><CodeLine lineNumber="367" lineLink="#a3b12f6c109442edaa63ab03ba8a6caec"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a3b12f6c109442edaa63ab03ba8a6caec">hasher&#95;init&#95;base</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint32&#95;t key&#91;8&#93;,</Highlight></CodeLine>
<Link id="l00368" /><CodeLine lineNumber="368"><Highlight kind="normal">                             uint8&#95;t flags) &#123;</Highlight></CodeLine>
<Link id="l00369" /><CodeLine lineNumber="369"><Highlight kind="normal">  memcpy(self-&gt;key, key, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a947bd80c6cdcbd362dd0760f3603abe6">BLAKE3&#95;KEY&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00370" /><CodeLine lineNumber="370"><Highlight kind="normal">  <a href="#a4db94e2dcf16f8659a69b1636897baeb">chunk&#95;state&#95;init</a>(&amp;self-&gt;chunk, key, flags);</Highlight></CodeLine>
<Link id="l00371" /><CodeLine lineNumber="371"><Highlight kind="normal">  self-&gt;cv&#95;stack&#95;len = 0;</Highlight></CodeLine>
<Link id="l00372" /><CodeLine lineNumber="372"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00373" /><CodeLine lineNumber="373"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00374" /><CodeLine lineNumber="374" lineLink="#a3723853888e765d1049d9f3b9e48dfed"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a3723853888e765d1049d9f3b9e48dfed">llvm&#95;blake3&#95;hasher&#95;init</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self) &#123; <a href="#a3b12f6c109442edaa63ab03ba8a6caec">hasher&#95;init&#95;base</a>(self, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>, 0); &#125;</Highlight></CodeLine>
<Link id="l00375" /><CodeLine lineNumber="375"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00376" /><CodeLine lineNumber="376" lineLink="#ac4c4231fe195d56ec58b572d0badc2e6"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#ac4c4231fe195d56ec58b572d0badc2e6">llvm&#95;blake3&#95;hasher&#95;init&#95;keyed</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self,</Highlight></CodeLine>
<Link id="l00377" /><CodeLine lineNumber="377"><Highlight kind="normal">                              </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t key&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a947bd80c6cdcbd362dd0760f3603abe6">BLAKE3&#95;KEY&#95;LEN</a>&#93;) &#123;</Highlight></CodeLine>
<Link id="l00378" /><CodeLine lineNumber="378"><Highlight kind="normal">  uint32&#95;t key&#95;words&#91;8&#93;;</Highlight></CodeLine>
<Link id="l00379" /><CodeLine lineNumber="379"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8b7b7d6918ecd7ddb8669390f1a321f4">load&#95;key&#95;words</a>(key, key&#95;words);</Highlight></CodeLine>
<Link id="l00380" /><CodeLine lineNumber="380"><Highlight kind="normal">  <a href="#a3b12f6c109442edaa63ab03ba8a6caec">hasher&#95;init&#95;base</a>(self, key&#95;words, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cba372c16918d756eb61949611abeb28fa5">KEYED&#95;HASH</a>);</Highlight></CodeLine>
<Link id="l00381" /><CodeLine lineNumber="381"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00382" /><CodeLine lineNumber="382"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00383" /><CodeLine lineNumber="383" lineLink="#acf30a68b4c258e1c1af255c60e880aac"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#acf30a68b4c258e1c1af255c60e880aac">llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key&#95;raw</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> &#42;context,</Highlight></CodeLine>
<Link id="l00384" /><CodeLine lineNumber="384"><Highlight kind="normal">                                       </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> context&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00385" /><CodeLine lineNumber="385"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> context&#95;hasher;</Highlight></CodeLine>
<Link id="l00386" /><CodeLine lineNumber="386"><Highlight kind="normal">  <a href="#a3b12f6c109442edaa63ab03ba8a6caec">hasher&#95;init&#95;base</a>(&amp;context&#95;hasher, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cba891ca3ed53dd8464f1aa3bc5ca792cce">DERIVE&#95;KEY&#95;CONTEXT</a>);</Highlight></CodeLine>
<Link id="l00387" /><CodeLine lineNumber="387"><Highlight kind="normal">  <a href="#a63f3b0c97048b549ce37f5e6a4da701d">llvm&#95;blake3&#95;hasher&#95;update</a>(&amp;context&#95;hasher, context, context&#95;len);</Highlight></CodeLine>
<Link id="l00388" /><CodeLine lineNumber="388"><Highlight kind="normal">  uint8&#95;t context&#95;key&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a947bd80c6cdcbd362dd0760f3603abe6">BLAKE3&#95;KEY&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00389" /><CodeLine lineNumber="389"><Highlight kind="normal">  <a href="#a6f1551c11ac8a08c294ee4bf7bf08623">llvm&#95;blake3&#95;hasher&#95;finalize</a>(&amp;context&#95;hasher, context&#95;key, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a947bd80c6cdcbd362dd0760f3603abe6">BLAKE3&#95;KEY&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00390" /><CodeLine lineNumber="390"><Highlight kind="normal">  uint32&#95;t context&#95;key&#95;words&#91;8&#93;;</Highlight></CodeLine>
<Link id="l00391" /><CodeLine lineNumber="391"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a8b7b7d6918ecd7ddb8669390f1a321f4">load&#95;key&#95;words</a>(context&#95;key, context&#95;key&#95;words);</Highlight></CodeLine>
<Link id="l00392" /><CodeLine lineNumber="392"><Highlight kind="normal">  <a href="#a3b12f6c109442edaa63ab03ba8a6caec">hasher&#95;init&#95;base</a>(self, context&#95;key&#95;words, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#af1f12c808c513e84d39a88930812b5cba399b62381341913e02639d8e1d3e8744">DERIVE&#95;KEY&#95;MATERIAL</a>);</Highlight></CodeLine>
<Link id="l00393" /><CodeLine lineNumber="393"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00394" /><CodeLine lineNumber="394"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00395" /><CodeLine lineNumber="395" lineLink="#ad0b8fa0cf17c5aa764845fbd3739c85b"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#ad0b8fa0cf17c5aa764845fbd3739c85b">llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">char</Highlight><Highlight kind="normal"> &#42;context) &#123;</Highlight></CodeLine>
<Link id="l00396" /><CodeLine lineNumber="396"><Highlight kind="normal">  <a href="#acf30a68b4c258e1c1af255c60e880aac">llvm&#95;blake3&#95;hasher&#95;init&#95;derive&#95;key&#95;raw</a>(self, context, strlen(context));</Highlight></CodeLine>
<Link id="l00397" /><CodeLine lineNumber="397"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00398" /><CodeLine lineNumber="398"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00399" /><CodeLine lineNumber="399"><Highlight kind="normal"></Highlight><Highlight kind="comment">// As described in hasher&#95;push&#95;cv() below, we do &quot;lazy merging&quot;, delaying</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00400" /><CodeLine lineNumber="400"><Highlight kind="normal"></Highlight><Highlight kind="comment">// merges until right before the next CV is about to be added. This is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00401" /><CodeLine lineNumber="401"><Highlight kind="normal"></Highlight><Highlight kind="comment">// different from the reference implementation. Another difference is that we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00402" /><CodeLine lineNumber="402"><Highlight kind="normal"></Highlight><Highlight kind="comment">// aren&#39;t always merging 1 chunk at a time. Instead, each CV might represent</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00403" /><CodeLine lineNumber="403"><Highlight kind="normal"></Highlight><Highlight kind="comment">// any power-of-two number of chunks, as long as the smaller-above-larger stack</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00404" /><CodeLine lineNumber="404"><Highlight kind="normal"></Highlight><Highlight kind="comment">// order is maintained. Instead of the &quot;count the trailing 0-bits&quot; algorithm</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00405" /><CodeLine lineNumber="405"><Highlight kind="normal"></Highlight><Highlight kind="comment">// described in the spec, we use a &quot;count the total number of 1-bits&quot; variant</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00406" /><CodeLine lineNumber="406"><Highlight kind="normal"></Highlight><Highlight kind="comment">// that doesn&#39;t require us to retain the subtree size of the CV on top of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00407" /><CodeLine lineNumber="407"><Highlight kind="normal"></Highlight><Highlight kind="comment">// stack. The principle is the same: each CV that should remain in the stack is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00408" /><CodeLine lineNumber="408"><Highlight kind="normal"></Highlight><Highlight kind="comment">// represented by a 1-bit in the total number of chunks (or bytes) so far.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00409" /><CodeLine lineNumber="409" lineLink="#a63183e27546bc2e072233e0268400e83"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a63183e27546bc2e072233e0268400e83">hasher&#95;merge&#95;cv&#95;stack</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self, uint64&#95;t total&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00410" /><CodeLine lineNumber="410"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> post&#95;merge&#95;stack&#95;len = (size&#95;t)<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a1817d7ef688b133f9befd300d9e971a0">popcnt</a>(total&#95;len);</Highlight></CodeLine>
<Link id="l00411" /><CodeLine lineNumber="411"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (self-&gt;cv&#95;stack&#95;len &gt; post&#95;merge&#95;stack&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00412" /><CodeLine lineNumber="412"><Highlight kind="normal">    uint8&#95;t &#42;parent&#95;node =</Highlight></CodeLine>
<Link id="l00413" /><CodeLine lineNumber="413"><Highlight kind="normal">        &amp;self-&gt;cv&#95;stack&#91;(self-&gt;cv&#95;stack&#95;len - 2) &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00414" /><CodeLine lineNumber="414"><Highlight kind="normal">    <a href="/docs/api/structs/output-t">output&#95;t</a> output = <a href="#ab18874614dade172d2726abc3e88d480">parent&#95;output</a>(parent&#95;node, self-&gt;key, self-&gt;chunk.flags);</Highlight></CodeLine>
<Link id="l00415" /><CodeLine lineNumber="415"><Highlight kind="normal">    <a href="#a92376f69320e66a51477df2b47088249">output&#95;chaining&#95;value</a>(&amp;output, parent&#95;node);</Highlight></CodeLine>
<Link id="l00416" /><CodeLine lineNumber="416"><Highlight kind="normal">    self-&gt;cv&#95;stack&#95;len -= 1;</Highlight></CodeLine>
<Link id="l00417" /><CodeLine lineNumber="417"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00418" /><CodeLine lineNumber="418"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00419" /><CodeLine lineNumber="419"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00420" /><CodeLine lineNumber="420"><Highlight kind="normal"></Highlight><Highlight kind="comment">// In reference&#95;impl.rs, we merge the new CV with existing CVs from the stack</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00421" /><CodeLine lineNumber="421"><Highlight kind="normal"></Highlight><Highlight kind="comment">// before pushing it. We can do that because we know more input is coming, so</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00422" /><CodeLine lineNumber="422"><Highlight kind="normal"></Highlight><Highlight kind="comment">// we know none of the merges are root.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00423" /><CodeLine lineNumber="423"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00424" /><CodeLine lineNumber="424"><Highlight kind="normal"></Highlight><Highlight kind="comment">// This setting is different. We want to feed as much input as possible to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00425" /><CodeLine lineNumber="425"><Highlight kind="normal"></Highlight><Highlight kind="comment">// compress&#95;subtree&#95;wide(), without setting aside anything for the chunk&#95;state.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00426" /><CodeLine lineNumber="426"><Highlight kind="normal"></Highlight><Highlight kind="comment">// If the user gives us 64 KiB, we want to parallelize over all 64 KiB at once</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00427" /><CodeLine lineNumber="427"><Highlight kind="normal"></Highlight><Highlight kind="comment">// as a single subtree, if at all possible.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00428" /><CodeLine lineNumber="428"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00429" /><CodeLine lineNumber="429"><Highlight kind="normal"></Highlight><Highlight kind="comment">// This leads to two problems:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00430" /><CodeLine lineNumber="430"><Highlight kind="normal"></Highlight><Highlight kind="comment">// 1) This 64 KiB input might be the only call that ever gets made to update.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00431" /><CodeLine lineNumber="431"><Highlight kind="normal"></Highlight><Highlight kind="comment">//    In this case, the root node of the 64 KiB subtree would be the root node</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00432" /><CodeLine lineNumber="432"><Highlight kind="normal"></Highlight><Highlight kind="comment">//    of the whole tree, and it would need to be ROOT finalized. We can&#39;t</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00433" /><CodeLine lineNumber="433"><Highlight kind="normal"></Highlight><Highlight kind="comment">//    compress it until we know.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00434" /><CodeLine lineNumber="434"><Highlight kind="normal"></Highlight><Highlight kind="comment">// 2) This 64 KiB input might complete a larger tree, whose root node is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00435" /><CodeLine lineNumber="435"><Highlight kind="normal"></Highlight><Highlight kind="comment">//    similarly going to be the the root of the whole tree. For example, maybe</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00436" /><CodeLine lineNumber="436"><Highlight kind="normal"></Highlight><Highlight kind="comment">//    we have 196 KiB (that is, 128 + 64) hashed so far. We can&#39;t compress the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00437" /><CodeLine lineNumber="437"><Highlight kind="normal"></Highlight><Highlight kind="comment">//    node at the root of the 256 KiB subtree until we know how to finalize it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00438" /><CodeLine lineNumber="438"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00439" /><CodeLine lineNumber="439"><Highlight kind="normal"></Highlight><Highlight kind="comment">// The second problem is solved with &quot;lazy merging&quot;. That is, when we&#39;re about</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00440" /><CodeLine lineNumber="440"><Highlight kind="normal"></Highlight><Highlight kind="comment">// to add a CV to the stack, we don&#39;t merge it with anything first, as the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00441" /><CodeLine lineNumber="441"><Highlight kind="normal"></Highlight><Highlight kind="comment">// reference impl does. Instead we do merges using the &#42;previous&#42; CV that was</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00442" /><CodeLine lineNumber="442"><Highlight kind="normal"></Highlight><Highlight kind="comment">// added, which is sitting on top of the stack, and we put the new CV</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00443" /><CodeLine lineNumber="443"><Highlight kind="normal"></Highlight><Highlight kind="comment">// (unmerged) on top of the stack afterwards. This guarantees that we never</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00444" /><CodeLine lineNumber="444"><Highlight kind="normal"></Highlight><Highlight kind="comment">// merge the root node until finalize().</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00445" /><CodeLine lineNumber="445"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00446" /><CodeLine lineNumber="446"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Solving the first problem requires an additional tool,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00447" /><CodeLine lineNumber="447"><Highlight kind="normal"></Highlight><Highlight kind="comment">// compress&#95;subtree&#95;to&#95;parent&#95;node(). That function always returns the top</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00448" /><CodeLine lineNumber="448"><Highlight kind="normal"></Highlight><Highlight kind="comment">// &#42;two&#42; chaining values of the subtree it&#39;s compressing. We then do lazy</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00449" /><CodeLine lineNumber="449"><Highlight kind="normal"></Highlight><Highlight kind="comment">// merging with each of them separately, so that the second CV will always</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00450" /><CodeLine lineNumber="450"><Highlight kind="normal"></Highlight><Highlight kind="comment">// remain unmerged. (That also helps us support extendable output when we&#39;re</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00451" /><CodeLine lineNumber="451"><Highlight kind="normal"></Highlight><Highlight kind="comment">// hashing an input all-at-once.)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00452" /><CodeLine lineNumber="452" lineLink="#ae7004860c25afdef231d29688cfdb2ff"><Highlight kind="normal"><a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a2eb6f9e0395b47b8d5e3eeae4fe0c116">INLINE</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#ae7004860c25afdef231d29688cfdb2ff">hasher&#95;push&#95;cv</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self, uint8&#95;t new&#95;cv&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;,</Highlight></CodeLine>
<Link id="l00453" /><CodeLine lineNumber="453"><Highlight kind="normal">                           uint64&#95;t chunk&#95;counter) &#123;</Highlight></CodeLine>
<Link id="l00454" /><CodeLine lineNumber="454"><Highlight kind="normal">  <a href="#a63183e27546bc2e072233e0268400e83">hasher&#95;merge&#95;cv&#95;stack</a>(self, chunk&#95;counter);</Highlight></CodeLine>
<Link id="l00455" /><CodeLine lineNumber="455"><Highlight kind="normal">  memcpy(&amp;self-&gt;cv&#95;stack&#91;self-&gt;cv&#95;stack&#95;len &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;, new&#95;cv,</Highlight></CodeLine>
<Link id="l00456" /><CodeLine lineNumber="456"><Highlight kind="normal">         <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>);</Highlight></CodeLine>
<Link id="l00457" /><CodeLine lineNumber="457"><Highlight kind="normal">  self-&gt;cv&#95;stack&#95;len += 1;</Highlight></CodeLine>
<Link id="l00458" /><CodeLine lineNumber="458"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00459" /><CodeLine lineNumber="459"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00460" /><CodeLine lineNumber="460" lineLink="#a63f3b0c97048b549ce37f5e6a4da701d"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a63f3b0c97048b549ce37f5e6a4da701d">llvm&#95;blake3&#95;hasher&#95;update</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> &#42;input,</Highlight></CodeLine>
<Link id="l00461" /><CodeLine lineNumber="461"><Highlight kind="normal">                          </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> input&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00462" /><CodeLine lineNumber="462"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Explicitly checking for zero avoids causing UB by passing a null pointer</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00463" /><CodeLine lineNumber="463"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to memcpy. This comes up in practice with things like:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00464" /><CodeLine lineNumber="464"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   std::vector&lt;uint8&#95;t&gt; v;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00465" /><CodeLine lineNumber="465"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   blake3&#95;hasher&#95;update(&amp;hasher, v.data(), v.size());</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00466" /><CodeLine lineNumber="466"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (input&#95;len == 0) &#123;</Highlight></CodeLine>
<Link id="l00467" /><CodeLine lineNumber="467"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00468" /><CodeLine lineNumber="468"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00469" /><CodeLine lineNumber="469"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00470" /><CodeLine lineNumber="470"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;input&#95;bytes = (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> uint8&#95;t &#42;)input;</Highlight></CodeLine>
<Link id="l00471" /><CodeLine lineNumber="471"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00472" /><CodeLine lineNumber="472"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we have some partial chunk bytes in the internal chunk&#95;state, we need</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00473" /><CodeLine lineNumber="473"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to finish that chunk first.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00474" /><CodeLine lineNumber="474"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a2c1ba208c88f9efdc6702769ecd006da">chunk&#95;state&#95;len</a>(&amp;self-&gt;chunk) &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l00475" /><CodeLine lineNumber="475"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> take = <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a> - <a href="#a2c1ba208c88f9efdc6702769ecd006da">chunk&#95;state&#95;len</a>(&amp;self-&gt;chunk);</Highlight></CodeLine>
<Link id="l00476" /><CodeLine lineNumber="476"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (take &gt; input&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00477" /><CodeLine lineNumber="477"><Highlight kind="normal">      take = input&#95;len;</Highlight></CodeLine>
<Link id="l00478" /><CodeLine lineNumber="478"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00479" /><CodeLine lineNumber="479"><Highlight kind="normal">    <a href="#a1c4270490e141bac2a6053af9ef01f6b">chunk&#95;state&#95;update</a>(&amp;self-&gt;chunk, input&#95;bytes, take);</Highlight></CodeLine>
<Link id="l00480" /><CodeLine lineNumber="480"><Highlight kind="normal">    input&#95;bytes += take;</Highlight></CodeLine>
<Link id="l00481" /><CodeLine lineNumber="481"><Highlight kind="normal">    input&#95;len -= take;</Highlight></CodeLine>
<Link id="l00482" /><CodeLine lineNumber="482"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If we&#39;ve filled the current chunk and there&#39;s more coming, finalize this</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00483" /><CodeLine lineNumber="483"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// chunk and proceed. In this case we know it&#39;s not the root.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00484" /><CodeLine lineNumber="484"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (input&#95;len &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l00485" /><CodeLine lineNumber="485"><Highlight kind="normal">      <a href="/docs/api/structs/output-t">output&#95;t</a> output = <a href="#acc3e5ba813b5fb930b49c67f1edadf41">chunk&#95;state&#95;output</a>(&amp;self-&gt;chunk);</Highlight></CodeLine>
<Link id="l00486" /><CodeLine lineNumber="486"><Highlight kind="normal">      uint8&#95;t chunk&#95;cv&#91;32&#93;;</Highlight></CodeLine>
<Link id="l00487" /><CodeLine lineNumber="487"><Highlight kind="normal">      <a href="#a92376f69320e66a51477df2b47088249">output&#95;chaining&#95;value</a>(&amp;output, chunk&#95;cv);</Highlight></CodeLine>
<Link id="l00488" /><CodeLine lineNumber="488"><Highlight kind="normal">      <a href="#ae7004860c25afdef231d29688cfdb2ff">hasher&#95;push&#95;cv</a>(self, chunk&#95;cv, self-&gt;chunk.chunk&#95;counter);</Highlight></CodeLine>
<Link id="l00489" /><CodeLine lineNumber="489"><Highlight kind="normal">      <a href="#ac3fec0f8016731502a8a1ad30cea4f3d">chunk&#95;state&#95;reset</a>(&amp;self-&gt;chunk, self-&gt;key, self-&gt;chunk.chunk&#95;counter + 1);</Highlight></CodeLine>
<Link id="l00490" /><CodeLine lineNumber="490"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00491" /><CodeLine lineNumber="491"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00492" /><CodeLine lineNumber="492"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00493" /><CodeLine lineNumber="493"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00494" /><CodeLine lineNumber="494"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00495" /><CodeLine lineNumber="495"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Now the chunk&#95;state is clear, and we have more input. If there&#39;s more than</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00496" /><CodeLine lineNumber="496"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// a single chunk (so, definitely not the root chunk), hash the largest whole</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00497" /><CodeLine lineNumber="497"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// subtree we can, with the full benefits of SIMD (and maybe in the future,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00498" /><CodeLine lineNumber="498"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// multi-threading) parallelism. Two restrictions:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00499" /><CodeLine lineNumber="499"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// - The subtree has to be a power-of-2 number of chunks. Only subtrees along</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00500" /><CodeLine lineNumber="500"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   the right edge can be incomplete, and we don&#39;t know where the right edge</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00501" /><CodeLine lineNumber="501"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   is going to be until we get to finalize().</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00502" /><CodeLine lineNumber="502"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// - The subtree must evenly divide the total number of chunks up until this</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00503" /><CodeLine lineNumber="503"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   point (if total is not 0). If the current incomplete subtree is only</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00504" /><CodeLine lineNumber="504"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   waiting for 1 more chunk, we can&#39;t hash a subtree of 4 chunks. We have</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00505" /><CodeLine lineNumber="505"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   to complete the current subtree first.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00506" /><CodeLine lineNumber="506"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Because we might need to break up the input to form powers of 2, or to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00507" /><CodeLine lineNumber="507"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// evenly divide what we already have, this part runs in a loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00508" /><CodeLine lineNumber="508"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (input&#95;len &gt; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>) &#123;</Highlight></CodeLine>
<Link id="l00509" /><CodeLine lineNumber="509"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> subtree&#95;len = <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#aa512c33323d4cb6599016c57337832fe">round&#95;down&#95;to&#95;power&#95;of&#95;2</a>(input&#95;len);</Highlight></CodeLine>
<Link id="l00510" /><CodeLine lineNumber="510"><Highlight kind="normal">    uint64&#95;t count&#95;so&#95;far = self-&gt;chunk.chunk&#95;counter &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>;</Highlight></CodeLine>
<Link id="l00511" /><CodeLine lineNumber="511"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Shrink the subtree&#95;len until it evenly divides the count so far. We know</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00512" /><CodeLine lineNumber="512"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// that subtree&#95;len itself is a power of 2, so we can use a bitmasking</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00513" /><CodeLine lineNumber="513"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// trick instead of an actual remainder operation. (Note that if the caller</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00514" /><CodeLine lineNumber="514"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// consistently passes power-of-2 inputs of the same size, as is hopefully</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00515" /><CodeLine lineNumber="515"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// typical, this loop condition will always fail, and subtree&#95;len will</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00516" /><CodeLine lineNumber="516"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// always be the full length of the input.)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00517" /><CodeLine lineNumber="517"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00518" /><CodeLine lineNumber="518"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// An aside: We don&#39;t have to shrink subtree&#95;len quite this much. For</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00519" /><CodeLine lineNumber="519"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// example, if count&#95;so&#95;far is 1, we could pass 2 chunks to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00520" /><CodeLine lineNumber="520"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// compress&#95;subtree&#95;to&#95;parent&#95;node. Since we&#39;ll get 2 CVs back, we&#39;ll still</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00521" /><CodeLine lineNumber="521"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// get the right answer in the end, and we might get to use 2-way SIMD</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00522" /><CodeLine lineNumber="522"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// parallelism. The problem with this optimization, is that it gets us</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00523" /><CodeLine lineNumber="523"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// stuck always hashing 2 chunks. The total number of chunks will remain</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00524" /><CodeLine lineNumber="524"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// odd, and we&#39;ll never graduate to higher degrees of parallelism. See</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00525" /><CodeLine lineNumber="525"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// https://github.com/BLAKE3-team/BLAKE3/issues/69.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00526" /><CodeLine lineNumber="526"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> ((((uint64&#95;t)(subtree&#95;len - 1)) &amp; count&#95;so&#95;far) != 0) &#123;</Highlight></CodeLine>
<Link id="l00527" /><CodeLine lineNumber="527"><Highlight kind="normal">      subtree&#95;len /= 2;</Highlight></CodeLine>
<Link id="l00528" /><CodeLine lineNumber="528"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00529" /><CodeLine lineNumber="529"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The shrunken subtree&#95;len might now be 1 chunk long. If so, hash that one</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00530" /><CodeLine lineNumber="530"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// chunk by itself. Otherwise, compress the subtree into a pair of CVs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00531" /><CodeLine lineNumber="531"><Highlight kind="normal">    uint64&#95;t subtree&#95;chunks = subtree&#95;len / <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>;</Highlight></CodeLine>
<Link id="l00532" /><CodeLine lineNumber="532"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (subtree&#95;len &lt;= <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#abcc4f732a672ef43bbfd2dc707e4d15e">BLAKE3&#95;CHUNK&#95;LEN</a>) &#123;</Highlight></CodeLine>
<Link id="l00533" /><CodeLine lineNumber="533"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#aed21153389299a4d7f8effa38ba58f3b">blake3&#95;chunk&#95;state</a> chunk&#95;state;</Highlight></CodeLine>
<Link id="l00534" /><CodeLine lineNumber="534"><Highlight kind="normal">      <a href="#a4db94e2dcf16f8659a69b1636897baeb">chunk&#95;state&#95;init</a>(&amp;chunk&#95;state, self-&gt;key, self-&gt;chunk.flags);</Highlight></CodeLine>
<Link id="l00535" /><CodeLine lineNumber="535"><Highlight kind="normal">      chunk&#95;state.chunk&#95;counter = self-&gt;chunk.chunk&#95;counter;</Highlight></CodeLine>
<Link id="l00536" /><CodeLine lineNumber="536"><Highlight kind="normal">      <a href="#a1c4270490e141bac2a6053af9ef01f6b">chunk&#95;state&#95;update</a>(&amp;chunk&#95;state, input&#95;bytes, subtree&#95;len);</Highlight></CodeLine>
<Link id="l00537" /><CodeLine lineNumber="537"><Highlight kind="normal">      <a href="/docs/api/structs/output-t">output&#95;t</a> output = <a href="#acc3e5ba813b5fb930b49c67f1edadf41">chunk&#95;state&#95;output</a>(&amp;chunk&#95;state);</Highlight></CodeLine>
<Link id="l00538" /><CodeLine lineNumber="538"><Highlight kind="normal">      uint8&#95;t cv&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00539" /><CodeLine lineNumber="539"><Highlight kind="normal">      <a href="#a92376f69320e66a51477df2b47088249">output&#95;chaining&#95;value</a>(&amp;output, cv);</Highlight></CodeLine>
<Link id="l00540" /><CodeLine lineNumber="540"><Highlight kind="normal">      <a href="#ae7004860c25afdef231d29688cfdb2ff">hasher&#95;push&#95;cv</a>(self, cv, chunk&#95;state.chunk&#95;counter);</Highlight></CodeLine>
<Link id="l00541" /><CodeLine lineNumber="541"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00542" /><CodeLine lineNumber="542"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// This is the high-performance happy path, though getting here depends</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00543" /><CodeLine lineNumber="543"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// on the caller giving us a long enough input.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00544" /><CodeLine lineNumber="544"><Highlight kind="normal">      uint8&#95;t cv&#95;pair&#91;2 &#42; <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00545" /><CodeLine lineNumber="545"><Highlight kind="normal">      <a href="#abd0aa960e3f0e3ebab8baccea1f3808a">compress&#95;subtree&#95;to&#95;parent&#95;node</a>(input&#95;bytes, subtree&#95;len, self-&gt;key,</Highlight></CodeLine>
<Link id="l00546" /><CodeLine lineNumber="546"><Highlight kind="normal">                                      self-&gt;chunk.chunk&#95;counter,</Highlight></CodeLine>
<Link id="l00547" /><CodeLine lineNumber="547"><Highlight kind="normal">                                      self-&gt;chunk.flags, cv&#95;pair);</Highlight></CodeLine>
<Link id="l00548" /><CodeLine lineNumber="548"><Highlight kind="normal">      <a href="#ae7004860c25afdef231d29688cfdb2ff">hasher&#95;push&#95;cv</a>(self, cv&#95;pair, self-&gt;chunk.chunk&#95;counter);</Highlight></CodeLine>
<Link id="l00549" /><CodeLine lineNumber="549"><Highlight kind="normal">      <a href="#ae7004860c25afdef231d29688cfdb2ff">hasher&#95;push&#95;cv</a>(self, &amp;cv&#95;pair&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a54e230beb5e1d501702361fb91f399f0">BLAKE3&#95;OUT&#95;LEN</a>&#93;,</Highlight></CodeLine>
<Link id="l00550" /><CodeLine lineNumber="550"><Highlight kind="normal">                     self-&gt;chunk.chunk&#95;counter + (subtree&#95;chunks / 2));</Highlight></CodeLine>
<Link id="l00551" /><CodeLine lineNumber="551"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00552" /><CodeLine lineNumber="552"><Highlight kind="normal">    self-&gt;chunk.chunk&#95;counter += subtree&#95;chunks;</Highlight></CodeLine>
<Link id="l00553" /><CodeLine lineNumber="553"><Highlight kind="normal">    input&#95;bytes += subtree&#95;len;</Highlight></CodeLine>
<Link id="l00554" /><CodeLine lineNumber="554"><Highlight kind="normal">    input&#95;len -= subtree&#95;len;</Highlight></CodeLine>
<Link id="l00555" /><CodeLine lineNumber="555"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00556" /><CodeLine lineNumber="556"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00557" /><CodeLine lineNumber="557"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there&#39;s any remaining input less than a full chunk, add it to the chunk</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00558" /><CodeLine lineNumber="558"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// state. In that case, also do a final merge loop to make sure the subtree</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00559" /><CodeLine lineNumber="559"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// stack doesn&#39;t contain any unmerged pairs. The remaining input means we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00560" /><CodeLine lineNumber="560"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// know these merges are non-root. This merge loop isn&#39;t strictly necessary</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00561" /><CodeLine lineNumber="561"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// here, because hasher&#95;push&#95;chunk&#95;cv already does its own merge loop, but it</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00562" /><CodeLine lineNumber="562"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// simplifies blake3&#95;hasher&#95;finalize below.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00563" /><CodeLine lineNumber="563"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (input&#95;len &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l00564" /><CodeLine lineNumber="564"><Highlight kind="normal">    <a href="#a1c4270490e141bac2a6053af9ef01f6b">chunk&#95;state&#95;update</a>(&amp;self-&gt;chunk, input&#95;bytes, input&#95;len);</Highlight></CodeLine>
<Link id="l00565" /><CodeLine lineNumber="565"><Highlight kind="normal">    <a href="#a63183e27546bc2e072233e0268400e83">hasher&#95;merge&#95;cv&#95;stack</a>(self, self-&gt;chunk.chunk&#95;counter);</Highlight></CodeLine>
<Link id="l00566" /><CodeLine lineNumber="566"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00567" /><CodeLine lineNumber="567"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00568" /><CodeLine lineNumber="568"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00569" /><CodeLine lineNumber="569" lineLink="#a6f1551c11ac8a08c294ee4bf7bf08623"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a6f1551c11ac8a08c294ee4bf7bf08623">llvm&#95;blake3&#95;hasher&#95;finalize</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self, uint8&#95;t &#42;out,</Highlight></CodeLine>
<Link id="l00570" /><CodeLine lineNumber="570"><Highlight kind="normal">                            </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> out&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00571" /><CodeLine lineNumber="571"><Highlight kind="normal">  <a href="#ab6b397feba4ec3af8a0b09c3d7c5bffb">llvm&#95;blake3&#95;hasher&#95;finalize&#95;seek</a>(self, 0, out, out&#95;len);</Highlight></CodeLine>
<Link id="l00572" /><CodeLine lineNumber="572"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if LLVM&#95;MEMORY&#95;SANITIZER&#95;BUILD</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00573" /><CodeLine lineNumber="573"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Avoid false positives due to uninstrumented assembly code.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00574" /><CodeLine lineNumber="574"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#a7b6ebda5fec619759c0522722503be67">&#95;&#95;msan&#95;unpoison</a>(out, out&#95;len);</Highlight></CodeLine>
<Link id="l00575" /><CodeLine lineNumber="575"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00576" /><CodeLine lineNumber="576"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00577" /><CodeLine lineNumber="577"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00578" /><CodeLine lineNumber="578" lineLink="#ab6b397feba4ec3af8a0b09c3d7c5bffb"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#ab6b397feba4ec3af8a0b09c3d7c5bffb">llvm&#95;blake3&#95;hasher&#95;finalize&#95;seek</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self, uint64&#95;t seek,</Highlight></CodeLine>
<Link id="l00579" /><CodeLine lineNumber="579"><Highlight kind="normal">                                 uint8&#95;t &#42;out, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> out&#95;len) &#123;</Highlight></CodeLine>
<Link id="l00580" /><CodeLine lineNumber="580"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Explicitly checking for zero avoids causing UB by passing a null pointer</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00581" /><CodeLine lineNumber="581"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to memcpy. This comes up in practice with things like:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00582" /><CodeLine lineNumber="582"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   std::vector&lt;uint8&#95;t&gt; v;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00583" /><CodeLine lineNumber="583"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//   blake3&#95;hasher&#95;finalize(&amp;hasher, v.data(), v.size());</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00584" /><CodeLine lineNumber="584"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (out&#95;len == 0) &#123;</Highlight></CodeLine>
<Link id="l00585" /><CodeLine lineNumber="585"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00586" /><CodeLine lineNumber="586"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00587" /><CodeLine lineNumber="587"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00588" /><CodeLine lineNumber="588"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If the subtree stack is empty, then the current chunk is the root.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00589" /><CodeLine lineNumber="589"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (self-&gt;cv&#95;stack&#95;len == 0) &#123;</Highlight></CodeLine>
<Link id="l00590" /><CodeLine lineNumber="590"><Highlight kind="normal">    <a href="/docs/api/structs/output-t">output&#95;t</a> output = <a href="#acc3e5ba813b5fb930b49c67f1edadf41">chunk&#95;state&#95;output</a>(&amp;self-&gt;chunk);</Highlight></CodeLine>
<Link id="l00591" /><CodeLine lineNumber="591"><Highlight kind="normal">    <a href="#a0a194eae24fe95b572091dc7e992744f">output&#95;root&#95;bytes</a>(&amp;output, seek, out, out&#95;len);</Highlight></CodeLine>
<Link id="l00592" /><CodeLine lineNumber="592"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00593" /><CodeLine lineNumber="593"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00594" /><CodeLine lineNumber="594"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there are any bytes in the chunk state, finalize that chunk and do a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00595" /><CodeLine lineNumber="595"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// roll-up merge between that chunk hash and every subtree in the stack. In</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00596" /><CodeLine lineNumber="596"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// this case, the extra merge loop at the end of blake3&#95;hasher&#95;update</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00597" /><CodeLine lineNumber="597"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// guarantees that none of the subtrees in the stack need to be merged with</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00598" /><CodeLine lineNumber="598"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// each other first. Otherwise, if there are no bytes in the chunk state,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00599" /><CodeLine lineNumber="599"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// then the top of the stack is a chunk hash, and we start the merge from</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00600" /><CodeLine lineNumber="600"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// that.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00601" /><CodeLine lineNumber="601"><Highlight kind="normal">  <a href="/docs/api/structs/output-t">output&#95;t</a> output;</Highlight></CodeLine>
<Link id="l00602" /><CodeLine lineNumber="602"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> cvs&#95;remaining;</Highlight></CodeLine>
<Link id="l00603" /><CodeLine lineNumber="603"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a2c1ba208c88f9efdc6702769ecd006da">chunk&#95;state&#95;len</a>(&amp;self-&gt;chunk) &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l00604" /><CodeLine lineNumber="604"><Highlight kind="normal">    cvs&#95;remaining = self-&gt;cv&#95;stack&#95;len;</Highlight></CodeLine>
<Link id="l00605" /><CodeLine lineNumber="605"><Highlight kind="normal">    output = <a href="#acc3e5ba813b5fb930b49c67f1edadf41">chunk&#95;state&#95;output</a>(&amp;self-&gt;chunk);</Highlight></CodeLine>
<Link id="l00606" /><CodeLine lineNumber="606"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l00607" /><CodeLine lineNumber="607"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// There are always at least 2 CVs in the stack in this case.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00608" /><CodeLine lineNumber="608"><Highlight kind="normal">    cvs&#95;remaining = self-&gt;cv&#95;stack&#95;len - 2;</Highlight></CodeLine>
<Link id="l00609" /><CodeLine lineNumber="609"><Highlight kind="normal">    output = <a href="#ab18874614dade172d2726abc3e88d480">parent&#95;output</a>(&amp;self-&gt;cv&#95;stack&#91;cvs&#95;remaining &#42; 32&#93;, self-&gt;key,</Highlight></CodeLine>
<Link id="l00610" /><CodeLine lineNumber="610"><Highlight kind="normal">                           self-&gt;chunk.flags);</Highlight></CodeLine>
<Link id="l00611" /><CodeLine lineNumber="611"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00612" /><CodeLine lineNumber="612"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (cvs&#95;remaining &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l00613" /><CodeLine lineNumber="613"><Highlight kind="normal">    cvs&#95;remaining -= 1;</Highlight></CodeLine>
<Link id="l00614" /><CodeLine lineNumber="614"><Highlight kind="normal">    uint8&#95;t parent&#95;block&#91;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a304cb82e31ff3dc5a4b02f7fce75555e">BLAKE3&#95;BLOCK&#95;LEN</a>&#93;;</Highlight></CodeLine>
<Link id="l00615" /><CodeLine lineNumber="615"><Highlight kind="normal">    memcpy(parent&#95;block, &amp;self-&gt;cv&#95;stack&#91;cvs&#95;remaining &#42; 32&#93;, 32);</Highlight></CodeLine>
<Link id="l00616" /><CodeLine lineNumber="616"><Highlight kind="normal">    <a href="#a92376f69320e66a51477df2b47088249">output&#95;chaining&#95;value</a>(&amp;output, &amp;parent&#95;block&#91;32&#93;);</Highlight></CodeLine>
<Link id="l00617" /><CodeLine lineNumber="617"><Highlight kind="normal">    output = <a href="#ab18874614dade172d2726abc3e88d480">parent&#95;output</a>(parent&#95;block, self-&gt;key, self-&gt;chunk.flags);</Highlight></CodeLine>
<Link id="l00618" /><CodeLine lineNumber="618"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00619" /><CodeLine lineNumber="619"><Highlight kind="normal">  <a href="#a0a194eae24fe95b572091dc7e992744f">output&#95;root&#95;bytes</a>(&amp;output, seek, out, out&#95;len);</Highlight></CodeLine>
<Link id="l00620" /><CodeLine lineNumber="620"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00621" /><CodeLine lineNumber="621"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00622" /><CodeLine lineNumber="622" lineLink="#a465d8d4d0fdcb5bf75858c000e3e54f0"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a465d8d4d0fdcb5bf75858c000e3e54f0">llvm&#95;blake3&#95;hasher&#95;reset</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/llvm-blake3-prefix-h/#a720ce7ad2dc122aeb214c6a5d4731f46">blake3&#95;hasher</a> &#42;self) &#123;</Highlight></CodeLine>
<Link id="l00623" /><CodeLine lineNumber="623"><Highlight kind="normal">  <a href="#ac3fec0f8016731502a8a1ad30cea4f3d">chunk&#95;state&#95;reset</a>(&amp;self-&gt;chunk, self-&gt;key, 0);</Highlight></CodeLine>
<Link id="l00624" /><CodeLine lineNumber="624"><Highlight kind="normal">  self-&gt;cv&#95;stack&#95;len = 0;</Highlight></CodeLine>
<Link id="l00625" /><CodeLine lineNumber="625"><Highlight kind="normal">&#125;</Highlight></CodeLine>

</ProgramListing>

</DoxygenPage>
