---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/files/lib/lib/target/lib/target/amdgpu/simoderegister-cpp
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - file

---

import Link from '@docusaurus/Link'

import CodeLine from '@xpack/docusaurus-plugin-doxygen/components/CodeLine'
import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import IncludesList from '@xpack/docusaurus-plugin-doxygen/components/IncludesList'
import IncludesListItem from '@xpack/docusaurus-plugin-doxygen/components/IncludesListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import ProgramListing from '@xpack/docusaurus-plugin-doxygen/components/ProgramListing'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `SIModeRegister.cpp` File Reference

<DoxygenPage pluginConfig={pluginConfig}>

This pass inserts changes to the Mode register settings as required. <a href="#details">More...</a>

## Included Headers

<IncludesList>
<IncludesListItem
  filePath="AMDGPU.h"
  permalink="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpu-h"
  isLocal="true" />
<IncludesListItem
  filePath="GCNSubtarget.h"
  permalink="/docs/api/files/lib/lib/target/lib/target/amdgpu/gcnsubtarget-h"
  isLocal="true" />
<IncludesListItem
  filePath="MCTargetDesc/AMDGPUMCTargetDesc.h"
  permalink="/docs/api/files/lib/lib/target/lib/target/amdgpu/lib/target/amdgpu/mctargetdesc/amdgpumctargetdesc-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/Statistic.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineFunctionPass.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machinefunctionpass-h"
  isLocal="true" />
<IncludesListItem
  filePath="queue"
  permalink=""
  isLocal="false" />
</IncludesList>

## Namespaces Index

<MembersIndex>

<MembersIndexItem
  type="namespace"
  name={<><a href="/docs/api/namespaces/anonymous-simoderegister-cpp-">anonymous&#123;SIModeRegister.cpp&#125;</a></>}>
</MembersIndexItem>

</MembersIndex>

## Classes Index

<MembersIndex>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/status">Status</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/blockdata">BlockData</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister">SIModeRegister</a></>}>
</MembersIndexItem>

</MembersIndex>

## Functions Index

<MembersIndex>

<MembersIndexItem
  name={<><a href="#a30c0948db8a2855682bf18fe7ef02750">STATISTIC</a> (NumSetregInserted, &quot;Number of setreg of mode register inserted.&quot;)</>}>
</MembersIndexItem>

</MembersIndex>

## Defines Index

<MembersIndex>

<MembersIndexItem
  type="#define"
  name={<><a href="#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>&nbsp;&nbsp;&nbsp;&quot;si-<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonoptaddrmode-cpp/#abdd61257a7f5e75ed961036299f26498">mode</a>-register&quot;</>}>
</MembersIndexItem>

</MembersIndex>

## Description {#details}

This pass inserts changes to the Mode register settings as required.

Note that currently it only deals with the Double Precision Floating Point rounding mode setting, but is intended to be generic enough to be easily expanded.

<SectionDefinition>

## Functions

### STATISTIC() {#a30c0948db8a2855682bf18fe7ef02750}

<MemberDefinition
  prototype={<>STATISTIC (NumSetregInserted, &quot;Number of setreg of <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonoptaddrmode-cpp/#abdd61257a7f5e75ed961036299f26498">mode</a> register inserted.&quot;)</>}>

Definition at line <a href="#l00025">25</a> of file <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/simoderegister-cpp">SIModeRegister.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Defines

### DEBUG&#95;TYPE {#ad78e062f62e0d6e453941fb4ca843e4d}

<MemberDefinition
  prototype={<>#define DEBUG&#95;TYPE&nbsp;&nbsp;&nbsp;&quot;si-<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonoptaddrmode-cpp/#abdd61257a7f5e75ed961036299f26498">mode</a>-register&quot;</>}>

Definition at line <a href="#l00023">23</a> of file <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/simoderegister-cpp">SIModeRegister.cpp</a>.
</MemberDefinition>

</SectionDefinition>

## File Listing

The file content with the documentation metadata removed is:

<ProgramListing>

<Link id="l00001" /><CodeLine lineNumber="1"><span class="doxyHighlightComment">//===-- SIModeRegister.cpp - Mode Register --------------------------------===//</span></CodeLine>
<Link id="l00002" /><CodeLine lineNumber="2"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00003" /><CodeLine lineNumber="3"><span class="doxyHighlightComment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></CodeLine>
<Link id="l00004" /><CodeLine lineNumber="4"><span class="doxyHighlightComment">// See https://llvm.org/LICENSE.txt for license information.</span></CodeLine>
<Link id="l00005" /><CodeLine lineNumber="5"><span class="doxyHighlightComment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></CodeLine>
<Link id="l00006" /><CodeLine lineNumber="6"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00007" /><CodeLine lineNumber="7"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00008" /><CodeLine lineNumber="8"><span class="doxyHighlightComment">/// \\file</span></CodeLine>
<Link id="l00009" /><CodeLine lineNumber="9"><span class="doxyHighlightComment">/// This pass inserts changes to the Mode register settings as required.</span></CodeLine>
<Link id="l00010" /><CodeLine lineNumber="10"><span class="doxyHighlightComment">/// Note that currently it only deals with the Double Precision Floating Point</span></CodeLine>
<Link id="l00011" /><CodeLine lineNumber="11"><span class="doxyHighlightComment">/// rounding mode setting, but is intended to be generic enough to be easily</span></CodeLine>
<Link id="l00012" /><CodeLine lineNumber="12"><span class="doxyHighlightComment">/// expanded.</span></CodeLine>
<Link id="l00013" /><CodeLine lineNumber="13"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00014" /><CodeLine lineNumber="14"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00015" /><CodeLine lineNumber="15"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00016" /><CodeLine lineNumber="16"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpu-h">AMDGPU.h</a>&quot;</span></CodeLine>
<Link id="l00017" /><CodeLine lineNumber="17"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/gcnsubtarget-h">GCNSubtarget.h</a>&quot;</span></CodeLine>
<Link id="l00018" /><CodeLine lineNumber="18"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/lib/target/amdgpu/mctargetdesc/amdgpumctargetdesc-h">MCTargetDesc/AMDGPUMCTargetDesc.h</a>&quot;</span></CodeLine>
<Link id="l00019" /><CodeLine lineNumber="19"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h">llvm/ADT/Statistic.h</a>&quot;</span></CodeLine>
<Link id="l00020" /><CodeLine lineNumber="20"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machinefunctionpass-h">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</span></CodeLine>
<Link id="l00021" /><CodeLine lineNumber="21"><span class="doxyHighlightPreprocessor">#include &lt;queue&gt;</span></CodeLine>
<Link id="l00022" /><CodeLine lineNumber="22"></CodeLine>
<Link id="l00023" /><CodeLine lineNumber="23" lineLink="#ad78e062f62e0d6e453941fb4ca843e4d"><span class="doxyHighlightPreprocessor">#define DEBUG&#95;TYPE &quot;si-mode-register&quot;</span></CodeLine>
<Link id="l00024" /><CodeLine lineNumber="24"></CodeLine>
<Link id="l00025" /><CodeLine lineNumber="25" lineLink="#a30c0948db8a2855682bf18fe7ef02750"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(NumSetregInserted, </span><span class="doxyHighlightStringLiteral">&quot;Number of setreg of mode register inserted.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00026" /><CodeLine lineNumber="26"></CodeLine>
<Link id="l00027" /><CodeLine lineNumber="27"><span class="doxyHighlightKeyword">using namespace </span><span class="doxyHighlight"><a href="/docs/api/namespaces/llvm">llvm</a>;</span></CodeLine>
<Link id="l00028" /><CodeLine lineNumber="28"></CodeLine>
<Link id="l00029" /><CodeLine lineNumber="29" lineLink="/docs/api/structs/status"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> &#123;</span></CodeLine>
<Link id="l00030" /><CodeLine lineNumber="30"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Mask is a bitmask where a &#39;1&#39; indicates the corresponding Mode bit has a</span></CodeLine>
<Link id="l00031" /><CodeLine lineNumber="31"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// known value</span></CodeLine>
<Link id="l00032" /><CodeLine lineNumber="32" lineLink="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> = 0;</span></CodeLine>
<Link id="l00033" /><CodeLine lineNumber="33" lineLink="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> = 0;</span></CodeLine>
<Link id="l00034" /><CodeLine lineNumber="34"></CodeLine>
<Link id="l00035" /><CodeLine lineNumber="35" lineLink="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a"><span class="doxyHighlight">  <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a>() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00036" /><CodeLine lineNumber="36"></CodeLine>
<Link id="l00037" /><CodeLine lineNumber="37" lineLink="/docs/api/structs/status/#a521e597985be481067010a6b7b40f7dc"><span class="doxyHighlight">  <a href="/docs/api/structs/status/#a521e597985be481067010a6b7b40f7dc">Status</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NewMask, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NewMode) : <a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>(NewMask), <a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a>(NewMode) &#123;</span></CodeLine>
<Link id="l00038" /><CodeLine lineNumber="38"><span class="doxyHighlight">    <a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> &amp;= <a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>;</span></CodeLine>
<Link id="l00039" /><CodeLine lineNumber="39"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00040" /><CodeLine lineNumber="40"></CodeLine>
<Link id="l00041" /><CodeLine lineNumber="41"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// merge two status values such that only values that don&#39;t conflict are</span></CodeLine>
<Link id="l00042" /><CodeLine lineNumber="42"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// preserved</span></CodeLine>
<Link id="l00043" /><CodeLine lineNumber="43" lineLink="/docs/api/structs/status/#a7d238cf08ca2aca7b1ef0e8b7a4b0770"><span class="doxyHighlight">  <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> <a href="/docs/api/structs/status/#a7d238cf08ca2aca7b1ef0e8b7a4b0770">merge</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> &amp;S)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00044" /><CodeLine lineNumber="44"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a>((<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> | S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>), ((<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> &amp; ~S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>) | (S.<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> &amp; S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>)));</span></CodeLine>
<Link id="l00045" /><CodeLine lineNumber="45"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00046" /><CodeLine lineNumber="46"></CodeLine>
<Link id="l00047" /><CodeLine lineNumber="47"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// merge an unknown value by using the unknown value&#39;s mask to remove bits</span></CodeLine>
<Link id="l00048" /><CodeLine lineNumber="48"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// from the result</span></CodeLine>
<Link id="l00049" /><CodeLine lineNumber="49" lineLink="/docs/api/structs/status/#aedf18ee1c895e1fea6c0e7e195a5a1ca"><span class="doxyHighlight">  <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> <a href="/docs/api/structs/status/#aedf18ee1c895e1fea6c0e7e195a5a1ca">mergeUnknown</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> newMask) &#123;</span></CodeLine>
<Link id="l00050" /><CodeLine lineNumber="50"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a>(<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> &amp; ~newMask, <a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> &amp; ~newMask);</span></CodeLine>
<Link id="l00051" /><CodeLine lineNumber="51"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00052" /><CodeLine lineNumber="52"></CodeLine>
<Link id="l00053" /><CodeLine lineNumber="53"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// intersect two Status values to produce a mode and mask that is a subset</span></CodeLine>
<Link id="l00054" /><CodeLine lineNumber="54"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// of both values</span></CodeLine>
<Link id="l00055" /><CodeLine lineNumber="55" lineLink="/docs/api/structs/status/#aa6c36013b7c84c75cc978506e306a1a4"><span class="doxyHighlight">  <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> <a href="/docs/api/structs/status/#aa6c36013b7c84c75cc978506e306a1a4">intersect</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> &amp;S)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00056" /><CodeLine lineNumber="56"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NewMask = (<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> &amp; S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>) &amp; (<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> ^ ~S.<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a>);</span></CodeLine>
<Link id="l00057" /><CodeLine lineNumber="57"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NewMode = (<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> &amp; NewMask);</span></CodeLine>
<Link id="l00058" /><CodeLine lineNumber="58"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a>(NewMask, NewMode);</span></CodeLine>
<Link id="l00059" /><CodeLine lineNumber="59"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00060" /><CodeLine lineNumber="60"></CodeLine>
<Link id="l00061" /><CodeLine lineNumber="61"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// produce the delta required to change the Mode to the required Mode</span></CodeLine>
<Link id="l00062" /><CodeLine lineNumber="62" lineLink="/docs/api/structs/status/#a4d49768146ce886e2eb17aacd8159ca9"><span class="doxyHighlight">  <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> <a href="/docs/api/structs/status/#a4d49768146ce886e2eb17aacd8159ca9">delta</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> &amp;S)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00063" /><CodeLine lineNumber="63"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a>((S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> &amp; (<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> ^ S.<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a>)) | (~<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> &amp; S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>), S.<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a>);</span></CodeLine>
<Link id="l00064" /><CodeLine lineNumber="64"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00065" /><CodeLine lineNumber="65"></CodeLine>
<Link id="l00066" /><CodeLine lineNumber="66" lineLink="/docs/api/structs/status/#a6927b9d6af12920e80ae469aa1660491"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a6927b9d6af12920e80ae469aa1660491">operator==</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> &amp;S)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00067" /><CodeLine lineNumber="67"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> (<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> == S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>) &amp;&amp; (<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> == S.<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a>);</span></CodeLine>
<Link id="l00068" /><CodeLine lineNumber="68"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00069" /><CodeLine lineNumber="69"></CodeLine>
<Link id="l00070" /><CodeLine lineNumber="70" lineLink="/docs/api/structs/status/#aa92eb76e83481bf6df6ecb43ae05964d"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#aa92eb76e83481bf6df6ecb43ae05964d">operator!=</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> &amp;S)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !(&#42;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight"> == S); &#125;</span></CodeLine>
<Link id="l00071" /><CodeLine lineNumber="71"></CodeLine>
<Link id="l00072" /><CodeLine lineNumber="72" lineLink="/docs/api/structs/status/#a78cea2430649ceb585466218022bd579"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a78cea2430649ceb585466218022bd579">isCompatible</a>(<a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> &amp;S) &#123;</span></CodeLine>
<Link id="l00073" /><CodeLine lineNumber="73"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> ((<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> &amp; S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>) == S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>) &amp;&amp; ((<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> &amp; S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>) == S.<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a>);</span></CodeLine>
<Link id="l00074" /><CodeLine lineNumber="74"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00075" /><CodeLine lineNumber="75"></CodeLine>
<Link id="l00076" /><CodeLine lineNumber="76" lineLink="/docs/api/structs/status/#a62c91ffba279ca27ad70766196e3367c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/status/#a62c91ffba279ca27ad70766196e3367c">isCombinable</a>(<a href="/docs/api/structs/status/#a693c4657472e9cd6990e401f1a26f88a">Status</a> &amp;S) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !(<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> &amp; S.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>) || <a href="/docs/api/structs/status/#a78cea2430649ceb585466218022bd579">isCompatible</a>(S); &#125;</span></CodeLine>
<Link id="l00077" /><CodeLine lineNumber="77"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00078" /><CodeLine lineNumber="78"></CodeLine>
<Link id="l00079" /><CodeLine lineNumber="79" lineLink="/docs/api/classes/blockdata"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/blockdata/#a4207f6098d7a9d7b1234e257e175971e">BlockData</a> &#123;</span></CodeLine>
<Link id="l00080" /><CodeLine lineNumber="80"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00081" /><CodeLine lineNumber="81"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The Status that represents the mode register settings required by the</span></CodeLine>
<Link id="l00082" /><CodeLine lineNumber="82"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// FirstInsertionPoint (if any) in this block. Calculated in Phase 1</span></CodeLine>
<Link id="l00083" /><CodeLine lineNumber="83" lineLink="/docs/api/classes/blockdata/#a7e85ac3d26806a2701681fe1a29fe08b"><span class="doxyHighlight">  <a href="/docs/api/structs/status">Status</a> <a href="/docs/api/classes/blockdata/#a7e85ac3d26806a2701681fe1a29fe08b">Require</a>;</span></CodeLine>
<Link id="l00084" /><CodeLine lineNumber="84"></CodeLine>
<Link id="l00085" /><CodeLine lineNumber="85"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The Status that represents the net changes to the Mode register made by</span></CodeLine>
<Link id="l00086" /><CodeLine lineNumber="86"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// this block, Calculated in Phase 1</span></CodeLine>
<Link id="l00087" /><CodeLine lineNumber="87" lineLink="/docs/api/classes/blockdata/#a1f3c9376e6a4054bbc88635859eb16cb"><span class="doxyHighlight">  <a href="/docs/api/structs/status">Status</a> <a href="/docs/api/classes/blockdata/#a1f3c9376e6a4054bbc88635859eb16cb">Change</a>;</span></CodeLine>
<Link id="l00088" /><CodeLine lineNumber="88"></CodeLine>
<Link id="l00089" /><CodeLine lineNumber="89"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The Status that represents the mode register settings on exit from this</span></CodeLine>
<Link id="l00090" /><CodeLine lineNumber="90"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// block. Calculated in Phase 2</span></CodeLine>
<Link id="l00091" /><CodeLine lineNumber="91" lineLink="/docs/api/classes/blockdata/#a74d8253f53eb9b3275801c555cb447ec"><span class="doxyHighlight">  <a href="/docs/api/structs/status">Status</a> <a href="/docs/api/classes/blockdata/#a74d8253f53eb9b3275801c555cb447ec">Exit</a>;</span></CodeLine>
<Link id="l00092" /><CodeLine lineNumber="92"></CodeLine>
<Link id="l00093" /><CodeLine lineNumber="93"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The Status that represents the intersection of exit Mode register settings</span></CodeLine>
<Link id="l00094" /><CodeLine lineNumber="94"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// from all predecessor blocks. Calculated in Phase 2, and used by Phase 3</span></CodeLine>
<Link id="l00095" /><CodeLine lineNumber="95" lineLink="/docs/api/classes/blockdata/#a43a066245da94488e55f6cc308f46636"><span class="doxyHighlight">  <a href="/docs/api/structs/status">Status</a> <a href="/docs/api/classes/blockdata/#a43a066245da94488e55f6cc308f46636">Pred</a>;</span></CodeLine>
<Link id="l00096" /><CodeLine lineNumber="96"></CodeLine>
<Link id="l00097" /><CodeLine lineNumber="97"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// In Phase 1 we record the first instruction that has a mode requirement,</span></CodeLine>
<Link id="l00098" /><CodeLine lineNumber="98"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// which is used in Phase 3 if we need to insert a mode change.</span></CodeLine>
<Link id="l00099" /><CodeLine lineNumber="99" lineLink="/docs/api/classes/blockdata/#a596f7df03267b0d4812287cac2550bff"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/classes/blockdata/#a596f7df03267b0d4812287cac2550bff">FirstInsertionPoint</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00100" /><CodeLine lineNumber="100"></CodeLine>
<Link id="l00101" /><CodeLine lineNumber="101"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// A flag to indicate whether an Exit value has been set (we can&#39;t tell by</span></CodeLine>
<Link id="l00102" /><CodeLine lineNumber="102"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// examining the Exit value itself as all values may be valid results).</span></CodeLine>
<Link id="l00103" /><CodeLine lineNumber="103" lineLink="/docs/api/classes/blockdata/#a8a91d4cd279a7137bbd4472e375c7d35"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/blockdata/#a8a91d4cd279a7137bbd4472e375c7d35">ExitSet</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00104" /><CodeLine lineNumber="104"></CodeLine>
<Link id="l00105" /><CodeLine lineNumber="105" lineLink="/docs/api/classes/blockdata/#a4207f6098d7a9d7b1234e257e175971e"><span class="doxyHighlight">  <a href="/docs/api/classes/blockdata/#a4207f6098d7a9d7b1234e257e175971e">BlockData</a>() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00106" /><CodeLine lineNumber="106"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00107" /><CodeLine lineNumber="107"></CodeLine>
<Link id="l00108" /><CodeLine lineNumber="108" lineLink="/docs/api/namespaces/anonymous-simoderegister-cpp-"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00109" /><CodeLine lineNumber="109"></CodeLine>
<Link id="l00110" /><CodeLine lineNumber="110" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa7b8c58dbae00af8f49fe8b0017ffe63">SIModeRegister</a> : </span><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinefunctionpass/#a29c81d2386f4a727c6d33413807530c8">MachineFunctionPass</a> &#123;</span></CodeLine>
<Link id="l00111" /><CodeLine lineNumber="111"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00112" /><CodeLine lineNumber="112" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac216d711e8acda2a3a5638faefe5ca2c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac216d711e8acda2a3a5638faefe5ca2c">ID</a>;</span></CodeLine>
<Link id="l00113" /><CodeLine lineNumber="113"></CodeLine>
<Link id="l00114" /><CodeLine lineNumber="114" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f"><span class="doxyHighlight">  std::vector&lt;std::unique&#95;ptr&lt;BlockData&gt;&gt; <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>;</span></CodeLine>
<Link id="l00115" /><CodeLine lineNumber="115" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a8269d92f6cbf40bffdcf0ad155f81caa"><span class="doxyHighlight">  std::queue&lt;MachineBasicBlock &#42;&gt; <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a8269d92f6cbf40bffdcf0ad155f81caa">Phase2List</a>;</span></CodeLine>
<Link id="l00116" /><CodeLine lineNumber="116"></CodeLine>
<Link id="l00117" /><CodeLine lineNumber="117"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The default mode register setting currently only caters for the floating</span></CodeLine>
<Link id="l00118" /><CodeLine lineNumber="118"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// point double precision rounding mode.</span></CodeLine>
<Link id="l00119" /><CodeLine lineNumber="119"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We currently assume the default rounding mode is Round to Nearest</span></CodeLine>
<Link id="l00120" /><CodeLine lineNumber="120"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// NOTE: this should come from a per function rounding mode setting once such</span></CodeLine>
<Link id="l00121" /><CodeLine lineNumber="121"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// a setting exists.</span></CodeLine>
<Link id="l00122" /><CodeLine lineNumber="122" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ae04b23547bcd8e830d865c3faab8bfab"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ae04b23547bcd8e830d865c3faab8bfab">DefaultMode</a> = <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a41f16ecef0a587cf75f9be3cce955f46">FP&#95;ROUND&#95;ROUND&#95;TO&#95;NEAREST</a>;</span></CodeLine>
<Link id="l00123" /><CodeLine lineNumber="123" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a1776b23a29cc38d2af1623b30be28b5b"><span class="doxyHighlight">  <a href="/docs/api/structs/status">Status</a> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a1776b23a29cc38d2af1623b30be28b5b">DefaultStatus</a> =</span></CodeLine>
<Link id="l00124" /><CodeLine lineNumber="124"><span class="doxyHighlight">      <a href="/docs/api/structs/status">Status</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a3bf6098fe268447f483c33ef54b0bd27">FP&#95;ROUND&#95;MODE&#95;DP</a>(0x3), <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a3bf6098fe268447f483c33ef54b0bd27">FP&#95;ROUND&#95;MODE&#95;DP</a>(<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ae04b23547bcd8e830d865c3faab8bfab">DefaultMode</a>));</span></CodeLine>
<Link id="l00125" /><CodeLine lineNumber="125"></CodeLine>
<Link id="l00126" /><CodeLine lineNumber="126" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a7a008d4f9f492f02b4c00fe05bba46d4"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a7a008d4f9f492f02b4c00fe05bba46d4">Changed</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00127" /><CodeLine lineNumber="127"></CodeLine>
<Link id="l00128" /><CodeLine lineNumber="128"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00129" /><CodeLine lineNumber="129" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa7b8c58dbae00af8f49fe8b0017ffe63"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa7b8c58dbae00af8f49fe8b0017ffe63">SIModeRegister</a>() : <a href="/docs/api/classes/llvm/machinefunctionpass/#a29c81d2386f4a727c6d33413807530c8">MachineFunctionPass</a>(<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac216d711e8acda2a3a5638faefe5ca2c">ID</a>) &#123;&#125;</span></CodeLine>
<Link id="l00130" /><CodeLine lineNumber="130"></CodeLine>
<Link id="l00131" /><CodeLine lineNumber="131"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> runOnMachineFunction(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF) </span><span class="doxyHighlightKeyword">override</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00132" /><CodeLine lineNumber="132"></CodeLine>
<Link id="l00133" /><CodeLine lineNumber="133" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a155eded900a371175503436a69208b01"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a155eded900a371175503436a69208b01">getAnalysisUsage</a>(<a href="/docs/api/classes/llvm/analysisusage">AnalysisUsage</a> &amp;AU)</span><span class="doxyHighlightKeyword"> const override </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00134" /><CodeLine lineNumber="134"><span class="doxyHighlight">    AU.<a href="/docs/api/classes/llvm/analysisusage/#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</span></CodeLine>
<Link id="l00135" /><CodeLine lineNumber="135"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinefunctionpass/#a864fd57b4304ef933b3281d0ef85a88e">MachineFunctionPass::getAnalysisUsage</a>(AU);</span></CodeLine>
<Link id="l00136" /><CodeLine lineNumber="136"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00137" /><CodeLine lineNumber="137"></CodeLine>
<Link id="l00138" /><CodeLine lineNumber="138"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> processBlockPhase1(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>);</span></CodeLine>
<Link id="l00139" /><CodeLine lineNumber="139"></CodeLine>
<Link id="l00140" /><CodeLine lineNumber="140"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> processBlockPhase2(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>);</span></CodeLine>
<Link id="l00141" /><CodeLine lineNumber="141"></CodeLine>
<Link id="l00142" /><CodeLine lineNumber="142"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> processBlockPhase3(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>);</span></CodeLine>
<Link id="l00143" /><CodeLine lineNumber="143"></CodeLine>
<Link id="l00144" /><CodeLine lineNumber="144"><span class="doxyHighlight">  <a href="/docs/api/structs/status">Status</a> getInstructionMode(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>);</span></CodeLine>
<Link id="l00145" /><CodeLine lineNumber="145"></CodeLine>
<Link id="l00146" /><CodeLine lineNumber="146"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> insertSetreg(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>,</span></CodeLine>
<Link id="l00147" /><CodeLine lineNumber="147"><span class="doxyHighlight">                    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>, <a href="/docs/api/structs/status">Status</a> InstrMode);</span></CodeLine>
<Link id="l00148" /><CodeLine lineNumber="148"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00149" /><CodeLine lineNumber="149"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// End anonymous namespace.</span></CodeLine>
<Link id="l00150" /><CodeLine lineNumber="150"></CodeLine>
<Link id="l00151" /><CodeLine lineNumber="151"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#af807c9595d50b45c0008924c4679c85c">INITIALIZE&#95;PASS</a>(<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa7b8c58dbae00af8f49fe8b0017ffe63">SIModeRegister</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/adt/genericcycleimpl-h/#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>,</span></CodeLine>
<Link id="l00152" /><CodeLine lineNumber="152"><span class="doxyHighlight">                </span><span class="doxyHighlightStringLiteral">&quot;Insert required mode register values&quot;</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l00153" /><CodeLine lineNumber="153"></CodeLine>
<Link id="l00154" /><CodeLine lineNumber="154"><span class="doxyHighlight">char <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa7b8c58dbae00af8f49fe8b0017ffe63">SIModeRegister</a>::<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> = 0;</span></CodeLine>
<Link id="l00155" /><CodeLine lineNumber="155"></CodeLine>
<Link id="l00156" /><CodeLine lineNumber="156"><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm">llvm</a>::<a href="/docs/api/namespaces/llvm/#a6c0ae8eb34e767f864323920af14b58b">SIModeRegisterID</a> = <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa7b8c58dbae00af8f49fe8b0017ffe63">SIModeRegister</a>::<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>;</span></CodeLine>
<Link id="l00157" /><CodeLine lineNumber="157"></CodeLine>
<Link id="l00158" /><CodeLine lineNumber="158" lineLink="/docs/api/namespaces/llvm/#a1ce45e5b72435b4b7423275d41cd2b63"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/functionpass">FunctionPass</a> &#42;<a href="/docs/api/namespaces/llvm">llvm</a>::<a href="/docs/api/namespaces/llvm/#a1ce45e5b72435b4b7423275d41cd2b63">createSIModeRegisterPass</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa7b8c58dbae00af8f49fe8b0017ffe63">SIModeRegister</a>(); &#125;</span></CodeLine>
<Link id="l00159" /><CodeLine lineNumber="159"></CodeLine>
<Link id="l00160" /><CodeLine lineNumber="160"><span class="doxyHighlightComment">// Determine the Mode register setting required for this instruction.</span></CodeLine>
<Link id="l00161" /><CodeLine lineNumber="161"><span class="doxyHighlightComment">// Instructions which don&#39;t use the Mode register return a null Status.</span></CodeLine>
<Link id="l00162" /><CodeLine lineNumber="162"><span class="doxyHighlightComment">// Note this currently only deals with instructions that use the floating point</span></CodeLine>
<Link id="l00163" /><CodeLine lineNumber="163"><span class="doxyHighlightComment">// double precision setting.</span></CodeLine>
<Link id="l00164" /><CodeLine lineNumber="164" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a7ab3269e00ecb2ad7713f6ee21c70a96"><span class="doxyHighlight"><a href="/docs/api/structs/status">Status</a> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a7ab3269e00ecb2ad7713f6ee21c70a96">SIModeRegister::getInstructionMode</a>(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</span></CodeLine>
<Link id="l00165" /><CodeLine lineNumber="165"><span class="doxyHighlight">                                          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>) &#123;</span></CodeLine>
<Link id="l00166" /><CodeLine lineNumber="166"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Opcode = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode();</span></CodeLine>
<Link id="l00167" /><CodeLine lineNumber="167"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;usesFPDPRounding(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) ||</span></CodeLine>
<Link id="l00168" /><CodeLine lineNumber="168"><span class="doxyHighlight">      Opcode == AMDGPU::FPTRUNC&#95;ROUND&#95;F16&#95;F32&#95;PSEUDO ||</span></CodeLine>
<Link id="l00169" /><CodeLine lineNumber="169"><span class="doxyHighlight">      Opcode == AMDGPU::FPTRUNC&#95;ROUND&#95;F32&#95;F64&#95;PSEUDO) &#123;</span></CodeLine>
<Link id="l00170" /><CodeLine lineNumber="170"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (Opcode) &#123;</span></CodeLine>
<Link id="l00171" /><CodeLine lineNumber="171"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> AMDGPU::V&#95;INTERP&#95;P1LL&#95;F16:</span></CodeLine>
<Link id="l00172" /><CodeLine lineNumber="172"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> AMDGPU::V&#95;INTERP&#95;P1LV&#95;F16:</span></CodeLine>
<Link id="l00173" /><CodeLine lineNumber="173"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> AMDGPU::V&#95;INTERP&#95;P2&#95;F16:</span></CodeLine>
<Link id="l00174" /><CodeLine lineNumber="174"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// f16 interpolation instructions need double precision round to zero</span></CodeLine>
<Link id="l00175" /><CodeLine lineNumber="175"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/status">Status</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a3bf6098fe268447f483c33ef54b0bd27">FP&#95;ROUND&#95;MODE&#95;DP</a>(3),</span></CodeLine>
<Link id="l00176" /><CodeLine lineNumber="176"><span class="doxyHighlight">                    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a3bf6098fe268447f483c33ef54b0bd27">FP&#95;ROUND&#95;MODE&#95;DP</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a4acbc6661acdb47237bd5ed7c9b73f3d">FP&#95;ROUND&#95;ROUND&#95;TO&#95;ZERO</a>));</span></CodeLine>
<Link id="l00177" /><CodeLine lineNumber="177"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> AMDGPU::FPTRUNC&#95;ROUND&#95;F16&#95;F32&#95;PSEUDO: &#123;</span></CodeLine>
<Link id="l00178" /><CodeLine lineNumber="178"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Mode = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(2).getImm();</span></CodeLine>
<Link id="l00179" /><CodeLine lineNumber="179"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.removeOperand(2);</span></CodeLine>
<Link id="l00180" /><CodeLine lineNumber="180"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Replacing the pseudo by a real instruction in place</span></CodeLine>
<Link id="l00181" /><CodeLine lineNumber="181"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getSubtarget().hasTrue16BitInsts()) &#123;</span></CodeLine>
<Link id="l00182" /><CodeLine lineNumber="182"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent();</span></CodeLine>
<Link id="l00183" /><CodeLine lineNumber="183"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/machineinstrbuilder">MachineInstrBuilder</a> <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.getParent(), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l00184" /><CodeLine lineNumber="184"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.setDesc(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(AMDGPU::V&#95;CVT&#95;F16&#95;F32&#95;fake16&#95;e64));</span></CodeLine>
<Link id="l00185" /><CodeLine lineNumber="185"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> Src0 = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1);</span></CodeLine>
<Link id="l00186" /><CodeLine lineNumber="186"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.removeOperand(1);</span></CodeLine>
<Link id="l00187" /><CodeLine lineNumber="187"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>.addImm(0); </span><span class="doxyHighlightComment">// src0&#95;modifiers</span></CodeLine>
<Link id="l00188" /><CodeLine lineNumber="188"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>.add(Src0); </span><span class="doxyHighlightComment">// re-add src0 operand</span></CodeLine>
<Link id="l00189" /><CodeLine lineNumber="189"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>.addImm(0); </span><span class="doxyHighlightComment">// clamp</span></CodeLine>
<Link id="l00190" /><CodeLine lineNumber="190"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>.addImm(0); </span><span class="doxyHighlightComment">// omod</span></CodeLine>
<Link id="l00191" /><CodeLine lineNumber="191"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00192" /><CodeLine lineNumber="192"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.setDesc(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(AMDGPU::V&#95;CVT&#95;F16&#95;F32&#95;e32));</span></CodeLine>
<Link id="l00193" /><CodeLine lineNumber="193"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/status">Status</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a3bf6098fe268447f483c33ef54b0bd27">FP&#95;ROUND&#95;MODE&#95;DP</a>(3), <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a3bf6098fe268447f483c33ef54b0bd27">FP&#95;ROUND&#95;MODE&#95;DP</a>(Mode));</span></CodeLine>
<Link id="l00194" /><CodeLine lineNumber="194"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00195" /><CodeLine lineNumber="195"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> AMDGPU::FPTRUNC&#95;ROUND&#95;F32&#95;F64&#95;PSEUDO: &#123;</span></CodeLine>
<Link id="l00196" /><CodeLine lineNumber="196"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Mode = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(2).getImm();</span></CodeLine>
<Link id="l00197" /><CodeLine lineNumber="197"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.removeOperand(2);</span></CodeLine>
<Link id="l00198" /><CodeLine lineNumber="198"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.setDesc(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(AMDGPU::V&#95;CVT&#95;F32&#95;F64&#95;e32));</span></CodeLine>
<Link id="l00199" /><CodeLine lineNumber="199"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/status">Status</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a3bf6098fe268447f483c33ef54b0bd27">FP&#95;ROUND&#95;MODE&#95;DP</a>(3), <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sidefines-h/#a3bf6098fe268447f483c33ef54b0bd27">FP&#95;ROUND&#95;MODE&#95;DP</a>(Mode));</span></CodeLine>
<Link id="l00200" /><CodeLine lineNumber="200"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00201" /><CodeLine lineNumber="201"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00202" /><CodeLine lineNumber="202"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a1776b23a29cc38d2af1623b30be28b5b">DefaultStatus</a>;</span></CodeLine>
<Link id="l00203" /><CodeLine lineNumber="203"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00204" /><CodeLine lineNumber="204"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00205" /><CodeLine lineNumber="205"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/status">Status</a>();</span></CodeLine>
<Link id="l00206" /><CodeLine lineNumber="206"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00207" /><CodeLine lineNumber="207"></CodeLine>
<Link id="l00208" /><CodeLine lineNumber="208"><span class="doxyHighlightComment">// Insert a setreg instruction to update the Mode register.</span></CodeLine>
<Link id="l00209" /><CodeLine lineNumber="209"><span class="doxyHighlightComment">// It is possible (though unlikely) for an instruction to require a change to</span></CodeLine>
<Link id="l00210" /><CodeLine lineNumber="210"><span class="doxyHighlightComment">// the value of disjoint parts of the Mode register when we don&#39;t know the</span></CodeLine>
<Link id="l00211" /><CodeLine lineNumber="211"><span class="doxyHighlightComment">// value of the intervening bits. In that case we need to use more than one</span></CodeLine>
<Link id="l00212" /><CodeLine lineNumber="212"><span class="doxyHighlightComment">// setreg instruction.</span></CodeLine>
<Link id="l00213" /><CodeLine lineNumber="213" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac5cb23515382def14508d54ee39bcc5f"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac5cb23515382def14508d54ee39bcc5f">SIModeRegister::insertSetreg</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</span></CodeLine>
<Link id="l00214" /><CodeLine lineNumber="214"><span class="doxyHighlight">                                  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>, <a href="/docs/api/structs/status">Status</a> InstrMode) &#123;</span></CodeLine>
<Link id="l00215" /><CodeLine lineNumber="215"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (InstrMode.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>) &#123;</span></CodeLine>
<Link id="l00216" /><CodeLine lineNumber="216"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/namespaces/llvm/#a57d2f9ee99e9e68cff564d0d579c8163">llvm::countr&#95;zero&lt;unsigned&gt;</a>(InstrMode.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a>);</span></CodeLine>
<Link id="l00217" /><CodeLine lineNumber="217"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Width = <a href="/docs/api/namespaces/llvm/#a239abca11deebf2731206dd41cf43c0e">llvm::countr&#95;one&lt;unsigned&gt;</a>(InstrMode.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> &gt;&gt; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</span></CodeLine>
<Link id="l00218" /><CodeLine lineNumber="218"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/value">Value</a> = (InstrMode.<a href="/docs/api/structs/status/#ae0d986f890ca1ef807fb7bbf99cff5bf">Mode</a> &gt;&gt; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &amp; ((1 &lt;&lt; Width) - 1);</span></CodeLine>
<Link id="l00219" /><CodeLine lineNumber="219"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">using namespace </span><span class="doxyHighlight"><a href="/docs/api/namespaces/llvm/amdgpu/hwreg">AMDGPU::Hwreg</a>;</span></CodeLine>
<Link id="l00220" /><CodeLine lineNumber="220"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(AMDGPU::S&#95;SETREG&#95;IMM32&#95;B32))</span></CodeLine>
<Link id="l00221" /><CodeLine lineNumber="221"><span class="doxyHighlight">        .<a href="/docs/api/classes/llvm/machineinstrbuilder/#a6c1f959947905135c7dd215b64957654">addImm</a>(<a href="/docs/api/classes/llvm/value">Value</a>)</span></CodeLine>
<Link id="l00222" /><CodeLine lineNumber="222"><span class="doxyHighlight">        .<a href="/docs/api/classes/llvm/machineinstrbuilder/#a6c1f959947905135c7dd215b64957654">addImm</a>(HwregEncoding::encode(ID&#95;MODE, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, Width));</span></CodeLine>
<Link id="l00223" /><CodeLine lineNumber="223"><span class="doxyHighlight">    ++NumSetregInserted;</span></CodeLine>
<Link id="l00224" /><CodeLine lineNumber="224"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a7a008d4f9f492f02b4c00fe05bba46d4">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00225" /><CodeLine lineNumber="225"><span class="doxyHighlight">    InstrMode.<a href="/docs/api/structs/status/#ad278024750ac1478e4a551043df7ff65">Mask</a> &amp;= ~(((1 &lt;&lt; Width) - 1) &lt;&lt; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</span></CodeLine>
<Link id="l00226" /><CodeLine lineNumber="226"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00227" /><CodeLine lineNumber="227"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00228" /><CodeLine lineNumber="228"></CodeLine>
<Link id="l00229" /><CodeLine lineNumber="229"><span class="doxyHighlightComment">// In Phase 1 we iterate through the instructions of the block and for each</span></CodeLine>
<Link id="l00230" /><CodeLine lineNumber="230"><span class="doxyHighlightComment">// instruction we get its mode usage. If the instruction uses the Mode register</span></CodeLine>
<Link id="l00231" /><CodeLine lineNumber="231"><span class="doxyHighlightComment">// we:</span></CodeLine>
<Link id="l00232" /><CodeLine lineNumber="232"><span class="doxyHighlightComment">// - update the Change status, which tracks the changes to the Mode register</span></CodeLine>
<Link id="l00233" /><CodeLine lineNumber="233"><span class="doxyHighlightComment">//   made by this block</span></CodeLine>
<Link id="l00234" /><CodeLine lineNumber="234"><span class="doxyHighlightComment">// - if this instruction&#39;s requirements are compatible with the current setting</span></CodeLine>
<Link id="l00235" /><CodeLine lineNumber="235"><span class="doxyHighlightComment">//   of the Mode register we merge the modes</span></CodeLine>
<Link id="l00236" /><CodeLine lineNumber="236"><span class="doxyHighlightComment">// - if it isn&#39;t compatible and an InsertionPoint isn&#39;t set, then we set the</span></CodeLine>
<Link id="l00237" /><CodeLine lineNumber="237"><span class="doxyHighlightComment">//   InsertionPoint to the current instruction, and we remember the current</span></CodeLine>
<Link id="l00238" /><CodeLine lineNumber="238"><span class="doxyHighlightComment">//   mode</span></CodeLine>
<Link id="l00239" /><CodeLine lineNumber="239"><span class="doxyHighlightComment">// - if it isn&#39;t compatible and InsertionPoint is set we insert a seteg before</span></CodeLine>
<Link id="l00240" /><CodeLine lineNumber="240"><span class="doxyHighlightComment">//   that instruction (unless this instruction forms part of the block&#39;s</span></CodeLine>
<Link id="l00241" /><CodeLine lineNumber="241"><span class="doxyHighlightComment">//   entry requirements in which case the insertion is deferred until Phase 3</span></CodeLine>
<Link id="l00242" /><CodeLine lineNumber="242"><span class="doxyHighlightComment">//   when predecessor exit values are known), and move the insertion point to</span></CodeLine>
<Link id="l00243" /><CodeLine lineNumber="243"><span class="doxyHighlightComment">//   this instruction</span></CodeLine>
<Link id="l00244" /><CodeLine lineNumber="244"><span class="doxyHighlightComment">// - if this is a setreg instruction we treat it as an incompatible instruction.</span></CodeLine>
<Link id="l00245" /><CodeLine lineNumber="245"><span class="doxyHighlightComment">//   This is sub-optimal but avoids some nasty corner cases, and is expected to</span></CodeLine>
<Link id="l00246" /><CodeLine lineNumber="246"><span class="doxyHighlightComment">//   occur very rarely.</span></CodeLine>
<Link id="l00247" /><CodeLine lineNumber="247"><span class="doxyHighlightComment">// - on exit we have set the Require, Change, and initial Exit modes.</span></CodeLine>
<Link id="l00248" /><CodeLine lineNumber="248" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#acf320f6e863d6b402e856a2c603d5ab5"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#acf320f6e863d6b402e856a2c603d5ab5">SIModeRegister::processBlockPhase1</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>,</span></CodeLine>
<Link id="l00249" /><CodeLine lineNumber="249"><span class="doxyHighlight">                                        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>) &#123;</span></CodeLine>
<Link id="l00250" /><CodeLine lineNumber="250"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> NewInfo = std::make&#95;unique&lt;BlockData&gt;();</span></CodeLine>
<Link id="l00251" /><CodeLine lineNumber="251"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/structs/insertionpoint">InsertionPoint</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00252" /><CodeLine lineNumber="252"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// RequirePending is used to indicate whether we are collecting the initial</span></CodeLine>
<Link id="l00253" /><CodeLine lineNumber="253"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// requirements for the block, and need to defer the first InsertionPoint to</span></CodeLine>
<Link id="l00254" /><CodeLine lineNumber="254"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Phase 3 It is set to false once we have set FirstInsertionPoint, or when</span></CodeLine>
<Link id="l00255" /><CodeLine lineNumber="255"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// we discover an explicit setreg that means this block doesn&#39;t have any</span></CodeLine>
<Link id="l00256" /><CodeLine lineNumber="256"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// initial requirements.</span></CodeLine>
<Link id="l00257" /><CodeLine lineNumber="257"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RequirePending = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00258" /><CodeLine lineNumber="258"><span class="doxyHighlight">  <a href="/docs/api/structs/status">Status</a> IPChange;</span></CodeLine>
<Link id="l00259" /><CodeLine lineNumber="259"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l00260" /><CodeLine lineNumber="260"><span class="doxyHighlight">    <a href="/docs/api/structs/status">Status</a> InstrMode = <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a7ab3269e00ecb2ad7713f6ee21c70a96">getInstructionMode</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>);</span></CodeLine>
<Link id="l00261" /><CodeLine lineNumber="261"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == AMDGPU::S&#95;SETREG&#95;B32 ||</span></CodeLine>
<Link id="l00262" /><CodeLine lineNumber="262"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == AMDGPU::S&#95;SETREG&#95;B32&#95;mode ||</span></CodeLine>
<Link id="l00263" /><CodeLine lineNumber="263"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == AMDGPU::S&#95;SETREG&#95;IMM32&#95;B32 ||</span></CodeLine>
<Link id="l00264" /><CodeLine lineNumber="264"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == AMDGPU::S&#95;SETREG&#95;IMM32&#95;B32&#95;mode) &#123;</span></CodeLine>
<Link id="l00265" /><CodeLine lineNumber="265"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We preserve any explicit mode register setreg instruction we encounter,</span></CodeLine>
<Link id="l00266" /><CodeLine lineNumber="266"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// as we assume it has been inserted by a higher authority (this is</span></CodeLine>
<Link id="l00267" /><CodeLine lineNumber="267"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// likely to be a very rare occurrence).</span></CodeLine>
<Link id="l00268" /><CodeLine lineNumber="268"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Dst = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getNamedOperand(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, AMDGPU::OpName::simm16)-&gt;getImm();</span></CodeLine>
<Link id="l00269" /><CodeLine lineNumber="269"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">using namespace </span><span class="doxyHighlight"><a href="/docs/api/namespaces/llvm/amdgpu/hwreg">AMDGPU::Hwreg</a>;</span></CodeLine>
<Link id="l00270" /><CodeLine lineNumber="270"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#91;Id, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, Width&#93; = HwregEncoding::decode(Dst);</span></CodeLine>
<Link id="l00271" /><CodeLine lineNumber="271"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Id != ID&#95;MODE)</span></CodeLine>
<Link id="l00272" /><CodeLine lineNumber="272"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00273" /><CodeLine lineNumber="273"></CodeLine>
<Link id="l00274" /><CodeLine lineNumber="274"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Mask = <a href="/docs/api/namespaces/llvm/#a79dff91526e31b1a05f59eed6c189eb4">maskTrailingOnes&lt;unsigned&gt;</a>(Width) &lt;&lt; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</span></CodeLine>
<Link id="l00275" /><CodeLine lineNumber="275"></CodeLine>
<Link id="l00276" /><CodeLine lineNumber="276"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If an InsertionPoint is set we will insert a setreg there.</span></CodeLine>
<Link id="l00277" /><CodeLine lineNumber="277"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/insertionpoint">InsertionPoint</a>) &#123;</span></CodeLine>
<Link id="l00278" /><CodeLine lineNumber="278"><span class="doxyHighlight">        <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac5cb23515382def14508d54ee39bcc5f">insertSetreg</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/structs/insertionpoint">InsertionPoint</a>, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>, IPChange.<a href="/docs/api/structs/status/#a4d49768146ce886e2eb17aacd8159ca9">delta</a>(NewInfo-&gt;Change));</span></CodeLine>
<Link id="l00279" /><CodeLine lineNumber="279"><span class="doxyHighlight">        <a href="/docs/api/structs/insertionpoint">InsertionPoint</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00280" /><CodeLine lineNumber="280"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00281" /><CodeLine lineNumber="281"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If this is an immediate then we know the value being set, but if it is</span></CodeLine>
<Link id="l00282" /><CodeLine lineNumber="282"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// not an immediate then we treat the modified bits of the mode register</span></CodeLine>
<Link id="l00283" /><CodeLine lineNumber="283"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// as unknown.</span></CodeLine>
<Link id="l00284" /><CodeLine lineNumber="284"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == AMDGPU::S&#95;SETREG&#95;IMM32&#95;B32 ||</span></CodeLine>
<Link id="l00285" /><CodeLine lineNumber="285"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOpcode() == AMDGPU::S&#95;SETREG&#95;IMM32&#95;B32&#95;mode) &#123;</span></CodeLine>
<Link id="l00286" /><CodeLine lineNumber="286"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Val = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getNamedOperand(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, AMDGPU::OpName::imm)-&gt;getImm();</span></CodeLine>
<Link id="l00287" /><CodeLine lineNumber="287"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Mode = (Val &lt;&lt; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &amp; Mask;</span></CodeLine>
<Link id="l00288" /><CodeLine lineNumber="288"><span class="doxyHighlight">        <a href="/docs/api/structs/status">Status</a> Setreg = <a href="/docs/api/structs/status">Status</a>(Mask, Mode);</span></CodeLine>
<Link id="l00289" /><CodeLine lineNumber="289"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If we haven&#39;t already set the initial requirements for the block we</span></CodeLine>
<Link id="l00290" /><CodeLine lineNumber="290"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// don&#39;t need to as the requirements start from this explicit setreg.</span></CodeLine>
<Link id="l00291" /><CodeLine lineNumber="291"><span class="doxyHighlight">        RequirePending = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00292" /><CodeLine lineNumber="292"><span class="doxyHighlight">        NewInfo-&gt;Change = NewInfo-&gt;Change.merge(Setreg);</span></CodeLine>
<Link id="l00293" /><CodeLine lineNumber="293"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00294" /><CodeLine lineNumber="294"><span class="doxyHighlight">        NewInfo-&gt;Change = NewInfo-&gt;Change.mergeUnknown(Mask);</span></CodeLine>
<Link id="l00295" /><CodeLine lineNumber="295"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00296" /><CodeLine lineNumber="296"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewInfo-&gt;Change.isCompatible(InstrMode)) &#123;</span></CodeLine>
<Link id="l00297" /><CodeLine lineNumber="297"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// This instruction uses the Mode register and its requirements aren&#39;t</span></CodeLine>
<Link id="l00298" /><CodeLine lineNumber="298"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// compatible with the current mode.</span></CodeLine>
<Link id="l00299" /><CodeLine lineNumber="299"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/insertionpoint">InsertionPoint</a>) &#123;</span></CodeLine>
<Link id="l00300" /><CodeLine lineNumber="300"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If the required mode change cannot be included in the current</span></CodeLine>
<Link id="l00301" /><CodeLine lineNumber="301"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// InsertionPoint changes, we need a setreg and start a new</span></CodeLine>
<Link id="l00302" /><CodeLine lineNumber="302"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// InsertionPoint.</span></CodeLine>
<Link id="l00303" /><CodeLine lineNumber="303"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IPChange.<a href="/docs/api/structs/status/#a4d49768146ce886e2eb17aacd8159ca9">delta</a>(NewInfo-&gt;Change).<a href="/docs/api/structs/status/#a62c91ffba279ca27ad70766196e3367c">isCombinable</a>(InstrMode)) &#123;</span></CodeLine>
<Link id="l00304" /><CodeLine lineNumber="304"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RequirePending) &#123;</span></CodeLine>
<Link id="l00305" /><CodeLine lineNumber="305"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// This is the first insertionPoint in the block so we will defer</span></CodeLine>
<Link id="l00306" /><CodeLine lineNumber="306"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// the insertion of the setreg to Phase 3 where we know whether or</span></CodeLine>
<Link id="l00307" /><CodeLine lineNumber="307"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// not it is actually needed.</span></CodeLine>
<Link id="l00308" /><CodeLine lineNumber="308"><span class="doxyHighlight">            NewInfo-&gt;FirstInsertionPoint = <a href="/docs/api/structs/insertionpoint">InsertionPoint</a>;</span></CodeLine>
<Link id="l00309" /><CodeLine lineNumber="309"><span class="doxyHighlight">            NewInfo-&gt;Require = NewInfo-&gt;Change;</span></CodeLine>
<Link id="l00310" /><CodeLine lineNumber="310"><span class="doxyHighlight">            RequirePending = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00311" /><CodeLine lineNumber="311"><span class="doxyHighlight">          &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00312" /><CodeLine lineNumber="312"><span class="doxyHighlight">            <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac5cb23515382def14508d54ee39bcc5f">insertSetreg</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/structs/insertionpoint">InsertionPoint</a>, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>,</span></CodeLine>
<Link id="l00313" /><CodeLine lineNumber="313"><span class="doxyHighlight">                         IPChange.<a href="/docs/api/structs/status/#a4d49768146ce886e2eb17aacd8159ca9">delta</a>(NewInfo-&gt;Change));</span></CodeLine>
<Link id="l00314" /><CodeLine lineNumber="314"><span class="doxyHighlight">            IPChange = NewInfo-&gt;Change;</span></CodeLine>
<Link id="l00315" /><CodeLine lineNumber="315"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l00316" /><CodeLine lineNumber="316"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Set the new InsertionPoint</span></CodeLine>
<Link id="l00317" /><CodeLine lineNumber="317"><span class="doxyHighlight">          <a href="/docs/api/structs/insertionpoint">InsertionPoint</a> = &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>;</span></CodeLine>
<Link id="l00318" /><CodeLine lineNumber="318"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l00319" /><CodeLine lineNumber="319"><span class="doxyHighlight">        NewInfo-&gt;Change = NewInfo-&gt;Change.merge(InstrMode);</span></CodeLine>
<Link id="l00320" /><CodeLine lineNumber="320"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00321" /><CodeLine lineNumber="321"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// No InsertionPoint is currently set - this is either the first in</span></CodeLine>
<Link id="l00322" /><CodeLine lineNumber="322"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// the block or we have previously seen an explicit setreg.</span></CodeLine>
<Link id="l00323" /><CodeLine lineNumber="323"><span class="doxyHighlight">        <a href="/docs/api/structs/insertionpoint">InsertionPoint</a> = &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>;</span></CodeLine>
<Link id="l00324" /><CodeLine lineNumber="324"><span class="doxyHighlight">        IPChange = NewInfo-&gt;Change;</span></CodeLine>
<Link id="l00325" /><CodeLine lineNumber="325"><span class="doxyHighlight">        NewInfo-&gt;Change = NewInfo-&gt;Change.<a href="/docs/api/structs/status/#a7d238cf08ca2aca7b1ef0e8b7a4b0770">merge</a>(InstrMode);</span></CodeLine>
<Link id="l00326" /><CodeLine lineNumber="326"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00327" /><CodeLine lineNumber="327"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00328" /><CodeLine lineNumber="328"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00329" /><CodeLine lineNumber="329"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RequirePending) &#123;</span></CodeLine>
<Link id="l00330" /><CodeLine lineNumber="330"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we haven&#39;t yet set the initial requirements for the block we set them</span></CodeLine>
<Link id="l00331" /><CodeLine lineNumber="331"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// now.</span></CodeLine>
<Link id="l00332" /><CodeLine lineNumber="332"><span class="doxyHighlight">    NewInfo-&gt;FirstInsertionPoint = <a href="/docs/api/structs/insertionpoint">InsertionPoint</a>;</span></CodeLine>
<Link id="l00333" /><CodeLine lineNumber="333"><span class="doxyHighlight">    NewInfo-&gt;Require = NewInfo-&gt;Change;</span></CodeLine>
<Link id="l00334" /><CodeLine lineNumber="334"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/insertionpoint">InsertionPoint</a>) &#123;</span></CodeLine>
<Link id="l00335" /><CodeLine lineNumber="335"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We need to insert a setreg at the InsertionPoint</span></CodeLine>
<Link id="l00336" /><CodeLine lineNumber="336"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac5cb23515382def14508d54ee39bcc5f">insertSetreg</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/structs/insertionpoint">InsertionPoint</a>, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>, IPChange.<a href="/docs/api/structs/status/#a4d49768146ce886e2eb17aacd8159ca9">delta</a>(NewInfo-&gt;Change));</span></CodeLine>
<Link id="l00337" /><CodeLine lineNumber="337"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00338" /><CodeLine lineNumber="338"><span class="doxyHighlight">  NewInfo-&gt;Exit = NewInfo-&gt;Change;</span></CodeLine>
<Link id="l00339" /><CodeLine lineNumber="339"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.getNumber()&#93; = std::move(NewInfo);</span></CodeLine>
<Link id="l00340" /><CodeLine lineNumber="340"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00341" /><CodeLine lineNumber="341"></CodeLine>
<Link id="l00342" /><CodeLine lineNumber="342"><span class="doxyHighlightComment">// In Phase 2 we revisit each block and calculate the common Mode register</span></CodeLine>
<Link id="l00343" /><CodeLine lineNumber="343"><span class="doxyHighlightComment">// value provided by all predecessor blocks. If the Exit value for the block</span></CodeLine>
<Link id="l00344" /><CodeLine lineNumber="344"><span class="doxyHighlightComment">// is changed, then we add the successor blocks to the worklist so that the</span></CodeLine>
<Link id="l00345" /><CodeLine lineNumber="345"><span class="doxyHighlightComment">// exit value is propagated.</span></CodeLine>
<Link id="l00346" /><CodeLine lineNumber="346" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa6dcb5a067510ae66e6c6ff91840dd75"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa6dcb5a067510ae66e6c6ff91840dd75">SIModeRegister::processBlockPhase2</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>,</span></CodeLine>
<Link id="l00347" /><CodeLine lineNumber="347"><span class="doxyHighlight">                                        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>) &#123;</span></CodeLine>
<Link id="l00348" /><CodeLine lineNumber="348"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RevisitRequired = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00349" /><CodeLine lineNumber="349"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ExitSet = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00350" /><CodeLine lineNumber="350"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ThisBlock = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.getNumber();</span></CodeLine>
<Link id="l00351" /><CodeLine lineNumber="351"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.pred&#95;empty()) &#123;</span></CodeLine>
<Link id="l00352" /><CodeLine lineNumber="352"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// There are no predecessors, so use the default starting status.</span></CodeLine>
<Link id="l00353" /><CodeLine lineNumber="353"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred = <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a1776b23a29cc38d2af1623b30be28b5b">DefaultStatus</a>;</span></CodeLine>
<Link id="l00354" /><CodeLine lineNumber="354"><span class="doxyHighlight">    ExitSet = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00355" /><CodeLine lineNumber="355"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00356" /><CodeLine lineNumber="356"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Build a status that is common to all the predecessors by intersecting</span></CodeLine>
<Link id="l00357" /><CodeLine lineNumber="357"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// all the predecessor exit status values.</span></CodeLine>
<Link id="l00358" /><CodeLine lineNumber="358"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Mask bits (which represent the Mode bits with a known value) can only be</span></CodeLine>
<Link id="l00359" /><CodeLine lineNumber="359"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// added by explicit SETREG instructions or the initial default value -</span></CodeLine>
<Link id="l00360" /><CodeLine lineNumber="360"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the intersection process may remove Mask bits.</span></CodeLine>
<Link id="l00361" /><CodeLine lineNumber="361"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we find a predecessor that has not yet had an exit value determined</span></CodeLine>
<Link id="l00362" /><CodeLine lineNumber="362"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// (this can happen for example if a block is its own predecessor) we defer</span></CodeLine>
<Link id="l00363" /><CodeLine lineNumber="363"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// use of that value as the Mask will be all zero, and we will revisit this</span></CodeLine>
<Link id="l00364" /><CodeLine lineNumber="364"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// block again later (unless the only predecessor without an exit value is</span></CodeLine>
<Link id="l00365" /><CodeLine lineNumber="365"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// this block).</span></CodeLine>
<Link id="l00366" /><CodeLine lineNumber="366"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock/#aa3e6549a5c552971ce60013e2e7c6154">MachineBasicBlock::pred&#95;iterator</a> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.pred&#95;begin(), E = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.pred&#95;end();</span></CodeLine>
<Link id="l00367" /><CodeLine lineNumber="367"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#afd1501c49c84f3addfd108c2484f5674">PB</a> = &#42;(&#42;P);</span></CodeLine>
<Link id="l00368" /><CodeLine lineNumber="368"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> PredBlock = <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#afd1501c49c84f3addfd108c2484f5674">PB</a>.getNumber();</span></CodeLine>
<Link id="l00369" /><CodeLine lineNumber="369"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((ThisBlock == PredBlock) &amp;&amp; (std::next(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>) == E)) &#123;</span></CodeLine>
<Link id="l00370" /><CodeLine lineNumber="370"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred = <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a1776b23a29cc38d2af1623b30be28b5b">DefaultStatus</a>;</span></CodeLine>
<Link id="l00371" /><CodeLine lineNumber="371"><span class="doxyHighlight">      ExitSet = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00372" /><CodeLine lineNumber="372"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;PredBlock&#93;-&gt;ExitSet) &#123;</span></CodeLine>
<Link id="l00373" /><CodeLine lineNumber="373"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred = <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;PredBlock&#93;-&gt;Exit;</span></CodeLine>
<Link id="l00374" /><CodeLine lineNumber="374"><span class="doxyHighlight">      ExitSet = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00375" /><CodeLine lineNumber="375"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PredBlock != ThisBlock)</span></CodeLine>
<Link id="l00376" /><CodeLine lineNumber="376"><span class="doxyHighlight">      RevisitRequired = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00377" /><CodeLine lineNumber="377"></CodeLine>
<Link id="l00378" /><CodeLine lineNumber="378"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = std::next(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>); <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> != E; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = std::next(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>)) &#123;</span></CodeLine>
<Link id="l00379" /><CodeLine lineNumber="379"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;Pred = &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</span></CodeLine>
<Link id="l00380" /><CodeLine lineNumber="380"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> PredBlock = Pred-&gt;getNumber();</span></CodeLine>
<Link id="l00381" /><CodeLine lineNumber="381"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;PredBlock&#93;-&gt;ExitSet) &#123;</span></CodeLine>
<Link id="l00382" /><CodeLine lineNumber="382"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;ExitSet) &#123;</span></CodeLine>
<Link id="l00383" /><CodeLine lineNumber="383"><span class="doxyHighlight">          <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred =</span></CodeLine>
<Link id="l00384" /><CodeLine lineNumber="384"><span class="doxyHighlight">              <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred.intersect(<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;PredBlock&#93;-&gt;Exit);</span></CodeLine>
<Link id="l00385" /><CodeLine lineNumber="385"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00386" /><CodeLine lineNumber="386"><span class="doxyHighlight">          <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred = <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;PredBlock&#93;-&gt;Exit;</span></CodeLine>
<Link id="l00387" /><CodeLine lineNumber="387"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l00388" /><CodeLine lineNumber="388"><span class="doxyHighlight">        ExitSet = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00389" /><CodeLine lineNumber="389"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PredBlock != ThisBlock)</span></CodeLine>
<Link id="l00390" /><CodeLine lineNumber="390"><span class="doxyHighlight">        RevisitRequired = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00391" /><CodeLine lineNumber="391"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00392" /><CodeLine lineNumber="392"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00393" /><CodeLine lineNumber="393"><span class="doxyHighlight">  <a href="/docs/api/structs/status">Status</a> TmpStatus =</span></CodeLine>
<Link id="l00394" /><CodeLine lineNumber="394"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred.merge(<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Change);</span></CodeLine>
<Link id="l00395" /><CodeLine lineNumber="395"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Exit != TmpStatus) &#123;</span></CodeLine>
<Link id="l00396" /><CodeLine lineNumber="396"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Exit = TmpStatus;</span></CodeLine>
<Link id="l00397" /><CodeLine lineNumber="397"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Add the successors to the work list so we can propagate the changed exit</span></CodeLine>
<Link id="l00398" /><CodeLine lineNumber="398"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// status.</span></CodeLine>
<Link id="l00399" /><CodeLine lineNumber="399"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;Succ : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.successors())</span></CodeLine>
<Link id="l00400" /><CodeLine lineNumber="400"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a8269d92f6cbf40bffdcf0ad155f81caa">Phase2List</a>.push(Succ);</span></CodeLine>
<Link id="l00401" /><CodeLine lineNumber="401"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00402" /><CodeLine lineNumber="402"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;ExitSet = ExitSet;</span></CodeLine>
<Link id="l00403" /><CodeLine lineNumber="403"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RevisitRequired)</span></CodeLine>
<Link id="l00404" /><CodeLine lineNumber="404"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a8269d92f6cbf40bffdcf0ad155f81caa">Phase2List</a>.push(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l00405" /><CodeLine lineNumber="405"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00406" /><CodeLine lineNumber="406"></CodeLine>
<Link id="l00407" /><CodeLine lineNumber="407"><span class="doxyHighlightComment">// In Phase 3 we revisit each block and if it has an insertion point defined we</span></CodeLine>
<Link id="l00408" /><CodeLine lineNumber="408"><span class="doxyHighlightComment">// check whether the predecessor mode meets the block&#39;s entry requirements. If</span></CodeLine>
<Link id="l00409" /><CodeLine lineNumber="409"><span class="doxyHighlightComment">// not we insert an appropriate setreg instruction to modify the Mode register.</span></CodeLine>
<Link id="l00410" /><CodeLine lineNumber="410" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aaeb9e3fc136861bdf85b5e512cf7370a"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aaeb9e3fc136861bdf85b5e512cf7370a">SIModeRegister::processBlockPhase3</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>,</span></CodeLine>
<Link id="l00411" /><CodeLine lineNumber="411"><span class="doxyHighlight">                                        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>) &#123;</span></CodeLine>
<Link id="l00412" /><CodeLine lineNumber="412"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ThisBlock = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.getNumber();</span></CodeLine>
<Link id="l00413" /><CodeLine lineNumber="413"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred.isCompatible(<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Require)) &#123;</span></CodeLine>
<Link id="l00414" /><CodeLine lineNumber="414"><span class="doxyHighlight">    <a href="/docs/api/structs/status">Status</a> Delta =</span></CodeLine>
<Link id="l00415" /><CodeLine lineNumber="415"><span class="doxyHighlight">        <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Pred.delta(<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;Require);</span></CodeLine>
<Link id="l00416" /><CodeLine lineNumber="416"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;FirstInsertionPoint)</span></CodeLine>
<Link id="l00417" /><CodeLine lineNumber="417"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac5cb23515382def14508d54ee39bcc5f">insertSetreg</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>&#91;ThisBlock&#93;-&gt;FirstInsertionPoint, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>, Delta);</span></CodeLine>
<Link id="l00418" /><CodeLine lineNumber="418"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00419" /><CodeLine lineNumber="419"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac5cb23515382def14508d54ee39bcc5f">insertSetreg</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.instr&#95;front(), <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>, Delta);</span></CodeLine>
<Link id="l00420" /><CodeLine lineNumber="420"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00421" /><CodeLine lineNumber="421"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00422" /><CodeLine lineNumber="422"></CodeLine>
<Link id="l00423" /><CodeLine lineNumber="423" lineLink="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a684cafae350ec693de0255b23ba6d6f5"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a684cafae350ec693de0255b23ba6d6f5">SIModeRegister::runOnMachineFunction</a>(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF) &#123;</span></CodeLine>
<Link id="l00424" /><CodeLine lineNumber="424"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Constrained FP intrinsics are used to support non-default rounding modes.</span></CodeLine>
<Link id="l00425" /><CodeLine lineNumber="425"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// strictfp attribute is required to mark functions with strict FP semantics</span></CodeLine>
<Link id="l00426" /><CodeLine lineNumber="426"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// having constrained FP intrinsics. This pass fixes up operations that uses</span></CodeLine>
<Link id="l00427" /><CodeLine lineNumber="427"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// a non-default rounding mode for non-strictfp functions. But it should not</span></CodeLine>
<Link id="l00428" /><CodeLine lineNumber="428"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// assume or modify any default rounding modes in case of strictfp functions.</span></CodeLine>
<Link id="l00429" /><CodeLine lineNumber="429"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/function">Function</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = MF.<a href="/docs/api/classes/llvm/machinefunction/#a977ddce262de45c645be23d951066351">getFunction</a>();</span></CodeLine>
<Link id="l00430" /><CodeLine lineNumber="430"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasFnAttribute(llvm::Attribute::StrictFP))</span></CodeLine>
<Link id="l00431" /><CodeLine lineNumber="431"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a7a008d4f9f492f02b4c00fe05bba46d4">Changed</a>;</span></CodeLine>
<Link id="l00432" /><CodeLine lineNumber="432"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>.resize(MF.<a href="/docs/api/classes/llvm/machinefunction/#aa22424ba23740b6a748e8d0c239b7e4c">getNumBlockIDs</a>());</span></CodeLine>
<Link id="l00433" /><CodeLine lineNumber="433"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/gcnsubtarget">GCNSubtarget</a> &amp;ST = MF.<a href="/docs/api/classes/llvm/machinefunction/#a3825368aca2bc1550d173660df4da6a6">getSubtarget</a>&lt;<a href="/docs/api/classes/llvm/gcnsubtarget">GCNSubtarget</a>&gt;();</span></CodeLine>
<Link id="l00434" /><CodeLine lineNumber="434"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/siinstrinfo">SIInstrInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a> = ST.getInstrInfo();</span></CodeLine>
<Link id="l00435" /><CodeLine lineNumber="435"></CodeLine>
<Link id="l00436" /><CodeLine lineNumber="436"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Processing is performed in a number of phases</span></CodeLine>
<Link id="l00437" /><CodeLine lineNumber="437"></CodeLine>
<Link id="l00438" /><CodeLine lineNumber="438"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Phase 1 - determine the initial mode required by each block, and add setreg</span></CodeLine>
<Link id="l00439" /><CodeLine lineNumber="439"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instructions for intra block requirements.</span></CodeLine>
<Link id="l00440" /><CodeLine lineNumber="440"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;BB : MF)</span></CodeLine>
<Link id="l00441" /><CodeLine lineNumber="441"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#acf320f6e863d6b402e856a2c603d5ab5">processBlockPhase1</a>(BB, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>);</span></CodeLine>
<Link id="l00442" /><CodeLine lineNumber="442"></CodeLine>
<Link id="l00443" /><CodeLine lineNumber="443"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Phase 2 - determine the exit mode from each block. We add all blocks to the</span></CodeLine>
<Link id="l00444" /><CodeLine lineNumber="444"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// list here, but will also add any that need to be revisited during Phase 2</span></CodeLine>
<Link id="l00445" /><CodeLine lineNumber="445"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// processing.</span></CodeLine>
<Link id="l00446" /><CodeLine lineNumber="446"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;BB : MF)</span></CodeLine>
<Link id="l00447" /><CodeLine lineNumber="447"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a8269d92f6cbf40bffdcf0ad155f81caa">Phase2List</a>.push(&amp;BB);</span></CodeLine>
<Link id="l00448" /><CodeLine lineNumber="448"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a8269d92f6cbf40bffdcf0ad155f81caa">Phase2List</a>.empty()) &#123;</span></CodeLine>
<Link id="l00449" /><CodeLine lineNumber="449"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aa6dcb5a067510ae66e6c6ff91840dd75">processBlockPhase2</a>(&#42;<a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a8269d92f6cbf40bffdcf0ad155f81caa">Phase2List</a>.front(), <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>);</span></CodeLine>
<Link id="l00450" /><CodeLine lineNumber="450"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a8269d92f6cbf40bffdcf0ad155f81caa">Phase2List</a>.pop();</span></CodeLine>
<Link id="l00451" /><CodeLine lineNumber="451"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00452" /><CodeLine lineNumber="452"></CodeLine>
<Link id="l00453" /><CodeLine lineNumber="453"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Phase 3 - add an initial setreg to each block where the required entry mode</span></CodeLine>
<Link id="l00454" /><CodeLine lineNumber="454"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is not satisfied by the exit mode of all its predecessors.</span></CodeLine>
<Link id="l00455" /><CodeLine lineNumber="455"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;BB : MF)</span></CodeLine>
<Link id="l00456" /><CodeLine lineNumber="456"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#aaeb9e3fc136861bdf85b5e512cf7370a">processBlockPhase3</a>(BB, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>);</span></CodeLine>
<Link id="l00457" /><CodeLine lineNumber="457"></CodeLine>
<Link id="l00458" /><CodeLine lineNumber="458"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#ac4f05bcf45cd030cea51ac45cda0123f">BlockInfo</a>.clear();</span></CodeLine>
<Link id="l00459" /><CodeLine lineNumber="459"></CodeLine>
<Link id="l00460" /><CodeLine lineNumber="460"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-simoderegister-cpp-/simoderegister/#a7a008d4f9f492f02b4c00fe05bba46d4">Changed</a>;</span></CodeLine>
<Link id="l00461" /><CodeLine lineNumber="461"><span class="doxyHighlight">&#125;</span></CodeLine>

</ProgramListing>


</DoxygenPage>
