---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - file

---

import Link from '@docusaurus/Link'

import CodeLine from '@xpack/docusaurus-plugin-doxygen/components/CodeLine'
import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import Highlight from '@xpack/docusaurus-plugin-doxygen/components/Highlight'
import IncludesList from '@xpack/docusaurus-plugin-doxygen/components/IncludesList'
import IncludesListItem from '@xpack/docusaurus-plugin-doxygen/components/IncludesListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import ProgramListing from '@xpack/docusaurus-plugin-doxygen/components/ProgramListing'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `LoopStrengthReduce.cpp` File Reference

<DoxygenPage pluginConfig={pluginConfig}>



## Included Headers

<IncludesList>
<IncludesListItem
  filePath="llvm/Transforms/Scalar/LoopStrengthReduce.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/scalar/loopstrengthreduce-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/APInt.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/apint-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/DenseMap.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/densemap-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/DenseSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/denseset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/Hashing.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/hashing-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/PointerIntPair.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/pointerintpair-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/STLExtras.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/stlextras-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SetVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/setvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallBitVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallbitvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallPtrSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallptrset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/Statistic.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/iterator_range.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/iterator-range-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/AssumptionCache.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/assumptioncache-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/DomTreeUpdater.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/domtreeupdater-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/IVUsers.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/ivusers-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/LoopAnalysisManager.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/loopanalysismanager-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/LoopInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/loopinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/LoopPass.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/looppass-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/MemorySSA.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/memoryssa-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/MemorySSAUpdater.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/memoryssaupdater-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ScalarEvolution.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolution-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ScalarEvolutionExpressions.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolutionexpressions-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ScalarEvolutionNormalization.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolutionnormalization-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/TargetLibraryInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/targetlibraryinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/TargetTransformInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/targettransforminfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ValueTracking.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/valuetracking-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/BinaryFormat/Dwarf.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/binaryformat/dwarf-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Config/llvm-config.h"
  permalink=""
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/BasicBlock.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/basicblock-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Constant.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/constant-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Constants.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/constants-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DebugInfoMetadata.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/debuginfometadata-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DerivedTypes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/derivedtypes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Dominators.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/dominators-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/GlobalValue.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/globalvalue-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/IRBuilder.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/irbuilder-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/InstrTypes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/instrtypes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Instruction.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/instruction-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Instructions.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/instructions-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/IntrinsicInst.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/intrinsicinst-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Module.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/module-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Operator.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/operator-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Type.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/type-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Use.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/use-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/User.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/user-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Value.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/value-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/ValueHandle.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/valuehandle-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/InitializePasses.h"
  permalink="/docs/api/files/include/include/llvm/initializepasses-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Pass.h"
  permalink="/docs/api/files/include/include/llvm/pass-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Casting.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/casting-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/CommandLine.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Compiler.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Debug.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/debug-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/ErrorHandling.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/MathExtras.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/mathextras-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/raw_ostream.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/raw-ostream-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Scalar.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/scalar-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/utils-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/BasicBlockUtils.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/basicblockutils-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/Local.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/local-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/LoopUtils.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/looputils-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/ScalarEvolutionExpander.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/scalarevolutionexpander-h"
  isLocal="true" />
<IncludesListItem
  filePath="algorithm"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cassert"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cstddef"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cstdint"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="iterator"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="limits"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="map"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="numeric"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="optional"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="utility"
  permalink=""
  isLocal="false" />
</IncludesList>

## Namespaces Index

<MembersIndex>

<MembersIndexItem
  type="namespace"
  name={<><a href="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-">anonymous&#123;LoopStrengthReduce.cpp&#125;</a></>}>
</MembersIndexItem>

</MembersIndex>

## Classes Index

<MembersIndex>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a></>}>
This class holds data which is used to order reuse candidates. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate">KeyOrderTargetImmediate</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate">KeyOrderSizeTAndImmediate</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a></>}>
Map register candidates to information about how they are used. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a></>}>
This class holds information that describes a formula for computing satisfying a use. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a></>}>
This class is used to measure and compare candidate formulae. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a></>}>
An operand value in an instruction which is to be replaced with some equivalent, possibly strength-reduced, replacement. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo">UniquifierDenseMapInfo</a></>}>
A <a href="/docs/api/structs/llvm/densemapinfo">DenseMapInfo</a> implementation for holding DenseMaps and DenseSets of sorted SmallVectors of const SCEV&#42;. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a></>}>
This class holds the state that LSR keeps for each use in <a href="/docs/api/classes/llvm/ivusers">IVUsers</a>, as well as uses invented by LSR itself. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a></>}>
An individual increment in a Chain of IV increments. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers">ChainUsers</a></>}>
Helper for CollectChains to track multiple IV increment uses. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance">LSRInstance</a></>}>
This class holds state for the main loop strength reduction logic. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem">WorkItem</a></>}>
Helper class for GenerateCrossUseConstantOffsets. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce">LoopStrengthReduce</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder">SCEVDbgValueBuilder</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec">DVIRecoveryRec</a></>}>
Holds all the required data to salvage a dbg.value using the pre-LSR SCEVs and <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#details">More...</a>
</MembersIndexItem>

</MembersIndex>

## Functions Index

<MembersIndex>

<MembersIndexItem
  type="bool"
  name={<><a href="#ad35b9a85ea52062375c0c870be5cd228">canFoldIVIncExpr</a> (const SCEV &#42;IncExpr, Instruction &#42;UserInst, Value &#42;Operand, const TargetTransformInfo &amp;TTI)</>}>
Return true if the <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> can be folded into an addressing mode. <a href="#ad35b9a85ea52062375c0c870be5cd228">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aa12378426474ba414b8bc234a26fd19b">canHoistIVInc</a> (const TargetTransformInfo &amp;TTI, const LSRFixup &amp;Fixup, const LSRUse &amp;LU, Instruction &#42;IVIncInsertPos, Loop &#42;L)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</>}
  name={<><a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a> (const SCEV &#42;S, const SCEVConstant &#42;C, SmallVectorImpl&lt; const SCEV &#42; &gt; &amp;Ops, const Loop &#42;L, ScalarEvolution &amp;SE, unsigned Depth=0)</>}>
Split S into subexpressions which can be pulled out into separate registers. <a href="#ad0531a07d7868c1577980524cf2add3a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a> (const SCEV &#42;S, const Loop &amp;L)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a9766c807d5c90cf726463e300d0787d8">DbgGatherSalvagableDVI</a> (Loop &#42;L, ScalarEvolution &amp;SE, SmallVector&lt; std::unique&#95;ptr&lt; DVIRecoveryRec &gt;, 2 &gt; &amp;SalvageableDVISCEVs, SmallSet&lt; AssertingVH&lt; DbgValueInst &gt;, 2 &gt; &amp;DVIHandles)</>}>
Identify and cache salvageable DVI locations and expressions along with the corresponding SCEV(s). <a href="#a9766c807d5c90cf726463e300d0787d8">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a9188ba3c048bf8057af2b2ac144b9f0f">DbgRewriteSalvageableDVIs</a> (llvm::Loop &#42;L, ScalarEvolution &amp;SE, llvm::PHINode &#42;LSRInductionVar, SmallVector&lt; std::unique&#95;ptr&lt; DVIRecoveryRec &gt;, 2 &gt; &amp;DVIToUpdate)</>}>
Obtain an expression for the iteration count, then attempt to salvage the dbg.value intrinsics. <a href="#a9188ba3c048bf8057af2b2ac144b9f0f">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a> (const SCEV &#42;S, Loop &#42;L, SmallVectorImpl&lt; const SCEV &#42; &gt; &amp;Good, SmallVectorImpl&lt; const SCEV &#42; &gt; &amp;Bad, ScalarEvolution &amp;SE)</>}>
Recursion helper for initialMatch. <a href="#aa59a46776e15b1f1bd597c4e1e769f59">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="Immediate"
  name={<><a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a> (const SCEV &#42;&amp;S, ScalarEvolution &amp;SE)</>}>
If S involves the addition of a constant integer value, return that integer value, and mutate S to point to a new <a href="/docs/api/classes/llvm/scev">SCEV</a> with that value excluded. <a href="#a1a0afc5106fca20f0a81eac37db70ab9">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;</>}
  name={<><a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a> (const SCEV &#42;&amp;S, ScalarEvolution &amp;SE)</>}>
If S involves the addition of a <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> address, return that symbol, and mutate S to point to a new <a href="/docs/api/classes/llvm/scev">SCEV</a> with that value excluded. <a href="#a45b1664e25bf2a7220367462f2580044">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a></>}
  name={<><a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a> (User::op&#95;iterator OI, User::op&#95;iterator OE, Loop &#42;L, ScalarEvolution &amp;SE)</>}>
Helper for CollectChains that finds an IV operand (computed by an AddRec in this loop) within &#91;OI,OE) or returns OE. <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="MemAccessTy"
  name={<><a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a> (const TargetTransformInfo &amp;TTI, Instruction &#42;Inst, Value &#42;OperandVal)</>}>
Return the type of the memory being accessed. <a href="#a7f4680b383ce7138bc2c12de282b14b4">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</>}
  name={<><a href="#ae0228f64a74eb3e9fc5343b024ab9a42">getAnyExtendConsideringPostIncUses</a> (ArrayRef&lt; PostIncLoopSet &gt; Loops, const SCEV &#42;Expr, Type &#42;ToTy, ScalarEvolution &amp;SE)</>}>
Extend/Truncate <code>Expr</code> to <code>ToTy</code> considering post-inc uses in <code>Loops</code>. <a href="#ae0228f64a74eb3e9fc5343b024ab9a42">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</>}
  name={<><a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a> (const SCEV &#42;LHS, const SCEV &#42;RHS, ScalarEvolution &amp;SE, bool IgnoreSignificantBits=false)</>}>
Return an expression for LHS /s RHS, if it can be determined and if the remainder is known to be zero, or null otherwise. <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</>}
  name={<><a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a> (const SCEV &#42;S)</>}>
Return an approximation of this <a href="/docs/api/classes/llvm/scev">SCEV</a> expression&#39;s &quot;base&quot;, or NULL for any constant. <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;</>}
  name={<><a href="#a6612c20f7ca23077265026ea4991e2b6">GetInductionVariable</a> (const Loop &amp;L, ScalarEvolution &amp;SE, const LSRInstance &amp;LSR)</>}>
Ideally pick the PHI IV inserted by ScalarEvolutionExpander. <a href="#a6612c20f7ca23077265026ea4991e2b6">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a></>}
  name={<><a href="#a3cbf7279944dc2f0f99a6896501277f9">getScalingFactorCost</a> (const TargetTransformInfo &amp;TTI, const LSRUse &amp;LU, const Formula &amp;F, const Loop &amp;L)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="unsigned"
  name={<><a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a> (const SCEV &#42;Reg, unsigned Depth)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">Value</a> &#42;</>}
  name={<><a href="#a7c340cc26f0c6d27219747cac55a2dc2">getValueOrPoison</a> (WeakVH &amp;VH, LLVMContext &amp;C)</>}>
Cached location ops may be erased during LSR, in which case a poison is required when restoring from the cache. <a href="#a7c340cc26f0c6d27219747cac55a2dc2">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">Value</a> &#42;</>}
  name={<><a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a> (Value &#42;Oper)</>}>
<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a> logic must consistently peek base <a href="/docs/api/classes/llvm/truncinst">TruncInst</a> operands, so wrap it in a convenient helper. <a href="#a0ef5c4bf982afaa71a03555b138aba58">More...</a>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a0cf26a507ec1ff72dd6624ac9b69d05c">INITIALIZE&#95;PASS&#95;BEGIN</a> (LoopStrengthReduce, &quot;loop-reduce&quot;, &quot;Loop Strength Reduction&quot;, false, false) INITIALIZE&#95;PASS&#95;END(LoopStrengthReduce</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a9b6b892760677b9b11c517eb5a46557f">isAddRecSExtable</a> (const SCEVAddRecExpr &#42;AR, ScalarEvolution &amp;SE)</>}>
Return true if the given addrec can be sign-extended without changing its value. <a href="#a9b6b892760677b9b11c517eb5a46557f">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a> (const TargetTransformInfo &amp;TTI, Instruction &#42;Inst, Value &#42;OperandVal)</>}>
Returns true if the specified instruction is using the specified value as an address. <a href="#a4120d81bd505176f5cadf647f5b8c7ef">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a1509f8a0c11e955037b00ce7542e24a7">isAddSExtable</a> (const SCEVAddExpr &#42;A, ScalarEvolution &amp;SE)</>}>
Return true if the given add can be sign-extended without changing its value. <a href="#a1509f8a0c11e955037b00ce7542e24a7">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a> (const TargetTransformInfo &amp;TTI, LSRUse::KindType Kind, MemAccessTy AccessTy, GlobalValue &#42;BaseGV, Immediate BaseOffset, bool HasBaseReg)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a290c161463cbfb7720d6499dba1310ad">isAlwaysFoldable</a> (const TargetTransformInfo &amp;TTI, ScalarEvolution &amp;SE, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, const SCEV &#42;S, bool HasBaseReg)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a> (const TargetTransformInfo &amp;TTI, const LSRUse &amp;LU, const Formula &amp;F)</>}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if the addressing mode defined by <code>F</code> is completely folded in <code>LU</code> at isel time. <a href="#aa847a3eff7b875035d9f887587291940">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a07e234e9b040a89b10635c52640987c9">isAMCompletelyFolded</a> (const TargetTransformInfo &amp;TTI, LSRUse::KindType Kind, MemAccessTy AccessTy, GlobalValue &#42;BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale, Instruction &#42;Fixup=nullptr)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a111eaa1963537539371757fda03a8d07">isAMCompletelyFolded</a> (const TargetTransformInfo &amp;TTI, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, GlobalValue &#42;BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aa4449f10e66ebab87164f4bf5bfd67d9">isAMCompletelyFolded</a> (const TargetTransformInfo &amp;TTI, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, const Formula &amp;F, const Loop &amp;L)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a3c81223cabf643af27adba3b3ceb680c">isExistingPhi</a> (const SCEVAddRecExpr &#42;AR, ScalarEvolution &amp;SE)</>}>
Return true if this AddRec is already a phi in its loop. <a href="#a3c81223cabf643af27adba3b3ceb680c">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a> (const SCEV &#42;S, SmallPtrSetImpl&lt; const SCEV &#42; &gt; &amp;Processed, ScalarEvolution &amp;SE)</>}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if expanding this expression is likely to incur significant cost. <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a52f2bc4870549427a397721a7de9849f">isLegalAddImmediate</a> (const TargetTransformInfo &amp;TTI, Immediate Offset)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a> (const TargetTransformInfo &amp;TTI, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, GlobalValue &#42;BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale)</>}>
Test whether we know how to expand the current formula. <a href="#a2e520a15f4578a464f9caaac2f4758ae">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a0cde97c20a134a57a746859698291aaa">isLegalUse</a> (const TargetTransformInfo &amp;TTI, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, const Formula &amp;F)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a32cdb4a97c185f1acbe11f45fcc70d12">isMulSExtable</a> (const SCEVMulExpr &#42;M, ScalarEvolution &amp;SE)</>}>
Return true if the given mul can be sign-extended without changing its value. <a href="#a32cdb4a97c185f1acbe11f45fcc70d12">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aca012302770ad32503de5e2c62344290">isProfitableChain</a> (IVChain &amp;Chain, SmallPtrSetImpl&lt; Instruction &#42; &gt; &amp;Users, ScalarEvolution &amp;SE, const TargetTransformInfo &amp;TTI)</>}>
Return true if the number of registers needed for the chain is estimated to be less than the number required for the individual IV users. <a href="#aca012302770ad32503de5e2c62344290">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a6c630dc63715497e5e49ab1ca9dc6ccb">IsSimplerBaseSCEVForTarget</a> (const TargetTransformInfo &amp;TTI, ScalarEvolution &amp;SE, const SCEV &#42;Best, const SCEV &#42;Reg, MemAccessTy AccessType)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a187751c86d349fac41ddc1b807b40b22">mayUsePostIncMode</a> (const TargetTransformInfo &amp;TTI, LSRUse &amp;LU, const SCEV &#42;S, const Loop &#42;L, ScalarEvolution &amp;SE)</>}>
Return true if the <a href="/docs/api/classes/llvm/scev">SCEV</a> represents a value that may end up as a post-increment operation. <a href="#a187751c86d349fac41ddc1b807b40b22">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="unsigned"
  name={<><a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a> (SmallVectorImpl&lt; uint64&#95;t &gt; &amp;Expr)</>}>
Returns the total number of DW&#95;OP&#95;llvm&#95;arg operands in the expression. <a href="#a80e922a79a22107b2f70e851825d098e">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#ac33f356faceb9655cb64611d2971d24f">ReduceLoopStrength</a> (Loop &#42;L, IVUsers &amp;IU, ScalarEvolution &amp;SE, DominatorTree &amp;DT, LoopInfo &amp;LI, const TargetTransformInfo &amp;TTI, AssumptionCache &amp;AC, TargetLibraryInfo &amp;TLI, MemorySSA &#42;MSSA)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a196b104079c33f7ccd4ad4816376b9a7">restorePreTransformState</a> (DVIRecoveryRec &amp;DVIRec)</>}>
Restore the DVI&#39;s pre-LSR arguments. Substitute undef for any erased values. <a href="#a196b104079c33f7ccd4ad4816376b9a7">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a02cf9d6ac96ae27b406798da5c2eb7ea">SalvageDVI</a> (llvm::Loop &#42;L, ScalarEvolution &amp;SE, llvm::PHINode &#42;LSRInductionVar, DVIRecoveryRec &amp;DVIRec, const SCEV &#42;SCEVInductionVar, SCEVDbgValueBuilder IterCountExpr)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0">UpdateDbgValueInst</a> (DVIRecoveryRec &amp;DVIRec, SmallVectorImpl&lt; Value &#42; &gt; &amp;NewLocationOps, SmallVectorImpl&lt; uint64&#95;t &gt; &amp;NewExpr)</>}>
Write the new expression and new location ops for the dbg.value. <a href="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0">More...</a>
</MembersIndexItem>

<MembersIndexItem
  template={<>template &lt;typename T&gt;</>}
  type="void"
  name={<><a href="#a4d8f7ff97b22c5203b332a778c88b088">updateDVIWithLocation</a> (T &amp;DbgVal, Value &#42;Location, SmallVectorImpl&lt; uint64&#95;t &gt; &amp;Ops)</>}>
Overwrites DVI with the location and Ops as the <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>. <a href="#a4d8f7ff97b22c5203b332a778c88b088">More...</a>
</MembersIndexItem>

<MembersIndexItem
  template={<>template &lt;typename T&gt;</>}
  type="void"
  name={<><a href="#ab2e6fc08d8f586e4979511620c12ffa8">updateDVIWithLocations</a> (T &amp;DbgVal, SmallVectorImpl&lt; Value &#42; &gt; &amp;Locations, SmallVectorImpl&lt; uint64&#95;t &gt; &amp;Ops)</>}>
Overwrite DVI with locations placed into a DIArglist. <a href="#ab2e6fc08d8f586e4979511620c12ffa8">More...</a>
</MembersIndexItem>

</MembersIndex>

## Variables Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44">cl::boolOrDefault</a> &gt;</>}
  name={<><a href="#a57a769eb2fe11448940d81a19e0140e2">AllowDropSolutionIfLessProfitable</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; unsigned &gt;</>}
  name={<><a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a0ce46a19f824c65a4ddace1f4e9ac529">DropScaledForVScale</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a94a7203d75d594f7012f80d9130dcadf">EnablePhiElim</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a5ca5d2aa868eb59998bc43f224fec74f">EnableVScaleImmediates</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<>loop <a href="/docs/api/classes/llvm/loop">Loop</a> Strength</>}
  name={<><a href="#a81103f81d98fb1888c83e3f13d71d043">false</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#aad3193b74a34d43bf4e02188ce67d3b7">FilterSameScaledReg</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#aa957fcc885db5c56e419b4646d135311">LSRExpNarrow</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> unsigned</>}
  name={<><a href="#a73b3c5e7c72bf97886e2ed1f12e28d54">MaxIVUsers</a> = 200</>}>
MaxIVUsers is an arbitrary threshold that provides an early opportunity for bail out. <a href="#a73b3c5e7c72bf97886e2ed1f12e28d54">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> unsigned</>}
  name={<><a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">MaxSCEVSalvageExpressionSize</a> = 64</>}>
Limit the size of expression that SCEV-based salvaging will attempt to translate into a <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>. <a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43">TTI::AddressingModeKind</a> &gt;</>}
  name={<><a href="#a5ecada6efd95584778cb27661747d9ba">PreferredAddresingMode</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="loop"
  name={<><a href="#a6d827fc34f1b4371a0b7183d3ca5bcac">reduce</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<>loop <a href="/docs/api/classes/llvm/loop">Loop</a> Strength</>}
  name={<><a href="#a175f1f53cc9c3619505ffbd13aca087f">Reduction</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; unsigned &gt;</>}
  name={<><a href="#af7597e13dc8bb8a3af795f41314f157f">SetupCostDepthLimit</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a></>}>
</MembersIndexItem>

</MembersIndex>

## Defines Index

<MembersIndex>

<MembersIndexItem
  type="#define"
  name={<><a href="#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>&nbsp;&nbsp;&nbsp;&quot;loop-reduce&quot;</>}>
</MembersIndexItem>

</MembersIndex>


<SectionDefinition>

## Functions

### canFoldIVIncExpr() {#ad35b9a85ea52062375c0c870be5cd228}

<MemberDefinition
  prototype={<>static bool canFoldIVIncExpr (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; IncExpr, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; UserInst, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Operand, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI)</>}
  labels = {["static"]}>
Return true if the <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> can be folded into an addressing mode.

Definition at line <a href="#l03359">3359</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### canHoistIVInc() {#aa12378426474ba414b8bc234a26fd19b}

<MemberDefinition
  prototype={<>static bool canHoistIVInc (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRFixup &amp; Fixup, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRUse &amp; LU, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; IVIncInsertPos, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L)</>}
  labels = {["static"]}>

Definition at line <a href="#l06031">6031</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### CollectSubexprs() {#ad0531a07d7868c1577980524cf2add3a}

<MemberDefinition
  prototype={<>static const SCEV &#42; CollectSubexprs (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42; C, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; &gt; &amp; Ops, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, unsigned Depth=0)</>}
  labels = {["static"]}>
Split S into subexpressions which can be pulled out into separate registers.

If C is non-null, multiply each subexpression by C.

Return remainder expression after factoring the subexpressions captured by Ops. If Ops is complete, return NULL.

Definition at line <a href="#l03835">3835</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### containsAddRecDependentOnLoop() {#a1fb9d2e9aea7544f9453aa3e2df38109}

<MemberDefinition
  prototype={<>static bool containsAddRecDependentOnLoop (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp; L)</>}
  labels = {["static"]}>

Definition at line <a href="#l00614">614</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### DbgGatherSalvagableDVI() {#a9766c807d5c90cf726463e300d0787d8}

<MemberDefinition
  prototype={<>static void DbgGatherSalvagableDVI (<a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; std::unique&#95;ptr&lt; DVIRecoveryRec &gt;, 2 &gt; &amp; SalvageableDVISCEVs, <a href="/docs/api/classes/llvm/smallset">SmallSet</a>&lt; <a href="/docs/api/classes/llvm/assertingvh">AssertingVH</a>&lt; <a href="/docs/api/classes/llvm/dbgvalueinst">DbgValueInst</a> &gt;, 2 &gt; &amp; DVIHandles)</>}
  labels = {["static"]}>
Identify and cache salvageable DVI locations and expressions along with the corresponding SCEV(s).

Also ensure that the DVI is not deleted between cacheing and salvaging.

Definition at line <a href="#l06969">6969</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### DbgRewriteSalvageableDVIs() {#a9188ba3c048bf8057af2b2ac144b9f0f}

<MemberDefinition
  prototype={<>static void DbgRewriteSalvageableDVIs (<a href="/docs/api/classes/llvm/loop">llvm::Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42; LSRInductionVar, <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; std::unique&#95;ptr&lt; DVIRecoveryRec &gt;, 2 &gt; &amp; DVIToUpdate)</>}
  labels = {["static"]}>
Obtain an expression for the iteration count, then attempt to salvage the dbg.value intrinsics.

Definition at line <a href="#l06931">6931</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### DoInitialMatch() {#aa59a46776e15b1f1bd597c4e1e769f59}

<MemberDefinition
  prototype={<>static void DoInitialMatch (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; &gt; &amp; Good, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; &gt; &amp; Bad, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Recursion helper for initialMatch.

Definition at line <a href="#l00541">541</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### ExtractImmediate() {#a1a0afc5106fca20f0a81eac37db70ab9}

<MemberDefinition
  prototype={<>static Immediate ExtractImmediate (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp; S, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
If S involves the addition of a constant integer value, return that integer value, and mutate S to point to a new <a href="/docs/api/classes/llvm/scev">SCEV</a> with that value excluded.

Definition at line <a href="#l00924">924</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### ExtractSymbol() {#a45b1664e25bf2a7220367462f2580044}

<MemberDefinition
  prototype={<>static GlobalValue &#42; ExtractSymbol (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp; S, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
If S involves the addition of a <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> address, return that symbol, and mutate S to point to a new <a href="/docs/api/classes/llvm/scev">SCEV</a> with that value excluded.

Definition at line <a href="#l00958">958</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### findIVOperand() {#a262aeb2eecfb752ae2eecb90bab7ec8a}

<MemberDefinition
  prototype={<>static User::op&#95;iterator findIVOperand (<a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> OI, <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> OE, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Helper for CollectChains that finds an IV operand (computed by an AddRec in this loop) within &#91;OI,OE) or returns OE.

If <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> mapped Instructions to IVStrideUses, we could partially skip this.

Definition at line <a href="#l02964">2964</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getAccessType() {#a7f4680b383ce7138bc2c12de282b14b4}

<MemberDefinition
  prototype={<>static MemAccessTy getAccessType (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; Inst, <a href="/docs/api/classes/llvm/value">Value</a> &#42; OperandVal)</>}
  labels = {["static"]}>
Return the type of the memory being accessed.

Definition at line <a href="#l01029">1029</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getAnyExtendConsideringPostIncUses() {#ae0228f64a74eb3e9fc5343b024ab9a42}

<MemberDefinition
  prototype={<>static const SCEV &#42; getAnyExtendConsideringPostIncUses (<a href="/docs/api/classes/llvm/arrayref">ArrayRef</a>&lt; <a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> &gt; Loops, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; Expr, <a href="/docs/api/classes/llvm/type">Type</a> &#42; ToTy, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Extend/Truncate <code>Expr</code> to <code>ToTy</code> considering post-inc uses in <code>Loops</code>.

For all PostIncLoopSets in <code>Loops</code>, first de-normalize <code>Expr</code>, then perform the extension/truncate and normalize again, as the normalized form can result in folds that are not valid in the post-inc use contexts. The expressions for all PostIncLoopSets must match, otherwise return nullptr.

Definition at line <a href="#l04400">4400</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getExactSDiv() {#ad0ad0c0f486f8ea43158a1227e610a9c}

<MemberDefinition
  prototype={<>static const SCEV &#42; getExactSDiv (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; LHS, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; RHS, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, bool IgnoreSignificantBits=false)</>}
  labels = {["static"]}>
Return an expression for LHS /s RHS, if it can be determined and if the remainder is known to be zero, or null otherwise.

If IgnoreSignificantBits is true, expressions like (X &#42; Y) /s Y are simplified to X, ignoring that the multiplication may overflow, which is useful when the result will be used in a context where the most significant bits are ignored.

Definition at line <a href="#l00819">819</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getExprBase() {#a60008b3cbf2b4ef3e3d14af04beb6a06}

<MemberDefinition
  prototype={<>static const SCEV &#42; getExprBase (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S)</>}
  labels = {["static"]}>
Return an approximation of this <a href="/docs/api/classes/llvm/scev">SCEV</a> expression&#39;s &quot;base&quot;, or NULL for any constant.

Returning the expression itself is conservative. Returning a deeper subexpression is more precise and valid as long as it isn&#39;t less complex than another subexpression. For expressions involving multiple unscaled values, we need to return the pointer-type <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a>. This avoids forming chains across objects, such as: PrevOper==a&#91;i&#93;, IVOper==b&#91;i&#93;, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a>==b-a.

Since <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> is the rightmost type, and pointers are the rightmost <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a>, we simply return the rightmost <a href="/docs/api/classes/llvm/scev">SCEV</a> operand.

Definition at line <a href="#l02999">2999</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### GetInductionVariable() {#a6612c20f7ca23077265026ea4991e2b6}

<MemberDefinition
  prototype={<>static llvm::PHINode &#42; GetInductionVariable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRInstance &amp; LSR)</>}
  labels = {["static"]}>
Ideally pick the PHI IV inserted by ScalarEvolutionExpander.

As a fallback any PHi from the loop header is usable, but may have less chance of surviving subsequent transforms.

Definition at line <a href="#l07032">7032</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getScalingFactorCost() {#a3cbf7279944dc2f0f99a6896501277f9}

<MemberDefinition
  prototype={<>static InstructionCost getScalingFactorCost (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRUse &amp; LU, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> Formula &amp; F, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp; L)</>}
  labels = {["static"]}>

Definition at line <a href="#l01963">1963</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getSetupCost() {#ae51d322caa9d6592ff524f98563eac36}

<MemberDefinition
  prototype={<>static unsigned getSetupCost (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; Reg, unsigned Depth)</>}
  labels = {["static"]}>

Definition at line <a href="#l01392">1392</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getValueOrPoison() {#a7c340cc26f0c6d27219747cac55a2dc2}

<MemberDefinition
  prototype={<>static Value &#42; getValueOrPoison (<a href="/docs/api/classes/llvm/weakvh">WeakVH</a> &amp; VH, <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp; C)</>}
  labels = {["static"]}>
Cached location ops may be erased during LSR, in which case a poison is required when restoring from the cache.

The type of that location is no longer available, so just use int8. The poison will be replaced by one or more locations later when a <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder">SCEVDbgValueBuilder</a> selects alternative locations to use for the salvage.

Definition at line <a href="#l06777">6777</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getWideOperand() {#a0ef5c4bf982afaa71a03555b138aba58}

<MemberDefinition
  prototype={<>static Value &#42; getWideOperand (<a href="/docs/api/classes/llvm/value">Value</a> &#42; Oper)</>}
  labels = {["static"]}>
<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a> logic must consistently peek base <a href="/docs/api/classes/llvm/truncinst">TruncInst</a> operands, so wrap it in a convenient helper.

Definition at line <a href="#l02983">2983</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### INITIALIZE&#95;PASS&#95;BEGIN() {#a0cf26a507ec1ff72dd6624ac9b69d05c}

<MemberDefinition
  prototype={<>INITIALIZE&#95;PASS&#95;BEGIN (LoopStrengthReduce, &quot;loop-reduce&quot;, &quot;Loop Strength Reduction&quot;, false, false)</>}>

Definition at line <a href="#l07182">7182</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAddRecSExtable() {#a9b6b892760677b9b11c517eb5a46557f}

<MemberDefinition
  prototype={<>static bool isAddRecSExtable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42; AR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if the given addrec can be sign-extended without changing its value.

Definition at line <a href="#l00791">791</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAddressUse() {#a4120d81bd505176f5cadf647f5b8c7ef}

<MemberDefinition
  prototype={<>static bool isAddressUse (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; Inst, <a href="/docs/api/classes/llvm/value">Value</a> &#42; OperandVal)</>}
  labels = {["static"]}>
Returns true if the specified instruction is using the specified value as an address.

Definition at line <a href="#l00984">984</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAddSExtable() {#a1509f8a0c11e955037b00ce7542e24a7}

<MemberDefinition
  prototype={<>static bool isAddSExtable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42; A, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if the given add can be sign-extended without changing its value.

Definition at line <a href="#l00799">799</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAlwaysFoldable() {#a626659c8868b0e423f831bfc2b98091e}

<MemberDefinition
  prototype={<>static bool isAlwaysFoldable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42; BaseGV, Immediate BaseOffset, bool HasBaseReg)</>}
  labels = {["static"]}>

Definition at line <a href="#l02008">2008</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAlwaysFoldable() {#a290c161463cbfb7720d6499dba1310ad}

<MemberDefinition
  prototype={<>static bool isAlwaysFoldable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, bool HasBaseReg)</>}
  labels = {["static"]}>

Definition at line <a href="#l02040">2040</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAMCompletelyFolded() {#aa847a3eff7b875035d9f887587291940}

<MemberDefinition
  prototype={<>static bool isAMCompletelyFolded (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRUse &amp; LU, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> Formula &amp; F)</>}
  labels = {["static"]}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if the addressing mode defined by <code>F</code> is completely folded in <code>LU</code> at isel time.

This includes address-mode folding and special icmp tricks. This function returns true if <code>LU</code> can accommodate what <code>F</code> defines and up to 1 base + 1 scaled + offset. In other words, if <code>F</code> has several base registers, this function may still return true. Therefore, users still need to account for additional base registers and/or unfolded offsets to derive an accurate cost model.

Definition at line <a href="#l01946">1946</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAMCompletelyFolded() {#a07e234e9b040a89b10635c52640987c9}

<MemberDefinition
  prototype={<>static bool isAMCompletelyFolded (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42; BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; Fixup=nullptr)</>}
  labels = {["static"]}>

Definition at line <a href="#l01810">1810</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAMCompletelyFolded() {#a111eaa1963537539371757fda03a8d07}

<MemberDefinition
  prototype={<>static bool isAMCompletelyFolded (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42; BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale)</>}
  labels = {["static"]}>

Definition at line <a href="#l01874">1874</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAMCompletelyFolded() {#aa4449f10e66ebab87164f4bf5bfd67d9}

<MemberDefinition
  prototype={<>static bool isAMCompletelyFolded (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> Formula &amp; F, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp; L)</>}
  labels = {["static"]}>

Definition at line <a href="#l01900">1900</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isExistingPhi() {#a3c81223cabf643af27adba3b3ceb680c}

<MemberDefinition
  prototype={<>static bool isExistingPhi (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42; AR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if this AddRec is already a phi in its loop.

Definition at line <a href="#l01082">1082</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isHighCostExpansion() {#a7ac21134b2aaca2a7d55f6ff9d92f5b2}

<MemberDefinition
  prototype={<>static bool isHighCostExpansion (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl</a>&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; &gt; &amp; Processed, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if expanding this expression is likely to incur significant cost.

This is tricky because <a href="/docs/api/classes/llvm/scev">SCEV</a> doesn&#39;t track which expressions are actually computed by the current IR.

We currently allow expansion of IV increments that involve adds, multiplication by constants, and AddRecs from existing phis.

TODO: Allow UDivExpr if we can find an existing IV increment that is an obvious multiple of the UDivExpr.

Definition at line <a href="#l01102">1102</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isLegalAddImmediate() {#a52f2bc4870549427a397721a7de9849f}

<MemberDefinition
  prototype={<>static bool isLegalAddImmediate (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate Offset)</>}
  labels = {["static"]}>

Definition at line <a href="#l01938">1938</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isLegalUse() {#a2e520a15f4578a464f9caaac2f4758ae}

<MemberDefinition
  prototype={<>static bool isLegalUse (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42; BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale)</>}
  labels = {["static"]}>
Test whether we know how to expand the current formula.

Definition at line <a href="#l01917">1917</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isLegalUse() {#a0cde97c20a134a57a746859698291aaa}

<MemberDefinition
  prototype={<>static bool isLegalUse (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> Formula &amp; F)</>}
  labels = {["static"]}>

Definition at line <a href="#l01931">1931</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isMulSExtable() {#a32cdb4a97c185f1acbe11f45fcc70d12}

<MemberDefinition
  prototype={<>static bool isMulSExtable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42; M, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if the given mul can be sign-extended without changing its value.

Definition at line <a href="#l00807">807</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isProfitableChain() {#aca012302770ad32503de5e2c62344290}

<MemberDefinition
  prototype={<>static bool isProfitableChain (IVChain &amp; Chain, <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl</a>&lt; <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; &gt; &amp; Users, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI)</>}
  labels = {["static"]}>
Return true if the number of registers needed for the chain is estimated to be less than the number required for the individual IV users.

First prohibit any IV users that keep the IV live across increments (the Users set should be empty). Next count the number and type of increments in the chain.

Chaining IVs can lead to considerable code bloat if ISEL doesn&#39;t effectively use postinc addressing modes. Only consider it profitable it the increments can be computed in fewer registers when chained.

TODO: Consider <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> free if it&#39;s already used in another chains.

Definition at line <a href="#l03066">3066</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### IsSimplerBaseSCEVForTarget() {#a6c630dc63715497e5e49ab1ca9dc6ccb}

<MemberDefinition
  prototype={<>static bool IsSimplerBaseSCEVForTarget (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; Best, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; Reg, MemAccessTy AccessType)</>}
  labels = {["static"]}>

Definition at line <a href="#l05307">5307</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### mayUsePostIncMode() {#a187751c86d349fac41ddc1b807b40b22}

<MemberDefinition
  prototype={<>static bool mayUsePostIncMode (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, LSRUse &amp; LU, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if the <a href="/docs/api/classes/llvm/scev">SCEV</a> represents a value that may end up as a post-increment operation.

Definition at line <a href="#l03893">3893</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### numLLVMArgOps() {#a80e922a79a22107b2f70e851825d098e}

<MemberDefinition
  prototype={<>static unsigned numLLVMArgOps (<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; uint64&#95;t &gt; &amp; Expr)</>}
  labels = {["static"]}>
Returns the total number of DW&#95;OP&#95;llvm&#95;arg operands in the expression.

This helps in determining if a DIArglist is necessary or can be omitted from the dbg.value.

Definition at line <a href="#l06693">6693</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### ReduceLoopStrength() {#ac33f356faceb9655cb64611d2971d24f}

<MemberDefinition
  prototype={<>static bool ReduceLoopStrength (<a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp; IU, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp; DT, <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp; LI, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp; AC, <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp; TLI, <a href="/docs/api/classes/llvm/memoryssa">MemorySSA</a> &#42; MSSA)</>}
  labels = {["static"]}>

Definition at line <a href="#l07064">7064</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### restorePreTransformState() {#a196b104079c33f7ccd4ad4816376b9a7}

<MemberDefinition
  prototype={<>static void restorePreTransformState (DVIRecoveryRec &amp; DVIRec)</>}
  labels = {["static"]}>
Restore the DVI&#39;s pre-LSR arguments. Substitute undef for any erased values.

Definition at line <a href="#l06782">6782</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### SalvageDVI() {#a02cf9d6ac96ae27b406798da5c2eb7ea}

<MemberDefinition
  prototype={<>static bool SalvageDVI (<a href="/docs/api/classes/llvm/loop">llvm::Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42; LSRInductionVar, DVIRecoveryRec &amp; DVIRec, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; SCEVInductionVar, SCEVDbgValueBuilder IterCountExpr)</>}
  labels = {["static"]}>

Definition at line <a href="#l06818">6818</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### UpdateDbgValueInst() {#ab8a7ab37beb2d225c6cb1e9c6c20d0d0}

<MemberDefinition
  prototype={<>static void UpdateDbgValueInst (DVIRecoveryRec &amp; DVIRec, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/value">Value</a> &#42; &gt; &amp; NewLocationOps, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; uint64&#95;t &gt; &amp; NewExpr)</>}
  labels = {["static"]}>
Write the new expression and new location ops for the dbg.value.

If possible reduce the szie of the dbg.value intrinsic by omitting DIArglist. This can be omitted if:
<ul>
<li>There is only a single location, refenced by a single DW&#95;OP&#95;llvm&#95;arg.</li>
<li>The DW&#95;OP&#95;LLVM&#95;arg is the first operand in the expression.</li>
</ul>

Definition at line <a href="#l06736">6736</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### updateDVIWithLocation() {#a4d8f7ff97b22c5203b332a778c88b088}

<MemberDefinition
  template={<>template &lt;typename T&gt;</>}
  prototype={<>static void updateDVIWithLocation (T &amp; DbgVal, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Location, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; uint64&#95;t &gt; &amp; Ops)</>}
  labels = {["static"]}>
Overwrites DVI with the location and Ops as the <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>.

This will create an invalid expression if Ops has any dwarf::DW&#95;OP&#95;llvm&#95;arg operands, because a DIArglist is not created for the first argument of the dbg.value.

Definition at line <a href="#l06706">6706</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### updateDVIWithLocations() {#ab2e6fc08d8f586e4979511620c12ffa8}

<MemberDefinition
  template={<>template &lt;typename T&gt;</>}
  prototype={<>static void updateDVIWithLocations (T &amp; DbgVal, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/value">Value</a> &#42; &gt; &amp; Locations, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; uint64&#95;t &gt; &amp; Ops)</>}
  labels = {["static"]}>
Overwrite DVI with locations placed into a DIArglist.

Definition at line <a href="#l06717">6717</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Variables

### AllowDropSolutionIfLessProfitable {#a57a769eb2fe11448940d81a19e0140e2}

<MemberDefinition
  prototype={<>cl::opt&lt; cl::boolOrDefault &gt; AllowDropSolutionIfLessProfitable(&quot;lsr-drop-solution&quot;, cl::Hidden, cl::desc(&quot;Attempt to drop solution if it is less profitable&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00191">191</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### ComplexityLimit {#ab5189d9a0612b4e660ef0320a77b2894}

<MemberDefinition
  prototype={<>cl::opt&lt; unsigned &gt; ComplexityLimit(&quot;lsr-complexity-limit&quot;, cl::Hidden, cl::init(std::numeric&#95;limits&lt; uint16&#95;t &gt;::max()), cl::desc(&quot;LSR search space complexity limit&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00182">182</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### DropScaledForVScale {#a0ce46a19f824c65a4ddace1f4e9ac529}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; DropScaledForVScale(&quot;lsr-drop-scaled-reg-for-vscale&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Avoid using scaled registers with vscale-relative addressing&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00199">199</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### EnablePhiElim {#a94a7203d75d594f7012f80d9130dcadf}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; EnablePhiElim(&quot;enable-lsr-phielim&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Enable LSR phi elimination&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00147">147</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### EnableVScaleImmediates {#a5ca5d2aa868eb59998bc43f224fec74f}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; EnableVScaleImmediates(&quot;lsr-enable-vscale-immediates&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Enable analysis of vscale-relative immediates in LSR&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00195">195</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### false {#a81103f81d98fb1888c83e3f13d71d043}

<MemberDefinition
  prototype="loop Loop Strength false">

Definition at line <a href="#l07191">7191</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### FilterSameScaledReg {#aad3193b74a34d43bf4e02188ce67d3b7}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; FilterSameScaledReg(&quot;lsr-filter-same-scaled-reg&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Narrow LSR search space by filtering non-optimal formulae&quot; &quot; with the same ScaledReg and Scale&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00164">164</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### InsnsCost {#a3d46ca97222c953c0d38e65b728e0f7b}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; InsnsCost(&quot;lsr-insns-cost&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Add instruction count to a LSR cost model&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00152">152</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### LSRExpNarrow {#aa957fcc885db5c56e419b4646d135311}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; LSRExpNarrow(&quot;lsr-exp-narrow&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Narrow LSR complex solution using&quot; &quot; expectation of registers number&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00157">157</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### MaxIVUsers {#a73b3c5e7c72bf97886e2ed1f12e28d54}

<MemberDefinition
  prototype="const unsigned MaxIVUsers = 200"
  labels = {["static"]}>
MaxIVUsers is an arbitrary threshold that provides an early opportunity for bail out.

This threshold is far beyond the number of users that LSR can conceivably solve, so it should not affect generated code, but catches the worst cases before LSR burns too much compile time and stack space.

Definition at line <a href="#l00138">138</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### MaxSCEVSalvageExpressionSize {#a35e8d876ca1d9ef72efaa8b320bd4f36}

<MemberDefinition
  prototype="const unsigned MaxSCEVSalvageExpressionSize = 64"
  labels = {["static"]}>
Limit the size of expression that SCEV-based salvaging will attempt to translate into a <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>.

Choose a maximum size such that debuginfo is not excessively increased and the salvaging is not too expensive for the compiler.

Definition at line <a href="#l00144">144</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### PreferredAddresingMode {#a5ecada6efd95584778cb27661747d9ba}

<MemberDefinition
  prototype={<>cl::opt&lt; TTI::AddressingModeKind &gt; PreferredAddresingMode(&quot;lsr-preferred-addressing-mode&quot;, cl::Hidden, cl::init(TTI::AMK&#95;None), cl::desc(&quot;A flag that overrides the target&#39;s preferred addressing mode.&quot;), cl::values(clEnumValN(TTI::AMK&#95;None, &quot;none&quot;, &quot;Don&#39;t prefer any addressing mode&quot;), clEnumValN(TTI::AMK&#95;PreIndexed, &quot;preindexed&quot;, &quot;Prefer pre-indexed addressing mode&quot;), clEnumValN(TTI::AMK&#95;PostIndexed, &quot;postindexed&quot;, &quot;Prefer post-indexed addressing mode&quot;)))</>}
  labels = {["static"]}>

Definition at line <a href="#l00169">169</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### reduce {#a6d827fc34f1b4371a0b7183d3ca5bcac}

<MemberDefinition
  prototype="loop reduce">

Definition at line <a href="#l07190">7190</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### Reduction {#a175f1f53cc9c3619505ffbd13aca087f}

<MemberDefinition
  prototype="loop Loop Strength Reduction">

Definition at line <a href="#l07191">7191</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### SetupCostDepthLimit {#af7597e13dc8bb8a3af795f41314f157f}

<MemberDefinition
  prototype={<>cl::opt&lt; unsigned &gt; SetupCostDepthLimit(&quot;lsr-setupcost-depth-limit&quot;, cl::Hidden, cl::init(7), cl::desc(&quot;The limit on recursion depth for LSRs setup cost&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00187">187</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### StressIVChain {#a3dbd582073ac67026ef5be72da94d4a3}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; StressIVChain(&quot;stress-ivchain&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Stress test LSR IV chains&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00205">205</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Defines

### DEBUG&#95;TYPE {#ad78e062f62e0d6e453941fb4ca843e4d}

<MemberDefinition
  prototype={<>#define DEBUG&#95;TYPE&nbsp;&nbsp;&nbsp;&quot;loop-reduce&quot;</>}>

Definition at line <a href="#l00132">132</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

</SectionDefinition>

## File Listing

The file content with the documentation metadata removed is:

<ProgramListing>

<Link id="l00001" /><CodeLine lineNumber="1"><Highlight kind="comment">//===- LoopStrengthReduce.cpp - Strength Reduce IVs in Loops --------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00002" /><CodeLine lineNumber="2"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00003" /><CodeLine lineNumber="3"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00004" /><CodeLine lineNumber="4"><Highlight kind="normal"></Highlight><Highlight kind="comment">// See https://llvm.org/LICENSE.txt for license information.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00005" /><CodeLine lineNumber="5"><Highlight kind="normal"></Highlight><Highlight kind="comment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00006" /><CodeLine lineNumber="6"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00007" /><CodeLine lineNumber="7"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00008" /><CodeLine lineNumber="8"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00009" /><CodeLine lineNumber="9"><Highlight kind="normal"></Highlight><Highlight kind="comment">// This transformation analyzes and transforms the induction variables (and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00010" /><CodeLine lineNumber="10"><Highlight kind="normal"></Highlight><Highlight kind="comment">// computations derived from them) into forms suitable for efficient execution</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00011" /><CodeLine lineNumber="11"><Highlight kind="normal"></Highlight><Highlight kind="comment">// on the target.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00012" /><CodeLine lineNumber="12"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00013" /><CodeLine lineNumber="13"><Highlight kind="normal"></Highlight><Highlight kind="comment">// This pass performs a strength reduction on array references inside loops that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00014" /><CodeLine lineNumber="14"><Highlight kind="normal"></Highlight><Highlight kind="comment">// have as one or more of their components the loop induction variable, it</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00015" /><CodeLine lineNumber="15"><Highlight kind="normal"></Highlight><Highlight kind="comment">// rewrites expressions to take advantage of scaled-index addressing modes</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00016" /><CodeLine lineNumber="16"><Highlight kind="normal"></Highlight><Highlight kind="comment">// available on the target, and it performs a variety of other optimizations</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00017" /><CodeLine lineNumber="17"><Highlight kind="normal"></Highlight><Highlight kind="comment">// related to loop induction variables.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00018" /><CodeLine lineNumber="18"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00019" /><CodeLine lineNumber="19"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Terminology note: this code has a lot of handling for &quot;post-increment&quot; or</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00020" /><CodeLine lineNumber="20"><Highlight kind="normal"></Highlight><Highlight kind="comment">// &quot;post-inc&quot; users. This is not talking about post-increment addressing modes;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00021" /><CodeLine lineNumber="21"><Highlight kind="normal"></Highlight><Highlight kind="comment">// it is instead talking about code like this:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00022" /><CodeLine lineNumber="22"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00023" /><CodeLine lineNumber="23"><Highlight kind="normal"></Highlight><Highlight kind="comment">//   %i = phi &#91; 0, %entry &#93;, &#91; %i.next, %latch &#93;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00024" /><CodeLine lineNumber="24"><Highlight kind="normal"></Highlight><Highlight kind="comment">//   ...</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00025" /><CodeLine lineNumber="25"><Highlight kind="normal"></Highlight><Highlight kind="comment">//   %i.next = add %i, 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00026" /><CodeLine lineNumber="26"><Highlight kind="normal"></Highlight><Highlight kind="comment">//   %c = icmp eq %i.next, %n</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00027" /><CodeLine lineNumber="27"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00028" /><CodeLine lineNumber="28"><Highlight kind="normal"></Highlight><Highlight kind="comment">// The SCEV for %i is &#123;0,+,1&#125;&lt;%L&gt;. The SCEV for %i.next is &#123;1,+,1&#125;&lt;%L&gt;, however</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00029" /><CodeLine lineNumber="29"><Highlight kind="normal"></Highlight><Highlight kind="comment">// it&#39;s useful to think about these as the same register, with some uses using</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00030" /><CodeLine lineNumber="30"><Highlight kind="normal"></Highlight><Highlight kind="comment">// the value of the register before the add and some using it after. In this</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00031" /><CodeLine lineNumber="31"><Highlight kind="normal"></Highlight><Highlight kind="comment">// example, the icmp is a post-increment user, since it uses %i.next, which is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00032" /><CodeLine lineNumber="32"><Highlight kind="normal"></Highlight><Highlight kind="comment">// the value of the induction variable after the increment. The other common</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00033" /><CodeLine lineNumber="33"><Highlight kind="normal"></Highlight><Highlight kind="comment">// case of post-increment users is users outside the loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00034" /><CodeLine lineNumber="34"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00035" /><CodeLine lineNumber="35"><Highlight kind="normal"></Highlight><Highlight kind="comment">// TODO: More sophistication in the way Formulae are generated and filtered.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00036" /><CodeLine lineNumber="36"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00037" /><CodeLine lineNumber="37"><Highlight kind="normal"></Highlight><Highlight kind="comment">// TODO: Handle multiple loops at a time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00038" /><CodeLine lineNumber="38"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00039" /><CodeLine lineNumber="39"><Highlight kind="normal"></Highlight><Highlight kind="comment">// TODO: Should the addressing mode BaseGV be changed to a ConstantExpr instead</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00040" /><CodeLine lineNumber="40"><Highlight kind="normal"></Highlight><Highlight kind="comment">//       of a GlobalValue?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00041" /><CodeLine lineNumber="41"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00042" /><CodeLine lineNumber="42"><Highlight kind="normal"></Highlight><Highlight kind="comment">// TODO: When truncation is free, truncate ICmp users&#39; operands to make it a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00043" /><CodeLine lineNumber="43"><Highlight kind="normal"></Highlight><Highlight kind="comment">//       smaller encoding (on x86 at least).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00044" /><CodeLine lineNumber="44"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00045" /><CodeLine lineNumber="45"><Highlight kind="normal"></Highlight><Highlight kind="comment">// TODO: When a negated register is used by an add (such as in a list of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00046" /><CodeLine lineNumber="46"><Highlight kind="normal"></Highlight><Highlight kind="comment">//       multiple base registers, or as the increment expression in an addrec),</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00047" /><CodeLine lineNumber="47"><Highlight kind="normal"></Highlight><Highlight kind="comment">//       we may not actually need both reg and (-1 &#42; reg) in registers; the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00048" /><CodeLine lineNumber="48"><Highlight kind="normal"></Highlight><Highlight kind="comment">//       negation can be implemented by using a sub instead of an add. The</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00049" /><CodeLine lineNumber="49"><Highlight kind="normal"></Highlight><Highlight kind="comment">//       lack of support for taking this into consideration when making</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00050" /><CodeLine lineNumber="50"><Highlight kind="normal"></Highlight><Highlight kind="comment">//       register pressure decisions is partly worked around by the &quot;Special&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00051" /><CodeLine lineNumber="51"><Highlight kind="normal"></Highlight><Highlight kind="comment">//       use kind.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00052" /><CodeLine lineNumber="52"><Highlight kind="normal"></Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00053" /><CodeLine lineNumber="53"><Highlight kind="normal"></Highlight><Highlight kind="comment">//===----------------------------------------------------------------------===//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00054" /><CodeLine lineNumber="54"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00055" /><CodeLine lineNumber="55"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/scalar/loopstrengthreduce-h">llvm/Transforms/Scalar/LoopStrengthReduce.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00056" /><CodeLine lineNumber="56"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/apint-h">llvm/ADT/APInt.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00057" /><CodeLine lineNumber="57"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/densemap-h">llvm/ADT/DenseMap.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00058" /><CodeLine lineNumber="58"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/denseset-h">llvm/ADT/DenseSet.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00059" /><CodeLine lineNumber="59"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/hashing-h">llvm/ADT/Hashing.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00060" /><CodeLine lineNumber="60"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/pointerintpair-h">llvm/ADT/PointerIntPair.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00061" /><CodeLine lineNumber="61"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/stlextras-h">llvm/ADT/STLExtras.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00062" /><CodeLine lineNumber="62"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/setvector-h">llvm/ADT/SetVector.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00063" /><CodeLine lineNumber="63"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallbitvector-h">llvm/ADT/SmallBitVector.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00064" /><CodeLine lineNumber="64"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallptrset-h">llvm/ADT/SmallPtrSet.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00065" /><CodeLine lineNumber="65"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallset-h">llvm/ADT/SmallSet.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00066" /><CodeLine lineNumber="66"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallvector-h">llvm/ADT/SmallVector.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00067" /><CodeLine lineNumber="67"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h">llvm/ADT/Statistic.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00068" /><CodeLine lineNumber="68"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/iterator-range-h">llvm/ADT/iterator&#95;range.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00069" /><CodeLine lineNumber="69"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/assumptioncache-h">llvm/Analysis/AssumptionCache.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00070" /><CodeLine lineNumber="70"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/domtreeupdater-h">llvm/Analysis/DomTreeUpdater.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00071" /><CodeLine lineNumber="71"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/ivusers-h">llvm/Analysis/IVUsers.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00072" /><CodeLine lineNumber="72"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/loopanalysismanager-h">llvm/Analysis/LoopAnalysisManager.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00073" /><CodeLine lineNumber="73"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/loopinfo-h">llvm/Analysis/LoopInfo.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00074" /><CodeLine lineNumber="74"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/looppass-h">llvm/Analysis/LoopPass.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00075" /><CodeLine lineNumber="75"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/memoryssa-h">llvm/Analysis/MemorySSA.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00076" /><CodeLine lineNumber="76"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/memoryssaupdater-h">llvm/Analysis/MemorySSAUpdater.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00077" /><CodeLine lineNumber="77"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolution-h">llvm/Analysis/ScalarEvolution.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00078" /><CodeLine lineNumber="78"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolutionexpressions-h">llvm/Analysis/ScalarEvolutionExpressions.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00079" /><CodeLine lineNumber="79"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolutionnormalization-h">llvm/Analysis/ScalarEvolutionNormalization.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00080" /><CodeLine lineNumber="80"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/targetlibraryinfo-h">llvm/Analysis/TargetLibraryInfo.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00081" /><CodeLine lineNumber="81"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/targettransforminfo-h">llvm/Analysis/TargetTransformInfo.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00082" /><CodeLine lineNumber="82"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/valuetracking-h">llvm/Analysis/ValueTracking.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00083" /><CodeLine lineNumber="83"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/binaryformat/dwarf-h">llvm/BinaryFormat/Dwarf.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00084" /><CodeLine lineNumber="84"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;llvm/Config/llvm-config.h&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00085" /><CodeLine lineNumber="85"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/basicblock-h">llvm/IR/BasicBlock.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00086" /><CodeLine lineNumber="86"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/constant-h">llvm/IR/Constant.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00087" /><CodeLine lineNumber="87"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/constants-h">llvm/IR/Constants.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00088" /><CodeLine lineNumber="88"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/debuginfometadata-h">llvm/IR/DebugInfoMetadata.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00089" /><CodeLine lineNumber="89"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/derivedtypes-h">llvm/IR/DerivedTypes.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00090" /><CodeLine lineNumber="90"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/dominators-h">llvm/IR/Dominators.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00091" /><CodeLine lineNumber="91"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/globalvalue-h">llvm/IR/GlobalValue.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00092" /><CodeLine lineNumber="92"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/irbuilder-h">llvm/IR/IRBuilder.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00093" /><CodeLine lineNumber="93"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/instrtypes-h">llvm/IR/InstrTypes.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00094" /><CodeLine lineNumber="94"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/instruction-h">llvm/IR/Instruction.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00095" /><CodeLine lineNumber="95"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/instructions-h">llvm/IR/Instructions.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00096" /><CodeLine lineNumber="96"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/intrinsicinst-h">llvm/IR/IntrinsicInst.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00097" /><CodeLine lineNumber="97"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/module-h">llvm/IR/Module.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00098" /><CodeLine lineNumber="98"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/operator-h">llvm/IR/Operator.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00099" /><CodeLine lineNumber="99"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/type-h">llvm/IR/Type.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00100" /><CodeLine lineNumber="100"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/use-h">llvm/IR/Use.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00101" /><CodeLine lineNumber="101"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/user-h">llvm/IR/User.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00102" /><CodeLine lineNumber="102"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/value-h">llvm/IR/Value.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00103" /><CodeLine lineNumber="103"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/valuehandle-h">llvm/IR/ValueHandle.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00104" /><CodeLine lineNumber="104"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/initializepasses-h">llvm/InitializePasses.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00105" /><CodeLine lineNumber="105"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/pass-h">llvm/Pass.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00106" /><CodeLine lineNumber="106"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/casting-h">llvm/Support/Casting.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00107" /><CodeLine lineNumber="107"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h">llvm/Support/CommandLine.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00108" /><CodeLine lineNumber="108"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h">llvm/Support/Compiler.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00109" /><CodeLine lineNumber="109"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h">llvm/Support/Debug.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00110" /><CodeLine lineNumber="110"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h">llvm/Support/ErrorHandling.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00111" /><CodeLine lineNumber="111"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/mathextras-h">llvm/Support/MathExtras.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00112" /><CodeLine lineNumber="112"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/raw-ostream-h">llvm/Support/raw&#95;ostream.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00113" /><CodeLine lineNumber="113"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/scalar-h">llvm/Transforms/Scalar.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00114" /><CodeLine lineNumber="114"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/utils-h">llvm/Transforms/Utils.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00115" /><CodeLine lineNumber="115"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/basicblockutils-h">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00116" /><CodeLine lineNumber="116"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/local-h">llvm/Transforms/Utils/Local.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00117" /><CodeLine lineNumber="117"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/looputils-h">llvm/Transforms/Utils/LoopUtils.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00118" /><CodeLine lineNumber="118"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/scalarevolutionexpander-h">llvm/Transforms/Utils/ScalarEvolutionExpander.h</a>&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00119" /><CodeLine lineNumber="119"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;algorithm&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00120" /><CodeLine lineNumber="120"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;cassert&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00121" /><CodeLine lineNumber="121"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;cstddef&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00122" /><CodeLine lineNumber="122"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;cstdint&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00123" /><CodeLine lineNumber="123"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;iterator&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00124" /><CodeLine lineNumber="124"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;limits&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00125" /><CodeLine lineNumber="125"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;map&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00126" /><CodeLine lineNumber="126"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;numeric&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00127" /><CodeLine lineNumber="127"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;optional&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00128" /><CodeLine lineNumber="128"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#include &lt;utility&gt;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00129" /><CodeLine lineNumber="129"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00130" /><CodeLine lineNumber="130"><Highlight kind="normal"></Highlight><Highlight kind="keyword">using namespace </Highlight><Highlight kind="normal"><a href="/docs/api/namespaces/llvm">llvm</a>;</Highlight></CodeLine>
<Link id="l00131" /><CodeLine lineNumber="131"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00132" /><CodeLine lineNumber="132" lineLink="#ad78e062f62e0d6e453941fb4ca843e4d"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#define DEBUG&#95;TYPE &quot;loop-reduce&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00133" /><CodeLine lineNumber="133"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00134" /><CodeLine lineNumber="134"><Highlight kind="comment">/// MaxIVUsers is an arbitrary threshold that provides an early opportunity for</Highlight></CodeLine>
<Link id="l00135" /><CodeLine lineNumber="135"><Highlight kind="comment">/// bail out. This threshold is far beyond the number of users that LSR can</Highlight></CodeLine>
<Link id="l00136" /><CodeLine lineNumber="136"><Highlight kind="comment">/// conceivably solve, so it should not affect generated code, but catches the</Highlight></CodeLine>
<Link id="l00137" /><CodeLine lineNumber="137"><Highlight kind="comment">/// worst cases before LSR burns too much compile time and stack space.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00138" /><CodeLine lineNumber="138" lineLink="#a73b3c5e7c72bf97886e2ed1f12e28d54"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="#a73b3c5e7c72bf97886e2ed1f12e28d54">MaxIVUsers</a> = 200;</Highlight></CodeLine>
<Link id="l00139" /><CodeLine lineNumber="139"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00140" /><CodeLine lineNumber="140"><Highlight kind="comment">/// Limit the size of expression that SCEV-based salvaging will attempt to</Highlight></CodeLine>
<Link id="l00141" /><CodeLine lineNumber="141"><Highlight kind="comment">/// translate into a DIExpression.</Highlight></CodeLine>
<Link id="l00142" /><CodeLine lineNumber="142"><Highlight kind="comment">/// Choose a maximum size such that debuginfo is not excessively increased and</Highlight></CodeLine>
<Link id="l00143" /><CodeLine lineNumber="143"><Highlight kind="comment">/// the salvaging is not too expensive for the compiler.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00144" /><CodeLine lineNumber="144" lineLink="#a35e8d876ca1d9ef72efaa8b320bd4f36"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">MaxSCEVSalvageExpressionSize</a> = 64;</Highlight></CodeLine>
<Link id="l00145" /><CodeLine lineNumber="145"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00146" /><CodeLine lineNumber="146"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Cleanup congruent phis after LSR phi expansion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00147" /><CodeLine lineNumber="147" lineLink="#a94a7203d75d594f7012f80d9130dcadf"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a94a7203d75d594f7012f80d9130dcadf">EnablePhiElim</a>(</Highlight></CodeLine>
<Link id="l00148" /><CodeLine lineNumber="148"><Highlight kind="normal">  </Highlight><Highlight kind="stringliteral">&quot;enable-lsr-phielim&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00149" /><CodeLine lineNumber="149"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Enable LSR phi elimination&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00150" /><CodeLine lineNumber="150"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00151" /><CodeLine lineNumber="151"><Highlight kind="normal"></Highlight><Highlight kind="comment">// The flag adds instruction count to solutions cost comparison.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00152" /><CodeLine lineNumber="152" lineLink="#a3d46ca97222c953c0d38e65b728e0f7b"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a>(</Highlight></CodeLine>
<Link id="l00153" /><CodeLine lineNumber="153"><Highlight kind="normal">  </Highlight><Highlight kind="stringliteral">&quot;lsr-insns-cost&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00154" /><CodeLine lineNumber="154"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Add instruction count to a LSR cost model&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00155" /><CodeLine lineNumber="155"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00156" /><CodeLine lineNumber="156"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Flag to choose how to narrow complex lsr solution</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00157" /><CodeLine lineNumber="157" lineLink="#aa957fcc885db5c56e419b4646d135311"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#aa957fcc885db5c56e419b4646d135311">LSRExpNarrow</a>(</Highlight></CodeLine>
<Link id="l00158" /><CodeLine lineNumber="158"><Highlight kind="normal">  </Highlight><Highlight kind="stringliteral">&quot;lsr-exp-narrow&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00159" /><CodeLine lineNumber="159"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Narrow LSR complex solution using&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00160" /><CodeLine lineNumber="160"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot; expectation of registers number&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00161" /><CodeLine lineNumber="161"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00162" /><CodeLine lineNumber="162"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Flag to narrow search space by filtering non-optimal formulae with</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00163" /><CodeLine lineNumber="163"><Highlight kind="normal"></Highlight><Highlight kind="comment">// the same ScaledReg and Scale.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00164" /><CodeLine lineNumber="164" lineLink="#aad3193b74a34d43bf4e02188ce67d3b7"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#aad3193b74a34d43bf4e02188ce67d3b7">FilterSameScaledReg</a>(</Highlight></CodeLine>
<Link id="l00165" /><CodeLine lineNumber="165"><Highlight kind="normal">    </Highlight><Highlight kind="stringliteral">&quot;lsr-filter-same-scaled-reg&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00166" /><CodeLine lineNumber="166"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Narrow LSR search space by filtering non-optimal formulae&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00167" /><CodeLine lineNumber="167"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot; with the same ScaledReg and Scale&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00168" /><CodeLine lineNumber="168"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00169" /><CodeLine lineNumber="169" lineLink="#a5ecada6efd95584778cb27661747d9ba"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;TTI::AddressingModeKind&gt;</a> <a href="#a5ecada6efd95584778cb27661747d9ba">PreferredAddresingMode</a>(</Highlight></CodeLine>
<Link id="l00170" /><CodeLine lineNumber="170"><Highlight kind="normal">  </Highlight><Highlight kind="stringliteral">&quot;lsr-preferred-addressing-mode&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43afcb500aacd74955fc04edc890f5e5d1a">TTI::AMK&#95;None</a>),</Highlight></CodeLine>
<Link id="l00171" /><CodeLine lineNumber="171"><Highlight kind="normal">   <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;A flag that overrides the target&#39;s preferred addressing mode.&quot;</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00172" /><CodeLine lineNumber="172"><Highlight kind="normal">   <a href="/docs/api/namespaces/llvm/cl/#a8fa743aa76b6902028f8a643dfb87171">cl::values</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h/#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43afcb500aacd74955fc04edc890f5e5d1a">TTI::AMK&#95;None</a>,</Highlight></CodeLine>
<Link id="l00173" /><CodeLine lineNumber="173"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;none&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00174" /><CodeLine lineNumber="174"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;Don&#39;t prefer any addressing mode&quot;</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00175" /><CodeLine lineNumber="175"><Highlight kind="normal">              <a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h/#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a7cb26b7792c751612e634c36dce16f9a">TTI::AMK&#95;PreIndexed</a>,</Highlight></CodeLine>
<Link id="l00176" /><CodeLine lineNumber="176"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;preindexed&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00177" /><CodeLine lineNumber="177"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;Prefer pre-indexed addressing mode&quot;</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00178" /><CodeLine lineNumber="178"><Highlight kind="normal">              <a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h/#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>,</Highlight></CodeLine>
<Link id="l00179" /><CodeLine lineNumber="179"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;postindexed&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l00180" /><CodeLine lineNumber="180"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;Prefer post-indexed addressing mode&quot;</Highlight><Highlight kind="normal">)));</Highlight></CodeLine>
<Link id="l00181" /><CodeLine lineNumber="181"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00182" /><CodeLine lineNumber="182" lineLink="#ab5189d9a0612b4e660ef0320a77b2894"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;unsigned&gt;</a> <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>(</Highlight></CodeLine>
<Link id="l00183" /><CodeLine lineNumber="183"><Highlight kind="normal">  </Highlight><Highlight kind="stringliteral">&quot;lsr-complexity-limit&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</Highlight></CodeLine>
<Link id="l00184" /><CodeLine lineNumber="184"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(std::numeric&#95;limits&lt;uint16&#95;t&gt;::max()),</Highlight></CodeLine>
<Link id="l00185" /><CodeLine lineNumber="185"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;LSR search space complexity limit&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00186" /><CodeLine lineNumber="186"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00187" /><CodeLine lineNumber="187" lineLink="#af7597e13dc8bb8a3af795f41314f157f"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;unsigned&gt;</a> <a href="#af7597e13dc8bb8a3af795f41314f157f">SetupCostDepthLimit</a>(</Highlight></CodeLine>
<Link id="l00188" /><CodeLine lineNumber="188"><Highlight kind="normal">    </Highlight><Highlight kind="stringliteral">&quot;lsr-setupcost-depth-limit&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(7),</Highlight></CodeLine>
<Link id="l00189" /><CodeLine lineNumber="189"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;The limit on recursion depth for LSRs setup cost&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00190" /><CodeLine lineNumber="190"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00191" /><CodeLine lineNumber="191" lineLink="#a57a769eb2fe11448940d81a19e0140e2"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;cl::boolOrDefault&gt;</a> <a href="#a57a769eb2fe11448940d81a19e0140e2">AllowDropSolutionIfLessProfitable</a>(</Highlight></CodeLine>
<Link id="l00192" /><CodeLine lineNumber="192"><Highlight kind="normal">    </Highlight><Highlight kind="stringliteral">&quot;lsr-drop-solution&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</Highlight></CodeLine>
<Link id="l00193" /><CodeLine lineNumber="193"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Attempt to drop solution if it is less profitable&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00194" /><CodeLine lineNumber="194"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00195" /><CodeLine lineNumber="195" lineLink="#a5ca5d2aa868eb59998bc43f224fec74f"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a5ca5d2aa868eb59998bc43f224fec74f">EnableVScaleImmediates</a>(</Highlight></CodeLine>
<Link id="l00196" /><CodeLine lineNumber="196"><Highlight kind="normal">    </Highlight><Highlight kind="stringliteral">&quot;lsr-enable-vscale-immediates&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00197" /><CodeLine lineNumber="197"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Enable analysis of vscale-relative immediates in LSR&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00198" /><CodeLine lineNumber="198"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00199" /><CodeLine lineNumber="199" lineLink="#a0ce46a19f824c65a4ddace1f4e9ac529"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a0ce46a19f824c65a4ddace1f4e9ac529">DropScaledForVScale</a>(</Highlight></CodeLine>
<Link id="l00200" /><CodeLine lineNumber="200"><Highlight kind="normal">    </Highlight><Highlight kind="stringliteral">&quot;lsr-drop-scaled-reg-for-vscale&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00201" /><CodeLine lineNumber="201"><Highlight kind="normal">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Avoid using scaled registers with vscale-relative addressing&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00202" /><CodeLine lineNumber="202"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00203" /><CodeLine lineNumber="203"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00204" /><CodeLine lineNumber="204"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Stress test IV chain generation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00205" /><CodeLine lineNumber="205" lineLink="#a3dbd582073ac67026ef5be72da94d4a3"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>(</Highlight></CodeLine>
<Link id="l00206" /><CodeLine lineNumber="206"><Highlight kind="normal">  </Highlight><Highlight kind="stringliteral">&quot;stress-ivchain&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l00207" /><CodeLine lineNumber="207"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</Highlight><Highlight kind="stringliteral">&quot;Stress test LSR IV chains&quot;</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l00208" /><CodeLine lineNumber="208"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00209" /><CodeLine lineNumber="209"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00210" /><CodeLine lineNumber="210"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00211" /><CodeLine lineNumber="211"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00212" /><CodeLine lineNumber="212" lineLink="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00213" /><CodeLine lineNumber="213"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00214" /><CodeLine lineNumber="214" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> &#123;</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00215" /><CodeLine lineNumber="215"><Highlight kind="comment">  /// Used in situations where the accessed memory type is unknown.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00216" /><CodeLine lineNumber="216" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a4ee10cdfa2006d2b20dc564ae2995ee1"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a4ee10cdfa2006d2b20dc564ae2995ee1">UnknownAddressSpace</a> =</Highlight></CodeLine>
<Link id="l00217" /><CodeLine lineNumber="217"><Highlight kind="normal">      std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l00218" /><CodeLine lineNumber="218"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00219" /><CodeLine lineNumber="219" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9">MemTy</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00220" /><CodeLine lineNumber="220" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#abcb8fc2f380d99384c4d7601a22ea5d4"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#abcb8fc2f380d99384c4d7601a22ea5d4">AddrSpace</a> = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a4ee10cdfa2006d2b20dc564ae2995ee1">UnknownAddressSpace</a>;</Highlight></CodeLine>
<Link id="l00221" /><CodeLine lineNumber="221"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00222" /><CodeLine lineNumber="222" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a>() = </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00223" /><CodeLine lineNumber="223" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#ae6e8a4160a8933052075b0dab6e34d37"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#ae6e8a4160a8933052075b0dab6e34d37">MemAccessTy</a>(<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> AS) : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9">MemTy</a>(Ty), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#abcb8fc2f380d99384c4d7601a22ea5d4">AddrSpace</a>(AS) &#123;&#125;</Highlight></CodeLine>
<Link id="l00224" /><CodeLine lineNumber="224"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00225" /><CodeLine lineNumber="225" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a7183efe5ec28296357354f7c4a96fe90"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a7183efe5ec28296357354f7c4a96fe90">operator==</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00226" /><CodeLine lineNumber="226"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9">MemTy</a> == <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.MemTy &amp;&amp; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#abcb8fc2f380d99384c4d7601a22ea5d4">AddrSpace</a> == <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.AddrSpace;</Highlight></CodeLine>
<Link id="l00227" /><CodeLine lineNumber="227"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00228" /><CodeLine lineNumber="228"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00229" /><CodeLine lineNumber="229" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a60fd54d9eedf54e07ae485542a6fdddb"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a60fd54d9eedf54e07ae485542a6fdddb">operator!=</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> !(&#42;</Highlight><Highlight kind="keyword">this</Highlight><Highlight kind="normal"> == <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>); &#125;</Highlight></CodeLine>
<Link id="l00230" /><CodeLine lineNumber="230"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00231" /><CodeLine lineNumber="231" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a153bbcee36817bcedb110f30d95b2368"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a153bbcee36817bcedb110f30d95b2368">getUnknown</a>(<a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx,</Highlight></CodeLine>
<Link id="l00232" /><CodeLine lineNumber="232"><Highlight kind="normal">                                </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> AS = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a4ee10cdfa2006d2b20dc564ae2995ee1">UnknownAddressSpace</a>) &#123;</Highlight></CodeLine>
<Link id="l00233" /><CodeLine lineNumber="233"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a>(<a href="/docs/api/classes/llvm/type/#a6e20e76960d952de088354cbcd14c3ab">Type::getVoidTy</a>(Ctx), AS);</Highlight></CodeLine>
<Link id="l00234" /><CodeLine lineNumber="234"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00235" /><CodeLine lineNumber="235"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00236" /><CodeLine lineNumber="236" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#ad0cbf9c432ea20b9cb91c7b7402b2fb0"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#ad0cbf9c432ea20b9cb91c7b7402b2fb0">getType</a>() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9">MemTy</a>; &#125;</Highlight></CodeLine>
<Link id="l00237" /><CodeLine lineNumber="237"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00238" /><CodeLine lineNumber="238"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00239" /><CodeLine lineNumber="239"><Highlight kind="comment">/// This class holds data which is used to order reuse candidates.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00240" /><CodeLine lineNumber="240" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata"><Highlight kind="normal"></Highlight><Highlight kind="keyword">class </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a> &#123;</Highlight></CodeLine>
<Link id="l00241" /><CodeLine lineNumber="241"><Highlight kind="normal"></Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal">:</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00242" /><CodeLine lineNumber="242"><Highlight kind="comment">  /// This represents the set of LSRUse indices which reference</Highlight></CodeLine>
<Link id="l00243" /><CodeLine lineNumber="243"><Highlight kind="comment">  /// a particular register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00244" /><CodeLine lineNumber="244" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>;</Highlight></CodeLine>
<Link id="l00245" /><CodeLine lineNumber="245"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00246" /><CodeLine lineNumber="246"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00247" /><CodeLine lineNumber="247"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00248" /><CodeLine lineNumber="248"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00249" /><CodeLine lineNumber="249"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00250" /><CodeLine lineNumber="250"><Highlight kind="normal"></Highlight><Highlight kind="comment">// An offset from an address that is either scalable or fixed. Used for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00251" /><CodeLine lineNumber="251"><Highlight kind="normal"></Highlight><Highlight kind="comment">// per-target optimizations of addressing modes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00252" /><CodeLine lineNumber="252" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate"><Highlight kind="normal"></Highlight><Highlight kind="keyword">class </Highlight><Highlight kind="normal">Immediate : </Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity">details::FixedOrScalableQuantity</a>&lt;Immediate, int64&#95;t&gt; &#123;</Highlight></CodeLine>
<Link id="l00253" /><CodeLine lineNumber="253"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate(<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> MinVal, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>)</Highlight></CodeLine>
<Link id="l00254" /><CodeLine lineNumber="254"><Highlight kind="normal">      : <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a57beba2321012fb9cb702573f26fefff">FixedOrScalableQuantity</a>(MinVal, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>) &#123;&#125;</Highlight></CodeLine>
<Link id="l00255" /><CodeLine lineNumber="255"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00256" /><CodeLine lineNumber="256"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a57beba2321012fb9cb702573f26fefff">FixedOrScalableQuantity&lt;Immediate, int64&#95;t&gt;</a> &amp;V)</Highlight></CodeLine>
<Link id="l00257" /><CodeLine lineNumber="257"><Highlight kind="normal">      : <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a57beba2321012fb9cb702573f26fefff">FixedOrScalableQuantity</a>(V) &#123;&#125;</Highlight></CodeLine>
<Link id="l00258" /><CodeLine lineNumber="258"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00259" /><CodeLine lineNumber="259"><Highlight kind="normal"></Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l00260" /><CodeLine lineNumber="260" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a>() = </Highlight><Highlight kind="keyword">delete</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00261" /><CodeLine lineNumber="261"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00262" /><CodeLine lineNumber="262" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">getFixed</a>(<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> MinVal) &#123;</Highlight></CodeLine>
<Link id="l00263" /><CodeLine lineNumber="263"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;MinVal, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00264" /><CodeLine lineNumber="264"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00265" /><CodeLine lineNumber="265" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ac7030e0a5d4b154f205b3d85dde0644b"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ac7030e0a5d4b154f205b3d85dde0644b">getScalable</a>(<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> MinVal) &#123;</Highlight></CodeLine>
<Link id="l00266" /><CodeLine lineNumber="266"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;MinVal, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00267" /><CodeLine lineNumber="267"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00268" /><CodeLine lineNumber="268" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341">get</a>(<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> MinVal, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>) &#123;</Highlight></CodeLine>
<Link id="l00269" /><CodeLine lineNumber="269"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;MinVal, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>&#125;;</Highlight></CodeLine>
<Link id="l00270" /><CodeLine lineNumber="270"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00271" /><CodeLine lineNumber="271" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">getZero</a>() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;0, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">&#125;; &#125;</Highlight></CodeLine>
<Link id="l00272" /><CodeLine lineNumber="272" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a691a45579958cfd41dd9dcff39646ca0"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a691a45579958cfd41dd9dcff39646ca0">getFixedMin</a>() &#123;</Highlight></CodeLine>
<Link id="l00273" /><CodeLine lineNumber="273"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;std::numeric&#95;limits&lt;int64&#95;t&gt;::min(), </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00274" /><CodeLine lineNumber="274"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00275" /><CodeLine lineNumber="275" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a23392dbe6d771d111f00d09560f87f0d"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a23392dbe6d771d111f00d09560f87f0d">getFixedMax</a>() &#123;</Highlight></CodeLine>
<Link id="l00276" /><CodeLine lineNumber="276"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;std::numeric&#95;limits&lt;int64&#95;t&gt;::max(), </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00277" /><CodeLine lineNumber="277"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00278" /><CodeLine lineNumber="278" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#addbe1dedb40bb3add88146d6f912ab8d"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#addbe1dedb40bb3add88146d6f912ab8d">getScalableMin</a>() &#123;</Highlight></CodeLine>
<Link id="l00279" /><CodeLine lineNumber="279"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;std::numeric&#95;limits&lt;int64&#95;t&gt;::min(), </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00280" /><CodeLine lineNumber="280"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00281" /><CodeLine lineNumber="281" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a7b628b6318570ab9f5c98bf6a81d0c8c"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a7b628b6318570ab9f5c98bf6a81d0c8c">getScalableMax</a>() &#123;</Highlight></CodeLine>
<Link id="l00282" /><CodeLine lineNumber="282"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;std::numeric&#95;limits&lt;int64&#95;t&gt;::max(), </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00283" /><CodeLine lineNumber="283"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00284" /><CodeLine lineNumber="284"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00285" /><CodeLine lineNumber="285" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a09fbb09d8e3de5323f1bf48d5f6ce4d3"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a09fbb09d8e3de5323f1bf48d5f6ce4d3">isLessThanZero</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> &lt; 0; &#125;</Highlight></CodeLine>
<Link id="l00286" /><CodeLine lineNumber="286"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00287" /><CodeLine lineNumber="287" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#af83345cd673ad0ac4c8e054676d99e20"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#af83345cd673ad0ac4c8e054676d99e20">isGreaterThanZero</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> &gt; 0; &#125;</Highlight></CodeLine>
<Link id="l00288" /><CodeLine lineNumber="288"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00289" /><CodeLine lineNumber="289" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a17247f3e579ad4a489daa1eec47d02fc"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a17247f3e579ad4a489daa1eec47d02fc">isCompatibleImmediate</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Immediate &amp;Imm)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00290" /><CodeLine lineNumber="290"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/analysis/lint-cpp/#a45005634b54e2126cb3e6ec0dbc9ade4">isZero</a>() || Imm.isZero() || Imm.Scalable == <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>;</Highlight></CodeLine>
<Link id="l00291" /><CodeLine lineNumber="291"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00292" /><CodeLine lineNumber="292"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00293" /><CodeLine lineNumber="293" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#af9e551c149ce95daab0aea2894c9e57e"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#af9e551c149ce95daab0aea2894c9e57e">isMin</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00294" /><CodeLine lineNumber="294"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> == std::numeric&#95;limits&lt;ScalarTy&gt;::min();</Highlight></CodeLine>
<Link id="l00295" /><CodeLine lineNumber="295"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00296" /><CodeLine lineNumber="296"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00297" /><CodeLine lineNumber="297" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a823489f1b0ab38e3bbc2e19d87e53f4d"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a823489f1b0ab38e3bbc2e19d87e53f4d">isMax</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00298" /><CodeLine lineNumber="298"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> == std::numeric&#95;limits&lt;ScalarTy&gt;::max();</Highlight></CodeLine>
<Link id="l00299" /><CodeLine lineNumber="299"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00300" /><CodeLine lineNumber="300"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00301" /><CodeLine lineNumber="301"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Arithmetic &#39;operators&#39; that cast to unsigned types first.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00302" /><CodeLine lineNumber="302" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a94f015c2cf77ee4c5f81b8fef5347372"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a94f015c2cf77ee4c5f81b8fef5347372">addUnsigned</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Immediate &amp;RHS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00303" /><CodeLine lineNumber="303"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a17247f3e579ad4a489daa1eec47d02fc">isCompatibleImmediate</a>(RHS) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Incompatible Immediates&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00304" /><CodeLine lineNumber="304"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> <a href="/docs/api/classes/llvm/value">Value</a> = (uint64&#95;t)<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> + RHS.getKnownMinValue();</Highlight></CodeLine>
<Link id="l00305" /><CodeLine lineNumber="305"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;<a href="/docs/api/classes/llvm/value">Value</a>, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a> || RHS.isScalable()&#125;;</Highlight></CodeLine>
<Link id="l00306" /><CodeLine lineNumber="306"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00307" /><CodeLine lineNumber="307"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00308" /><CodeLine lineNumber="308" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ab49fcf96665935bc0bc9d4cbd0a61a5d"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ab49fcf96665935bc0bc9d4cbd0a61a5d">subUnsigned</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Immediate &amp;RHS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00309" /><CodeLine lineNumber="309"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a17247f3e579ad4a489daa1eec47d02fc">isCompatibleImmediate</a>(RHS) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Incompatible Immediates&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00310" /><CodeLine lineNumber="310"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> <a href="/docs/api/classes/llvm/value">Value</a> = (uint64&#95;t)<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> - RHS.getKnownMinValue();</Highlight></CodeLine>
<Link id="l00311" /><CodeLine lineNumber="311"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;<a href="/docs/api/classes/llvm/value">Value</a>, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a> || RHS.isScalable()&#125;;</Highlight></CodeLine>
<Link id="l00312" /><CodeLine lineNumber="312"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00313" /><CodeLine lineNumber="313"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00314" /><CodeLine lineNumber="314"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Scale the quantity by a constant without caring about runtime scalability.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00315" /><CodeLine lineNumber="315" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#aaee2861110d67f49f009585108f84fe9"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">constexpr</Highlight><Highlight kind="normal"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#aaee2861110d67f49f009585108f84fe9">mulUnsigned</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> RHS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00316" /><CodeLine lineNumber="316"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> <a href="/docs/api/classes/llvm/value">Value</a> = (uint64&#95;t)<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> &#42; RHS;</Highlight></CodeLine>
<Link id="l00317" /><CodeLine lineNumber="317"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;<a href="/docs/api/classes/llvm/value">Value</a>, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>&#125;;</Highlight></CodeLine>
<Link id="l00318" /><CodeLine lineNumber="318"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00319" /><CodeLine lineNumber="319"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00320" /><CodeLine lineNumber="320"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Helpers for generating SCEVs with vscale terms where needed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00321" /><CodeLine lineNumber="321" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a51c730254cd6b346d9fa4588c58a7517"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a51c730254cd6b346d9fa4588c58a7517">getSCEV</a>(<a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00322" /><CodeLine lineNumber="322"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(Ty, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a>);</Highlight></CodeLine>
<Link id="l00323" /><CodeLine lineNumber="323"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>)</Highlight></CodeLine>
<Link id="l00324" /><CodeLine lineNumber="324"><Highlight kind="normal">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(S, SE.<a href="/docs/api/classes/llvm/scalarevolution/#abc6d543083aac1a4e161c0ed02b9b30a">getVScale</a>(S-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</Highlight></CodeLine>
<Link id="l00325" /><CodeLine lineNumber="325"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> S;</Highlight></CodeLine>
<Link id="l00326" /><CodeLine lineNumber="326"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00327" /><CodeLine lineNumber="327"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00328" /><CodeLine lineNumber="328" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a81bada52d17e453e10221581a1bda050"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a81bada52d17e453e10221581a1bda050">getNegativeSCEV</a>(<a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00329" /><CodeLine lineNumber="329"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NegS = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(Ty, -(uint64&#95;t)<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a>);</Highlight></CodeLine>
<Link id="l00330" /><CodeLine lineNumber="330"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>)</Highlight></CodeLine>
<Link id="l00331" /><CodeLine lineNumber="331"><Highlight kind="normal">      NegS = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(NegS, SE.<a href="/docs/api/classes/llvm/scalarevolution/#abc6d543083aac1a4e161c0ed02b9b30a">getVScale</a>(NegS-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</Highlight></CodeLine>
<Link id="l00332" /><CodeLine lineNumber="332"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> NegS;</Highlight></CodeLine>
<Link id="l00333" /><CodeLine lineNumber="333"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00334" /><CodeLine lineNumber="334"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00335" /><CodeLine lineNumber="335" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a8829aacd47e6a4f3dbaf6c359d5afdfb"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a8829aacd47e6a4f3dbaf6c359d5afdfb">getUnknownSCEV</a>(<a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00336" /><CodeLine lineNumber="336"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;SU = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad8e4f5b2ced08ad7d138b598aefdd338">getUnknown</a>(<a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(Ty, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a>));</Highlight></CodeLine>
<Link id="l00337" /><CodeLine lineNumber="337"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>)</Highlight></CodeLine>
<Link id="l00338" /><CodeLine lineNumber="338"><Highlight kind="normal">      SU = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(SU, SE.<a href="/docs/api/classes/llvm/scalarevolution/#abc6d543083aac1a4e161c0ed02b9b30a">getVScale</a>(SU-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</Highlight></CodeLine>
<Link id="l00339" /><CodeLine lineNumber="339"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SU;</Highlight></CodeLine>
<Link id="l00340" /><CodeLine lineNumber="340"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00341" /><CodeLine lineNumber="341"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00342" /><CodeLine lineNumber="342"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00343" /><CodeLine lineNumber="343"><Highlight kind="normal"></Highlight><Highlight kind="comment">// This is needed for the Compare type of std::map when Immediate is used</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00344" /><CodeLine lineNumber="344"><Highlight kind="normal"></Highlight><Highlight kind="comment">// as a key. We don&#39;t need it to be fully correct against any value of vscale,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00345" /><CodeLine lineNumber="345"><Highlight kind="normal"></Highlight><Highlight kind="comment">// just to make sure that vscale-related terms in the map are considered against</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00346" /><CodeLine lineNumber="346"><Highlight kind="normal"></Highlight><Highlight kind="comment">// each other rather than being mixed up and potentially missing opportunities.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00347" /><CodeLine lineNumber="347" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate">KeyOrderTargetImmediate</a> &#123;</Highlight></CodeLine>
<Link id="l00348" /><CodeLine lineNumber="348" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate/#aeaef27a0b75edede472740694b20ca90"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate/#aeaef27a0b75edede472740694b20ca90">operator()</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> &amp;LHS, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> &amp;RHS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00349" /><CodeLine lineNumber="349"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LHS.isScalable() &amp;&amp; !RHS.isScalable())</Highlight></CodeLine>
<Link id="l00350" /><CodeLine lineNumber="350"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00351" /><CodeLine lineNumber="351"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LHS.isScalable() &amp;&amp; RHS.isScalable())</Highlight></CodeLine>
<Link id="l00352" /><CodeLine lineNumber="352"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00353" /><CodeLine lineNumber="353"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LHS.getKnownMinValue() &lt; RHS.getKnownMinValue();</Highlight></CodeLine>
<Link id="l00354" /><CodeLine lineNumber="354"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00355" /><CodeLine lineNumber="355"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00356" /><CodeLine lineNumber="356"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00357" /><CodeLine lineNumber="357"><Highlight kind="normal"></Highlight><Highlight kind="comment">// This would be nicer if we could be generic instead of directly using size&#95;t,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00358" /><CodeLine lineNumber="358"><Highlight kind="normal"></Highlight><Highlight kind="comment">// but there doesn&#39;t seem to be a type trait for is&#95;orderable or</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00359" /><CodeLine lineNumber="359"><Highlight kind="normal"></Highlight><Highlight kind="comment">// is&#95;lessthan&#95;comparable or similar.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00360" /><CodeLine lineNumber="360" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate">KeyOrderSizeTAndImmediate</a> &#123;</Highlight></CodeLine>
<Link id="l00361" /><CodeLine lineNumber="361" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate/#a839eca6f38e94cf573f5614ef356342e"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate/#a839eca6f38e94cf573f5614ef356342e">operator()</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> std::pair&lt;size&#95;t, Immediate&gt; &amp;LHS,</Highlight></CodeLine>
<Link id="l00362" /><CodeLine lineNumber="362"><Highlight kind="normal">                  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> std::pair&lt;size&#95;t, Immediate&gt; &amp;RHS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00363" /><CodeLine lineNumber="363"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LSize = LHS.first;</Highlight></CodeLine>
<Link id="l00364" /><CodeLine lineNumber="364"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> RSize = RHS.first;</Highlight></CodeLine>
<Link id="l00365" /><CodeLine lineNumber="365"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LSize != RSize)</Highlight></CodeLine>
<Link id="l00366" /><CodeLine lineNumber="366"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LSize &lt; RSize;</Highlight></CodeLine>
<Link id="l00367" /><CodeLine lineNumber="367"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate">KeyOrderTargetImmediate</a>()(LHS.second, RHS.second);</Highlight></CodeLine>
<Link id="l00368" /><CodeLine lineNumber="368"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00369" /><CodeLine lineNumber="369"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00370" /><CodeLine lineNumber="370"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// end anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00371" /><CodeLine lineNumber="371"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00372" /><CodeLine lineNumber="372"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00373" /><CodeLine lineNumber="373" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#a4238146a308b03c91ba9bfb8f7096da5"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#a4238146a308b03c91ba9bfb8f7096da5">RegSortData::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00374" /><CodeLine lineNumber="374"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;&#91;NumUses=&quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.count() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;&#93;&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00375" /><CodeLine lineNumber="375"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00376" /><CodeLine lineNumber="376"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00377" /><CodeLine lineNumber="377" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#a8efa96a6fa3836082f6d19af59855749"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#a8efa96a6fa3836082f6d19af59855749">RegSortData::dump</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00378" /><CodeLine lineNumber="378"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00379" /><CodeLine lineNumber="379"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00380" /><CodeLine lineNumber="380"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00381" /><CodeLine lineNumber="381"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00382" /><CodeLine lineNumber="382"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00383" /><CodeLine lineNumber="383"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00384" /><CodeLine lineNumber="384"><Highlight kind="comment">/// Map register candidates to information about how they are used.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00385" /><CodeLine lineNumber="385" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker"><Highlight kind="normal"></Highlight><Highlight kind="keyword">class </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &#123;</Highlight></CodeLine>
<Link id="l00386" /><CodeLine lineNumber="386"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal">RegUsesTy = <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;const SCEV &#42;, RegSortData&gt;</a>;</Highlight></CodeLine>
<Link id="l00387" /><CodeLine lineNumber="387"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00388" /><CodeLine lineNumber="388"><Highlight kind="normal">  RegUsesTy RegUsesMap;</Highlight></CodeLine>
<Link id="l00389" /><CodeLine lineNumber="389"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 16&gt;</a> RegSequence;</Highlight></CodeLine>
<Link id="l00390" /><CodeLine lineNumber="390"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00391" /><CodeLine lineNumber="391"><Highlight kind="normal"></Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l00392" /><CodeLine lineNumber="392"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a13a5af062b4806f2bd27402b3c6d96ff">countRegister</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx);</Highlight></CodeLine>
<Link id="l00393" /><CodeLine lineNumber="393"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a6a56d58ef201c3111c594b541bfef549">dropRegister</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx);</Highlight></CodeLine>
<Link id="l00394" /><CodeLine lineNumber="394"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a3eb3a081cacc38c1381cf09b9bb18896">swapAndDropUse</a>(</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LastLUIdx);</Highlight></CodeLine>
<Link id="l00395" /><CodeLine lineNumber="395"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00396" /><CodeLine lineNumber="396"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8">isRegUsedByUsesOtherThan</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00397" /><CodeLine lineNumber="397"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00398" /><CodeLine lineNumber="398"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#ab1c14aaffa1b779ce5a92c7dcc05f82e">getUsedByIndices</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00399" /><CodeLine lineNumber="399"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00400" /><CodeLine lineNumber="400"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a14ad095be362f7dd688c153d7ba9a175">clear</a>();</Highlight></CodeLine>
<Link id="l00401" /><CodeLine lineNumber="401"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00402" /><CodeLine lineNumber="402" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a21aba04f31017f55f43d2e7cf3c1c1bf"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a21aba04f31017f55f43d2e7cf3c1c1bf">iterator</a> = <a href="/docs/api/classes/llvm/smallvectorimpl/#ac5b936169badf0b703567eb960278648">SmallVectorImpl&lt;const SCEV &#42;&gt;::iterator</a>;</Highlight></CodeLine>
<Link id="l00403" /><CodeLine lineNumber="403" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a5a0d256358eb9a6994ec926a8cd18274"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a5a0d256358eb9a6994ec926a8cd18274">const&#95;iterator</a> = <a href="/docs/api/classes/llvm/smallvectorimpl/#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;const SCEV &#42;&gt;::const&#95;iterator</a>;</Highlight></CodeLine>
<Link id="l00404" /><CodeLine lineNumber="404"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00405" /><CodeLine lineNumber="405" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a24db856ac6d50aff7b2ab43995f15d6d"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a21aba04f31017f55f43d2e7cf3c1c1bf">iterator</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a24db856ac6d50aff7b2ab43995f15d6d">begin</a>() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RegSequence.begin(); &#125;</Highlight></CodeLine>
<Link id="l00406" /><CodeLine lineNumber="406" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a83e3936deef3bb1c920cb7c38a550a54"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a21aba04f31017f55f43d2e7cf3c1c1bf">iterator</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a83e3936deef3bb1c920cb7c38a550a54">end</a>()   &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RegSequence.end(); &#125;</Highlight></CodeLine>
<Link id="l00407" /><CodeLine lineNumber="407" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a7c7496da55decd93c55e294066609e5f"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a5a0d256358eb9a6994ec926a8cd18274">const&#95;iterator</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a7c7496da55decd93c55e294066609e5f">begin</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RegSequence.begin(); &#125;</Highlight></CodeLine>
<Link id="l00408" /><CodeLine lineNumber="408" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a70480517636076003c44cb6107ea0d70"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a5a0d256358eb9a6994ec926a8cd18274">const&#95;iterator</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a70480517636076003c44cb6107ea0d70">end</a>()</Highlight><Highlight kind="keyword"> const   </Highlight><Highlight kind="normal">&#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> RegSequence.end(); &#125;</Highlight></CodeLine>
<Link id="l00409" /><CodeLine lineNumber="409"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00410" /><CodeLine lineNumber="410"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00411" /><CodeLine lineNumber="411"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// end anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00412" /><CodeLine lineNumber="412"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00413" /><CodeLine lineNumber="413"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00414" /><CodeLine lineNumber="414" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a13a5af062b4806f2bd27402b3c6d96ff"><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a13a5af062b4806f2bd27402b3c6d96ff">RegUseTracker::countRegister</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx) &#123;</Highlight></CodeLine>
<Link id="l00415" /><CodeLine lineNumber="415"><Highlight kind="normal">  std::pair&lt;RegUsesTy::iterator, bool&gt; Pair =</Highlight></CodeLine>
<Link id="l00416" /><CodeLine lineNumber="416"><Highlight kind="normal">    RegUsesMap.insert(std::make&#95;pair(Reg, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a>()));</Highlight></CodeLine>
<Link id="l00417" /><CodeLine lineNumber="417"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a> &amp;RSD = Pair.first-&gt;second;</Highlight></CodeLine>
<Link id="l00418" /><CodeLine lineNumber="418"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Pair.second)</Highlight></CodeLine>
<Link id="l00419" /><CodeLine lineNumber="419"><Highlight kind="normal">    RegSequence.push&#95;back(Reg);</Highlight></CodeLine>
<Link id="l00420" /><CodeLine lineNumber="420"><Highlight kind="normal">  RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#aa79d9a55d612eb330a0e25dc4170470d">resize</a>(std::max(RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>(), LUIdx + 1));</Highlight></CodeLine>
<Link id="l00421" /><CodeLine lineNumber="421"><Highlight kind="normal">  RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#a18e2d7efe05987370dc6b5c54797fcf5">set</a>(LUIdx);</Highlight></CodeLine>
<Link id="l00422" /><CodeLine lineNumber="422"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00423" /><CodeLine lineNumber="423"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00424" /><CodeLine lineNumber="424"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00425" /><CodeLine lineNumber="425" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a6a56d58ef201c3111c594b541bfef549"><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a6a56d58ef201c3111c594b541bfef549">RegUseTracker::dropRegister</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx) &#123;</Highlight></CodeLine>
<Link id="l00426" /><CodeLine lineNumber="426"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/densemapbase/#a214e872d61db2ea8cb023f127cafd0b9">RegUsesTy::iterator</a> It = RegUsesMap.find(Reg);</Highlight></CodeLine>
<Link id="l00427" /><CodeLine lineNumber="427"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It != RegUsesMap.end());</Highlight></CodeLine>
<Link id="l00428" /><CodeLine lineNumber="428"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a> &amp;RSD = It-&gt;second;</Highlight></CodeLine>
<Link id="l00429" /><CodeLine lineNumber="429"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>() &gt; LUIdx);</Highlight></CodeLine>
<Link id="l00430" /><CodeLine lineNumber="430"><Highlight kind="normal">  RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#af1232d0679de538d35381496f43e303a">reset</a>(LUIdx);</Highlight></CodeLine>
<Link id="l00431" /><CodeLine lineNumber="431"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00432" /><CodeLine lineNumber="432"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00433" /><CodeLine lineNumber="433"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00434" /><CodeLine lineNumber="434" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a3eb3a081cacc38c1381cf09b9bb18896"><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a3eb3a081cacc38c1381cf09b9bb18896">RegUseTracker::swapAndDropUse</a>(</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LastLUIdx) &#123;</Highlight></CodeLine>
<Link id="l00435" /><CodeLine lineNumber="435"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LUIdx &lt;= LastLUIdx);</Highlight></CodeLine>
<Link id="l00436" /><CodeLine lineNumber="436"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00437" /><CodeLine lineNumber="437"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update RegUses. The data structure is not optimized for this purpose;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00438" /><CodeLine lineNumber="438"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// we must iterate through it and update each of the bit vectors.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00439" /><CodeLine lineNumber="439"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Pair : RegUsesMap) &#123;</Highlight></CodeLine>
<Link id="l00440" /><CodeLine lineNumber="440"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = Pair.second.UsedByIndices;</Highlight></CodeLine>
<Link id="l00441" /><CodeLine lineNumber="441"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LUIdx &lt; UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>())</Highlight></CodeLine>
<Link id="l00442" /><CodeLine lineNumber="442"><Highlight kind="normal">      UsedByIndices&#91;LUIdx&#93; =</Highlight></CodeLine>
<Link id="l00443" /><CodeLine lineNumber="443"><Highlight kind="normal">        LastLUIdx &lt; UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>() ? UsedByIndices&#91;LastLUIdx&#93; : </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00444" /><CodeLine lineNumber="444"><Highlight kind="normal">    UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#aa79d9a55d612eb330a0e25dc4170470d">resize</a>(std::min(UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>(), LastLUIdx));</Highlight></CodeLine>
<Link id="l00445" /><CodeLine lineNumber="445"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00446" /><CodeLine lineNumber="446"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00447" /><CodeLine lineNumber="447"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00448" /><CodeLine lineNumber="448"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00449" /><CodeLine lineNumber="449" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8"><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8">RegUseTracker::isRegUsedByUsesOtherThan</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00450" /><CodeLine lineNumber="450"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/densemapbase/#a5784c312872bef21d9344dae0a0e8fc0">RegUsesTy::const&#95;iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = RegUsesMap.find(Reg);</Highlight></CodeLine>
<Link id="l00451" /><CodeLine lineNumber="451"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> == RegUsesMap.end())</Highlight></CodeLine>
<Link id="l00452" /><CodeLine lineNumber="452"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00453" /><CodeLine lineNumber="453"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;second.UsedByIndices;</Highlight></CodeLine>
<Link id="l00454" /><CodeLine lineNumber="454"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> i = UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#a12297e7775aa1fc62fbea882aef623fc">find&#95;first</a>();</Highlight></CodeLine>
<Link id="l00455" /><CodeLine lineNumber="455"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (i == -1) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00456" /><CodeLine lineNumber="456"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal">)i != LUIdx) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00457" /><CodeLine lineNumber="457"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#a823f7f9343d9bb1e02104ae3b2d3edb9">find&#95;next</a>(i) != -1;</Highlight></CodeLine>
<Link id="l00458" /><CodeLine lineNumber="458"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00459" /><CodeLine lineNumber="459"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00460" /><CodeLine lineNumber="460" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#ab1c14aaffa1b779ce5a92c7dcc05f82e"><Highlight kind="normal"></Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#ab1c14aaffa1b779ce5a92c7dcc05f82e">RegUseTracker::getUsedByIndices</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00461" /><CodeLine lineNumber="461"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/densemapbase/#a5784c312872bef21d9344dae0a0e8fc0">RegUsesTy::const&#95;iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = RegUsesMap.find(Reg);</Highlight></CodeLine>
<Link id="l00462" /><CodeLine lineNumber="462"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != RegUsesMap.end() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Unknown register!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00463" /><CodeLine lineNumber="463"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;second.UsedByIndices;</Highlight></CodeLine>
<Link id="l00464" /><CodeLine lineNumber="464"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00465" /><CodeLine lineNumber="465"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00466" /><CodeLine lineNumber="466" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a14ad095be362f7dd688c153d7ba9a175"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a14ad095be362f7dd688c153d7ba9a175">RegUseTracker::clear</a>() &#123;</Highlight></CodeLine>
<Link id="l00467" /><CodeLine lineNumber="467"><Highlight kind="normal">  RegUsesMap.clear();</Highlight></CodeLine>
<Link id="l00468" /><CodeLine lineNumber="468"><Highlight kind="normal">  RegSequence.clear();</Highlight></CodeLine>
<Link id="l00469" /><CodeLine lineNumber="469"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00470" /><CodeLine lineNumber="470"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00471" /><CodeLine lineNumber="471"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00472" /><CodeLine lineNumber="472"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00473" /><CodeLine lineNumber="473"><Highlight kind="comment">/// This class holds information that describes a formula for computing</Highlight></CodeLine>
<Link id="l00474" /><CodeLine lineNumber="474"><Highlight kind="comment">/// satisfying a use. It may include broken-out immediates and scaled registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00475" /><CodeLine lineNumber="475" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a0d4735864020dc6d7bef7067c9a16a3d">Formula</a> &#123;</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00476" /><CodeLine lineNumber="476"><Highlight kind="comment">  /// Global base address used for complex addressing.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00477" /><CodeLine lineNumber="477" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00478" /><CodeLine lineNumber="478"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00479" /><CodeLine lineNumber="479"><Highlight kind="comment">  /// Base offset for complex addressing.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00480" /><CodeLine lineNumber="480" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152">BaseOffset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</Highlight></CodeLine>
<Link id="l00481" /><CodeLine lineNumber="481"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00482" /><CodeLine lineNumber="482"><Highlight kind="comment">  /// Whether any complex addressing has a base register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00483" /><CodeLine lineNumber="483" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00484" /><CodeLine lineNumber="484"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00485" /><CodeLine lineNumber="485"><Highlight kind="comment">  /// The scale of any complex addressing.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00486" /><CodeLine lineNumber="486" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48"><Highlight kind="normal">  int64&#95;t <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> = 0;</Highlight></CodeLine>
<Link id="l00487" /><CodeLine lineNumber="487"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00488" /><CodeLine lineNumber="488"><Highlight kind="comment">  /// The list of &quot;base&quot; registers for this use. When this is non-empty. The</Highlight></CodeLine>
<Link id="l00489" /><CodeLine lineNumber="489"><Highlight kind="comment">  /// canonical representation of a formula is</Highlight></CodeLine>
<Link id="l00490" /><CodeLine lineNumber="490"><Highlight kind="comment">  /// 1 BaseRegs.size &gt; 1 implies ScaledReg != NULL and</Highlight></CodeLine>
<Link id="l00491" /><CodeLine lineNumber="491"><Highlight kind="comment">  /// 2 ScaledReg != NULL implies Scale != 1 || !BaseRegs.empty().</Highlight></CodeLine>
<Link id="l00492" /><CodeLine lineNumber="492"><Highlight kind="comment">  /// 3 The reg containing recurrent expr related with currect loop in the</Highlight></CodeLine>
<Link id="l00493" /><CodeLine lineNumber="493"><Highlight kind="comment">  /// formula should be put in the ScaledReg.</Highlight></CodeLine>
<Link id="l00494" /><CodeLine lineNumber="494"><Highlight kind="comment">  /// #1 enforces that the scaled register is always used when at least two</Highlight></CodeLine>
<Link id="l00495" /><CodeLine lineNumber="495"><Highlight kind="comment">  /// registers are needed by the formula: e.g., reg1 + reg2 is reg1 + 1 &#42; reg2.</Highlight></CodeLine>
<Link id="l00496" /><CodeLine lineNumber="496"><Highlight kind="comment">  /// #2 enforces that 1 &#42; reg is reg.</Highlight></CodeLine>
<Link id="l00497" /><CodeLine lineNumber="497"><Highlight kind="comment">  /// #3 ensures invariant regs with respect to current loop can be combined</Highlight></CodeLine>
<Link id="l00498" /><CodeLine lineNumber="498"><Highlight kind="comment">  /// together in LSR codegen.</Highlight></CodeLine>
<Link id="l00499" /><CodeLine lineNumber="499"><Highlight kind="comment">  /// This invariant can be temporarily broken while building a formula.</Highlight></CodeLine>
<Link id="l00500" /><CodeLine lineNumber="500"><Highlight kind="comment">  /// However, every formula inserted into the LSRInstance must be in canonical</Highlight></CodeLine>
<Link id="l00501" /><CodeLine lineNumber="501"><Highlight kind="comment">  /// form.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00502" /><CodeLine lineNumber="502" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>;</Highlight></CodeLine>
<Link id="l00503" /><CodeLine lineNumber="503"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00504" /><CodeLine lineNumber="504"><Highlight kind="comment">  /// The &#39;scaled&#39; register for this use. This should be non-null when Scale is</Highlight></CodeLine>
<Link id="l00505" /><CodeLine lineNumber="505"><Highlight kind="comment">  /// not zero.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00506" /><CodeLine lineNumber="506" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00507" /><CodeLine lineNumber="507"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00508" /><CodeLine lineNumber="508"><Highlight kind="comment">  /// An additional constant offset which added near the use. This requires a</Highlight></CodeLine>
<Link id="l00509" /><CodeLine lineNumber="509"><Highlight kind="comment">  /// temporary register, but the offset itself can live in an add immediate</Highlight></CodeLine>
<Link id="l00510" /><CodeLine lineNumber="510"><Highlight kind="comment">  /// field rather than a register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00511" /><CodeLine lineNumber="511" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3">UnfoldedOffset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</Highlight></CodeLine>
<Link id="l00512" /><CodeLine lineNumber="512"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00513" /><CodeLine lineNumber="513" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a0d4735864020dc6d7bef7067c9a16a3d"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a0d4735864020dc6d7bef7067c9a16a3d">Formula</a>() = </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00514" /><CodeLine lineNumber="514"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00515" /><CodeLine lineNumber="515"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5e104e7ceecb5b2eddfc08e66e925c09">initialMatch</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE);</Highlight></CodeLine>
<Link id="l00516" /><CodeLine lineNumber="516"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00517" /><CodeLine lineNumber="517"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/ir/debuginfometadata-cpp/#a97d418be7ec7fc90283cc2fee34599ce">isCanonical</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00518" /><CodeLine lineNumber="518"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00519" /><CodeLine lineNumber="519"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aef242a2293780c65ed1974184bc17193">canonicalize</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L);</Highlight></CodeLine>
<Link id="l00520" /><CodeLine lineNumber="520"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00521" /><CodeLine lineNumber="521"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad02fff210996fa6f08b890aabf0f10ca">unscale</a>();</Highlight></CodeLine>
<Link id="l00522" /><CodeLine lineNumber="522"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00523" /><CodeLine lineNumber="523"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2fab594af348068066d23af810379fff">hasZeroEnd</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00524" /><CodeLine lineNumber="524"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00525" /><CodeLine lineNumber="525"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a326e8d43b798acbc2b57c0ed8573b492">getNumRegs</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00526" /><CodeLine lineNumber="526"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/files/lib/lib/object/tapifile-cpp/#a913a691648e20063bbd278e8f02d8430">getType</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00527" /><CodeLine lineNumber="527"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00528" /><CodeLine lineNumber="528"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a3ae8c31aeebb77960343a102ce36adcb">deleteBaseReg</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;S);</Highlight></CodeLine>
<Link id="l00529" /><CodeLine lineNumber="529"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00530" /><CodeLine lineNumber="530"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7984ece4636cc86706ac5bdfefe3bc6d">referencesReg</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00531" /><CodeLine lineNumber="531"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a98e7bf1bb1d9378c9867e4168a7bfa89">hasRegsUsedByUsesOtherThan</a>(</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l00532" /><CodeLine lineNumber="532"><Highlight kind="normal">                                  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &amp;RegUses) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00533" /><CodeLine lineNumber="533"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00534" /><CodeLine lineNumber="534"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00535" /><CodeLine lineNumber="535"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00536" /><CodeLine lineNumber="536"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l00537" /><CodeLine lineNumber="537"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00538" /><CodeLine lineNumber="538"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// end anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00539" /><CodeLine lineNumber="539"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00540" /><CodeLine lineNumber="540"><Highlight kind="comment">/// Recursion helper for initialMatch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00541" /><CodeLine lineNumber="541" lineLink="#aa59a46776e15b1f1bd597c4e1e769f59"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L,</Highlight></CodeLine>
<Link id="l00542" /><CodeLine lineNumber="542"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const SCEV &#42;&gt;</a> &amp;Good,</Highlight></CodeLine>
<Link id="l00543" /><CodeLine lineNumber="543"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const SCEV &#42;&gt;</a> &amp;Bad,</Highlight></CodeLine>
<Link id="l00544" /><CodeLine lineNumber="544"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l00545" /><CodeLine lineNumber="545"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Collect expressions which properly dominate the loop header.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00546" /><CodeLine lineNumber="546"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.<a href="/docs/api/classes/llvm/scalarevolution/#ae0d036af111b8aafe90db0771b8e9ce3">properlyDominates</a>(S, L-&gt;getHeader())) &#123;</Highlight></CodeLine>
<Link id="l00547" /><CodeLine lineNumber="547"><Highlight kind="normal">    Good.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(S);</Highlight></CodeLine>
<Link id="l00548" /><CodeLine lineNumber="548"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00549" /><CodeLine lineNumber="549"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00550" /><CodeLine lineNumber="550"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00551" /><CodeLine lineNumber="551"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Look at add operands.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00552" /><CodeLine lineNumber="552"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l00553" /><CodeLine lineNumber="553"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands())</Highlight></CodeLine>
<Link id="l00554" /><CodeLine lineNumber="554"><Highlight kind="normal">      <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(S, L, Good, Bad, SE);</Highlight></CodeLine>
<Link id="l00555" /><CodeLine lineNumber="555"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00556" /><CodeLine lineNumber="556"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00557" /><CodeLine lineNumber="557"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00558" /><CodeLine lineNumber="558"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Look at addrec operands.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00559" /><CodeLine lineNumber="559"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S))</Highlight></CodeLine>
<Link id="l00560" /><CodeLine lineNumber="560"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AR-&gt;getStart()-&gt;isZero() &amp;&amp; AR-&gt;isAffine()) &#123;</Highlight></CodeLine>
<Link id="l00561" /><CodeLine lineNumber="561"><Highlight kind="normal">      <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(AR-&gt;getStart(), L, Good, Bad, SE);</Highlight></CodeLine>
<Link id="l00562" /><CodeLine lineNumber="562"><Highlight kind="normal">      <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(AR-&gt;getType(), 0),</Highlight></CodeLine>
<Link id="l00563" /><CodeLine lineNumber="563"><Highlight kind="normal">                                      AR-&gt;getStepRecurrence(SE),</Highlight></CodeLine>
<Link id="l00564" /><CodeLine lineNumber="564"><Highlight kind="normal">                                      </Highlight><Highlight kind="comment">// FIXME: AR-&gt;getNoWrapFlags()</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00565" /><CodeLine lineNumber="565"><Highlight kind="normal">                                      AR-&gt;getLoop(), <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>),</Highlight></CodeLine>
<Link id="l00566" /><CodeLine lineNumber="566"><Highlight kind="normal">                     L, Good, Bad, SE);</Highlight></CodeLine>
<Link id="l00567" /><CodeLine lineNumber="567"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00568" /><CodeLine lineNumber="568"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00569" /><CodeLine lineNumber="569"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00570" /><CodeLine lineNumber="570"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Handle a multiplication by -1 (negation) if it didn&#39;t fold.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00571" /><CodeLine lineNumber="571"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S))</Highlight></CodeLine>
<Link id="l00572" /><CodeLine lineNumber="572"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(0)-&gt;isAllOnesValue()) &#123;</Highlight></CodeLine>
<Link id="l00573" /><CodeLine lineNumber="573"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>(<a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">drop&#95;begin</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;operands()));</Highlight></CodeLine>
<Link id="l00574" /><CodeLine lineNumber="574"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewMul = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>);</Highlight></CodeLine>
<Link id="l00575" /><CodeLine lineNumber="575"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00576" /><CodeLine lineNumber="576"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> MyGood;</Highlight></CodeLine>
<Link id="l00577" /><CodeLine lineNumber="577"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> MyBad;</Highlight></CodeLine>
<Link id="l00578" /><CodeLine lineNumber="578"><Highlight kind="normal">      <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(NewMul, L, MyGood, MyBad, SE);</Highlight></CodeLine>
<Link id="l00579" /><CodeLine lineNumber="579"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NegOne = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a href="/docs/api/classes/llvm/constant/#a4d51384de6e1798bb6aa875aebeea9f0">ConstantInt::getAllOnesValue</a>(</Highlight></CodeLine>
<Link id="l00580" /><CodeLine lineNumber="580"><Highlight kind="normal">        SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6dcfa69ce27cf214caaf50f21bfe1f2f">getEffectiveSCEVType</a>(NewMul-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>())));</Highlight></CodeLine>
<Link id="l00581" /><CodeLine lineNumber="581"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : MyGood)</Highlight></CodeLine>
<Link id="l00582" /><CodeLine lineNumber="582"><Highlight kind="normal">        Good.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(NegOne, S));</Highlight></CodeLine>
<Link id="l00583" /><CodeLine lineNumber="583"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : MyBad)</Highlight></CodeLine>
<Link id="l00584" /><CodeLine lineNumber="584"><Highlight kind="normal">        Bad.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(NegOne, S));</Highlight></CodeLine>
<Link id="l00585" /><CodeLine lineNumber="585"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00586" /><CodeLine lineNumber="586"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00587" /><CodeLine lineNumber="587"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00588" /><CodeLine lineNumber="588"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ok, we can&#39;t do anything interesting. Just stuff the whole thing into a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00589" /><CodeLine lineNumber="589"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// register and hope for the best.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00590" /><CodeLine lineNumber="590"><Highlight kind="normal">  Bad.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(S);</Highlight></CodeLine>
<Link id="l00591" /><CodeLine lineNumber="591"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00592" /><CodeLine lineNumber="592"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00593" /><CodeLine lineNumber="593"><Highlight kind="comment">/// Incorporate loop-variant parts of S into this Formula, attempting to keep</Highlight></CodeLine>
<Link id="l00594" /><CodeLine lineNumber="594"><Highlight kind="comment">/// all loop-invariant and loop-computable values in a single base register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00595" /><CodeLine lineNumber="595" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5e104e7ceecb5b2eddfc08e66e925c09"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5e104e7ceecb5b2eddfc08e66e925c09">Formula::initialMatch</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l00596" /><CodeLine lineNumber="596"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> Good;</Highlight></CodeLine>
<Link id="l00597" /><CodeLine lineNumber="597"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> Bad;</Highlight></CodeLine>
<Link id="l00598" /><CodeLine lineNumber="598"><Highlight kind="normal">  <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(S, L, Good, Bad, SE);</Highlight></CodeLine>
<Link id="l00599" /><CodeLine lineNumber="599"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Good.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</Highlight></CodeLine>
<Link id="l00600" /><CodeLine lineNumber="600"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Sum = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(Good);</Highlight></CodeLine>
<Link id="l00601" /><CodeLine lineNumber="601"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Sum-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</Highlight></CodeLine>
<Link id="l00602" /><CodeLine lineNumber="602"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.push&#95;back(Sum);</Highlight></CodeLine>
<Link id="l00603" /><CodeLine lineNumber="603"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00604" /><CodeLine lineNumber="604"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00605" /><CodeLine lineNumber="605"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Bad.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</Highlight></CodeLine>
<Link id="l00606" /><CodeLine lineNumber="606"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Sum = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(Bad);</Highlight></CodeLine>
<Link id="l00607" /><CodeLine lineNumber="607"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Sum-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</Highlight></CodeLine>
<Link id="l00608" /><CodeLine lineNumber="608"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.push&#95;back(Sum);</Highlight></CodeLine>
<Link id="l00609" /><CodeLine lineNumber="609"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00610" /><CodeLine lineNumber="610"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00611" /><CodeLine lineNumber="611"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aef242a2293780c65ed1974184bc17193">canonicalize</a>(&#42;L);</Highlight></CodeLine>
<Link id="l00612" /><CodeLine lineNumber="612"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00613" /><CodeLine lineNumber="613"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00614" /><CodeLine lineNumber="614" lineLink="#a1fb9d2e9aea7544f9453aa3e2df38109"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</Highlight></CodeLine>
<Link id="l00615" /><CodeLine lineNumber="615"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#affb88623037a9864e030154052747ba1">SCEVExprContains</a>(S, &#91;&amp;L&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</Highlight></CodeLine>
<Link id="l00616" /><CodeLine lineNumber="616"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(S) &amp;&amp; (<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(S)-&gt;getLoop() == &amp;L);</Highlight></CodeLine>
<Link id="l00617" /><CodeLine lineNumber="617"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l00618" /><CodeLine lineNumber="618"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00619" /><CodeLine lineNumber="619"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00620" /><CodeLine lineNumber="620"><Highlight kind="comment">/// Check whether or not this formula satisfies the canonical</Highlight></CodeLine>
<Link id="l00621" /><CodeLine lineNumber="621"><Highlight kind="comment">/// representation.</Highlight></CodeLine>
<Link id="l00622" /><CodeLine lineNumber="622"><Highlight kind="comment">/// \\see Formula::BaseRegs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00623" /><CodeLine lineNumber="623" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a315b16382757c50cd6c367fb26e1b15b"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a315b16382757c50cd6c367fb26e1b15b">Formula::isCanonical</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00624" /><CodeLine lineNumber="624"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> == 0 || <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l00625" /><CodeLine lineNumber="625"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;ScaledReg must be non-null if Scale is non-zero&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00626" /><CodeLine lineNumber="626"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00627" /><CodeLine lineNumber="627"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>)</Highlight></CodeLine>
<Link id="l00628" /><CodeLine lineNumber="628"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.size() &lt;= 1;</Highlight></CodeLine>
<Link id="l00629" /><CodeLine lineNumber="629"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00630" /><CodeLine lineNumber="630"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> != 1)</Highlight></CodeLine>
<Link id="l00631" /><CodeLine lineNumber="631"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00632" /><CodeLine lineNumber="632"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00633" /><CodeLine lineNumber="633"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> == 1 &amp;&amp; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty())</Highlight></CodeLine>
<Link id="l00634" /><CodeLine lineNumber="634"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00635" /><CodeLine lineNumber="635"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00636" /><CodeLine lineNumber="636"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>, L))</Highlight></CodeLine>
<Link id="l00637" /><CodeLine lineNumber="637"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00638" /><CodeLine lineNumber="638"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00639" /><CodeLine lineNumber="639"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If ScaledReg is not a recurrent expr, or it is but its loop is not current</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00640" /><CodeLine lineNumber="640"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// loop, meanwhile BaseRegs contains a recurrent expr reg related with current</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00641" /><CodeLine lineNumber="641"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// loop, we want to swap the reg in BaseRegs with ScaledReg.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00642" /><CodeLine lineNumber="642"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a7dc3069afa2ce5ea62ac2eb183e51c00">none&#95;of</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>, &#91;&amp;L&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</Highlight></CodeLine>
<Link id="l00643" /><CodeLine lineNumber="643"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(S, L);</Highlight></CodeLine>
<Link id="l00644" /><CodeLine lineNumber="644"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l00645" /><CodeLine lineNumber="645"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00646" /><CodeLine lineNumber="646"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00647" /><CodeLine lineNumber="647"><Highlight kind="comment">/// Helper method to morph a formula into its canonical representation.</Highlight></CodeLine>
<Link id="l00648" /><CodeLine lineNumber="648"><Highlight kind="comment">/// \\see Formula::BaseRegs.</Highlight></CodeLine>
<Link id="l00649" /><CodeLine lineNumber="649"><Highlight kind="comment">/// Every formula having more than one base register, must use the ScaledReg</Highlight></CodeLine>
<Link id="l00650" /><CodeLine lineNumber="650"><Highlight kind="comment">/// field. Otherwise, we would have to do special cases everywhere in LSR</Highlight></CodeLine>
<Link id="l00651" /><CodeLine lineNumber="651"><Highlight kind="comment">/// to treat reg1 + reg2 + ... the same way as reg1 + 1&#42;reg2 + ...</Highlight></CodeLine>
<Link id="l00652" /><CodeLine lineNumber="652"><Highlight kind="comment">/// On the other hand, 1&#42;reg should be canonicalized into reg.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00653" /><CodeLine lineNumber="653" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aef242a2293780c65ed1974184bc17193"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aef242a2293780c65ed1974184bc17193">Formula::canonicalize</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</Highlight></CodeLine>
<Link id="l00654" /><CodeLine lineNumber="654"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/ir/debuginfometadata-cpp/#a97d418be7ec7fc90283cc2fee34599ce">isCanonical</a>(L))</Highlight></CodeLine>
<Link id="l00655" /><CodeLine lineNumber="655"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00656" /><CodeLine lineNumber="656"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00657" /><CodeLine lineNumber="657"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty()) &#123;</Highlight></CodeLine>
<Link id="l00658" /><CodeLine lineNumber="658"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// No base reg? Use scale reg with scale = 1 as such.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00659" /><CodeLine lineNumber="659"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected 1&#42;reg =&gt; reg&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00660" /><CodeLine lineNumber="660"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> == 1 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected 1&#42;reg =&gt; reg&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00661" /><CodeLine lineNumber="661"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.push&#95;back(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>);</Highlight></CodeLine>
<Link id="l00662" /><CodeLine lineNumber="662"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> = 0;</Highlight></CodeLine>
<Link id="l00663" /><CodeLine lineNumber="663"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00664" /><CodeLine lineNumber="664"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00665" /><CodeLine lineNumber="665"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00666" /><CodeLine lineNumber="666"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00667" /><CodeLine lineNumber="667"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Keep the invariant sum in BaseRegs and one of the variant sum in ScaledReg.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00668" /><CodeLine lineNumber="668"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>) &#123;</Highlight></CodeLine>
<Link id="l00669" /><CodeLine lineNumber="669"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.pop&#95;back&#95;val();</Highlight></CodeLine>
<Link id="l00670" /><CodeLine lineNumber="670"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> = 1;</Highlight></CodeLine>
<Link id="l00671" /><CodeLine lineNumber="671"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00672" /><CodeLine lineNumber="672"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00673" /><CodeLine lineNumber="673"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If ScaledReg is an invariant with respect to L, find the reg from</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00674" /><CodeLine lineNumber="674"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// BaseRegs containing the recurrent expr related with Loop L. Swap the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00675" /><CodeLine lineNumber="675"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// reg with ScaledReg.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00676" /><CodeLine lineNumber="676"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>, L)) &#123;</Highlight></CodeLine>
<Link id="l00677" /><CodeLine lineNumber="677"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/#ac78c09ae232b2ce188ff590d51e3c268">find&#95;if</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>, &#91;&amp;L&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</Highlight></CodeLine>
<Link id="l00678" /><CodeLine lineNumber="678"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(S, L);</Highlight></CodeLine>
<Link id="l00679" /><CodeLine lineNumber="679"><Highlight kind="normal">    &#125;);</Highlight></CodeLine>
<Link id="l00680" /><CodeLine lineNumber="680"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.end())</Highlight></CodeLine>
<Link id="l00681" /><CodeLine lineNumber="681"><Highlight kind="normal">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>, &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l00682" /><CodeLine lineNumber="682"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00683" /><CodeLine lineNumber="683"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/ir/debuginfometadata-cpp/#a97d418be7ec7fc90283cc2fee34599ce">isCanonical</a>(L) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Failed to canonicalize?&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00684" /><CodeLine lineNumber="684"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00685" /><CodeLine lineNumber="685"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00686" /><CodeLine lineNumber="686"><Highlight kind="comment">/// Get rid of the scale in the formula.</Highlight></CodeLine>
<Link id="l00687" /><CodeLine lineNumber="687"><Highlight kind="comment">/// In other words, this method morphes reg1 + 1&#42;reg2 into reg1 + reg2.</Highlight></CodeLine>
<Link id="l00688" /><CodeLine lineNumber="688"><Highlight kind="comment">/// \\return true if it was possible to get rid of the scale, false otherwise.</Highlight></CodeLine>
<Link id="l00689" /><CodeLine lineNumber="689"><Highlight kind="comment">/// \\note After this operation the formula may not be in the canonical form.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00690" /><CodeLine lineNumber="690" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad02fff210996fa6f08b890aabf0f10ca"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad02fff210996fa6f08b890aabf0f10ca">Formula::unscale</a>() &#123;</Highlight></CodeLine>
<Link id="l00691" /><CodeLine lineNumber="691"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> != 1)</Highlight></CodeLine>
<Link id="l00692" /><CodeLine lineNumber="692"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00693" /><CodeLine lineNumber="693"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> = 0;</Highlight></CodeLine>
<Link id="l00694" /><CodeLine lineNumber="694"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.push&#95;back(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>);</Highlight></CodeLine>
<Link id="l00695" /><CodeLine lineNumber="695"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00696" /><CodeLine lineNumber="696"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00697" /><CodeLine lineNumber="697"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00698" /><CodeLine lineNumber="698"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00699" /><CodeLine lineNumber="699" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2fab594af348068066d23af810379fff"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2fab594af348068066d23af810379fff">Formula::hasZeroEnd</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00700" /><CodeLine lineNumber="700"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3">UnfoldedOffset</a> || <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152">BaseOffset</a>)</Highlight></CodeLine>
<Link id="l00701" /><CodeLine lineNumber="701"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00702" /><CodeLine lineNumber="702"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.size() != 1 || <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>)</Highlight></CodeLine>
<Link id="l00703" /><CodeLine lineNumber="703"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00704" /><CodeLine lineNumber="704"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00705" /><CodeLine lineNumber="705"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00706" /><CodeLine lineNumber="706"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00707" /><CodeLine lineNumber="707"><Highlight kind="comment">/// Return the total number of register operands used by this formula. This does</Highlight></CodeLine>
<Link id="l00708" /><CodeLine lineNumber="708"><Highlight kind="comment">/// not include register uses implied by non-constant addrec strides.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00709" /><CodeLine lineNumber="709" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a326e8d43b798acbc2b57c0ed8573b492"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a326e8d43b798acbc2b57c0ed8573b492">Formula::getNumRegs</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00710" /><CodeLine lineNumber="710"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> !!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> + <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.size();</Highlight></CodeLine>
<Link id="l00711" /><CodeLine lineNumber="711"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00712" /><CodeLine lineNumber="712"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00713" /><CodeLine lineNumber="713"><Highlight kind="comment">/// Return the type of this formula, if it has one, or null otherwise. This type</Highlight></CodeLine>
<Link id="l00714" /><CodeLine lineNumber="714"><Highlight kind="comment">/// is meaningless except for the bit size.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00715" /><CodeLine lineNumber="715" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2ee5737cd553c4eec111f7fbf9894f37"><Highlight kind="normal"><a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2ee5737cd553c4eec111f7fbf9894f37">Formula::getType</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00716" /><CodeLine lineNumber="716"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> !<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty() ? <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.front()-&gt;getType() :</Highlight></CodeLine>
<Link id="l00717" /><CodeLine lineNumber="717"><Highlight kind="normal">         <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> ? <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>-&gt;getType() :</Highlight></CodeLine>
<Link id="l00718" /><CodeLine lineNumber="718"><Highlight kind="normal">         <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a> ? <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a>-&gt;getType() :</Highlight></CodeLine>
<Link id="l00719" /><CodeLine lineNumber="719"><Highlight kind="normal">         </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00720" /><CodeLine lineNumber="720"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00721" /><CodeLine lineNumber="721"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00722" /><CodeLine lineNumber="722"><Highlight kind="comment">/// Delete the given base reg from the BaseRegs list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00723" /><CodeLine lineNumber="723" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a3ae8c31aeebb77960343a102ce36adcb"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a3ae8c31aeebb77960343a102ce36adcb">Formula::deleteBaseReg</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;S) &#123;</Highlight></CodeLine>
<Link id="l00724" /><CodeLine lineNumber="724"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (&amp;S != &amp;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.back())</Highlight></CodeLine>
<Link id="l00725" /><CodeLine lineNumber="725"><Highlight kind="normal">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(S, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.back());</Highlight></CodeLine>
<Link id="l00726" /><CodeLine lineNumber="726"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.pop&#95;back();</Highlight></CodeLine>
<Link id="l00727" /><CodeLine lineNumber="727"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00728" /><CodeLine lineNumber="728"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00729" /><CodeLine lineNumber="729"><Highlight kind="comment">/// Test if this formula references the given register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00730" /><CodeLine lineNumber="730" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7984ece4636cc86706ac5bdfefe3bc6d"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7984ece4636cc86706ac5bdfefe3bc6d">Formula::referencesReg</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00731" /><CodeLine lineNumber="731"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> S == <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> || <a href="/docs/api/namespaces/llvm/#acd1cd968cb420c82d70926920fcdc7d7">is&#95;contained</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>, S);</Highlight></CodeLine>
<Link id="l00732" /><CodeLine lineNumber="732"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00733" /><CodeLine lineNumber="733"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00734" /><CodeLine lineNumber="734"><Highlight kind="comment">/// Test whether this formula uses registers which are used by uses other than</Highlight></CodeLine>
<Link id="l00735" /><CodeLine lineNumber="735"><Highlight kind="comment">/// the use with the given index.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00736" /><CodeLine lineNumber="736" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a98e7bf1bb1d9378c9867e4168a7bfa89"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a98e7bf1bb1d9378c9867e4168a7bfa89">Formula::hasRegsUsedByUsesOtherThan</a>(</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l00737" /><CodeLine lineNumber="737"><Highlight kind="normal">                                         </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &amp;RegUses)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00738" /><CodeLine lineNumber="738"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>)</Highlight></CodeLine>
<Link id="l00739" /><CodeLine lineNumber="739"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RegUses.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8">isRegUsedByUsesOtherThan</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>, LUIdx))</Highlight></CodeLine>
<Link id="l00740" /><CodeLine lineNumber="740"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00741" /><CodeLine lineNumber="741"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>)</Highlight></CodeLine>
<Link id="l00742" /><CodeLine lineNumber="742"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RegUses.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8">isRegUsedByUsesOtherThan</a>(BaseReg, LUIdx))</Highlight></CodeLine>
<Link id="l00743" /><CodeLine lineNumber="743"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00744" /><CodeLine lineNumber="744"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00745" /><CodeLine lineNumber="745"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00746" /><CodeLine lineNumber="746"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00747" /><CodeLine lineNumber="747"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00748" /><CodeLine lineNumber="748" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ab6da05c123f7ca65ecc1163ebf739f01"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ab6da05c123f7ca65ecc1163ebf739f01">Formula::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00749" /><CodeLine lineNumber="749"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00750" /><CodeLine lineNumber="750"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a>) &#123;</Highlight></CodeLine>
<Link id="l00751" /><CodeLine lineNumber="751"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; + &quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00752" /><CodeLine lineNumber="752"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a>-&gt;printAsOperand(OS, </Highlight><Highlight kind="comment">/&#42;PrintType=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l00753" /><CodeLine lineNumber="753"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00754" /><CodeLine lineNumber="754"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152">BaseOffset</a>.isNonZero()) &#123;</Highlight></CodeLine>
<Link id="l00755" /><CodeLine lineNumber="755"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; + &quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00756" /><CodeLine lineNumber="756"><Highlight kind="normal">    OS &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152">BaseOffset</a>;</Highlight></CodeLine>
<Link id="l00757" /><CodeLine lineNumber="757"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00758" /><CodeLine lineNumber="758"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>) &#123;</Highlight></CodeLine>
<Link id="l00759" /><CodeLine lineNumber="759"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; + &quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00760" /><CodeLine lineNumber="760"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;reg(&quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;BaseReg &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;)&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00761" /><CodeLine lineNumber="761"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00762" /><CodeLine lineNumber="762"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> &amp;&amp; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty()) &#123;</Highlight></CodeLine>
<Link id="l00763" /><CodeLine lineNumber="763"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; + &quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00764" /><CodeLine lineNumber="764"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;&#42;&#42;error: HasBaseReg&#42;&#42;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00765" /><CodeLine lineNumber="765"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> &amp;&amp; !<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty()) &#123;</Highlight></CodeLine>
<Link id="l00766" /><CodeLine lineNumber="766"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; + &quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00767" /><CodeLine lineNumber="767"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;&#42;&#42;error: !HasBaseReg&#42;&#42;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00768" /><CodeLine lineNumber="768"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00769" /><CodeLine lineNumber="769"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> != 0) &#123;</Highlight></CodeLine>
<Link id="l00770" /><CodeLine lineNumber="770"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; + &quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00771" /><CodeLine lineNumber="771"><Highlight kind="normal">    OS &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;&#42;reg(&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00772" /><CodeLine lineNumber="772"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>)</Highlight></CodeLine>
<Link id="l00773" /><CodeLine lineNumber="773"><Highlight kind="normal">      OS &lt;&lt; &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>;</Highlight></CodeLine>
<Link id="l00774" /><CodeLine lineNumber="774"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00775" /><CodeLine lineNumber="775"><Highlight kind="normal">      OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;&lt;unknown&gt;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00776" /><CodeLine lineNumber="776"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;)&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00777" /><CodeLine lineNumber="777"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00778" /><CodeLine lineNumber="778"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3">UnfoldedOffset</a>.isNonZero()) &#123;</Highlight></CodeLine>
<Link id="l00779" /><CodeLine lineNumber="779"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; + &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00780" /><CodeLine lineNumber="780"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;imm(&quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3">UnfoldedOffset</a> &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;)&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00781" /><CodeLine lineNumber="781"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00782" /><CodeLine lineNumber="782"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00783" /><CodeLine lineNumber="783"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00784" /><CodeLine lineNumber="784" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a376acc2ec7fd1a216d5ec9fb9f04c99a"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a376acc2ec7fd1a216d5ec9fb9f04c99a">Formula::dump</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l00785" /><CodeLine lineNumber="785"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00786" /><CodeLine lineNumber="786"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00787" /><CodeLine lineNumber="787"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00788" /><CodeLine lineNumber="788"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00789" /><CodeLine lineNumber="789"><Highlight kind="comment">/// Return true if the given addrec can be sign-extended without changing its</Highlight></CodeLine>
<Link id="l00790" /><CodeLine lineNumber="790"><Highlight kind="comment">/// value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00791" /><CodeLine lineNumber="791" lineLink="#a9b6b892760677b9b11c517eb5a46557f"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a9b6b892760677b9b11c517eb5a46557f">isAddRecSExtable</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l00792" /><CodeLine lineNumber="792"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;WideTy =</Highlight></CodeLine>
<Link id="l00793" /><CodeLine lineNumber="793"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#aff9e533399d91febd63fa4bfe82a42a7">getContext</a>(), SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>()) + 1);</Highlight></CodeLine>
<Link id="l00794" /><CodeLine lineNumber="794"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(AR, WideTy));</Highlight></CodeLine>
<Link id="l00795" /><CodeLine lineNumber="795"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00796" /><CodeLine lineNumber="796"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00797" /><CodeLine lineNumber="797"><Highlight kind="comment">/// Return true if the given add can be sign-extended without changing its</Highlight></CodeLine>
<Link id="l00798" /><CodeLine lineNumber="798"><Highlight kind="comment">/// value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00799" /><CodeLine lineNumber="799" lineLink="#a1509f8a0c11e955037b00ce7542e24a7"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a1509f8a0c11e955037b00ce7542e24a7">isAddSExtable</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l00800" /><CodeLine lineNumber="800"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;WideTy =</Highlight></CodeLine>
<Link id="l00801" /><CodeLine lineNumber="801"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#aff9e533399d91febd63fa4bfe82a42a7">getContext</a>(), SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getType()) + 1);</Highlight></CodeLine>
<Link id="l00802" /><CodeLine lineNumber="802"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, WideTy));</Highlight></CodeLine>
<Link id="l00803" /><CodeLine lineNumber="803"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00804" /><CodeLine lineNumber="804"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00805" /><CodeLine lineNumber="805"><Highlight kind="comment">/// Return true if the given mul can be sign-extended without changing its</Highlight></CodeLine>
<Link id="l00806" /><CodeLine lineNumber="806"><Highlight kind="comment">/// value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00807" /><CodeLine lineNumber="807" lineLink="#a32cdb4a97c185f1acbe11f45fcc70d12"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a32cdb4a97c185f1acbe11f45fcc70d12">isMulSExtable</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;M, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l00808" /><CodeLine lineNumber="808"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;WideTy =</Highlight></CodeLine>
<Link id="l00809" /><CodeLine lineNumber="809"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#aff9e533399d91febd63fa4bfe82a42a7">getContext</a>(),</Highlight></CodeLine>
<Link id="l00810" /><CodeLine lineNumber="810"><Highlight kind="normal">                     SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(M-&gt;getType()) &#42; M-&gt;getNumOperands());</Highlight></CodeLine>
<Link id="l00811" /><CodeLine lineNumber="811"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVMulExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(M, WideTy));</Highlight></CodeLine>
<Link id="l00812" /><CodeLine lineNumber="812"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00813" /><CodeLine lineNumber="813"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00814" /><CodeLine lineNumber="814"><Highlight kind="comment">/// Return an expression for LHS /s RHS, if it can be determined and if the</Highlight></CodeLine>
<Link id="l00815" /><CodeLine lineNumber="815"><Highlight kind="comment">/// remainder is known to be zero, or null otherwise. If IgnoreSignificantBits</Highlight></CodeLine>
<Link id="l00816" /><CodeLine lineNumber="816"><Highlight kind="comment">/// is true, expressions like (X &#42; Y) /s Y are simplified to X, ignoring that</Highlight></CodeLine>
<Link id="l00817" /><CodeLine lineNumber="817"><Highlight kind="comment">/// the multiplication may overflow, which is useful when the result will be</Highlight></CodeLine>
<Link id="l00818" /><CodeLine lineNumber="818"><Highlight kind="comment">/// used in a context where the most significant bits are ignored.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00819" /><CodeLine lineNumber="819" lineLink="#ad0ad0c0f486f8ea43158a1227e610a9c"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</Highlight></CodeLine>
<Link id="l00820" /><CodeLine lineNumber="820"><Highlight kind="normal">                                <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</Highlight></CodeLine>
<Link id="l00821" /><CodeLine lineNumber="821"><Highlight kind="normal">                                </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IgnoreSignificantBits = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l00822" /><CodeLine lineNumber="822"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Handle the trivial case, which works for any SCEV type.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00823" /><CodeLine lineNumber="823"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> == <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)</Highlight></CodeLine>
<Link id="l00824" /><CodeLine lineNumber="824"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;getType(), 1);</Highlight></CodeLine>
<Link id="l00825" /><CodeLine lineNumber="825"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00826" /><CodeLine lineNumber="826"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Handle a few RHS special cases.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00827" /><CodeLine lineNumber="827"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;RC = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</Highlight></CodeLine>
<Link id="l00828" /><CodeLine lineNumber="828"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RC) &#123;</Highlight></CodeLine>
<Link id="l00829" /><CodeLine lineNumber="829"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/apint">APInt</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a> = RC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a6caf7f3a0a4303e4c0bc06ed8e205126">getAPInt</a>();</Highlight></CodeLine>
<Link id="l00830" /><CodeLine lineNumber="830"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Handle x /s -1 as x &#42; -1, to give ScalarEvolution a chance to do</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00831" /><CodeLine lineNumber="831"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// some folding.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00832" /><CodeLine lineNumber="832"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a>.isAllOnes()) &#123;</Highlight></CodeLine>
<Link id="l00833" /><CodeLine lineNumber="833"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;getType()-&gt;isPointerTy())</Highlight></CodeLine>
<Link id="l00834" /><CodeLine lineNumber="834"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00835" /><CodeLine lineNumber="835"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, RC);</Highlight></CodeLine>
<Link id="l00836" /><CodeLine lineNumber="836"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00837" /><CodeLine lineNumber="837"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Handle x /s 1 as x.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00838" /><CodeLine lineNumber="838"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a> == 1)</Highlight></CodeLine>
<Link id="l00839" /><CodeLine lineNumber="839"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>;</Highlight></CodeLine>
<Link id="l00840" /><CodeLine lineNumber="840"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00841" /><CodeLine lineNumber="841"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00842" /><CodeLine lineNumber="842"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check for a division of a constant by a constant.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00843" /><CodeLine lineNumber="843"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) &#123;</Highlight></CodeLine>
<Link id="l00844" /><CodeLine lineNumber="844"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!RC)</Highlight></CodeLine>
<Link id="l00845" /><CodeLine lineNumber="845"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00846" /><CodeLine lineNumber="846"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/apint">APInt</a> &amp;LA = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt();</Highlight></CodeLine>
<Link id="l00847" /><CodeLine lineNumber="847"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/apint">APInt</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a> = RC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a6caf7f3a0a4303e4c0bc06ed8e205126">getAPInt</a>();</Highlight></CodeLine>
<Link id="l00848" /><CodeLine lineNumber="848"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LA.<a href="/docs/api/classes/llvm/apint/#ac131d830427393332e440e1d6e3013b6">srem</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a>) != 0)</Highlight></CodeLine>
<Link id="l00849" /><CodeLine lineNumber="849"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00850" /><CodeLine lineNumber="850"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(LA.<a href="/docs/api/classes/llvm/apint/#a71f7f6e3a4774296efc7274196a74793">sdiv</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a>));</Highlight></CodeLine>
<Link id="l00851" /><CodeLine lineNumber="851"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00852" /><CodeLine lineNumber="852"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00853" /><CodeLine lineNumber="853"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Distribute the sdiv over addrec operands, if the addrec doesn&#39;t overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00854" /><CodeLine lineNumber="854"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) &#123;</Highlight></CodeLine>
<Link id="l00855" /><CodeLine lineNumber="855"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((IgnoreSignificantBits || <a href="#a9b6b892760677b9b11c517eb5a46557f">isAddRecSExtable</a>(AR, SE)) &amp;&amp; AR-&gt;isAffine()) &#123;</Highlight></CodeLine>
<Link id="l00856" /><CodeLine lineNumber="856"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Step = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(AR-&gt;getStepRecurrence(SE), <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, SE,</Highlight></CodeLine>
<Link id="l00857" /><CodeLine lineNumber="857"><Highlight kind="normal">                                      IgnoreSignificantBits);</Highlight></CodeLine>
<Link id="l00858" /><CodeLine lineNumber="858"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Step) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00859" /><CodeLine lineNumber="859"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Start = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(AR-&gt;getStart(), <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, SE,</Highlight></CodeLine>
<Link id="l00860" /><CodeLine lineNumber="860"><Highlight kind="normal">                                       IgnoreSignificantBits);</Highlight></CodeLine>
<Link id="l00861" /><CodeLine lineNumber="861"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Start) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00862" /><CodeLine lineNumber="862"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// FlagNW is independent of the start value, step direction, and is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00863" /><CodeLine lineNumber="863"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// preserved with smaller magnitude steps.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00864" /><CodeLine lineNumber="864"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// FIXME: AR-&gt;getNoWrapFlags(SCEV::FlagNW)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00865" /><CodeLine lineNumber="865"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(Start, Step, AR-&gt;getLoop(), <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>);</Highlight></CodeLine>
<Link id="l00866" /><CodeLine lineNumber="866"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00867" /><CodeLine lineNumber="867"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00868" /><CodeLine lineNumber="868"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00869" /><CodeLine lineNumber="869"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00870" /><CodeLine lineNumber="870"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Distribute the sdiv over add operands, if the add doesn&#39;t overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00871" /><CodeLine lineNumber="871"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) &#123;</Highlight></CodeLine>
<Link id="l00872" /><CodeLine lineNumber="872"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IgnoreSignificantBits || <a href="#a1509f8a0c11e955037b00ce7542e24a7">isAddSExtable</a>(<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>, SE)) &#123;</Highlight></CodeLine>
<Link id="l00873" /><CodeLine lineNumber="873"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</Highlight></CodeLine>
<Link id="l00874" /><CodeLine lineNumber="874"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands()) &#123;</Highlight></CodeLine>
<Link id="l00875" /><CodeLine lineNumber="875"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(S, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, SE, IgnoreSignificantBits);</Highlight></CodeLine>
<Link id="l00876" /><CodeLine lineNumber="876"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00877" /><CodeLine lineNumber="877"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</Highlight></CodeLine>
<Link id="l00878" /><CodeLine lineNumber="878"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l00879" /><CodeLine lineNumber="879"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>);</Highlight></CodeLine>
<Link id="l00880" /><CodeLine lineNumber="880"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00881" /><CodeLine lineNumber="881"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00882" /><CodeLine lineNumber="882"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00883" /><CodeLine lineNumber="883"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00884" /><CodeLine lineNumber="884"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check for a multiply operand that we can pull RHS out of.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00885" /><CodeLine lineNumber="885"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) &#123;</Highlight></CodeLine>
<Link id="l00886" /><CodeLine lineNumber="886"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IgnoreSignificantBits || <a href="#a32cdb4a97c185f1acbe11f45fcc70d12">isMulSExtable</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>, SE)) &#123;</Highlight></CodeLine>
<Link id="l00887" /><CodeLine lineNumber="887"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Handle special case C1&#42;X&#42;Y /s C2&#42;X&#42;Y.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00888" /><CodeLine lineNumber="888"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;MulRHS = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)) &#123;</Highlight></CodeLine>
<Link id="l00889" /><CodeLine lineNumber="889"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IgnoreSignificantBits || <a href="#a32cdb4a97c185f1acbe11f45fcc70d12">isMulSExtable</a>(MulRHS, SE)) &#123;</Highlight></CodeLine>
<Link id="l00890" /><CodeLine lineNumber="890"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;LC = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(0));</Highlight></CodeLine>
<Link id="l00891" /><CodeLine lineNumber="891"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;RC =</Highlight></CodeLine>
<Link id="l00892" /><CodeLine lineNumber="892"><Highlight kind="normal">              <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(MulRHS-&gt;getOperand(0));</Highlight></CodeLine>
<Link id="l00893" /><CodeLine lineNumber="893"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LC &amp;&amp; RC) &#123;</Highlight></CodeLine>
<Link id="l00894" /><CodeLine lineNumber="894"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> LOps(<a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">drop&#95;begin</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;operands()));</Highlight></CodeLine>
<Link id="l00895" /><CodeLine lineNumber="895"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> ROps(<a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">drop&#95;begin</a>(MulRHS-&gt;operands()));</Highlight></CodeLine>
<Link id="l00896" /><CodeLine lineNumber="896"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LOps == ROps)</Highlight></CodeLine>
<Link id="l00897" /><CodeLine lineNumber="897"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(LC, RC, SE, IgnoreSignificantBits);</Highlight></CodeLine>
<Link id="l00898" /><CodeLine lineNumber="898"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l00899" /><CodeLine lineNumber="899"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l00900" /><CodeLine lineNumber="900"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l00901" /><CodeLine lineNumber="901"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00902" /><CodeLine lineNumber="902"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</Highlight></CodeLine>
<Link id="l00903" /><CodeLine lineNumber="903"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Found = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00904" /><CodeLine lineNumber="904"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;operands()) &#123;</Highlight></CodeLine>
<Link id="l00905" /><CodeLine lineNumber="905"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Found)</Highlight></CodeLine>
<Link id="l00906" /><CodeLine lineNumber="906"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Q = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(S, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, SE,</Highlight></CodeLine>
<Link id="l00907" /><CodeLine lineNumber="907"><Highlight kind="normal">                                           IgnoreSignificantBits)) &#123;</Highlight></CodeLine>
<Link id="l00908" /><CodeLine lineNumber="908"><Highlight kind="normal">            S = Q;</Highlight></CodeLine>
<Link id="l00909" /><CodeLine lineNumber="909"><Highlight kind="normal">            Found = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00910" /><CodeLine lineNumber="910"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l00911" /><CodeLine lineNumber="911"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(S);</Highlight></CodeLine>
<Link id="l00912" /><CodeLine lineNumber="912"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l00913" /><CodeLine lineNumber="913"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Found ? SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) : </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00914" /><CodeLine lineNumber="914"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00915" /><CodeLine lineNumber="915"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00916" /><CodeLine lineNumber="916"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00917" /><CodeLine lineNumber="917"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00918" /><CodeLine lineNumber="918"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Otherwise we don&#39;t know.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00919" /><CodeLine lineNumber="919"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00920" /><CodeLine lineNumber="920"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00921" /><CodeLine lineNumber="921"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00922" /><CodeLine lineNumber="922"><Highlight kind="comment">/// If S involves the addition of a constant integer value, return that integer</Highlight></CodeLine>
<Link id="l00923" /><CodeLine lineNumber="923"><Highlight kind="comment">/// value, and mutate S to point to a new SCEV with that value excluded.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00924" /><CodeLine lineNumber="924" lineLink="#a1a0afc5106fca20f0a81eac37db70ab9"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a> <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;S, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l00925" /><CodeLine lineNumber="925"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l00926" /><CodeLine lineNumber="926"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSignificantBits() &lt;= 64) &#123;</Highlight></CodeLine>
<Link id="l00927" /><CodeLine lineNumber="927"><Highlight kind="normal">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getType(), 0);</Highlight></CodeLine>
<Link id="l00928" /><CodeLine lineNumber="928"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue()-&gt;getSExtValue());</Highlight></CodeLine>
<Link id="l00929" /><CodeLine lineNumber="929"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00930" /><CodeLine lineNumber="930"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l00931" /><CodeLine lineNumber="931"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> NewOps(<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands());</Highlight></CodeLine>
<Link id="l00932" /><CodeLine lineNumber="932"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a> Result = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(NewOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>(), SE);</Highlight></CodeLine>
<Link id="l00933" /><CodeLine lineNumber="933"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Result.isNonZero())</Highlight></CodeLine>
<Link id="l00934" /><CodeLine lineNumber="934"><Highlight kind="normal">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(NewOps);</Highlight></CodeLine>
<Link id="l00935" /><CodeLine lineNumber="935"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Result;</Highlight></CodeLine>
<Link id="l00936" /><CodeLine lineNumber="936"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l00937" /><CodeLine lineNumber="937"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> NewOps(AR-&gt;operands());</Highlight></CodeLine>
<Link id="l00938" /><CodeLine lineNumber="938"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a> Result = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(NewOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>(), SE);</Highlight></CodeLine>
<Link id="l00939" /><CodeLine lineNumber="939"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Result.isNonZero())</Highlight></CodeLine>
<Link id="l00940" /><CodeLine lineNumber="940"><Highlight kind="normal">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(NewOps, AR-&gt;getLoop(),</Highlight></CodeLine>
<Link id="l00941" /><CodeLine lineNumber="941"><Highlight kind="normal">                           </Highlight><Highlight kind="comment">// FIXME: AR-&gt;getNoWrapFlags(SCEV::FlagNW)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00942" /><CodeLine lineNumber="942"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>);</Highlight></CodeLine>
<Link id="l00943" /><CodeLine lineNumber="943"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Result;</Highlight></CodeLine>
<Link id="l00944" /><CodeLine lineNumber="944"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;M = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l00945" /><CodeLine lineNumber="945"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a5ca5d2aa868eb59998bc43f224fec74f">EnableVScaleImmediates</a> &amp;&amp; M-&gt;getNumOperands() == 2) &#123;</Highlight></CodeLine>
<Link id="l00946" /><CodeLine lineNumber="946"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(M-&gt;getOperand(0)))</Highlight></CodeLine>
<Link id="l00947" /><CodeLine lineNumber="947"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVVScale&gt;</a>(M-&gt;getOperand(1))) &#123;</Highlight></CodeLine>
<Link id="l00948" /><CodeLine lineNumber="948"><Highlight kind="normal">          S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(M-&gt;getType(), 0);</Highlight></CodeLine>
<Link id="l00949" /><CodeLine lineNumber="949"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ac7030e0a5d4b154f205b3d85dde0644b">Immediate::getScalable</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue()-&gt;getSExtValue());</Highlight></CodeLine>
<Link id="l00950" /><CodeLine lineNumber="950"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l00951" /><CodeLine lineNumber="951"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00952" /><CodeLine lineNumber="952"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00953" /><CodeLine lineNumber="953"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</Highlight></CodeLine>
<Link id="l00954" /><CodeLine lineNumber="954"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00955" /><CodeLine lineNumber="955"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00956" /><CodeLine lineNumber="956"><Highlight kind="comment">/// If S involves the addition of a GlobalValue address, return that symbol, and</Highlight></CodeLine>
<Link id="l00957" /><CodeLine lineNumber="957"><Highlight kind="comment">/// mutate S to point to a new SCEV with that value excluded.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00958" /><CodeLine lineNumber="958" lineLink="#a45b1664e25bf2a7220367462f2580044"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;<a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;S, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l00959" /><CodeLine lineNumber="959"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l00960" /><CodeLine lineNumber="960"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;GV = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;GlobalValue&gt;</a>(U-&gt;getValue())) &#123;</Highlight></CodeLine>
<Link id="l00961" /><CodeLine lineNumber="961"><Highlight kind="normal">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(GV-&gt;getType(), 0);</Highlight></CodeLine>
<Link id="l00962" /><CodeLine lineNumber="962"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> GV;</Highlight></CodeLine>
<Link id="l00963" /><CodeLine lineNumber="963"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l00964" /><CodeLine lineNumber="964"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l00965" /><CodeLine lineNumber="965"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> NewOps(<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands());</Highlight></CodeLine>
<Link id="l00966" /><CodeLine lineNumber="966"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;Result = <a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(NewOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>(), SE);</Highlight></CodeLine>
<Link id="l00967" /><CodeLine lineNumber="967"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Result)</Highlight></CodeLine>
<Link id="l00968" /><CodeLine lineNumber="968"><Highlight kind="normal">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(NewOps);</Highlight></CodeLine>
<Link id="l00969" /><CodeLine lineNumber="969"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Result;</Highlight></CodeLine>
<Link id="l00970" /><CodeLine lineNumber="970"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l00971" /><CodeLine lineNumber="971"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> NewOps(AR-&gt;operands());</Highlight></CodeLine>
<Link id="l00972" /><CodeLine lineNumber="972"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;Result = <a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(NewOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>(), SE);</Highlight></CodeLine>
<Link id="l00973" /><CodeLine lineNumber="973"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Result)</Highlight></CodeLine>
<Link id="l00974" /><CodeLine lineNumber="974"><Highlight kind="normal">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(NewOps, AR-&gt;getLoop(),</Highlight></CodeLine>
<Link id="l00975" /><CodeLine lineNumber="975"><Highlight kind="normal">                           </Highlight><Highlight kind="comment">// FIXME: AR-&gt;getNoWrapFlags(SCEV::FlagNW)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00976" /><CodeLine lineNumber="976"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>);</Highlight></CodeLine>
<Link id="l00977" /><CodeLine lineNumber="977"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Result;</Highlight></CodeLine>
<Link id="l00978" /><CodeLine lineNumber="978"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l00979" /><CodeLine lineNumber="979"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00980" /><CodeLine lineNumber="980"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l00981" /><CodeLine lineNumber="981"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l00982" /><CodeLine lineNumber="982"><Highlight kind="comment">/// Returns true if the specified instruction is using the specified value as an</Highlight></CodeLine>
<Link id="l00983" /><CodeLine lineNumber="983"><Highlight kind="comment">/// address.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00984" /><CodeLine lineNumber="984" lineLink="#a4120d81bd505176f5cadf647f5b8c7ef"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l00985" /><CodeLine lineNumber="985"><Highlight kind="normal">                         <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst, <a href="/docs/api/classes/llvm/value">Value</a> &#42;OperandVal) &#123;</Highlight></CodeLine>
<Link id="l00986" /><CodeLine lineNumber="986"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> isAddress = <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;LoadInst&gt;</a>(Inst);</Highlight></CodeLine>
<Link id="l00987" /><CodeLine lineNumber="987"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/storeinst">StoreInst</a> &#42;<a href="/docs/api/namespaces/llvm/si">SI</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StoreInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l00988" /><CodeLine lineNumber="988"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/si">SI</a>-&gt;getPointerOperand() == OperandVal)</Highlight></CodeLine>
<Link id="l00989" /><CodeLine lineNumber="989"><Highlight kind="normal">      isAddress = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00990" /><CodeLine lineNumber="990"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/intrinsicinst">IntrinsicInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;IntrinsicInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l00991" /><CodeLine lineNumber="991"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Addressing modes can also be folded into prefetches and a variety</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00992" /><CodeLine lineNumber="992"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// of intrinsics.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l00993" /><CodeLine lineNumber="993"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getIntrinsicID()) &#123;</Highlight></CodeLine>
<Link id="l00994" /><CodeLine lineNumber="994"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::memset:</Highlight></CodeLine>
<Link id="l00995" /><CodeLine lineNumber="995"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::prefetch:</Highlight></CodeLine>
<Link id="l00996" /><CodeLine lineNumber="996"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::masked&#95;load:</Highlight></CodeLine>
<Link id="l00997" /><CodeLine lineNumber="997"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(0) == OperandVal)</Highlight></CodeLine>
<Link id="l00998" /><CodeLine lineNumber="998"><Highlight kind="normal">        isAddress = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l00999" /><CodeLine lineNumber="999"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01000" /><CodeLine lineNumber="1000"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::masked&#95;store:</Highlight></CodeLine>
<Link id="l01001" /><CodeLine lineNumber="1001"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(1) == OperandVal)</Highlight></CodeLine>
<Link id="l01002" /><CodeLine lineNumber="1002"><Highlight kind="normal">        isAddress = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01003" /><CodeLine lineNumber="1003"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01004" /><CodeLine lineNumber="1004"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::memmove:</Highlight></CodeLine>
<Link id="l01005" /><CodeLine lineNumber="1005"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::memcpy:</Highlight></CodeLine>
<Link id="l01006" /><CodeLine lineNumber="1006"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(0) == OperandVal ||</Highlight></CodeLine>
<Link id="l01007" /><CodeLine lineNumber="1007"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(1) == OperandVal)</Highlight></CodeLine>
<Link id="l01008" /><CodeLine lineNumber="1008"><Highlight kind="normal">        isAddress = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01009" /><CodeLine lineNumber="1009"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01010" /><CodeLine lineNumber="1010"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">: &#123;</Highlight></CodeLine>
<Link id="l01011" /><CodeLine lineNumber="1011"><Highlight kind="normal">      <a href="/docs/api/structs/llvm/memintrinsicinfo">MemIntrinsicInfo</a> IntrInfo;</Highlight></CodeLine>
<Link id="l01012" /><CodeLine lineNumber="1012"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.getTgtMemIntrinsic(<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>, IntrInfo)) &#123;</Highlight></CodeLine>
<Link id="l01013" /><CodeLine lineNumber="1013"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IntrInfo.<a href="/docs/api/structs/llvm/memintrinsicinfo/#a96d9e7ee9af6f300d2544d8f7b97c234">PtrVal</a> == OperandVal)</Highlight></CodeLine>
<Link id="l01014" /><CodeLine lineNumber="1014"><Highlight kind="normal">          isAddress = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01015" /><CodeLine lineNumber="1015"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l01016" /><CodeLine lineNumber="1016"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01017" /><CodeLine lineNumber="1017"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01018" /><CodeLine lineNumber="1018"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/atomicrmwinst">AtomicRMWInst</a> &#42;RMW = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AtomicRMWInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l01019" /><CodeLine lineNumber="1019"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RMW-&gt;getPointerOperand() == OperandVal)</Highlight></CodeLine>
<Link id="l01020" /><CodeLine lineNumber="1020"><Highlight kind="normal">      isAddress = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01021" /><CodeLine lineNumber="1021"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/atomiccmpxchginst">AtomicCmpXchgInst</a> &#42;CmpX = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AtomicCmpXchgInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l01022" /><CodeLine lineNumber="1022"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CmpX-&gt;getPointerOperand() == OperandVal)</Highlight></CodeLine>
<Link id="l01023" /><CodeLine lineNumber="1023"><Highlight kind="normal">      isAddress = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01024" /><CodeLine lineNumber="1024"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01025" /><CodeLine lineNumber="1025"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> isAddress;</Highlight></CodeLine>
<Link id="l01026" /><CodeLine lineNumber="1026"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01027" /><CodeLine lineNumber="1027"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01028" /><CodeLine lineNumber="1028"><Highlight kind="comment">/// Return the type of the memory being accessed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01029" /><CodeLine lineNumber="1029" lineLink="#a7f4680b383ce7138bc2c12de282b14b4"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> <a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01030" /><CodeLine lineNumber="1030"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst, <a href="/docs/api/classes/llvm/value">Value</a> &#42;OperandVal) &#123;</Highlight></CodeLine>
<Link id="l01031" /><CodeLine lineNumber="1031"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> AccessTy = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a153bbcee36817bcedb110f30d95b2368">MemAccessTy::getUnknown</a>(Inst-&gt;<a href="/docs/api/classes/llvm/value/#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</Highlight></CodeLine>
<Link id="l01032" /><CodeLine lineNumber="1032"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01033" /><CodeLine lineNumber="1033"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// First get the type of memory being accessed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01034" /><CodeLine lineNumber="1034"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty = Inst-&gt;<a href="/docs/api/classes/llvm/instruction/#a765d7abba7daa905e301027dd2fd1086">getAccessType</a>())</Highlight></CodeLine>
<Link id="l01035" /><CodeLine lineNumber="1035"><Highlight kind="normal">    AccessTy.MemTy = Ty;</Highlight></CodeLine>
<Link id="l01036" /><CodeLine lineNumber="1036"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01037" /><CodeLine lineNumber="1037"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Then get the pointer address space.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01038" /><CodeLine lineNumber="1038"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/storeinst">StoreInst</a> &#42;<a href="/docs/api/namespaces/llvm/si">SI</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StoreInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l01039" /><CodeLine lineNumber="1039"><Highlight kind="normal">    AccessTy.AddrSpace = <a href="/docs/api/namespaces/llvm/si">SI</a>-&gt;getPointerAddressSpace();</Highlight></CodeLine>
<Link id="l01040" /><CodeLine lineNumber="1040"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loadinst">LoadInst</a> &#42;LI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;LoadInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l01041" /><CodeLine lineNumber="1041"><Highlight kind="normal">    AccessTy.AddrSpace = LI-&gt;getPointerAddressSpace();</Highlight></CodeLine>
<Link id="l01042" /><CodeLine lineNumber="1042"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomicrmwinst">AtomicRMWInst</a> &#42;RMW = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AtomicRMWInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l01043" /><CodeLine lineNumber="1043"><Highlight kind="normal">    AccessTy.AddrSpace = RMW-&gt;getPointerAddressSpace();</Highlight></CodeLine>
<Link id="l01044" /><CodeLine lineNumber="1044"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/atomiccmpxchginst">AtomicCmpXchgInst</a> &#42;CmpX = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AtomicCmpXchgInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l01045" /><CodeLine lineNumber="1045"><Highlight kind="normal">    AccessTy.AddrSpace = CmpX-&gt;getPointerAddressSpace();</Highlight></CodeLine>
<Link id="l01046" /><CodeLine lineNumber="1046"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/intrinsicinst">IntrinsicInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;IntrinsicInst&gt;</a>(Inst)) &#123;</Highlight></CodeLine>
<Link id="l01047" /><CodeLine lineNumber="1047"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getIntrinsicID()) &#123;</Highlight></CodeLine>
<Link id="l01048" /><CodeLine lineNumber="1048"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::prefetch:</Highlight></CodeLine>
<Link id="l01049" /><CodeLine lineNumber="1049"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::memset:</Highlight></CodeLine>
<Link id="l01050" /><CodeLine lineNumber="1050"><Highlight kind="normal">      AccessTy.AddrSpace = <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(0)-&gt;getType()-&gt;getPointerAddressSpace();</Highlight></CodeLine>
<Link id="l01051" /><CodeLine lineNumber="1051"><Highlight kind="normal">      AccessTy.MemTy = OperandVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l01052" /><CodeLine lineNumber="1052"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01053" /><CodeLine lineNumber="1053"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::memmove:</Highlight></CodeLine>
<Link id="l01054" /><CodeLine lineNumber="1054"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::memcpy:</Highlight></CodeLine>
<Link id="l01055" /><CodeLine lineNumber="1055"><Highlight kind="normal">      AccessTy.AddrSpace = OperandVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</Highlight></CodeLine>
<Link id="l01056" /><CodeLine lineNumber="1056"><Highlight kind="normal">      AccessTy.MemTy = OperandVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l01057" /><CodeLine lineNumber="1057"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01058" /><CodeLine lineNumber="1058"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::masked&#95;load:</Highlight></CodeLine>
<Link id="l01059" /><CodeLine lineNumber="1059"><Highlight kind="normal">      AccessTy.AddrSpace =</Highlight></CodeLine>
<Link id="l01060" /><CodeLine lineNumber="1060"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(0)-&gt;getType()-&gt;getPointerAddressSpace();</Highlight></CodeLine>
<Link id="l01061" /><CodeLine lineNumber="1061"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01062" /><CodeLine lineNumber="1062"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Intrinsic::masked&#95;store:</Highlight></CodeLine>
<Link id="l01063" /><CodeLine lineNumber="1063"><Highlight kind="normal">      AccessTy.AddrSpace =</Highlight></CodeLine>
<Link id="l01064" /><CodeLine lineNumber="1064"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(1)-&gt;getType()-&gt;getPointerAddressSpace();</Highlight></CodeLine>
<Link id="l01065" /><CodeLine lineNumber="1065"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01066" /><CodeLine lineNumber="1066"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">: &#123;</Highlight></CodeLine>
<Link id="l01067" /><CodeLine lineNumber="1067"><Highlight kind="normal">      <a href="/docs/api/structs/llvm/memintrinsicinfo">MemIntrinsicInfo</a> IntrInfo;</Highlight></CodeLine>
<Link id="l01068" /><CodeLine lineNumber="1068"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.getTgtMemIntrinsic(<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>, IntrInfo) &amp;&amp; IntrInfo.<a href="/docs/api/structs/llvm/memintrinsicinfo/#a96d9e7ee9af6f300d2544d8f7b97c234">PtrVal</a>) &#123;</Highlight></CodeLine>
<Link id="l01069" /><CodeLine lineNumber="1069"><Highlight kind="normal">        AccessTy.AddrSpace</Highlight></CodeLine>
<Link id="l01070" /><CodeLine lineNumber="1070"><Highlight kind="normal">          = IntrInfo.<a href="/docs/api/structs/llvm/memintrinsicinfo/#a96d9e7ee9af6f300d2544d8f7b97c234">PtrVal</a>-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</Highlight></CodeLine>
<Link id="l01071" /><CodeLine lineNumber="1071"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l01072" /><CodeLine lineNumber="1072"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01073" /><CodeLine lineNumber="1073"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01074" /><CodeLine lineNumber="1074"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01075" /><CodeLine lineNumber="1075"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01076" /><CodeLine lineNumber="1076"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01077" /><CodeLine lineNumber="1077"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01078" /><CodeLine lineNumber="1078"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> AccessTy;</Highlight></CodeLine>
<Link id="l01079" /><CodeLine lineNumber="1079"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01080" /><CodeLine lineNumber="1080"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01081" /><CodeLine lineNumber="1081"><Highlight kind="comment">/// Return true if this AddRec is already a phi in its loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01082" /><CodeLine lineNumber="1082" lineLink="#a3c81223cabf643af27adba3b3ceb680c"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a3c81223cabf643af27adba3b3ceb680c">isExistingPhi</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l01083" /><CodeLine lineNumber="1083"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;PN : AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>()-&gt;<a href="/docs/api/classes/llvm/loopbase/#a4a75755081e9a3803d2f4ccf6f0cb1f8">getHeader</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a13da92d2694197fbcb5b95fd94e7570d">phis</a>()) &#123;</Highlight></CodeLine>
<Link id="l01084" /><CodeLine lineNumber="1084"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(PN.getType()) &amp;&amp;</Highlight></CodeLine>
<Link id="l01085" /><CodeLine lineNumber="1085"><Highlight kind="normal">        (SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6dcfa69ce27cf214caaf50f21bfe1f2f">getEffectiveSCEVType</a>(PN.getType()) ==</Highlight></CodeLine>
<Link id="l01086" /><CodeLine lineNumber="1086"><Highlight kind="normal">         SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6dcfa69ce27cf214caaf50f21bfe1f2f">getEffectiveSCEVType</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>())) &amp;&amp;</Highlight></CodeLine>
<Link id="l01087" /><CodeLine lineNumber="1087"><Highlight kind="normal">        SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(&amp;PN) == AR)</Highlight></CodeLine>
<Link id="l01088" /><CodeLine lineNumber="1088"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01089" /><CodeLine lineNumber="1089"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01090" /><CodeLine lineNumber="1090"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01091" /><CodeLine lineNumber="1091"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01092" /><CodeLine lineNumber="1092"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01093" /><CodeLine lineNumber="1093"><Highlight kind="comment">/// Check if expanding this expression is likely to incur significant cost. This</Highlight></CodeLine>
<Link id="l01094" /><CodeLine lineNumber="1094"><Highlight kind="comment">/// is tricky because SCEV doesn&#39;t track which expressions are actually computed</Highlight></CodeLine>
<Link id="l01095" /><CodeLine lineNumber="1095"><Highlight kind="comment">/// by the current IR.</Highlight></CodeLine>
<Link id="l01096" /><CodeLine lineNumber="1096"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l01097" /><CodeLine lineNumber="1097"><Highlight kind="comment">/// We currently allow expansion of IV increments that involve adds,</Highlight></CodeLine>
<Link id="l01098" /><CodeLine lineNumber="1098"><Highlight kind="comment">/// multiplication by constants, and AddRecs from existing phis.</Highlight></CodeLine>
<Link id="l01099" /><CodeLine lineNumber="1099"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l01100" /><CodeLine lineNumber="1100"><Highlight kind="comment">/// TODO: Allow UDivExpr if we can find an existing IV increment that is an</Highlight></CodeLine>
<Link id="l01101" /><CodeLine lineNumber="1101"><Highlight kind="comment">/// obvious multiple of the UDivExpr.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01102" /><CodeLine lineNumber="1102" lineLink="#a7ac21134b2aaca2a7d55f6ff9d92f5b2"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S,</Highlight></CodeLine>
<Link id="l01103" /><CodeLine lineNumber="1103"><Highlight kind="normal">                                <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV&#42;&gt;</a> &amp;Processed,</Highlight></CodeLine>
<Link id="l01104" /><CodeLine lineNumber="1104"><Highlight kind="normal">                                <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l01105" /><CodeLine lineNumber="1105"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Zero/One operand expressions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01106" /><CodeLine lineNumber="1106"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (S-&gt;<a href="/docs/api/classes/llvm/scev/#ad4f956914bf94bdcd1058badb5bd90e6">getSCEVType</a>()) &#123;</Highlight></CodeLine>
<Link id="l01107" /><CodeLine lineNumber="1107"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea80488550b42b6548ec4d5c7118c7ff1d">scUnknown</a>:</Highlight></CodeLine>
<Link id="l01108" /><CodeLine lineNumber="1108"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eabcb1f797cb330e61a5879fc260aaec5b">scConstant</a>:</Highlight></CodeLine>
<Link id="l01109" /><CodeLine lineNumber="1109"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea61df12d6bb21842a8f766c4433c85717">scVScale</a>:</Highlight></CodeLine>
<Link id="l01110" /><CodeLine lineNumber="1110"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01111" /><CodeLine lineNumber="1111"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ead3656bcc84af213cc488acb56c60de22">scTruncate</a>:</Highlight></CodeLine>
<Link id="l01112" /><CodeLine lineNumber="1112"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVTruncateExpr&gt;</a>(S)-&gt;getOperand(),</Highlight></CodeLine>
<Link id="l01113" /><CodeLine lineNumber="1113"><Highlight kind="normal">                               Processed, SE);</Highlight></CodeLine>
<Link id="l01114" /><CodeLine lineNumber="1114"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eadd4a8d5cb0d78c9be22d01e1546bafc6">scZeroExtend</a>:</Highlight></CodeLine>
<Link id="l01115" /><CodeLine lineNumber="1115"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVZeroExtendExpr&gt;</a>(S)-&gt;getOperand(),</Highlight></CodeLine>
<Link id="l01116" /><CodeLine lineNumber="1116"><Highlight kind="normal">                               Processed, SE);</Highlight></CodeLine>
<Link id="l01117" /><CodeLine lineNumber="1117"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ead05711646a19cb20775cfbc8ef0a8c09">scSignExtend</a>:</Highlight></CodeLine>
<Link id="l01118" /><CodeLine lineNumber="1118"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVSignExtendExpr&gt;</a>(S)-&gt;getOperand(),</Highlight></CodeLine>
<Link id="l01119" /><CodeLine lineNumber="1119"><Highlight kind="normal">                               Processed, SE);</Highlight></CodeLine>
<Link id="l01120" /><CodeLine lineNumber="1120"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l01121" /><CodeLine lineNumber="1121"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01122" /><CodeLine lineNumber="1122"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01123" /><CodeLine lineNumber="1123"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01124" /><CodeLine lineNumber="1124"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Processed.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(S).second)</Highlight></CodeLine>
<Link id="l01125" /><CodeLine lineNumber="1125"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01126" /><CodeLine lineNumber="1126"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01127" /><CodeLine lineNumber="1127"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l01128" /><CodeLine lineNumber="1128"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands()) &#123;</Highlight></CodeLine>
<Link id="l01129" /><CodeLine lineNumber="1129"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(S, Processed, SE))</Highlight></CodeLine>
<Link id="l01130" /><CodeLine lineNumber="1130"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01131" /><CodeLine lineNumber="1131"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01132" /><CodeLine lineNumber="1132"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01133" /><CodeLine lineNumber="1133"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01134" /><CodeLine lineNumber="1134"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01135" /><CodeLine lineNumber="1135"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l01136" /><CodeLine lineNumber="1136"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getNumOperands() == 2) &#123;</Highlight></CodeLine>
<Link id="l01137" /><CodeLine lineNumber="1137"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Multiplication by a constant is ok</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01138" /><CodeLine lineNumber="1138"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(0)))</Highlight></CodeLine>
<Link id="l01139" /><CodeLine lineNumber="1139"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(1), Processed, SE);</Highlight></CodeLine>
<Link id="l01140" /><CodeLine lineNumber="1140"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01141" /><CodeLine lineNumber="1141"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If we have the value of one operand, check if an existing</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01142" /><CodeLine lineNumber="1142"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// multiplication already generates this expression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01143" /><CodeLine lineNumber="1143"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(1))) &#123;</Highlight></CodeLine>
<Link id="l01144" /><CodeLine lineNumber="1144"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;UVal = U-&gt;getValue();</Highlight></CodeLine>
<Link id="l01145" /><CodeLine lineNumber="1145"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/user">User</a> &#42;UR : UVal-&gt;<a href="/docs/api/classes/llvm/value/#a411cf3e3932f209ce3374cb31adc1da6">users</a>()) &#123;</Highlight></CodeLine>
<Link id="l01146" /><CodeLine lineNumber="1146"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// If U is a constant, it may be used by a ConstantExpr.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01147" /><CodeLine lineNumber="1147"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(UR);</Highlight></CodeLine>
<Link id="l01148" /><CodeLine lineNumber="1148"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UI &amp;&amp; UI-&gt;<a href="/docs/api/classes/llvm/instruction/#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::Mul &amp;&amp;</Highlight></CodeLine>
<Link id="l01149" /><CodeLine lineNumber="1149"><Highlight kind="normal">              SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(UI-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())) &#123;</Highlight></CodeLine>
<Link id="l01150" /><CodeLine lineNumber="1150"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(UI) == <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>;</Highlight></CodeLine>
<Link id="l01151" /><CodeLine lineNumber="1151"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l01152" /><CodeLine lineNumber="1152"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l01153" /><CodeLine lineNumber="1153"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l01154" /><CodeLine lineNumber="1154"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01155" /><CodeLine lineNumber="1155"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01156" /><CodeLine lineNumber="1156"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01157" /><CodeLine lineNumber="1157"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l01158" /><CodeLine lineNumber="1158"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a3c81223cabf643af27adba3b3ceb680c">isExistingPhi</a>(AR, SE))</Highlight></CodeLine>
<Link id="l01159" /><CodeLine lineNumber="1159"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01160" /><CodeLine lineNumber="1160"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01161" /><CodeLine lineNumber="1161"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01162" /><CodeLine lineNumber="1162"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Fow now, consider any other type of expression (div/mul/min/max) high cost.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01163" /><CodeLine lineNumber="1163"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01164" /><CodeLine lineNumber="1164"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01165" /><CodeLine lineNumber="1165"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01166" /><CodeLine lineNumber="1166"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01167" /><CodeLine lineNumber="1167"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01168" /><CodeLine lineNumber="1168"><Highlight kind="normal"></Highlight><Highlight kind="keyword">class </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a>;</Highlight></CodeLine>
<Link id="l01169" /><CodeLine lineNumber="1169"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01170" /><CodeLine lineNumber="1170"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// end anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01171" /><CodeLine lineNumber="1171"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01172" /><CodeLine lineNumber="1172"><Highlight kind="comment">/// Check if the addressing mode defined by \\p F is completely</Highlight></CodeLine>
<Link id="l01173" /><CodeLine lineNumber="1173"><Highlight kind="comment">/// folded in \\p LU at isel time.</Highlight></CodeLine>
<Link id="l01174" /><CodeLine lineNumber="1174"><Highlight kind="comment">/// This includes address-mode folding and special icmp tricks.</Highlight></CodeLine>
<Link id="l01175" /><CodeLine lineNumber="1175"><Highlight kind="comment">/// This function returns true if \\p LU can accommodate what \\p F</Highlight></CodeLine>
<Link id="l01176" /><CodeLine lineNumber="1176"><Highlight kind="comment">/// defines and up to 1 base + 1 scaled + offset.</Highlight></CodeLine>
<Link id="l01177" /><CodeLine lineNumber="1177"><Highlight kind="comment">/// In other words, if \\p F has several base registers, this function may</Highlight></CodeLine>
<Link id="l01178" /><CodeLine lineNumber="1178"><Highlight kind="comment">/// still return true. Therefore, users still need to account for</Highlight></CodeLine>
<Link id="l01179" /><CodeLine lineNumber="1179"><Highlight kind="comment">/// additional base registers and/or unfolded offsets to derive an</Highlight></CodeLine>
<Link id="l01180" /><CodeLine lineNumber="1180"><Highlight kind="comment">/// accurate cost model.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01181" /><CodeLine lineNumber="1181"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01182" /><CodeLine lineNumber="1182"><Highlight kind="normal">                                 </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l01183" /><CodeLine lineNumber="1183"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01184" /><CodeLine lineNumber="1184"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Get the cost of the scaling factor used in F for LU.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01185" /><CodeLine lineNumber="1185"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a> <a href="#a3cbf7279944dc2f0f99a6896501277f9">getScalingFactorCost</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01186" /><CodeLine lineNumber="1186"><Highlight kind="normal">                                            </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l01187" /><CodeLine lineNumber="1187"><Highlight kind="normal">                                            </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L);</Highlight></CodeLine>
<Link id="l01188" /><CodeLine lineNumber="1188"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01189" /><CodeLine lineNumber="1189"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01190" /><CodeLine lineNumber="1190"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01191" /><CodeLine lineNumber="1191"><Highlight kind="comment">/// This class is used to measure and compare candidate formulae.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01192" /><CodeLine lineNumber="1192" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost"><Highlight kind="normal"></Highlight><Highlight kind="keyword">class </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad60603979ceadc6c0b683403e7131646">Cost</a> &#123;</Highlight></CodeLine>
<Link id="l01193" /><CodeLine lineNumber="1193"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01194" /><CodeLine lineNumber="1194"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &#42;SE = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01195" /><CodeLine lineNumber="1195"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &#42;TTI = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01196" /><CodeLine lineNumber="1196"><Highlight kind="normal">  <a href="/docs/api/structs/llvm/targettransforminfo/lsrcost">TargetTransformInfo::LSRCost</a> C;</Highlight></CodeLine>
<Link id="l01197" /><CodeLine lineNumber="1197"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43">TTI::AddressingModeKind</a> AMK = <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43afcb500aacd74955fc04edc890f5e5d1a">TTI::AMK&#95;None</a>;</Highlight></CodeLine>
<Link id="l01198" /><CodeLine lineNumber="1198"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01199" /><CodeLine lineNumber="1199"><Highlight kind="normal"></Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l01200" /><CodeLine lineNumber="1200" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad60603979ceadc6c0b683403e7131646"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad60603979ceadc6c0b683403e7131646">Cost</a>() = </Highlight><Highlight kind="keyword">delete</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01201" /><CodeLine lineNumber="1201" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1d7a221dcf14ef35df4e30ecd319dab6"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1d7a221dcf14ef35df4e30ecd319dab6">Cost</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;TTI,</Highlight></CodeLine>
<Link id="l01202" /><CodeLine lineNumber="1202"><Highlight kind="normal">       <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43">TTI::AddressingModeKind</a> AMK) :</Highlight></CodeLine>
<Link id="l01203" /><CodeLine lineNumber="1203"><Highlight kind="normal">    L(L), SE(&amp;SE), TTI(&amp;TTI), AMK(AMK) &#123;</Highlight></CodeLine>
<Link id="l01204" /><CodeLine lineNumber="1204"><Highlight kind="normal">    C.Insns = 0;</Highlight></CodeLine>
<Link id="l01205" /><CodeLine lineNumber="1205"><Highlight kind="normal">    C.NumRegs = 0;</Highlight></CodeLine>
<Link id="l01206" /><CodeLine lineNumber="1206"><Highlight kind="normal">    C.AddRecCost = 0;</Highlight></CodeLine>
<Link id="l01207" /><CodeLine lineNumber="1207"><Highlight kind="normal">    C.NumIVMuls = 0;</Highlight></CodeLine>
<Link id="l01208" /><CodeLine lineNumber="1208"><Highlight kind="normal">    C.NumBaseAdds = 0;</Highlight></CodeLine>
<Link id="l01209" /><CodeLine lineNumber="1209"><Highlight kind="normal">    C.ImmCost = 0;</Highlight></CodeLine>
<Link id="l01210" /><CodeLine lineNumber="1210"><Highlight kind="normal">    C.SetupCost = 0;</Highlight></CodeLine>
<Link id="l01211" /><CodeLine lineNumber="1211"><Highlight kind="normal">    C.ScaleCost = 0;</Highlight></CodeLine>
<Link id="l01212" /><CodeLine lineNumber="1212"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01213" /><CodeLine lineNumber="1213"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01214" /><CodeLine lineNumber="1214"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> isLess(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01215" /><CodeLine lineNumber="1215"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01216" /><CodeLine lineNumber="1216"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> Lose();</Highlight></CodeLine>
<Link id="l01217" /><CodeLine lineNumber="1217"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01218" /><CodeLine lineNumber="1218"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01219" /><CodeLine lineNumber="1219"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Once any of the metrics loses, they must all remain losers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01220" /><CodeLine lineNumber="1220" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1c9e1a8d2f818a4369919bc3fb731c03"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1c9e1a8d2f818a4369919bc3fb731c03">isValid</a>() &#123;</Highlight></CodeLine>
<Link id="l01221" /><CodeLine lineNumber="1221"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ((C.Insns | C.NumRegs | C.AddRecCost | C.NumIVMuls | C.NumBaseAdds</Highlight></CodeLine>
<Link id="l01222" /><CodeLine lineNumber="1222"><Highlight kind="normal">             | C.ImmCost | C.SetupCost | C.ScaleCost) != ~0u)</Highlight></CodeLine>
<Link id="l01223" /><CodeLine lineNumber="1223"><Highlight kind="normal">      || ((C.Insns &amp; C.NumRegs &amp; C.AddRecCost &amp; C.NumIVMuls &amp; C.NumBaseAdds</Highlight></CodeLine>
<Link id="l01224" /><CodeLine lineNumber="1224"><Highlight kind="normal">           &amp; C.ImmCost &amp; C.SetupCost &amp; C.ScaleCost) == ~0u);</Highlight></CodeLine>
<Link id="l01225" /><CodeLine lineNumber="1225"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01226" /><CodeLine lineNumber="1226"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01227" /><CodeLine lineNumber="1227"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01228" /><CodeLine lineNumber="1228" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed">isLoser</a>() &#123;</Highlight></CodeLine>
<Link id="l01229" /><CodeLine lineNumber="1229"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/demangle/rustdemangle-cpp/#a103d8cfe62c1651cd70e181746f8a840">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;invalid cost&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01230" /><CodeLine lineNumber="1230"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> C.NumRegs == ~0u;</Highlight></CodeLine>
<Link id="l01231" /><CodeLine lineNumber="1231"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01232" /><CodeLine lineNumber="1232"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01233" /><CodeLine lineNumber="1233"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> RateFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l01234" /><CodeLine lineNumber="1234"><Highlight kind="normal">                   <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs,</Highlight></CodeLine>
<Link id="l01235" /><CodeLine lineNumber="1235"><Highlight kind="normal">                   </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> &amp;VisitedRegs,</Highlight></CodeLine>
<Link id="l01236" /><CodeLine lineNumber="1236"><Highlight kind="normal">                   </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU,</Highlight></CodeLine>
<Link id="l01237" /><CodeLine lineNumber="1237"><Highlight kind="normal">                   <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &#42;LoserRegs = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01238" /><CodeLine lineNumber="1238"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01239" /><CodeLine lineNumber="1239" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1df4626320d0227de1e9763ac846ac34"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1df4626320d0227de1e9763ac846ac34">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01240" /><CodeLine lineNumber="1240"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01241" /><CodeLine lineNumber="1241"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01242" /><CodeLine lineNumber="1242"><Highlight kind="normal"></Highlight><Highlight kind="keyword">private</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l01243" /><CodeLine lineNumber="1243"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> RateRegister(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg,</Highlight></CodeLine>
<Link id="l01244" /><CodeLine lineNumber="1244"><Highlight kind="normal">                    <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs);</Highlight></CodeLine>
<Link id="l01245" /><CodeLine lineNumber="1245"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> RatePrimaryRegister(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg,</Highlight></CodeLine>
<Link id="l01246" /><CodeLine lineNumber="1246"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs,</Highlight></CodeLine>
<Link id="l01247" /><CodeLine lineNumber="1247"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &#42;LoserRegs);</Highlight></CodeLine>
<Link id="l01248" /><CodeLine lineNumber="1248"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l01249" /><CodeLine lineNumber="1249"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01250" /><CodeLine lineNumber="1250"><Highlight kind="comment">/// An operand value in an instruction which is to be replaced with some</Highlight></CodeLine>
<Link id="l01251" /><CodeLine lineNumber="1251"><Highlight kind="comment">/// equivalent, possibly strength-reduced, replacement.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01252" /><CodeLine lineNumber="1252" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ad0a66a1f097b56f42f484be7080b23c0">LSRFixup</a> &#123;</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01253" /><CodeLine lineNumber="1253"><Highlight kind="comment">  /// The instruction which will be updated.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01254" /><CodeLine lineNumber="1254" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01255" /><CodeLine lineNumber="1255"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01256" /><CodeLine lineNumber="1256"><Highlight kind="comment">  /// The operand of the instruction which will be replaced. The operand may be</Highlight></CodeLine>
<Link id="l01257" /><CodeLine lineNumber="1257"><Highlight kind="comment">  /// used more than once; every instance will be replaced.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01258" /><CodeLine lineNumber="1258" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a2ee07fa1e186cc7e152f3e5ed2a1c3cc"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a2ee07fa1e186cc7e152f3e5ed2a1c3cc">OperandValToReplace</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01259" /><CodeLine lineNumber="1259"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01260" /><CodeLine lineNumber="1260"><Highlight kind="comment">  /// If this user is to use the post-incremented value of an induction</Highlight></CodeLine>
<Link id="l01261" /><CodeLine lineNumber="1261"><Highlight kind="comment">  /// variable, this set is non-empty and holds the loops associated with the</Highlight></CodeLine>
<Link id="l01262" /><CodeLine lineNumber="1262"><Highlight kind="comment">  /// induction variable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01263" /><CodeLine lineNumber="1263" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a70aa44719a26fecd9a48e86edcb69b51"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a70aa44719a26fecd9a48e86edcb69b51">PostIncLoops</a>;</Highlight></CodeLine>
<Link id="l01264" /><CodeLine lineNumber="1264"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01265" /><CodeLine lineNumber="1265"><Highlight kind="comment">  /// A constant offset to be added to the LSRUse expression.  This allows</Highlight></CodeLine>
<Link id="l01266" /><CodeLine lineNumber="1266"><Highlight kind="comment">  /// multiple fixups to share the same LSRUse with different offsets, for</Highlight></CodeLine>
<Link id="l01267" /><CodeLine lineNumber="1267"><Highlight kind="comment">  /// example in an unrolled loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01268" /><CodeLine lineNumber="1268" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a6d9b5bf6278b280c61b1c37375cad241"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a6d9b5bf6278b280c61b1c37375cad241">Offset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</Highlight></CodeLine>
<Link id="l01269" /><CodeLine lineNumber="1269"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01270" /><CodeLine lineNumber="1270" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ad0a66a1f097b56f42f484be7080b23c0"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ad0a66a1f097b56f42f484be7080b23c0">LSRFixup</a>() = </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01271" /><CodeLine lineNumber="1271"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01272" /><CodeLine lineNumber="1272"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ab5814e2a785fccd6bdcfccc78286fc10">isUseFullyOutsideLoop</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01273" /><CodeLine lineNumber="1273"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01274" /><CodeLine lineNumber="1274"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01275" /><CodeLine lineNumber="1275"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01276" /><CodeLine lineNumber="1276"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l01277" /><CodeLine lineNumber="1277"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01278" /><CodeLine lineNumber="1278"><Highlight kind="comment">/// A DenseMapInfo implementation for holding DenseMaps and DenseSets of sorted</Highlight></CodeLine>
<Link id="l01279" /><CodeLine lineNumber="1279"><Highlight kind="comment">/// SmallVectors of const SCEV&#42;.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01280" /><CodeLine lineNumber="1280" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo">UniquifierDenseMapInfo</a> &#123;</Highlight></CodeLine>
<Link id="l01281" /><CodeLine lineNumber="1281" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#a896950a0629ca3b63bbb06660a1e4ad0"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#a896950a0629ca3b63bbb06660a1e4ad0">getEmptyKey</a>() &#123;</Highlight></CodeLine>
<Link id="l01282" /><CodeLine lineNumber="1282"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a>  V;</Highlight></CodeLine>
<Link id="l01283" /><CodeLine lineNumber="1283"><Highlight kind="normal">    V.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="keyword">reinterpret&#95;cast&lt;</Highlight><Highlight kind="keyword">const </Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(-1));</Highlight></CodeLine>
<Link id="l01284" /><CodeLine lineNumber="1284"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> V;</Highlight></CodeLine>
<Link id="l01285" /><CodeLine lineNumber="1285"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01286" /><CodeLine lineNumber="1286"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01287" /><CodeLine lineNumber="1287" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#ab342fc50b3fc95a5028ba25d3646b3f0"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#ab342fc50b3fc95a5028ba25d3646b3f0">getTombstoneKey</a>() &#123;</Highlight></CodeLine>
<Link id="l01288" /><CodeLine lineNumber="1288"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> V;</Highlight></CodeLine>
<Link id="l01289" /><CodeLine lineNumber="1289"><Highlight kind="normal">    V.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight><Highlight kind="keyword">reinterpret&#95;cast&lt;</Highlight><Highlight kind="keyword">const </Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(-2));</Highlight></CodeLine>
<Link id="l01290" /><CodeLine lineNumber="1290"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> V;</Highlight></CodeLine>
<Link id="l01291" /><CodeLine lineNumber="1291"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01292" /><CodeLine lineNumber="1292"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01293" /><CodeLine lineNumber="1293" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#ab0b5ece0e00938bdfa4f083ac4e11736"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#ab0b5ece0e00938bdfa4f083ac4e11736">getHashValue</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> &amp;V) &#123;</Highlight></CodeLine>
<Link id="l01294" /><CodeLine lineNumber="1294"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(<a href="/docs/api/namespaces/llvm/#af80edfc5e42059e045aa7bf7fe42bee3">hash&#95;combine&#95;range</a>(V.begin(), V.end()));</Highlight></CodeLine>
<Link id="l01295" /><CodeLine lineNumber="1295"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01296" /><CodeLine lineNumber="1296"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01297" /><CodeLine lineNumber="1297" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#a599e877e85a0f8ddde1453d036629750"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#a599e877e85a0f8ddde1453d036629750">isEqual</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> &amp;LHS,</Highlight></CodeLine>
<Link id="l01298" /><CodeLine lineNumber="1298"><Highlight kind="normal">                      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> &amp;RHS) &#123;</Highlight></CodeLine>
<Link id="l01299" /><CodeLine lineNumber="1299"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LHS == RHS;</Highlight></CodeLine>
<Link id="l01300" /><CodeLine lineNumber="1300"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01301" /><CodeLine lineNumber="1301"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l01302" /><CodeLine lineNumber="1302"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01303" /><CodeLine lineNumber="1303"><Highlight kind="comment">/// This class holds the state that LSR keeps for each use in IVUsers, as well</Highlight></CodeLine>
<Link id="l01304" /><CodeLine lineNumber="1304"><Highlight kind="comment">/// as uses invented by LSR itself. It includes information about what kinds of</Highlight></CodeLine>
<Link id="l01305" /><CodeLine lineNumber="1305"><Highlight kind="comment">/// things can be folded into the user, information about the user itself, and</Highlight></CodeLine>
<Link id="l01306" /><CodeLine lineNumber="1306"><Highlight kind="comment">/// information about how the use may be satisfied.  TODO: Represent multiple</Highlight></CodeLine>
<Link id="l01307" /><CodeLine lineNumber="1307"><Highlight kind="comment">/// users of the same expression in common?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01308" /><CodeLine lineNumber="1308" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse"><Highlight kind="normal"></Highlight><Highlight kind="keyword">class </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a> &#123;</Highlight></CodeLine>
<Link id="l01309" /><CodeLine lineNumber="1309"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;SmallVector&lt;const SCEV &#42;, 4&gt;</a>, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo">UniquifierDenseMapInfo</a>&gt; Uniquifier;</Highlight></CodeLine>
<Link id="l01310" /><CodeLine lineNumber="1310"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01311" /><CodeLine lineNumber="1311"><Highlight kind="normal"></Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal">:</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01312" /><CodeLine lineNumber="1312"><Highlight kind="comment">  /// An enum for a kind of use, indicating what types of scaled and immediate</Highlight></CodeLine>
<Link id="l01313" /><CodeLine lineNumber="1313"><Highlight kind="comment">  /// operands it might support.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01314" /><CodeLine lineNumber="1314" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">enum</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">KindType</a> &#123;</Highlight></CodeLine>
<Link id="l01315" /><CodeLine lineNumber="1315" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">Basic</a>,   </Highlight><Highlight kind="comment">///&lt; A normal use, with no folding.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01316" /><CodeLine lineNumber="1316" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">Special</a>, </Highlight><Highlight kind="comment">///&lt; A special case of basic, allowing -1 scales.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01317" /><CodeLine lineNumber="1317" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">Address</a>, </Highlight><Highlight kind="comment">///&lt; An address use; folding according to TargetLowering</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01318" /><CodeLine lineNumber="1318" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">ICmpZero</a> </Highlight><Highlight kind="comment">///&lt; An equality icmp with both operands folded into one.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01319" /><CodeLine lineNumber="1319"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Add a generic icmp too?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01320" /><CodeLine lineNumber="1320"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l01321" /><CodeLine lineNumber="1321"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01322" /><CodeLine lineNumber="1322" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a4a62881e0181b4f2dc498eff32edf764"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a4a62881e0181b4f2dc498eff32edf764">SCEVUseKindPair</a> = <a href="/docs/api/classes/llvm/pointerintpair">PointerIntPair&lt;const SCEV &#42;, 2, KindType&gt;</a>;</Highlight></CodeLine>
<Link id="l01323" /><CodeLine lineNumber="1323"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01324" /><CodeLine lineNumber="1324" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af414d3b8902f3db57e9f08d3232fc17c"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">KindType</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af414d3b8902f3db57e9f08d3232fc17c">Kind</a>;</Highlight></CodeLine>
<Link id="l01325" /><CodeLine lineNumber="1325" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>;</Highlight></CodeLine>
<Link id="l01326" /><CodeLine lineNumber="1326"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01327" /><CodeLine lineNumber="1327"><Highlight kind="comment">  /// The list of operands which are to be replaced.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01328" /><CodeLine lineNumber="1328" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;LSRFixup, 8&gt;</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>;</Highlight></CodeLine>
<Link id="l01329" /><CodeLine lineNumber="1329"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01330" /><CodeLine lineNumber="1330"><Highlight kind="comment">  /// Keep track of the min and max offsets of the fixups.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01331" /><CodeLine lineNumber="1331" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a445b231c7c14ab0d460f9a4d70367c8e"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a445b231c7c14ab0d460f9a4d70367c8e">MinOffset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a23392dbe6d771d111f00d09560f87f0d">Immediate::getFixedMax</a>();</Highlight></CodeLine>
<Link id="l01332" /><CodeLine lineNumber="1332" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#afb7a640470c15f82dc8df85e033d8619"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#afb7a640470c15f82dc8df85e033d8619">MaxOffset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a691a45579958cfd41dd9dcff39646ca0">Immediate::getFixedMin</a>();</Highlight></CodeLine>
<Link id="l01333" /><CodeLine lineNumber="1333"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01334" /><CodeLine lineNumber="1334"><Highlight kind="comment">  /// This records whether all of the fixups using this LSRUse are outside of</Highlight></CodeLine>
<Link id="l01335" /><CodeLine lineNumber="1335"><Highlight kind="comment">  /// the loop, in which case some special-case heuristics may be used.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01336" /><CodeLine lineNumber="1336" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aac7deb997535d3d9a445dd87bd0f2192"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aac7deb997535d3d9a445dd87bd0f2192">AllFixupsOutsideLoop</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01337" /><CodeLine lineNumber="1337"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01338" /><CodeLine lineNumber="1338"><Highlight kind="comment">  /// RigidFormula is set to true to guarantee that this use will be associated</Highlight></CodeLine>
<Link id="l01339" /><CodeLine lineNumber="1339"><Highlight kind="comment">  /// with a single formula--the one that initially matched. Some SCEV</Highlight></CodeLine>
<Link id="l01340" /><CodeLine lineNumber="1340"><Highlight kind="comment">  /// expressions cannot be expanded. This allows LSR to consider the registers</Highlight></CodeLine>
<Link id="l01341" /><CodeLine lineNumber="1341"><Highlight kind="comment">  /// used by those expressions without the need to expand them later after</Highlight></CodeLine>
<Link id="l01342" /><CodeLine lineNumber="1342"><Highlight kind="comment">  /// changing the formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01343" /><CodeLine lineNumber="1343" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aa45af5caf29ddb4040ef123166ba800a"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aa45af5caf29ddb4040ef123166ba800a">RigidFormula</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01344" /><CodeLine lineNumber="1344"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01345" /><CodeLine lineNumber="1345"><Highlight kind="comment">  /// This records the widest use type for any fixup using this</Highlight></CodeLine>
<Link id="l01346" /><CodeLine lineNumber="1346"><Highlight kind="comment">  /// LSRUse. FindUseWithSimilarFormula can&#39;t consider uses with different max</Highlight></CodeLine>
<Link id="l01347" /><CodeLine lineNumber="1347"><Highlight kind="comment">  /// fixup widths to be equivalent, because the narrower one may be relying on</Highlight></CodeLine>
<Link id="l01348" /><CodeLine lineNumber="1348"><Highlight kind="comment">  /// the implicit truncation to truncate away bogus bits.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01349" /><CodeLine lineNumber="1349" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ac6eb6d8e22eb1da2d816c5cb38fe166d"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ac6eb6d8e22eb1da2d816c5cb38fe166d">WidestFixupType</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01350" /><CodeLine lineNumber="1350"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01351" /><CodeLine lineNumber="1351"><Highlight kind="comment">  /// A list of ways to build a value that can satisfy this user.  After the</Highlight></CodeLine>
<Link id="l01352" /><CodeLine lineNumber="1352"><Highlight kind="comment">  /// list is populated, one of these is selected heuristically and used to</Highlight></CodeLine>
<Link id="l01353" /><CodeLine lineNumber="1353"><Highlight kind="comment">  /// formulate a replacement for OperandValToReplace in UserInst.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01354" /><CodeLine lineNumber="1354" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Formula, 12&gt;</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>;</Highlight></CodeLine>
<Link id="l01355" /><CodeLine lineNumber="1355"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01356" /><CodeLine lineNumber="1356"><Highlight kind="comment">  /// The set of register candidates used by all formulae in this LSRUse.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01357" /><CodeLine lineNumber="1357" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>;</Highlight></CodeLine>
<Link id="l01358" /><CodeLine lineNumber="1358"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01359" /><CodeLine lineNumber="1359" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a>(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">KindType</a> K, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a> AT) : <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af414d3b8902f3db57e9f08d3232fc17c">Kind</a>(K), <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>(AT) &#123;&#125;</Highlight></CodeLine>
<Link id="l01360" /><CodeLine lineNumber="1360"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01361" /><CodeLine lineNumber="1361" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a2fe504663d9ae4f9f4b7d30c6d1b6d69"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a2fe504663d9ae4f9f4b7d30c6d1b6d69">getNewFixup</a>() &#123;</Highlight></CodeLine>
<Link id="l01362" /><CodeLine lineNumber="1362"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>.push&#95;back(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a>());</Highlight></CodeLine>
<Link id="l01363" /><CodeLine lineNumber="1363"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>.back();</Highlight></CodeLine>
<Link id="l01364" /><CodeLine lineNumber="1364"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01365" /><CodeLine lineNumber="1365"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01366" /><CodeLine lineNumber="1366" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ae24f15680876cc6aab9d451d3b7906dd"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ae24f15680876cc6aab9d451d3b7906dd">pushFixup</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;f) &#123;</Highlight></CodeLine>
<Link id="l01367" /><CodeLine lineNumber="1367"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>.push&#95;back(f);</Highlight></CodeLine>
<Link id="l01368" /><CodeLine lineNumber="1368"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#addaa86bfa4ca26b7f366cbdd868f99bf">Immediate::isKnownGT</a>(f.Offset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#afb7a640470c15f82dc8df85e033d8619">MaxOffset</a>))</Highlight></CodeLine>
<Link id="l01369" /><CodeLine lineNumber="1369"><Highlight kind="normal">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#afb7a640470c15f82dc8df85e033d8619">MaxOffset</a> = f.Offset;</Highlight></CodeLine>
<Link id="l01370" /><CodeLine lineNumber="1370"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a83e6442f8ebefccdb5e089732fe397ac">Immediate::isKnownLT</a>(f.Offset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a445b231c7c14ab0d460f9a4d70367c8e">MinOffset</a>))</Highlight></CodeLine>
<Link id="l01371" /><CodeLine lineNumber="1371"><Highlight kind="normal">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a445b231c7c14ab0d460f9a4d70367c8e">MinOffset</a> = f.Offset;</Highlight></CodeLine>
<Link id="l01372" /><CodeLine lineNumber="1372"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01373" /><CodeLine lineNumber="1373"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01374" /><CodeLine lineNumber="1374"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasFormulaWithSameRegs(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01375" /><CodeLine lineNumber="1375"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal"> getNotSelectedProbability(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01376" /><CodeLine lineNumber="1376"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> InsertFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L);</Highlight></CodeLine>
<Link id="l01377" /><CodeLine lineNumber="1377"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> DeleteFormula(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l01378" /><CodeLine lineNumber="1378"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> RecomputeRegs(</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &amp;Reguses);</Highlight></CodeLine>
<Link id="l01379" /><CodeLine lineNumber="1379"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01380" /><CodeLine lineNumber="1380"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01381" /><CodeLine lineNumber="1381"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01382" /><CodeLine lineNumber="1382"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l01383" /><CodeLine lineNumber="1383"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01384" /><CodeLine lineNumber="1384"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// end anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01385" /><CodeLine lineNumber="1385"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01386" /><CodeLine lineNumber="1386"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01387" /><CodeLine lineNumber="1387"><Highlight kind="normal">                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> AccessTy,</Highlight></CodeLine>
<Link id="l01388" /><CodeLine lineNumber="1388"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a> BaseOffset,</Highlight></CodeLine>
<Link id="l01389" /><CodeLine lineNumber="1389"><Highlight kind="normal">                                 </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasBaseReg, int64&#95;t Scale,</Highlight></CodeLine>
<Link id="l01390" /><CodeLine lineNumber="1390"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01391" /><CodeLine lineNumber="1391"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01392" /><CodeLine lineNumber="1392" lineLink="#ae51d322caa9d6592ff524f98563eac36"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>) &#123;</Highlight></CodeLine>
<Link id="l01393" /><CodeLine lineNumber="1393"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) || <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</Highlight></CodeLine>
<Link id="l01394" /><CodeLine lineNumber="1394"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 1;</Highlight></CodeLine>
<Link id="l01395" /><CodeLine lineNumber="1395"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> == 0)</Highlight></CodeLine>
<Link id="l01396" /><CodeLine lineNumber="1396"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 0;</Highlight></CodeLine>
<Link id="l01397" /><CodeLine lineNumber="1397"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</Highlight></CodeLine>
<Link id="l01398" /><CodeLine lineNumber="1398"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(S-&gt;getStart(), <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> - 1);</Highlight></CodeLine>
<Link id="l01399" /><CodeLine lineNumber="1399"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVIntegralCastExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</Highlight></CodeLine>
<Link id="l01400" /><CodeLine lineNumber="1400"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(S-&gt;getOperand(), <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> - 1);</Highlight></CodeLine>
<Link id="l01401" /><CodeLine lineNumber="1401"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVNAryExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</Highlight></CodeLine>
<Link id="l01402" /><CodeLine lineNumber="1402"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> std::accumulate(S-&gt;operands().begin(), S-&gt;operands().end(), 0,</Highlight></CodeLine>
<Link id="l01403" /><CodeLine lineNumber="1403"><Highlight kind="normal">                           &#91;&amp;&#93;(</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> i, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &#123;</Highlight></CodeLine>
<Link id="l01404" /><CodeLine lineNumber="1404"><Highlight kind="normal">                             return i + getSetupCost(Reg, Depth - 1);</Highlight></CodeLine>
<Link id="l01405" /><CodeLine lineNumber="1405"><Highlight kind="normal">                           &#125;);</Highlight></CodeLine>
<Link id="l01406" /><CodeLine lineNumber="1406"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUDivExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</Highlight></CodeLine>
<Link id="l01407" /><CodeLine lineNumber="1407"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(S-&gt;getLHS(), <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> - 1) +</Highlight></CodeLine>
<Link id="l01408" /><CodeLine lineNumber="1408"><Highlight kind="normal">           <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(S-&gt;getRHS(), <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> - 1);</Highlight></CodeLine>
<Link id="l01409" /><CodeLine lineNumber="1409"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 0;</Highlight></CodeLine>
<Link id="l01410" /><CodeLine lineNumber="1410"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01411" /><CodeLine lineNumber="1411"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01412" /><CodeLine lineNumber="1412"><Highlight kind="comment">/// Tally up interesting quantities from the given register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01413" /><CodeLine lineNumber="1413"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> Cost::RateRegister(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</Highlight></CodeLine>
<Link id="l01414" /><CodeLine lineNumber="1414"><Highlight kind="normal">                        <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs) &#123;</Highlight></CodeLine>
<Link id="l01415" /><CodeLine lineNumber="1415"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> SCEVAddRecExpr &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</Highlight></CodeLine>
<Link id="l01416" /><CodeLine lineNumber="1416"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If this is an addrec for another loop, it should be an invariant</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01417" /><CodeLine lineNumber="1417"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// with respect to L since L is the innermost loop (at least</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01418" /><CodeLine lineNumber="1418"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// for now LSR only handles innermost loops).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01419" /><CodeLine lineNumber="1419"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AR-&gt;getLoop() != L) &#123;</Highlight></CodeLine>
<Link id="l01420" /><CodeLine lineNumber="1420"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If the AddRec exists, consider it&#39;s register free and leave it alone.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01421" /><CodeLine lineNumber="1421"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a3c81223cabf643af27adba3b3ceb680c">isExistingPhi</a>(AR, &#42;SE) &amp;&amp; AMK != <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>)</Highlight></CodeLine>
<Link id="l01422" /><CodeLine lineNumber="1422"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01423" /><CodeLine lineNumber="1423"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01424" /><CodeLine lineNumber="1424"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// It is bad to allow LSR for current loop to add induction variables</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01425" /><CodeLine lineNumber="1425"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// for its sibling loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01426" /><CodeLine lineNumber="1426"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AR-&gt;getLoop()-&gt;contains(L)) &#123;</Highlight></CodeLine>
<Link id="l01427" /><CodeLine lineNumber="1427"><Highlight kind="normal">        Lose();</Highlight></CodeLine>
<Link id="l01428" /><CodeLine lineNumber="1428"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01429" /><CodeLine lineNumber="1429"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l01430" /><CodeLine lineNumber="1430"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01431" /><CodeLine lineNumber="1431"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Otherwise, it will be an invariant with respect to Loop L.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01432" /><CodeLine lineNumber="1432"><Highlight kind="normal">      ++<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumRegs;</Highlight></CodeLine>
<Link id="l01433" /><CodeLine lineNumber="1433"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01434" /><CodeLine lineNumber="1434"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01435" /><CodeLine lineNumber="1435"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01436" /><CodeLine lineNumber="1436"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LoopCost = 1;</Highlight></CodeLine>
<Link id="l01437" /><CodeLine lineNumber="1437"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>-&gt;<a href="/docs/api/classes/llvm/targettransforminfo/#a7716bda26c61738e624214efa149e83e">isIndexedLoadLegal</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>-&gt;<a href="/docs/api/classes/llvm/targettransforminfo/#acf5cc8324c33cb1f59869456263f9f4ba3a471f30b7a193785b57c081776ad3cb">MIM&#95;PostInc</a>, AR-&gt;getType()) ||</Highlight></CodeLine>
<Link id="l01438" /><CodeLine lineNumber="1438"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>-&gt;<a href="/docs/api/classes/llvm/targettransforminfo/#a5a768ef7bcf1b5059f409327c1f83591">isIndexedStoreLegal</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>-&gt;<a href="/docs/api/classes/llvm/targettransforminfo/#acf5cc8324c33cb1f59869456263f9f4ba3a471f30b7a193785b57c081776ad3cb">MIM&#95;PostInc</a>, AR-&gt;getType())) &#123;</Highlight></CodeLine>
<Link id="l01439" /><CodeLine lineNumber="1439"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01440" /><CodeLine lineNumber="1440"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If the step size matches the base offset, we could use pre-indexed</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01441" /><CodeLine lineNumber="1441"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// addressing.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01442" /><CodeLine lineNumber="1442"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a7cb26b7792c751612e634c36dce16f9a">TTI::AMK&#95;PreIndexed</a> &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isFixed()) &#123;</Highlight></CodeLine>
<Link id="l01443" /><CodeLine lineNumber="1443"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Step = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(AR-&gt;getStepRecurrence(&#42;SE)))</Highlight></CodeLine>
<Link id="l01444" /><CodeLine lineNumber="1444"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Step-&gt;getAPInt() == <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.getFixedValue())</Highlight></CodeLine>
<Link id="l01445" /><CodeLine lineNumber="1445"><Highlight kind="normal">            LoopCost = 0;</Highlight></CodeLine>
<Link id="l01446" /><CodeLine lineNumber="1446"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>) &#123;</Highlight></CodeLine>
<Link id="l01447" /><CodeLine lineNumber="1447"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> SCEV &#42;LoopStep = AR-&gt;getStepRecurrence(&#42;SE);</Highlight></CodeLine>
<Link id="l01448" /><CodeLine lineNumber="1448"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(LoopStep)) &#123;</Highlight></CodeLine>
<Link id="l01449" /><CodeLine lineNumber="1449"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> SCEV &#42;LoopStart = AR-&gt;getStart();</Highlight></CodeLine>
<Link id="l01450" /><CodeLine lineNumber="1450"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(LoopStart) &amp;&amp;</Highlight></CodeLine>
<Link id="l01451" /><CodeLine lineNumber="1451"><Highlight kind="normal">              SE-&gt;isLoopInvariant(LoopStart, L))</Highlight></CodeLine>
<Link id="l01452" /><CodeLine lineNumber="1452"><Highlight kind="normal">            LoopCost = 0;</Highlight></CodeLine>
<Link id="l01453" /><CodeLine lineNumber="1453"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l01454" /><CodeLine lineNumber="1454"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l01455" /><CodeLine lineNumber="1455"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01456" /><CodeLine lineNumber="1456"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.AddRecCost += LoopCost;</Highlight></CodeLine>
<Link id="l01457" /><CodeLine lineNumber="1457"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01458" /><CodeLine lineNumber="1458"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add the step value register, if it needs one.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01459" /><CodeLine lineNumber="1459"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: The non-affine case isn&#39;t precisely modeled here.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01460" /><CodeLine lineNumber="1460"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AR-&gt;isAffine() || !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(AR-&gt;getOperand(1))) &#123;</Highlight></CodeLine>
<Link id="l01461" /><CodeLine lineNumber="1461"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Regs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(AR-&gt;getOperand(1))) &#123;</Highlight></CodeLine>
<Link id="l01462" /><CodeLine lineNumber="1462"><Highlight kind="normal">        RateRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, AR-&gt;getOperand(1), Regs);</Highlight></CodeLine>
<Link id="l01463" /><CodeLine lineNumber="1463"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (isLoser())</Highlight></CodeLine>
<Link id="l01464" /><CodeLine lineNumber="1464"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01465" /><CodeLine lineNumber="1465"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l01466" /><CodeLine lineNumber="1466"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01467" /><CodeLine lineNumber="1467"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01468" /><CodeLine lineNumber="1468"><Highlight kind="normal">  ++<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumRegs;</Highlight></CodeLine>
<Link id="l01469" /><CodeLine lineNumber="1469"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01470" /><CodeLine lineNumber="1470"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Rough heuristic; favor registers which don&#39;t require extra setup</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01471" /><CodeLine lineNumber="1471"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// instructions in the preheader.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01472" /><CodeLine lineNumber="1472"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost += <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, <a href="#af7597e13dc8bb8a3af795f41314f157f">SetupCostDepthLimit</a>);</Highlight></CodeLine>
<Link id="l01473" /><CodeLine lineNumber="1473"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ensure we don&#39;t, even with the recusion limit, produce invalid costs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01474" /><CodeLine lineNumber="1474"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost = std::min&lt;unsigned&gt;(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost, 1 &lt;&lt; 16);</Highlight></CodeLine>
<Link id="l01475" /><CodeLine lineNumber="1475"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01476" /><CodeLine lineNumber="1476"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumIVMuls += <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVMulExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l01477" /><CodeLine lineNumber="1477"><Highlight kind="normal">               SE-&gt;hasComputableLoopEvolution(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, L);</Highlight></CodeLine>
<Link id="l01478" /><CodeLine lineNumber="1478"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01479" /><CodeLine lineNumber="1479"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01480" /><CodeLine lineNumber="1480"><Highlight kind="comment">/// Record this register in the set. If we haven&#39;t seen it before, rate</Highlight></CodeLine>
<Link id="l01481" /><CodeLine lineNumber="1481"><Highlight kind="comment">/// it. Optional LoserRegs provides a way to declare any formula that refers to</Highlight></CodeLine>
<Link id="l01482" /><CodeLine lineNumber="1482"><Highlight kind="comment">/// one of those regs an instant loser.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01483" /><CodeLine lineNumber="1483"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> Cost::RatePrimaryRegister(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</Highlight></CodeLine>
<Link id="l01484" /><CodeLine lineNumber="1484"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs,</Highlight></CodeLine>
<Link id="l01485" /><CodeLine lineNumber="1485"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &#42;LoserRegs) &#123;</Highlight></CodeLine>
<Link id="l01486" /><CodeLine lineNumber="1486"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LoserRegs &amp;&amp; LoserRegs-&gt;<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</Highlight></CodeLine>
<Link id="l01487" /><CodeLine lineNumber="1487"><Highlight kind="normal">    Lose();</Highlight></CodeLine>
<Link id="l01488" /><CodeLine lineNumber="1488"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01489" /><CodeLine lineNumber="1489"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01490" /><CodeLine lineNumber="1490"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Regs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>).second) &#123;</Highlight></CodeLine>
<Link id="l01491" /><CodeLine lineNumber="1491"><Highlight kind="normal">    RateRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, Regs);</Highlight></CodeLine>
<Link id="l01492" /><CodeLine lineNumber="1492"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LoserRegs &amp;&amp; isLoser())</Highlight></CodeLine>
<Link id="l01493" /><CodeLine lineNumber="1493"><Highlight kind="normal">      LoserRegs-&gt;<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</Highlight></CodeLine>
<Link id="l01494" /><CodeLine lineNumber="1494"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01495" /><CodeLine lineNumber="1495"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01496" /><CodeLine lineNumber="1496"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01497" /><CodeLine lineNumber="1497" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#abd90406531e76ab0007b8cf6ebe8b34d"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> Cost::RateFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l01498" /><CodeLine lineNumber="1498"><Highlight kind="normal">                       <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs,</Highlight></CodeLine>
<Link id="l01499" /><CodeLine lineNumber="1499"><Highlight kind="normal">                       </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> &amp;VisitedRegs,</Highlight></CodeLine>
<Link id="l01500" /><CodeLine lineNumber="1500"><Highlight kind="normal">                       </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU,</Highlight></CodeLine>
<Link id="l01501" /><CodeLine lineNumber="1501"><Highlight kind="normal">                       <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &#42;LoserRegs) &#123;</Highlight></CodeLine>
<Link id="l01502" /><CodeLine lineNumber="1502"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed">isLoser</a>())</Highlight></CodeLine>
<Link id="l01503" /><CodeLine lineNumber="1503"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01504" /><CodeLine lineNumber="1504"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isCanonical(&#42;L) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Cost is accurate only for canonical formula&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01505" /><CodeLine lineNumber="1505"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Tally up the registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01506" /><CodeLine lineNumber="1506"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> PrevAddRecCost = C.AddRecCost;</Highlight></CodeLine>
<Link id="l01507" /><CodeLine lineNumber="1507"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> PrevNumRegs = C.NumRegs;</Highlight></CodeLine>
<Link id="l01508" /><CodeLine lineNumber="1508"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> PrevNumBaseAdds = C.NumBaseAdds;</Highlight></CodeLine>
<Link id="l01509" /><CodeLine lineNumber="1509"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;ScaledReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) &#123;</Highlight></CodeLine>
<Link id="l01510" /><CodeLine lineNumber="1510"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (VisitedRegs.<a href="/docs/api/classes/llvm/detail/densesetimpl/#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(ScaledReg)) &#123;</Highlight></CodeLine>
<Link id="l01511" /><CodeLine lineNumber="1511"><Highlight kind="normal">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad3242d77b21293a7423564fc64997620">Lose</a>();</Highlight></CodeLine>
<Link id="l01512" /><CodeLine lineNumber="1512"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01513" /><CodeLine lineNumber="1513"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01514" /><CodeLine lineNumber="1514"><Highlight kind="normal">    RatePrimaryRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, ScaledReg, Regs, LoserRegs);</Highlight></CodeLine>
<Link id="l01515" /><CodeLine lineNumber="1515"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed">isLoser</a>())</Highlight></CodeLine>
<Link id="l01516" /><CodeLine lineNumber="1516"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01517" /><CodeLine lineNumber="1517"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01518" /><CodeLine lineNumber="1518"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</Highlight></CodeLine>
<Link id="l01519" /><CodeLine lineNumber="1519"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (VisitedRegs.<a href="/docs/api/classes/llvm/detail/densesetimpl/#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(BaseReg)) &#123;</Highlight></CodeLine>
<Link id="l01520" /><CodeLine lineNumber="1520"><Highlight kind="normal">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad3242d77b21293a7423564fc64997620">Lose</a>();</Highlight></CodeLine>
<Link id="l01521" /><CodeLine lineNumber="1521"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01522" /><CodeLine lineNumber="1522"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01523" /><CodeLine lineNumber="1523"><Highlight kind="normal">    RatePrimaryRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, BaseReg, Regs, LoserRegs);</Highlight></CodeLine>
<Link id="l01524" /><CodeLine lineNumber="1524"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed">isLoser</a>())</Highlight></CodeLine>
<Link id="l01525" /><CodeLine lineNumber="1525"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01526" /><CodeLine lineNumber="1526"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01527" /><CodeLine lineNumber="1527"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01528" /><CodeLine lineNumber="1528"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Determine how many (unfolded) adds we&#39;ll need inside the loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01529" /><CodeLine lineNumber="1529"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> NumBaseParts = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs();</Highlight></CodeLine>
<Link id="l01530" /><CodeLine lineNumber="1530"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumBaseParts &gt; 1)</Highlight></CodeLine>
<Link id="l01531" /><CodeLine lineNumber="1531"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Do not count the base and a possible second register if the target</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01532" /><CodeLine lineNumber="1532"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// allows to fold 2 registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01533" /><CodeLine lineNumber="1533"><Highlight kind="normal">    C.NumBaseAdds +=</Highlight></CodeLine>
<Link id="l01534" /><CodeLine lineNumber="1534"><Highlight kind="normal">        NumBaseParts - (1 + (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale &amp;&amp; <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(&#42;TTI, LU, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)));</Highlight></CodeLine>
<Link id="l01535" /><CodeLine lineNumber="1535"><Highlight kind="normal">  C.NumBaseAdds += (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isNonZero());</Highlight></CodeLine>
<Link id="l01536" /><CodeLine lineNumber="1536"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01537" /><CodeLine lineNumber="1537"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Accumulate non-free scaling amounts.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01538" /><CodeLine lineNumber="1538"><Highlight kind="normal">  C.ScaleCost += &#42;<a href="#a3cbf7279944dc2f0f99a6896501277f9">getScalingFactorCost</a>(&#42;TTI, LU, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &#42;L).<a href="/docs/api/classes/llvm/instructioncost/#a9b642067999075ba996ecdee40b52b68">getValue</a>();</Highlight></CodeLine>
<Link id="l01539" /><CodeLine lineNumber="1539"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01540" /><CodeLine lineNumber="1540"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Tally up the non-zero immediates.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01541" /><CodeLine lineNumber="1541"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : LU.Fixups) &#123;</Highlight></CodeLine>
<Link id="l01542" /><CodeLine lineNumber="1542"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset.isCompatibleImmediate(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset)) &#123;</Highlight></CodeLine>
<Link id="l01543" /><CodeLine lineNumber="1543"><Highlight kind="normal">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset.addUnsigned(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset);</Highlight></CodeLine>
<Link id="l01544" /><CodeLine lineNumber="1544"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV)</Highlight></CodeLine>
<Link id="l01545" /><CodeLine lineNumber="1545"><Highlight kind="normal">        C.ImmCost += 64; </Highlight><Highlight kind="comment">// Handle symbolic values conservatively.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01546" /><CodeLine lineNumber="1546"><Highlight kind="normal">                         </Highlight><Highlight kind="comment">// TODO: This should probably be the pointer size.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01547" /><CodeLine lineNumber="1547"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isNonZero())</Highlight></CodeLine>
<Link id="l01548" /><CodeLine lineNumber="1548"><Highlight kind="normal">        C.ImmCost +=</Highlight></CodeLine>
<Link id="l01549" /><CodeLine lineNumber="1549"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/apint">APInt</a>(64, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getKnownMinValue(), </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">).<a href="/docs/api/classes/llvm/apint/#a9f78d7e839322a6bfc0c665d29052242">getSignificantBits</a>();</Highlight></CodeLine>
<Link id="l01550" /><CodeLine lineNumber="1550"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01551" /><CodeLine lineNumber="1551"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Check with target if this offset with this instruction is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01552" /><CodeLine lineNumber="1552"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// specifically not supported.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01553" /><CodeLine lineNumber="1553"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> &amp;&amp; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isNonZero() &amp;&amp;</Highlight></CodeLine>
<Link id="l01554" /><CodeLine lineNumber="1554"><Highlight kind="normal">          !<a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(&#42;TTI, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV,</Highlight></CodeLine>
<Link id="l01555" /><CodeLine lineNumber="1555"><Highlight kind="normal">                                <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale, <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst))</Highlight></CodeLine>
<Link id="l01556" /><CodeLine lineNumber="1556"><Highlight kind="normal">        C.NumBaseAdds++;</Highlight></CodeLine>
<Link id="l01557" /><CodeLine lineNumber="1557"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l01558" /><CodeLine lineNumber="1558"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Incompatible immediate type, increase cost to avoid using</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01559" /><CodeLine lineNumber="1559"><Highlight kind="normal">      C.ImmCost += 2048;</Highlight></CodeLine>
<Link id="l01560" /><CodeLine lineNumber="1560"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01561" /><CodeLine lineNumber="1561"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01562" /><CodeLine lineNumber="1562"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01563" /><CodeLine lineNumber="1563"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we don&#39;t count instruction cost exit here.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01564" /><CodeLine lineNumber="1564"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a>) &#123;</Highlight></CodeLine>
<Link id="l01565" /><CodeLine lineNumber="1565"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/instructioncost/#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;invalid cost&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01566" /><CodeLine lineNumber="1566"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01567" /><CodeLine lineNumber="1567"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01568" /><CodeLine lineNumber="1568"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01569" /><CodeLine lineNumber="1569"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Treat every new register that exceeds TTI.getNumberOfRegisters() - 1 as</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01570" /><CodeLine lineNumber="1570"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// additional instruction (at least fill).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01571" /><CodeLine lineNumber="1571"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Need distinguish register class?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01572" /><CodeLine lineNumber="1572"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> TTIRegNum = TTI-&gt;getNumberOfRegisters(</Highlight></CodeLine>
<Link id="l01573" /><CodeLine lineNumber="1573"><Highlight kind="normal">                       TTI-&gt;getRegisterClassForType(</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getType())) - 1;</Highlight></CodeLine>
<Link id="l01574" /><CodeLine lineNumber="1574"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (C.NumRegs &gt; TTIRegNum) &#123;</Highlight></CodeLine>
<Link id="l01575" /><CodeLine lineNumber="1575"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Cost already exceeded TTIRegNum, then only newly added register can add</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01576" /><CodeLine lineNumber="1576"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// new instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01577" /><CodeLine lineNumber="1577"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PrevNumRegs &gt; TTIRegNum)</Highlight></CodeLine>
<Link id="l01578" /><CodeLine lineNumber="1578"><Highlight kind="normal">      C.Insns += (C.NumRegs - PrevNumRegs);</Highlight></CodeLine>
<Link id="l01579" /><CodeLine lineNumber="1579"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01580" /><CodeLine lineNumber="1580"><Highlight kind="normal">      C.Insns += (C.NumRegs - TTIRegNum);</Highlight></CodeLine>
<Link id="l01581" /><CodeLine lineNumber="1581"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01582" /><CodeLine lineNumber="1582"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01583" /><CodeLine lineNumber="1583"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If ICmpZero formula ends with not 0, it could not be replaced by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01584" /><CodeLine lineNumber="1584"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// just add or sub. We&#39;ll need to compare final result of AddRec.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01585" /><CodeLine lineNumber="1585"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// That means we&#39;ll need an additional instruction. But if the target can</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01586" /><CodeLine lineNumber="1586"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// macro-fuse a compare with a branch, don&#39;t count this extra instruction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01587" /><CodeLine lineNumber="1587"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// For -10 + &#123;0, +, 1&#125;:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01588" /><CodeLine lineNumber="1588"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// i = i + 1;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01589" /><CodeLine lineNumber="1589"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// cmp i, 10</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01590" /><CodeLine lineNumber="1590"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01591" /><CodeLine lineNumber="1591"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// For &#123;-10, +, 1&#125;:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01592" /><CodeLine lineNumber="1592"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// i = i + 1;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01593" /><CodeLine lineNumber="1593"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> &amp;&amp; !<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasZeroEnd() &amp;&amp;</Highlight></CodeLine>
<Link id="l01594" /><CodeLine lineNumber="1594"><Highlight kind="normal">      !TTI-&gt;canMacroFuseCmp())</Highlight></CodeLine>
<Link id="l01595" /><CodeLine lineNumber="1595"><Highlight kind="normal">    C.Insns++;</Highlight></CodeLine>
<Link id="l01596" /><CodeLine lineNumber="1596"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Each new AddRec adds 1 instruction to calculation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01597" /><CodeLine lineNumber="1597"><Highlight kind="normal">  C.Insns += (C.AddRecCost - PrevAddRecCost);</Highlight></CodeLine>
<Link id="l01598" /><CodeLine lineNumber="1598"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01599" /><CodeLine lineNumber="1599"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// BaseAdds adds instructions for unfolded registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01600" /><CodeLine lineNumber="1600"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>)</Highlight></CodeLine>
<Link id="l01601" /><CodeLine lineNumber="1601"><Highlight kind="normal">    C.Insns += C.NumBaseAdds - PrevNumBaseAdds;</Highlight></CodeLine>
<Link id="l01602" /><CodeLine lineNumber="1602"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/instructioncost/#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;invalid cost&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01603" /><CodeLine lineNumber="1603"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01604" /><CodeLine lineNumber="1604"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01605" /><CodeLine lineNumber="1605"><Highlight kind="comment">/// Set this cost to a losing value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01606" /><CodeLine lineNumber="1606" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad3242d77b21293a7423564fc64997620"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> Cost::Lose() &#123;</Highlight></CodeLine>
<Link id="l01607" /><CodeLine lineNumber="1607"><Highlight kind="normal">  C.Insns = std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l01608" /><CodeLine lineNumber="1608"><Highlight kind="normal">  C.NumRegs = std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l01609" /><CodeLine lineNumber="1609"><Highlight kind="normal">  C.AddRecCost = std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l01610" /><CodeLine lineNumber="1610"><Highlight kind="normal">  C.NumIVMuls = std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l01611" /><CodeLine lineNumber="1611"><Highlight kind="normal">  C.NumBaseAdds = std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l01612" /><CodeLine lineNumber="1612"><Highlight kind="normal">  C.ImmCost = std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l01613" /><CodeLine lineNumber="1613"><Highlight kind="normal">  C.SetupCost = std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l01614" /><CodeLine lineNumber="1614"><Highlight kind="normal">  C.ScaleCost = std::numeric&#95;limits&lt;unsigned&gt;::max();</Highlight></CodeLine>
<Link id="l01615" /><CodeLine lineNumber="1615"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01616" /><CodeLine lineNumber="1616"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01617" /><CodeLine lineNumber="1617"><Highlight kind="comment">/// Choose the lower cost.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01618" /><CodeLine lineNumber="1618" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a60988944a715f927e4c1210fe049f3fa"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Cost::isLess(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad60603979ceadc6c0b683403e7131646">Cost</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01619" /><CodeLine lineNumber="1619"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a>.getNumOccurrences() &gt; 0 &amp;&amp; <a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l01620" /><CodeLine lineNumber="1620"><Highlight kind="normal">      C.Insns != <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.C.Insns)</Highlight></CodeLine>
<Link id="l01621" /><CodeLine lineNumber="1621"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> C.Insns &lt; <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.C.Insns;</Highlight></CodeLine>
<Link id="l01622" /><CodeLine lineNumber="1622"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> TTI-&gt;isLSRCostLess(C, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.C);</Highlight></CodeLine>
<Link id="l01623" /><CodeLine lineNumber="1623"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01624" /><CodeLine lineNumber="1624"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01625" /><CodeLine lineNumber="1625"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01626" /><CodeLine lineNumber="1626"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/instructioncost/#a7a0b7d0565cbdb80fcc368365bf86c9c">Cost::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01627" /><CodeLine lineNumber="1627"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a>)</Highlight></CodeLine>
<Link id="l01628" /><CodeLine lineNumber="1628"><Highlight kind="normal">    OS &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.Insns &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; instruction&quot;</Highlight><Highlight kind="normal"> &lt;&lt; (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.Insns == 1 ? </Highlight><Highlight kind="stringliteral">&quot; &quot;</Highlight><Highlight kind="normal"> : </Highlight><Highlight kind="stringliteral">&quot;s &quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01629" /><CodeLine lineNumber="1629"><Highlight kind="normal">  OS &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumRegs &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; reg&quot;</Highlight><Highlight kind="normal"> &lt;&lt; (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumRegs == 1 ? </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal"> : </Highlight><Highlight kind="stringliteral">&quot;s&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01630" /><CodeLine lineNumber="1630"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.AddRecCost != 0)</Highlight></CodeLine>
<Link id="l01631" /><CodeLine lineNumber="1631"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, with addrec cost &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.AddRecCost;</Highlight></CodeLine>
<Link id="l01632" /><CodeLine lineNumber="1632"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumIVMuls != 0)</Highlight></CodeLine>
<Link id="l01633" /><CodeLine lineNumber="1633"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, plus &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumIVMuls &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; IV mul&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01634" /><CodeLine lineNumber="1634"><Highlight kind="normal">       &lt;&lt; (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumIVMuls == 1 ? </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal"> : </Highlight><Highlight kind="stringliteral">&quot;s&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01635" /><CodeLine lineNumber="1635"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumBaseAdds != 0)</Highlight></CodeLine>
<Link id="l01636" /><CodeLine lineNumber="1636"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, plus &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumBaseAdds &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; base add&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01637" /><CodeLine lineNumber="1637"><Highlight kind="normal">       &lt;&lt; (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumBaseAdds == 1 ? </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal"> : </Highlight><Highlight kind="stringliteral">&quot;s&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01638" /><CodeLine lineNumber="1638"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.ScaleCost != 0)</Highlight></CodeLine>
<Link id="l01639" /><CodeLine lineNumber="1639"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, plus &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.ScaleCost &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; scale cost&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01640" /><CodeLine lineNumber="1640"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.ImmCost != 0)</Highlight></CodeLine>
<Link id="l01641" /><CodeLine lineNumber="1641"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, plus &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.ImmCost &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; imm cost&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01642" /><CodeLine lineNumber="1642"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost != 0)</Highlight></CodeLine>
<Link id="l01643" /><CodeLine lineNumber="1643"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, plus &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; setup cost&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01644" /><CodeLine lineNumber="1644"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01645" /><CodeLine lineNumber="1645"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01646" /><CodeLine lineNumber="1646" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ab9ff5264fbc3faf5b26768f683a43e59"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> Cost::dump()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01647" /><CodeLine lineNumber="1647"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instructioncost/#a7a0b7d0565cbdb80fcc368365bf86c9c">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01648" /><CodeLine lineNumber="1648"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01649" /><CodeLine lineNumber="1649"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01650" /><CodeLine lineNumber="1650"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01651" /><CodeLine lineNumber="1651"><Highlight kind="comment">/// Test whether this fixup always uses its value outside of the given loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01652" /><CodeLine lineNumber="1652" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ab5814e2a785fccd6bdcfccc78286fc10"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ab5814e2a785fccd6bdcfccc78286fc10">LSRFixup::isUseFullyOutsideLoop</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01653" /><CodeLine lineNumber="1653"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// PHI nodes use their value in their incoming blocks.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01654" /><CodeLine lineNumber="1654"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>)) &#123;</Highlight></CodeLine>
<Link id="l01655" /><CodeLine lineNumber="1655"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> i = 0, e = PN-&gt;getNumIncomingValues(); i != e; ++i)</Highlight></CodeLine>
<Link id="l01656" /><CodeLine lineNumber="1656"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PN-&gt;getIncomingValue(i) == <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a2ee07fa1e186cc7e152f3e5ed2a1c3cc">OperandValToReplace</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l01657" /><CodeLine lineNumber="1657"><Highlight kind="normal">          L-&gt;contains(PN-&gt;getIncomingBlock(i)))</Highlight></CodeLine>
<Link id="l01658" /><CodeLine lineNumber="1658"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01659" /><CodeLine lineNumber="1659"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01660" /><CodeLine lineNumber="1660"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01661" /><CodeLine lineNumber="1661"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01662" /><CodeLine lineNumber="1662"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> !L-&gt;contains(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>);</Highlight></CodeLine>
<Link id="l01663" /><CodeLine lineNumber="1663"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01664" /><CodeLine lineNumber="1664"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01665" /><CodeLine lineNumber="1665"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01666" /><CodeLine lineNumber="1666" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#aa7f24a759cb17285abd90cfa12e030c1"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#aa7f24a759cb17285abd90cfa12e030c1">LSRFixup::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01667" /><CodeLine lineNumber="1667"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;UserInst=&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01668" /><CodeLine lineNumber="1668"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Store is common and interesting enough to be worth special-casing.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01669" /><CodeLine lineNumber="1669"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/storeinst">StoreInst</a> &#42;Store = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StoreInst&gt;</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>)) &#123;</Highlight></CodeLine>
<Link id="l01670" /><CodeLine lineNumber="1670"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;store &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01671" /><CodeLine lineNumber="1671"><Highlight kind="normal">    Store-&gt;getOperand(0)-&gt;printAsOperand(OS, </Highlight><Highlight kind="comment">/&#42;PrintType=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01672" /><CodeLine lineNumber="1672"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>-&gt;getType()-&gt;isVoidTy())</Highlight></CodeLine>
<Link id="l01673" /><CodeLine lineNumber="1673"><Highlight kind="normal">    OS &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>-&gt;getOpcodeName();</Highlight></CodeLine>
<Link id="l01674" /><CodeLine lineNumber="1674"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01675" /><CodeLine lineNumber="1675"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>-&gt;printAsOperand(OS, </Highlight><Highlight kind="comment">/&#42;PrintType=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01676" /><CodeLine lineNumber="1676"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01677" /><CodeLine lineNumber="1677"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, OperandValToReplace=&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01678" /><CodeLine lineNumber="1678"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a2ee07fa1e186cc7e152f3e5ed2a1c3cc">OperandValToReplace</a>-&gt;printAsOperand(OS, </Highlight><Highlight kind="comment">/&#42;PrintType=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01679" /><CodeLine lineNumber="1679"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01680" /><CodeLine lineNumber="1680"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;PIL : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a70aa44719a26fecd9a48e86edcb69b51">PostIncLoops</a>) &#123;</Highlight></CodeLine>
<Link id="l01681" /><CodeLine lineNumber="1681"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, PostIncLoop=&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01682" /><CodeLine lineNumber="1682"><Highlight kind="normal">    PIL-&gt;getHeader()-&gt;printAsOperand(OS, </Highlight><Highlight kind="comment">/&#42;PrintType=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01683" /><CodeLine lineNumber="1683"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01684" /><CodeLine lineNumber="1684"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01685" /><CodeLine lineNumber="1685"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a6d9b5bf6278b280c61b1c37375cad241">Offset</a>.isNonZero())</Highlight></CodeLine>
<Link id="l01686" /><CodeLine lineNumber="1686"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, Offset=&quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a6d9b5bf6278b280c61b1c37375cad241">Offset</a>;</Highlight></CodeLine>
<Link id="l01687" /><CodeLine lineNumber="1687"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01688" /><CodeLine lineNumber="1688"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01689" /><CodeLine lineNumber="1689" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a17103d1dadfcbedb1b4455345d844dc1"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a17103d1dadfcbedb1b4455345d844dc1">LSRFixup::dump</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01690" /><CodeLine lineNumber="1690"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01691" /><CodeLine lineNumber="1691"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01692" /><CodeLine lineNumber="1692"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01693" /><CodeLine lineNumber="1693"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01694" /><CodeLine lineNumber="1694"><Highlight kind="comment">/// Test whether this use as a formula which has the same registers as the given</Highlight></CodeLine>
<Link id="l01695" /><CodeLine lineNumber="1695"><Highlight kind="comment">/// formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01696" /><CodeLine lineNumber="1696" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a389c4d3c542f309b3ad61e8966fb930a"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a389c4d3c542f309b3ad61e8966fb930a">LSRUse::HasFormulaWithSameRegs</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01697" /><CodeLine lineNumber="1697"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs;</Highlight></CodeLine>
<Link id="l01698" /><CodeLine lineNumber="1698"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>.push&#95;back(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</Highlight></CodeLine>
<Link id="l01699" /><CodeLine lineNumber="1699"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Unstable sort by host order ok, because this is only used for uniquifying.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01700" /><CodeLine lineNumber="1700"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>);</Highlight></CodeLine>
<Link id="l01701" /><CodeLine lineNumber="1701"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Uniquifier.count(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>);</Highlight></CodeLine>
<Link id="l01702" /><CodeLine lineNumber="1702"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01703" /><CodeLine lineNumber="1703"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01704" /><CodeLine lineNumber="1704"><Highlight kind="comment">/// The function returns a probability of selecting formula without Reg.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01705" /><CodeLine lineNumber="1705" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a99ba1cdbe93816bffc94d88e85b97de7"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a99ba1cdbe93816bffc94d88e85b97de7">LSRUse::getNotSelectedProbability</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01706" /><CodeLine lineNumber="1706"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> FNum = 0;</Highlight></CodeLine>
<Link id="l01707" /><CodeLine lineNumber="1707"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>)</Highlight></CodeLine>
<Link id="l01708" /><CodeLine lineNumber="1708"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.referencesReg(Reg))</Highlight></CodeLine>
<Link id="l01709" /><CodeLine lineNumber="1709"><Highlight kind="normal">      FNum++;</Highlight></CodeLine>
<Link id="l01710" /><CodeLine lineNumber="1710"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ((</Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal">)(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.size() - FNum)) / <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.size();</Highlight></CodeLine>
<Link id="l01711" /><CodeLine lineNumber="1711"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01712" /><CodeLine lineNumber="1712"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01713" /><CodeLine lineNumber="1713"><Highlight kind="comment">/// If the given formula has not yet been inserted, add it to the list, and</Highlight></CodeLine>
<Link id="l01714" /><CodeLine lineNumber="1714"><Highlight kind="comment">/// return true. Return false otherwise.  The formula must be in canonical form.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01715" /><CodeLine lineNumber="1715" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ab2507970e8b86d818892ad183328b450"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ab2507970e8b86d818892ad183328b450">LSRUse::InsertFormula</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</Highlight></CodeLine>
<Link id="l01716" /><CodeLine lineNumber="1716"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isCanonical(L) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Invalid canonical representation&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01717" /><CodeLine lineNumber="1717"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01718" /><CodeLine lineNumber="1718"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.empty() &amp;&amp; <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aa45af5caf29ddb4040ef123166ba800a">RigidFormula</a>)</Highlight></CodeLine>
<Link id="l01719" /><CodeLine lineNumber="1719"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01720" /><CodeLine lineNumber="1720"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01721" /><CodeLine lineNumber="1721"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs;</Highlight></CodeLine>
<Link id="l01722" /><CodeLine lineNumber="1722"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>.push&#95;back(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</Highlight></CodeLine>
<Link id="l01723" /><CodeLine lineNumber="1723"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Unstable sort by host order ok, because this is only used for uniquifying.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01724" /><CodeLine lineNumber="1724"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>);</Highlight></CodeLine>
<Link id="l01725" /><CodeLine lineNumber="1725"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01726" /><CodeLine lineNumber="1726"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Uniquifier.insert(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>).second)</Highlight></CodeLine>
<Link id="l01727" /><CodeLine lineNumber="1727"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01728" /><CodeLine lineNumber="1728"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01729" /><CodeLine lineNumber="1729"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Using a register to hold the value of 0 is not profitable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01730" /><CodeLine lineNumber="1730"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg || !<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg-&gt;isZero()) &amp;&amp;</Highlight></CodeLine>
<Link id="l01731" /><CodeLine lineNumber="1731"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Zero allocated in a scaled register!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01732" /><CodeLine lineNumber="1732"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01733" /><CodeLine lineNumber="1733"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs)</Highlight></CodeLine>
<Link id="l01734" /><CodeLine lineNumber="1734"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!BaseReg-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Zero allocated in a base register!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01735" /><CodeLine lineNumber="1735"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01736" /><CodeLine lineNumber="1736"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01737" /><CodeLine lineNumber="1737"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add the formula to the list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01738" /><CodeLine lineNumber="1738"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.push&#95;back(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l01739" /><CodeLine lineNumber="1739"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01740" /><CodeLine lineNumber="1740"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Record registers now being used by this use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01741" /><CodeLine lineNumber="1741"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.end());</Highlight></CodeLine>
<Link id="l01742" /><CodeLine lineNumber="1742"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg)</Highlight></CodeLine>
<Link id="l01743" /><CodeLine lineNumber="1743"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</Highlight></CodeLine>
<Link id="l01744" /><CodeLine lineNumber="1744"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01745" /><CodeLine lineNumber="1745"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01746" /><CodeLine lineNumber="1746"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01747" /><CodeLine lineNumber="1747"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01748" /><CodeLine lineNumber="1748"><Highlight kind="comment">/// Remove the given formula from this use&#39;s list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01749" /><CodeLine lineNumber="1749" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#abc6f1cb20b27dcacac8a3ca73baf84df"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#abc6f1cb20b27dcacac8a3ca73baf84df">LSRUse::DeleteFormula</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</Highlight></CodeLine>
<Link id="l01750" /><CodeLine lineNumber="1750"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> != &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.back())</Highlight></CodeLine>
<Link id="l01751" /><CodeLine lineNumber="1751"><Highlight kind="normal">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.back());</Highlight></CodeLine>
<Link id="l01752" /><CodeLine lineNumber="1752"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.pop&#95;back();</Highlight></CodeLine>
<Link id="l01753" /><CodeLine lineNumber="1753"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01754" /><CodeLine lineNumber="1754"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01755" /><CodeLine lineNumber="1755"><Highlight kind="comment">/// Recompute the Regs field, and update RegUses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01756" /><CodeLine lineNumber="1756" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ae5e9a6e4934a1c3f5194b6940b9b85fc"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ae5e9a6e4934a1c3f5194b6940b9b85fc">LSRUse::RecomputeRegs</a>(</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &amp;RegUses) &#123;</Highlight></CodeLine>
<Link id="l01757" /><CodeLine lineNumber="1757"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Now that we&#39;ve filtered out some formulae, recompute the Regs set.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01758" /><CodeLine lineNumber="1758"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 4&gt;</a> OldRegs = std::move(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>);</Highlight></CodeLine>
<Link id="l01759" /><CodeLine lineNumber="1759"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.clear();</Highlight></CodeLine>
<Link id="l01760" /><CodeLine lineNumber="1760"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>) &#123;</Highlight></CodeLine>
<Link id="l01761" /><CodeLine lineNumber="1761"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</Highlight></CodeLine>
<Link id="l01762" /><CodeLine lineNumber="1762"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.end());</Highlight></CodeLine>
<Link id="l01763" /><CodeLine lineNumber="1763"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01764" /><CodeLine lineNumber="1764"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01765" /><CodeLine lineNumber="1765"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update the RegTracker.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01766" /><CodeLine lineNumber="1766"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : OldRegs)</Highlight></CodeLine>
<Link id="l01767" /><CodeLine lineNumber="1767"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.count(S))</Highlight></CodeLine>
<Link id="l01768" /><CodeLine lineNumber="1768"><Highlight kind="normal">      RegUses.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a6a56d58ef201c3111c594b541bfef549">dropRegister</a>(S, LUIdx);</Highlight></CodeLine>
<Link id="l01769" /><CodeLine lineNumber="1769"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01770" /><CodeLine lineNumber="1770"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01771" /><CodeLine lineNumber="1771"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01772" /><CodeLine lineNumber="1772" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a223ebe6602a0309788a0c3906a683175"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a223ebe6602a0309788a0c3906a683175">LSRUse::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01773" /><CodeLine lineNumber="1773"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;LSR Use: Kind=&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01774" /><CodeLine lineNumber="1774"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af414d3b8902f3db57e9f08d3232fc17c">Kind</a>) &#123;</Highlight></CodeLine>
<Link id="l01775" /><CodeLine lineNumber="1775"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">Basic</a>:    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Basic&quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01776" /><CodeLine lineNumber="1776"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">Special</a>:  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Special&quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01777" /><CodeLine lineNumber="1777"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">ICmpZero</a>: OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;ICmpZero&quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01778" /><CodeLine lineNumber="1778"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">Address</a>:</Highlight></CodeLine>
<Link id="l01779" /><CodeLine lineNumber="1779"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Address of &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01780" /><CodeLine lineNumber="1780"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>.MemTy-&gt;isPointerTy())</Highlight></CodeLine>
<Link id="l01781" /><CodeLine lineNumber="1781"><Highlight kind="normal">      OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;pointer&quot;</Highlight><Highlight kind="normal">; </Highlight><Highlight kind="comment">// the full pointer type could be really verbose</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01782" /><CodeLine lineNumber="1782"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l01783" /><CodeLine lineNumber="1783"><Highlight kind="normal">      OS &lt;&lt; &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>.MemTy;</Highlight></CodeLine>
<Link id="l01784" /><CodeLine lineNumber="1784"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01785" /><CodeLine lineNumber="1785"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01786" /><CodeLine lineNumber="1786"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; in addrspace(&quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>.AddrSpace &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;)&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01787" /><CodeLine lineNumber="1787"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01788" /><CodeLine lineNumber="1788"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01789" /><CodeLine lineNumber="1789"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, Offsets=&#123;&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01790" /><CodeLine lineNumber="1790"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> NeedComma = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01791" /><CodeLine lineNumber="1791"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>) &#123;</Highlight></CodeLine>
<Link id="l01792" /><CodeLine lineNumber="1792"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NeedComma) OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;,&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01793" /><CodeLine lineNumber="1793"><Highlight kind="normal">    OS &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset;</Highlight></CodeLine>
<Link id="l01794" /><CodeLine lineNumber="1794"><Highlight kind="normal">    NeedComma = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01795" /><CodeLine lineNumber="1795"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01796" /><CodeLine lineNumber="1796"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;&#125;&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01797" /><CodeLine lineNumber="1797"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01798" /><CodeLine lineNumber="1798"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aac7deb997535d3d9a445dd87bd0f2192">AllFixupsOutsideLoop</a>)</Highlight></CodeLine>
<Link id="l01799" /><CodeLine lineNumber="1799"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, all-fixups-outside-loop&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01800" /><CodeLine lineNumber="1800"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01801" /><CodeLine lineNumber="1801"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ac6eb6d8e22eb1da2d816c5cb38fe166d">WidestFixupType</a>)</Highlight></CodeLine>
<Link id="l01802" /><CodeLine lineNumber="1802"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, widest fixup type: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ac6eb6d8e22eb1da2d816c5cb38fe166d">WidestFixupType</a>;</Highlight></CodeLine>
<Link id="l01803" /><CodeLine lineNumber="1803"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01804" /><CodeLine lineNumber="1804"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01805" /><CodeLine lineNumber="1805" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af5eebe76701b28ce106d5ffd86fbcc27"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af5eebe76701b28ce106d5ffd86fbcc27">LSRUse::dump</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l01806" /><CodeLine lineNumber="1806"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01807" /><CodeLine lineNumber="1807"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01808" /><CodeLine lineNumber="1808"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01809" /><CodeLine lineNumber="1809"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01810" /><CodeLine lineNumber="1810" lineLink="#a07e234e9b040a89b10635c52640987c9"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01811" /><CodeLine lineNumber="1811"><Highlight kind="normal">                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy,</Highlight></CodeLine>
<Link id="l01812" /><CodeLine lineNumber="1812"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV, Immediate BaseOffset,</Highlight></CodeLine>
<Link id="l01813" /><CodeLine lineNumber="1813"><Highlight kind="normal">                                 </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasBaseReg, int64&#95;t Scale,</Highlight></CodeLine>
<Link id="l01814" /><CodeLine lineNumber="1814"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> </Highlight><Highlight kind="comment">/&#42; = nullptr &#42;/</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l01815" /><CodeLine lineNumber="1815"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (Kind) &#123;</Highlight></CodeLine>
<Link id="l01816" /><CodeLine lineNumber="1816"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>: &#123;</Highlight></CodeLine>
<Link id="l01817" /><CodeLine lineNumber="1817"><Highlight kind="normal">    int64&#95;t FixedOffset =</Highlight></CodeLine>
<Link id="l01818" /><CodeLine lineNumber="1818"><Highlight kind="normal">        BaseOffset.isScalable() ? 0 : BaseOffset.getFixedValue();</Highlight></CodeLine>
<Link id="l01819" /><CodeLine lineNumber="1819"><Highlight kind="normal">    int64&#95;t ScalableOffset =</Highlight></CodeLine>
<Link id="l01820" /><CodeLine lineNumber="1820"><Highlight kind="normal">        BaseOffset.isScalable() ? BaseOffset.getKnownMinValue() : 0;</Highlight></CodeLine>
<Link id="l01821" /><CodeLine lineNumber="1821"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(AccessTy.MemTy, BaseGV, FixedOffset,</Highlight></CodeLine>
<Link id="l01822" /><CodeLine lineNumber="1822"><Highlight kind="normal">                                     HasBaseReg, Scale, AccessTy.AddrSpace,</Highlight></CodeLine>
<Link id="l01823" /><CodeLine lineNumber="1823"><Highlight kind="normal">                                     <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>, ScalableOffset);</Highlight></CodeLine>
<Link id="l01824" /><CodeLine lineNumber="1824"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01825" /><CodeLine lineNumber="1825"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>:</Highlight></CodeLine>
<Link id="l01826" /><CodeLine lineNumber="1826"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// There&#39;s not even a target hook for querying whether it would be legal to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01827" /><CodeLine lineNumber="1827"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// fold a GV into an ICmp.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01828" /><CodeLine lineNumber="1828"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseGV)</Highlight></CodeLine>
<Link id="l01829" /><CodeLine lineNumber="1829"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01830" /><CodeLine lineNumber="1830"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01831" /><CodeLine lineNumber="1831"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ICmp only has two operands; don&#39;t allow more than two non-trivial parts.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01832" /><CodeLine lineNumber="1832"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Scale != 0 &amp;&amp; HasBaseReg &amp;&amp; BaseOffset.isNonZero())</Highlight></CodeLine>
<Link id="l01833" /><CodeLine lineNumber="1833"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01834" /><CodeLine lineNumber="1834"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01835" /><CodeLine lineNumber="1835"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ICmp only supports no scale or a -1 scale, as we can &quot;fold&quot; a -1 scale by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01836" /><CodeLine lineNumber="1836"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// putting the scaled register in the other operand of the icmp.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01837" /><CodeLine lineNumber="1837"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Scale != 0 &amp;&amp; Scale != -1)</Highlight></CodeLine>
<Link id="l01838" /><CodeLine lineNumber="1838"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01839" /><CodeLine lineNumber="1839"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01840" /><CodeLine lineNumber="1840"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If we have low-level target information, ask the target if it can fold an</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01841" /><CodeLine lineNumber="1841"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// integer immediate on an icmp.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01842" /><CodeLine lineNumber="1842"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseOffset.isNonZero()) &#123;</Highlight></CodeLine>
<Link id="l01843" /><CodeLine lineNumber="1843"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// We don&#39;t have an interface to query whether the target supports</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01844" /><CodeLine lineNumber="1844"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// icmpzero against scalable quantities yet.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01845" /><CodeLine lineNumber="1845"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseOffset.isScalable())</Highlight></CodeLine>
<Link id="l01846" /><CodeLine lineNumber="1846"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01847" /><CodeLine lineNumber="1847"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01848" /><CodeLine lineNumber="1848"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// We have one of:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01849" /><CodeLine lineNumber="1849"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// ICmpZero     BaseReg + BaseOffset =&gt; ICmp BaseReg, -BaseOffset</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01850" /><CodeLine lineNumber="1850"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// ICmpZero -1&#42;ScaleReg + BaseOffset =&gt; ICmp ScaleReg, BaseOffset</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01851" /><CodeLine lineNumber="1851"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Offs is the ICmp immediate.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01852" /><CodeLine lineNumber="1852"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Scale == 0)</Highlight></CodeLine>
<Link id="l01853" /><CodeLine lineNumber="1853"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// The cast does the right thing with</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01854" /><CodeLine lineNumber="1854"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// std::numeric&#95;limits&lt;int64&#95;t&gt;::min().</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01855" /><CodeLine lineNumber="1855"><Highlight kind="normal">        BaseOffset = BaseOffset.getFixed(-(uint64&#95;t)BaseOffset.getFixedValue());</Highlight></CodeLine>
<Link id="l01856" /><CodeLine lineNumber="1856"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalICmpImmediate(BaseOffset.getFixedValue());</Highlight></CodeLine>
<Link id="l01857" /><CodeLine lineNumber="1857"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01858" /><CodeLine lineNumber="1858"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01859" /><CodeLine lineNumber="1859"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ICmpZero BaseReg + -1&#42;ScaleReg =&gt; ICmp BaseReg, ScaleReg</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01860" /><CodeLine lineNumber="1860"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01861" /><CodeLine lineNumber="1861"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01862" /><CodeLine lineNumber="1862"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a>:</Highlight></CodeLine>
<Link id="l01863" /><CodeLine lineNumber="1863"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Only handle single-register values.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01864" /><CodeLine lineNumber="1864"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> !BaseGV &amp;&amp; Scale == 0 &amp;&amp; BaseOffset.isZero();</Highlight></CodeLine>
<Link id="l01865" /><CodeLine lineNumber="1865"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01866" /><CodeLine lineNumber="1866"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">LSRUse::Special</a>:</Highlight></CodeLine>
<Link id="l01867" /><CodeLine lineNumber="1867"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Special case Basic to handle -1 scales.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01868" /><CodeLine lineNumber="1868"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> !BaseGV &amp;&amp; (Scale == 0 || Scale == -1) &amp;&amp; BaseOffset.isZero();</Highlight></CodeLine>
<Link id="l01869" /><CodeLine lineNumber="1869"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01870" /><CodeLine lineNumber="1870"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01871" /><CodeLine lineNumber="1871"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Invalid LSRUse Kind!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01872" /><CodeLine lineNumber="1872"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01873" /><CodeLine lineNumber="1873"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01874" /><CodeLine lineNumber="1874" lineLink="#a111eaa1963537539371757fda03a8d07"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01875" /><CodeLine lineNumber="1875"><Highlight kind="normal">                                 Immediate MinOffset, Immediate MaxOffset,</Highlight></CodeLine>
<Link id="l01876" /><CodeLine lineNumber="1876"><Highlight kind="normal">                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy,</Highlight></CodeLine>
<Link id="l01877" /><CodeLine lineNumber="1877"><Highlight kind="normal">                                 <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV, Immediate BaseOffset,</Highlight></CodeLine>
<Link id="l01878" /><CodeLine lineNumber="1878"><Highlight kind="normal">                                 </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasBaseReg, int64&#95;t Scale) &#123;</Highlight></CodeLine>
<Link id="l01879" /><CodeLine lineNumber="1879"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseOffset.isNonZero() &amp;&amp;</Highlight></CodeLine>
<Link id="l01880" /><CodeLine lineNumber="1880"><Highlight kind="normal">      (BaseOffset.isScalable() != MinOffset.isScalable() ||</Highlight></CodeLine>
<Link id="l01881" /><CodeLine lineNumber="1881"><Highlight kind="normal">       BaseOffset.isScalable() != MaxOffset.isScalable()))</Highlight></CodeLine>
<Link id="l01882" /><CodeLine lineNumber="1882"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01883" /><CodeLine lineNumber="1883"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check for overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01884" /><CodeLine lineNumber="1884"><Highlight kind="normal">  int64&#95;t <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = BaseOffset.getKnownMinValue();</Highlight></CodeLine>
<Link id="l01885" /><CodeLine lineNumber="1885"><Highlight kind="normal">  int64&#95;t Min = MinOffset.getKnownMinValue();</Highlight></CodeLine>
<Link id="l01886" /><CodeLine lineNumber="1886"><Highlight kind="normal">  int64&#95;t Max = MaxOffset.getKnownMinValue();</Highlight></CodeLine>
<Link id="l01887" /><CodeLine lineNumber="1887"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (((int64&#95;t)((uint64&#95;t)<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> + Min) &gt; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) != (Min &gt; 0))</Highlight></CodeLine>
<Link id="l01888" /><CodeLine lineNumber="1888"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01889" /><CodeLine lineNumber="1889"><Highlight kind="normal">  MinOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341">Immediate::get</a>((uint64&#95;t)<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> + Min, MinOffset.isScalable());</Highlight></CodeLine>
<Link id="l01890" /><CodeLine lineNumber="1890"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (((int64&#95;t)((uint64&#95;t)<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> + Max) &gt; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) != (Max &gt; 0))</Highlight></CodeLine>
<Link id="l01891" /><CodeLine lineNumber="1891"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01892" /><CodeLine lineNumber="1892"><Highlight kind="normal">  MaxOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341">Immediate::get</a>((uint64&#95;t)<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> + Max, MaxOffset.isScalable());</Highlight></CodeLine>
<Link id="l01893" /><CodeLine lineNumber="1893"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01894" /><CodeLine lineNumber="1894"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, AccessTy, BaseGV, MinOffset,</Highlight></CodeLine>
<Link id="l01895" /><CodeLine lineNumber="1895"><Highlight kind="normal">                              HasBaseReg, Scale) &amp;&amp;</Highlight></CodeLine>
<Link id="l01896" /><CodeLine lineNumber="1896"><Highlight kind="normal">         <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, AccessTy, BaseGV, MaxOffset,</Highlight></CodeLine>
<Link id="l01897" /><CodeLine lineNumber="1897"><Highlight kind="normal">                              HasBaseReg, Scale);</Highlight></CodeLine>
<Link id="l01898" /><CodeLine lineNumber="1898"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01899" /><CodeLine lineNumber="1899"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01900" /><CodeLine lineNumber="1900" lineLink="#aa4449f10e66ebab87164f4bf5bfd67d9"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01901" /><CodeLine lineNumber="1901"><Highlight kind="normal">                                 Immediate MinOffset, Immediate MaxOffset,</Highlight></CodeLine>
<Link id="l01902" /><CodeLine lineNumber="1902"><Highlight kind="normal">                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy,</Highlight></CodeLine>
<Link id="l01903" /><CodeLine lineNumber="1903"><Highlight kind="normal">                                 </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</Highlight></CodeLine>
<Link id="l01904" /><CodeLine lineNumber="1904"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// For the purpose of isAMCompletelyFolded either having a canonical formula</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01905" /><CodeLine lineNumber="1905"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// or a scale not equal to zero is correct.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01906" /><CodeLine lineNumber="1906"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Problems may arise from non canonical formulae having a scale == 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01907" /><CodeLine lineNumber="1907"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Strictly speaking it would best to just rely on canonical formulae.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01908" /><CodeLine lineNumber="1908"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// However, when we generate the scaled formulae, we first check that the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01909" /><CodeLine lineNumber="1909"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// scaling factor is profitable before computing the actual ScaledReg for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01910" /><CodeLine lineNumber="1910"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// compile time sake.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01911" /><CodeLine lineNumber="1911"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isCanonical(L) || <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 0));</Highlight></CodeLine>
<Link id="l01912" /><CodeLine lineNumber="1912"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy,</Highlight></CodeLine>
<Link id="l01913" /><CodeLine lineNumber="1913"><Highlight kind="normal">                              <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale);</Highlight></CodeLine>
<Link id="l01914" /><CodeLine lineNumber="1914"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01915" /><CodeLine lineNumber="1915"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l01916" /><CodeLine lineNumber="1916"><Highlight kind="comment">/// Test whether we know how to expand the current formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01917" /><CodeLine lineNumber="1917" lineLink="#a2e520a15f4578a464f9caaac2f4758ae"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Immediate MinOffset,</Highlight></CodeLine>
<Link id="l01918" /><CodeLine lineNumber="1918"><Highlight kind="normal">                       Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</Highlight></CodeLine>
<Link id="l01919" /><CodeLine lineNumber="1919"><Highlight kind="normal">                       MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV,</Highlight></CodeLine>
<Link id="l01920" /><CodeLine lineNumber="1920"><Highlight kind="normal">                       Immediate BaseOffset, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasBaseReg, int64&#95;t Scale) &#123;</Highlight></CodeLine>
<Link id="l01921" /><CodeLine lineNumber="1921"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We know how to expand completely foldable formulae.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01922" /><CodeLine lineNumber="1922"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy, BaseGV,</Highlight></CodeLine>
<Link id="l01923" /><CodeLine lineNumber="1923"><Highlight kind="normal">                              BaseOffset, HasBaseReg, Scale) ||</Highlight></CodeLine>
<Link id="l01924" /><CodeLine lineNumber="1924"><Highlight kind="normal">         </Highlight><Highlight kind="comment">// Or formulae that use a base register produced by a sum of base</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01925" /><CodeLine lineNumber="1925"><Highlight kind="normal">         </Highlight><Highlight kind="comment">// registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01926" /><CodeLine lineNumber="1926"><Highlight kind="normal">         (Scale == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l01927" /><CodeLine lineNumber="1927"><Highlight kind="normal">          <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy,</Highlight></CodeLine>
<Link id="l01928" /><CodeLine lineNumber="1928"><Highlight kind="normal">                               BaseGV, BaseOffset, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, 0));</Highlight></CodeLine>
<Link id="l01929" /><CodeLine lineNumber="1929"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01930" /><CodeLine lineNumber="1930"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01931" /><CodeLine lineNumber="1931" lineLink="#a0cde97c20a134a57a746859698291aaa"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Immediate MinOffset,</Highlight></CodeLine>
<Link id="l01932" /><CodeLine lineNumber="1932"><Highlight kind="normal">                       Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</Highlight></CodeLine>
<Link id="l01933" /><CodeLine lineNumber="1933"><Highlight kind="normal">                       MemAccessTy AccessTy, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</Highlight></CodeLine>
<Link id="l01934" /><CodeLine lineNumber="1934"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV,</Highlight></CodeLine>
<Link id="l01935" /><CodeLine lineNumber="1935"><Highlight kind="normal">                    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale);</Highlight></CodeLine>
<Link id="l01936" /><CodeLine lineNumber="1936"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01937" /><CodeLine lineNumber="1937"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01938" /><CodeLine lineNumber="1938" lineLink="#a52f2bc4870549427a397721a7de9849f"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a52f2bc4870549427a397721a7de9849f">isLegalAddImmediate</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01939" /><CodeLine lineNumber="1939"><Highlight kind="normal">                                Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &#123;</Highlight></CodeLine>
<Link id="l01940" /><CodeLine lineNumber="1940"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isScalable())</Highlight></CodeLine>
<Link id="l01941" /><CodeLine lineNumber="1941"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddScalableImmediate(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getKnownMinValue());</Highlight></CodeLine>
<Link id="l01942" /><CodeLine lineNumber="1942"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01943" /><CodeLine lineNumber="1943"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddImmediate(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue());</Highlight></CodeLine>
<Link id="l01944" /><CodeLine lineNumber="1944"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01945" /><CodeLine lineNumber="1945"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01946" /><CodeLine lineNumber="1946" lineLink="#aa847a3eff7b875035d9f887587291940"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01947" /><CodeLine lineNumber="1947"><Highlight kind="normal">                                 </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</Highlight></CodeLine>
<Link id="l01948" /><CodeLine lineNumber="1948"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Target may want to look at the user instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01949" /><CodeLine lineNumber="1949"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> &amp;&amp; <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.LSRWithInstrQueries()) &#123;</Highlight></CodeLine>
<Link id="l01950" /><CodeLine lineNumber="1950"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : LU.Fixups)</Highlight></CodeLine>
<Link id="l01951" /><CodeLine lineNumber="1951"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV,</Highlight></CodeLine>
<Link id="l01952" /><CodeLine lineNumber="1952"><Highlight kind="normal">                                (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg,</Highlight></CodeLine>
<Link id="l01953" /><CodeLine lineNumber="1953"><Highlight kind="normal">                                <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale, <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst))</Highlight></CodeLine>
<Link id="l01954" /><CodeLine lineNumber="1954"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01955" /><CodeLine lineNumber="1955"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l01956" /><CodeLine lineNumber="1956"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01957" /><CodeLine lineNumber="1957"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01958" /><CodeLine lineNumber="1958"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind,</Highlight></CodeLine>
<Link id="l01959" /><CodeLine lineNumber="1959"><Highlight kind="normal">                              LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg,</Highlight></CodeLine>
<Link id="l01960" /><CodeLine lineNumber="1960"><Highlight kind="normal">                              <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale);</Highlight></CodeLine>
<Link id="l01961" /><CodeLine lineNumber="1961"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l01962" /><CodeLine lineNumber="1962"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01963" /><CodeLine lineNumber="1963" lineLink="#a3cbf7279944dc2f0f99a6896501277f9"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a> <a href="#a3cbf7279944dc2f0f99a6896501277f9">getScalingFactorCost</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l01964" /><CodeLine lineNumber="1964"><Highlight kind="normal">                                            </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l01965" /><CodeLine lineNumber="1965"><Highlight kind="normal">                                            </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</Highlight></CodeLine>
<Link id="l01966" /><CodeLine lineNumber="1966"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale)</Highlight></CodeLine>
<Link id="l01967" /><CodeLine lineNumber="1967"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 0;</Highlight></CodeLine>
<Link id="l01968" /><CodeLine lineNumber="1968"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01969" /><CodeLine lineNumber="1969"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If the use is not completely folded in that instruction, we will have to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01970" /><CodeLine lineNumber="1970"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// pay an extra cost only for scale != 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01971" /><CodeLine lineNumber="1971"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind,</Highlight></CodeLine>
<Link id="l01972" /><CodeLine lineNumber="1972"><Highlight kind="normal">                            LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, L))</Highlight></CodeLine>
<Link id="l01973" /><CodeLine lineNumber="1973"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 1;</Highlight></CodeLine>
<Link id="l01974" /><CodeLine lineNumber="1974"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01975" /><CodeLine lineNumber="1975"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (LU.Kind) &#123;</Highlight></CodeLine>
<Link id="l01976" /><CodeLine lineNumber="1976"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>: &#123;</Highlight></CodeLine>
<Link id="l01977" /><CodeLine lineNumber="1977"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check the scaling factor cost with both the min and max offsets.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01978" /><CodeLine lineNumber="1978"><Highlight kind="normal">    int64&#95;t ScalableMin = 0, ScalableMax = 0, FixedMin = 0, FixedMax = 0;</Highlight></CodeLine>
<Link id="l01979" /><CodeLine lineNumber="1979"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isScalable()) &#123;</Highlight></CodeLine>
<Link id="l01980" /><CodeLine lineNumber="1980"><Highlight kind="normal">      ScalableMin = (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + LU.MinOffset).getKnownMinValue();</Highlight></CodeLine>
<Link id="l01981" /><CodeLine lineNumber="1981"><Highlight kind="normal">      ScalableMax = (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + LU.MaxOffset).getKnownMinValue();</Highlight></CodeLine>
<Link id="l01982" /><CodeLine lineNumber="1982"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l01983" /><CodeLine lineNumber="1983"><Highlight kind="normal">      FixedMin = (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + LU.MinOffset).getFixedValue();</Highlight></CodeLine>
<Link id="l01984" /><CodeLine lineNumber="1984"><Highlight kind="normal">      FixedMax = (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + LU.MaxOffset).getFixedValue();</Highlight></CodeLine>
<Link id="l01985" /><CodeLine lineNumber="1985"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l01986" /><CodeLine lineNumber="1986"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a> ScaleCostMinOffset = <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.getScalingFactorCost(</Highlight></CodeLine>
<Link id="l01987" /><CodeLine lineNumber="1987"><Highlight kind="normal">        LU.AccessTy.MemTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV, <a href="/docs/api/classes/llvm/stackoffset/#aab735eb6b844f1b683d12013a083b4e2">StackOffset::get</a>(FixedMin, ScalableMin),</Highlight></CodeLine>
<Link id="l01988" /><CodeLine lineNumber="1988"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale, LU.AccessTy.AddrSpace);</Highlight></CodeLine>
<Link id="l01989" /><CodeLine lineNumber="1989"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a> ScaleCostMaxOffset = <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.getScalingFactorCost(</Highlight></CodeLine>
<Link id="l01990" /><CodeLine lineNumber="1990"><Highlight kind="normal">        LU.AccessTy.MemTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV, <a href="/docs/api/classes/llvm/stackoffset/#aab735eb6b844f1b683d12013a083b4e2">StackOffset::get</a>(FixedMax, ScalableMax),</Highlight></CodeLine>
<Link id="l01991" /><CodeLine lineNumber="1991"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale, LU.AccessTy.AddrSpace);</Highlight></CodeLine>
<Link id="l01992" /><CodeLine lineNumber="1992"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l01993" /><CodeLine lineNumber="1993"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ScaleCostMinOffset.<a href="/docs/api/classes/llvm/instructioncost/#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp; ScaleCostMaxOffset.<a href="/docs/api/classes/llvm/instructioncost/#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l01994" /><CodeLine lineNumber="1994"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Legal addressing mode has an illegal cost!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l01995" /><CodeLine lineNumber="1995"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> std::max(ScaleCostMinOffset, ScaleCostMaxOffset);</Highlight></CodeLine>
<Link id="l01996" /><CodeLine lineNumber="1996"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l01997" /><CodeLine lineNumber="1997"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>:</Highlight></CodeLine>
<Link id="l01998" /><CodeLine lineNumber="1998"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a>:</Highlight></CodeLine>
<Link id="l01999" /><CodeLine lineNumber="1999"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">LSRUse::Special</a>:</Highlight></CodeLine>
<Link id="l02000" /><CodeLine lineNumber="2000"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The use is completely folded, i.e., everything is folded into the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02001" /><CodeLine lineNumber="2001"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// instruction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02002" /><CodeLine lineNumber="2002"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> 0;</Highlight></CodeLine>
<Link id="l02003" /><CodeLine lineNumber="2003"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02004" /><CodeLine lineNumber="2004"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02005" /><CodeLine lineNumber="2005"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Invalid LSRUse Kind!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02006" /><CodeLine lineNumber="2006"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02007" /><CodeLine lineNumber="2007"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02008" /><CodeLine lineNumber="2008" lineLink="#a626659c8868b0e423f831bfc2b98091e"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l02009" /><CodeLine lineNumber="2009"><Highlight kind="normal">                             <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy,</Highlight></CodeLine>
<Link id="l02010" /><CodeLine lineNumber="2010"><Highlight kind="normal">                             <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV, Immediate BaseOffset,</Highlight></CodeLine>
<Link id="l02011" /><CodeLine lineNumber="2011"><Highlight kind="normal">                             </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasBaseReg) &#123;</Highlight></CodeLine>
<Link id="l02012" /><CodeLine lineNumber="2012"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Fast-path: zero is always foldable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02013" /><CodeLine lineNumber="2013"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseOffset.isZero() &amp;&amp; !BaseGV)</Highlight></CodeLine>
<Link id="l02014" /><CodeLine lineNumber="2014"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02015" /><CodeLine lineNumber="2015"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02016" /><CodeLine lineNumber="2016"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Conservatively, create an address with an immediate and a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02017" /><CodeLine lineNumber="2017"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// base and a scale.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02018" /><CodeLine lineNumber="2018"><Highlight kind="normal">  int64&#95;t Scale = Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> ? -1 : 1;</Highlight></CodeLine>
<Link id="l02019" /><CodeLine lineNumber="2019"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02020" /><CodeLine lineNumber="2020"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Canonicalize a scale of 1 to a base register if the formula doesn&#39;t</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02021" /><CodeLine lineNumber="2021"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// already have a base register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02022" /><CodeLine lineNumber="2022"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!HasBaseReg &amp;&amp; Scale == 1) &#123;</Highlight></CodeLine>
<Link id="l02023" /><CodeLine lineNumber="2023"><Highlight kind="normal">    Scale = 0;</Highlight></CodeLine>
<Link id="l02024" /><CodeLine lineNumber="2024"><Highlight kind="normal">    HasBaseReg = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02025" /><CodeLine lineNumber="2025"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02026" /><CodeLine lineNumber="2026"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02027" /><CodeLine lineNumber="2027"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// FIXME: Try with + without a scale? Maybe based on TTI?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02028" /><CodeLine lineNumber="2028"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// I think basereg + scaledreg + immediateoffset isn&#39;t a good &#39;conservative&#39;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02029" /><CodeLine lineNumber="2029"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// default for many architectures, not just AArch64 SVE. More investigation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02030" /><CodeLine lineNumber="2030"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// needed later to determine if this should be used more widely than just</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02031" /><CodeLine lineNumber="2031"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// on scalable types.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02032" /><CodeLine lineNumber="2032"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasBaseReg &amp;&amp; BaseOffset.isNonZero() &amp;&amp; Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l02033" /><CodeLine lineNumber="2033"><Highlight kind="normal">      AccessTy.MemTy &amp;&amp; AccessTy.MemTy-&gt;isScalableTy() &amp;&amp; <a href="#a0ce46a19f824c65a4ddace1f4e9ac529">DropScaledForVScale</a>)</Highlight></CodeLine>
<Link id="l02034" /><CodeLine lineNumber="2034"><Highlight kind="normal">    Scale = 0;</Highlight></CodeLine>
<Link id="l02035" /><CodeLine lineNumber="2035"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02036" /><CodeLine lineNumber="2036"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, AccessTy, BaseGV, BaseOffset,</Highlight></CodeLine>
<Link id="l02037" /><CodeLine lineNumber="2037"><Highlight kind="normal">                              HasBaseReg, Scale);</Highlight></CodeLine>
<Link id="l02038" /><CodeLine lineNumber="2038"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02039" /><CodeLine lineNumber="2039"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02040" /><CodeLine lineNumber="2040" lineLink="#a290c161463cbfb7720d6499dba1310ad"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l02041" /><CodeLine lineNumber="2041"><Highlight kind="normal">                             <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, Immediate MinOffset,</Highlight></CodeLine>
<Link id="l02042" /><CodeLine lineNumber="2042"><Highlight kind="normal">                             Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</Highlight></CodeLine>
<Link id="l02043" /><CodeLine lineNumber="2043"><Highlight kind="normal">                             MemAccessTy AccessTy, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S,</Highlight></CodeLine>
<Link id="l02044" /><CodeLine lineNumber="2044"><Highlight kind="normal">                             </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasBaseReg) &#123;</Highlight></CodeLine>
<Link id="l02045" /><CodeLine lineNumber="2045"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Fast-path: zero is always foldable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02046" /><CodeLine lineNumber="2046"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (S-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02047" /><CodeLine lineNumber="2047"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02048" /><CodeLine lineNumber="2048"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Conservatively, create an address with an immediate and a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02049" /><CodeLine lineNumber="2049"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// base and a scale.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02050" /><CodeLine lineNumber="2050"><Highlight kind="normal">  Immediate BaseOffset = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(S, SE);</Highlight></CodeLine>
<Link id="l02051" /><CodeLine lineNumber="2051"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV = <a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(S, SE);</Highlight></CodeLine>
<Link id="l02052" /><CodeLine lineNumber="2052"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02053" /><CodeLine lineNumber="2053"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there&#39;s anything else involved, it&#39;s not foldable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02054" /><CodeLine lineNumber="2054"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!S-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02055" /><CodeLine lineNumber="2055"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02056" /><CodeLine lineNumber="2056"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Fast-path: zero is always foldable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02057" /><CodeLine lineNumber="2057"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseOffset.isZero() &amp;&amp; !BaseGV)</Highlight></CodeLine>
<Link id="l02058" /><CodeLine lineNumber="2058"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02059" /><CodeLine lineNumber="2059"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02060" /><CodeLine lineNumber="2060"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseOffset.isScalable())</Highlight></CodeLine>
<Link id="l02061" /><CodeLine lineNumber="2061"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02062" /><CodeLine lineNumber="2062"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02063" /><CodeLine lineNumber="2063"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Conservatively, create an address with an immediate and a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02064" /><CodeLine lineNumber="2064"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// base and a scale.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02065" /><CodeLine lineNumber="2065"><Highlight kind="normal">  int64&#95;t Scale = Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> ? -1 : 1;</Highlight></CodeLine>
<Link id="l02066" /><CodeLine lineNumber="2066"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02067" /><CodeLine lineNumber="2067"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy, BaseGV,</Highlight></CodeLine>
<Link id="l02068" /><CodeLine lineNumber="2068"><Highlight kind="normal">                              BaseOffset, HasBaseReg, Scale);</Highlight></CodeLine>
<Link id="l02069" /><CodeLine lineNumber="2069"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02070" /><CodeLine lineNumber="2070"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02071" /><CodeLine lineNumber="2071"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l02072" /><CodeLine lineNumber="2072"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02073" /><CodeLine lineNumber="2073"><Highlight kind="comment">/// An individual increment in a Chain of IV increments.  Relate an IV user to</Highlight></CodeLine>
<Link id="l02074" /><CodeLine lineNumber="2074"><Highlight kind="comment">/// an expression that computes the IV it uses from the IV used by the previous</Highlight></CodeLine>
<Link id="l02075" /><CodeLine lineNumber="2075"><Highlight kind="comment">/// link in the Chain.</Highlight></CodeLine>
<Link id="l02076" /><CodeLine lineNumber="2076"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02077" /><CodeLine lineNumber="2077"><Highlight kind="comment">/// For the head of a chain, IncExpr holds the absolute SCEV expression for the</Highlight></CodeLine>
<Link id="l02078" /><CodeLine lineNumber="2078"><Highlight kind="comment">/// original IVOperand. The head of the chain&#39;s IVOperand is only valid during</Highlight></CodeLine>
<Link id="l02079" /><CodeLine lineNumber="2079"><Highlight kind="comment">/// chain collection, before LSR replaces IV users. During chain generation,</Highlight></CodeLine>
<Link id="l02080" /><CodeLine lineNumber="2080"><Highlight kind="comment">/// IncExpr can be used to find the new IVOperand that computes the same</Highlight></CodeLine>
<Link id="l02081" /><CodeLine lineNumber="2081"><Highlight kind="comment">/// expression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02082" /><CodeLine lineNumber="2082" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a4a00efb2c77fbadba8355cf70a0c46da">IVInc</a> &#123;</Highlight></CodeLine>
<Link id="l02083" /><CodeLine lineNumber="2083" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a24dd72fbb252cd525690013aae6688db"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a24dd72fbb252cd525690013aae6688db">UserInst</a>;</Highlight></CodeLine>
<Link id="l02084" /><CodeLine lineNumber="2084" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a89eb1b3a3d8c73618179b2ca0ac8bfd6"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a>&#42; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a89eb1b3a3d8c73618179b2ca0ac8bfd6">IVOperand</a>;</Highlight></CodeLine>
<Link id="l02085" /><CodeLine lineNumber="2085" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#aad35bcf540910bcaecb50636e153c55c"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#aad35bcf540910bcaecb50636e153c55c">IncExpr</a>;</Highlight></CodeLine>
<Link id="l02086" /><CodeLine lineNumber="2086"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02087" /><CodeLine lineNumber="2087" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a4a00efb2c77fbadba8355cf70a0c46da"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a4a00efb2c77fbadba8355cf70a0c46da">IVInc</a>(<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;U, <a href="/docs/api/classes/llvm/value">Value</a> &#42;O, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;E)</Highlight></CodeLine>
<Link id="l02088" /><CodeLine lineNumber="2088"><Highlight kind="normal">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a24dd72fbb252cd525690013aae6688db">UserInst</a>(U), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a89eb1b3a3d8c73618179b2ca0ac8bfd6">IVOperand</a>(O), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#aad35bcf540910bcaecb50636e153c55c">IncExpr</a>(E) &#123;&#125;</Highlight></CodeLine>
<Link id="l02089" /><CodeLine lineNumber="2089"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l02090" /><CodeLine lineNumber="2090"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02091" /><CodeLine lineNumber="2091"><Highlight kind="normal"></Highlight><Highlight kind="comment">// The list of IV increments in program order.  We typically add the head of a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02092" /><CodeLine lineNumber="2092"><Highlight kind="normal"></Highlight><Highlight kind="comment">// chain without finding subsequent links.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02093" /><CodeLine lineNumber="2093" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a02ff66a22299f873b2bcf73f03d50707">IVChain</a> &#123;</Highlight></CodeLine>
<Link id="l02094" /><CodeLine lineNumber="2094" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;IVInc, 1&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>;</Highlight></CodeLine>
<Link id="l02095" /><CodeLine lineNumber="2095" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a43345861037b44e75b6240b17c3e7965"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a43345861037b44e75b6240b17c3e7965">ExprBase</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02096" /><CodeLine lineNumber="2096"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02097" /><CodeLine lineNumber="2097" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a02ff66a22299f873b2bcf73f03d50707"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a02ff66a22299f873b2bcf73f03d50707">IVChain</a>() = </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02098" /><CodeLine lineNumber="2098" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a79cdd382de7e2c08c536aec18f2bb17a"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a79cdd382de7e2c08c536aec18f2bb17a">IVChain</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> &amp;Head, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>)</Highlight></CodeLine>
<Link id="l02099" /><CodeLine lineNumber="2099"><Highlight kind="normal">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>(1, Head), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a43345861037b44e75b6240b17c3e7965">ExprBase</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;&#125;</Highlight></CodeLine>
<Link id="l02100" /><CodeLine lineNumber="2100"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02101" /><CodeLine lineNumber="2101" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">const&#95;iterator</a> = <a href="/docs/api/classes/llvm/smallvectorimpl/#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;IVInc&gt;::const&#95;iterator</a>;</Highlight></CodeLine>
<Link id="l02102" /><CodeLine lineNumber="2102"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02103" /><CodeLine lineNumber="2103"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Return the first increment in the chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02104" /><CodeLine lineNumber="2104" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a0d9bed9a63ddbf560eb0e5a5bd9a977d"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">const&#95;iterator</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a0d9bed9a63ddbf560eb0e5a5bd9a977d">begin</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l02105" /><CodeLine lineNumber="2105"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.empty());</Highlight></CodeLine>
<Link id="l02106" /><CodeLine lineNumber="2106"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> std::next(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.begin());</Highlight></CodeLine>
<Link id="l02107" /><CodeLine lineNumber="2107"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02108" /><CodeLine lineNumber="2108" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a99ebaa4bf34d0ae2bacfc305101006df"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">const&#95;iterator</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a99ebaa4bf34d0ae2bacfc305101006df">end</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l02109" /><CodeLine lineNumber="2109"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.end();</Highlight></CodeLine>
<Link id="l02110" /><CodeLine lineNumber="2110"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02111" /><CodeLine lineNumber="2111"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02112" /><CodeLine lineNumber="2112"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Returns true if this chain contains any increments.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02113" /><CodeLine lineNumber="2113" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a80714456485921f3145c280a15cd9a0d"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a80714456485921f3145c280a15cd9a0d">hasIncs</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.size() &gt;= 2; &#125;</Highlight></CodeLine>
<Link id="l02114" /><CodeLine lineNumber="2114"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02115" /><CodeLine lineNumber="2115"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add an IVInc to the end of this chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02116" /><CodeLine lineNumber="2116" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a74b61b4ed15354a4d7a40a72045bda49"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a74b61b4ed15354a4d7a40a72045bda49">add</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>) &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.push&#95;back(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>); &#125;</Highlight></CodeLine>
<Link id="l02117" /><CodeLine lineNumber="2117"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02118" /><CodeLine lineNumber="2118"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Returns the last UserInst in the chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02119" /><CodeLine lineNumber="2119" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3c7f16fc2b68e37e493102584cd94445"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3c7f16fc2b68e37e493102584cd94445">tailUserInst</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.back().UserInst; &#125;</Highlight></CodeLine>
<Link id="l02120" /><CodeLine lineNumber="2120"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02121" /><CodeLine lineNumber="2121"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Returns true if IncExpr can be profitably added to this chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02122" /><CodeLine lineNumber="2122"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> isProfitableIncrement(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OperExpr,</Highlight></CodeLine>
<Link id="l02123" /><CodeLine lineNumber="2123"><Highlight kind="normal">                             </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr,</Highlight></CodeLine>
<Link id="l02124" /><CodeLine lineNumber="2124"><Highlight kind="normal">                             <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a>&amp;);</Highlight></CodeLine>
<Link id="l02125" /><CodeLine lineNumber="2125"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l02126" /><CodeLine lineNumber="2126"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02127" /><CodeLine lineNumber="2127"><Highlight kind="comment">/// Helper for CollectChains to track multiple IV increment uses.  Distinguish</Highlight></CodeLine>
<Link id="l02128" /><CodeLine lineNumber="2128"><Highlight kind="comment">/// between FarUsers that definitely cross IV increments and NearUsers that may</Highlight></CodeLine>
<Link id="l02129" /><CodeLine lineNumber="2129"><Highlight kind="comment">/// be used between IV increments.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02130" /><CodeLine lineNumber="2130" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers">ChainUsers</a> &#123;</Highlight></CodeLine>
<Link id="l02131" /><CodeLine lineNumber="2131" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#ae20ff1d73c2a85f990a86d2369df5d11"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction&#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#ae20ff1d73c2a85f990a86d2369df5d11">FarUsers</a>;</Highlight></CodeLine>
<Link id="l02132" /><CodeLine lineNumber="2132" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#a9c5fc8575e447cda16ba00faa25afb5c"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction&#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#a9c5fc8575e447cda16ba00faa25afb5c">NearUsers</a>;</Highlight></CodeLine>
<Link id="l02133" /><CodeLine lineNumber="2133"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l02134" /><CodeLine lineNumber="2134"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02135" /><CodeLine lineNumber="2135"><Highlight kind="comment">/// This class holds state for the main loop strength reduction logic.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02136" /><CodeLine lineNumber="2136" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance"><Highlight kind="normal"></Highlight><Highlight kind="keyword">class </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a9bcf42be7435217d79cd175d4e6993d7">LSRInstance</a> &#123;</Highlight></CodeLine>
<Link id="l02137" /><CodeLine lineNumber="2137"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp;IU;</Highlight></CodeLine>
<Link id="l02138" /><CodeLine lineNumber="2138"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE;</Highlight></CodeLine>
<Link id="l02139" /><CodeLine lineNumber="2139"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;DT;</Highlight></CodeLine>
<Link id="l02140" /><CodeLine lineNumber="2140"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI;</Highlight></CodeLine>
<Link id="l02141" /><CodeLine lineNumber="2141"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;AC;</Highlight></CodeLine>
<Link id="l02142" /><CodeLine lineNumber="2142"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp;TLI;</Highlight></CodeLine>
<Link id="l02143" /><CodeLine lineNumber="2143"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;TTI;</Highlight></CodeLine>
<Link id="l02144" /><CodeLine lineNumber="2144"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> L;</Highlight></CodeLine>
<Link id="l02145" /><CodeLine lineNumber="2145"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/memoryssaupdater">MemorySSAUpdater</a> &#42;MSSAU;</Highlight></CodeLine>
<Link id="l02146" /><CodeLine lineNumber="2146"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43">TTI::AddressingModeKind</a> AMK;</Highlight></CodeLine>
<Link id="l02147" /><CodeLine lineNumber="2147"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">mutable</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevexpander">SCEVExpander</a> Rewriter;</Highlight></CodeLine>
<Link id="l02148" /><CodeLine lineNumber="2148"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Changed = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02149" /><CodeLine lineNumber="2149"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02150" /><CodeLine lineNumber="2150"><Highlight kind="comment">  /// This is the insert position that the current loop&#39;s induction variable</Highlight></CodeLine>
<Link id="l02151" /><CodeLine lineNumber="2151"><Highlight kind="comment">  /// increment should be placed. In simple loops, this is the latch block&#39;s</Highlight></CodeLine>
<Link id="l02152" /><CodeLine lineNumber="2152"><Highlight kind="comment">  /// terminator. But in more complicated cases, this is a position which will</Highlight></CodeLine>
<Link id="l02153" /><CodeLine lineNumber="2153"><Highlight kind="comment">  /// dominate all the in-loop post-increment users.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02154" /><CodeLine lineNumber="2154"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVIncInsertPos = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02155" /><CodeLine lineNumber="2155"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02156" /><CodeLine lineNumber="2156"><Highlight kind="comment">  /// Interesting factors between use strides.</Highlight></CodeLine>
<Link id="l02157" /><CodeLine lineNumber="2157"><Highlight kind="comment">  ///</Highlight></CodeLine>
<Link id="l02158" /><CodeLine lineNumber="2158"><Highlight kind="comment">  /// We explicitly use a SetVector which contains a SmallSet, instead of the</Highlight></CodeLine>
<Link id="l02159" /><CodeLine lineNumber="2159"><Highlight kind="comment">  /// default, a SmallDenseSet, because we need to use the full range of</Highlight></CodeLine>
<Link id="l02160" /><CodeLine lineNumber="2160"><Highlight kind="comment">  /// int64&#95;ts, and there&#39;s currently no good way of doing that with</Highlight></CodeLine>
<Link id="l02161" /><CodeLine lineNumber="2161"><Highlight kind="comment">  /// SmallDenseSet.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02162" /><CodeLine lineNumber="2162"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/setvector">SetVector&lt;int64&#95;t, SmallVector&lt;int64&#95;t, 8&gt;</a>, <a href="/docs/api/classes/llvm/smallset">SmallSet&lt;int64&#95;t, 8&gt;</a>&gt; Factors;</Highlight></CodeLine>
<Link id="l02163" /><CodeLine lineNumber="2163"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02164" /><CodeLine lineNumber="2164"><Highlight kind="comment">  /// The cost of the current SCEV, the best solution by LSR will be dropped if</Highlight></CodeLine>
<Link id="l02165" /><CodeLine lineNumber="2165"><Highlight kind="comment">  /// the solution is not profitable.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02166" /><CodeLine lineNumber="2166"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a> BaselineCost;</Highlight></CodeLine>
<Link id="l02167" /><CodeLine lineNumber="2167"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02168" /><CodeLine lineNumber="2168"><Highlight kind="comment">  /// Interesting use types, to facilitate truncation reuse.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02169" /><CodeLine lineNumber="2169"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector&lt;Type &#42;, 4&gt;</a> Types;</Highlight></CodeLine>
<Link id="l02170" /><CodeLine lineNumber="2170"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02171" /><CodeLine lineNumber="2171"><Highlight kind="comment">  /// The list of interesting uses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02172" /><CodeLine lineNumber="2172"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">mutable</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;LSRUse, 16&gt;</a> Uses;</Highlight></CodeLine>
<Link id="l02173" /><CodeLine lineNumber="2173"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02174" /><CodeLine lineNumber="2174"><Highlight kind="comment">  /// Track which uses use which register candidates.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02175" /><CodeLine lineNumber="2175"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> RegUses;</Highlight></CodeLine>
<Link id="l02176" /><CodeLine lineNumber="2176"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02177" /><CodeLine lineNumber="2177"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Limit the number of chains to avoid quadratic behavior. We don&#39;t expect to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02178" /><CodeLine lineNumber="2178"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// have more than a few IV increment chains in a loop. Missing a Chain falls</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02179" /><CodeLine lineNumber="2179"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// back to normal LSR behavior for those uses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02180" /><CodeLine lineNumber="2180"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> MaxChains = 8;</Highlight></CodeLine>
<Link id="l02181" /><CodeLine lineNumber="2181"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02182" /><CodeLine lineNumber="2182"><Highlight kind="comment">  /// IV users can form a chain of IV increments.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02183" /><CodeLine lineNumber="2183"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;IVChain, MaxChains&gt;</a> IVChainVec;</Highlight></CodeLine>
<Link id="l02184" /><CodeLine lineNumber="2184"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02185" /><CodeLine lineNumber="2185"><Highlight kind="comment">  /// IV users that belong to profitable IVChains.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02186" /><CodeLine lineNumber="2186"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Use&#42;, MaxChains&gt;</a> IVIncSet;</Highlight></CodeLine>
<Link id="l02187" /><CodeLine lineNumber="2187"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02188" /><CodeLine lineNumber="2188"><Highlight kind="comment">  /// Induction variables that were generated and inserted by the SCEV Expander.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02189" /><CodeLine lineNumber="2189"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;llvm::WeakVH, 2&gt;</a> ScalarEvolutionIVs;</Highlight></CodeLine>
<Link id="l02190" /><CodeLine lineNumber="2190"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02191" /><CodeLine lineNumber="2191"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Inserting instructions in the loop and using them as PHI&#39;s input could</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02192" /><CodeLine lineNumber="2192"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// break LCSSA in case if PHI&#39;s parent block is not a loop exit (i.e. the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02193" /><CodeLine lineNumber="2193"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// corresponding incoming block is not loop exiting). So collect all such</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02194" /><CodeLine lineNumber="2194"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// instructions to form LCSSA for them later.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02195" /><CodeLine lineNumber="2195"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector&lt;Instruction &#42;, 4&gt;</a> InsertedNonLCSSAInsts;</Highlight></CodeLine>
<Link id="l02196" /><CodeLine lineNumber="2196"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02197" /><CodeLine lineNumber="2197"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OptimizeShadowIV();</Highlight></CodeLine>
<Link id="l02198" /><CodeLine lineNumber="2198"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> FindIVUserForCond(<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &#42;&amp;CondUse);</Highlight></CodeLine>
<Link id="l02199" /><CodeLine lineNumber="2199"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;OptimizeMax(<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a>&#42; &amp;CondUse);</Highlight></CodeLine>
<Link id="l02200" /><CodeLine lineNumber="2200"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> OptimizeLoopTermCond();</Highlight></CodeLine>
<Link id="l02201" /><CodeLine lineNumber="2201"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02202" /><CodeLine lineNumber="2202"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> ChainInstruction(<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVOper,</Highlight></CodeLine>
<Link id="l02203" /><CodeLine lineNumber="2203"><Highlight kind="normal">                        <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;ChainUsers&gt;</a> &amp;ChainUsersVec);</Highlight></CodeLine>
<Link id="l02204" /><CodeLine lineNumber="2204"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> FinalizeChain(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a> &amp;Chain);</Highlight></CodeLine>
<Link id="l02205" /><CodeLine lineNumber="2205"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> CollectChains();</Highlight></CodeLine>
<Link id="l02206" /><CodeLine lineNumber="2206"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateIVChain(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a> &amp;Chain,</Highlight></CodeLine>
<Link id="l02207" /><CodeLine lineNumber="2207"><Highlight kind="normal">                       <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts);</Highlight></CodeLine>
<Link id="l02208" /><CodeLine lineNumber="2208"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02209" /><CodeLine lineNumber="2209"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> CollectInterestingTypesAndFactors();</Highlight></CodeLine>
<Link id="l02210" /><CodeLine lineNumber="2210"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> CollectFixupsAndInitialFormulae();</Highlight></CodeLine>
<Link id="l02211" /><CodeLine lineNumber="2211"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02212" /><CodeLine lineNumber="2212"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Support for sharing of LSRUses between LSRFixups.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02213" /><CodeLine lineNumber="2213"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal">UseMapTy = <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;LSRUse::SCEVUseKindPair, size&#95;t&gt;</a>;</Highlight></CodeLine>
<Link id="l02214" /><CodeLine lineNumber="2214"><Highlight kind="normal">  UseMapTy UseMap;</Highlight></CodeLine>
<Link id="l02215" /><CodeLine lineNumber="2215"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02216" /><CodeLine lineNumber="2216"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> reconcileNewOffset(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> NewOffset, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasBaseReg,</Highlight></CodeLine>
<Link id="l02217" /><CodeLine lineNumber="2217"><Highlight kind="normal">                          <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a> AccessTy);</Highlight></CodeLine>
<Link id="l02218" /><CodeLine lineNumber="2218"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02219" /><CodeLine lineNumber="2219"><Highlight kind="normal">  std::pair&lt;size&#95;t, Immediate&gt; getUse(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;Expr, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</Highlight></CodeLine>
<Link id="l02220" /><CodeLine lineNumber="2220"><Highlight kind="normal">                                      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a> AccessTy);</Highlight></CodeLine>
<Link id="l02221" /><CodeLine lineNumber="2221"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02222" /><CodeLine lineNumber="2222"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> DeleteUse(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx);</Highlight></CodeLine>
<Link id="l02223" /><CodeLine lineNumber="2223"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02224" /><CodeLine lineNumber="2224"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &#42;FindUseWithSimilarFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;OrigLU);</Highlight></CodeLine>
<Link id="l02225" /><CodeLine lineNumber="2225"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02226" /><CodeLine lineNumber="2226"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> InsertInitialFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx);</Highlight></CodeLine>
<Link id="l02227" /><CodeLine lineNumber="2227"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> InsertSupplementalFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx);</Highlight></CodeLine>
<Link id="l02228" /><CodeLine lineNumber="2228"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> CountRegisters(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx);</Highlight></CodeLine>
<Link id="l02229" /><CodeLine lineNumber="2229"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> InsertFormula(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l02230" /><CodeLine lineNumber="2230"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02231" /><CodeLine lineNumber="2231"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> CollectLoopInvariantFixupsAndFormulae();</Highlight></CodeLine>
<Link id="l02232" /><CodeLine lineNumber="2232"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02233" /><CodeLine lineNumber="2233"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateReassociations(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l02234" /><CodeLine lineNumber="2234"><Highlight kind="normal">                              </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> = 0);</Highlight></CodeLine>
<Link id="l02235" /><CodeLine lineNumber="2235"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02236" /><CodeLine lineNumber="2236"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateReassociationsImpl(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l02237" /><CodeLine lineNumber="2237"><Highlight kind="normal">                                  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>,</Highlight></CodeLine>
<Link id="l02238" /><CodeLine lineNumber="2238"><Highlight kind="normal">                                  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> Idx, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsScaledReg = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02239" /><CodeLine lineNumber="2239"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateCombinations(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</Highlight></CodeLine>
<Link id="l02240" /><CodeLine lineNumber="2240"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateSymbolicOffsetsImpl(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l02241" /><CodeLine lineNumber="2241"><Highlight kind="normal">                                   </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> Idx,</Highlight></CodeLine>
<Link id="l02242" /><CodeLine lineNumber="2242"><Highlight kind="normal">                                   </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsScaledReg = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02243" /><CodeLine lineNumber="2243"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateSymbolicOffsets(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</Highlight></CodeLine>
<Link id="l02244" /><CodeLine lineNumber="2244"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateConstantOffsetsImpl(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l02245" /><CodeLine lineNumber="2245"><Highlight kind="normal">                                   </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l02246" /><CodeLine lineNumber="2246"><Highlight kind="normal">                                   </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Immediate&gt;</a> &amp;Worklist,</Highlight></CodeLine>
<Link id="l02247" /><CodeLine lineNumber="2247"><Highlight kind="normal">                                   </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> Idx, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsScaledReg = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02248" /><CodeLine lineNumber="2248"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateConstantOffsets(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</Highlight></CodeLine>
<Link id="l02249" /><CodeLine lineNumber="2249"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateICmpZeroScales(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</Highlight></CodeLine>
<Link id="l02250" /><CodeLine lineNumber="2250"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateScales(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</Highlight></CodeLine>
<Link id="l02251" /><CodeLine lineNumber="2251"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateTruncates(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</Highlight></CodeLine>
<Link id="l02252" /><CodeLine lineNumber="2252"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateCrossUseConstantOffsets();</Highlight></CodeLine>
<Link id="l02253" /><CodeLine lineNumber="2253"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> GenerateAllReuseFormulae();</Highlight></CodeLine>
<Link id="l02254" /><CodeLine lineNumber="2254"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02255" /><CodeLine lineNumber="2255"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> FilterOutUndesirableDedicatedRegisters();</Highlight></CodeLine>
<Link id="l02256" /><CodeLine lineNumber="2256"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02257" /><CodeLine lineNumber="2257"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> EstimateSearchSpaceComplexity() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02258" /><CodeLine lineNumber="2258"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> NarrowSearchSpaceByDetectingSupersets();</Highlight></CodeLine>
<Link id="l02259" /><CodeLine lineNumber="2259"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> NarrowSearchSpaceByCollapsingUnrolledCode();</Highlight></CodeLine>
<Link id="l02260" /><CodeLine lineNumber="2260"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> NarrowSearchSpaceByRefilteringUndesirableDedicatedRegisters();</Highlight></CodeLine>
<Link id="l02261" /><CodeLine lineNumber="2261"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> NarrowSearchSpaceByFilterFormulaWithSameScaledReg();</Highlight></CodeLine>
<Link id="l02262" /><CodeLine lineNumber="2262"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> NarrowSearchSpaceByFilterPostInc();</Highlight></CodeLine>
<Link id="l02263" /><CodeLine lineNumber="2263"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> NarrowSearchSpaceByDeletingCostlyFormulas();</Highlight></CodeLine>
<Link id="l02264" /><CodeLine lineNumber="2264"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> NarrowSearchSpaceByPickingWinnerRegs();</Highlight></CodeLine>
<Link id="l02265" /><CodeLine lineNumber="2265"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> NarrowSearchSpaceUsingHeuristics();</Highlight></CodeLine>
<Link id="l02266" /><CodeLine lineNumber="2266"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02267" /><CodeLine lineNumber="2267"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> SolveRecurse(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution,</Highlight></CodeLine>
<Link id="l02268" /><CodeLine lineNumber="2268"><Highlight kind="normal">                    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a> &amp;SolutionCost,</Highlight></CodeLine>
<Link id="l02269" /><CodeLine lineNumber="2269"><Highlight kind="normal">                    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Workspace,</Highlight></CodeLine>
<Link id="l02270" /><CodeLine lineNumber="2270"><Highlight kind="normal">                    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a> &amp;CurCost,</Highlight></CodeLine>
<Link id="l02271" /><CodeLine lineNumber="2271"><Highlight kind="normal">                    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> &amp;CurRegs,</Highlight></CodeLine>
<Link id="l02272" /><CodeLine lineNumber="2272"><Highlight kind="normal">                    <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> &amp;VisitedRegs) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02273" /><CodeLine lineNumber="2273"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> Solve(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02274" /><CodeLine lineNumber="2274"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02275" /><CodeLine lineNumber="2275"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a></Highlight></CodeLine>
<Link id="l02276" /><CodeLine lineNumber="2276"><Highlight kind="normal">  HoistInsertPosition(<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</Highlight></CodeLine>
<Link id="l02277" /><CodeLine lineNumber="2277"><Highlight kind="normal">                      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Instruction &#42;&gt;</a> &amp;Inputs) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02278" /><CodeLine lineNumber="2278"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> AdjustInsertPositionForExpand(<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</Highlight></CodeLine>
<Link id="l02279" /><CodeLine lineNumber="2279"><Highlight kind="normal">                                                     </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF,</Highlight></CodeLine>
<Link id="l02280" /><CodeLine lineNumber="2280"><Highlight kind="normal">                                                     </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02281" /><CodeLine lineNumber="2281"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02282" /><CodeLine lineNumber="2282"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Expand(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l02283" /><CodeLine lineNumber="2283"><Highlight kind="normal">                <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</Highlight></CodeLine>
<Link id="l02284" /><CodeLine lineNumber="2284"><Highlight kind="normal">                <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02285" /><CodeLine lineNumber="2285"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> RewriteForPHI(<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF,</Highlight></CodeLine>
<Link id="l02286" /><CodeLine lineNumber="2286"><Highlight kind="normal">                     </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l02287" /><CodeLine lineNumber="2287"><Highlight kind="normal">                     <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts);</Highlight></CodeLine>
<Link id="l02288" /><CodeLine lineNumber="2288"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> Rewrite(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l02289" /><CodeLine lineNumber="2289"><Highlight kind="normal">               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts);</Highlight></CodeLine>
<Link id="l02290" /><CodeLine lineNumber="2290"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> ImplementSolution(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution);</Highlight></CodeLine>
<Link id="l02291" /><CodeLine lineNumber="2291"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02292" /><CodeLine lineNumber="2292"><Highlight kind="normal"></Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l02293" /><CodeLine lineNumber="2293"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a9bcf42be7435217d79cd175d4e6993d7">LSRInstance</a>(<a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp;IU, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;DT,</Highlight></CodeLine>
<Link id="l02294" /><CodeLine lineNumber="2294"><Highlight kind="normal">              <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;TTI, <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;AC,</Highlight></CodeLine>
<Link id="l02295" /><CodeLine lineNumber="2295"><Highlight kind="normal">              <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp;TLI, <a href="/docs/api/classes/llvm/memoryssaupdater">MemorySSAUpdater</a> &#42;MSSAU);</Highlight></CodeLine>
<Link id="l02296" /><CodeLine lineNumber="2296"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02297" /><CodeLine lineNumber="2297" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a93ebde9d4c2fe184724a11d3c1184124"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a93ebde9d4c2fe184724a11d3c1184124">getChanged</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Changed; &#125;</Highlight></CodeLine>
<Link id="l02298" /><CodeLine lineNumber="2298" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a34d7093fa45e90e82de2073b08157efc"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakVH&gt;</a> &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a34d7093fa45e90e82de2073b08157efc">getScalarEvolutionIVs</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l02299" /><CodeLine lineNumber="2299"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> ScalarEvolutionIVs;</Highlight></CodeLine>
<Link id="l02300" /><CodeLine lineNumber="2300"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02301" /><CodeLine lineNumber="2301"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02302" /><CodeLine lineNumber="2302"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> print&#95;factors&#95;and&#95;types(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02303" /><CodeLine lineNumber="2303"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> print&#95;fixups(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02304" /><CodeLine lineNumber="2304"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> print&#95;uses(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02305" /><CodeLine lineNumber="2305"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02306" /><CodeLine lineNumber="2306"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02307" /><CodeLine lineNumber="2307"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l02308" /><CodeLine lineNumber="2308"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02309" /><CodeLine lineNumber="2309"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// end anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02310" /><CodeLine lineNumber="2310"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02311" /><CodeLine lineNumber="2311"><Highlight kind="comment">/// If IV is used in a int-to-float cast inside the loop then try to eliminate</Highlight></CodeLine>
<Link id="l02312" /><CodeLine lineNumber="2312"><Highlight kind="comment">/// the cast operation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02313" /><CodeLine lineNumber="2313"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::OptimizeShadowIV() &#123;</Highlight></CodeLine>
<Link id="l02314" /><CodeLine lineNumber="2314"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BackedgeTakenCount = SE.getBackedgeTakenCount(L);</Highlight></CodeLine>
<Link id="l02315" /><CodeLine lineNumber="2315"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVCouldNotCompute&gt;</a>(BackedgeTakenCount))</Highlight></CodeLine>
<Link id="l02316" /><CodeLine lineNumber="2316"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02317" /><CodeLine lineNumber="2317"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02318" /><CodeLine lineNumber="2318"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/ivusers/#a1ac1243c7bc2878be52de359bd652680">IVUsers::const&#95;iterator</a> UI = IU.begin(), <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = IU.end();</Highlight></CodeLine>
<Link id="l02319" /><CodeLine lineNumber="2319"><Highlight kind="normal">       UI != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; </Highlight><Highlight kind="comment">/&#42; empty &#42;/</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l02320" /><CodeLine lineNumber="2320"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/ivusers/#a1ac1243c7bc2878be52de359bd652680">IVUsers::const&#95;iterator</a> CandidateUI = UI;</Highlight></CodeLine>
<Link id="l02321" /><CodeLine lineNumber="2321"><Highlight kind="normal">    ++UI;</Highlight></CodeLine>
<Link id="l02322" /><CodeLine lineNumber="2322"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;ShadowUse = CandidateUI-&gt;getUser();</Highlight></CodeLine>
<Link id="l02323" /><CodeLine lineNumber="2323"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;DestTy = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02324" /><CodeLine lineNumber="2324"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsSigned = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02325" /><CodeLine lineNumber="2325"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02326" /><CodeLine lineNumber="2326"><Highlight kind="normal">    </Highlight><Highlight kind="comment">/&#42; If shadow use is a int-&gt;float cast then insert a second IV</Highlight></CodeLine>
<Link id="l02327" /><CodeLine lineNumber="2327"><Highlight kind="comment">       to eliminate this cast.</Highlight></CodeLine>
<Link id="l02328" /><CodeLine lineNumber="2328"><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02329" /><CodeLine lineNumber="2329"><Highlight kind="comment">         for (unsigned i = 0; i &lt; n; ++i)</Highlight></CodeLine>
<Link id="l02330" /><CodeLine lineNumber="2330"><Highlight kind="comment">           foo((double)i);</Highlight></CodeLine>
<Link id="l02331" /><CodeLine lineNumber="2331"><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02332" /><CodeLine lineNumber="2332"><Highlight kind="comment">       is transformed into</Highlight></CodeLine>
<Link id="l02333" /><CodeLine lineNumber="2333"><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02334" /><CodeLine lineNumber="2334"><Highlight kind="comment">         double d = 0.0;</Highlight></CodeLine>
<Link id="l02335" /><CodeLine lineNumber="2335"><Highlight kind="comment">         for (unsigned i = 0; i &lt; n; ++i, ++d)</Highlight></CodeLine>
<Link id="l02336" /><CodeLine lineNumber="2336"><Highlight kind="comment">           foo(d);</Highlight></CodeLine>
<Link id="l02337" /><CodeLine lineNumber="2337"><Highlight kind="comment">    &#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02338" /><CodeLine lineNumber="2338"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/uitofpinst">UIToFPInst</a> &#42;UCast = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;UIToFPInst&gt;</a>(CandidateUI-&gt;getUser())) &#123;</Highlight></CodeLine>
<Link id="l02339" /><CodeLine lineNumber="2339"><Highlight kind="normal">      IsSigned = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02340" /><CodeLine lineNumber="2340"><Highlight kind="normal">      DestTy = UCast-&gt;getDestTy();</Highlight></CodeLine>
<Link id="l02341" /><CodeLine lineNumber="2341"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02342" /><CodeLine lineNumber="2342"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/sitofpinst">SIToFPInst</a> &#42;SCast = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SIToFPInst&gt;</a>(CandidateUI-&gt;getUser())) &#123;</Highlight></CodeLine>
<Link id="l02343" /><CodeLine lineNumber="2343"><Highlight kind="normal">      IsSigned = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02344" /><CodeLine lineNumber="2344"><Highlight kind="normal">      DestTy = SCast-&gt;getDestTy();</Highlight></CodeLine>
<Link id="l02345" /><CodeLine lineNumber="2345"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02346" /><CodeLine lineNumber="2346"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DestTy) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02347" /><CodeLine lineNumber="2347"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02348" /><CodeLine lineNumber="2348"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If target does not support DestTy natively then do not apply</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02349" /><CodeLine lineNumber="2349"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// this transformation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02350" /><CodeLine lineNumber="2350"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isTypeLegal(DestTy)) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02351" /><CodeLine lineNumber="2351"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02352" /><CodeLine lineNumber="2352"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PH = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(ShadowUse-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0));</Highlight></CodeLine>
<Link id="l02353" /><CodeLine lineNumber="2353"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!PH) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02354" /><CodeLine lineNumber="2354"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PH-&gt;<a href="/docs/api/classes/llvm/phinode/#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>() != 2) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02355" /><CodeLine lineNumber="2355"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02356" /><CodeLine lineNumber="2356"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If the calculation in integers overflows, the result in FP type will</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02357" /><CodeLine lineNumber="2357"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// differ. So we only can do this transformation if we are guaranteed to not</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02358" /><CodeLine lineNumber="2358"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// deal with overflowing values</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02359" /><CodeLine lineNumber="2359"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(SE.getSCEV(PH));</Highlight></CodeLine>
<Link id="l02360" /><CodeLine lineNumber="2360"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AR) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02361" /><CodeLine lineNumber="2361"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsSigned &amp;&amp; !AR-&gt;<a href="/docs/api/classes/llvm/scevnaryexpr/#a71deee7ef49ab5407b7e1aa758b6ec0a">hasNoSignedWrap</a>()) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02362" /><CodeLine lineNumber="2362"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IsSigned &amp;&amp; !AR-&gt;<a href="/docs/api/classes/llvm/scevnaryexpr/#a09cc70290a71475141063b6dff42a5d2">hasNoUnsignedWrap</a>()) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02363" /><CodeLine lineNumber="2363"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02364" /><CodeLine lineNumber="2364"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;SrcTy = PH-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l02365" /><CodeLine lineNumber="2365"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> Mantissa = DestTy-&gt;<a href="/docs/api/classes/llvm/type/#ad9b99a13e459cb18bb386ddd610ecf8c">getFPMantissaWidth</a>();</Highlight></CodeLine>
<Link id="l02366" /><CodeLine lineNumber="2366"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Mantissa == -1) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02367" /><CodeLine lineNumber="2367"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((</Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal">)SE.getTypeSizeInBits(SrcTy) &gt; Mantissa)</Highlight></CodeLine>
<Link id="l02368" /><CodeLine lineNumber="2368"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02369" /><CodeLine lineNumber="2369"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02370" /><CodeLine lineNumber="2370"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/coff/#ae7629a0652411dc2be61aea4fee2b39caadd024eaaab0666500593f30456bbc43">Entry</a>, Latch;</Highlight></CodeLine>
<Link id="l02371" /><CodeLine lineNumber="2371"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PH-&gt;<a href="/docs/api/classes/llvm/phinode/#ac53e1aabdf64e91b8b325bcac250d8a9">getIncomingBlock</a>(0) == <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopPreheader()) &#123;</Highlight></CodeLine>
<Link id="l02372" /><CodeLine lineNumber="2372"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/coff/#ae7629a0652411dc2be61aea4fee2b39caadd024eaaab0666500593f30456bbc43">Entry</a> = 0;</Highlight></CodeLine>
<Link id="l02373" /><CodeLine lineNumber="2373"><Highlight kind="normal">      Latch = 1;</Highlight></CodeLine>
<Link id="l02374" /><CodeLine lineNumber="2374"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l02375" /><CodeLine lineNumber="2375"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/coff/#ae7629a0652411dc2be61aea4fee2b39caadd024eaaab0666500593f30456bbc43">Entry</a> = 1;</Highlight></CodeLine>
<Link id="l02376" /><CodeLine lineNumber="2376"><Highlight kind="normal">      Latch = 0;</Highlight></CodeLine>
<Link id="l02377" /><CodeLine lineNumber="2377"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02378" /><CodeLine lineNumber="2378"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02379" /><CodeLine lineNumber="2379"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;<a href="/docs/api/classes/llvm/init">Init</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(PH-&gt;<a href="/docs/api/classes/llvm/phinode/#aca1fd00f3ab63ec8f0f1ccc2093a9f6d">getIncomingValue</a>(Entry));</Highlight></CodeLine>
<Link id="l02380" /><CodeLine lineNumber="2380"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/classes/llvm/init">Init</a>) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02381" /><CodeLine lineNumber="2381"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;NewInit = ConstantFP::get(DestTy, IsSigned ?</Highlight></CodeLine>
<Link id="l02382" /><CodeLine lineNumber="2382"><Highlight kind="normal">                                        (</Highlight><Highlight kind="keywordtype">double</Highlight><Highlight kind="normal">)<a href="/docs/api/classes/llvm/init">Init</a>-&gt;getSExtValue() :</Highlight></CodeLine>
<Link id="l02383" /><CodeLine lineNumber="2383"><Highlight kind="normal">                                        (</Highlight><Highlight kind="keywordtype">double</Highlight><Highlight kind="normal">)<a href="/docs/api/classes/llvm/init">Init</a>-&gt;getZExtValue());</Highlight></CodeLine>
<Link id="l02384" /><CodeLine lineNumber="2384"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02385" /><CodeLine lineNumber="2385"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/binaryoperator">BinaryOperator</a> &#42;Incr =</Highlight></CodeLine>
<Link id="l02386" /><CodeLine lineNumber="2386"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;BinaryOperator&gt;</a>(PH-&gt;<a href="/docs/api/classes/llvm/phinode/#aca1fd00f3ab63ec8f0f1ccc2093a9f6d">getIncomingValue</a>(Latch));</Highlight></CodeLine>
<Link id="l02387" /><CodeLine lineNumber="2387"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Incr) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02388" /><CodeLine lineNumber="2388"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Incr-&gt;<a href="/docs/api/classes/llvm/binaryoperator/#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() != Instruction::Add</Highlight></CodeLine>
<Link id="l02389" /><CodeLine lineNumber="2389"><Highlight kind="normal">        &amp;&amp; Incr-&gt;<a href="/docs/api/classes/llvm/binaryoperator/#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() != Instruction::Sub)</Highlight></CodeLine>
<Link id="l02390" /><CodeLine lineNumber="2390"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02391" /><CodeLine lineNumber="2391"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02392" /><CodeLine lineNumber="2392"><Highlight kind="normal">    </Highlight><Highlight kind="comment">/&#42; Initialize new IV, double d = 0 in above example. &#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02393" /><CodeLine lineNumber="2393"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02394" /><CodeLine lineNumber="2394"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Incr-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0) == PH)</Highlight></CodeLine>
<Link id="l02395" /><CodeLine lineNumber="2395"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(Incr-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1));</Highlight></CodeLine>
<Link id="l02396" /><CodeLine lineNumber="2396"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Incr-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1) == PH)</Highlight></CodeLine>
<Link id="l02397" /><CodeLine lineNumber="2397"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(Incr-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0));</Highlight></CodeLine>
<Link id="l02398" /><CodeLine lineNumber="2398"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02399" /><CodeLine lineNumber="2399"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02400" /><CodeLine lineNumber="2400"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02401" /><CodeLine lineNumber="2401"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02402" /><CodeLine lineNumber="2402"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02403" /><CodeLine lineNumber="2403"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Ignore negative constants, as the code below doesn&#39;t handle them</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02404" /><CodeLine lineNumber="2404"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// correctly. TODO: Remove this restriction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02405" /><CodeLine lineNumber="2405"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue().isStrictlyPositive())</Highlight></CodeLine>
<Link id="l02406" /><CodeLine lineNumber="2406"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02407" /><CodeLine lineNumber="2407"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02408" /><CodeLine lineNumber="2408"><Highlight kind="normal">    </Highlight><Highlight kind="comment">/&#42; Add new PHINode. &#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02409" /><CodeLine lineNumber="2409"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;NewPH = <a href="/docs/api/classes/llvm/phinode/#af4aba918a76ca15bde1be3e14572e475">PHINode::Create</a>(DestTy, 2, </Highlight><Highlight kind="stringliteral">&quot;IV.S.&quot;</Highlight><Highlight kind="normal">, PH-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l02410" /><CodeLine lineNumber="2410"><Highlight kind="normal">    NewPH-&gt;<a href="/docs/api/classes/llvm/instruction/#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(PH-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</Highlight></CodeLine>
<Link id="l02411" /><CodeLine lineNumber="2411"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02412" /><CodeLine lineNumber="2412"><Highlight kind="normal">    </Highlight><Highlight kind="comment">/&#42; create new increment. &#39;++d&#39; in above example. &#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02413" /><CodeLine lineNumber="2413"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;CFP = ConstantFP::get(DestTy, <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getZExtValue());</Highlight></CodeLine>
<Link id="l02414" /><CodeLine lineNumber="2414"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/binaryoperator">BinaryOperator</a> &#42;NewIncr = <a href="/docs/api/classes/llvm/binaryoperator/#a8f385eda0f71b4e8199b296fbc8e0da9">BinaryOperator::Create</a>(</Highlight></CodeLine>
<Link id="l02415" /><CodeLine lineNumber="2415"><Highlight kind="normal">        Incr-&gt;<a href="/docs/api/classes/llvm/binaryoperator/#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() == Instruction::Add ? Instruction::FAdd</Highlight></CodeLine>
<Link id="l02416" /><CodeLine lineNumber="2416"><Highlight kind="normal">                                              : Instruction::FSub,</Highlight></CodeLine>
<Link id="l02417" /><CodeLine lineNumber="2417"><Highlight kind="normal">        NewPH, CFP, </Highlight><Highlight kind="stringliteral">&quot;IV.S.next.&quot;</Highlight><Highlight kind="normal">, Incr-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l02418" /><CodeLine lineNumber="2418"><Highlight kind="normal">    NewIncr-&gt;<a href="/docs/api/classes/llvm/instruction/#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(Incr-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</Highlight></CodeLine>
<Link id="l02419" /><CodeLine lineNumber="2419"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02420" /><CodeLine lineNumber="2420"><Highlight kind="normal">    NewPH-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewInit, PH-&gt;<a href="/docs/api/classes/llvm/phinode/#ac53e1aabdf64e91b8b325bcac250d8a9">getIncomingBlock</a>(Entry));</Highlight></CodeLine>
<Link id="l02421" /><CodeLine lineNumber="2421"><Highlight kind="normal">    NewPH-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewIncr, PH-&gt;<a href="/docs/api/classes/llvm/phinode/#ac53e1aabdf64e91b8b325bcac250d8a9">getIncomingBlock</a>(Latch));</Highlight></CodeLine>
<Link id="l02422" /><CodeLine lineNumber="2422"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02423" /><CodeLine lineNumber="2423"><Highlight kind="normal">    </Highlight><Highlight kind="comment">/&#42; Remove cast operation &#42;/</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02424" /><CodeLine lineNumber="2424"><Highlight kind="normal">    ShadowUse-&gt;<a href="/docs/api/classes/llvm/value/#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewPH);</Highlight></CodeLine>
<Link id="l02425" /><CodeLine lineNumber="2425"><Highlight kind="normal">    ShadowUse-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l02426" /><CodeLine lineNumber="2426"><Highlight kind="normal">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02427" /><CodeLine lineNumber="2427"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02428" /><CodeLine lineNumber="2428"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02429" /><CodeLine lineNumber="2429"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02430" /><CodeLine lineNumber="2430"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02431" /><CodeLine lineNumber="2431"><Highlight kind="comment">/// If Cond has an operand that is an expression of an IV, set the IV user and</Highlight></CodeLine>
<Link id="l02432" /><CodeLine lineNumber="2432"><Highlight kind="comment">/// stride information and return true, otherwise return false.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02433" /><CodeLine lineNumber="2433"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> LSRInstance::FindIVUserForCond(<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &#42;&amp;CondUse) &#123;</Highlight></CodeLine>
<Link id="l02434" /><CodeLine lineNumber="2434"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;U : IU)</Highlight></CodeLine>
<Link id="l02435" /><CodeLine lineNumber="2435"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser() == <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>) &#123;</Highlight></CodeLine>
<Link id="l02436" /><CodeLine lineNumber="2436"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// NOTE: we could handle setcc instructions with multiple uses here, but</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02437" /><CodeLine lineNumber="2437"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// InstCombine does it as well for simple uses, it&#39;s not clear that it</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02438" /><CodeLine lineNumber="2438"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// occurs enough in real life to handle.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02439" /><CodeLine lineNumber="2439"><Highlight kind="normal">      CondUse = &amp;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>;</Highlight></CodeLine>
<Link id="l02440" /><CodeLine lineNumber="2440"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02441" /><CodeLine lineNumber="2441"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02442" /><CodeLine lineNumber="2442"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02443" /><CodeLine lineNumber="2443"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02444" /><CodeLine lineNumber="2444"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02445" /><CodeLine lineNumber="2445"><Highlight kind="comment">/// Rewrite the loop&#39;s terminating condition if it uses a max computation.</Highlight></CodeLine>
<Link id="l02446" /><CodeLine lineNumber="2446"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02447" /><CodeLine lineNumber="2447"><Highlight kind="comment">/// This is a narrow solution to a specific, but acute, problem. For loops</Highlight></CodeLine>
<Link id="l02448" /><CodeLine lineNumber="2448"><Highlight kind="comment">/// like this:</Highlight></CodeLine>
<Link id="l02449" /><CodeLine lineNumber="2449"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02450" /><CodeLine lineNumber="2450"><Highlight kind="comment">///   i = 0;</Highlight></CodeLine>
<Link id="l02451" /><CodeLine lineNumber="2451"><Highlight kind="comment">///   do &#123;</Highlight></CodeLine>
<Link id="l02452" /><CodeLine lineNumber="2452"><Highlight kind="comment">///     p&#91;i&#93; = 0.0;</Highlight></CodeLine>
<Link id="l02453" /><CodeLine lineNumber="2453"><Highlight kind="comment">///   &#125; while (++i &lt; n);</Highlight></CodeLine>
<Link id="l02454" /><CodeLine lineNumber="2454"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02455" /><CodeLine lineNumber="2455"><Highlight kind="comment">/// the trip count isn&#39;t just &#39;n&#39;, because &#39;n&#39; might not be positive. And</Highlight></CodeLine>
<Link id="l02456" /><CodeLine lineNumber="2456"><Highlight kind="comment">/// unfortunately this can come up even for loops where the user didn&#39;t use</Highlight></CodeLine>
<Link id="l02457" /><CodeLine lineNumber="2457"><Highlight kind="comment">/// a C do-while loop. For example, seemingly well-behaved top-test loops</Highlight></CodeLine>
<Link id="l02458" /><CodeLine lineNumber="2458"><Highlight kind="comment">/// will commonly be lowered like this:</Highlight></CodeLine>
<Link id="l02459" /><CodeLine lineNumber="2459"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02460" /><CodeLine lineNumber="2460"><Highlight kind="comment">///   if (n &gt; 0) &#123;</Highlight></CodeLine>
<Link id="l02461" /><CodeLine lineNumber="2461"><Highlight kind="comment">///     i = 0;</Highlight></CodeLine>
<Link id="l02462" /><CodeLine lineNumber="2462"><Highlight kind="comment">///     do &#123;</Highlight></CodeLine>
<Link id="l02463" /><CodeLine lineNumber="2463"><Highlight kind="comment">///       p&#91;i&#93; = 0.0;</Highlight></CodeLine>
<Link id="l02464" /><CodeLine lineNumber="2464"><Highlight kind="comment">///     &#125; while (++i &lt; n);</Highlight></CodeLine>
<Link id="l02465" /><CodeLine lineNumber="2465"><Highlight kind="comment">///   &#125;</Highlight></CodeLine>
<Link id="l02466" /><CodeLine lineNumber="2466"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02467" /><CodeLine lineNumber="2467"><Highlight kind="comment">/// and then it&#39;s possible for subsequent optimization to obscure the if</Highlight></CodeLine>
<Link id="l02468" /><CodeLine lineNumber="2468"><Highlight kind="comment">/// test in such a way that indvars can&#39;t find it.</Highlight></CodeLine>
<Link id="l02469" /><CodeLine lineNumber="2469"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02470" /><CodeLine lineNumber="2470"><Highlight kind="comment">/// When indvars can&#39;t find the if test in loops like this, it creates a</Highlight></CodeLine>
<Link id="l02471" /><CodeLine lineNumber="2471"><Highlight kind="comment">/// max expression, which allows it to give the loop a canonical</Highlight></CodeLine>
<Link id="l02472" /><CodeLine lineNumber="2472"><Highlight kind="comment">/// induction variable:</Highlight></CodeLine>
<Link id="l02473" /><CodeLine lineNumber="2473"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02474" /><CodeLine lineNumber="2474"><Highlight kind="comment">///   i = 0;</Highlight></CodeLine>
<Link id="l02475" /><CodeLine lineNumber="2475"><Highlight kind="comment">///   max = n &lt; 1 ? 1 : n;</Highlight></CodeLine>
<Link id="l02476" /><CodeLine lineNumber="2476"><Highlight kind="comment">///   do &#123;</Highlight></CodeLine>
<Link id="l02477" /><CodeLine lineNumber="2477"><Highlight kind="comment">///     p&#91;i&#93; = 0.0;</Highlight></CodeLine>
<Link id="l02478" /><CodeLine lineNumber="2478"><Highlight kind="comment">///   &#125; while (++i != max);</Highlight></CodeLine>
<Link id="l02479" /><CodeLine lineNumber="2479"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02480" /><CodeLine lineNumber="2480"><Highlight kind="comment">/// Canonical induction variables are necessary because the loop passes</Highlight></CodeLine>
<Link id="l02481" /><CodeLine lineNumber="2481"><Highlight kind="comment">/// are designed around them. The most obvious example of this is the</Highlight></CodeLine>
<Link id="l02482" /><CodeLine lineNumber="2482"><Highlight kind="comment">/// LoopInfo analysis, which doesn&#39;t remember trip count values. It</Highlight></CodeLine>
<Link id="l02483" /><CodeLine lineNumber="2483"><Highlight kind="comment">/// expects to be able to rediscover the trip count each time it is</Highlight></CodeLine>
<Link id="l02484" /><CodeLine lineNumber="2484"><Highlight kind="comment">/// needed, and it does this using a simple analysis that only succeeds if</Highlight></CodeLine>
<Link id="l02485" /><CodeLine lineNumber="2485"><Highlight kind="comment">/// the loop has a canonical induction variable.</Highlight></CodeLine>
<Link id="l02486" /><CodeLine lineNumber="2486"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02487" /><CodeLine lineNumber="2487"><Highlight kind="comment">/// However, when it comes time to generate code, the maximum operation</Highlight></CodeLine>
<Link id="l02488" /><CodeLine lineNumber="2488"><Highlight kind="comment">/// can be quite costly, especially if it&#39;s inside of an outer loop.</Highlight></CodeLine>
<Link id="l02489" /><CodeLine lineNumber="2489"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02490" /><CodeLine lineNumber="2490"><Highlight kind="comment">/// This function solves this problem by detecting this type of loop and</Highlight></CodeLine>
<Link id="l02491" /><CodeLine lineNumber="2491"><Highlight kind="comment">/// rewriting their conditions from ICMP&#95;NE back to ICMP&#95;SLT, and deleting</Highlight></CodeLine>
<Link id="l02492" /><CodeLine lineNumber="2492"><Highlight kind="comment">/// the instructions for the maximum computation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02493" /><CodeLine lineNumber="2493"><Highlight kind="normal"><a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;LSRInstance::OptimizeMax(<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a>&#42; &amp;CondUse) &#123;</Highlight></CodeLine>
<Link id="l02494" /><CodeLine lineNumber="2494"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check that the loop matches the pattern we&#39;re looking for.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02495" /><CodeLine lineNumber="2495"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getPredicate() != <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP&#95;EQ</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l02496" /><CodeLine lineNumber="2496"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getPredicate() != <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP&#95;NE</a>)</Highlight></CodeLine>
<Link id="l02497" /><CodeLine lineNumber="2497"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02498" /><CodeLine lineNumber="2498"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02499" /><CodeLine lineNumber="2499"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/selectinst">SelectInst</a> &#42;Sel = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SelectInst&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getOperand(1));</Highlight></CodeLine>
<Link id="l02500" /><CodeLine lineNumber="2500"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Sel || !Sel-&gt;<a href="/docs/api/classes/llvm/value/#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>()) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02501" /><CodeLine lineNumber="2501"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02502" /><CodeLine lineNumber="2502"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BackedgeTakenCount = SE.getBackedgeTakenCount(L);</Highlight></CodeLine>
<Link id="l02503" /><CodeLine lineNumber="2503"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVCouldNotCompute&gt;</a>(BackedgeTakenCount))</Highlight></CodeLine>
<Link id="l02504" /><CodeLine lineNumber="2504"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02505" /><CodeLine lineNumber="2505"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;One = SE.getConstant(BackedgeTakenCount-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>(), 1);</Highlight></CodeLine>
<Link id="l02506" /><CodeLine lineNumber="2506"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02507" /><CodeLine lineNumber="2507"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Add one to the backedge-taken count to get the trip count.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02508" /><CodeLine lineNumber="2508"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IterationCount = SE.getAddExpr(One, BackedgeTakenCount);</Highlight></CodeLine>
<Link id="l02509" /><CodeLine lineNumber="2509"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IterationCount != SE.getSCEV(Sel)) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02510" /><CodeLine lineNumber="2510"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02511" /><CodeLine lineNumber="2511"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check for a max calculation that matches the pattern. There&#39;s no check</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02512" /><CodeLine lineNumber="2512"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// for ICMP&#95;ULE here because the comparison would be with zero, which</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02513" /><CodeLine lineNumber="2513"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// isn&#39;t interesting.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02514" /><CodeLine lineNumber="2514"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05">ICmpInst::BAD&#95;ICMP&#95;PREDICATE</a>;</Highlight></CodeLine>
<Link id="l02515" /><CodeLine lineNumber="2515"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevnaryexpr">SCEVNAryExpr</a> &#42;<a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02516" /><CodeLine lineNumber="2516"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevsmaxexpr">SCEVSMaxExpr</a> &#42;S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVSMaxExpr&gt;</a>(BackedgeTakenCount)) &#123;</Highlight></CodeLine>
<Link id="l02517" /><CodeLine lineNumber="2517"><Highlight kind="normal">    Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba2751d6136a2819749dcef65dc19a4246">ICmpInst::ICMP&#95;SLE</a>;</Highlight></CodeLine>
<Link id="l02518" /><CodeLine lineNumber="2518"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = S;</Highlight></CodeLine>
<Link id="l02519" /><CodeLine lineNumber="2519"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevsmaxexpr">SCEVSMaxExpr</a> &#42;S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVSMaxExpr&gt;</a>(IterationCount)) &#123;</Highlight></CodeLine>
<Link id="l02520" /><CodeLine lineNumber="2520"><Highlight kind="normal">    Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP&#95;SLT</a>;</Highlight></CodeLine>
<Link id="l02521" /><CodeLine lineNumber="2521"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = S;</Highlight></CodeLine>
<Link id="l02522" /><CodeLine lineNumber="2522"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevumaxexpr">SCEVUMaxExpr</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUMaxExpr&gt;</a>(IterationCount)) &#123;</Highlight></CodeLine>
<Link id="l02523" /><CodeLine lineNumber="2523"><Highlight kind="normal">    Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">ICmpInst::ICMP&#95;ULT</a>;</Highlight></CodeLine>
<Link id="l02524" /><CodeLine lineNumber="2524"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>;</Highlight></CodeLine>
<Link id="l02525" /><CodeLine lineNumber="2525"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l02526" /><CodeLine lineNumber="2526"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// No match; bail.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02527" /><CodeLine lineNumber="2527"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02528" /><CodeLine lineNumber="2528"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02529" /><CodeLine lineNumber="2529"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02530" /><CodeLine lineNumber="2530"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// To handle a max with more than two operands, this optimization would</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02531" /><CodeLine lineNumber="2531"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// require additional checking and setup.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02532" /><CodeLine lineNumber="2532"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a>-&gt;getNumOperands() != 2)</Highlight></CodeLine>
<Link id="l02533" /><CodeLine lineNumber="2533"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02534" /><CodeLine lineNumber="2534"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02535" /><CodeLine lineNumber="2535"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;MaxLHS = <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a>-&gt;getOperand(0);</Highlight></CodeLine>
<Link id="l02536" /><CodeLine lineNumber="2536"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;MaxRHS = <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a>-&gt;getOperand(1);</Highlight></CodeLine>
<Link id="l02537" /><CodeLine lineNumber="2537"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02538" /><CodeLine lineNumber="2538"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ScalarEvolution canonicalizes constants to the left. For &lt; and &gt;, look</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02539" /><CodeLine lineNumber="2539"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// for a comparison with 1 For &lt;= and &gt;=, a comparison with zero.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02540" /><CodeLine lineNumber="2540"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!MaxLHS ||</Highlight></CodeLine>
<Link id="l02541" /><CodeLine lineNumber="2541"><Highlight kind="normal">      (<a href="/docs/api/classes/llvm/cmpinst/#a5ba8484cef2818d14b85640a903b2598">ICmpInst::isTrueWhenEqual</a>(Pred) ? !MaxLHS-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>() : (MaxLHS != One)))</Highlight></CodeLine>
<Link id="l02542" /><CodeLine lineNumber="2542"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02543" /><CodeLine lineNumber="2543"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02544" /><CodeLine lineNumber="2544"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check the relevant induction variable for conformance to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02545" /><CodeLine lineNumber="2545"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the pattern.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02546" /><CodeLine lineNumber="2546"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> = SE.getSCEV(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getOperand(0));</Highlight></CodeLine>
<Link id="l02547" /><CodeLine lineNumber="2547"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>);</Highlight></CodeLine>
<Link id="l02548" /><CodeLine lineNumber="2548"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AR || !AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>() ||</Highlight></CodeLine>
<Link id="l02549" /><CodeLine lineNumber="2549"><Highlight kind="normal">      AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>() != One ||</Highlight></CodeLine>
<Link id="l02550" /><CodeLine lineNumber="2550"><Highlight kind="normal">      AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE) != One)</Highlight></CodeLine>
<Link id="l02551" /><CodeLine lineNumber="2551"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02552" /><CodeLine lineNumber="2552"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02553" /><CodeLine lineNumber="2553"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L &amp;&amp;</Highlight></CodeLine>
<Link id="l02554" /><CodeLine lineNumber="2554"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Loop condition operand is an addrec in a different loop!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02555" /><CodeLine lineNumber="2555"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02556" /><CodeLine lineNumber="2556"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check the right operand of the select, and remember it, as it will</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02557" /><CodeLine lineNumber="2557"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// be used in the new comparison instruction.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02558" /><CodeLine lineNumber="2558"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;NewRHS = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02559" /><CodeLine lineNumber="2559"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/cmpinst/#a5ba8484cef2818d14b85640a903b2598">ICmpInst::isTrueWhenEqual</a>(Pred)) &#123;</Highlight></CodeLine>
<Link id="l02560" /><CodeLine lineNumber="2560"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Look for n+1, and grab n.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02561" /><CodeLine lineNumber="2561"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/addoperator">AddOperator</a> &#42;BO = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AddOperator&gt;</a>(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1)))</Highlight></CodeLine>
<Link id="l02562" /><CodeLine lineNumber="2562"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;BO1 = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(BO-&gt;getOperand(1)))</Highlight></CodeLine>
<Link id="l02563" /><CodeLine lineNumber="2563"><Highlight kind="normal">         </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BO1-&gt;isOne() &amp;&amp; SE.getSCEV(BO-&gt;getOperand(0)) == MaxRHS)</Highlight></CodeLine>
<Link id="l02564" /><CodeLine lineNumber="2564"><Highlight kind="normal">           NewRHS = BO-&gt;getOperand(0);</Highlight></CodeLine>
<Link id="l02565" /><CodeLine lineNumber="2565"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/addoperator">AddOperator</a> &#42;BO = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AddOperator&gt;</a>(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(2)))</Highlight></CodeLine>
<Link id="l02566" /><CodeLine lineNumber="2566"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;BO1 = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(BO-&gt;getOperand(1)))</Highlight></CodeLine>
<Link id="l02567" /><CodeLine lineNumber="2567"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BO1-&gt;isOne() &amp;&amp; SE.getSCEV(BO-&gt;getOperand(0)) == MaxRHS)</Highlight></CodeLine>
<Link id="l02568" /><CodeLine lineNumber="2568"><Highlight kind="normal">          NewRHS = BO-&gt;getOperand(0);</Highlight></CodeLine>
<Link id="l02569" /><CodeLine lineNumber="2569"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!NewRHS)</Highlight></CodeLine>
<Link id="l02570" /><CodeLine lineNumber="2570"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02571" /><CodeLine lineNumber="2571"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getSCEV(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1)) == MaxRHS)</Highlight></CodeLine>
<Link id="l02572" /><CodeLine lineNumber="2572"><Highlight kind="normal">    NewRHS = Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1);</Highlight></CodeLine>
<Link id="l02573" /><CodeLine lineNumber="2573"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getSCEV(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(2)) == MaxRHS)</Highlight></CodeLine>
<Link id="l02574" /><CodeLine lineNumber="2574"><Highlight kind="normal">    NewRHS = Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(2);</Highlight></CodeLine>
<Link id="l02575" /><CodeLine lineNumber="2575"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;SU = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(MaxRHS))</Highlight></CodeLine>
<Link id="l02576" /><CodeLine lineNumber="2576"><Highlight kind="normal">    NewRHS = SU-&gt;getValue();</Highlight></CodeLine>
<Link id="l02577" /><CodeLine lineNumber="2577"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02578" /><CodeLine lineNumber="2578"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Max doesn&#39;t match expected pattern.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02579" /><CodeLine lineNumber="2579"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02580" /><CodeLine lineNumber="2580"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02581" /><CodeLine lineNumber="2581"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Determine the new comparison opcode. It may be signed or unsigned,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02582" /><CodeLine lineNumber="2582"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and the original comparison may be either equality or inequality.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02583" /><CodeLine lineNumber="2583"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getPredicate() == <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP&#95;EQ</a>)</Highlight></CodeLine>
<Link id="l02584" /><CodeLine lineNumber="2584"><Highlight kind="normal">    Pred = <a href="/docs/api/classes/llvm/cmpinst/#aa2a54b545d237ecfe450fd1292f7675e">CmpInst::getInversePredicate</a>(Pred);</Highlight></CodeLine>
<Link id="l02585" /><CodeLine lineNumber="2585"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02586" /><CodeLine lineNumber="2586"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ok, everything looks ok to change the condition into an SLT or SGE and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02587" /><CodeLine lineNumber="2587"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// delete the max calculation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02588" /><CodeLine lineNumber="2588"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;NewCond = </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getIterator(), Pred,</Highlight></CodeLine>
<Link id="l02589" /><CodeLine lineNumber="2589"><Highlight kind="normal">                                   <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getOperand(0), NewRHS, </Highlight><Highlight kind="stringliteral">&quot;scmp&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02590" /><CodeLine lineNumber="2590"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02591" /><CodeLine lineNumber="2591"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Delete the max calculation instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02592" /><CodeLine lineNumber="2592"><Highlight kind="normal">  NewCond-&gt;<a href="/docs/api/classes/llvm/instruction/#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getDebugLoc());</Highlight></CodeLine>
<Link id="l02593" /><CodeLine lineNumber="2593"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;replaceAllUsesWith(NewCond);</Highlight></CodeLine>
<Link id="l02594" /><CodeLine lineNumber="2594"><Highlight kind="normal">  CondUse-&gt;<a href="/docs/api/classes/llvm/ivstrideuse/#acb8718e691dfd2e5d5a3e0d876e35cc9">setUser</a>(NewCond);</Highlight></CodeLine>
<Link id="l02595" /><CodeLine lineNumber="2595"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0));</Highlight></CodeLine>
<Link id="l02596" /><CodeLine lineNumber="2596"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l02597" /><CodeLine lineNumber="2597"><Highlight kind="normal">  Sel-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</Highlight></CodeLine>
<Link id="l02598" /><CodeLine lineNumber="2598"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;use&#95;empty())</Highlight></CodeLine>
<Link id="l02599" /><CodeLine lineNumber="2599"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;eraseFromParent();</Highlight></CodeLine>
<Link id="l02600" /><CodeLine lineNumber="2600"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> NewCond;</Highlight></CodeLine>
<Link id="l02601" /><CodeLine lineNumber="2601"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02602" /><CodeLine lineNumber="2602"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02603" /><CodeLine lineNumber="2603"><Highlight kind="comment">/// Change loop terminating condition to use the postinc iv when possible.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02604" /><CodeLine lineNumber="2604"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02605" /><CodeLine lineNumber="2605"><Highlight kind="normal">LSRInstance::OptimizeLoopTermCond() &#123;</Highlight></CodeLine>
<Link id="l02606" /><CodeLine lineNumber="2606"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction &#42;, 4&gt;</a> PostIncs;</Highlight></CodeLine>
<Link id="l02607" /><CodeLine lineNumber="2607"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02608" /><CodeLine lineNumber="2608"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We need a different set of heuristics for rotated and non-rotated loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02609" /><CodeLine lineNumber="2609"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If a loop is rotated then the latch is also the backedge, so inserting</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02610" /><CodeLine lineNumber="2610"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// post-inc expressions just before the latch is ideal. To reduce live ranges</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02611" /><CodeLine lineNumber="2611"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// it also makes sense to rewrite terminating conditions to use post-inc</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02612" /><CodeLine lineNumber="2612"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// expressions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02613" /><CodeLine lineNumber="2613"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02614" /><CodeLine lineNumber="2614"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If the loop is not rotated then the latch is not a backedge; the latch</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02615" /><CodeLine lineNumber="2615"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// check is done in the loop head. Adding post-inc expressions before the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02616" /><CodeLine lineNumber="2616"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// latch will cause overlapping live-ranges of pre-inc and post-inc expressions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02617" /><CodeLine lineNumber="2617"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// in the loop body. In this case we do &#42;not&#42; want to use post-inc expressions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02618" /><CodeLine lineNumber="2618"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// in the latch check, and we want to insert post-inc expressions before</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02619" /><CodeLine lineNumber="2619"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the backedge.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02620" /><CodeLine lineNumber="2620"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;LatchBlock = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch();</Highlight></CodeLine>
<Link id="l02621" /><CodeLine lineNumber="2621"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock&#42;, 8&gt;</a> ExitingBlocks;</Highlight></CodeLine>
<Link id="l02622" /><CodeLine lineNumber="2622"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getExitingBlocks(ExitingBlocks);</Highlight></CodeLine>
<Link id="l02623" /><CodeLine lineNumber="2623"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#acd1cd968cb420c82d70926920fcdc7d7">llvm::is&#95;contained</a>(ExitingBlocks, LatchBlock)) &#123;</Highlight></CodeLine>
<Link id="l02624" /><CodeLine lineNumber="2624"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The backedge doesn&#39;t exit the loop; treat this as a head-tested loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02625" /><CodeLine lineNumber="2625"><Highlight kind="normal">    IVIncInsertPos = LatchBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l02626" /><CodeLine lineNumber="2626"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02627" /><CodeLine lineNumber="2627"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02628" /><CodeLine lineNumber="2628"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02629" /><CodeLine lineNumber="2629"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Otherwise treat this as a rotated loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02630" /><CodeLine lineNumber="2630"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ExitingBlock : ExitingBlocks) &#123;</Highlight></CodeLine>
<Link id="l02631" /><CodeLine lineNumber="2631"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Get the terminating condition for the loop if possible.  If we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02632" /><CodeLine lineNumber="2632"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// can, we want to change it to use a post-incremented version of its</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02633" /><CodeLine lineNumber="2633"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// induction variable, to allow coalescing the live ranges for the IV into</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02634" /><CodeLine lineNumber="2634"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// one register value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02635" /><CodeLine lineNumber="2635"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02636" /><CodeLine lineNumber="2636"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/branchinst">BranchInst</a> &#42;TermBr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;BranchInst&gt;</a>(ExitingBlock-&gt;getTerminator());</Highlight></CodeLine>
<Link id="l02637" /><CodeLine lineNumber="2637"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!TermBr)</Highlight></CodeLine>
<Link id="l02638" /><CodeLine lineNumber="2638"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02639" /><CodeLine lineNumber="2639"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// FIXME: Overly conservative, termination condition could be an &#39;or&#39; etc..</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02640" /><CodeLine lineNumber="2640"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TermBr-&gt;<a href="/docs/api/classes/llvm/branchinst/#ad56f6a9b5cd05940017c4544df48bc30">isUnconditional</a>() || !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;ICmpInst&gt;</a>(TermBr-&gt;<a href="/docs/api/classes/llvm/branchinst/#aebd4af5642453ce3169094f08dd3d7b8">getCondition</a>()))</Highlight></CodeLine>
<Link id="l02641" /><CodeLine lineNumber="2641"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02642" /><CodeLine lineNumber="2642"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02643" /><CodeLine lineNumber="2643"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Search IVUsesByStride to find Cond&#39;s IVUse if there is one.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02644" /><CodeLine lineNumber="2644"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &#42;CondUse = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02645" /><CodeLine lineNumber="2645"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ICmpInst&gt;</a>(TermBr-&gt;<a href="/docs/api/classes/llvm/branchinst/#aebd4af5642453ce3169094f08dd3d7b8">getCondition</a>());</Highlight></CodeLine>
<Link id="l02646" /><CodeLine lineNumber="2646"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!FindIVUserForCond(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, CondUse))</Highlight></CodeLine>
<Link id="l02647" /><CodeLine lineNumber="2647"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02648" /><CodeLine lineNumber="2648"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02649" /><CodeLine lineNumber="2649"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If the trip count is computed in terms of a max (due to ScalarEvolution</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02650" /><CodeLine lineNumber="2650"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// being unable to find a sufficient guard, for example), change the loop</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02651" /><CodeLine lineNumber="2651"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// comparison to use SLT or ULT instead of NE.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02652" /><CodeLine lineNumber="2652"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// One consequence of doing this now is that it disrupts the count-down</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02653" /><CodeLine lineNumber="2653"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// optimization. That&#39;s not always a bad thing though, because in such</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02654" /><CodeLine lineNumber="2654"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// cases it may still be worthwhile to avoid a max.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02655" /><CodeLine lineNumber="2655"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = OptimizeMax(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, CondUse);</Highlight></CodeLine>
<Link id="l02656" /><CodeLine lineNumber="2656"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02657" /><CodeLine lineNumber="2657"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If this exiting block dominates the latch block, it may also use</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02658" /><CodeLine lineNumber="2658"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the post-inc value if it won&#39;t be shared with other uses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02659" /><CodeLine lineNumber="2659"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check for dominance.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02660" /><CodeLine lineNumber="2660"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DT.dominates(ExitingBlock, LatchBlock))</Highlight></CodeLine>
<Link id="l02661" /><CodeLine lineNumber="2661"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02662" /><CodeLine lineNumber="2662"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02663" /><CodeLine lineNumber="2663"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Conservatively avoid trying to use the post-inc value in non-latch</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02664" /><CodeLine lineNumber="2664"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// exits if there may be pre-inc users in intervening blocks.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02665" /><CodeLine lineNumber="2665"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LatchBlock != ExitingBlock)</Highlight></CodeLine>
<Link id="l02666" /><CodeLine lineNumber="2666"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;UI : IU)</Highlight></CodeLine>
<Link id="l02667" /><CodeLine lineNumber="2667"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Test if the use is reachable from the exiting block. This dominator</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02668" /><CodeLine lineNumber="2668"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// query is a conservative approximation of reachability.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02669" /><CodeLine lineNumber="2669"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (&amp;UI != CondUse &amp;&amp;</Highlight></CodeLine>
<Link id="l02670" /><CodeLine lineNumber="2670"><Highlight kind="normal">            !DT.properlyDominates(UI.getUser()-&gt;getParent(), ExitingBlock)) &#123;</Highlight></CodeLine>
<Link id="l02671" /><CodeLine lineNumber="2671"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// Conservatively assume there may be reuse if the quotient of their</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02672" /><CodeLine lineNumber="2672"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// strides could be a legal scale.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02673" /><CodeLine lineNumber="2673"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a> = IU.getStride(&#42;CondUse, L);</Highlight></CodeLine>
<Link id="l02674" /><CodeLine lineNumber="2674"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a> = IU.getStride(UI, L);</Highlight></CodeLine>
<Link id="l02675" /><CodeLine lineNumber="2675"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a> || !<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02676" /><CodeLine lineNumber="2676"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getTypeSizeInBits(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getType()) !=</Highlight></CodeLine>
<Link id="l02677" /><CodeLine lineNumber="2677"><Highlight kind="normal">              SE.getTypeSizeInBits(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;getType())) &#123;</Highlight></CodeLine>
<Link id="l02678" /><CodeLine lineNumber="2678"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getTypeSizeInBits(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getType()) &gt;</Highlight></CodeLine>
<Link id="l02679" /><CodeLine lineNumber="2679"><Highlight kind="normal">                SE.getTypeSizeInBits(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;getType()))</Highlight></CodeLine>
<Link id="l02680" /><CodeLine lineNumber="2680"><Highlight kind="normal">              <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a> = SE.getSignExtendExpr(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getType());</Highlight></CodeLine>
<Link id="l02681" /><CodeLine lineNumber="2681"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02682" /><CodeLine lineNumber="2682"><Highlight kind="normal">              <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a> = SE.getSignExtendExpr(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;getType());</Highlight></CodeLine>
<Link id="l02683" /><CodeLine lineNumber="2683"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l02684" /><CodeLine lineNumber="2684"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a> =</Highlight></CodeLine>
<Link id="l02685" /><CodeLine lineNumber="2685"><Highlight kind="normal">                <a href="/docs/api/namespaces/llvm/#a5f6182886dc2f96c204299e92c1565d5">dyn&#95;cast&#95;or&#95;null&lt;SCEVConstant&gt;</a>(<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, SE))) &#123;</Highlight></CodeLine>
<Link id="l02686" /><CodeLine lineNumber="2686"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>-&gt;getValue();</Highlight></CodeLine>
<Link id="l02687" /><CodeLine lineNumber="2687"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// Stride of one or negative one can have reuse with non-addresses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02688" /><CodeLine lineNumber="2688"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;isOne() || <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;isMinusOne())</Highlight></CodeLine>
<Link id="l02689" /><CodeLine lineNumber="2689"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">goto</Highlight><Highlight kind="normal"> decline&#95;post&#95;inc;</Highlight></CodeLine>
<Link id="l02690" /><CodeLine lineNumber="2690"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// Avoid weird situations.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02691" /><CodeLine lineNumber="2691"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue().getSignificantBits() &gt;= 64 ||</Highlight></CodeLine>
<Link id="l02692" /><CodeLine lineNumber="2692"><Highlight kind="normal">                <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue().isMinSignedValue())</Highlight></CodeLine>
<Link id="l02693" /><CodeLine lineNumber="2693"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">goto</Highlight><Highlight kind="normal"> decline&#95;post&#95;inc;</Highlight></CodeLine>
<Link id="l02694" /><CodeLine lineNumber="2694"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// Check for possible scaled-address reuse.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02695" /><CodeLine lineNumber="2695"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UI.getUser(), UI.getOperandValToReplace())) &#123;</Highlight></CodeLine>
<Link id="l02696" /><CodeLine lineNumber="2696"><Highlight kind="normal">              MemAccessTy AccessTy =</Highlight></CodeLine>
<Link id="l02697" /><CodeLine lineNumber="2697"><Highlight kind="normal">                  <a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UI.getUser(), UI.getOperandValToReplace());</Highlight></CodeLine>
<Link id="l02698" /><CodeLine lineNumber="2698"><Highlight kind="normal">              int64&#95;t Scale = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getSExtValue();</Highlight></CodeLine>
<Link id="l02699" /><CodeLine lineNumber="2699"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(AccessTy.MemTy, </Highlight><Highlight kind="comment">/&#42;BaseGV=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02700" /><CodeLine lineNumber="2700"><Highlight kind="normal">                                            </Highlight><Highlight kind="comment">/&#42;BaseOffset=&#42;/</Highlight><Highlight kind="normal">0,</Highlight></CodeLine>
<Link id="l02701" /><CodeLine lineNumber="2701"><Highlight kind="normal">                                            </Highlight><Highlight kind="comment">/&#42;HasBaseReg=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, Scale,</Highlight></CodeLine>
<Link id="l02702" /><CodeLine lineNumber="2702"><Highlight kind="normal">                                            AccessTy.AddrSpace))</Highlight></CodeLine>
<Link id="l02703" /><CodeLine lineNumber="2703"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">goto</Highlight><Highlight kind="normal"> decline&#95;post&#95;inc;</Highlight></CodeLine>
<Link id="l02704" /><CodeLine lineNumber="2704"><Highlight kind="normal">              Scale = -Scale;</Highlight></CodeLine>
<Link id="l02705" /><CodeLine lineNumber="2705"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(AccessTy.MemTy, </Highlight><Highlight kind="comment">/&#42;BaseGV=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02706" /><CodeLine lineNumber="2706"><Highlight kind="normal">                                            </Highlight><Highlight kind="comment">/&#42;BaseOffset=&#42;/</Highlight><Highlight kind="normal">0,</Highlight></CodeLine>
<Link id="l02707" /><CodeLine lineNumber="2707"><Highlight kind="normal">                                            </Highlight><Highlight kind="comment">/&#42;HasBaseReg=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, Scale,</Highlight></CodeLine>
<Link id="l02708" /><CodeLine lineNumber="2708"><Highlight kind="normal">                                            AccessTy.AddrSpace))</Highlight></CodeLine>
<Link id="l02709" /><CodeLine lineNumber="2709"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">goto</Highlight><Highlight kind="normal"> decline&#95;post&#95;inc;</Highlight></CodeLine>
<Link id="l02710" /><CodeLine lineNumber="2710"><Highlight kind="normal">            &#125;</Highlight></CodeLine>
<Link id="l02711" /><CodeLine lineNumber="2711"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l02712" /><CodeLine lineNumber="2712"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l02713" /><CodeLine lineNumber="2713"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02714" /><CodeLine lineNumber="2714"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Change loop exiting icmp to use postinc iv: &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02715" /><CodeLine lineNumber="2715"><Highlight kind="normal">                      &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02716" /><CodeLine lineNumber="2716"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02717" /><CodeLine lineNumber="2717"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// It&#39;s possible for the setcc instruction to be anywhere in the loop, and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02718" /><CodeLine lineNumber="2718"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// possible for it to have multiple users.  If it is not immediately before</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02719" /><CodeLine lineNumber="2719"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the exiting block branch, move it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02720" /><CodeLine lineNumber="2720"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getNextNonDebugInstruction() != TermBr) &#123;</Highlight></CodeLine>
<Link id="l02721" /><CodeLine lineNumber="2721"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;hasOneUse()) &#123;</Highlight></CodeLine>
<Link id="l02722" /><CodeLine lineNumber="2722"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;moveBefore(TermBr-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l02723" /><CodeLine lineNumber="2723"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l02724" /><CodeLine lineNumber="2724"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Clone the terminating condition and insert into the loopend.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02725" /><CodeLine lineNumber="2725"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;OldCond = <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</Highlight></CodeLine>
<Link id="l02726" /><CodeLine lineNumber="2726"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ICmpInst&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;clone());</Highlight></CodeLine>
<Link id="l02727" /><CodeLine lineNumber="2727"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;setName(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getName() + </Highlight><Highlight kind="stringliteral">&quot;.termcond&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l02728" /><CodeLine lineNumber="2728"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;insertInto(ExitingBlock, TermBr-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l02729" /><CodeLine lineNumber="2729"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02730" /><CodeLine lineNumber="2730"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Clone the IVUse, as the old use still exists!</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02731" /><CodeLine lineNumber="2731"><Highlight kind="normal">        CondUse = &amp;IU.AddUser(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, CondUse-&gt;<a href="/docs/api/classes/llvm/ivstrideuse/#a850ce8990175a8dc4e5a641df3db14aa">getOperandValToReplace</a>());</Highlight></CodeLine>
<Link id="l02732" /><CodeLine lineNumber="2732"><Highlight kind="normal">        TermBr-&gt;<a href="/docs/api/classes/llvm/user/#a1600c7959045cb6b6a5f5a1d427ec67e">replaceUsesOfWith</a>(OldCond, <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>);</Highlight></CodeLine>
<Link id="l02733" /><CodeLine lineNumber="2733"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02734" /><CodeLine lineNumber="2734"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02735" /><CodeLine lineNumber="2735"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02736" /><CodeLine lineNumber="2736"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If we get to here, we know that we can transform the setcc instruction to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02737" /><CodeLine lineNumber="2737"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// use the post-incremented version of the IV, allowing us to coalesce the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02738" /><CodeLine lineNumber="2738"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// live ranges for the IV correctly.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02739" /><CodeLine lineNumber="2739"><Highlight kind="normal">    CondUse-&gt;<a href="/docs/api/classes/llvm/ivstrideuse/#a8433a09d9b66df4f5c8a4d1414dc8ec9">transformToPostInc</a>(L);</Highlight></CodeLine>
<Link id="l02740" /><CodeLine lineNumber="2740"><Highlight kind="normal">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02741" /><CodeLine lineNumber="2741"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02742" /><CodeLine lineNumber="2742"><Highlight kind="normal">    PostIncs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>);</Highlight></CodeLine>
<Link id="l02743" /><CodeLine lineNumber="2743"><Highlight kind="normal">  decline&#95;post&#95;inc:;</Highlight></CodeLine>
<Link id="l02744" /><CodeLine lineNumber="2744"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02745" /><CodeLine lineNumber="2745"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02746" /><CodeLine lineNumber="2746"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Determine an insertion point for the loop induction variable increment. It</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02747" /><CodeLine lineNumber="2747"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// must dominate all the post-inc comparisons we just set up, and it must</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02748" /><CodeLine lineNumber="2748"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// dominate the loop latch edge.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02749" /><CodeLine lineNumber="2749"><Highlight kind="normal">  IVIncInsertPos = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()-&gt;getTerminator();</Highlight></CodeLine>
<Link id="l02750" /><CodeLine lineNumber="2750"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst : PostIncs)</Highlight></CodeLine>
<Link id="l02751" /><CodeLine lineNumber="2751"><Highlight kind="normal">    IVIncInsertPos = DT.findNearestCommonDominator(IVIncInsertPos, Inst);</Highlight></CodeLine>
<Link id="l02752" /><CodeLine lineNumber="2752"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02753" /><CodeLine lineNumber="2753"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02754" /><CodeLine lineNumber="2754"><Highlight kind="comment">/// Determine if the given use can accommodate a fixup at the given offset and</Highlight></CodeLine>
<Link id="l02755" /><CodeLine lineNumber="2755"><Highlight kind="comment">/// other details. If so, update the use and return true.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02756" /><CodeLine lineNumber="2756"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> LSRInstance::reconcileNewOffset(LSRUse &amp;LU, Immediate NewOffset,</Highlight></CodeLine>
<Link id="l02757" /><CodeLine lineNumber="2757"><Highlight kind="normal">                                     </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasBaseReg, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</Highlight></CodeLine>
<Link id="l02758" /><CodeLine lineNumber="2758"><Highlight kind="normal">                                     MemAccessTy AccessTy) &#123;</Highlight></CodeLine>
<Link id="l02759" /><CodeLine lineNumber="2759"><Highlight kind="normal">  Immediate NewMinOffset = LU.MinOffset;</Highlight></CodeLine>
<Link id="l02760" /><CodeLine lineNumber="2760"><Highlight kind="normal">  Immediate NewMaxOffset = LU.MaxOffset;</Highlight></CodeLine>
<Link id="l02761" /><CodeLine lineNumber="2761"><Highlight kind="normal">  MemAccessTy NewAccessTy = AccessTy;</Highlight></CodeLine>
<Link id="l02762" /><CodeLine lineNumber="2762"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02763" /><CodeLine lineNumber="2763"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check for a mismatched kind. It&#39;s tempting to collapse mismatched kinds to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02764" /><CodeLine lineNumber="2764"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// something conservative, however this can pessimize in the case that one of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02765" /><CodeLine lineNumber="2765"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the uses will have all its uses outside the loop, for example.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02766" /><CodeLine lineNumber="2766"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind != Kind)</Highlight></CodeLine>
<Link id="l02767" /><CodeLine lineNumber="2767"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02768" /><CodeLine lineNumber="2768"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02769" /><CodeLine lineNumber="2769"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check for a mismatched access type, and fall back conservatively as needed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02770" /><CodeLine lineNumber="2770"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Be less conservative when the type is similar and can use the same</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02771" /><CodeLine lineNumber="2771"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// addressing modes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02772" /><CodeLine lineNumber="2772"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>) &#123;</Highlight></CodeLine>
<Link id="l02773" /><CodeLine lineNumber="2773"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AccessTy.MemTy != LU.AccessTy.MemTy) &#123;</Highlight></CodeLine>
<Link id="l02774" /><CodeLine lineNumber="2774"><Highlight kind="normal">      NewAccessTy = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a153bbcee36817bcedb110f30d95b2368">MemAccessTy::getUnknown</a>(AccessTy.MemTy-&gt;getContext(),</Highlight></CodeLine>
<Link id="l02775" /><CodeLine lineNumber="2775"><Highlight kind="normal">                                            AccessTy.AddrSpace);</Highlight></CodeLine>
<Link id="l02776" /><CodeLine lineNumber="2776"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02777" /><CodeLine lineNumber="2777"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02778" /><CodeLine lineNumber="2778"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02779" /><CodeLine lineNumber="2779"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Conservatively assume HasBaseReg is true for now.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02780" /><CodeLine lineNumber="2780"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a83e6442f8ebefccdb5e089732fe397ac">Immediate::isKnownLT</a>(NewOffset, LU.MinOffset)) &#123;</Highlight></CodeLine>
<Link id="l02781" /><CodeLine lineNumber="2781"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, NewAccessTy, </Highlight><Highlight kind="comment">/&#42;BaseGV=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02782" /><CodeLine lineNumber="2782"><Highlight kind="normal">                          LU.MaxOffset - NewOffset, HasBaseReg))</Highlight></CodeLine>
<Link id="l02783" /><CodeLine lineNumber="2783"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02784" /><CodeLine lineNumber="2784"><Highlight kind="normal">    NewMinOffset = NewOffset;</Highlight></CodeLine>
<Link id="l02785" /><CodeLine lineNumber="2785"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#addaa86bfa4ca26b7f366cbdd868f99bf">Immediate::isKnownGT</a>(NewOffset, LU.MaxOffset)) &#123;</Highlight></CodeLine>
<Link id="l02786" /><CodeLine lineNumber="2786"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, NewAccessTy, </Highlight><Highlight kind="comment">/&#42;BaseGV=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02787" /><CodeLine lineNumber="2787"><Highlight kind="normal">                          NewOffset - LU.MinOffset, HasBaseReg))</Highlight></CodeLine>
<Link id="l02788" /><CodeLine lineNumber="2788"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02789" /><CodeLine lineNumber="2789"><Highlight kind="normal">    NewMaxOffset = NewOffset;</Highlight></CodeLine>
<Link id="l02790" /><CodeLine lineNumber="2790"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02791" /><CodeLine lineNumber="2791"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02792" /><CodeLine lineNumber="2792"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// FIXME: We should be able to handle some level of scalable offset support</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02793" /><CodeLine lineNumber="2793"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// for &#39;void&#39;, but in order to get basic support up and running this is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02794" /><CodeLine lineNumber="2794"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// being left out.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02795" /><CodeLine lineNumber="2795"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NewAccessTy.MemTy &amp;&amp; NewAccessTy.MemTy-&gt;isVoidTy() &amp;&amp;</Highlight></CodeLine>
<Link id="l02796" /><CodeLine lineNumber="2796"><Highlight kind="normal">      (NewMinOffset.isScalable() || NewMaxOffset.isScalable()))</Highlight></CodeLine>
<Link id="l02797" /><CodeLine lineNumber="2797"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02798" /><CodeLine lineNumber="2798"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02799" /><CodeLine lineNumber="2799"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update the use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02800" /><CodeLine lineNumber="2800"><Highlight kind="normal">  LU.MinOffset = NewMinOffset;</Highlight></CodeLine>
<Link id="l02801" /><CodeLine lineNumber="2801"><Highlight kind="normal">  LU.MaxOffset = NewMaxOffset;</Highlight></CodeLine>
<Link id="l02802" /><CodeLine lineNumber="2802"><Highlight kind="normal">  LU.AccessTy = NewAccessTy;</Highlight></CodeLine>
<Link id="l02803" /><CodeLine lineNumber="2803"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02804" /><CodeLine lineNumber="2804"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02805" /><CodeLine lineNumber="2805"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02806" /><CodeLine lineNumber="2806"><Highlight kind="comment">/// Return an LSRUse index and an offset value for a fixup which needs the given</Highlight></CodeLine>
<Link id="l02807" /><CodeLine lineNumber="2807"><Highlight kind="comment">/// expression, with the given kind and optional access type.  Either reuse an</Highlight></CodeLine>
<Link id="l02808" /><CodeLine lineNumber="2808"><Highlight kind="comment">/// existing use or create a new one, as needed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02809" /><CodeLine lineNumber="2809"><Highlight kind="normal">std::pair&lt;size&#95;t, Immediate&gt; LSRInstance::getUse(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;Expr,</Highlight></CodeLine>
<Link id="l02810" /><CodeLine lineNumber="2810"><Highlight kind="normal">                                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</Highlight></CodeLine>
<Link id="l02811" /><CodeLine lineNumber="2811"><Highlight kind="normal">                                                 MemAccessTy AccessTy) &#123;</Highlight></CodeLine>
<Link id="l02812" /><CodeLine lineNumber="2812"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/namespaces/llvm/codeview/#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = Expr;</Highlight></CodeLine>
<Link id="l02813" /><CodeLine lineNumber="2813"><Highlight kind="normal">  Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(Expr, SE);</Highlight></CodeLine>
<Link id="l02814" /><CodeLine lineNumber="2814"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02815" /><CodeLine lineNumber="2815"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Basic uses can&#39;t accept any offset, for example.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02816" /><CodeLine lineNumber="2816"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, AccessTy, </Highlight><Highlight kind="comment">/&#42;BaseGV=&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l02817" /><CodeLine lineNumber="2817"><Highlight kind="normal">                        <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, </Highlight><Highlight kind="comment">/&#42;HasBaseReg=&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">)) &#123;</Highlight></CodeLine>
<Link id="l02818" /><CodeLine lineNumber="2818"><Highlight kind="normal">    Expr = <a href="/docs/api/namespaces/llvm/codeview/#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>;</Highlight></CodeLine>
<Link id="l02819" /><CodeLine lineNumber="2819"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(0);</Highlight></CodeLine>
<Link id="l02820" /><CodeLine lineNumber="2820"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02821" /><CodeLine lineNumber="2821"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02822" /><CodeLine lineNumber="2822"><Highlight kind="normal">  std::pair&lt;UseMapTy::iterator, bool&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> =</Highlight></CodeLine>
<Link id="l02823" /><CodeLine lineNumber="2823"><Highlight kind="normal">    UseMap.insert(std::make&#95;pair(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a4a62881e0181b4f2dc498eff32edf764">LSRUse::SCEVUseKindPair</a>(Expr, Kind), 0));</Highlight></CodeLine>
<Link id="l02824" /><CodeLine lineNumber="2824"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second) &#123;</Highlight></CodeLine>
<Link id="l02825" /><CodeLine lineNumber="2825"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// A use already existed with this base.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02826" /><CodeLine lineNumber="2826"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;second;</Highlight></CodeLine>
<Link id="l02827" /><CodeLine lineNumber="2827"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l02828" /><CodeLine lineNumber="2828"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (reconcileNewOffset(LU, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, </Highlight><Highlight kind="comment">/&#42;HasBaseReg=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, Kind, AccessTy))</Highlight></CodeLine>
<Link id="l02829" /><CodeLine lineNumber="2829"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Reuse this use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02830" /><CodeLine lineNumber="2830"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> std::make&#95;pair(LUIdx, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</Highlight></CodeLine>
<Link id="l02831" /><CodeLine lineNumber="2831"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02832" /><CodeLine lineNumber="2832"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02833" /><CodeLine lineNumber="2833"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Create a new use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02834" /><CodeLine lineNumber="2834"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size();</Highlight></CodeLine>
<Link id="l02835" /><CodeLine lineNumber="2835"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;second = LUIdx;</Highlight></CodeLine>
<Link id="l02836" /><CodeLine lineNumber="2836"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.push&#95;back(LSRUse(Kind, AccessTy));</Highlight></CodeLine>
<Link id="l02837" /><CodeLine lineNumber="2837"><Highlight kind="normal">  LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l02838" /><CodeLine lineNumber="2838"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02839" /><CodeLine lineNumber="2839"><Highlight kind="normal">  LU.MinOffset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</Highlight></CodeLine>
<Link id="l02840" /><CodeLine lineNumber="2840"><Highlight kind="normal">  LU.MaxOffset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</Highlight></CodeLine>
<Link id="l02841" /><CodeLine lineNumber="2841"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> std::make&#95;pair(LUIdx, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</Highlight></CodeLine>
<Link id="l02842" /><CodeLine lineNumber="2842"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02843" /><CodeLine lineNumber="2843"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02844" /><CodeLine lineNumber="2844"><Highlight kind="comment">/// Delete the given use from the Uses list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02845" /><CodeLine lineNumber="2845"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::DeleteUse(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx) &#123;</Highlight></CodeLine>
<Link id="l02846" /><CodeLine lineNumber="2846"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (&amp;LU != &amp;<a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.back())</Highlight></CodeLine>
<Link id="l02847" /><CodeLine lineNumber="2847"><Highlight kind="normal">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LU, <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.back());</Highlight></CodeLine>
<Link id="l02848" /><CodeLine lineNumber="2848"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.pop&#95;back();</Highlight></CodeLine>
<Link id="l02849" /><CodeLine lineNumber="2849"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02850" /><CodeLine lineNumber="2850"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Update RegUses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02851" /><CodeLine lineNumber="2851"><Highlight kind="normal">  RegUses.swapAndDropUse(LUIdx, <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size());</Highlight></CodeLine>
<Link id="l02852" /><CodeLine lineNumber="2852"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02853" /><CodeLine lineNumber="2853"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02854" /><CodeLine lineNumber="2854"><Highlight kind="comment">/// Look for a use distinct from OrigLU which is has a formula that has the same</Highlight></CodeLine>
<Link id="l02855" /><CodeLine lineNumber="2855"><Highlight kind="comment">/// registers as the given formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02856" /><CodeLine lineNumber="2856"><Highlight kind="normal">LSRUse &#42;</Highlight></CodeLine>
<Link id="l02857" /><CodeLine lineNumber="2857"><Highlight kind="normal">LSRInstance::FindUseWithSimilarFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;OrigF,</Highlight></CodeLine>
<Link id="l02858" /><CodeLine lineNumber="2858"><Highlight kind="normal">                                       </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;OrigLU) &#123;</Highlight></CodeLine>
<Link id="l02859" /><CodeLine lineNumber="2859"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Search all uses for the formula. This could be more clever.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02860" /><CodeLine lineNumber="2860"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (LSRUse &amp;LU : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>) &#123;</Highlight></CodeLine>
<Link id="l02861" /><CodeLine lineNumber="2861"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check whether this use is close enough to OrigLU, to see whether it&#39;s</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02862" /><CodeLine lineNumber="2862"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// worthwhile looking through its formulae.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02863" /><CodeLine lineNumber="2863"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Ignore ICmpZero uses because they may contain formulae generated by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02864" /><CodeLine lineNumber="2864"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// GenerateICmpZeroScales, in which case adding fixup offsets may</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02865" /><CodeLine lineNumber="2865"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// be invalid.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02866" /><CodeLine lineNumber="2866"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (&amp;LU != &amp;OrigLU &amp;&amp;</Highlight></CodeLine>
<Link id="l02867" /><CodeLine lineNumber="2867"><Highlight kind="normal">        LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l02868" /><CodeLine lineNumber="2868"><Highlight kind="normal">        LU.Kind == OrigLU.Kind &amp;&amp; OrigLU.AccessTy == LU.AccessTy &amp;&amp;</Highlight></CodeLine>
<Link id="l02869" /><CodeLine lineNumber="2869"><Highlight kind="normal">        LU.WidestFixupType == OrigLU.WidestFixupType &amp;&amp;</Highlight></CodeLine>
<Link id="l02870" /><CodeLine lineNumber="2870"><Highlight kind="normal">        LU.HasFormulaWithSameRegs(OrigF)) &#123;</Highlight></CodeLine>
<Link id="l02871" /><CodeLine lineNumber="2871"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Scan through this use&#39;s formulae.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02872" /><CodeLine lineNumber="2872"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae) &#123;</Highlight></CodeLine>
<Link id="l02873" /><CodeLine lineNumber="2873"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Check to see if this formula has the same registers and symbols</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02874" /><CodeLine lineNumber="2874"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// as OrigF.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02875" /><CodeLine lineNumber="2875"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs == OrigF.BaseRegs &amp;&amp;</Highlight></CodeLine>
<Link id="l02876" /><CodeLine lineNumber="2876"><Highlight kind="normal">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg == OrigF.ScaledReg &amp;&amp;</Highlight></CodeLine>
<Link id="l02877" /><CodeLine lineNumber="2877"><Highlight kind="normal">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV == OrigF.BaseGV &amp;&amp;</Highlight></CodeLine>
<Link id="l02878" /><CodeLine lineNumber="2878"><Highlight kind="normal">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == OrigF.Scale &amp;&amp;</Highlight></CodeLine>
<Link id="l02879" /><CodeLine lineNumber="2879"><Highlight kind="normal">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset == OrigF.UnfoldedOffset) &#123;</Highlight></CodeLine>
<Link id="l02880" /><CodeLine lineNumber="2880"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isZero())</Highlight></CodeLine>
<Link id="l02881" /><CodeLine lineNumber="2881"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &amp;LU;</Highlight></CodeLine>
<Link id="l02882" /><CodeLine lineNumber="2882"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// This is the formula where all the registers and symbols matched;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02883" /><CodeLine lineNumber="2883"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// there aren&#39;t going to be any others. Since we declined it, we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02884" /><CodeLine lineNumber="2884"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// can skip the rest of the formulae and proceed to the next LSRUse.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02885" /><CodeLine lineNumber="2885"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02886" /><CodeLine lineNumber="2886"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l02887" /><CodeLine lineNumber="2887"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02888" /><CodeLine lineNumber="2888"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02889" /><CodeLine lineNumber="2889"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02890" /><CodeLine lineNumber="2890"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02891" /><CodeLine lineNumber="2891"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Nothing looked good.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02892" /><CodeLine lineNumber="2892"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02893" /><CodeLine lineNumber="2893"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02894" /><CodeLine lineNumber="2894"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02895" /><CodeLine lineNumber="2895"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::CollectInterestingTypesAndFactors() &#123;</Highlight></CodeLine>
<Link id="l02896" /><CodeLine lineNumber="2896"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector&lt;const SCEV &#42;, 4&gt;</a> Strides;</Highlight></CodeLine>
<Link id="l02897" /><CodeLine lineNumber="2897"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02898" /><CodeLine lineNumber="2898"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Collect interesting types and strides.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02899" /><CodeLine lineNumber="2899"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> Worklist;</Highlight></CodeLine>
<Link id="l02900" /><CodeLine lineNumber="2900"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;U : IU) &#123;</Highlight></CodeLine>
<Link id="l02901" /><CodeLine lineNumber="2901"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Expr = IU.getExpr(U);</Highlight></CodeLine>
<Link id="l02902" /><CodeLine lineNumber="2902"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Expr)</Highlight></CodeLine>
<Link id="l02903" /><CodeLine lineNumber="2903"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02904" /><CodeLine lineNumber="2904"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02905" /><CodeLine lineNumber="2905"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Collect interesting types.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02906" /><CodeLine lineNumber="2906"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/logicalview/#a90c9f20715929cbe06c523bf8546c38baf2d346b1bb7c1c85ab6f7f21e3666b9f">Types</a>.insert(SE.getEffectiveSCEVType(Expr-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</Highlight></CodeLine>
<Link id="l02907" /><CodeLine lineNumber="2907"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02908" /><CodeLine lineNumber="2908"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add strides for mentioned loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02909" /><CodeLine lineNumber="2909"><Highlight kind="normal">    Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Expr);</Highlight></CodeLine>
<Link id="l02910" /><CodeLine lineNumber="2910"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">do</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l02911" /><CodeLine lineNumber="2911"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = Worklist.<a href="/docs/api/classes/llvm/smallvectorimpl/#a0c8ffe664a36e30d49c84d0aded2fe08">pop&#95;back&#95;val</a>();</Highlight></CodeLine>
<Link id="l02912" /><CodeLine lineNumber="2912"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l02913" /><CodeLine lineNumber="2913"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L)</Highlight></CodeLine>
<Link id="l02914" /><CodeLine lineNumber="2914"><Highlight kind="normal">          Strides.<a href="/docs/api/classes/llvm/setvector/#af34eb71cc483e84d2eca80575cb9ccde">insert</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE));</Highlight></CodeLine>
<Link id="l02915" /><CodeLine lineNumber="2915"><Highlight kind="normal">        Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>());</Highlight></CodeLine>
<Link id="l02916" /><CodeLine lineNumber="2916"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l02917" /><CodeLine lineNumber="2917"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a39d3d23a084c4544ee5903203db10e8a">append&#95;range</a>(Worklist, <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands());</Highlight></CodeLine>
<Link id="l02918" /><CodeLine lineNumber="2918"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02919" /><CodeLine lineNumber="2919"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (!Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>());</Highlight></CodeLine>
<Link id="l02920" /><CodeLine lineNumber="2920"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02921" /><CodeLine lineNumber="2921"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02922" /><CodeLine lineNumber="2922"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Compute interesting factors from the set of interesting strides.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02923" /><CodeLine lineNumber="2923"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/setvector/#a954de16c021e57fb3c8e8143bdb428ca">SmallSetVector&lt;const SCEV &#42;, 4&gt;::const&#95;iterator</a></Highlight></CodeLine>
<Link id="l02924" /><CodeLine lineNumber="2924"><Highlight kind="normal">       <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Strides.<a href="/docs/api/classes/llvm/setvector/#ad0bf95396cec46a41371341460d14a1c">begin</a>(), <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = Strides.<a href="/docs/api/classes/llvm/setvector/#a889cc0df630d4b01e12d359517e26670">end</a>(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</Highlight></CodeLine>
<Link id="l02925" /><CodeLine lineNumber="2925"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/setvector/#a954de16c021e57fb3c8e8143bdb428ca">SmallSetVector&lt;const SCEV &#42;, 4&gt;::const&#95;iterator</a> NewStrideIter =</Highlight></CodeLine>
<Link id="l02926" /><CodeLine lineNumber="2926"><Highlight kind="normal">         std::next(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>); NewStrideIter != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++NewStrideIter) &#123;</Highlight></CodeLine>
<Link id="l02927" /><CodeLine lineNumber="2927"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OldStride = &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</Highlight></CodeLine>
<Link id="l02928" /><CodeLine lineNumber="2928"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewStride = &#42;NewStrideIter;</Highlight></CodeLine>
<Link id="l02929" /><CodeLine lineNumber="2929"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02930" /><CodeLine lineNumber="2930"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getTypeSizeInBits(OldStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()) !=</Highlight></CodeLine>
<Link id="l02931" /><CodeLine lineNumber="2931"><Highlight kind="normal">          SE.getTypeSizeInBits(NewStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>())) &#123;</Highlight></CodeLine>
<Link id="l02932" /><CodeLine lineNumber="2932"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getTypeSizeInBits(OldStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()) &gt;</Highlight></CodeLine>
<Link id="l02933" /><CodeLine lineNumber="2933"><Highlight kind="normal">            SE.getTypeSizeInBits(NewStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()))</Highlight></CodeLine>
<Link id="l02934" /><CodeLine lineNumber="2934"><Highlight kind="normal">          NewStride = SE.getSignExtendExpr(NewStride, OldStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>());</Highlight></CodeLine>
<Link id="l02935" /><CodeLine lineNumber="2935"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02936" /><CodeLine lineNumber="2936"><Highlight kind="normal">          OldStride = SE.getSignExtendExpr(OldStride, NewStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>());</Highlight></CodeLine>
<Link id="l02937" /><CodeLine lineNumber="2937"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02938" /><CodeLine lineNumber="2938"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;Factor =</Highlight></CodeLine>
<Link id="l02939" /><CodeLine lineNumber="2939"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/#a5f6182886dc2f96c204299e92c1565d5">dyn&#95;cast&#95;or&#95;null&lt;SCEVConstant&gt;</a>(<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(NewStride, OldStride,</Highlight></CodeLine>
<Link id="l02940" /><CodeLine lineNumber="2940"><Highlight kind="normal">                                                        SE, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">))) &#123;</Highlight></CodeLine>
<Link id="l02941" /><CodeLine lineNumber="2941"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Factor-&gt;getAPInt().getSignificantBits() &lt;= 64 &amp;&amp; !Factor-&gt;isZero())</Highlight></CodeLine>
<Link id="l02942" /><CodeLine lineNumber="2942"><Highlight kind="normal">          Factors.insert(Factor-&gt;getAPInt().getSExtValue());</Highlight></CodeLine>
<Link id="l02943" /><CodeLine lineNumber="2943"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;Factor =</Highlight></CodeLine>
<Link id="l02944" /><CodeLine lineNumber="2944"><Highlight kind="normal">                   <a href="/docs/api/namespaces/llvm/#a5f6182886dc2f96c204299e92c1565d5">dyn&#95;cast&#95;or&#95;null&lt;SCEVConstant&gt;</a>(<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(OldStride,</Highlight></CodeLine>
<Link id="l02945" /><CodeLine lineNumber="2945"><Highlight kind="normal">                                                               NewStride,</Highlight></CodeLine>
<Link id="l02946" /><CodeLine lineNumber="2946"><Highlight kind="normal">                                                               SE, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">))) &#123;</Highlight></CodeLine>
<Link id="l02947" /><CodeLine lineNumber="2947"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Factor-&gt;getAPInt().getSignificantBits() &lt;= 64 &amp;&amp; !Factor-&gt;isZero())</Highlight></CodeLine>
<Link id="l02948" /><CodeLine lineNumber="2948"><Highlight kind="normal">          Factors.insert(Factor-&gt;getAPInt().getSExtValue());</Highlight></CodeLine>
<Link id="l02949" /><CodeLine lineNumber="2949"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02950" /><CodeLine lineNumber="2950"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02951" /><CodeLine lineNumber="2951"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02952" /><CodeLine lineNumber="2952"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If all uses use the same type, don&#39;t bother looking for truncation-based</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02953" /><CodeLine lineNumber="2953"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// reuse.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02954" /><CodeLine lineNumber="2954"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/logicalview/#a90c9f20715929cbe06c523bf8546c38baf2d346b1bb7c1c85ab6f7f21e3666b9f">Types</a>.size() == 1)</Highlight></CodeLine>
<Link id="l02955" /><CodeLine lineNumber="2955"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/logicalview/#a90c9f20715929cbe06c523bf8546c38baf2d346b1bb7c1c85ab6f7f21e3666b9f">Types</a>.clear();</Highlight></CodeLine>
<Link id="l02956" /><CodeLine lineNumber="2956"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02957" /><CodeLine lineNumber="2957"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(print&#95;factors&#95;and&#95;types(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l02958" /><CodeLine lineNumber="2958"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02959" /><CodeLine lineNumber="2959"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02960" /><CodeLine lineNumber="2960"><Highlight kind="comment">/// Helper for CollectChains that finds an IV operand (computed by an AddRec in</Highlight></CodeLine>
<Link id="l02961" /><CodeLine lineNumber="2961"><Highlight kind="comment">/// this loop) within &#91;OI,OE) or returns OE. If IVUsers mapped Instructions to</Highlight></CodeLine>
<Link id="l02962" /><CodeLine lineNumber="2962"><Highlight kind="comment">/// IVStrideUses, we could partially skip this.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02963" /><CodeLine lineNumber="2963"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a></Highlight></CodeLine>
<Link id="l02964" /><CodeLine lineNumber="2964" lineLink="#a262aeb2eecfb752ae2eecb90bab7ec8a"><Highlight kind="normal"><a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(<a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> OI, <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> OE,</Highlight></CodeLine>
<Link id="l02965" /><CodeLine lineNumber="2965"><Highlight kind="normal">              <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l02966" /><CodeLine lineNumber="2966"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal">(; OI != OE; ++OI) &#123;</Highlight></CodeLine>
<Link id="l02967" /><CodeLine lineNumber="2967"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Oper = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(&#42;OI)) &#123;</Highlight></CodeLine>
<Link id="l02968" /><CodeLine lineNumber="2968"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(Oper-&gt;getType()))</Highlight></CodeLine>
<Link id="l02969" /><CodeLine lineNumber="2969"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02970" /><CodeLine lineNumber="2970"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02971" /><CodeLine lineNumber="2971"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR =</Highlight></CodeLine>
<Link id="l02972" /><CodeLine lineNumber="2972"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Oper))) &#123;</Highlight></CodeLine>
<Link id="l02973" /><CodeLine lineNumber="2973"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L)</Highlight></CodeLine>
<Link id="l02974" /><CodeLine lineNumber="2974"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l02975" /><CodeLine lineNumber="2975"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l02976" /><CodeLine lineNumber="2976"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l02977" /><CodeLine lineNumber="2977"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l02978" /><CodeLine lineNumber="2978"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> OI;</Highlight></CodeLine>
<Link id="l02979" /><CodeLine lineNumber="2979"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02980" /><CodeLine lineNumber="2980"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02981" /><CodeLine lineNumber="2981"><Highlight kind="comment">/// IVChain logic must consistently peek base TruncInst operands, so wrap it in</Highlight></CodeLine>
<Link id="l02982" /><CodeLine lineNumber="2982"><Highlight kind="comment">/// a convenient helper.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02983" /><CodeLine lineNumber="2983" lineLink="#a0ef5c4bf982afaa71a03555b138aba58"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(<a href="/docs/api/classes/llvm/value">Value</a> &#42;Oper) &#123;</Highlight></CodeLine>
<Link id="l02984" /><CodeLine lineNumber="2984"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/truncinst">TruncInst</a> &#42;Trunc = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;TruncInst&gt;</a>(Oper))</Highlight></CodeLine>
<Link id="l02985" /><CodeLine lineNumber="2985"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Trunc-&gt;getOperand(0);</Highlight></CodeLine>
<Link id="l02986" /><CodeLine lineNumber="2986"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Oper;</Highlight></CodeLine>
<Link id="l02987" /><CodeLine lineNumber="2987"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l02988" /><CodeLine lineNumber="2988"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l02989" /><CodeLine lineNumber="2989"><Highlight kind="comment">/// Return an approximation of this SCEV expression&#39;s &quot;base&quot;, or NULL for any</Highlight></CodeLine>
<Link id="l02990" /><CodeLine lineNumber="2990"><Highlight kind="comment">/// constant. Returning the expression itself is conservative. Returning a</Highlight></CodeLine>
<Link id="l02991" /><CodeLine lineNumber="2991"><Highlight kind="comment">/// deeper subexpression is more precise and valid as long as it isn&#39;t less</Highlight></CodeLine>
<Link id="l02992" /><CodeLine lineNumber="2992"><Highlight kind="comment">/// complex than another subexpression. For expressions involving multiple</Highlight></CodeLine>
<Link id="l02993" /><CodeLine lineNumber="2993"><Highlight kind="comment">/// unscaled values, we need to return the pointer-type SCEVUnknown. This avoids</Highlight></CodeLine>
<Link id="l02994" /><CodeLine lineNumber="2994"><Highlight kind="comment">/// forming chains across objects, such as: PrevOper==a&#91;i&#93;, IVOper==b&#91;i&#93;,</Highlight></CodeLine>
<Link id="l02995" /><CodeLine lineNumber="2995"><Highlight kind="comment">/// IVInc==b-a.</Highlight></CodeLine>
<Link id="l02996" /><CodeLine lineNumber="2996"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l02997" /><CodeLine lineNumber="2997"><Highlight kind="comment">/// Since SCEVUnknown is the rightmost type, and pointers are the rightmost</Highlight></CodeLine>
<Link id="l02998" /><CodeLine lineNumber="2998"><Highlight kind="comment">/// SCEVUnknown, we simply return the rightmost SCEV operand.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l02999" /><CodeLine lineNumber="2999" lineLink="#a60008b3cbf2b4ef3e3d14af04beb6a06"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</Highlight></CodeLine>
<Link id="l03000" /><CodeLine lineNumber="3000"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (S-&gt;<a href="/docs/api/classes/llvm/scev/#ad4f956914bf94bdcd1058badb5bd90e6">getSCEVType</a>()) &#123;</Highlight></CodeLine>
<Link id="l03001" /><CodeLine lineNumber="3001"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">: </Highlight><Highlight kind="comment">// including scUnknown.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03002" /><CodeLine lineNumber="3002"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> S;</Highlight></CodeLine>
<Link id="l03003" /><CodeLine lineNumber="3003"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eabcb1f797cb330e61a5879fc260aaec5b">scConstant</a>:</Highlight></CodeLine>
<Link id="l03004" /><CodeLine lineNumber="3004"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea61df12d6bb21842a8f766c4433c85717">scVScale</a>:</Highlight></CodeLine>
<Link id="l03005" /><CodeLine lineNumber="3005"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03006" /><CodeLine lineNumber="3006"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ead3656bcc84af213cc488acb56c60de22">scTruncate</a>:</Highlight></CodeLine>
<Link id="l03007" /><CodeLine lineNumber="3007"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVTruncateExpr&gt;</a>(S)-&gt;getOperand());</Highlight></CodeLine>
<Link id="l03008" /><CodeLine lineNumber="3008"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eadd4a8d5cb0d78c9be22d01e1546bafc6">scZeroExtend</a>:</Highlight></CodeLine>
<Link id="l03009" /><CodeLine lineNumber="3009"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVZeroExtendExpr&gt;</a>(S)-&gt;getOperand());</Highlight></CodeLine>
<Link id="l03010" /><CodeLine lineNumber="3010"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ead05711646a19cb20775cfbc8ef0a8c09">scSignExtend</a>:</Highlight></CodeLine>
<Link id="l03011" /><CodeLine lineNumber="3011"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVSignExtendExpr&gt;</a>(S)-&gt;getOperand());</Highlight></CodeLine>
<Link id="l03012" /><CodeLine lineNumber="3012"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea3a80b1a7dda48464be1849ee1fb85868">scAddExpr</a>: &#123;</Highlight></CodeLine>
<Link id="l03013" /><CodeLine lineNumber="3013"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Skip over scaled operands (scMulExpr) to follow add operands as long as</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03014" /><CodeLine lineNumber="3014"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// there&#39;s nothing more complex.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03015" /><CodeLine lineNumber="3015"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// FIXME: not sure if we want to recognize negation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03016" /><CodeLine lineNumber="3016"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddExpr&gt;</a>(S);</Highlight></CodeLine>
<Link id="l03017" /><CodeLine lineNumber="3017"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;SubExpr : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands())) &#123;</Highlight></CodeLine>
<Link id="l03018" /><CodeLine lineNumber="3018"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SubExpr-&gt;getSCEVType() == <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea3a80b1a7dda48464be1849ee1fb85868">scAddExpr</a>)</Highlight></CodeLine>
<Link id="l03019" /><CodeLine lineNumber="3019"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(SubExpr);</Highlight></CodeLine>
<Link id="l03020" /><CodeLine lineNumber="3020"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03021" /><CodeLine lineNumber="3021"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SubExpr-&gt;getSCEVType() != <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eafd56f054da3d1f9b827ae1003da3a38b">scMulExpr</a>)</Highlight></CodeLine>
<Link id="l03022" /><CodeLine lineNumber="3022"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SubExpr;</Highlight></CodeLine>
<Link id="l03023" /><CodeLine lineNumber="3023"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03024" /><CodeLine lineNumber="3024"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> S; </Highlight><Highlight kind="comment">// all operands are scaled, be conservative.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03025" /><CodeLine lineNumber="3025"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03026" /><CodeLine lineNumber="3026"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea222c9c7b5d5e742d5d1238a3256b1ea5">scAddRecExpr</a>:</Highlight></CodeLine>
<Link id="l03027" /><CodeLine lineNumber="3027"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(S)-&gt;getStart());</Highlight></CodeLine>
<Link id="l03028" /><CodeLine lineNumber="3028"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03029" /><CodeLine lineNumber="3029"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unknown SCEV kind!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03030" /><CodeLine lineNumber="3030"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03031" /><CodeLine lineNumber="3031"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03032" /><CodeLine lineNumber="3032"><Highlight kind="comment">/// Return true if the chain increment is profitable to expand into a loop</Highlight></CodeLine>
<Link id="l03033" /><CodeLine lineNumber="3033"><Highlight kind="comment">/// invariant value, which may require its own register. A profitable chain</Highlight></CodeLine>
<Link id="l03034" /><CodeLine lineNumber="3034"><Highlight kind="comment">/// increment will be an offset relative to the same base. We allow such offsets</Highlight></CodeLine>
<Link id="l03035" /><CodeLine lineNumber="3035"><Highlight kind="comment">/// to potentially be used as chain increment as long as it&#39;s not obviously</Highlight></CodeLine>
<Link id="l03036" /><CodeLine lineNumber="3036"><Highlight kind="comment">/// expensive to expand using real instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03037" /><CodeLine lineNumber="3037" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#ade9271834ae6b0312cf662fe231a75c4"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#ade9271834ae6b0312cf662fe231a75c4">IVChain::isProfitableIncrement</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OperExpr,</Highlight></CodeLine>
<Link id="l03038" /><CodeLine lineNumber="3038"><Highlight kind="normal">                                    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr,</Highlight></CodeLine>
<Link id="l03039" /><CodeLine lineNumber="3039"><Highlight kind="normal">                                    <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l03040" /><CodeLine lineNumber="3040"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Aggressively form chains when -stress-ivchain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03041" /><CodeLine lineNumber="3041"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>)</Highlight></CodeLine>
<Link id="l03042" /><CodeLine lineNumber="3042"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03043" /><CodeLine lineNumber="3043"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03044" /><CodeLine lineNumber="3044"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Do not replace a constant offset from IV head with a nonconstant IV</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03045" /><CodeLine lineNumber="3045"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// increment.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03046" /><CodeLine lineNumber="3046"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(IncExpr)) &#123;</Highlight></CodeLine>
<Link id="l03047" /><CodeLine lineNumber="3047"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;HeadExpr = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>&#91;0&#93;.IVOperand));</Highlight></CodeLine>
<Link id="l03048" /><CodeLine lineNumber="3048"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(OperExpr, HeadExpr)))</Highlight></CodeLine>
<Link id="l03049" /><CodeLine lineNumber="3049"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03050" /><CodeLine lineNumber="3050"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03051" /><CodeLine lineNumber="3051"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03052" /><CodeLine lineNumber="3052"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV&#42;, 8&gt;</a> Processed;</Highlight></CodeLine>
<Link id="l03053" /><CodeLine lineNumber="3053"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> !<a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(IncExpr, Processed, SE);</Highlight></CodeLine>
<Link id="l03054" /><CodeLine lineNumber="3054"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03055" /><CodeLine lineNumber="3055"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03056" /><CodeLine lineNumber="3056"><Highlight kind="comment">/// Return true if the number of registers needed for the chain is estimated to</Highlight></CodeLine>
<Link id="l03057" /><CodeLine lineNumber="3057"><Highlight kind="comment">/// be less than the number required for the individual IV users. First prohibit</Highlight></CodeLine>
<Link id="l03058" /><CodeLine lineNumber="3058"><Highlight kind="comment">/// any IV users that keep the IV live across increments (the Users set should</Highlight></CodeLine>
<Link id="l03059" /><CodeLine lineNumber="3059"><Highlight kind="comment">/// be empty). Next count the number and type of increments in the chain.</Highlight></CodeLine>
<Link id="l03060" /><CodeLine lineNumber="3060"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l03061" /><CodeLine lineNumber="3061"><Highlight kind="comment">/// Chaining IVs can lead to considerable code bloat if ISEL doesn&#39;t</Highlight></CodeLine>
<Link id="l03062" /><CodeLine lineNumber="3062"><Highlight kind="comment">/// effectively use postinc addressing modes. Only consider it profitable it the</Highlight></CodeLine>
<Link id="l03063" /><CodeLine lineNumber="3063"><Highlight kind="comment">/// increments can be computed in fewer registers when chained.</Highlight></CodeLine>
<Link id="l03064" /><CodeLine lineNumber="3064"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l03065" /><CodeLine lineNumber="3065"><Highlight kind="comment">/// TODO: Consider IVInc free if it&#39;s already used in another chains.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03066" /><CodeLine lineNumber="3066" lineLink="#aca012302770ad32503de5e2c62344290"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#aca012302770ad32503de5e2c62344290">isProfitableChain</a>(IVChain &amp;Chain,</Highlight></CodeLine>
<Link id="l03067" /><CodeLine lineNumber="3067"><Highlight kind="normal">                              <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;Instruction &#42;&gt;</a> &amp;<a href="/docs/api/files/lib/lib/analysis/ivusers-cpp/#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>,</Highlight></CodeLine>
<Link id="l03068" /><CodeLine lineNumber="3068"><Highlight kind="normal">                              <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</Highlight></CodeLine>
<Link id="l03069" /><CodeLine lineNumber="3069"><Highlight kind="normal">                              </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>) &#123;</Highlight></CodeLine>
<Link id="l03070" /><CodeLine lineNumber="3070"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>)</Highlight></CodeLine>
<Link id="l03071" /><CodeLine lineNumber="3071"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03072" /><CodeLine lineNumber="3072"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03073" /><CodeLine lineNumber="3073"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Chain.hasIncs())</Highlight></CodeLine>
<Link id="l03074" /><CodeLine lineNumber="3074"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03075" /><CodeLine lineNumber="3075"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03076" /><CodeLine lineNumber="3076"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/analysis/ivusers-cpp/#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>.empty()) &#123;</Highlight></CodeLine>
<Link id="l03077" /><CodeLine lineNumber="3077"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Chain: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Chain.Incs&#91;0&#93;.UserInst &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; users:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03078" /><CodeLine lineNumber="3078"><Highlight kind="normal">               <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a4cfc8b177e8521a4b496ae2edff6244f">for</a> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst</Highlight></CodeLine>
<Link id="l03079" /><CodeLine lineNumber="3079"><Highlight kind="normal">                    : <a href="/docs/api/files/lib/lib/analysis/ivusers-cpp/#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>) &#123; <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Inst &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">; &#125;);</Highlight></CodeLine>
<Link id="l03080" /><CodeLine lineNumber="3080"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03081" /><CodeLine lineNumber="3081"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03082" /><CodeLine lineNumber="3082"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Chain.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;empty IV chains are not allowed&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03083" /><CodeLine lineNumber="3083"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03084" /><CodeLine lineNumber="3084"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The chain itself may require a register, so intialize cost to 1</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03085" /><CodeLine lineNumber="3085"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> cost = 1;</Highlight></CodeLine>
<Link id="l03086" /><CodeLine lineNumber="3086"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03087" /><CodeLine lineNumber="3087"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// A complete chain likely eliminates the need for keeping the original IV in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03088" /><CodeLine lineNumber="3088"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// a register. LSR does not currently know how to form a complete chain unless</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03089" /><CodeLine lineNumber="3089"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the header phi already exists.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03090" /><CodeLine lineNumber="3090"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(Chain.tailUserInst())</Highlight></CodeLine>
<Link id="l03091" /><CodeLine lineNumber="3091"><Highlight kind="normal">      &amp;&amp; SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Chain.tailUserInst()) == Chain.Incs&#91;0&#93;.IncExpr) &#123;</Highlight></CodeLine>
<Link id="l03092" /><CodeLine lineNumber="3092"><Highlight kind="normal">    --cost;</Highlight></CodeLine>
<Link id="l03093" /><CodeLine lineNumber="3093"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03094" /><CodeLine lineNumber="3094"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LastIncExpr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03095" /><CodeLine lineNumber="3095"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumConstIncrements = 0;</Highlight></CodeLine>
<Link id="l03096" /><CodeLine lineNumber="3096"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumVarIncrements = 0;</Highlight></CodeLine>
<Link id="l03097" /><CodeLine lineNumber="3097"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumReusedIncrements = 0;</Highlight></CodeLine>
<Link id="l03098" /><CodeLine lineNumber="3098"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03099" /><CodeLine lineNumber="3099"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isProfitableLSRChainElement(Chain.Incs&#91;0&#93;.UserInst))</Highlight></CodeLine>
<Link id="l03100" /><CodeLine lineNumber="3100"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03101" /><CodeLine lineNumber="3101"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03102" /><CodeLine lineNumber="3102"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> IVInc &amp;Inc : Chain) &#123;</Highlight></CodeLine>
<Link id="l03103" /><CodeLine lineNumber="3103"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isProfitableLSRChainElement(Inc.UserInst))</Highlight></CodeLine>
<Link id="l03104" /><CodeLine lineNumber="3104"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03105" /><CodeLine lineNumber="3105"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Inc.IncExpr-&gt;isZero())</Highlight></CodeLine>
<Link id="l03106" /><CodeLine lineNumber="3106"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03107" /><CodeLine lineNumber="3107"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03108" /><CodeLine lineNumber="3108"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Incrementing by zero or some constant is neutral. We assume constants can</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03109" /><CodeLine lineNumber="3109"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// be folded into an addressing mode or an add&#39;s immediate operand.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03110" /><CodeLine lineNumber="3110"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(Inc.IncExpr)) &#123;</Highlight></CodeLine>
<Link id="l03111" /><CodeLine lineNumber="3111"><Highlight kind="normal">      ++NumConstIncrements;</Highlight></CodeLine>
<Link id="l03112" /><CodeLine lineNumber="3112"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03113" /><CodeLine lineNumber="3113"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03114" /><CodeLine lineNumber="3114"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03115" /><CodeLine lineNumber="3115"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Inc.IncExpr == LastIncExpr)</Highlight></CodeLine>
<Link id="l03116" /><CodeLine lineNumber="3116"><Highlight kind="normal">      ++NumReusedIncrements;</Highlight></CodeLine>
<Link id="l03117" /><CodeLine lineNumber="3117"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03118" /><CodeLine lineNumber="3118"><Highlight kind="normal">      ++NumVarIncrements;</Highlight></CodeLine>
<Link id="l03119" /><CodeLine lineNumber="3119"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03120" /><CodeLine lineNumber="3120"><Highlight kind="normal">    LastIncExpr = Inc.IncExpr;</Highlight></CodeLine>
<Link id="l03121" /><CodeLine lineNumber="3121"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03122" /><CodeLine lineNumber="3122"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// An IV chain with a single increment is handled by LSR&#39;s postinc</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03123" /><CodeLine lineNumber="3123"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// uses. However, a chain with multiple increments requires keeping the IV&#39;s</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03124" /><CodeLine lineNumber="3124"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// value live longer than it needs to be if chained.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03125" /><CodeLine lineNumber="3125"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumConstIncrements &gt; 1)</Highlight></CodeLine>
<Link id="l03126" /><CodeLine lineNumber="3126"><Highlight kind="normal">    --cost;</Highlight></CodeLine>
<Link id="l03127" /><CodeLine lineNumber="3127"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03128" /><CodeLine lineNumber="3128"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Materializing increment expressions in the preheader that didn&#39;t exist in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03129" /><CodeLine lineNumber="3129"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the original code may cost a register. For example, sign-extended array</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03130" /><CodeLine lineNumber="3130"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// indices can produce ridiculous increments like this:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03131" /><CodeLine lineNumber="3131"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// IV + ((sext i32 (2 &#42; %s) to i64) + (-1 &#42; (sext i32 %s to i64)))</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03132" /><CodeLine lineNumber="3132"><Highlight kind="normal">  cost += NumVarIncrements;</Highlight></CodeLine>
<Link id="l03133" /><CodeLine lineNumber="3133"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03134" /><CodeLine lineNumber="3134"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Reusing variable increments likely saves a register to hold the multiple of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03135" /><CodeLine lineNumber="3135"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the stride.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03136" /><CodeLine lineNumber="3136"><Highlight kind="normal">  cost -= NumReusedIncrements;</Highlight></CodeLine>
<Link id="l03137" /><CodeLine lineNumber="3137"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03138" /><CodeLine lineNumber="3138"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Chain: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Chain.Incs&#91;0&#93;.UserInst &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; Cost: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; cost</Highlight></CodeLine>
<Link id="l03139" /><CodeLine lineNumber="3139"><Highlight kind="normal">                    &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03140" /><CodeLine lineNumber="3140"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03141" /><CodeLine lineNumber="3141"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> cost &lt; 0;</Highlight></CodeLine>
<Link id="l03142" /><CodeLine lineNumber="3142"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03143" /><CodeLine lineNumber="3143"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03144" /><CodeLine lineNumber="3144"><Highlight kind="comment">/// Add this IV user to an existing chain or make it the head of a new chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03145" /><CodeLine lineNumber="3145"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::ChainInstruction(<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVOper,</Highlight></CodeLine>
<Link id="l03146" /><CodeLine lineNumber="3146"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;ChainUsers&gt;</a> &amp;ChainUsersVec) &#123;</Highlight></CodeLine>
<Link id="l03147" /><CodeLine lineNumber="3147"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// When IVs are used as types of varying widths, they are generally converted</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03148" /><CodeLine lineNumber="3148"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to a wider type with some uses remaining narrow under a (free) trunc.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03149" /><CodeLine lineNumber="3149"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> NextIV = <a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(IVOper);</Highlight></CodeLine>
<Link id="l03150" /><CodeLine lineNumber="3150"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OperExpr = SE.getSCEV(NextIV);</Highlight></CodeLine>
<Link id="l03151" /><CodeLine lineNumber="3151"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> OperExprBase = <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(OperExpr);</Highlight></CodeLine>
<Link id="l03152" /><CodeLine lineNumber="3152"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03153" /><CodeLine lineNumber="3153"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Visit all existing chains. Check if its IVOper can be computed as a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03154" /><CodeLine lineNumber="3154"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// profitable loop invariant increment from the last link in the Chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03155" /><CodeLine lineNumber="3155"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> ChainIdx = 0, NChains = IVChainVec.size();</Highlight></CodeLine>
<Link id="l03156" /><CodeLine lineNumber="3156"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LastIncExpr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03157" /><CodeLine lineNumber="3157"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (; ChainIdx &lt; NChains; ++ChainIdx) &#123;</Highlight></CodeLine>
<Link id="l03158" /><CodeLine lineNumber="3158"><Highlight kind="normal">    IVChain &amp;<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a> = IVChainVec&#91;ChainIdx&#93;;</Highlight></CodeLine>
<Link id="l03159" /><CodeLine lineNumber="3159"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03160" /><CodeLine lineNumber="3160"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Prune the solution space aggressively by checking that both IV operands</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03161" /><CodeLine lineNumber="3161"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// are expressions that operate on the same unscaled SCEVUnknown. This</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03162" /><CodeLine lineNumber="3162"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// &quot;base&quot; will be canceled by the subsequent getMinusSCEV call. Checking</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03163" /><CodeLine lineNumber="3163"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// first avoids creating extra SCEV expressions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03164" /><CodeLine lineNumber="3164"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a> &amp;&amp; <a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.ExprBase != OperExprBase)</Highlight></CodeLine>
<Link id="l03165" /><CodeLine lineNumber="3165"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03166" /><CodeLine lineNumber="3166"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03167" /><CodeLine lineNumber="3167"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;PrevIV = <a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>().IVOperand);</Highlight></CodeLine>
<Link id="l03168" /><CodeLine lineNumber="3168"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PrevIV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != NextIV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())</Highlight></CodeLine>
<Link id="l03169" /><CodeLine lineNumber="3169"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03170" /><CodeLine lineNumber="3170"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03171" /><CodeLine lineNumber="3171"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// A phi node terminates a chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03172" /><CodeLine lineNumber="3172"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(UserInst) &amp;&amp; <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.tailUserInst()))</Highlight></CodeLine>
<Link id="l03173" /><CodeLine lineNumber="3173"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03174" /><CodeLine lineNumber="3174"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03175" /><CodeLine lineNumber="3175"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The increment must be loop-invariant so it can be kept in a register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03176" /><CodeLine lineNumber="3176"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;PrevExpr = SE.getSCEV(PrevIV);</Highlight></CodeLine>
<Link id="l03177" /><CodeLine lineNumber="3177"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr = SE.getMinusSCEV(OperExpr, PrevExpr);</Highlight></CodeLine>
<Link id="l03178" /><CodeLine lineNumber="3178"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVCouldNotCompute&gt;</a>(IncExpr) || !SE.isLoopInvariant(IncExpr, L))</Highlight></CodeLine>
<Link id="l03179" /><CodeLine lineNumber="3179"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03180" /><CodeLine lineNumber="3180"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03181" /><CodeLine lineNumber="3181"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.isProfitableIncrement(OperExpr, IncExpr, SE)) &#123;</Highlight></CodeLine>
<Link id="l03182" /><CodeLine lineNumber="3182"><Highlight kind="normal">      LastIncExpr = IncExpr;</Highlight></CodeLine>
<Link id="l03183" /><CodeLine lineNumber="3183"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03184" /><CodeLine lineNumber="3184"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03185" /><CodeLine lineNumber="3185"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03186" /><CodeLine lineNumber="3186"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we haven&#39;t found a chain, create a new one, unless we hit the max. Don&#39;t</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03187" /><CodeLine lineNumber="3187"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// bother for phi nodes, because they must be last in the chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03188" /><CodeLine lineNumber="3188"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ChainIdx == NChains) &#123;</Highlight></CodeLine>
<Link id="l03189" /><CodeLine lineNumber="3189"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(UserInst))</Highlight></CodeLine>
<Link id="l03190" /><CodeLine lineNumber="3190"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03191" /><CodeLine lineNumber="3191"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NChains &gt;= MaxChains &amp;&amp; !<a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>) &#123;</Highlight></CodeLine>
<Link id="l03192" /><CodeLine lineNumber="3192"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;IV Chain Limit\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03193" /><CodeLine lineNumber="3193"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03194" /><CodeLine lineNumber="3194"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03195" /><CodeLine lineNumber="3195"><Highlight kind="normal">    LastIncExpr = OperExpr;</Highlight></CodeLine>
<Link id="l03196" /><CodeLine lineNumber="3196"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// IVUsers may have skipped over sign/zero extensions. We don&#39;t currently</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03197" /><CodeLine lineNumber="3197"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// attempt to form chains involving extensions unless they can be hoisted</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03198" /><CodeLine lineNumber="3198"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// into this loop&#39;s AddRec.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03199" /><CodeLine lineNumber="3199"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(LastIncExpr))</Highlight></CodeLine>
<Link id="l03200" /><CodeLine lineNumber="3200"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03201" /><CodeLine lineNumber="3201"><Highlight kind="normal">    ++NChains;</Highlight></CodeLine>
<Link id="l03202" /><CodeLine lineNumber="3202"><Highlight kind="normal">    IVChainVec.push&#95;back(IVChain(IVInc(UserInst, IVOper, LastIncExpr),</Highlight></CodeLine>
<Link id="l03203" /><CodeLine lineNumber="3203"><Highlight kind="normal">                                 OperExprBase));</Highlight></CodeLine>
<Link id="l03204" /><CodeLine lineNumber="3204"><Highlight kind="normal">    ChainUsersVec.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(NChains);</Highlight></CodeLine>
<Link id="l03205" /><CodeLine lineNumber="3205"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;IV Chain#&quot;</Highlight><Highlight kind="normal"> &lt;&lt; ChainIdx &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; Head: (&quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;UserInst</Highlight></CodeLine>
<Link id="l03206" /><CodeLine lineNumber="3206"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;) IV=&quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;LastIncExpr &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03207" /><CodeLine lineNumber="3207"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l03208" /><CodeLine lineNumber="3208"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;IV Chain#&quot;</Highlight><Highlight kind="normal"> &lt;&lt; ChainIdx &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Inc: (&quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;UserInst</Highlight></CodeLine>
<Link id="l03209" /><CodeLine lineNumber="3209"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;) IV+&quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;LastIncExpr &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03210" /><CodeLine lineNumber="3210"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add this IV user to the end of the chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03211" /><CodeLine lineNumber="3211"><Highlight kind="normal">    IVChainVec&#91;ChainIdx&#93;.add(IVInc(UserInst, IVOper, LastIncExpr));</Highlight></CodeLine>
<Link id="l03212" /><CodeLine lineNumber="3212"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03213" /><CodeLine lineNumber="3213"><Highlight kind="normal">  IVChain &amp;<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a> = IVChainVec&#91;ChainIdx&#93;;</Highlight></CodeLine>
<Link id="l03214" /><CodeLine lineNumber="3214"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03215" /><CodeLine lineNumber="3215"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction&#42;,4&gt;</a> &amp;NearUsers = ChainUsersVec&#91;ChainIdx&#93;.NearUsers;</Highlight></CodeLine>
<Link id="l03216" /><CodeLine lineNumber="3216"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This chain&#39;s NearUsers become FarUsers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03217" /><CodeLine lineNumber="3217"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LastIncExpr-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</Highlight></CodeLine>
<Link id="l03218" /><CodeLine lineNumber="3218"><Highlight kind="normal">    ChainUsersVec&#91;ChainIdx&#93;.FarUsers.<a href="/docs/api/classes/llvm/smallvectorimpl/#a94d23373106467003722f7d6c17b1528">insert</a>(NearUsers.<a href="/docs/api/classes/llvm/smallptrsetimpl/#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>(),</Highlight></CodeLine>
<Link id="l03219" /><CodeLine lineNumber="3219"><Highlight kind="normal">                                            NearUsers.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a7004354fbee1c8cd74ed9001915e1db5">end</a>());</Highlight></CodeLine>
<Link id="l03220" /><CodeLine lineNumber="3220"><Highlight kind="normal">    NearUsers.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</Highlight></CodeLine>
<Link id="l03221" /><CodeLine lineNumber="3221"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03222" /><CodeLine lineNumber="3222"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03223" /><CodeLine lineNumber="3223"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// All other uses of IVOperand become near uses of the chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03224" /><CodeLine lineNumber="3224"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We currently ignore intermediate values within SCEV expressions, assuming</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03225" /><CodeLine lineNumber="3225"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// they will eventually be used be the current chain, or can be computed</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03226" /><CodeLine lineNumber="3226"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// from one of the chain increments. To be more precise we could</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03227" /><CodeLine lineNumber="3227"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// transitively follow its user and only add leaf IV users to the set.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03228" /><CodeLine lineNumber="3228"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/user">User</a> &#42;U : IVOper-&gt;<a href="/docs/api/classes/llvm/value/#a411cf3e3932f209ce3374cb31adc1da6">users</a>()) &#123;</Highlight></CodeLine>
<Link id="l03229" /><CodeLine lineNumber="3229"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;OtherUse = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(U);</Highlight></CodeLine>
<Link id="l03230" /><CodeLine lineNumber="3230"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!OtherUse)</Highlight></CodeLine>
<Link id="l03231" /><CodeLine lineNumber="3231"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03232" /><CodeLine lineNumber="3232"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Uses in the chain will no longer be uses if the chain is formed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03233" /><CodeLine lineNumber="3233"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Include the head of the chain in this iteration (not Chain.begin()).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03234" /><CodeLine lineNumber="3234"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">IVChain::const&#95;iterator</a> IncIter = <a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>();</Highlight></CodeLine>
<Link id="l03235" /><CodeLine lineNumber="3235"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">IVChain::const&#95;iterator</a> IncEnd = <a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>();</Highlight></CodeLine>
<Link id="l03236" /><CodeLine lineNumber="3236"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal">( ; IncIter != IncEnd; ++IncIter) &#123;</Highlight></CodeLine>
<Link id="l03237" /><CodeLine lineNumber="3237"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IncIter-&gt;UserInst == OtherUse)</Highlight></CodeLine>
<Link id="l03238" /><CodeLine lineNumber="3238"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03239" /><CodeLine lineNumber="3239"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03240" /><CodeLine lineNumber="3240"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IncIter != IncEnd)</Highlight></CodeLine>
<Link id="l03241" /><CodeLine lineNumber="3241"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03242" /><CodeLine lineNumber="3242"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03243" /><CodeLine lineNumber="3243"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.isSCEVable(OtherUse-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())</Highlight></CodeLine>
<Link id="l03244" /><CodeLine lineNumber="3244"><Highlight kind="normal">        &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(SE.getSCEV(OtherUse))</Highlight></CodeLine>
<Link id="l03245" /><CodeLine lineNumber="3245"><Highlight kind="normal">        &amp;&amp; IU.isIVUserOrOperand(OtherUse)) &#123;</Highlight></CodeLine>
<Link id="l03246" /><CodeLine lineNumber="3246"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03247" /><CodeLine lineNumber="3247"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03248" /><CodeLine lineNumber="3248"><Highlight kind="normal">    NearUsers.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(OtherUse);</Highlight></CodeLine>
<Link id="l03249" /><CodeLine lineNumber="3249"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03250" /><CodeLine lineNumber="3250"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03251" /><CodeLine lineNumber="3251"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Since this user is part of the chain, it&#39;s no longer considered a use</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03252" /><CodeLine lineNumber="3252"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// of the chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03253" /><CodeLine lineNumber="3253"><Highlight kind="normal">  ChainUsersVec&#91;ChainIdx&#93;.FarUsers.<a href="/docs/api/classes/llvm/smallvectorimpl/#a563ffc2ff61c499b3be2e00100cb72fa">erase</a>(UserInst);</Highlight></CodeLine>
<Link id="l03254" /><CodeLine lineNumber="3254"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03255" /><CodeLine lineNumber="3255"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03256" /><CodeLine lineNumber="3256"><Highlight kind="comment">/// Populate the vector of Chains.</Highlight></CodeLine>
<Link id="l03257" /><CodeLine lineNumber="3257"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l03258" /><CodeLine lineNumber="3258"><Highlight kind="comment">/// This decreases ILP at the architecture level. Targets with ample registers,</Highlight></CodeLine>
<Link id="l03259" /><CodeLine lineNumber="3259"><Highlight kind="comment">/// multiple memory ports, and no register renaming probably don&#39;t want</Highlight></CodeLine>
<Link id="l03260" /><CodeLine lineNumber="3260"><Highlight kind="comment">/// this. However, such targets should probably disable LSR altogether.</Highlight></CodeLine>
<Link id="l03261" /><CodeLine lineNumber="3261"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l03262" /><CodeLine lineNumber="3262"><Highlight kind="comment">/// The job of LSR is to make a reasonable choice of induction variables across</Highlight></CodeLine>
<Link id="l03263" /><CodeLine lineNumber="3263"><Highlight kind="comment">/// the loop. Subsequent passes can easily &quot;unchain&quot; computation exposing more</Highlight></CodeLine>
<Link id="l03264" /><CodeLine lineNumber="3264"><Highlight kind="comment">/// ILP &#42;within the loop&#42; if the target wants it.</Highlight></CodeLine>
<Link id="l03265" /><CodeLine lineNumber="3265"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l03266" /><CodeLine lineNumber="3266"><Highlight kind="comment">/// Finding the best IV chain is potentially a scheduling problem. Since LSR</Highlight></CodeLine>
<Link id="l03267" /><CodeLine lineNumber="3267"><Highlight kind="comment">/// will not reorder memory operations, it will recognize this as a chain, but</Highlight></CodeLine>
<Link id="l03268" /><CodeLine lineNumber="3268"><Highlight kind="comment">/// will generate redundant IV increments. Ideally this would be corrected later</Highlight></CodeLine>
<Link id="l03269" /><CodeLine lineNumber="3269"><Highlight kind="comment">/// by a smart scheduler:</Highlight></CodeLine>
<Link id="l03270" /><CodeLine lineNumber="3270"><Highlight kind="comment">///        = A&#91;i&#93;</Highlight></CodeLine>
<Link id="l03271" /><CodeLine lineNumber="3271"><Highlight kind="comment">///        = A&#91;i+x&#93;</Highlight></CodeLine>
<Link id="l03272" /><CodeLine lineNumber="3272"><Highlight kind="comment">/// A&#91;i&#93;   =</Highlight></CodeLine>
<Link id="l03273" /><CodeLine lineNumber="3273"><Highlight kind="comment">/// A&#91;i+x&#93; =</Highlight></CodeLine>
<Link id="l03274" /><CodeLine lineNumber="3274"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l03275" /><CodeLine lineNumber="3275"><Highlight kind="comment">/// TODO: Walk the entire domtree within this loop, not just the path to the</Highlight></CodeLine>
<Link id="l03276" /><CodeLine lineNumber="3276"><Highlight kind="comment">/// loop latch. This will discover chains on side paths, but requires</Highlight></CodeLine>
<Link id="l03277" /><CodeLine lineNumber="3277"><Highlight kind="comment">/// maintaining multiple copies of the Chains state.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03278" /><CodeLine lineNumber="3278"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::CollectChains() &#123;</Highlight></CodeLine>
<Link id="l03279" /><CodeLine lineNumber="3279"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Collecting IV Chains.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03280" /><CodeLine lineNumber="3280"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ChainUsers, 8&gt;</a> ChainUsersVec;</Highlight></CodeLine>
<Link id="l03281" /><CodeLine lineNumber="3281"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03282" /><CodeLine lineNumber="3282"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;,8&gt;</a> LatchPath;</Highlight></CodeLine>
<Link id="l03283" /><CodeLine lineNumber="3283"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;LoopHeader = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader();</Highlight></CodeLine>
<Link id="l03284" /><CodeLine lineNumber="3284"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a58b9df85470fc4e2a8066ff6a62e5a34">DomTreeNode</a> &#42;Rung = DT.getNode(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch());</Highlight></CodeLine>
<Link id="l03285" /><CodeLine lineNumber="3285"><Highlight kind="normal">       Rung-&gt;getBlock() != LoopHeader; Rung = Rung-&gt;getIDom()) &#123;</Highlight></CodeLine>
<Link id="l03286" /><CodeLine lineNumber="3286"><Highlight kind="normal">    LatchPath.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Rung-&gt;getBlock());</Highlight></CodeLine>
<Link id="l03287" /><CodeLine lineNumber="3287"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03288" /><CodeLine lineNumber="3288"><Highlight kind="normal">  LatchPath.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LoopHeader);</Highlight></CodeLine>
<Link id="l03289" /><CodeLine lineNumber="3289"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03290" /><CodeLine lineNumber="3290"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Walk the instruction stream from the loop header to the loop latch.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03291" /><CodeLine lineNumber="3291"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(LatchPath)) &#123;</Highlight></CodeLine>
<Link id="l03292" /><CodeLine lineNumber="3292"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : &#42;BB) &#123;</Highlight></CodeLine>
<Link id="l03293" /><CodeLine lineNumber="3293"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Skip instructions that weren&#39;t seen by IVUsers analysis.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03294" /><CodeLine lineNumber="3294"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || !IU.isIVUserOrOperand(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</Highlight></CodeLine>
<Link id="l03295" /><CodeLine lineNumber="3295"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03296" /><CodeLine lineNumber="3296"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03297" /><CodeLine lineNumber="3297"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Ignore users that are part of a SCEV expression. This way we only</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03298" /><CodeLine lineNumber="3298"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// consider leaf IV Users. This effectively rediscovers a portion of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03299" /><CodeLine lineNumber="3299"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// IVUsers analysis but in program order this time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03300" /><CodeLine lineNumber="3300"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.isSCEVable(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()) &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(SE.getSCEV(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)))</Highlight></CodeLine>
<Link id="l03301" /><CodeLine lineNumber="3301"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03302" /><CodeLine lineNumber="3302"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03303" /><CodeLine lineNumber="3303"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Remove this instruction from any NearUsers set it may be in.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03304" /><CodeLine lineNumber="3304"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> ChainIdx = 0, NChains = IVChainVec.size();</Highlight></CodeLine>
<Link id="l03305" /><CodeLine lineNumber="3305"><Highlight kind="normal">           ChainIdx &lt; NChains; ++ChainIdx) &#123;</Highlight></CodeLine>
<Link id="l03306" /><CodeLine lineNumber="3306"><Highlight kind="normal">        ChainUsersVec&#91;ChainIdx&#93;.NearUsers.<a href="/docs/api/classes/llvm/smallvectorimpl/#a563ffc2ff61c499b3be2e00100cb72fa">erase</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l03307" /><CodeLine lineNumber="3307"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l03308" /><CodeLine lineNumber="3308"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Search for operands that can be chained.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03309" /><CodeLine lineNumber="3309"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction&#42;, 4&gt;</a> UniqueOperands;</Highlight></CodeLine>
<Link id="l03310" /><CodeLine lineNumber="3310"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> IVOpEnd = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.op&#95;end();</Highlight></CodeLine>
<Link id="l03311" /><CodeLine lineNumber="3311"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> IVOpIter = <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.op&#95;begin(), IVOpEnd, L, SE);</Highlight></CodeLine>
<Link id="l03312" /><CodeLine lineNumber="3312"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (IVOpIter != IVOpEnd) &#123;</Highlight></CodeLine>
<Link id="l03313" /><CodeLine lineNumber="3313"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVOpInst = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(&#42;IVOpIter);</Highlight></CodeLine>
<Link id="l03314" /><CodeLine lineNumber="3314"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UniqueOperands.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(IVOpInst).second)</Highlight></CodeLine>
<Link id="l03315" /><CodeLine lineNumber="3315"><Highlight kind="normal">          ChainInstruction(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, IVOpInst, ChainUsersVec);</Highlight></CodeLine>
<Link id="l03316" /><CodeLine lineNumber="3316"><Highlight kind="normal">        IVOpIter = <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(std::next(IVOpIter), IVOpEnd, L, SE);</Highlight></CodeLine>
<Link id="l03317" /><CodeLine lineNumber="3317"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l03318" /><CodeLine lineNumber="3318"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="comment">// Continue walking down the instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03319" /><CodeLine lineNumber="3319"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="comment">// Continue walking down the domtree.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03320" /><CodeLine lineNumber="3320"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Visit phi backedges to determine if the chain can generate the IV postinc.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03321" /><CodeLine lineNumber="3321"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;PN : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;phis()) &#123;</Highlight></CodeLine>
<Link id="l03322" /><CodeLine lineNumber="3322"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SE.isSCEVable(PN.getType()))</Highlight></CodeLine>
<Link id="l03323" /><CodeLine lineNumber="3323"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03324" /><CodeLine lineNumber="3324"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03325" /><CodeLine lineNumber="3325"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IncV =</Highlight></CodeLine>
<Link id="l03326" /><CodeLine lineNumber="3326"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(PN.getIncomingValueForBlock(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()));</Highlight></CodeLine>
<Link id="l03327" /><CodeLine lineNumber="3327"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IncV)</Highlight></CodeLine>
<Link id="l03328" /><CodeLine lineNumber="3328"><Highlight kind="normal">      ChainInstruction(&amp;PN, IncV, ChainUsersVec);</Highlight></CodeLine>
<Link id="l03329" /><CodeLine lineNumber="3329"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03330" /><CodeLine lineNumber="3330"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remove any unprofitable chains.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03331" /><CodeLine lineNumber="3331"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> ChainIdx = 0;</Highlight></CodeLine>
<Link id="l03332" /><CodeLine lineNumber="3332"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> UsersIdx = 0, NChains = IVChainVec.size();</Highlight></CodeLine>
<Link id="l03333" /><CodeLine lineNumber="3333"><Highlight kind="normal">       UsersIdx &lt; NChains; ++UsersIdx) &#123;</Highlight></CodeLine>
<Link id="l03334" /><CodeLine lineNumber="3334"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#aca012302770ad32503de5e2c62344290">isProfitableChain</a>(IVChainVec&#91;UsersIdx&#93;,</Highlight></CodeLine>
<Link id="l03335" /><CodeLine lineNumber="3335"><Highlight kind="normal">                           ChainUsersVec&#91;UsersIdx&#93;.FarUsers, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>))</Highlight></CodeLine>
<Link id="l03336" /><CodeLine lineNumber="3336"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03337" /><CodeLine lineNumber="3337"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Preserve the chain at UsesIdx.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03338" /><CodeLine lineNumber="3338"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ChainIdx != UsersIdx)</Highlight></CodeLine>
<Link id="l03339" /><CodeLine lineNumber="3339"><Highlight kind="normal">      IVChainVec&#91;ChainIdx&#93; = IVChainVec&#91;UsersIdx&#93;;</Highlight></CodeLine>
<Link id="l03340" /><CodeLine lineNumber="3340"><Highlight kind="normal">    FinalizeChain(IVChainVec&#91;ChainIdx&#93;);</Highlight></CodeLine>
<Link id="l03341" /><CodeLine lineNumber="3341"><Highlight kind="normal">    ++ChainIdx;</Highlight></CodeLine>
<Link id="l03342" /><CodeLine lineNumber="3342"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03343" /><CodeLine lineNumber="3343"><Highlight kind="normal">  IVChainVec.resize(ChainIdx);</Highlight></CodeLine>
<Link id="l03344" /><CodeLine lineNumber="3344"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03345" /><CodeLine lineNumber="3345"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03346" /><CodeLine lineNumber="3346"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::FinalizeChain(IVChain &amp;Chain) &#123;</Highlight></CodeLine>
<Link id="l03347" /><CodeLine lineNumber="3347"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;empty IV chains are not allowed&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03348" /><CodeLine lineNumber="3348"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Final Chain: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs&#91;0&#93;.UserInst &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03349" /><CodeLine lineNumber="3349"><Highlight kind="normal">  </Highlight></CodeLine>
<Link id="l03350" /><CodeLine lineNumber="3350"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> IVInc &amp;Inc : Chain) &#123;</Highlight></CodeLine>
<Link id="l03351" /><CodeLine lineNumber="3351"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;        Inc: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Inc.UserInst &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03352" /><CodeLine lineNumber="3352"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> UseI = <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">find</a>(Inc.UserInst-&gt;operands(), Inc.IVOperand);</Highlight></CodeLine>
<Link id="l03353" /><CodeLine lineNumber="3353"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(UseI != Inc.UserInst-&gt;op&#95;end() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;cannot find IV operand&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03354" /><CodeLine lineNumber="3354"><Highlight kind="normal">    IVIncSet.insert(UseI);</Highlight></CodeLine>
<Link id="l03355" /><CodeLine lineNumber="3355"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03356" /><CodeLine lineNumber="3356"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03357" /><CodeLine lineNumber="3357"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03358" /><CodeLine lineNumber="3358"><Highlight kind="comment">/// Return true if the IVInc can be folded into an addressing mode.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03359" /><CodeLine lineNumber="3359" lineLink="#ad35b9a85ea52062375c0c870be5cd228"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#ad35b9a85ea52062375c0c870be5cd228">canFoldIVIncExpr</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst,</Highlight></CodeLine>
<Link id="l03360" /><CodeLine lineNumber="3360"><Highlight kind="normal">                             <a href="/docs/api/classes/llvm/value">Value</a> &#42;Operand, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>) &#123;</Highlight></CodeLine>
<Link id="l03361" /><CodeLine lineNumber="3361"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;IncConst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(IncExpr);</Highlight></CodeLine>
<Link id="l03362" /><CodeLine lineNumber="3362"><Highlight kind="normal">  Immediate IncOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</Highlight></CodeLine>
<Link id="l03363" /><CodeLine lineNumber="3363"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IncConst) &#123;</Highlight></CodeLine>
<Link id="l03364" /><CodeLine lineNumber="3364"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IncConst &amp;&amp; IncConst-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a6caf7f3a0a4303e4c0bc06ed8e205126">getAPInt</a>().<a href="/docs/api/classes/llvm/apint/#a9f78d7e839322a6bfc0c665d29052242">getSignificantBits</a>() &gt; 64)</Highlight></CodeLine>
<Link id="l03365" /><CodeLine lineNumber="3365"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03366" /><CodeLine lineNumber="3366"><Highlight kind="normal">    IncOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(IncConst-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a476a7aca5d55536fcbfb498dfe5d380d">getValue</a>()-&gt;<a href="/docs/api/classes/llvm/constantint/#aa8f4be0661aa64f5b1f20b15e93bb403">getSExtValue</a>());</Highlight></CodeLine>
<Link id="l03367" /><CodeLine lineNumber="3367"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l03368" /><CodeLine lineNumber="3368"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Look for mul(vscale, constant), to detect a scalable offset.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03369" /><CodeLine lineNumber="3369"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;IncVScale = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(IncExpr);</Highlight></CodeLine>
<Link id="l03370" /><CodeLine lineNumber="3370"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IncVScale || IncVScale-&gt;getNumOperands() != 2 ||</Highlight></CodeLine>
<Link id="l03371" /><CodeLine lineNumber="3371"><Highlight kind="normal">        !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVVScale&gt;</a>(IncVScale-&gt;getOperand(1)))</Highlight></CodeLine>
<Link id="l03372" /><CodeLine lineNumber="3372"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03373" /><CodeLine lineNumber="3373"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Scale = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(IncVScale-&gt;getOperand(0));</Highlight></CodeLine>
<Link id="l03374" /><CodeLine lineNumber="3374"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Scale || Scale-&gt;getType()-&gt;getScalarSizeInBits() &gt; 64)</Highlight></CodeLine>
<Link id="l03375" /><CodeLine lineNumber="3375"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03376" /><CodeLine lineNumber="3376"><Highlight kind="normal">    IncOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ac7030e0a5d4b154f205b3d85dde0644b">Immediate::getScalable</a>(Scale-&gt;getValue()-&gt;getSExtValue());</Highlight></CodeLine>
<Link id="l03377" /><CodeLine lineNumber="3377"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03378" /><CodeLine lineNumber="3378"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03379" /><CodeLine lineNumber="3379"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UserInst, Operand))</Highlight></CodeLine>
<Link id="l03380" /><CodeLine lineNumber="3380"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03381" /><CodeLine lineNumber="3381"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03382" /><CodeLine lineNumber="3382"><Highlight kind="normal">  MemAccessTy AccessTy = <a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UserInst, Operand);</Highlight></CodeLine>
<Link id="l03383" /><CodeLine lineNumber="3383"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>, AccessTy, </Highlight><Highlight kind="comment">/&#42;BaseGV=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l03384" /><CodeLine lineNumber="3384"><Highlight kind="normal">                        IncOffset, </Highlight><Highlight kind="comment">/&#42;HasBaseReg=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">))</Highlight></CodeLine>
<Link id="l03385" /><CodeLine lineNumber="3385"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03386" /><CodeLine lineNumber="3386"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03387" /><CodeLine lineNumber="3387"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03388" /><CodeLine lineNumber="3388"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03389" /><CodeLine lineNumber="3389"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03390" /><CodeLine lineNumber="3390"><Highlight kind="comment">/// Generate an add or subtract for each IVInc in a chain to materialize the IV</Highlight></CodeLine>
<Link id="l03391" /><CodeLine lineNumber="3391"><Highlight kind="comment">/// user&#39;s operand from the previous IV user&#39;s operand.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03392" /><CodeLine lineNumber="3392"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateIVChain(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> IVChain &amp;Chain,</Highlight></CodeLine>
<Link id="l03393" /><CodeLine lineNumber="3393"><Highlight kind="normal">                                  <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts) &#123;</Highlight></CodeLine>
<Link id="l03394" /><CodeLine lineNumber="3394"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Find the new IVOperand for the head of the chain. It may have been replaced</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03395" /><CodeLine lineNumber="3395"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// by LSR.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03396" /><CodeLine lineNumber="3396"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> IVInc &amp;Head = <a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs&#91;0&#93;;</Highlight></CodeLine>
<Link id="l03397" /><CodeLine lineNumber="3397"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> IVOpEnd = Head.UserInst-&gt;op&#95;end();</Highlight></CodeLine>
<Link id="l03398" /><CodeLine lineNumber="3398"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// findIVOperand returns IVOpEnd if it can no longer find a valid IV user.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03399" /><CodeLine lineNumber="3399"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> IVOpIter = <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(Head.UserInst-&gt;op&#95;begin(),</Highlight></CodeLine>
<Link id="l03400" /><CodeLine lineNumber="3400"><Highlight kind="normal">                                             IVOpEnd, L, SE);</Highlight></CodeLine>
<Link id="l03401" /><CodeLine lineNumber="3401"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;IVSrc = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03402" /><CodeLine lineNumber="3402"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (IVOpIter != IVOpEnd) &#123;</Highlight></CodeLine>
<Link id="l03403" /><CodeLine lineNumber="3403"><Highlight kind="normal">    IVSrc = <a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(&#42;IVOpIter);</Highlight></CodeLine>
<Link id="l03404" /><CodeLine lineNumber="3404"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03405" /><CodeLine lineNumber="3405"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If this operand computes the expression that the chain needs, we may use</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03406" /><CodeLine lineNumber="3406"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// it. (Check this after setting IVSrc which is used below.)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03407" /><CodeLine lineNumber="3407"><Highlight kind="normal">    </Highlight><Highlight kind="comment">//</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03408" /><CodeLine lineNumber="3408"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Note that if Head.IncExpr is wider than IVSrc, then this phi is too</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03409" /><CodeLine lineNumber="3409"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// narrow for the chain, so we can no longer use it. We do allow using a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03410" /><CodeLine lineNumber="3410"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// wider phi, assuming the LSR checked for free truncation. In that case we</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03411" /><CodeLine lineNumber="3411"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// should already have a truncate on this operand such that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03412" /><CodeLine lineNumber="3412"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// getSCEV(IVSrc) == IncExpr.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03413" /><CodeLine lineNumber="3413"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getSCEV(&#42;IVOpIter) == Head.IncExpr</Highlight></CodeLine>
<Link id="l03414" /><CodeLine lineNumber="3414"><Highlight kind="normal">        || SE.getSCEV(IVSrc) == Head.IncExpr) &#123;</Highlight></CodeLine>
<Link id="l03415" /><CodeLine lineNumber="3415"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03416" /><CodeLine lineNumber="3416"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03417" /><CodeLine lineNumber="3417"><Highlight kind="normal">    IVOpIter = <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(std::next(IVOpIter), IVOpEnd, L, SE);</Highlight></CodeLine>
<Link id="l03418" /><CodeLine lineNumber="3418"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03419" /><CodeLine lineNumber="3419"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IVOpIter == IVOpEnd) &#123;</Highlight></CodeLine>
<Link id="l03420" /><CodeLine lineNumber="3420"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Gracefully give up on this chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03421" /><CodeLine lineNumber="3421"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Concealed chain head: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Head.UserInst &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03422" /><CodeLine lineNumber="3422"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03423" /><CodeLine lineNumber="3423"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03424" /><CodeLine lineNumber="3424"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IVSrc &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Failed to find IV chain source&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03425" /><CodeLine lineNumber="3425"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03426" /><CodeLine lineNumber="3426"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Generate chain at: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;IVSrc &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03427" /><CodeLine lineNumber="3427"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IVTy = IVSrc-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l03428" /><CodeLine lineNumber="3428"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = SE.getEffectiveSCEVType(IVTy);</Highlight></CodeLine>
<Link id="l03429" /><CodeLine lineNumber="3429"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LeftOverExpr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03430" /><CodeLine lineNumber="3430"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Accum = SE.getZero(IntTy);</Highlight></CodeLine>
<Link id="l03431" /><CodeLine lineNumber="3431"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;const SCEV &#42;, Value &#42;&gt;</a>&gt; Bases;</Highlight></CodeLine>
<Link id="l03432" /><CodeLine lineNumber="3432"><Highlight kind="normal">  Bases.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Accum, IVSrc);</Highlight></CodeLine>
<Link id="l03433" /><CodeLine lineNumber="3433"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03434" /><CodeLine lineNumber="3434"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> IVInc &amp;Inc : Chain) &#123;</Highlight></CodeLine>
<Link id="l03435" /><CodeLine lineNumber="3435"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;InsertPt = Inc.UserInst;</Highlight></CodeLine>
<Link id="l03436" /><CodeLine lineNumber="3436"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(InsertPt))</Highlight></CodeLine>
<Link id="l03437" /><CodeLine lineNumber="3437"><Highlight kind="normal">      InsertPt = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()-&gt;getTerminator();</Highlight></CodeLine>
<Link id="l03438" /><CodeLine lineNumber="3438"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03439" /><CodeLine lineNumber="3439"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// IVOper will replace the current IV User&#39;s operand. IVSrc is the IV</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03440" /><CodeLine lineNumber="3440"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// value currently held in a register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03441" /><CodeLine lineNumber="3441"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;IVOper = IVSrc;</Highlight></CodeLine>
<Link id="l03442" /><CodeLine lineNumber="3442"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Inc.IncExpr-&gt;isZero()) &#123;</Highlight></CodeLine>
<Link id="l03443" /><CodeLine lineNumber="3443"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// IncExpr was the result of subtraction of two narrow values, so must</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03444" /><CodeLine lineNumber="3444"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// be signed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03445" /><CodeLine lineNumber="3445"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr = SE.getNoopOrSignExtend(Inc.IncExpr, IntTy);</Highlight></CodeLine>
<Link id="l03446" /><CodeLine lineNumber="3446"><Highlight kind="normal">      Accum = SE.getAddExpr(Accum, IncExpr);</Highlight></CodeLine>
<Link id="l03447" /><CodeLine lineNumber="3447"><Highlight kind="normal">      LeftOverExpr = LeftOverExpr ?</Highlight></CodeLine>
<Link id="l03448" /><CodeLine lineNumber="3448"><Highlight kind="normal">        SE.getAddExpr(LeftOverExpr, IncExpr) : IncExpr;</Highlight></CodeLine>
<Link id="l03449" /><CodeLine lineNumber="3449"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03450" /><CodeLine lineNumber="3450"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03451" /><CodeLine lineNumber="3451"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Look through each base to see if any can produce a nice addressing mode.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03452" /><CodeLine lineNumber="3452"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> FoundBase = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03453" /><CodeLine lineNumber="3453"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#91;MapScev, MapIVOper&#93; : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(Bases)) &#123;</Highlight></CodeLine>
<Link id="l03454" /><CodeLine lineNumber="3454"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder = SE.getMinusSCEV(Accum, MapScev);</Highlight></CodeLine>
<Link id="l03455" /><CodeLine lineNumber="3455"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#ad35b9a85ea52062375c0c870be5cd228">canFoldIVIncExpr</a>(Remainder, Inc.UserInst, Inc.IVOperand, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>)) &#123;</Highlight></CodeLine>
<Link id="l03456" /><CodeLine lineNumber="3456"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Remainder-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</Highlight></CodeLine>
<Link id="l03457" /><CodeLine lineNumber="3457"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clearPostInc();</Highlight></CodeLine>
<Link id="l03458" /><CodeLine lineNumber="3458"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/value">Value</a> &#42;IncV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(Remainder, IntTy, InsertPt);</Highlight></CodeLine>
<Link id="l03459" /><CodeLine lineNumber="3459"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IVOperExpr =</Highlight></CodeLine>
<Link id="l03460" /><CodeLine lineNumber="3460"><Highlight kind="normal">              SE.getAddExpr(SE.getUnknown(MapIVOper), SE.getUnknown(IncV));</Highlight></CodeLine>
<Link id="l03461" /><CodeLine lineNumber="3461"><Highlight kind="normal">          IVOper = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(IVOperExpr, IVTy, InsertPt);</Highlight></CodeLine>
<Link id="l03462" /><CodeLine lineNumber="3462"><Highlight kind="normal">        &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l03463" /><CodeLine lineNumber="3463"><Highlight kind="normal">          IVOper = MapIVOper;</Highlight></CodeLine>
<Link id="l03464" /><CodeLine lineNumber="3464"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l03465" /><CodeLine lineNumber="3465"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03466" /><CodeLine lineNumber="3466"><Highlight kind="normal">        FoundBase = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03467" /><CodeLine lineNumber="3467"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03468" /><CodeLine lineNumber="3468"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l03469" /><CodeLine lineNumber="3469"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03470" /><CodeLine lineNumber="3470"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!FoundBase &amp;&amp; LeftOverExpr &amp;&amp; !LeftOverExpr-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</Highlight></CodeLine>
<Link id="l03471" /><CodeLine lineNumber="3471"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Expand the IV increment.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03472" /><CodeLine lineNumber="3472"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clearPostInc();</Highlight></CodeLine>
<Link id="l03473" /><CodeLine lineNumber="3473"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;IncV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(LeftOverExpr, IntTy, InsertPt);</Highlight></CodeLine>
<Link id="l03474" /><CodeLine lineNumber="3474"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IVOperExpr = SE.getAddExpr(SE.getUnknown(IVSrc),</Highlight></CodeLine>
<Link id="l03475" /><CodeLine lineNumber="3475"><Highlight kind="normal">                                             SE.getUnknown(IncV));</Highlight></CodeLine>
<Link id="l03476" /><CodeLine lineNumber="3476"><Highlight kind="normal">      IVOper = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(IVOperExpr, IVTy, InsertPt);</Highlight></CodeLine>
<Link id="l03477" /><CodeLine lineNumber="3477"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03478" /><CodeLine lineNumber="3478"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If an IV increment can&#39;t be folded, use it as the next IV value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03479" /><CodeLine lineNumber="3479"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#ad35b9a85ea52062375c0c870be5cd228">canFoldIVIncExpr</a>(LeftOverExpr, Inc.UserInst, Inc.IVOperand, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>)) &#123;</Highlight></CodeLine>
<Link id="l03480" /><CodeLine lineNumber="3480"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IVTy == IVOper-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;inconsistent IV increment type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03481" /><CodeLine lineNumber="3481"><Highlight kind="normal">        Bases.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Accum, IVOper);</Highlight></CodeLine>
<Link id="l03482" /><CodeLine lineNumber="3482"><Highlight kind="normal">        IVSrc = IVOper;</Highlight></CodeLine>
<Link id="l03483" /><CodeLine lineNumber="3483"><Highlight kind="normal">        LeftOverExpr = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03484" /><CodeLine lineNumber="3484"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l03485" /><CodeLine lineNumber="3485"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03486" /><CodeLine lineNumber="3486"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;OperTy = Inc.IVOperand-&gt;getType();</Highlight></CodeLine>
<Link id="l03487" /><CodeLine lineNumber="3487"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IVTy != OperTy) &#123;</Highlight></CodeLine>
<Link id="l03488" /><CodeLine lineNumber="3488"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SE.getTypeSizeInBits(IVTy) &gt;= SE.getTypeSizeInBits(OperTy) &amp;&amp;</Highlight></CodeLine>
<Link id="l03489" /><CodeLine lineNumber="3489"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;cannot extend a chained IV&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03490" /><CodeLine lineNumber="3490"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> Builder(InsertPt);</Highlight></CodeLine>
<Link id="l03491" /><CodeLine lineNumber="3491"><Highlight kind="normal">      IVOper = Builder.CreateTruncOrBitCast(IVOper, OperTy, </Highlight><Highlight kind="stringliteral">&quot;lsr.chain&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03492" /><CodeLine lineNumber="3492"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03493" /><CodeLine lineNumber="3493"><Highlight kind="normal">    Inc.UserInst-&gt;replaceUsesOfWith(Inc.IVOperand, IVOper);</Highlight></CodeLine>
<Link id="l03494" /><CodeLine lineNumber="3494"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;OperandIsInstr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(Inc.IVOperand))</Highlight></CodeLine>
<Link id="l03495" /><CodeLine lineNumber="3495"><Highlight kind="normal">      DeadInsts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(OperandIsInstr);</Highlight></CodeLine>
<Link id="l03496" /><CodeLine lineNumber="3496"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03497" /><CodeLine lineNumber="3497"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If LSR created a new, wider phi, we may also replace its postinc. We only</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03498" /><CodeLine lineNumber="3498"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// do this if we also found a wide value for the head of the chain.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03499" /><CodeLine lineNumber="3499"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.tailUserInst())) &#123;</Highlight></CodeLine>
<Link id="l03500" /><CodeLine lineNumber="3500"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;Phi : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;phis()) &#123;</Highlight></CodeLine>
<Link id="l03501" /><CodeLine lineNumber="3501"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/rdf/#a379bee2dadbfd1d7a599f003c4275dd8">Phi</a>.getType() != IVSrc-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())</Highlight></CodeLine>
<Link id="l03502" /><CodeLine lineNumber="3502"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03503" /><CodeLine lineNumber="3503"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;PostIncV = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(</Highlight></CodeLine>
<Link id="l03504" /><CodeLine lineNumber="3504"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/rdf/#a379bee2dadbfd1d7a599f003c4275dd8">Phi</a>.getIncomingValueForBlock(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()));</Highlight></CodeLine>
<Link id="l03505" /><CodeLine lineNumber="3505"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!PostIncV || (SE.getSCEV(PostIncV) != SE.getSCEV(IVSrc)))</Highlight></CodeLine>
<Link id="l03506" /><CodeLine lineNumber="3506"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03507" /><CodeLine lineNumber="3507"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;IVOper = IVSrc;</Highlight></CodeLine>
<Link id="l03508" /><CodeLine lineNumber="3508"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/type">Type</a> &#42;PostIncTy = PostIncV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</Highlight></CodeLine>
<Link id="l03509" /><CodeLine lineNumber="3509"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IVTy != PostIncTy) &#123;</Highlight></CodeLine>
<Link id="l03510" /><CodeLine lineNumber="3510"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PostIncTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;mixing int/ptr IV types&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03511" /><CodeLine lineNumber="3511"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> Builder(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()-&gt;getTerminator());</Highlight></CodeLine>
<Link id="l03512" /><CodeLine lineNumber="3512"><Highlight kind="normal">        Builder.SetCurrentDebugLocation(PostIncV-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</Highlight></CodeLine>
<Link id="l03513" /><CodeLine lineNumber="3513"><Highlight kind="normal">        IVOper = Builder.CreatePointerCast(IVSrc, PostIncTy, </Highlight><Highlight kind="stringliteral">&quot;lsr.chain&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03514" /><CodeLine lineNumber="3514"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l03515" /><CodeLine lineNumber="3515"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/rdf/#a379bee2dadbfd1d7a599f003c4275dd8">Phi</a>.replaceUsesOfWith(PostIncV, IVOper);</Highlight></CodeLine>
<Link id="l03516" /><CodeLine lineNumber="3516"><Highlight kind="normal">      DeadInsts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(PostIncV);</Highlight></CodeLine>
<Link id="l03517" /><CodeLine lineNumber="3517"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03518" /><CodeLine lineNumber="3518"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03519" /><CodeLine lineNumber="3519"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03520" /><CodeLine lineNumber="3520"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03521" /><CodeLine lineNumber="3521"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::CollectFixupsAndInitialFormulae() &#123;</Highlight></CodeLine>
<Link id="l03522" /><CodeLine lineNumber="3522"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/branchinst">BranchInst</a> &#42;ExitBranch = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03523" /><CodeLine lineNumber="3523"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> SaveCmp = <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.canSaveCmp(L, &amp;ExitBranch, &amp;SE, &amp;LI, &amp;DT, &amp;AC, &amp;TLI);</Highlight></CodeLine>
<Link id="l03524" /><CodeLine lineNumber="3524"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03525" /><CodeLine lineNumber="3525"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// For calculating baseline cost</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03526" /><CodeLine lineNumber="3526"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> Regs;</Highlight></CodeLine>
<Link id="l03527" /><CodeLine lineNumber="3527"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> VisitedRegs;</Highlight></CodeLine>
<Link id="l03528" /><CodeLine lineNumber="3528"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;size&#95;t&gt;</a> VisitedLSRUse;</Highlight></CodeLine>
<Link id="l03529" /><CodeLine lineNumber="3529"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03530" /><CodeLine lineNumber="3530"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;U : IU) &#123;</Highlight></CodeLine>
<Link id="l03531" /><CodeLine lineNumber="3531"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser();</Highlight></CodeLine>
<Link id="l03532" /><CodeLine lineNumber="3532"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Skip IV users that are part of profitable IV Chains.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03533" /><CodeLine lineNumber="3533"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> UseI =</Highlight></CodeLine>
<Link id="l03534" /><CodeLine lineNumber="3534"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">find</a>(UserInst-&gt;<a href="/docs/api/classes/llvm/user/#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>(), <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace());</Highlight></CodeLine>
<Link id="l03535" /><CodeLine lineNumber="3535"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(UseI != UserInst-&gt;<a href="/docs/api/classes/llvm/user/#af41f58e730804d10b91fcff39b035f74">op&#95;end</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;cannot find IV operand&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03536" /><CodeLine lineNumber="3536"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IVIncSet.count(UseI)) &#123;</Highlight></CodeLine>
<Link id="l03537" /><CodeLine lineNumber="3537"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Use is in profitable chain: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;&#42;UseI &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03538" /><CodeLine lineNumber="3538"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03539" /><CodeLine lineNumber="3539"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03540" /><CodeLine lineNumber="3540"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03541" /><CodeLine lineNumber="3541"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> <a href="/docs/api/namespaces/llvm/lltok/#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a>;</Highlight></CodeLine>
<Link id="l03542" /><CodeLine lineNumber="3542"><Highlight kind="normal">    MemAccessTy AccessTy;</Highlight></CodeLine>
<Link id="l03543" /><CodeLine lineNumber="3543"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UserInst, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace())) &#123;</Highlight></CodeLine>
<Link id="l03544" /><CodeLine lineNumber="3544"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/lltok/#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>;</Highlight></CodeLine>
<Link id="l03545" /><CodeLine lineNumber="3545"><Highlight kind="normal">      AccessTy = <a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UserInst, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace());</Highlight></CodeLine>
<Link id="l03546" /><CodeLine lineNumber="3546"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03547" /><CodeLine lineNumber="3547"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03548" /><CodeLine lineNumber="3548"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = IU.getExpr(U);</Highlight></CodeLine>
<Link id="l03549" /><CodeLine lineNumber="3549"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!S)</Highlight></CodeLine>
<Link id="l03550" /><CodeLine lineNumber="3550"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03551" /><CodeLine lineNumber="3551"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> TmpPostIncLoops = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getPostIncLoops();</Highlight></CodeLine>
<Link id="l03552" /><CodeLine lineNumber="3552"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03553" /><CodeLine lineNumber="3553"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Equality (== and !=) ICmps are special. We can rewrite (i == N) as</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03554" /><CodeLine lineNumber="3554"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// (N - i == 0), and this allows (N - i) to be the expression that we work</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03555" /><CodeLine lineNumber="3555"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// with rather than just N or i, so we can consider the register</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03556" /><CodeLine lineNumber="3556"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// requirements for both N and i at the same time. Limiting this code to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03557" /><CodeLine lineNumber="3557"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// equality icmps is not a problem because all interesting loops use</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03558" /><CodeLine lineNumber="3558"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// equality icmps, thanks to IndVarSimplify.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03559" /><CodeLine lineNumber="3559"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;CI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ICmpInst&gt;</a>(UserInst)) &#123;</Highlight></CodeLine>
<Link id="l03560" /><CodeLine lineNumber="3560"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If CI can be saved in some target, like replaced inside hardware loop</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03561" /><CodeLine lineNumber="3561"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// in PowerPC, no need to generate initial formulae for it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03562" /><CodeLine lineNumber="3562"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SaveCmp &amp;&amp; CI == <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ICmpInst&gt;</a>(ExitBranch-&gt;<a href="/docs/api/classes/llvm/branchinst/#aebd4af5642453ce3169094f08dd3d7b8">getCondition</a>()))</Highlight></CodeLine>
<Link id="l03563" /><CodeLine lineNumber="3563"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03564" /><CodeLine lineNumber="3564"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CI-&gt;isEquality()) &#123;</Highlight></CodeLine>
<Link id="l03565" /><CodeLine lineNumber="3565"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Swap the operands if needed to put the OperandValToReplace on the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03566" /><CodeLine lineNumber="3566"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// left, for consistency.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03567" /><CodeLine lineNumber="3567"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/ore/#a5ca06dfbc998afac005414d8e9b7c234">NV</a> = CI-&gt;getOperand(1);</Highlight></CodeLine>
<Link id="l03568" /><CodeLine lineNumber="3568"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NV == <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace()) &#123;</Highlight></CodeLine>
<Link id="l03569" /><CodeLine lineNumber="3569"><Highlight kind="normal">          CI-&gt;setOperand(1, CI-&gt;getOperand(0));</Highlight></CodeLine>
<Link id="l03570" /><CodeLine lineNumber="3570"><Highlight kind="normal">          CI-&gt;setOperand(0, NV);</Highlight></CodeLine>
<Link id="l03571" /><CodeLine lineNumber="3571"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/ore/#a5ca06dfbc998afac005414d8e9b7c234">NV</a> = CI-&gt;getOperand(1);</Highlight></CodeLine>
<Link id="l03572" /><CodeLine lineNumber="3572"><Highlight kind="normal">          <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03573" /><CodeLine lineNumber="3573"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l03574" /><CodeLine lineNumber="3574"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03575" /><CodeLine lineNumber="3575"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// x == y  --&gt;  x - y == 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03576" /><CodeLine lineNumber="3576"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = SE.getSCEV(NV);</Highlight></CodeLine>
<Link id="l03577" /><CodeLine lineNumber="3577"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.isLoopInvariant(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, L) &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isSafeToExpand(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l03578" /><CodeLine lineNumber="3578"><Highlight kind="normal">            (!<a href="/docs/api/namespaces/llvm/ore/#a5ca06dfbc998afac005414d8e9b7c234">NV</a>-&gt;getType()-&gt;isPointerTy() ||</Highlight></CodeLine>
<Link id="l03579" /><CodeLine lineNumber="3579"><Highlight kind="normal">             SE.getPointerBase(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>) == SE.getPointerBase(S))) &#123;</Highlight></CodeLine>
<Link id="l03580" /><CodeLine lineNumber="3580"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// S is normalized, so normalize N before folding it into S</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03581" /><CodeLine lineNumber="3581"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// to keep the result normalized.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03582" /><CodeLine lineNumber="3582"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = <a href="/docs/api/namespaces/llvm/#a99237ea99bf8618b7d29b5ca6185069b">normalizeForPostIncUse</a>(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, TmpPostIncLoops, SE);</Highlight></CodeLine>
<Link id="l03583" /><CodeLine lineNumber="3583"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>)</Highlight></CodeLine>
<Link id="l03584" /><CodeLine lineNumber="3584"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03585" /><CodeLine lineNumber="3585"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/lltok/#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>;</Highlight></CodeLine>
<Link id="l03586" /><CodeLine lineNumber="3586"><Highlight kind="normal">          S = SE.getMinusSCEV(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, S);</Highlight></CodeLine>
<Link id="l03587" /><CodeLine lineNumber="3587"><Highlight kind="normal">        &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;isLoopInvariant(NV) &amp;&amp;</Highlight></CodeLine>
<Link id="l03588" /><CodeLine lineNumber="3588"><Highlight kind="normal">                   (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;Instruction&gt;</a>(NV) ||</Highlight></CodeLine>
<Link id="l03589" /><CodeLine lineNumber="3589"><Highlight kind="normal">                    DT.dominates(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(NV), <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader())) &amp;&amp;</Highlight></CodeLine>
<Link id="l03590" /><CodeLine lineNumber="3590"><Highlight kind="normal">                   !<a href="/docs/api/namespaces/llvm/ore/#a5ca06dfbc998afac005414d8e9b7c234">NV</a>-&gt;getType()-&gt;isPointerTy()) &#123;</Highlight></CodeLine>
<Link id="l03591" /><CodeLine lineNumber="3591"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// If we can&#39;t generally expand the expression (e.g. it contains</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03592" /><CodeLine lineNumber="3592"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// a divide), but it is already at a loop invariant point before the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03593" /><CodeLine lineNumber="3593"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// loop, wrap it in an unknown (to prevent the expander from trying</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03594" /><CodeLine lineNumber="3594"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// to re-expand in a potentially unsafe way.)  The restriction to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03595" /><CodeLine lineNumber="3595"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// integer types is required because the unknown hides the base, and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03596" /><CodeLine lineNumber="3596"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// SCEV can&#39;t compute the difference of two unknown pointers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03597" /><CodeLine lineNumber="3597"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = SE.getUnknown(NV);</Highlight></CodeLine>
<Link id="l03598" /><CodeLine lineNumber="3598"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = <a href="/docs/api/namespaces/llvm/#a99237ea99bf8618b7d29b5ca6185069b">normalizeForPostIncUse</a>(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, TmpPostIncLoops, SE);</Highlight></CodeLine>
<Link id="l03599" /><CodeLine lineNumber="3599"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>)</Highlight></CodeLine>
<Link id="l03600" /><CodeLine lineNumber="3600"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03601" /><CodeLine lineNumber="3601"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/lltok/#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>;</Highlight></CodeLine>
<Link id="l03602" /><CodeLine lineNumber="3602"><Highlight kind="normal">          S = SE.getMinusSCEV(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, S);</Highlight></CodeLine>
<Link id="l03603" /><CodeLine lineNumber="3603"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVCouldNotCompute&gt;</a>(S));</Highlight></CodeLine>
<Link id="l03604" /><CodeLine lineNumber="3604"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l03605" /><CodeLine lineNumber="3605"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03606" /><CodeLine lineNumber="3606"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// -1 and the negations of all interesting strides (except the negation</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03607" /><CodeLine lineNumber="3607"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// of -1) are now also interesting.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03608" /><CodeLine lineNumber="3608"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = Factors.size(); i != e; ++i)</Highlight></CodeLine>
<Link id="l03609" /><CodeLine lineNumber="3609"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Factors&#91;i&#93; != -1)</Highlight></CodeLine>
<Link id="l03610" /><CodeLine lineNumber="3610"><Highlight kind="normal">            Factors.insert(-(uint64&#95;t)Factors&#91;i&#93;);</Highlight></CodeLine>
<Link id="l03611" /><CodeLine lineNumber="3611"><Highlight kind="normal">        Factors.insert(-1);</Highlight></CodeLine>
<Link id="l03612" /><CodeLine lineNumber="3612"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l03613" /><CodeLine lineNumber="3613"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03614" /><CodeLine lineNumber="3614"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03615" /><CodeLine lineNumber="3615"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Get or create an LSRUse.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03616" /><CodeLine lineNumber="3616"><Highlight kind="normal">    std::pair&lt;size&#95;t, Immediate&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = getUse(S, Kind, AccessTy);</Highlight></CodeLine>
<Link id="l03617" /><CodeLine lineNumber="3617"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first;</Highlight></CodeLine>
<Link id="l03618" /><CodeLine lineNumber="3618"><Highlight kind="normal">    Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second;</Highlight></CodeLine>
<Link id="l03619" /><CodeLine lineNumber="3619"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l03620" /><CodeLine lineNumber="3620"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03621" /><CodeLine lineNumber="3621"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Record the fixup.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03622" /><CodeLine lineNumber="3622"><Highlight kind="normal">    LSRFixup &amp;LF = LU.getNewFixup();</Highlight></CodeLine>
<Link id="l03623" /><CodeLine lineNumber="3623"><Highlight kind="normal">    LF.UserInst = UserInst;</Highlight></CodeLine>
<Link id="l03624" /><CodeLine lineNumber="3624"><Highlight kind="normal">    LF.OperandValToReplace = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace();</Highlight></CodeLine>
<Link id="l03625" /><CodeLine lineNumber="3625"><Highlight kind="normal">    LF.PostIncLoops = TmpPostIncLoops;</Highlight></CodeLine>
<Link id="l03626" /><CodeLine lineNumber="3626"><Highlight kind="normal">    LF.Offset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</Highlight></CodeLine>
<Link id="l03627" /><CodeLine lineNumber="3627"><Highlight kind="normal">    LU.AllFixupsOutsideLoop &amp;= LF.isUseFullyOutsideLoop(L);</Highlight></CodeLine>
<Link id="l03628" /><CodeLine lineNumber="3628"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03629" /><CodeLine lineNumber="3629"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Create SCEV as Formula for calculating baseline cost</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03630" /><CodeLine lineNumber="3630"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!VisitedLSRUse.<a href="/docs/api/classes/llvm/detail/densesetimpl/#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(LUIdx) &amp;&amp; !LF.isUseFullyOutsideLoop(L)) &#123;</Highlight></CodeLine>
<Link id="l03631" /><CodeLine lineNumber="3631"><Highlight kind="normal">      Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</Highlight></CodeLine>
<Link id="l03632" /><CodeLine lineNumber="3632"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.initialMatch(S, L, SE);</Highlight></CodeLine>
<Link id="l03633" /><CodeLine lineNumber="3633"><Highlight kind="normal">      BaselineCost.RateFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Regs, VisitedRegs, LU);</Highlight></CodeLine>
<Link id="l03634" /><CodeLine lineNumber="3634"><Highlight kind="normal">      VisitedLSRUse.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(LUIdx);</Highlight></CodeLine>
<Link id="l03635" /><CodeLine lineNumber="3635"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03636" /><CodeLine lineNumber="3636"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03637" /><CodeLine lineNumber="3637"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LU.WidestFixupType ||</Highlight></CodeLine>
<Link id="l03638" /><CodeLine lineNumber="3638"><Highlight kind="normal">        SE.getTypeSizeInBits(LU.WidestFixupType) &lt;</Highlight></CodeLine>
<Link id="l03639" /><CodeLine lineNumber="3639"><Highlight kind="normal">        SE.getTypeSizeInBits(LF.OperandValToReplace-&gt;getType()))</Highlight></CodeLine>
<Link id="l03640" /><CodeLine lineNumber="3640"><Highlight kind="normal">      LU.WidestFixupType = LF.OperandValToReplace-&gt;getType();</Highlight></CodeLine>
<Link id="l03641" /><CodeLine lineNumber="3641"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03642" /><CodeLine lineNumber="3642"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If this is the first use of this LSRUse, give it a formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03643" /><CodeLine lineNumber="3643"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Formulae.empty()) &#123;</Highlight></CodeLine>
<Link id="l03644" /><CodeLine lineNumber="3644"><Highlight kind="normal">      InsertInitialFormula(S, LU, LUIdx);</Highlight></CodeLine>
<Link id="l03645" /><CodeLine lineNumber="3645"><Highlight kind="normal">      CountRegisters(LU.Formulae.back(), LUIdx);</Highlight></CodeLine>
<Link id="l03646" /><CodeLine lineNumber="3646"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03647" /><CodeLine lineNumber="3647"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03648" /><CodeLine lineNumber="3648"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03649" /><CodeLine lineNumber="3649"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(print&#95;fixups(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l03650" /><CodeLine lineNumber="3650"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03651" /><CodeLine lineNumber="3651"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03652" /><CodeLine lineNumber="3652"><Highlight kind="comment">/// Insert a formula for the given expression into the given use, separating out</Highlight></CodeLine>
<Link id="l03653" /><CodeLine lineNumber="3653"><Highlight kind="comment">/// loop-variant portions from loop-invariant and loop-computable portions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03654" /><CodeLine lineNumber="3654"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::InsertInitialFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, LSRUse &amp;LU,</Highlight></CodeLine>
<Link id="l03655" /><CodeLine lineNumber="3655"><Highlight kind="normal">                                       </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx) &#123;</Highlight></CodeLine>
<Link id="l03656" /><CodeLine lineNumber="3656"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Mark uses whose expressions cannot be expanded.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03657" /><CodeLine lineNumber="3657"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isSafeToExpand(S))</Highlight></CodeLine>
<Link id="l03658" /><CodeLine lineNumber="3658"><Highlight kind="normal">    LU.RigidFormula = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03659" /><CodeLine lineNumber="3659"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03660" /><CodeLine lineNumber="3660"><Highlight kind="normal">  Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</Highlight></CodeLine>
<Link id="l03661" /><CodeLine lineNumber="3661"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.initialMatch(S, L, SE);</Highlight></CodeLine>
<Link id="l03662" /><CodeLine lineNumber="3662"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a> = InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l03663" /><CodeLine lineNumber="3663"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Inserted &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Initial formula already exists!&quot;</Highlight><Highlight kind="normal">); (void)Inserted;</Highlight></CodeLine>
<Link id="l03664" /><CodeLine lineNumber="3664"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03665" /><CodeLine lineNumber="3665"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03666" /><CodeLine lineNumber="3666"><Highlight kind="comment">/// Insert a simple single-register formula for the given expression into the</Highlight></CodeLine>
<Link id="l03667" /><CodeLine lineNumber="3667"><Highlight kind="comment">/// given use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03668" /><CodeLine lineNumber="3668"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03669" /><CodeLine lineNumber="3669"><Highlight kind="normal">LSRInstance::InsertSupplementalFormula(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S,</Highlight></CodeLine>
<Link id="l03670" /><CodeLine lineNumber="3670"><Highlight kind="normal">                                       LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx) &#123;</Highlight></CodeLine>
<Link id="l03671" /><CodeLine lineNumber="3671"><Highlight kind="normal">  Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</Highlight></CodeLine>
<Link id="l03672" /><CodeLine lineNumber="3672"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.push&#95;back(S);</Highlight></CodeLine>
<Link id="l03673" /><CodeLine lineNumber="3673"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03674" /><CodeLine lineNumber="3674"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a> = InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l03675" /><CodeLine lineNumber="3675"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Inserted &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Supplemental formula already exists!&quot;</Highlight><Highlight kind="normal">); (void)Inserted;</Highlight></CodeLine>
<Link id="l03676" /><CodeLine lineNumber="3676"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03677" /><CodeLine lineNumber="3677"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03678" /><CodeLine lineNumber="3678"><Highlight kind="comment">/// Note which registers are used by the given formula, updating RegUses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03679" /><CodeLine lineNumber="3679"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::CountRegisters(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx) &#123;</Highlight></CodeLine>
<Link id="l03680" /><CodeLine lineNumber="3680"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg)</Highlight></CodeLine>
<Link id="l03681" /><CodeLine lineNumber="3681"><Highlight kind="normal">    RegUses.countRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, LUIdx);</Highlight></CodeLine>
<Link id="l03682" /><CodeLine lineNumber="3682"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs)</Highlight></CodeLine>
<Link id="l03683" /><CodeLine lineNumber="3683"><Highlight kind="normal">    RegUses.countRegister(BaseReg, LUIdx);</Highlight></CodeLine>
<Link id="l03684" /><CodeLine lineNumber="3684"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03685" /><CodeLine lineNumber="3685"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03686" /><CodeLine lineNumber="3686"><Highlight kind="comment">/// If the given formula has not yet been inserted, add it to the list, and</Highlight></CodeLine>
<Link id="l03687" /><CodeLine lineNumber="3687"><Highlight kind="comment">/// return true. Return false otherwise.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03688" /><CodeLine lineNumber="3688"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> LSRInstance::InsertFormula(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</Highlight></CodeLine>
<Link id="l03689" /><CodeLine lineNumber="3689"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Do not insert formula that we will not be able to expand.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03690" /><CodeLine lineNumber="3690"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l03691" /><CodeLine lineNumber="3691"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Formula is illegal&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l03692" /><CodeLine lineNumber="3692"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03693" /><CodeLine lineNumber="3693"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LU.InsertFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &#42;L))</Highlight></CodeLine>
<Link id="l03694" /><CodeLine lineNumber="3694"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03695" /><CodeLine lineNumber="3695"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03696" /><CodeLine lineNumber="3696"><Highlight kind="normal">  CountRegisters(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, LUIdx);</Highlight></CodeLine>
<Link id="l03697" /><CodeLine lineNumber="3697"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03698" /><CodeLine lineNumber="3698"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03699" /><CodeLine lineNumber="3699"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03700" /><CodeLine lineNumber="3700"><Highlight kind="comment">/// Check for other uses of loop-invariant values which we&#39;re tracking. These</Highlight></CodeLine>
<Link id="l03701" /><CodeLine lineNumber="3701"><Highlight kind="comment">/// other uses will pin these values in registers, making them less profitable</Highlight></CodeLine>
<Link id="l03702" /><CodeLine lineNumber="3702"><Highlight kind="comment">/// for elimination.</Highlight></CodeLine>
<Link id="l03703" /><CodeLine lineNumber="3703"><Highlight kind="comment">/// TODO: This currently misses non-constant addrec step registers.</Highlight></CodeLine>
<Link id="l03704" /><CodeLine lineNumber="3704"><Highlight kind="comment">/// TODO: Should this give more weight to users inside the loop?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03705" /><CodeLine lineNumber="3705"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03706" /><CodeLine lineNumber="3706"><Highlight kind="normal">LSRInstance::CollectLoopInvariantFixupsAndFormulae() &#123;</Highlight></CodeLine>
<Link id="l03707" /><CodeLine lineNumber="3707"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> Worklist(RegUses.begin(), RegUses.end());</Highlight></CodeLine>
<Link id="l03708" /><CodeLine lineNumber="3708"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 32&gt;</a> Visited;</Highlight></CodeLine>
<Link id="l03709" /><CodeLine lineNumber="3709"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03710" /><CodeLine lineNumber="3710"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Don&#39;t collect outside uses if we are favoring postinc - the instructions in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03711" /><CodeLine lineNumber="3711"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the loop are more important than the ones outside of it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03712" /><CodeLine lineNumber="3712"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>)</Highlight></CodeLine>
<Link id="l03713" /><CodeLine lineNumber="3713"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03714" /><CodeLine lineNumber="3714"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03715" /><CodeLine lineNumber="3715"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (!Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</Highlight></CodeLine>
<Link id="l03716" /><CodeLine lineNumber="3716"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = Worklist.<a href="/docs/api/classes/llvm/smallvectorimpl/#a0c8ffe664a36e30d49c84d0aded2fe08">pop&#95;back&#95;val</a>();</Highlight></CodeLine>
<Link id="l03717" /><CodeLine lineNumber="3717"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03718" /><CodeLine lineNumber="3718"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Don&#39;t process the same SCEV twice</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03719" /><CodeLine lineNumber="3719"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Visited.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(S).second)</Highlight></CodeLine>
<Link id="l03720" /><CodeLine lineNumber="3720"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03721" /><CodeLine lineNumber="3721"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03722" /><CodeLine lineNumber="3722"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevnaryexpr">SCEVNAryExpr</a> &#42;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVNAryExpr&gt;</a>(S))</Highlight></CodeLine>
<Link id="l03723" /><CodeLine lineNumber="3723"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a39d3d23a084c4544ee5903203db10e8a">append&#95;range</a>(Worklist, <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;operands());</Highlight></CodeLine>
<Link id="l03724" /><CodeLine lineNumber="3724"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevintegralcastexpr">SCEVIntegralCastExpr</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVIntegralCastExpr&gt;</a>(S))</Highlight></CodeLine>
<Link id="l03725" /><CodeLine lineNumber="3725"><Highlight kind="normal">      Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getOperand());</Highlight></CodeLine>
<Link id="l03726" /><CodeLine lineNumber="3726"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevudivexpr">SCEVUDivExpr</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUDivExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l03727" /><CodeLine lineNumber="3727"><Highlight kind="normal">      Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>-&gt;getLHS());</Highlight></CodeLine>
<Link id="l03728" /><CodeLine lineNumber="3728"><Highlight kind="normal">      Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>-&gt;getRHS());</Highlight></CodeLine>
<Link id="l03729" /><CodeLine lineNumber="3729"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;US = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l03730" /><CodeLine lineNumber="3730"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a> = US-&gt;getValue();</Highlight></CodeLine>
<Link id="l03731" /><CodeLine lineNumber="3731"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(V)) &#123;</Highlight></CodeLine>
<Link id="l03732" /><CodeLine lineNumber="3732"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Look for instructions defined outside the loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03733" /><CodeLine lineNumber="3733"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(Inst)) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03734" /><CodeLine lineNumber="3734"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;Constant&gt;</a>(V))</Highlight></CodeLine>
<Link id="l03735" /><CodeLine lineNumber="3735"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Constants can be re-materialized.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03736" /><CodeLine lineNumber="3736"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03737" /><CodeLine lineNumber="3737"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/use">Use</a> &amp;U : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>-&gt;uses()) &#123;</Highlight></CodeLine>
<Link id="l03738" /><CodeLine lineNumber="3738"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser());</Highlight></CodeLine>
<Link id="l03739" /><CodeLine lineNumber="3739"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Ignore non-instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03740" /><CodeLine lineNumber="3740"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!UserInst)</Highlight></CodeLine>
<Link id="l03741" /><CodeLine lineNumber="3741"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03742" /><CodeLine lineNumber="3742"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Don&#39;t bother if the instruction is an EHPad.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03743" /><CodeLine lineNumber="3743"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UserInst-&gt;<a href="/docs/api/classes/llvm/instruction/#a5d3d315f678bc76e43b27d18e5d72829">isEHPad</a>())</Highlight></CodeLine>
<Link id="l03744" /><CodeLine lineNumber="3744"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03745" /><CodeLine lineNumber="3745"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Ignore instructions in other functions (as can happen with</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03746" /><CodeLine lineNumber="3746"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Constants).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03747" /><CodeLine lineNumber="3747"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UserInst-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;getParent() != <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getParent())</Highlight></CodeLine>
<Link id="l03748" /><CodeLine lineNumber="3748"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03749" /><CodeLine lineNumber="3749"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Ignore instructions not dominated by the loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03750" /><CodeLine lineNumber="3750"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;UseBB = !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(UserInst) ?</Highlight></CodeLine>
<Link id="l03751" /><CodeLine lineNumber="3751"><Highlight kind="normal">          UserInst-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() :</Highlight></CodeLine>
<Link id="l03752" /><CodeLine lineNumber="3752"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(UserInst)-&gt;getIncomingBlock(</Highlight></CodeLine>
<Link id="l03753" /><CodeLine lineNumber="3753"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/phinode/#aca414c43a6d42c13998208463637a20d">PHINode::getIncomingValueNumForOperand</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandNo()));</Highlight></CodeLine>
<Link id="l03754" /><CodeLine lineNumber="3754"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DT.dominates(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader(), UseBB))</Highlight></CodeLine>
<Link id="l03755" /><CodeLine lineNumber="3755"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03756" /><CodeLine lineNumber="3756"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Don&#39;t bother if the instruction is in a BB which ends in an EHPad.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03757" /><CodeLine lineNumber="3757"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UseBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a5d3d315f678bc76e43b27d18e5d72829">isEHPad</a>())</Highlight></CodeLine>
<Link id="l03758" /><CodeLine lineNumber="3758"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03759" /><CodeLine lineNumber="3759"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03760" /><CodeLine lineNumber="3760"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Ignore cases in which the currently-examined value could come from</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03761" /><CodeLine lineNumber="3761"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// a basic block terminated with an EHPad. This checks all incoming</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03762" /><CodeLine lineNumber="3762"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// blocks of the phi node since it is possible that the same incoming</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03763" /><CodeLine lineNumber="3763"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// value comes from multiple basic blocks, only some of which may end</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03764" /><CodeLine lineNumber="3764"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// in an EHPad. If any of them do, a subsequent rewrite attempt by this</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03765" /><CodeLine lineNumber="3765"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// pass would try to insert instructions into an EHPad, hitting an</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03766" /><CodeLine lineNumber="3766"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// assertion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03767" /><CodeLine lineNumber="3767"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(UserInst)) &#123;</Highlight></CodeLine>
<Link id="l03768" /><CodeLine lineNumber="3768"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;PhiNode = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(UserInst);</Highlight></CodeLine>
<Link id="l03769" /><CodeLine lineNumber="3769"><Highlight kind="normal">          </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasIncompatibleEHPTerminatedBlock = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03770" /><CodeLine lineNumber="3770"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;ExpectedValue = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>;</Highlight></CodeLine>
<Link id="l03771" /><CodeLine lineNumber="3771"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; PhiNode-&gt;getNumIncomingValues(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) &#123;</Highlight></CodeLine>
<Link id="l03772" /><CodeLine lineNumber="3772"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PhiNode-&gt;getIncomingValue(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) == ExpectedValue) &#123;</Highlight></CodeLine>
<Link id="l03773" /><CodeLine lineNumber="3773"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PhiNode-&gt;getIncomingBlock(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;getTerminator()-&gt;isEHPad()) &#123;</Highlight></CodeLine>
<Link id="l03774" /><CodeLine lineNumber="3774"><Highlight kind="normal">                HasIncompatibleEHPTerminatedBlock = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03775" /><CodeLine lineNumber="3775"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03776" /><CodeLine lineNumber="3776"><Highlight kind="normal">              &#125;</Highlight></CodeLine>
<Link id="l03777" /><CodeLine lineNumber="3777"><Highlight kind="normal">            &#125;</Highlight></CodeLine>
<Link id="l03778" /><CodeLine lineNumber="3778"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l03779" /><CodeLine lineNumber="3779"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasIncompatibleEHPTerminatedBlock) &#123;</Highlight></CodeLine>
<Link id="l03780" /><CodeLine lineNumber="3780"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03781" /><CodeLine lineNumber="3781"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l03782" /><CodeLine lineNumber="3782"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l03783" /><CodeLine lineNumber="3783"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03784" /><CodeLine lineNumber="3784"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Don&#39;t bother rewriting PHIs in catchswitch blocks.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03785" /><CodeLine lineNumber="3785"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(UserInst-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;getTerminator()))</Highlight></CodeLine>
<Link id="l03786" /><CodeLine lineNumber="3786"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03787" /><CodeLine lineNumber="3787"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Ignore uses which are part of other SCEV expressions, to avoid</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03788" /><CodeLine lineNumber="3788"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// analyzing them multiple times.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03789" /><CodeLine lineNumber="3789"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.isSCEVable(UserInst-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())) &#123;</Highlight></CodeLine>
<Link id="l03790" /><CodeLine lineNumber="3790"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;UserS = SE.getSCEV(</Highlight><Highlight kind="keyword">const&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(UserInst));</Highlight></CodeLine>
<Link id="l03791" /><CodeLine lineNumber="3791"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// If the user is a no-op, look through to its uses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03792" /><CodeLine lineNumber="3792"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(UserS))</Highlight></CodeLine>
<Link id="l03793" /><CodeLine lineNumber="3793"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03794" /><CodeLine lineNumber="3794"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UserS == US) &#123;</Highlight></CodeLine>
<Link id="l03795" /><CodeLine lineNumber="3795"><Highlight kind="normal">            Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</Highlight></CodeLine>
<Link id="l03796" /><CodeLine lineNumber="3796"><Highlight kind="normal">              SE.getUnknown(</Highlight><Highlight kind="keyword">const&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(UserInst)));</Highlight></CodeLine>
<Link id="l03797" /><CodeLine lineNumber="3797"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03798" /><CodeLine lineNumber="3798"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l03799" /><CodeLine lineNumber="3799"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l03800" /><CodeLine lineNumber="3800"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Ignore icmp instructions which are already being analyzed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03801" /><CodeLine lineNumber="3801"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;ICI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ICmpInst&gt;</a>(UserInst)) &#123;</Highlight></CodeLine>
<Link id="l03802" /><CodeLine lineNumber="3802"><Highlight kind="normal">          </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> OtherIdx = !<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandNo();</Highlight></CodeLine>
<Link id="l03803" /><CodeLine lineNumber="3803"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/value">Value</a> &#42;OtherOp = </Highlight><Highlight kind="keyword">const&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(ICI-&gt;getOperand(OtherIdx));</Highlight></CodeLine>
<Link id="l03804" /><CodeLine lineNumber="3804"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.hasComputableLoopEvolution(SE.getSCEV(OtherOp), L))</Highlight></CodeLine>
<Link id="l03805" /><CodeLine lineNumber="3805"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03806" /><CodeLine lineNumber="3806"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l03807" /><CodeLine lineNumber="3807"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03808" /><CodeLine lineNumber="3808"><Highlight kind="normal">        std::pair&lt;size&#95;t, Immediate&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> =</Highlight></CodeLine>
<Link id="l03809" /><CodeLine lineNumber="3809"><Highlight kind="normal">            getUse(S, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a>, MemAccessTy());</Highlight></CodeLine>
<Link id="l03810" /><CodeLine lineNumber="3810"><Highlight kind="normal">        </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first;</Highlight></CodeLine>
<Link id="l03811" /><CodeLine lineNumber="3811"><Highlight kind="normal">        Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second;</Highlight></CodeLine>
<Link id="l03812" /><CodeLine lineNumber="3812"><Highlight kind="normal">        LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l03813" /><CodeLine lineNumber="3813"><Highlight kind="normal">        LSRFixup &amp;LF = LU.getNewFixup();</Highlight></CodeLine>
<Link id="l03814" /><CodeLine lineNumber="3814"><Highlight kind="normal">        LF.UserInst = </Highlight><Highlight kind="keyword">const&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(UserInst);</Highlight></CodeLine>
<Link id="l03815" /><CodeLine lineNumber="3815"><Highlight kind="normal">        LF.OperandValToReplace = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>;</Highlight></CodeLine>
<Link id="l03816" /><CodeLine lineNumber="3816"><Highlight kind="normal">        LF.Offset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</Highlight></CodeLine>
<Link id="l03817" /><CodeLine lineNumber="3817"><Highlight kind="normal">        LU.AllFixupsOutsideLoop &amp;= LF.isUseFullyOutsideLoop(L);</Highlight></CodeLine>
<Link id="l03818" /><CodeLine lineNumber="3818"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LU.WidestFixupType ||</Highlight></CodeLine>
<Link id="l03819" /><CodeLine lineNumber="3819"><Highlight kind="normal">            SE.getTypeSizeInBits(LU.WidestFixupType) &lt;</Highlight></CodeLine>
<Link id="l03820" /><CodeLine lineNumber="3820"><Highlight kind="normal">            SE.getTypeSizeInBits(LF.OperandValToReplace-&gt;getType()))</Highlight></CodeLine>
<Link id="l03821" /><CodeLine lineNumber="3821"><Highlight kind="normal">          LU.WidestFixupType = LF.OperandValToReplace-&gt;getType();</Highlight></CodeLine>
<Link id="l03822" /><CodeLine lineNumber="3822"><Highlight kind="normal">        InsertSupplementalFormula(US, LU, LUIdx);</Highlight></CodeLine>
<Link id="l03823" /><CodeLine lineNumber="3823"><Highlight kind="normal">        CountRegisters(LU.Formulae.back(), <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size() - 1);</Highlight></CodeLine>
<Link id="l03824" /><CodeLine lineNumber="3824"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03825" /><CodeLine lineNumber="3825"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l03826" /><CodeLine lineNumber="3826"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03827" /><CodeLine lineNumber="3827"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03828" /><CodeLine lineNumber="3828"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03829" /><CodeLine lineNumber="3829"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03830" /><CodeLine lineNumber="3830"><Highlight kind="comment">/// Split S into subexpressions which can be pulled out into separate</Highlight></CodeLine>
<Link id="l03831" /><CodeLine lineNumber="3831"><Highlight kind="comment">/// registers. If C is non-null, multiply each subexpression by C.</Highlight></CodeLine>
<Link id="l03832" /><CodeLine lineNumber="3832"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l03833" /><CodeLine lineNumber="3833"><Highlight kind="comment">/// Return remainder expression after factoring the subexpressions captured by</Highlight></CodeLine>
<Link id="l03834" /><CodeLine lineNumber="3834"><Highlight kind="comment">/// Ops. If Ops is complete, return NULL.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03835" /><CodeLine lineNumber="3835" lineLink="#ad0531a07d7868c1577980524cf2add3a"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>,</Highlight></CodeLine>
<Link id="l03836" /><CodeLine lineNumber="3836"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const SCEV &#42;&gt;</a> &amp;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>,</Highlight></CodeLine>
<Link id="l03837" /><CodeLine lineNumber="3837"><Highlight kind="normal">                                   </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L,</Highlight></CodeLine>
<Link id="l03838" /><CodeLine lineNumber="3838"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</Highlight></CodeLine>
<Link id="l03839" /><CodeLine lineNumber="3839"><Highlight kind="normal">                                   </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> = 0) &#123;</Highlight></CodeLine>
<Link id="l03840" /><CodeLine lineNumber="3840"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Arbitrarily cap recursion to protect compile time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03841" /><CodeLine lineNumber="3841"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> &gt;= 3)</Highlight></CodeLine>
<Link id="l03842" /><CodeLine lineNumber="3842"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> S;</Highlight></CodeLine>
<Link id="l03843" /><CodeLine lineNumber="3843"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03844" /><CodeLine lineNumber="3844"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l03845" /><CodeLine lineNumber="3845"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Break out add operands.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03846" /><CodeLine lineNumber="3846"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands()) &#123;</Highlight></CodeLine>
<Link id="l03847" /><CodeLine lineNumber="3847"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder = <a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(S, <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>, L, SE, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>+1);</Highlight></CodeLine>
<Link id="l03848" /><CodeLine lineNumber="3848"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Remainder)</Highlight></CodeLine>
<Link id="l03849" /><CodeLine lineNumber="3849"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> ? SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, Remainder) : Remainder);</Highlight></CodeLine>
<Link id="l03850" /><CodeLine lineNumber="3850"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03851" /><CodeLine lineNumber="3851"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03852" /><CodeLine lineNumber="3852"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l03853" /><CodeLine lineNumber="3853"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Split a non-zero base out of an addrec.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03854" /><CodeLine lineNumber="3854"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>()-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>() || !AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>())</Highlight></CodeLine>
<Link id="l03855" /><CodeLine lineNumber="3855"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> S;</Highlight></CodeLine>
<Link id="l03856" /><CodeLine lineNumber="3856"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03857" /><CodeLine lineNumber="3857"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder = <a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>(),</Highlight></CodeLine>
<Link id="l03858" /><CodeLine lineNumber="3858"><Highlight kind="normal">                                            <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>, L, SE, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>+1);</Highlight></CodeLine>
<Link id="l03859" /><CodeLine lineNumber="3859"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Split the non-zero AddRec unless it is part of a nested recurrence that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03860" /><CodeLine lineNumber="3860"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// does not pertain to this loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03861" /><CodeLine lineNumber="3861"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Remainder &amp;&amp; (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L || !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(Remainder))) &#123;</Highlight></CodeLine>
<Link id="l03862" /><CodeLine lineNumber="3862"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> ? SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, Remainder) : Remainder);</Highlight></CodeLine>
<Link id="l03863" /><CodeLine lineNumber="3863"><Highlight kind="normal">      Remainder = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03864" /><CodeLine lineNumber="3864"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03865" /><CodeLine lineNumber="3865"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Remainder != AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>()) &#123;</Highlight></CodeLine>
<Link id="l03866" /><CodeLine lineNumber="3866"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Remainder)</Highlight></CodeLine>
<Link id="l03867" /><CodeLine lineNumber="3867"><Highlight kind="normal">        Remainder = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>(), 0);</Highlight></CodeLine>
<Link id="l03868" /><CodeLine lineNumber="3868"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(Remainder,</Highlight></CodeLine>
<Link id="l03869" /><CodeLine lineNumber="3869"><Highlight kind="normal">                              AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE),</Highlight></CodeLine>
<Link id="l03870" /><CodeLine lineNumber="3870"><Highlight kind="normal">                              AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>(),</Highlight></CodeLine>
<Link id="l03871" /><CodeLine lineNumber="3871"><Highlight kind="normal">                              </Highlight><Highlight kind="comment">//FIXME: AR-&gt;getNoWrapFlags(SCEV::FlagNW)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03872" /><CodeLine lineNumber="3872"><Highlight kind="normal">                              <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>);</Highlight></CodeLine>
<Link id="l03873" /><CodeLine lineNumber="3873"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03874" /><CodeLine lineNumber="3874"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l03875" /><CodeLine lineNumber="3875"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Break (C &#42; (a + b + c)) into C&#42;a + C&#42;b + C&#42;c.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03876" /><CodeLine lineNumber="3876"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getNumOperands() != 2)</Highlight></CodeLine>
<Link id="l03877" /><CodeLine lineNumber="3877"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> S;</Highlight></CodeLine>
<Link id="l03878" /><CodeLine lineNumber="3878"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;Op0 =</Highlight></CodeLine>
<Link id="l03879" /><CodeLine lineNumber="3879"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(0))) &#123;</Highlight></CodeLine>
<Link id="l03880" /><CodeLine lineNumber="3880"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> ? <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVConstant&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, Op0)) : Op0;</Highlight></CodeLine>
<Link id="l03881" /><CodeLine lineNumber="3881"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder =</Highlight></CodeLine>
<Link id="l03882" /><CodeLine lineNumber="3882"><Highlight kind="normal">        <a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(1), <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>, L, SE, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>+1);</Highlight></CodeLine>
<Link id="l03883" /><CodeLine lineNumber="3883"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Remainder)</Highlight></CodeLine>
<Link id="l03884" /><CodeLine lineNumber="3884"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, Remainder));</Highlight></CodeLine>
<Link id="l03885" /><CodeLine lineNumber="3885"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03886" /><CodeLine lineNumber="3886"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l03887" /><CodeLine lineNumber="3887"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03888" /><CodeLine lineNumber="3888"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> S;</Highlight></CodeLine>
<Link id="l03889" /><CodeLine lineNumber="3889"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03890" /><CodeLine lineNumber="3890"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03891" /><CodeLine lineNumber="3891"><Highlight kind="comment">/// Return true if the SCEV represents a value that may end up as a</Highlight></CodeLine>
<Link id="l03892" /><CodeLine lineNumber="3892"><Highlight kind="comment">/// post-increment operation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03893" /><CodeLine lineNumber="3893" lineLink="#a187751c86d349fac41ddc1b807b40b22"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a187751c86d349fac41ddc1b807b40b22">mayUsePostIncMode</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l03894" /><CodeLine lineNumber="3894"><Highlight kind="normal">                              LSRUse &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L,</Highlight></CodeLine>
<Link id="l03895" /><CodeLine lineNumber="3895"><Highlight kind="normal">                              <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l03896" /><CodeLine lineNumber="3896"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> ||</Highlight></CodeLine>
<Link id="l03897" /><CodeLine lineNumber="3897"><Highlight kind="normal">      !LU.AccessTy.getType()-&gt;isIntOrIntVectorTy())</Highlight></CodeLine>
<Link id="l03898" /><CodeLine lineNumber="3898"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03899" /><CodeLine lineNumber="3899"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S);</Highlight></CodeLine>
<Link id="l03900" /><CodeLine lineNumber="3900"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AR)</Highlight></CodeLine>
<Link id="l03901" /><CodeLine lineNumber="3901"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03902" /><CodeLine lineNumber="3902"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LoopStep = AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE);</Highlight></CodeLine>
<Link id="l03903" /><CodeLine lineNumber="3903"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(LoopStep))</Highlight></CodeLine>
<Link id="l03904" /><CodeLine lineNumber="3904"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03905" /><CodeLine lineNumber="3905"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check if a post-indexed load/store can be used.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03906" /><CodeLine lineNumber="3906"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedLoadLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>()) ||</Highlight></CodeLine>
<Link id="l03907" /><CodeLine lineNumber="3907"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedStoreLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>())) &#123;</Highlight></CodeLine>
<Link id="l03908" /><CodeLine lineNumber="3908"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LoopStart = AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>();</Highlight></CodeLine>
<Link id="l03909" /><CodeLine lineNumber="3909"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(LoopStart) &amp;&amp; SE.<a href="/docs/api/classes/llvm/scalarevolution/#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(LoopStart, L))</Highlight></CodeLine>
<Link id="l03910" /><CodeLine lineNumber="3910"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03911" /><CodeLine lineNumber="3911"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l03912" /><CodeLine lineNumber="3912"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03913" /><CodeLine lineNumber="3913"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l03914" /><CodeLine lineNumber="3914"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l03915" /><CodeLine lineNumber="3915"><Highlight kind="comment">/// Helper function for LSRInstance::GenerateReassociations.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03916" /><CodeLine lineNumber="3916"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateReassociationsImpl(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l03917" /><CodeLine lineNumber="3917"><Highlight kind="normal">                                             </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l03918" /><CodeLine lineNumber="3918"><Highlight kind="normal">                                             </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> Idx,</Highlight></CodeLine>
<Link id="l03919" /><CodeLine lineNumber="3919"><Highlight kind="normal">                                             </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsScaledReg) &#123;</Highlight></CodeLine>
<Link id="l03920" /><CodeLine lineNumber="3920"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg = IsScaledReg ? <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;Idx&#93;;</Highlight></CodeLine>
<Link id="l03921" /><CodeLine lineNumber="3921"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Don&#39;t generate reassociations for the base register of a value that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03922" /><CodeLine lineNumber="3922"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// may generate a post-increment operator. The reason is that the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03923" /><CodeLine lineNumber="3923"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// reassociations cause extra base+register formula to be created,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03924" /><CodeLine lineNumber="3924"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// and possibly chosen, but the post-increment is more efficient.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03925" /><CodeLine lineNumber="3925"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a> &amp;&amp; <a href="#a187751c86d349fac41ddc1b807b40b22">mayUsePostIncMode</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU, BaseReg, L, SE))</Highlight></CodeLine>
<Link id="l03926" /><CodeLine lineNumber="3926"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03927" /><CodeLine lineNumber="3927"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> AddOps;</Highlight></CodeLine>
<Link id="l03928" /><CodeLine lineNumber="3928"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder = <a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(BaseReg, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, AddOps, L, SE);</Highlight></CodeLine>
<Link id="l03929" /><CodeLine lineNumber="3929"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Remainder)</Highlight></CodeLine>
<Link id="l03930" /><CodeLine lineNumber="3930"><Highlight kind="normal">    AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Remainder);</Highlight></CodeLine>
<Link id="l03931" /><CodeLine lineNumber="3931"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03932" /><CodeLine lineNumber="3932"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == 1)</Highlight></CodeLine>
<Link id="l03933" /><CodeLine lineNumber="3933"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03934" /><CodeLine lineNumber="3934"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03935" /><CodeLine lineNumber="3935"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/smallvectorimpl/#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;const SCEV &#42;&gt;::const&#95;iterator</a> J = AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(),</Highlight></CodeLine>
<Link id="l03936" /><CodeLine lineNumber="3936"><Highlight kind="normal">                                                     JE = AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>();</Highlight></CodeLine>
<Link id="l03937" /><CodeLine lineNumber="3937"><Highlight kind="normal">       J != JE; ++J) &#123;</Highlight></CodeLine>
<Link id="l03938" /><CodeLine lineNumber="3938"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Loop-variant &quot;unknown&quot; values are uninteresting; we won&#39;t be able to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03939" /><CodeLine lineNumber="3939"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// do anything meaningful with them.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03940" /><CodeLine lineNumber="3940"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(&#42;J) &amp;&amp; !SE.isLoopInvariant(&#42;J, L))</Highlight></CodeLine>
<Link id="l03941" /><CodeLine lineNumber="3941"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03942" /><CodeLine lineNumber="3942"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03943" /><CodeLine lineNumber="3943"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Don&#39;t pull a constant into a register if the constant could be folded</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03944" /><CodeLine lineNumber="3944"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// into an immediate field.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03945" /><CodeLine lineNumber="3945"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, SE, LU.MinOffset, LU.MaxOffset, LU.Kind,</Highlight></CodeLine>
<Link id="l03946" /><CodeLine lineNumber="3946"><Highlight kind="normal">                         LU.AccessTy, &#42;J, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getNumRegs() &gt; 1))</Highlight></CodeLine>
<Link id="l03947" /><CodeLine lineNumber="3947"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03948" /><CodeLine lineNumber="3948"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03949" /><CodeLine lineNumber="3949"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Collect all operands except &#42;J.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03950" /><CodeLine lineNumber="3950"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> InnerAddOps(</Highlight></CodeLine>
<Link id="l03951" /><CodeLine lineNumber="3951"><Highlight kind="normal">        ((</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> &amp;)AddOps).<a href="/docs/api/namespaces/llvm/sandboxir/#a2fdb10193ae65fe59b4d8df288044864">begin</a>(), J);</Highlight></CodeLine>
<Link id="l03952" /><CodeLine lineNumber="3952"><Highlight kind="normal">    InnerAddOps.append(std::next(J),</Highlight></CodeLine>
<Link id="l03953" /><CodeLine lineNumber="3953"><Highlight kind="normal">                       ((</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> &amp;)AddOps).<a href="/docs/api/namespaces/llvm/sandboxir/#a64ac61287490361f2183faf1d7639ee9">end</a>());</Highlight></CodeLine>
<Link id="l03954" /><CodeLine lineNumber="3954"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03955" /><CodeLine lineNumber="3955"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Don&#39;t leave just a constant behind in a register if the constant could</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03956" /><CodeLine lineNumber="3956"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// be folded into an immediate field.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03957" /><CodeLine lineNumber="3957"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (InnerAddOps.size() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l03958" /><CodeLine lineNumber="3958"><Highlight kind="normal">        <a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, SE, LU.MinOffset, LU.MaxOffset, LU.Kind,</Highlight></CodeLine>
<Link id="l03959" /><CodeLine lineNumber="3959"><Highlight kind="normal">                         LU.AccessTy, InnerAddOps&#91;0&#93;, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getNumRegs() &gt; 1))</Highlight></CodeLine>
<Link id="l03960" /><CodeLine lineNumber="3960"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03961" /><CodeLine lineNumber="3961"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03962" /><CodeLine lineNumber="3962"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;InnerSum = SE.getAddExpr(InnerAddOps);</Highlight></CodeLine>
<Link id="l03963" /><CodeLine lineNumber="3963"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (InnerSum-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</Highlight></CodeLine>
<Link id="l03964" /><CodeLine lineNumber="3964"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03965" /><CodeLine lineNumber="3965"><Highlight kind="normal">    Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</Highlight></CodeLine>
<Link id="l03966" /><CodeLine lineNumber="3966"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03967" /><CodeLine lineNumber="3967"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isNonZero() &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isScalable())</Highlight></CodeLine>
<Link id="l03968" /><CodeLine lineNumber="3968"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03969" /><CodeLine lineNumber="3969"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03970" /><CodeLine lineNumber="3970"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add the remaining pieces of the add back into the new formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03971" /><CodeLine lineNumber="3971"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;InnerSumSC = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(InnerSum);</Highlight></CodeLine>
<Link id="l03972" /><CodeLine lineNumber="3972"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (InnerSumSC &amp;&amp; SE.getTypeSizeInBits(InnerSumSC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a35e59d0864faf0a0ccb63421a8f60183">getType</a>()) &lt;= 64 &amp;&amp;</Highlight></CodeLine>
<Link id="l03973" /><CodeLine lineNumber="3973"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddImmediate((uint64&#95;t)<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() +</Highlight></CodeLine>
<Link id="l03974" /><CodeLine lineNumber="3974"><Highlight kind="normal">                                InnerSumSC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a476a7aca5d55536fcbfb498dfe5d380d">getValue</a>()-&gt;<a href="/docs/api/classes/llvm/constantint/#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>())) &#123;</Highlight></CodeLine>
<Link id="l03975" /><CodeLine lineNumber="3975"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset =</Highlight></CodeLine>
<Link id="l03976" /><CodeLine lineNumber="3976"><Highlight kind="normal">          <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>((uint64&#95;t)<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() +</Highlight></CodeLine>
<Link id="l03977" /><CodeLine lineNumber="3977"><Highlight kind="normal">                              InnerSumSC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a476a7aca5d55536fcbfb498dfe5d380d">getValue</a>()-&gt;<a href="/docs/api/classes/llvm/constantint/#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>());</Highlight></CodeLine>
<Link id="l03978" /><CodeLine lineNumber="3978"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsScaledReg) &#123;</Highlight></CodeLine>
<Link id="l03979" /><CodeLine lineNumber="3979"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l03980" /><CodeLine lineNumber="3980"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale = 0;</Highlight></CodeLine>
<Link id="l03981" /><CodeLine lineNumber="3981"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03982" /><CodeLine lineNumber="3982"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.erase(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin() + Idx);</Highlight></CodeLine>
<Link id="l03983" /><CodeLine lineNumber="3983"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsScaledReg)</Highlight></CodeLine>
<Link id="l03984" /><CodeLine lineNumber="3984"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = InnerSum;</Highlight></CodeLine>
<Link id="l03985" /><CodeLine lineNumber="3985"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03986" /><CodeLine lineNumber="3986"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93; = InnerSum;</Highlight></CodeLine>
<Link id="l03987" /><CodeLine lineNumber="3987"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03988" /><CodeLine lineNumber="3988"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Add J as its own register, or an unfolded immediate.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03989" /><CodeLine lineNumber="3989"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/ppcisd/#ad1c32e5bb1cb213fb836bc3d221e4f19a2ae057e4de45c51c89b7e5dc5053df62">SC</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(&#42;J);</Highlight></CodeLine>
<Link id="l03990" /><CodeLine lineNumber="3990"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SC &amp;&amp; SE.getTypeSizeInBits(<a href="/docs/api/namespaces/llvm/ppcisd/#ad1c32e5bb1cb213fb836bc3d221e4f19a2ae057e4de45c51c89b7e5dc5053df62">SC</a>-&gt;getType()) &lt;= 64 &amp;&amp;</Highlight></CodeLine>
<Link id="l03991" /><CodeLine lineNumber="3991"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddImmediate((uint64&#95;t)<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() +</Highlight></CodeLine>
<Link id="l03992" /><CodeLine lineNumber="3992"><Highlight kind="normal">                                <a href="/docs/api/namespaces/llvm/ppcisd/#ad1c32e5bb1cb213fb836bc3d221e4f19a2ae057e4de45c51c89b7e5dc5053df62">SC</a>-&gt;getValue()-&gt;getZExtValue()))</Highlight></CodeLine>
<Link id="l03993" /><CodeLine lineNumber="3993"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset =</Highlight></CodeLine>
<Link id="l03994" /><CodeLine lineNumber="3994"><Highlight kind="normal">          <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>((uint64&#95;t)<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() +</Highlight></CodeLine>
<Link id="l03995" /><CodeLine lineNumber="3995"><Highlight kind="normal">                              <a href="/docs/api/namespaces/llvm/ppcisd/#ad1c32e5bb1cb213fb836bc3d221e4f19a2ae057e4de45c51c89b7e5dc5053df62">SC</a>-&gt;getValue()-&gt;getZExtValue());</Highlight></CodeLine>
<Link id="l03996" /><CodeLine lineNumber="3996"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03997" /><CodeLine lineNumber="3997"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.push&#95;back(&#42;J);</Highlight></CodeLine>
<Link id="l03998" /><CodeLine lineNumber="3998"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// We may have changed the number of register in base regs, adjust the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l03999" /><CodeLine lineNumber="3999"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// formula accordingly.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04000" /><CodeLine lineNumber="4000"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</Highlight></CodeLine>
<Link id="l04001" /><CodeLine lineNumber="4001"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04002" /><CodeLine lineNumber="4002"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</Highlight></CodeLine>
<Link id="l04003" /><CodeLine lineNumber="4003"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If that formula hadn&#39;t been seen before, recurse to find more like</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04004" /><CodeLine lineNumber="4004"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04005" /><CodeLine lineNumber="4005"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Add check on Log16(AddOps.size()) - same as Log2&#95;32(AddOps.size()) &gt;&gt; 2)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04006" /><CodeLine lineNumber="4006"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Because just Depth is not enough to bound compile time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04007" /><CodeLine lineNumber="4007"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// This means that every time AddOps.size() is greater 16^x we will add</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04008" /><CodeLine lineNumber="4008"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// x to Depth.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04009" /><CodeLine lineNumber="4009"><Highlight kind="normal">      GenerateReassociations(LU, LUIdx, LU.Formulae.back(),</Highlight></CodeLine>
<Link id="l04010" /><CodeLine lineNumber="4010"><Highlight kind="normal">                             <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> + 1 + (<a href="/docs/api/namespaces/llvm/#a646986783f35e0fef8988f0f28d2589f">Log2&#95;32</a>(AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>()) &gt;&gt; 2));</Highlight></CodeLine>
<Link id="l04011" /><CodeLine lineNumber="4011"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04012" /><CodeLine lineNumber="4012"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04013" /><CodeLine lineNumber="4013"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04014" /><CodeLine lineNumber="4014"><Highlight kind="comment">/// Split out subexpressions from adds and the bases of addrecs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04015" /><CodeLine lineNumber="4015"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateReassociations(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l04016" /><CodeLine lineNumber="4016"><Highlight kind="normal">                                         Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>) &#123;</Highlight></CodeLine>
<Link id="l04017" /><CodeLine lineNumber="4017"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.isCanonical(&#42;L) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Input must be in the canonical form&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04018" /><CodeLine lineNumber="4018"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Arbitrarily cap recursion to protect compile time.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04019" /><CodeLine lineNumber="4019"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> &gt;= 3)</Highlight></CodeLine>
<Link id="l04020" /><CodeLine lineNumber="4020"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04021" /><CodeLine lineNumber="4021"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04022" /><CodeLine lineNumber="4022"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size(); i != e; ++i)</Highlight></CodeLine>
<Link id="l04023" /><CodeLine lineNumber="4023"><Highlight kind="normal">    GenerateReassociationsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>, i);</Highlight></CodeLine>
<Link id="l04024" /><CodeLine lineNumber="4024"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04025" /><CodeLine lineNumber="4025"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 1)</Highlight></CodeLine>
<Link id="l04026" /><CodeLine lineNumber="4026"><Highlight kind="normal">    GenerateReassociationsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>,</Highlight></CodeLine>
<Link id="l04027" /><CodeLine lineNumber="4027"><Highlight kind="normal">                               </Highlight><Highlight kind="comment">/&#42; Idx &#42;/</Highlight><Highlight kind="normal"> -1, </Highlight><Highlight kind="comment">/&#42; IsScaledReg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04028" /><CodeLine lineNumber="4028"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04029" /><CodeLine lineNumber="4029"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04030" /><CodeLine lineNumber="4030"><Highlight kind="comment">///  Generate a formula consisting of all of the loop-dominating registers added</Highlight></CodeLine>
<Link id="l04031" /><CodeLine lineNumber="4031"><Highlight kind="comment">/// into a single register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04032" /><CodeLine lineNumber="4032"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateCombinations(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l04033" /><CodeLine lineNumber="4033"><Highlight kind="normal">                                       Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</Highlight></CodeLine>
<Link id="l04034" /><CodeLine lineNumber="4034"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This method is only interesting on a plurality of registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04035" /><CodeLine lineNumber="4035"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size() + (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 1) +</Highlight></CodeLine>
<Link id="l04036" /><CodeLine lineNumber="4036"><Highlight kind="normal">          (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.UnfoldedOffset.isNonZero()) &lt;=</Highlight></CodeLine>
<Link id="l04037" /><CodeLine lineNumber="4037"><Highlight kind="normal">      1)</Highlight></CodeLine>
<Link id="l04038" /><CodeLine lineNumber="4038"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04039" /><CodeLine lineNumber="4039"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04040" /><CodeLine lineNumber="4040"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Flatten the representation, i.e., reg1 + 1&#42;reg2 =&gt; reg1 + reg2, before</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04041" /><CodeLine lineNumber="4041"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// processing the formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04042" /><CodeLine lineNumber="4042"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.unscale();</Highlight></CodeLine>
<Link id="l04043" /><CodeLine lineNumber="4043"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</Highlight></CodeLine>
<Link id="l04044" /><CodeLine lineNumber="4044"><Highlight kind="normal">  Formula NewBase = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</Highlight></CodeLine>
<Link id="l04045" /><CodeLine lineNumber="4045"><Highlight kind="normal">  NewBase.BaseRegs.clear();</Highlight></CodeLine>
<Link id="l04046" /><CodeLine lineNumber="4046"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;CombinedIntegerType = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04047" /><CodeLine lineNumber="4047"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs) &#123;</Highlight></CodeLine>
<Link id="l04048" /><CodeLine lineNumber="4048"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.properlyDominates(BaseReg, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()) &amp;&amp;</Highlight></CodeLine>
<Link id="l04049" /><CodeLine lineNumber="4049"><Highlight kind="normal">        !SE.hasComputableLoopEvolution(BaseReg, L)) &#123;</Highlight></CodeLine>
<Link id="l04050" /><CodeLine lineNumber="4050"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!CombinedIntegerType)</Highlight></CodeLine>
<Link id="l04051" /><CodeLine lineNumber="4051"><Highlight kind="normal">        CombinedIntegerType = SE.getEffectiveSCEVType(BaseReg-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>());</Highlight></CodeLine>
<Link id="l04052" /><CodeLine lineNumber="4052"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(BaseReg);</Highlight></CodeLine>
<Link id="l04053" /><CodeLine lineNumber="4053"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04054" /><CodeLine lineNumber="4054"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04055" /><CodeLine lineNumber="4055"><Highlight kind="normal">      NewBase.BaseRegs.push&#95;back(BaseReg);</Highlight></CodeLine>
<Link id="l04056" /><CodeLine lineNumber="4056"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04057" /><CodeLine lineNumber="4057"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04058" /><CodeLine lineNumber="4058"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If no register is relevant, we&#39;re done.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04059" /><CodeLine lineNumber="4059"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.size() == 0)</Highlight></CodeLine>
<Link id="l04060" /><CodeLine lineNumber="4060"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04061" /><CodeLine lineNumber="4061"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04062" /><CodeLine lineNumber="4062"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Utility function for generating the required variants of the combined</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04063" /><CodeLine lineNumber="4063"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04064" /><CodeLine lineNumber="4064"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> GenerateFormula = &#91;&amp;&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Sum) &#123;</Highlight></CodeLine>
<Link id="l04065" /><CodeLine lineNumber="4065"><Highlight kind="normal">    Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = NewBase;</Highlight></CodeLine>
<Link id="l04066" /><CodeLine lineNumber="4066"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04067" /><CodeLine lineNumber="4067"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: If Sum is zero, it probably means ScalarEvolution missed an</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04068" /><CodeLine lineNumber="4068"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// opportunity to fold something. For now, just ignore such cases</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04069" /><CodeLine lineNumber="4069"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// rather than proceed with zero in a register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04070" /><CodeLine lineNumber="4070"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Sum-&gt;isZero())</Highlight></CodeLine>
<Link id="l04071" /><CodeLine lineNumber="4071"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04072" /><CodeLine lineNumber="4072"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04073" /><CodeLine lineNumber="4073"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.push&#95;back(Sum);</Highlight></CodeLine>
<Link id="l04074" /><CodeLine lineNumber="4074"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</Highlight></CodeLine>
<Link id="l04075" /><CodeLine lineNumber="4075"><Highlight kind="normal">    (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04076" /><CodeLine lineNumber="4076"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l04077" /><CodeLine lineNumber="4077"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04078" /><CodeLine lineNumber="4078"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we collected at least two registers, generate a formula combining them.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04079" /><CodeLine lineNumber="4079"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.size() &gt; 1) &#123;</Highlight></CodeLine>
<Link id="l04080" /><CodeLine lineNumber="4080"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> OpsCopy(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>); </Highlight><Highlight kind="comment">// Don&#39;t let SE modify Ops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04081" /><CodeLine lineNumber="4081"><Highlight kind="normal">    GenerateFormula(SE.getAddExpr(OpsCopy));</Highlight></CodeLine>
<Link id="l04082" /><CodeLine lineNumber="4082"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04083" /><CodeLine lineNumber="4083"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04084" /><CodeLine lineNumber="4084"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If we have an unfolded offset, generate a formula combining it with the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04085" /><CodeLine lineNumber="4085"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// registers collected.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04086" /><CodeLine lineNumber="4086"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NewBase.UnfoldedOffset.isNonZero() &amp;&amp; NewBase.UnfoldedOffset.isFixed()) &#123;</Highlight></CodeLine>
<Link id="l04087" /><CodeLine lineNumber="4087"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CombinedIntegerType &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Missing a type for the unfolded offset&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04088" /><CodeLine lineNumber="4088"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getConstant(CombinedIntegerType,</Highlight></CodeLine>
<Link id="l04089" /><CodeLine lineNumber="4089"><Highlight kind="normal">                                 NewBase.UnfoldedOffset.getFixedValue(), </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l04090" /><CodeLine lineNumber="4090"><Highlight kind="normal">    NewBase.UnfoldedOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(0);</Highlight></CodeLine>
<Link id="l04091" /><CodeLine lineNumber="4091"><Highlight kind="normal">    GenerateFormula(SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</Highlight></CodeLine>
<Link id="l04092" /><CodeLine lineNumber="4092"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04093" /><CodeLine lineNumber="4093"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04094" /><CodeLine lineNumber="4094"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04095" /><CodeLine lineNumber="4095"><Highlight kind="comment">/// Helper function for LSRInstance::GenerateSymbolicOffsets.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04096" /><CodeLine lineNumber="4096"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateSymbolicOffsetsImpl(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l04097" /><CodeLine lineNumber="4097"><Highlight kind="normal">                                              </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> Idx,</Highlight></CodeLine>
<Link id="l04098" /><CodeLine lineNumber="4098"><Highlight kind="normal">                                              </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsScaledReg) &#123;</Highlight></CodeLine>
<Link id="l04099" /><CodeLine lineNumber="4099"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a> = IsScaledReg ? <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;Idx&#93;;</Highlight></CodeLine>
<Link id="l04100" /><CodeLine lineNumber="4100"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;GV = <a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, SE);</Highlight></CodeLine>
<Link id="l04101" /><CodeLine lineNumber="4101"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;isZero() || !GV)</Highlight></CodeLine>
<Link id="l04102" /><CodeLine lineNumber="4102"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04103" /><CodeLine lineNumber="4103"><Highlight kind="normal">  Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</Highlight></CodeLine>
<Link id="l04104" /><CodeLine lineNumber="4104"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV = GV;</Highlight></CodeLine>
<Link id="l04105" /><CodeLine lineNumber="4105"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</Highlight></CodeLine>
<Link id="l04106" /><CodeLine lineNumber="4106"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04107" /><CodeLine lineNumber="4107"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsScaledReg)</Highlight></CodeLine>
<Link id="l04108" /><CodeLine lineNumber="4108"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>;</Highlight></CodeLine>
<Link id="l04109" /><CodeLine lineNumber="4109"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04110" /><CodeLine lineNumber="4110"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93; = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>;</Highlight></CodeLine>
<Link id="l04111" /><CodeLine lineNumber="4111"><Highlight kind="normal">  (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04112" /><CodeLine lineNumber="4112"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04113" /><CodeLine lineNumber="4113"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04114" /><CodeLine lineNumber="4114"><Highlight kind="comment">/// Generate reuse formulae using symbolic offsets.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04115" /><CodeLine lineNumber="4115"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateSymbolicOffsets(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l04116" /><CodeLine lineNumber="4116"><Highlight kind="normal">                                          Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</Highlight></CodeLine>
<Link id="l04117" /><CodeLine lineNumber="4117"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We can&#39;t add a symbolic offset if the address already contains one.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04118" /><CodeLine lineNumber="4118"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseGV) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04119" /><CodeLine lineNumber="4119"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04120" /><CodeLine lineNumber="4120"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size(); i != e; ++i)</Highlight></CodeLine>
<Link id="l04121" /><CodeLine lineNumber="4121"><Highlight kind="normal">    GenerateSymbolicOffsetsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, i);</Highlight></CodeLine>
<Link id="l04122" /><CodeLine lineNumber="4122"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 1)</Highlight></CodeLine>
<Link id="l04123" /><CodeLine lineNumber="4123"><Highlight kind="normal">    GenerateSymbolicOffsetsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </Highlight><Highlight kind="comment">/&#42; Idx &#42;/</Highlight><Highlight kind="normal"> -1,</Highlight></CodeLine>
<Link id="l04124" /><CodeLine lineNumber="4124"><Highlight kind="normal">                                </Highlight><Highlight kind="comment">/&#42; IsScaledReg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04125" /><CodeLine lineNumber="4125"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04126" /><CodeLine lineNumber="4126"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04127" /><CodeLine lineNumber="4127"><Highlight kind="comment">/// Helper function for LSRInstance::GenerateConstantOffsets.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04128" /><CodeLine lineNumber="4128"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateConstantOffsetsImpl(</Highlight></CodeLine>
<Link id="l04129" /><CodeLine lineNumber="4129"><Highlight kind="normal">    LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</Highlight></CodeLine>
<Link id="l04130" /><CodeLine lineNumber="4130"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Immediate&gt;</a> &amp;Worklist, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> Idx, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsScaledReg) &#123;</Highlight></CodeLine>
<Link id="l04131" /><CodeLine lineNumber="4131"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04132" /><CodeLine lineNumber="4132"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> GenerateOffset = &#91;&amp;&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &#123;</Highlight></CodeLine>
<Link id="l04133" /><CodeLine lineNumber="4133"><Highlight kind="normal">    Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</Highlight></CodeLine>
<Link id="l04134" /><CodeLine lineNumber="4134"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isCompatibleImmediate(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>))</Highlight></CodeLine>
<Link id="l04135" /><CodeLine lineNumber="4135"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04136" /><CodeLine lineNumber="4136"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.subUnsigned(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</Highlight></CodeLine>
<Link id="l04137" /><CodeLine lineNumber="4137"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04138" /><CodeLine lineNumber="4138"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) &#123;</Highlight></CodeLine>
<Link id="l04139" /><CodeLine lineNumber="4139"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Add the offset to the base register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04140" /><CodeLine lineNumber="4140"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewOffset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getSCEV(SE, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;getType());</Highlight></CodeLine>
<Link id="l04141" /><CodeLine lineNumber="4141"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewG = SE.getAddExpr(NewOffset, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>);</Highlight></CodeLine>
<Link id="l04142" /><CodeLine lineNumber="4142"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If it cancelled out, drop the base register, otherwise update it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04143" /><CodeLine lineNumber="4143"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NewG-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</Highlight></CodeLine>
<Link id="l04144" /><CodeLine lineNumber="4144"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsScaledReg) &#123;</Highlight></CodeLine>
<Link id="l04145" /><CodeLine lineNumber="4145"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale = 0;</Highlight></CodeLine>
<Link id="l04146" /><CodeLine lineNumber="4146"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04147" /><CodeLine lineNumber="4147"><Highlight kind="normal">        &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04148" /><CodeLine lineNumber="4148"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.deleteBaseReg(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93;);</Highlight></CodeLine>
<Link id="l04149" /><CodeLine lineNumber="4149"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</Highlight></CodeLine>
<Link id="l04150" /><CodeLine lineNumber="4150"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsScaledReg)</Highlight></CodeLine>
<Link id="l04151" /><CodeLine lineNumber="4151"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = NewG;</Highlight></CodeLine>
<Link id="l04152" /><CodeLine lineNumber="4152"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04153" /><CodeLine lineNumber="4153"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93; = NewG;</Highlight></CodeLine>
<Link id="l04154" /><CodeLine lineNumber="4154"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04155" /><CodeLine lineNumber="4155"><Highlight kind="normal">      (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04156" /><CodeLine lineNumber="4156"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04157" /><CodeLine lineNumber="4157"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l04158" /><CodeLine lineNumber="4158"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04159" /><CodeLine lineNumber="4159"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a> = IsScaledReg ? <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;Idx&#93;;</Highlight></CodeLine>
<Link id="l04160" /><CodeLine lineNumber="4160"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04161" /><CodeLine lineNumber="4161"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// With constant offsets and constant steps, we can generate pre-inc</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04162" /><CodeLine lineNumber="4162"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// accesses by having the offset equal the step. So, for access #0 with a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04163" /><CodeLine lineNumber="4163"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// step of 8, we generate a G - 8 base which would require the first access</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04164" /><CodeLine lineNumber="4164"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to be ((G - 8) + 8),+,8. The pre-indexed access then updates the pointer</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04165" /><CodeLine lineNumber="4165"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// for itself and hopefully becomes the base for other accesses. This means</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04166" /><CodeLine lineNumber="4166"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// means that a single pre-indexed access can be generated to become the new</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04167" /><CodeLine lineNumber="4167"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// base pointer for each iteration of the loop, resulting in no extra add/sub</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04168" /><CodeLine lineNumber="4168"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// instructions for pointer updating.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04169" /><CodeLine lineNumber="4169"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a7cb26b7792c751612e634c36dce16f9a">TTI::AMK&#95;PreIndexed</a> &amp;&amp; LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>) &#123;</Highlight></CodeLine>
<Link id="l04170" /><CodeLine lineNumber="4170"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;GAR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>)) &#123;</Highlight></CodeLine>
<Link id="l04171" /><CodeLine lineNumber="4171"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;StepRec =</Highlight></CodeLine>
<Link id="l04172" /><CodeLine lineNumber="4172"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(GAR-&gt;getStepRecurrence(SE))) &#123;</Highlight></CodeLine>
<Link id="l04173" /><CodeLine lineNumber="4173"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/apint">APInt</a> &amp;StepInt = StepRec-&gt;getAPInt();</Highlight></CodeLine>
<Link id="l04174" /><CodeLine lineNumber="4174"><Highlight kind="normal">        int64&#95;t Step = StepInt.<a href="/docs/api/classes/llvm/apint/#a6804d9caf15411f55e7b9e9f397f0422">isNegative</a>() ?</Highlight></CodeLine>
<Link id="l04175" /><CodeLine lineNumber="4175"><Highlight kind="normal">          StepInt.<a href="/docs/api/classes/llvm/apint/#af2daa0ee117afefed4c82eee55bf97b7">getSExtValue</a>() : StepInt.<a href="/docs/api/classes/llvm/apint/#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</Highlight></CodeLine>
<Link id="l04176" /><CodeLine lineNumber="4176"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04177" /><CodeLine lineNumber="4177"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> : Worklist) &#123;</Highlight></CodeLine>
<Link id="l04178" /><CodeLine lineNumber="4178"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isFixed()) &#123;</Highlight></CodeLine>
<Link id="l04179" /><CodeLine lineNumber="4179"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue() - Step);</Highlight></CodeLine>
<Link id="l04180" /><CodeLine lineNumber="4180"><Highlight kind="normal">            GenerateOffset(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</Highlight></CodeLine>
<Link id="l04181" /><CodeLine lineNumber="4181"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l04182" /><CodeLine lineNumber="4182"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l04183" /><CodeLine lineNumber="4183"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04184" /><CodeLine lineNumber="4184"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04185" /><CodeLine lineNumber="4185"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04186" /><CodeLine lineNumber="4186"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> : Worklist)</Highlight></CodeLine>
<Link id="l04187" /><CodeLine lineNumber="4187"><Highlight kind="normal">    GenerateOffset(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</Highlight></CodeLine>
<Link id="l04188" /><CodeLine lineNumber="4188"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04189" /><CodeLine lineNumber="4189"><Highlight kind="normal">  Immediate <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a> = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, SE);</Highlight></CodeLine>
<Link id="l04190" /><CodeLine lineNumber="4190"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;isZero() || <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a>.isZero() ||</Highlight></CodeLine>
<Link id="l04191" /><CodeLine lineNumber="4191"><Highlight kind="normal">      !<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isCompatibleImmediate(Imm))</Highlight></CodeLine>
<Link id="l04192" /><CodeLine lineNumber="4192"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04193" /><CodeLine lineNumber="4193"><Highlight kind="normal">  Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</Highlight></CodeLine>
<Link id="l04194" /><CodeLine lineNumber="4194"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.addUnsigned(Imm);</Highlight></CodeLine>
<Link id="l04195" /><CodeLine lineNumber="4195"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</Highlight></CodeLine>
<Link id="l04196" /><CodeLine lineNumber="4196"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04197" /><CodeLine lineNumber="4197"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsScaledReg) &#123;</Highlight></CodeLine>
<Link id="l04198" /><CodeLine lineNumber="4198"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>;</Highlight></CodeLine>
<Link id="l04199" /><CodeLine lineNumber="4199"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l04200" /><CodeLine lineNumber="4200"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93; = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>;</Highlight></CodeLine>
<Link id="l04201" /><CodeLine lineNumber="4201"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// We may generate non canonical Formula if G is a recurrent expr reg</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04202" /><CodeLine lineNumber="4202"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// related with current loop while F.ScaledReg is not.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04203" /><CodeLine lineNumber="4203"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</Highlight></CodeLine>
<Link id="l04204" /><CodeLine lineNumber="4204"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04205" /><CodeLine lineNumber="4205"><Highlight kind="normal">  (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04206" /><CodeLine lineNumber="4206"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04207" /><CodeLine lineNumber="4207"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04208" /><CodeLine lineNumber="4208"><Highlight kind="comment">/// GenerateConstantOffsets - Generate reuse formulae using symbolic offsets.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04209" /><CodeLine lineNumber="4209"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateConstantOffsets(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l04210" /><CodeLine lineNumber="4210"><Highlight kind="normal">                                          Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</Highlight></CodeLine>
<Link id="l04211" /><CodeLine lineNumber="4211"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: For now, just add the min and max offset, because it usually isn&#39;t</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04212" /><CodeLine lineNumber="4212"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// worthwhile looking at everything inbetween.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04213" /><CodeLine lineNumber="4213"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Immediate, 2&gt;</a> Worklist;</Highlight></CodeLine>
<Link id="l04214" /><CodeLine lineNumber="4214"><Highlight kind="normal">  Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LU.MinOffset);</Highlight></CodeLine>
<Link id="l04215" /><CodeLine lineNumber="4215"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.MaxOffset != LU.MinOffset)</Highlight></CodeLine>
<Link id="l04216" /><CodeLine lineNumber="4216"><Highlight kind="normal">    Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LU.MaxOffset);</Highlight></CodeLine>
<Link id="l04217" /><CodeLine lineNumber="4217"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04218" /><CodeLine lineNumber="4218"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size(); i != e; ++i)</Highlight></CodeLine>
<Link id="l04219" /><CodeLine lineNumber="4219"><Highlight kind="normal">    GenerateConstantOffsetsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, Worklist, i);</Highlight></CodeLine>
<Link id="l04220" /><CodeLine lineNumber="4220"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 1)</Highlight></CodeLine>
<Link id="l04221" /><CodeLine lineNumber="4221"><Highlight kind="normal">    GenerateConstantOffsetsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, Worklist, </Highlight><Highlight kind="comment">/&#42; Idx &#42;/</Highlight><Highlight kind="normal"> -1,</Highlight></CodeLine>
<Link id="l04222" /><CodeLine lineNumber="4222"><Highlight kind="normal">                                </Highlight><Highlight kind="comment">/&#42; IsScaledReg &#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04223" /><CodeLine lineNumber="4223"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04224" /><CodeLine lineNumber="4224"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04225" /><CodeLine lineNumber="4225"><Highlight kind="comment">/// For ICmpZero, check to see if we can scale up the comparison. For example, x</Highlight></CodeLine>
<Link id="l04226" /><CodeLine lineNumber="4226"><Highlight kind="comment">/// == y -&gt; x&#42;c == y&#42;c.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04227" /><CodeLine lineNumber="4227"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateICmpZeroScales(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx,</Highlight></CodeLine>
<Link id="l04228" /><CodeLine lineNumber="4228"><Highlight kind="normal">                                         Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</Highlight></CodeLine>
<Link id="l04229" /><CodeLine lineNumber="4229"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04230" /><CodeLine lineNumber="4230"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04231" /><CodeLine lineNumber="4231"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Determine the integer type for the base formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04232" /><CodeLine lineNumber="4232"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getType();</Highlight></CodeLine>
<Link id="l04233" /><CodeLine lineNumber="4233"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IntTy) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04234" /><CodeLine lineNumber="4234"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getTypeSizeInBits(IntTy) &gt; 64) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04235" /><CodeLine lineNumber="4235"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04236" /><CodeLine lineNumber="4236"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Don&#39;t do this if there is more than one offset.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04237" /><CodeLine lineNumber="4237"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.MinOffset != LU.MaxOffset) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04238" /><CodeLine lineNumber="4238"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04239" /><CodeLine lineNumber="4239"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check if transformation is valid. It is illegal to multiply pointer.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04240" /><CodeLine lineNumber="4240"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg &amp;&amp; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg-&gt;getType()-&gt;isPointerTy())</Highlight></CodeLine>
<Link id="l04241" /><CodeLine lineNumber="4241"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04242" /><CodeLine lineNumber="4242"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs)</Highlight></CodeLine>
<Link id="l04243" /><CodeLine lineNumber="4243"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseReg-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</Highlight></CodeLine>
<Link id="l04244" /><CodeLine lineNumber="4244"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04245" /><CodeLine lineNumber="4245"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseGV &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;ICmpZero use is not legal!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04246" /><CodeLine lineNumber="4246"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04247" /><CodeLine lineNumber="4247"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check each interesting stride.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04248" /><CodeLine lineNumber="4248"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (int64&#95;t Factor : Factors) &#123;</Highlight></CodeLine>
<Link id="l04249" /><CodeLine lineNumber="4249"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check that Factor can be represented by IntTy</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04250" /><CodeLine lineNumber="4250"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/classes/llvm/constantint/#a5b75b94b0d81c2ae458192b4a6544e18">ConstantInt::isValueValidForType</a>(IntTy, Factor))</Highlight></CodeLine>
<Link id="l04251" /><CodeLine lineNumber="4251"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04252" /><CodeLine lineNumber="4252"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check that the multiplication doesn&#39;t overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04253" /><CodeLine lineNumber="4253"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isMin() &amp;&amp; Factor == -1)</Highlight></CodeLine>
<Link id="l04254" /><CodeLine lineNumber="4254"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04255" /><CodeLine lineNumber="4255"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Not supporting scalable immediates.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04256" /><CodeLine lineNumber="4256"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isNonZero() &amp;&amp; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isScalable())</Highlight></CodeLine>
<Link id="l04257" /><CodeLine lineNumber="4257"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04258" /><CodeLine lineNumber="4258"><Highlight kind="normal">    Immediate NewBaseOffset = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.mulUnsigned(Factor);</Highlight></CodeLine>
<Link id="l04259" /><CodeLine lineNumber="4259"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Factor != 0 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Zero factor not expected!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04260" /><CodeLine lineNumber="4260"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NewBaseOffset.getFixedValue() / Factor !=</Highlight></CodeLine>
<Link id="l04261" /><CodeLine lineNumber="4261"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.getFixedValue())</Highlight></CodeLine>
<Link id="l04262" /><CodeLine lineNumber="4262"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04263" /><CodeLine lineNumber="4263"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If the offset will be truncated at this use, check that it is in bounds.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04264" /><CodeLine lineNumber="4264"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IntTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l04265" /><CodeLine lineNumber="4265"><Highlight kind="normal">        !<a href="/docs/api/classes/llvm/constantint/#a5b75b94b0d81c2ae458192b4a6544e18">ConstantInt::isValueValidForType</a>(IntTy, NewBaseOffset.getFixedValue()))</Highlight></CodeLine>
<Link id="l04266" /><CodeLine lineNumber="4266"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04267" /><CodeLine lineNumber="4267"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04268" /><CodeLine lineNumber="4268"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check that multiplying with the use offset doesn&#39;t overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04269" /><CodeLine lineNumber="4269"><Highlight kind="normal">    Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = LU.MinOffset;</Highlight></CodeLine>
<Link id="l04270" /><CodeLine lineNumber="4270"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isMin() &amp;&amp; Factor == -1)</Highlight></CodeLine>
<Link id="l04271" /><CodeLine lineNumber="4271"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04272" /><CodeLine lineNumber="4272"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.mulUnsigned(Factor);</Highlight></CodeLine>
<Link id="l04273" /><CodeLine lineNumber="4273"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue() / Factor != LU.MinOffset.getFixedValue())</Highlight></CodeLine>
<Link id="l04274" /><CodeLine lineNumber="4274"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04275" /><CodeLine lineNumber="4275"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If the offset will be truncated at this use, check that it is in bounds.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04276" /><CodeLine lineNumber="4276"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IntTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l04277" /><CodeLine lineNumber="4277"><Highlight kind="normal">        !<a href="/docs/api/classes/llvm/constantint/#a5b75b94b0d81c2ae458192b4a6544e18">ConstantInt::isValueValidForType</a>(IntTy, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue()))</Highlight></CodeLine>
<Link id="l04278" /><CodeLine lineNumber="4278"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04279" /><CodeLine lineNumber="4279"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04280" /><CodeLine lineNumber="4280"><Highlight kind="normal">    Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</Highlight></CodeLine>
<Link id="l04281" /><CodeLine lineNumber="4281"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset = NewBaseOffset;</Highlight></CodeLine>
<Link id="l04282" /><CodeLine lineNumber="4282"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04283" /><CodeLine lineNumber="4283"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check that this scale is legal.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04284" /><CodeLine lineNumber="4284"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</Highlight></CodeLine>
<Link id="l04285" /><CodeLine lineNumber="4285"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04286" /><CodeLine lineNumber="4286"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04287" /><CodeLine lineNumber="4287"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Compensate for the use having MinOffset built into it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04288" /><CodeLine lineNumber="4288"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.addUnsigned(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>).subUnsigned(LU.MinOffset);</Highlight></CodeLine>
<Link id="l04289" /><CodeLine lineNumber="4289"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04290" /><CodeLine lineNumber="4290"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;FactorS = SE.getConstant(IntTy, Factor);</Highlight></CodeLine>
<Link id="l04291" /><CodeLine lineNumber="4291"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04292" /><CodeLine lineNumber="4292"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check that multiplying with each base register doesn&#39;t overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04293" /><CodeLine lineNumber="4293"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.size(); i != e; ++i) &#123;</Highlight></CodeLine>
<Link id="l04294" /><CodeLine lineNumber="4294"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;i&#93; = SE.getMulExpr(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;i&#93;, FactorS);</Highlight></CodeLine>
<Link id="l04295" /><CodeLine lineNumber="4295"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;i&#93;, FactorS, SE) != <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;i&#93;)</Highlight></CodeLine>
<Link id="l04296" /><CodeLine lineNumber="4296"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">goto</Highlight><Highlight kind="normal"> next;</Highlight></CodeLine>
<Link id="l04297" /><CodeLine lineNumber="4297"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04298" /><CodeLine lineNumber="4298"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04299" /><CodeLine lineNumber="4299"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check that multiplying with the scaled register doesn&#39;t overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04300" /><CodeLine lineNumber="4300"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) &#123;</Highlight></CodeLine>
<Link id="l04301" /><CodeLine lineNumber="4301"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = SE.getMulExpr(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, FactorS);</Highlight></CodeLine>
<Link id="l04302" /><CodeLine lineNumber="4302"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, FactorS, SE) != <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg)</Highlight></CodeLine>
<Link id="l04303" /><CodeLine lineNumber="4303"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04304" /><CodeLine lineNumber="4304"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04305" /><CodeLine lineNumber="4305"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04306" /><CodeLine lineNumber="4306"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check that multiplying with the unfolded offset doesn&#39;t overflow.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04307" /><CodeLine lineNumber="4307"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isNonZero()) &#123;</Highlight></CodeLine>
<Link id="l04308" /><CodeLine lineNumber="4308"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isMin() &amp;&amp; Factor == -1)</Highlight></CodeLine>
<Link id="l04309" /><CodeLine lineNumber="4309"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04310" /><CodeLine lineNumber="4310"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.mulUnsigned(Factor);</Highlight></CodeLine>
<Link id="l04311" /><CodeLine lineNumber="4311"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() / Factor !=</Highlight></CodeLine>
<Link id="l04312" /><CodeLine lineNumber="4312"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.UnfoldedOffset.getFixedValue())</Highlight></CodeLine>
<Link id="l04313" /><CodeLine lineNumber="4313"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04314" /><CodeLine lineNumber="4314"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If the offset will be truncated, check that it is in bounds.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04315" /><CodeLine lineNumber="4315"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IntTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp; !<a href="/docs/api/classes/llvm/constantint/#a5b75b94b0d81c2ae458192b4a6544e18">ConstantInt::isValueValidForType</a>(</Highlight></CodeLine>
<Link id="l04316" /><CodeLine lineNumber="4316"><Highlight kind="normal">                                       IntTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue()))</Highlight></CodeLine>
<Link id="l04317" /><CodeLine lineNumber="4317"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04318" /><CodeLine lineNumber="4318"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04319" /><CodeLine lineNumber="4319"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04320" /><CodeLine lineNumber="4320"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If we make it here and it&#39;s legal, add it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04321" /><CodeLine lineNumber="4321"><Highlight kind="normal">    (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04322" /><CodeLine lineNumber="4322"><Highlight kind="normal">  next:;</Highlight></CodeLine>
<Link id="l04323" /><CodeLine lineNumber="4323"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04324" /><CodeLine lineNumber="4324"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04325" /><CodeLine lineNumber="4325"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04326" /><CodeLine lineNumber="4326"><Highlight kind="comment">/// Generate stride factor reuse formulae by making use of scaled-offset address</Highlight></CodeLine>
<Link id="l04327" /><CodeLine lineNumber="4327"><Highlight kind="comment">/// modes, for example.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04328" /><CodeLine lineNumber="4328"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateScales(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</Highlight></CodeLine>
<Link id="l04329" /><CodeLine lineNumber="4329"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Determine the integer type for the base formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04330" /><CodeLine lineNumber="4330"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getType();</Highlight></CodeLine>
<Link id="l04331" /><CodeLine lineNumber="4331"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IntTy) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04332" /><CodeLine lineNumber="4332"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04333" /><CodeLine lineNumber="4333"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If this Formula already has a scaled register, we can&#39;t add another one.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04334" /><CodeLine lineNumber="4334"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Try to unscale the formula to generate a better scale.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04335" /><CodeLine lineNumber="4335"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale != 0 &amp;&amp; !<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.unscale())</Highlight></CodeLine>
<Link id="l04336" /><CodeLine lineNumber="4336"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04337" /><CodeLine lineNumber="4337"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04338" /><CodeLine lineNumber="4338"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 0 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;unscale did not did its job!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04339" /><CodeLine lineNumber="4339"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04340" /><CodeLine lineNumber="4340"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Check each interesting stride.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04341" /><CodeLine lineNumber="4341"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (int64&#95;t Factor : Factors) &#123;</Highlight></CodeLine>
<Link id="l04342" /><CodeLine lineNumber="4342"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale = Factor;</Highlight></CodeLine>
<Link id="l04343" /><CodeLine lineNumber="4343"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.HasBaseReg = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size() &gt; 1;</Highlight></CodeLine>
<Link id="l04344" /><CodeLine lineNumber="4344"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Check whether this scale is going to be legal.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04345" /><CodeLine lineNumber="4345"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy,</Highlight></CodeLine>
<Link id="l04346" /><CodeLine lineNumber="4346"><Highlight kind="normal">                    <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>)) &#123;</Highlight></CodeLine>
<Link id="l04347" /><CodeLine lineNumber="4347"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// As a special-case, handle special out-of-loop Basic users specially.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04348" /><CodeLine lineNumber="4348"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// TODO: Reconsider this special case.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04349" /><CodeLine lineNumber="4349"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l04350" /><CodeLine lineNumber="4350"><Highlight kind="normal">          <a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">LSRUse::Special</a>,</Highlight></CodeLine>
<Link id="l04351" /><CodeLine lineNumber="4351"><Highlight kind="normal">                     LU.AccessTy, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l04352" /><CodeLine lineNumber="4352"><Highlight kind="normal">          LU.AllFixupsOutsideLoop)</Highlight></CodeLine>
<Link id="l04353" /><CodeLine lineNumber="4353"><Highlight kind="normal">        LU.Kind = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">LSRUse::Special</a>;</Highlight></CodeLine>
<Link id="l04354" /><CodeLine lineNumber="4354"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04355" /><CodeLine lineNumber="4355"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04356" /><CodeLine lineNumber="4356"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04357" /><CodeLine lineNumber="4357"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// For an ICmpZero, negating a solitary base register won&#39;t lead to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04358" /><CodeLine lineNumber="4358"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// new solutions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04359" /><CodeLine lineNumber="4359"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> &amp;&amp; !<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.HasBaseReg &amp;&amp;</Highlight></CodeLine>
<Link id="l04360" /><CodeLine lineNumber="4360"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isZero() &amp;&amp; !<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseGV)</Highlight></CodeLine>
<Link id="l04361" /><CodeLine lineNumber="4361"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04362" /><CodeLine lineNumber="4362"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// For each addrec base reg, if its loop is current loop, apply the scale.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04363" /><CodeLine lineNumber="4363"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size(); i != e; ++i) &#123;</Highlight></CodeLine>
<Link id="l04364" /><CodeLine lineNumber="4364"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04365" /><CodeLine lineNumber="4365"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AR &amp;&amp; (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L || LU.AllFixupsOutsideLoop)) &#123;</Highlight></CodeLine>
<Link id="l04366" /><CodeLine lineNumber="4366"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;FactorS = SE.getConstant(IntTy, Factor);</Highlight></CodeLine>
<Link id="l04367" /><CodeLine lineNumber="4367"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FactorS-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</Highlight></CodeLine>
<Link id="l04368" /><CodeLine lineNumber="4368"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04369" /><CodeLine lineNumber="4369"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Divide out the factor, ignoring high bits, since we&#39;ll be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04370" /><CodeLine lineNumber="4370"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// scaling the value back up in the end.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04371" /><CodeLine lineNumber="4371"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Quotient = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(AR, FactorS, SE, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">))</Highlight></CodeLine>
<Link id="l04372" /><CodeLine lineNumber="4372"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Quotient-&gt;isZero()) &#123;</Highlight></CodeLine>
<Link id="l04373" /><CodeLine lineNumber="4373"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// TODO: This could be optimized to avoid all the copying.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04374" /><CodeLine lineNumber="4374"><Highlight kind="normal">            Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</Highlight></CodeLine>
<Link id="l04375" /><CodeLine lineNumber="4375"><Highlight kind="normal">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = Quotient;</Highlight></CodeLine>
<Link id="l04376" /><CodeLine lineNumber="4376"><Highlight kind="normal">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.deleteBaseReg(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04377" /><CodeLine lineNumber="4377"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// The canonical representation of 1&#42;reg is reg, which is already in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04378" /><CodeLine lineNumber="4378"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// Base. In that case, do not try to insert the formula, it will be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04379" /><CodeLine lineNumber="4379"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// rejected anyway.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04380" /><CodeLine lineNumber="4380"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 1 &amp;&amp; (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.empty() ||</Highlight></CodeLine>
<Link id="l04381" /><CodeLine lineNumber="4381"><Highlight kind="normal">                                 (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() != L &amp;&amp; LU.AllFixupsOutsideLoop)))</Highlight></CodeLine>
<Link id="l04382" /><CodeLine lineNumber="4382"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04383" /><CodeLine lineNumber="4383"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// If AllFixupsOutsideLoop is true and F.Scale is 1, we may generate</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04384" /><CodeLine lineNumber="4384"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// non canonical Formula with ScaledReg&#39;s loop not being L.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04385" /><CodeLine lineNumber="4385"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 1 &amp;&amp; LU.AllFixupsOutsideLoop)</Highlight></CodeLine>
<Link id="l04386" /><CodeLine lineNumber="4386"><Highlight kind="normal">              <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</Highlight></CodeLine>
<Link id="l04387" /><CodeLine lineNumber="4387"><Highlight kind="normal">            (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04388" /><CodeLine lineNumber="4388"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l04389" /><CodeLine lineNumber="4389"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04390" /><CodeLine lineNumber="4390"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04391" /><CodeLine lineNumber="4391"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04392" /><CodeLine lineNumber="4392"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04393" /><CodeLine lineNumber="4393"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04394" /><CodeLine lineNumber="4394"><Highlight kind="comment">/// Extend/Truncate \\p Expr to \\p ToTy considering post-inc uses in \\p Loops.</Highlight></CodeLine>
<Link id="l04395" /><CodeLine lineNumber="4395"><Highlight kind="comment">/// For all PostIncLoopSets in \\p Loops, first de-normalize \\p Expr, then</Highlight></CodeLine>
<Link id="l04396" /><CodeLine lineNumber="4396"><Highlight kind="comment">/// perform the extension/truncate and normalize again, as the normalized form</Highlight></CodeLine>
<Link id="l04397" /><CodeLine lineNumber="4397"><Highlight kind="comment">/// can result in folds that are not valid in the post-inc use contexts. The</Highlight></CodeLine>
<Link id="l04398" /><CodeLine lineNumber="4398"><Highlight kind="comment">/// expressions for all PostIncLoopSets must match, otherwise return nullptr.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04399" /><CodeLine lineNumber="4399"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</Highlight></CodeLine>
<Link id="l04400" /><CodeLine lineNumber="4400" lineLink="#ae0228f64a74eb3e9fc5343b024ab9a42"><Highlight kind="normal"><a href="#ae0228f64a74eb3e9fc5343b024ab9a42">getAnyExtendConsideringPostIncUses</a>(<a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;PostIncLoopSet&gt;</a> <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>,</Highlight></CodeLine>
<Link id="l04401" /><CodeLine lineNumber="4401"><Highlight kind="normal">                                   </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Expr, <a href="/docs/api/classes/llvm/type">Type</a> &#42;ToTy,</Highlight></CodeLine>
<Link id="l04402" /><CodeLine lineNumber="4402"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l04403" /><CodeLine lineNumber="4403"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Result = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04404" /><CodeLine lineNumber="4404"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;L : <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>) &#123;</Highlight></CodeLine>
<Link id="l04405" /><CodeLine lineNumber="4405"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;DenormExpr = <a href="/docs/api/namespaces/llvm/#a6fb1355b48afff4e97045b546b5f6415">denormalizeForPostIncUse</a>(Expr, L, SE);</Highlight></CodeLine>
<Link id="l04406" /><CodeLine lineNumber="4406"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewDenormExpr = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aa35959e3f6bea8e35cffcfd8659e3156">getAnyExtendExpr</a>(DenormExpr, ToTy);</Highlight></CodeLine>
<Link id="l04407" /><CodeLine lineNumber="4407"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;New = <a href="/docs/api/namespaces/llvm/#a99237ea99bf8618b7d29b5ca6185069b">normalizeForPostIncUse</a>(NewDenormExpr, L, SE);</Highlight></CodeLine>
<Link id="l04408" /><CodeLine lineNumber="4408"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!New || (Result &amp;&amp; New != Result))</Highlight></CodeLine>
<Link id="l04409" /><CodeLine lineNumber="4409"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04410" /><CodeLine lineNumber="4410"><Highlight kind="normal">    Result = New;</Highlight></CodeLine>
<Link id="l04411" /><CodeLine lineNumber="4411"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04412" /><CodeLine lineNumber="4412"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04413" /><CodeLine lineNumber="4413"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Result &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;failed to create expression&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04414" /><CodeLine lineNumber="4414"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Result;</Highlight></CodeLine>
<Link id="l04415" /><CodeLine lineNumber="4415"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04416" /><CodeLine lineNumber="4416"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04417" /><CodeLine lineNumber="4417"><Highlight kind="comment">/// Generate reuse formulae from different IV types.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04418" /><CodeLine lineNumber="4418"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateTruncates(LSRUse &amp;LU, </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx, Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</Highlight></CodeLine>
<Link id="l04419" /><CodeLine lineNumber="4419"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Don&#39;t bother truncating symbolic values.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04420" /><CodeLine lineNumber="4420"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseGV) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04421" /><CodeLine lineNumber="4421"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04422" /><CodeLine lineNumber="4422"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Determine the integer type for the base formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04423" /><CodeLine lineNumber="4423"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;DstTy = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getType();</Highlight></CodeLine>
<Link id="l04424" /><CodeLine lineNumber="4424"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DstTy) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04425" /><CodeLine lineNumber="4425"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DstTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</Highlight></CodeLine>
<Link id="l04426" /><CodeLine lineNumber="4426"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04427" /><CodeLine lineNumber="4427"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04428" /><CodeLine lineNumber="4428"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// It is invalid to extend a pointer type so exit early if ScaledReg or</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04429" /><CodeLine lineNumber="4429"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// any of the BaseRegs are pointers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04430" /><CodeLine lineNumber="4430"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg &amp;&amp; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg-&gt;getType()-&gt;isPointerTy())</Highlight></CodeLine>
<Link id="l04431" /><CodeLine lineNumber="4431"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04432" /><CodeLine lineNumber="4432"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a61d13d6824ec46c31260a4fd0997eda0">any&#95;of</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs,</Highlight></CodeLine>
<Link id="l04433" /><CodeLine lineNumber="4433"><Highlight kind="normal">             &#91;&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123; return S-&gt;getType()-&gt;isPointerTy(); &#125;))</Highlight></CodeLine>
<Link id="l04434" /><CodeLine lineNumber="4434"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04435" /><CodeLine lineNumber="4435"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04436" /><CodeLine lineNumber="4436"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;PostIncLoopSet&gt;</a> <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>;</Highlight></CodeLine>
<Link id="l04437" /><CodeLine lineNumber="4437"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;LF : LU.Fixups)</Highlight></CodeLine>
<Link id="l04438" /><CodeLine lineNumber="4438"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LF.PostIncLoops);</Highlight></CodeLine>
<Link id="l04439" /><CodeLine lineNumber="4439"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04440" /><CodeLine lineNumber="4440"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/type">Type</a> &#42;SrcTy : Types) &#123;</Highlight></CodeLine>
<Link id="l04441" /><CodeLine lineNumber="4441"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SrcTy != DstTy &amp;&amp; <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isTruncateFree(SrcTy, DstTy)) &#123;</Highlight></CodeLine>
<Link id="l04442" /><CodeLine lineNumber="4442"><Highlight kind="normal">      Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</Highlight></CodeLine>
<Link id="l04443" /><CodeLine lineNumber="4443"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04444" /><CodeLine lineNumber="4444"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Sometimes SCEV is able to prove zero during ext transform. It may</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04445" /><CodeLine lineNumber="4445"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// happen if SCEV did not do all possible transforms while creating the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04446" /><CodeLine lineNumber="4446"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// initial node (maybe due to depth limitations), but it can do them while</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04447" /><CodeLine lineNumber="4447"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// taking ext.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04448" /><CodeLine lineNumber="4448"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) &#123;</Highlight></CodeLine>
<Link id="l04449" /><CodeLine lineNumber="4449"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewScaledReg =</Highlight></CodeLine>
<Link id="l04450" /><CodeLine lineNumber="4450"><Highlight kind="normal">            <a href="#ae0228f64a74eb3e9fc5343b024ab9a42">getAnyExtendConsideringPostIncUses</a>(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, SrcTy, SE);</Highlight></CodeLine>
<Link id="l04451" /><CodeLine lineNumber="4451"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!NewScaledReg || NewScaledReg-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</Highlight></CodeLine>
<Link id="l04452" /><CodeLine lineNumber="4452"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04453" /><CodeLine lineNumber="4453"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = NewScaledReg;</Highlight></CodeLine>
<Link id="l04454" /><CodeLine lineNumber="4454"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04455" /><CodeLine lineNumber="4455"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> HasZeroBaseReg = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04456" /><CodeLine lineNumber="4456"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</Highlight></CodeLine>
<Link id="l04457" /><CodeLine lineNumber="4457"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewBaseReg =</Highlight></CodeLine>
<Link id="l04458" /><CodeLine lineNumber="4458"><Highlight kind="normal">            <a href="#ae0228f64a74eb3e9fc5343b024ab9a42">getAnyExtendConsideringPostIncUses</a>(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>, BaseReg, SrcTy, SE);</Highlight></CodeLine>
<Link id="l04459" /><CodeLine lineNumber="4459"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!NewBaseReg || NewBaseReg-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</Highlight></CodeLine>
<Link id="l04460" /><CodeLine lineNumber="4460"><Highlight kind="normal">          HasZeroBaseReg = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04461" /><CodeLine lineNumber="4461"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04462" /><CodeLine lineNumber="4462"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l04463" /><CodeLine lineNumber="4463"><Highlight kind="normal">        BaseReg = NewBaseReg;</Highlight></CodeLine>
<Link id="l04464" /><CodeLine lineNumber="4464"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04465" /><CodeLine lineNumber="4465"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (HasZeroBaseReg)</Highlight></CodeLine>
<Link id="l04466" /><CodeLine lineNumber="4466"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04467" /><CodeLine lineNumber="4467"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04468" /><CodeLine lineNumber="4468"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// TODO: This assumes we&#39;ve done basic processing on all uses and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04469" /><CodeLine lineNumber="4469"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// have an idea what the register usage is.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04470" /><CodeLine lineNumber="4470"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasRegsUsedByUsesOtherThan(LUIdx, RegUses))</Highlight></CodeLine>
<Link id="l04471" /><CodeLine lineNumber="4471"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04472" /><CodeLine lineNumber="4472"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04473" /><CodeLine lineNumber="4473"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</Highlight></CodeLine>
<Link id="l04474" /><CodeLine lineNumber="4474"><Highlight kind="normal">      (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04475" /><CodeLine lineNumber="4475"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04476" /><CodeLine lineNumber="4476"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04477" /><CodeLine lineNumber="4477"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04478" /><CodeLine lineNumber="4478"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04479" /><CodeLine lineNumber="4479"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l04480" /><CodeLine lineNumber="4480"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04481" /><CodeLine lineNumber="4481"><Highlight kind="comment">/// Helper class for GenerateCrossUseConstantOffsets. It&#39;s used to defer</Highlight></CodeLine>
<Link id="l04482" /><CodeLine lineNumber="4482"><Highlight kind="comment">/// modifications so that the search phase doesn&#39;t have to worry about the data</Highlight></CodeLine>
<Link id="l04483" /><CodeLine lineNumber="4483"><Highlight kind="comment">/// structures moving underneath it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04484" /><CodeLine lineNumber="4484" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#ad08f488d8d7c39cdd65fdd02f3433b48">WorkItem</a> &#123;</Highlight></CodeLine>
<Link id="l04485" /><CodeLine lineNumber="4485" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#aaaafc698bf9e95dece11ebbe3464c678"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#aaaafc698bf9e95dece11ebbe3464c678">LUIdx</a>;</Highlight></CodeLine>
<Link id="l04486" /><CodeLine lineNumber="4486" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a6ea4ba88bb5cefffde6534660188720b"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a6ea4ba88bb5cefffde6534660188720b">Imm</a>;</Highlight></CodeLine>
<Link id="l04487" /><CodeLine lineNumber="4487" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a41baa8ff8fffe77ba278bb3f009c8e3a"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a41baa8ff8fffe77ba278bb3f009c8e3a">OrigReg</a>;</Highlight></CodeLine>
<Link id="l04488" /><CodeLine lineNumber="4488"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04489" /><CodeLine lineNumber="4489" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#ad08f488d8d7c39cdd65fdd02f3433b48"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#ad08f488d8d7c39cdd65fdd02f3433b48">WorkItem</a>(</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LI, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;R)</Highlight></CodeLine>
<Link id="l04490" /><CodeLine lineNumber="4490"><Highlight kind="normal">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#aaaafc698bf9e95dece11ebbe3464c678">LUIdx</a>(LI), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a6ea4ba88bb5cefffde6534660188720b">Imm</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a41baa8ff8fffe77ba278bb3f009c8e3a">OrigReg</a>(R) &#123;&#125;</Highlight></CodeLine>
<Link id="l04491" /><CodeLine lineNumber="4491"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04492" /><CodeLine lineNumber="4492"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04493" /><CodeLine lineNumber="4493"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04494" /><CodeLine lineNumber="4494"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l04495" /><CodeLine lineNumber="4495"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04496" /><CodeLine lineNumber="4496"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// end anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04497" /><CodeLine lineNumber="4497"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04498" /><CodeLine lineNumber="4498"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04499" /><CodeLine lineNumber="4499" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a10aaa870abf7228d3bbbf3f9b66a7d97"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a10aaa870abf7228d3bbbf3f9b66a7d97">WorkItem::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l04500" /><CodeLine lineNumber="4500"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;in formulae referencing &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a41baa8ff8fffe77ba278bb3f009c8e3a">OrigReg</a> &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; in use &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#aaaafc698bf9e95dece11ebbe3464c678">LUIdx</a></Highlight></CodeLine>
<Link id="l04501" /><CodeLine lineNumber="4501"><Highlight kind="normal">     &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; , add offset &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a6ea4ba88bb5cefffde6534660188720b">Imm</a>;</Highlight></CodeLine>
<Link id="l04502" /><CodeLine lineNumber="4502"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04503" /><CodeLine lineNumber="4503"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04504" /><CodeLine lineNumber="4504" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a9ee84141fefcb511385561d5d59523ce"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a9ee84141fefcb511385561d5d59523ce">WorkItem::dump</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l04505" /><CodeLine lineNumber="4505"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04506" /><CodeLine lineNumber="4506"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04507" /><CodeLine lineNumber="4507"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04508" /><CodeLine lineNumber="4508"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04509" /><CodeLine lineNumber="4509"><Highlight kind="comment">/// Look for registers which are a constant distance apart and try to form reuse</Highlight></CodeLine>
<Link id="l04510" /><CodeLine lineNumber="4510"><Highlight kind="comment">/// opportunities between them.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04511" /><CodeLine lineNumber="4511"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::GenerateCrossUseConstantOffsets() &#123;</Highlight></CodeLine>
<Link id="l04512" /><CodeLine lineNumber="4512"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Group the registers by their value without any added constant offset.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04513" /><CodeLine lineNumber="4513"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal">ImmMapTy = std::map&lt;Immediate, const SCEV &#42;, KeyOrderTargetImmediate&gt;;</Highlight></CodeLine>
<Link id="l04514" /><CodeLine lineNumber="4514"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04515" /><CodeLine lineNumber="4515"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;const SCEV &#42;, ImmMapTy&gt;</a> Map;</Highlight></CodeLine>
<Link id="l04516" /><CodeLine lineNumber="4516"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;const SCEV &#42;, SmallBitVector&gt;</a> UsedByIndicesMap;</Highlight></CodeLine>
<Link id="l04517" /><CodeLine lineNumber="4517"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> Sequence;</Highlight></CodeLine>
<Link id="l04518" /><CodeLine lineNumber="4518"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/classes/llvm/use">Use</a> : RegUses) &#123;</Highlight></CodeLine>
<Link id="l04519" /><CodeLine lineNumber="4519"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg = <a href="/docs/api/classes/llvm/use">Use</a>; </Highlight><Highlight kind="comment">// Make a copy for ExtractImmediate to modify.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04520" /><CodeLine lineNumber="4520"><Highlight kind="normal">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> Imm = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(Reg, SE);</Highlight></CodeLine>
<Link id="l04521" /><CodeLine lineNumber="4521"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> Pair = Map.insert(std::make&#95;pair(Reg, ImmMapTy()));</Highlight></CodeLine>
<Link id="l04522" /><CodeLine lineNumber="4522"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Pair.second)</Highlight></CodeLine>
<Link id="l04523" /><CodeLine lineNumber="4523"><Highlight kind="normal">      Sequence.push&#95;back(Reg);</Highlight></CodeLine>
<Link id="l04524" /><CodeLine lineNumber="4524"><Highlight kind="normal">    Pair.first-&gt;second.insert(std::make&#95;pair(Imm, <a href="/docs/api/classes/llvm/use">Use</a>));</Highlight></CodeLine>
<Link id="l04525" /><CodeLine lineNumber="4525"><Highlight kind="normal">    UsedByIndicesMap&#91;Reg&#93; |= RegUses.getUsedByIndices(<a href="/docs/api/classes/llvm/use">Use</a>);</Highlight></CodeLine>
<Link id="l04526" /><CodeLine lineNumber="4526"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04527" /><CodeLine lineNumber="4527"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04528" /><CodeLine lineNumber="4528"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Now examine each set of registers with the same base value. Build up</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04529" /><CodeLine lineNumber="4529"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// a list of work to do and do the work in a separate step so that we&#39;re</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04530" /><CodeLine lineNumber="4530"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// not adding formulae and register counts while we&#39;re searching.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04531" /><CodeLine lineNumber="4531"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WorkItem, 32&gt;</a> WorkItems;</Highlight></CodeLine>
<Link id="l04532" /><CodeLine lineNumber="4532"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallset">SmallSet&lt;std::pair&lt;size&#95;t, Immediate&gt;</a>, 32, KeyOrderSizeTAndImmediate&gt;</Highlight></CodeLine>
<Link id="l04533" /><CodeLine lineNumber="4533"><Highlight kind="normal">      UniqueItems;</Highlight></CodeLine>
<Link id="l04534" /><CodeLine lineNumber="4534"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : Sequence) &#123;</Highlight></CodeLine>
<Link id="l04535" /><CodeLine lineNumber="4535"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> ImmMapTy &amp;Imms = Map.find(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)-&gt;second;</Highlight></CodeLine>
<Link id="l04536" /><CodeLine lineNumber="4536"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04537" /><CodeLine lineNumber="4537"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// It&#39;s not worthwhile looking for reuse if there&#39;s only one offset.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04538" /><CodeLine lineNumber="4538"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Imms.size() == 1)</Highlight></CodeLine>
<Link id="l04539" /><CodeLine lineNumber="4539"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04540" /><CodeLine lineNumber="4540"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04541" /><CodeLine lineNumber="4541"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Generating cross-use offsets for &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;:&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04542" /><CodeLine lineNumber="4542"><Highlight kind="normal">               </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Entry</Highlight></CodeLine>
<Link id="l04543" /><CodeLine lineNumber="4543"><Highlight kind="normal">                    : Imms) <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</Highlight></CodeLine>
<Link id="l04544" /><CodeLine lineNumber="4544"><Highlight kind="normal">               &lt;&lt; </Highlight><Highlight kind="charliteral">&#39; &#39;</Highlight><Highlight kind="normal"> &lt;&lt; Entry.first;</Highlight></CodeLine>
<Link id="l04545" /><CodeLine lineNumber="4545"><Highlight kind="normal">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04546" /><CodeLine lineNumber="4546"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04547" /><CodeLine lineNumber="4547"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Examine each offset.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04548" /><CodeLine lineNumber="4548"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (ImmMapTy::const&#95;iterator J = Imms.begin(), JE = Imms.end();</Highlight></CodeLine>
<Link id="l04549" /><CodeLine lineNumber="4549"><Highlight kind="normal">         J != JE; ++J) &#123;</Highlight></CodeLine>
<Link id="l04550" /><CodeLine lineNumber="4550"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OrigReg = J-&gt;second;</Highlight></CodeLine>
<Link id="l04551" /><CodeLine lineNumber="4551"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04552" /><CodeLine lineNumber="4552"><Highlight kind="normal">      Immediate JImm = J-&gt;first;</Highlight></CodeLine>
<Link id="l04553" /><CodeLine lineNumber="4553"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = RegUses.getUsedByIndices(OrigReg);</Highlight></CodeLine>
<Link id="l04554" /><CodeLine lineNumber="4554"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04555" /><CodeLine lineNumber="4555"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(OrigReg) &amp;&amp;</Highlight></CodeLine>
<Link id="l04556" /><CodeLine lineNumber="4556"><Highlight kind="normal">          UsedByIndicesMap&#91;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>&#93;.<a href="/docs/api/namespaces/llvm/#ab1772fd431decccb7926d484ea223db7">count</a>() == 1) &#123;</Highlight></CodeLine>
<Link id="l04557" /><CodeLine lineNumber="4557"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Skipping cross-use reuse for &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OrigReg</Highlight></CodeLine>
<Link id="l04558" /><CodeLine lineNumber="4558"><Highlight kind="normal">                          &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04559" /><CodeLine lineNumber="4559"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04560" /><CodeLine lineNumber="4560"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04561" /><CodeLine lineNumber="4561"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04562" /><CodeLine lineNumber="4562"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Conservatively examine offsets between this orig reg a few selected</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04563" /><CodeLine lineNumber="4563"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// other orig regs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04564" /><CodeLine lineNumber="4564"><Highlight kind="normal">      Immediate <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = Imms.begin()-&gt;first;</Highlight></CodeLine>
<Link id="l04565" /><CodeLine lineNumber="4565"><Highlight kind="normal">      Immediate <a href="/docs/api/namespaces/llvm/#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">Last</a> = std::prev(Imms.end())-&gt;first;</Highlight></CodeLine>
<Link id="l04566" /><CodeLine lineNumber="4566"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>.isCompatibleImmediate(<a href="/docs/api/namespaces/llvm/#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">Last</a>)) &#123;</Highlight></CodeLine>
<Link id="l04567" /><CodeLine lineNumber="4567"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Skipping cross-use reuse for &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;OrigReg</Highlight></CodeLine>
<Link id="l04568" /><CodeLine lineNumber="4568"><Highlight kind="normal">                          &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04569" /><CodeLine lineNumber="4569"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04570" /><CodeLine lineNumber="4570"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04571" /><CodeLine lineNumber="4571"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Only scalable if both terms are scalable, or if one is scalable and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04572" /><CodeLine lineNumber="4572"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// the other is 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04573" /><CodeLine lineNumber="4573"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> Scalable = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>.isScalable() || <a href="/docs/api/namespaces/llvm/#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">Last</a>.isScalable();</Highlight></CodeLine>
<Link id="l04574" /><CodeLine lineNumber="4574"><Highlight kind="normal">      int64&#95;t FI = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>.getKnownMinValue();</Highlight></CodeLine>
<Link id="l04575" /><CodeLine lineNumber="4575"><Highlight kind="normal">      int64&#95;t LI = <a href="/docs/api/namespaces/llvm/#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">Last</a>.getKnownMinValue();</Highlight></CodeLine>
<Link id="l04576" /><CodeLine lineNumber="4576"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Compute (First + Last)  / 2 without overflow using the fact that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04577" /><CodeLine lineNumber="4577"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// First + Last = 2 &#42; (First + Last) + (First ^ Last).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04578" /><CodeLine lineNumber="4578"><Highlight kind="normal">      int64&#95;t Avg = (FI &amp; LI) + ((FI ^ LI) &gt;&gt; 1);</Highlight></CodeLine>
<Link id="l04579" /><CodeLine lineNumber="4579"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If the result is negative and FI is odd and LI even (or vice versa),</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04580" /><CodeLine lineNumber="4580"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// we rounded towards -inf. Add 1 in that case, to round towards 0</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04581" /><CodeLine lineNumber="4581"><Highlight kind="normal">      Avg = Avg + ((FI ^ LI) &amp; ((uint64&#95;t)Avg &gt;&gt; 63));</Highlight></CodeLine>
<Link id="l04582" /><CodeLine lineNumber="4582"><Highlight kind="normal">      ImmMapTy::const&#95;iterator OtherImms&#91;&#93; = &#123;</Highlight></CodeLine>
<Link id="l04583" /><CodeLine lineNumber="4583"><Highlight kind="normal">          Imms.begin(), std::prev(Imms.end()),</Highlight></CodeLine>
<Link id="l04584" /><CodeLine lineNumber="4584"><Highlight kind="normal">          Imms.lower&#95;bound(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341">Immediate::get</a>(Avg, Scalable))&#125;;</Highlight></CodeLine>
<Link id="l04585" /><CodeLine lineNumber="4585"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;M : OtherImms) &#123;</Highlight></CodeLine>
<Link id="l04586" /><CodeLine lineNumber="4586"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (M == J || M == JE) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04587" /><CodeLine lineNumber="4587"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!JImm.isCompatibleImmediate(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>-&gt;first))</Highlight></CodeLine>
<Link id="l04588" /><CodeLine lineNumber="4588"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04589" /><CodeLine lineNumber="4589"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04590" /><CodeLine lineNumber="4590"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Compute the difference between the two.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04591" /><CodeLine lineNumber="4591"><Highlight kind="normal">        Immediate <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a> = JImm.subUnsigned(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>-&gt;first);</Highlight></CodeLine>
<Link id="l04592" /><CodeLine lineNumber="4592"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> LUIdx : UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#a72bc4f47a61dc9d9888561c4dc22e8f6">set&#95;bits</a>())</Highlight></CodeLine>
<Link id="l04593" /><CodeLine lineNumber="4593"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// Make a memo of this use, offset, and register tuple.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04594" /><CodeLine lineNumber="4594"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UniqueItems.<a href="/docs/api/classes/llvm/smallset/#afcadfef2cf37c3e6dbdbc9cd7bea50a0">insert</a>(std::make&#95;pair(LUIdx, Imm)).second)</Highlight></CodeLine>
<Link id="l04595" /><CodeLine lineNumber="4595"><Highlight kind="normal">            WorkItems.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(WorkItem(LUIdx, Imm, OrigReg));</Highlight></CodeLine>
<Link id="l04596" /><CodeLine lineNumber="4596"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04597" /><CodeLine lineNumber="4597"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04598" /><CodeLine lineNumber="4598"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04599" /><CodeLine lineNumber="4599"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04600" /><CodeLine lineNumber="4600"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/msgpack/#afdae9da66bac09f4b2bfc0fd9f0559e6a46f3ea056caa3126b91f3f70beea068c">Map</a>.clear();</Highlight></CodeLine>
<Link id="l04601" /><CodeLine lineNumber="4601"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/objcarc/#a845b8f76f8bd22e4e2eb851121db306d">Sequence</a>.clear();</Highlight></CodeLine>
<Link id="l04602" /><CodeLine lineNumber="4602"><Highlight kind="normal">  UsedByIndicesMap.<a href="/docs/api/classes/llvm/densemapbase/#adf4e7878fc0b3b8dcde545178564190d">clear</a>();</Highlight></CodeLine>
<Link id="l04603" /><CodeLine lineNumber="4603"><Highlight kind="normal">  UniqueItems.<a href="/docs/api/classes/llvm/smallset/#a76b3fc7c102561fb5210d5151531e409">clear</a>();</Highlight></CodeLine>
<Link id="l04604" /><CodeLine lineNumber="4604"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04605" /><CodeLine lineNumber="4605"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Now iterate through the worklist and add new formulae.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04606" /><CodeLine lineNumber="4606"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> WorkItem &amp;WI : WorkItems) &#123;</Highlight></CodeLine>
<Link id="l04607" /><CodeLine lineNumber="4607"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = WI.LUIdx;</Highlight></CodeLine>
<Link id="l04608" /><CodeLine lineNumber="4608"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l04609" /><CodeLine lineNumber="4609"><Highlight kind="normal">    Immediate <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a> = WI.Imm;</Highlight></CodeLine>
<Link id="l04610" /><CodeLine lineNumber="4610"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OrigReg = WI.OrigReg;</Highlight></CodeLine>
<Link id="l04611" /><CodeLine lineNumber="4611"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04612" /><CodeLine lineNumber="4612"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = SE.getEffectiveSCEVType(OrigReg-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>());</Highlight></CodeLine>
<Link id="l04613" /><CodeLine lineNumber="4613"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NegImmS = <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a>.getNegativeSCEV(SE, IntTy);</Highlight></CodeLine>
<Link id="l04614" /><CodeLine lineNumber="4614"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = SE.getTypeSizeInBits(IntTy);</Highlight></CodeLine>
<Link id="l04615" /><CodeLine lineNumber="4615"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04616" /><CodeLine lineNumber="4616"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Use a more targeted data structure.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04617" /><CodeLine lineNumber="4617"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> L = 0, LE = LU.Formulae.size(); L != LE; ++L) &#123;</Highlight></CodeLine>
<Link id="l04618" /><CodeLine lineNumber="4618"><Highlight kind="normal">      Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>&#93;;</Highlight></CodeLine>
<Link id="l04619" /><CodeLine lineNumber="4619"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// FIXME: The code for the scaled and unscaled registers looks</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04620" /><CodeLine lineNumber="4620"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// very similar but slightly different. Investigate if they</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04621" /><CodeLine lineNumber="4621"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// could be merged. That way, we would not have to unscale the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04622" /><CodeLine lineNumber="4622"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04623" /><CodeLine lineNumber="4623"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.unscale();</Highlight></CodeLine>
<Link id="l04624" /><CodeLine lineNumber="4624"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Use the immediate in the scaled register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04625" /><CodeLine lineNumber="4625"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg == OrigReg) &#123;</Highlight></CodeLine>
<Link id="l04626" /><CodeLine lineNumber="4626"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isCompatibleImmediate(Imm))</Highlight></CodeLine>
<Link id="l04627" /><CodeLine lineNumber="4627"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04628" /><CodeLine lineNumber="4628"><Highlight kind="normal">        Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.addUnsigned(<a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a>.mulUnsigned(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale));</Highlight></CodeLine>
<Link id="l04629" /><CodeLine lineNumber="4629"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Don&#39;t create 50 + reg(-50).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04630" /><CodeLine lineNumber="4630"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getNegativeSCEV(SE, IntTy);</Highlight></CodeLine>
<Link id="l04631" /><CodeLine lineNumber="4631"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.referencesReg(S))</Highlight></CodeLine>
<Link id="l04632" /><CodeLine lineNumber="4632"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04633" /><CodeLine lineNumber="4633"><Highlight kind="normal">        Formula NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</Highlight></CodeLine>
<Link id="l04634" /><CodeLine lineNumber="4634"><Highlight kind="normal">        NewF.BaseOffset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</Highlight></CodeLine>
<Link id="l04635" /><CodeLine lineNumber="4635"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy,</Highlight></CodeLine>
<Link id="l04636" /><CodeLine lineNumber="4636"><Highlight kind="normal">                        NewF))</Highlight></CodeLine>
<Link id="l04637" /><CodeLine lineNumber="4637"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04638" /><CodeLine lineNumber="4638"><Highlight kind="normal">        NewF.ScaledReg = SE.getAddExpr(NegImmS, NewF.ScaledReg);</Highlight></CodeLine>
<Link id="l04639" /><CodeLine lineNumber="4639"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04640" /><CodeLine lineNumber="4640"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// If the new scale is a constant in a register, and adding the constant</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04641" /><CodeLine lineNumber="4641"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// value to the immediate would produce a value closer to zero than the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04642" /><CodeLine lineNumber="4642"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// immediate itself, then the formula isn&#39;t worthwhile.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04643" /><CodeLine lineNumber="4643"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(NewF.ScaledReg)) &#123;</Highlight></CodeLine>
<Link id="l04644" /><CodeLine lineNumber="4644"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// FIXME: Do we need to do something for scalable immediates here?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04645" /><CodeLine lineNumber="4645"><Highlight kind="normal">          </Highlight><Highlight kind="comment">//        A scalable SCEV won&#39;t be constant, but we might still have</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04646" /><CodeLine lineNumber="4646"><Highlight kind="normal">          </Highlight><Highlight kind="comment">//        something in the offset? Bail out for now to be safe.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04647" /><CodeLine lineNumber="4647"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NewF.BaseOffset.isNonZero() &amp;&amp; NewF.BaseOffset.isScalable())</Highlight></CodeLine>
<Link id="l04648" /><CodeLine lineNumber="4648"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04649" /><CodeLine lineNumber="4649"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue()-&gt;isNegative() !=</Highlight></CodeLine>
<Link id="l04650" /><CodeLine lineNumber="4650"><Highlight kind="normal">                  (NewF.BaseOffset.isLessThanZero()) &amp;&amp;</Highlight></CodeLine>
<Link id="l04651" /><CodeLine lineNumber="4651"><Highlight kind="normal">              (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().abs() &#42; <a href="/docs/api/classes/llvm/apint">APInt</a>(<a href="/docs/api/namespaces/llvm/#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale))</Highlight></CodeLine>
<Link id="l04652" /><CodeLine lineNumber="4652"><Highlight kind="normal">                  .ule(std::abs(NewF.BaseOffset.getFixedValue())))</Highlight></CodeLine>
<Link id="l04653" /><CodeLine lineNumber="4653"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04654" /><CodeLine lineNumber="4654"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l04655" /><CodeLine lineNumber="4655"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04656" /><CodeLine lineNumber="4656"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// OK, looks good.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04657" /><CodeLine lineNumber="4657"><Highlight kind="normal">        NewF.canonicalize(&#42;this-&gt;L);</Highlight></CodeLine>
<Link id="l04658" /><CodeLine lineNumber="4658"><Highlight kind="normal">        (void)InsertFormula(LU, LUIdx, NewF);</Highlight></CodeLine>
<Link id="l04659" /><CodeLine lineNumber="4659"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l04660" /><CodeLine lineNumber="4660"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Use the immediate in a base register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04661" /><CodeLine lineNumber="4661"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = 0, NE = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.size(); <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> != NE; ++<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>) &#123;</Highlight></CodeLine>
<Link id="l04662" /><CodeLine lineNumber="4662"><Highlight kind="normal">          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>&#93;;</Highlight></CodeLine>
<Link id="l04663" /><CodeLine lineNumber="4663"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaseReg != OrigReg)</Highlight></CodeLine>
<Link id="l04664" /><CodeLine lineNumber="4664"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04665" /><CodeLine lineNumber="4665"><Highlight kind="normal">          Formula NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</Highlight></CodeLine>
<Link id="l04666" /><CodeLine lineNumber="4666"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!NewF.BaseOffset.isCompatibleImmediate(Imm) ||</Highlight></CodeLine>
<Link id="l04667" /><CodeLine lineNumber="4667"><Highlight kind="normal">              !NewF.UnfoldedOffset.isCompatibleImmediate(Imm) ||</Highlight></CodeLine>
<Link id="l04668" /><CodeLine lineNumber="4668"><Highlight kind="normal">              !NewF.BaseOffset.isCompatibleImmediate(NewF.UnfoldedOffset))</Highlight></CodeLine>
<Link id="l04669" /><CodeLine lineNumber="4669"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04670" /><CodeLine lineNumber="4670"><Highlight kind="normal">          NewF.BaseOffset = NewF.BaseOffset.addUnsigned(Imm);</Highlight></CodeLine>
<Link id="l04671" /><CodeLine lineNumber="4671"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset,</Highlight></CodeLine>
<Link id="l04672" /><CodeLine lineNumber="4672"><Highlight kind="normal">                          LU.Kind, LU.AccessTy, NewF)) &#123;</Highlight></CodeLine>
<Link id="l04673" /><CodeLine lineNumber="4673"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l04674" /><CodeLine lineNumber="4674"><Highlight kind="normal">                <a href="#a187751c86d349fac41ddc1b807b40b22">mayUsePostIncMode</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU, OrigReg, this-&gt;L, SE))</Highlight></CodeLine>
<Link id="l04675" /><CodeLine lineNumber="4675"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04676" /><CodeLine lineNumber="4676"><Highlight kind="normal">            Immediate NewUnfoldedOffset = NewF.UnfoldedOffset.addUnsigned(Imm);</Highlight></CodeLine>
<Link id="l04677" /><CodeLine lineNumber="4677"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a52f2bc4870549427a397721a7de9849f">isLegalAddImmediate</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, NewUnfoldedOffset))</Highlight></CodeLine>
<Link id="l04678" /><CodeLine lineNumber="4678"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04679" /><CodeLine lineNumber="4679"><Highlight kind="normal">            NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</Highlight></CodeLine>
<Link id="l04680" /><CodeLine lineNumber="4680"><Highlight kind="normal">            NewF.UnfoldedOffset = NewUnfoldedOffset;</Highlight></CodeLine>
<Link id="l04681" /><CodeLine lineNumber="4681"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l04682" /><CodeLine lineNumber="4682"><Highlight kind="normal">          NewF.BaseRegs&#91;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>&#93; = SE.getAddExpr(NegImmS, BaseReg);</Highlight></CodeLine>
<Link id="l04683" /><CodeLine lineNumber="4683"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04684" /><CodeLine lineNumber="4684"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// If the new formula has a constant in a register, and adding the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04685" /><CodeLine lineNumber="4685"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// constant value to the immediate would produce a value closer to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04686" /><CodeLine lineNumber="4686"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// zero than the immediate itself, then the formula isn&#39;t worthwhile.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04687" /><CodeLine lineNumber="4687"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewReg : NewF.BaseRegs)</Highlight></CodeLine>
<Link id="l04688" /><CodeLine lineNumber="4688"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(NewReg)) &#123;</Highlight></CodeLine>
<Link id="l04689" /><CodeLine lineNumber="4689"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NewF.BaseOffset.isNonZero() &amp;&amp; NewF.BaseOffset.isScalable())</Highlight></CodeLine>
<Link id="l04690" /><CodeLine lineNumber="4690"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">goto</Highlight><Highlight kind="normal"> skip&#95;formula;</Highlight></CodeLine>
<Link id="l04691" /><CodeLine lineNumber="4691"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt() + NewF.BaseOffset.getFixedValue())</Highlight></CodeLine>
<Link id="l04692" /><CodeLine lineNumber="4692"><Highlight kind="normal">                      .abs()</Highlight></CodeLine>
<Link id="l04693" /><CodeLine lineNumber="4693"><Highlight kind="normal">                      .slt(std::abs(NewF.BaseOffset.getFixedValue())) &amp;&amp;</Highlight></CodeLine>
<Link id="l04694" /><CodeLine lineNumber="4694"><Highlight kind="normal">                  (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt() + NewF.BaseOffset.getFixedValue())</Highlight></CodeLine>
<Link id="l04695" /><CodeLine lineNumber="4695"><Highlight kind="normal">                          .countr&#95;zero() &gt;=</Highlight></CodeLine>
<Link id="l04696" /><CodeLine lineNumber="4696"><Highlight kind="normal">                      (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal">)<a href="/docs/api/namespaces/llvm/#a57d2f9ee99e9e68cff564d0d579c8163">llvm::countr&#95;zero&lt;uint64&#95;t&gt;</a>(</Highlight></CodeLine>
<Link id="l04697" /><CodeLine lineNumber="4697"><Highlight kind="normal">                          NewF.BaseOffset.getFixedValue()))</Highlight></CodeLine>
<Link id="l04698" /><CodeLine lineNumber="4698"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">goto</Highlight><Highlight kind="normal"> skip&#95;formula;</Highlight></CodeLine>
<Link id="l04699" /><CodeLine lineNumber="4699"><Highlight kind="normal">            &#125;</Highlight></CodeLine>
<Link id="l04700" /><CodeLine lineNumber="4700"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04701" /><CodeLine lineNumber="4701"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// Ok, looks good.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04702" /><CodeLine lineNumber="4702"><Highlight kind="normal">          NewF.canonicalize(&#42;this-&gt;L);</Highlight></CodeLine>
<Link id="l04703" /><CodeLine lineNumber="4703"><Highlight kind="normal">          (void)InsertFormula(LU, LUIdx, NewF);</Highlight></CodeLine>
<Link id="l04704" /><CodeLine lineNumber="4704"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04705" /><CodeLine lineNumber="4705"><Highlight kind="normal">        skip&#95;formula:;</Highlight></CodeLine>
<Link id="l04706" /><CodeLine lineNumber="4706"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l04707" /><CodeLine lineNumber="4707"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04708" /><CodeLine lineNumber="4708"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04709" /><CodeLine lineNumber="4709"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04710" /><CodeLine lineNumber="4710"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04711" /><CodeLine lineNumber="4711"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04712" /><CodeLine lineNumber="4712"><Highlight kind="comment">/// Generate formulae for each use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04713" /><CodeLine lineNumber="4713"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04714" /><CodeLine lineNumber="4714"><Highlight kind="normal">LSRInstance::GenerateAllReuseFormulae() &#123;</Highlight></CodeLine>
<Link id="l04715" /><CodeLine lineNumber="4715"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This is split into multiple loops so that hasRegsUsedByUsesOtherThan</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04716" /><CodeLine lineNumber="4716"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// queries are more precise.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04717" /><CodeLine lineNumber="4717"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l04718" /><CodeLine lineNumber="4718"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l04719" /><CodeLine lineNumber="4719"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, f = LU.Formulae.size(); i != f; ++i)</Highlight></CodeLine>
<Link id="l04720" /><CodeLine lineNumber="4720"><Highlight kind="normal">      GenerateReassociations(LU, LUIdx, LU.Formulae&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04721" /><CodeLine lineNumber="4721"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, f = LU.Formulae.size(); i != f; ++i)</Highlight></CodeLine>
<Link id="l04722" /><CodeLine lineNumber="4722"><Highlight kind="normal">      GenerateCombinations(LU, LUIdx, LU.Formulae&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04723" /><CodeLine lineNumber="4723"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04724" /><CodeLine lineNumber="4724"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l04725" /><CodeLine lineNumber="4725"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l04726" /><CodeLine lineNumber="4726"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, f = LU.Formulae.size(); i != f; ++i)</Highlight></CodeLine>
<Link id="l04727" /><CodeLine lineNumber="4727"><Highlight kind="normal">      GenerateSymbolicOffsets(LU, LUIdx, LU.Formulae&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04728" /><CodeLine lineNumber="4728"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, f = LU.Formulae.size(); i != f; ++i)</Highlight></CodeLine>
<Link id="l04729" /><CodeLine lineNumber="4729"><Highlight kind="normal">      GenerateConstantOffsets(LU, LUIdx, LU.Formulae&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04730" /><CodeLine lineNumber="4730"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, f = LU.Formulae.size(); i != f; ++i)</Highlight></CodeLine>
<Link id="l04731" /><CodeLine lineNumber="4731"><Highlight kind="normal">      GenerateICmpZeroScales(LU, LUIdx, LU.Formulae&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04732" /><CodeLine lineNumber="4732"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, f = LU.Formulae.size(); i != f; ++i)</Highlight></CodeLine>
<Link id="l04733" /><CodeLine lineNumber="4733"><Highlight kind="normal">      GenerateScales(LU, LUIdx, LU.Formulae&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04734" /><CodeLine lineNumber="4734"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04735" /><CodeLine lineNumber="4735"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l04736" /><CodeLine lineNumber="4736"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l04737" /><CodeLine lineNumber="4737"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, f = LU.Formulae.size(); i != f; ++i)</Highlight></CodeLine>
<Link id="l04738" /><CodeLine lineNumber="4738"><Highlight kind="normal">      GenerateTruncates(LU, LUIdx, LU.Formulae&#91;i&#93;);</Highlight></CodeLine>
<Link id="l04739" /><CodeLine lineNumber="4739"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04740" /><CodeLine lineNumber="4740"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04741" /><CodeLine lineNumber="4741"><Highlight kind="normal">  GenerateCrossUseConstantOffsets();</Highlight></CodeLine>
<Link id="l04742" /><CodeLine lineNumber="4742"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04743" /><CodeLine lineNumber="4743"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04744" /><CodeLine lineNumber="4744"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;After generating reuse formulae:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04745" /><CodeLine lineNumber="4745"><Highlight kind="normal">             print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l04746" /><CodeLine lineNumber="4746"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04747" /><CodeLine lineNumber="4747"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04748" /><CodeLine lineNumber="4748"><Highlight kind="comment">/// If there are multiple formulae with the same set of registers used</Highlight></CodeLine>
<Link id="l04749" /><CodeLine lineNumber="4749"><Highlight kind="comment">/// by other uses, pick the best one and delete the others.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04750" /><CodeLine lineNumber="4750"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::FilterOutUndesirableDedicatedRegisters() &#123;</Highlight></CodeLine>
<Link id="l04751" /><CodeLine lineNumber="4751"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> VisitedRegs;</Highlight></CodeLine>
<Link id="l04752" /><CodeLine lineNumber="4752"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> Regs;</Highlight></CodeLine>
<Link id="l04753" /><CodeLine lineNumber="4753"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> LoserRegs;</Highlight></CodeLine>
<Link id="l04754" /><CodeLine lineNumber="4754"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04755" /><CodeLine lineNumber="4755"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> ChangedFormulae = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04756" /><CodeLine lineNumber="4756"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04757" /><CodeLine lineNumber="4757"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04758" /><CodeLine lineNumber="4758"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Collect the best formula for each unique set of shared registers. This</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04759" /><CodeLine lineNumber="4759"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// is reset for each use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04760" /><CodeLine lineNumber="4760"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal">BestFormulaeTy =</Highlight></CodeLine>
<Link id="l04761" /><CodeLine lineNumber="4761"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;SmallVector&lt;const SCEV &#42;, 4&gt;</a>, size&#95;t, UniquifierDenseMapInfo&gt;;</Highlight></CodeLine>
<Link id="l04762" /><CodeLine lineNumber="4762"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04763" /><CodeLine lineNumber="4763"><Highlight kind="normal">  BestFormulaeTy BestFormulae;</Highlight></CodeLine>
<Link id="l04764" /><CodeLine lineNumber="4764"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04765" /><CodeLine lineNumber="4765"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l04766" /><CodeLine lineNumber="4766"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l04767" /><CodeLine lineNumber="4767"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Filtering for use &quot;</Highlight><Highlight kind="normal">; LU.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l04768" /><CodeLine lineNumber="4768"><Highlight kind="normal">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04769" /><CodeLine lineNumber="4769"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04770" /><CodeLine lineNumber="4770"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04771" /><CodeLine lineNumber="4771"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> FIdx = 0, NumForms = LU.Formulae.size();</Highlight></CodeLine>
<Link id="l04772" /><CodeLine lineNumber="4772"><Highlight kind="normal">         FIdx != NumForms; ++FIdx) &#123;</Highlight></CodeLine>
<Link id="l04773" /><CodeLine lineNumber="4773"><Highlight kind="normal">      Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;FIdx&#93;;</Highlight></CodeLine>
<Link id="l04774" /><CodeLine lineNumber="4774"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04775" /><CodeLine lineNumber="4775"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Some formulas are instant losers. For example, they may depend on</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04776" /><CodeLine lineNumber="4776"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// nonexistent AddRecs from other loops. These need to be filtered</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04777" /><CodeLine lineNumber="4777"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// immediately, otherwise heuristics could choose them over others leading</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04778" /><CodeLine lineNumber="4778"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// to an unsatisfactory solution. Passing LoserRegs into RateFormula here</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04779" /><CodeLine lineNumber="4779"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// avoids the need to recompute this information across formulae using the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04780" /><CodeLine lineNumber="4780"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// same bad AddRec. Passing LoserRegs is also essential unless we remove</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04781" /><CodeLine lineNumber="4781"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// the corresponding bad register from the Regs set.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04782" /><CodeLine lineNumber="4782"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CostF(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</Highlight></CodeLine>
<Link id="l04783" /><CodeLine lineNumber="4783"><Highlight kind="normal">      Regs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</Highlight></CodeLine>
<Link id="l04784" /><CodeLine lineNumber="4784"><Highlight kind="normal">      CostF.RateFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Regs, VisitedRegs, LU, &amp;LoserRegs);</Highlight></CodeLine>
<Link id="l04785" /><CodeLine lineNumber="4785"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CostF.isLoser()) &#123;</Highlight></CodeLine>
<Link id="l04786" /><CodeLine lineNumber="4786"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// During initial formula generation, undesirable formulae are generated</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04787" /><CodeLine lineNumber="4787"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// by uses within other loops that have some non-trivial address mode or</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04788" /><CodeLine lineNumber="4788"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// use the postinc form of the IV. LSR needs to provide these formulae</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04789" /><CodeLine lineNumber="4789"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// as the basis of rediscovering the desired formula that uses an AddRec</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04790" /><CodeLine lineNumber="4790"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// corresponding to the existing phi. Once all formulae have been</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04791" /><CodeLine lineNumber="4791"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// generated, these initial losers may be pruned.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04792" /><CodeLine lineNumber="4792"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Filtering loser &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l04793" /><CodeLine lineNumber="4793"><Highlight kind="normal">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04794" /><CodeLine lineNumber="4794"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04795" /><CodeLine lineNumber="4795"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l04796" /><CodeLine lineNumber="4796"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>;</Highlight></CodeLine>
<Link id="l04797" /><CodeLine lineNumber="4797"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</Highlight></CodeLine>
<Link id="l04798" /><CodeLine lineNumber="4798"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (RegUses.isRegUsedByUsesOtherThan(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, LUIdx))</Highlight></CodeLine>
<Link id="l04799" /><CodeLine lineNumber="4799"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>.push&#95;back(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</Highlight></CodeLine>
<Link id="l04800" /><CodeLine lineNumber="4800"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l04801" /><CodeLine lineNumber="4801"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg &amp;&amp;</Highlight></CodeLine>
<Link id="l04802" /><CodeLine lineNumber="4802"><Highlight kind="normal">            RegUses.isRegUsedByUsesOtherThan(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, LUIdx))</Highlight></CodeLine>
<Link id="l04803" /><CodeLine lineNumber="4803"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>.push&#95;back(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</Highlight></CodeLine>
<Link id="l04804" /><CodeLine lineNumber="4804"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Unstable sort by host order ok, because this is only used for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04805" /><CodeLine lineNumber="4805"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// uniquifying.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04806" /><CodeLine lineNumber="4806"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>);</Highlight></CodeLine>
<Link id="l04807" /><CodeLine lineNumber="4807"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04808" /><CodeLine lineNumber="4808"><Highlight kind="normal">        std::pair&lt;BestFormulaeTy::const&#95;iterator, bool&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> =</Highlight></CodeLine>
<Link id="l04809" /><CodeLine lineNumber="4809"><Highlight kind="normal">          BestFormulae.insert(std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>, FIdx));</Highlight></CodeLine>
<Link id="l04810" /><CodeLine lineNumber="4810"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second)</Highlight></CodeLine>
<Link id="l04811" /><CodeLine lineNumber="4811"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04812" /><CodeLine lineNumber="4812"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04813" /><CodeLine lineNumber="4813"><Highlight kind="normal">        Formula &amp;Best = LU.Formulae&#91;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;second&#93;;</Highlight></CodeLine>
<Link id="l04814" /><CodeLine lineNumber="4814"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04815" /><CodeLine lineNumber="4815"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CostBest(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</Highlight></CodeLine>
<Link id="l04816" /><CodeLine lineNumber="4816"><Highlight kind="normal">        Regs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</Highlight></CodeLine>
<Link id="l04817" /><CodeLine lineNumber="4817"><Highlight kind="normal">        CostBest.RateFormula(Best, Regs, VisitedRegs, LU);</Highlight></CodeLine>
<Link id="l04818" /><CodeLine lineNumber="4818"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (CostF.isLess(CostBest))</Highlight></CodeLine>
<Link id="l04819" /><CodeLine lineNumber="4819"><Highlight kind="normal">          <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Best);</Highlight></CodeLine>
<Link id="l04820" /><CodeLine lineNumber="4820"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Filtering out formula &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l04821" /><CodeLine lineNumber="4821"><Highlight kind="normal">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04822" /><CodeLine lineNumber="4822"><Highlight kind="normal">                             </Highlight><Highlight kind="stringliteral">&quot;    in favor of formula &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04823" /><CodeLine lineNumber="4823"><Highlight kind="normal">                   Best.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04824" /><CodeLine lineNumber="4824"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04825" /><CodeLine lineNumber="4825"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04826" /><CodeLine lineNumber="4826"><Highlight kind="normal">      ChangedFormulae = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04827" /><CodeLine lineNumber="4827"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04828" /><CodeLine lineNumber="4828"><Highlight kind="normal">      LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04829" /><CodeLine lineNumber="4829"><Highlight kind="normal">      --FIdx;</Highlight></CodeLine>
<Link id="l04830" /><CodeLine lineNumber="4830"><Highlight kind="normal">      --NumForms;</Highlight></CodeLine>
<Link id="l04831" /><CodeLine lineNumber="4831"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04832" /><CodeLine lineNumber="4832"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04833" /><CodeLine lineNumber="4833"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04834" /><CodeLine lineNumber="4834"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Now that we&#39;ve filtered out some formulae, recompute the Regs set.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04835" /><CodeLine lineNumber="4835"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/any">Any</a>)</Highlight></CodeLine>
<Link id="l04836" /><CodeLine lineNumber="4836"><Highlight kind="normal">      LU.RecomputeRegs(LUIdx, RegUses);</Highlight></CodeLine>
<Link id="l04837" /><CodeLine lineNumber="4837"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04838" /><CodeLine lineNumber="4838"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Reset this to prepare for the next use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04839" /><CodeLine lineNumber="4839"><Highlight kind="normal">    BestFormulae.clear();</Highlight></CodeLine>
<Link id="l04840" /><CodeLine lineNumber="4840"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04841" /><CodeLine lineNumber="4841"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04842" /><CodeLine lineNumber="4842"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ChangedFormulae) &#123;</Highlight></CodeLine>
<Link id="l04843" /><CodeLine lineNumber="4843"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04844" /><CodeLine lineNumber="4844"><Highlight kind="normal">              </Highlight><Highlight kind="stringliteral">&quot;After filtering out undesirable candidates:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04845" /><CodeLine lineNumber="4845"><Highlight kind="normal">    print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l04846" /><CodeLine lineNumber="4846"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l04847" /><CodeLine lineNumber="4847"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04848" /><CodeLine lineNumber="4848"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04849" /><CodeLine lineNumber="4849"><Highlight kind="comment">/// Estimate the worst-case number of solutions the solver might have to</Highlight></CodeLine>
<Link id="l04850" /><CodeLine lineNumber="4850"><Highlight kind="comment">/// consider. It almost never considers this many solutions because it prune the</Highlight></CodeLine>
<Link id="l04851" /><CodeLine lineNumber="4851"><Highlight kind="comment">/// search space, but the pruning isn&#39;t always sufficient.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04852" /><CodeLine lineNumber="4852"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LSRInstance::EstimateSearchSpaceComplexity()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l04853" /><CodeLine lineNumber="4853"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> Power = 1;</Highlight></CodeLine>
<Link id="l04854" /><CodeLine lineNumber="4854"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>) &#123;</Highlight></CodeLine>
<Link id="l04855" /><CodeLine lineNumber="4855"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> FSize = LU.Formulae.size();</Highlight></CodeLine>
<Link id="l04856" /><CodeLine lineNumber="4856"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FSize &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>) &#123;</Highlight></CodeLine>
<Link id="l04857" /><CodeLine lineNumber="4857"><Highlight kind="normal">      Power = <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>;</Highlight></CodeLine>
<Link id="l04858" /><CodeLine lineNumber="4858"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04859" /><CodeLine lineNumber="4859"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04860" /><CodeLine lineNumber="4860"><Highlight kind="normal">    Power &#42;= FSize;</Highlight></CodeLine>
<Link id="l04861" /><CodeLine lineNumber="4861"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Power &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</Highlight></CodeLine>
<Link id="l04862" /><CodeLine lineNumber="4862"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04863" /><CodeLine lineNumber="4863"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04864" /><CodeLine lineNumber="4864"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Power;</Highlight></CodeLine>
<Link id="l04865" /><CodeLine lineNumber="4865"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04866" /><CodeLine lineNumber="4866"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04867" /><CodeLine lineNumber="4867"><Highlight kind="comment">/// When one formula uses a superset of the registers of another formula, it</Highlight></CodeLine>
<Link id="l04868" /><CodeLine lineNumber="4868"><Highlight kind="comment">/// won&#39;t help reduce register pressure (though it may not necessarily hurt</Highlight></CodeLine>
<Link id="l04869" /><CodeLine lineNumber="4869"><Highlight kind="comment">/// register pressure); remove it to simplify the system.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04870" /><CodeLine lineNumber="4870"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::NarrowSearchSpaceByDetectingSupersets() &#123;</Highlight></CodeLine>
<Link id="l04871" /><CodeLine lineNumber="4871"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EstimateSearchSpaceComplexity() &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>) &#123;</Highlight></CodeLine>
<Link id="l04872" /><CodeLine lineNumber="4872"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;The search space is too complex.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04873" /><CodeLine lineNumber="4873"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04874" /><CodeLine lineNumber="4874"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Narrowing the search space by eliminating formulae &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04875" /><CodeLine lineNumber="4875"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;which use a superset of registers used by other &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04876" /><CodeLine lineNumber="4876"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;formulae.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04877" /><CodeLine lineNumber="4877"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04878" /><CodeLine lineNumber="4878"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l04879" /><CodeLine lineNumber="4879"><Highlight kind="normal">      LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l04880" /><CodeLine lineNumber="4880"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04881" /><CodeLine lineNumber="4881"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = LU.Formulae.size(); i != e; ++i) &#123;</Highlight></CodeLine>
<Link id="l04882" /><CodeLine lineNumber="4882"><Highlight kind="normal">        Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;i&#93;;</Highlight></CodeLine>
<Link id="l04883" /><CodeLine lineNumber="4883"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isNonZero() &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isScalable())</Highlight></CodeLine>
<Link id="l04884" /><CodeLine lineNumber="4884"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04885" /><CodeLine lineNumber="4885"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Look for a formula with a constant or GV in a register. If the use</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04886" /><CodeLine lineNumber="4886"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// also has a formula with that same value in an immediate field,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04887" /><CodeLine lineNumber="4887"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// delete the one that uses a register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04888" /><CodeLine lineNumber="4888"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/smallvectorimpl/#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;const SCEV &#42;&gt;::const&#95;iterator</a></Highlight></CodeLine>
<Link id="l04889" /><CodeLine lineNumber="4889"><Highlight kind="normal">             <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin(), <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.end(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l04890" /><CodeLine lineNumber="4890"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &#123;</Highlight></CodeLine>
<Link id="l04891" /><CodeLine lineNumber="4891"><Highlight kind="normal">            Formula NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</Highlight></CodeLine>
<Link id="l04892" /><CodeLine lineNumber="4892"><Highlight kind="normal">            </Highlight><Highlight kind="comment">//FIXME: Formulas should store bitwidth to do wrapping properly.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04893" /><CodeLine lineNumber="4893"><Highlight kind="normal">            </Highlight><Highlight kind="comment">//       See PR41034.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04894" /><CodeLine lineNumber="4894"><Highlight kind="normal">            NewF.BaseOffset =</Highlight></CodeLine>
<Link id="l04895" /><CodeLine lineNumber="4895"><Highlight kind="normal">                <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(NewF.BaseOffset.getFixedValue() +</Highlight></CodeLine>
<Link id="l04896" /><CodeLine lineNumber="4896"><Highlight kind="normal">                                    (uint64&#95;t)<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue()-&gt;getSExtValue());</Highlight></CodeLine>
<Link id="l04897" /><CodeLine lineNumber="4897"><Highlight kind="normal">            NewF.BaseRegs.erase(NewF.BaseRegs.begin() +</Highlight></CodeLine>
<Link id="l04898" /><CodeLine lineNumber="4898"><Highlight kind="normal">                                (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> - <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin()));</Highlight></CodeLine>
<Link id="l04899" /><CodeLine lineNumber="4899"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.HasFormulaWithSameRegs(NewF)) &#123;</Highlight></CodeLine>
<Link id="l04900" /><CodeLine lineNumber="4900"><Highlight kind="normal">              <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Deleting &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l04901" /><CodeLine lineNumber="4901"><Highlight kind="normal">                         <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04902" /><CodeLine lineNumber="4902"><Highlight kind="normal">              LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04903" /><CodeLine lineNumber="4903"><Highlight kind="normal">              --i;</Highlight></CodeLine>
<Link id="l04904" /><CodeLine lineNumber="4904"><Highlight kind="normal">              --<a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a>;</Highlight></CodeLine>
<Link id="l04905" /><CodeLine lineNumber="4905"><Highlight kind="normal">              <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04906" /><CodeLine lineNumber="4906"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04907" /><CodeLine lineNumber="4907"><Highlight kind="normal">            &#125;</Highlight></CodeLine>
<Link id="l04908" /><CodeLine lineNumber="4908"><Highlight kind="normal">          &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &#123;</Highlight></CodeLine>
<Link id="l04909" /><CodeLine lineNumber="4909"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;GV = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;GlobalValue&gt;</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>-&gt;getValue()))</Highlight></CodeLine>
<Link id="l04910" /><CodeLine lineNumber="4910"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV) &#123;</Highlight></CodeLine>
<Link id="l04911" /><CodeLine lineNumber="4911"><Highlight kind="normal">                Formula NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</Highlight></CodeLine>
<Link id="l04912" /><CodeLine lineNumber="4912"><Highlight kind="normal">                NewF.BaseGV = GV;</Highlight></CodeLine>
<Link id="l04913" /><CodeLine lineNumber="4913"><Highlight kind="normal">                NewF.BaseRegs.erase(NewF.BaseRegs.begin() +</Highlight></CodeLine>
<Link id="l04914" /><CodeLine lineNumber="4914"><Highlight kind="normal">                                    (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> - <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin()));</Highlight></CodeLine>
<Link id="l04915" /><CodeLine lineNumber="4915"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.HasFormulaWithSameRegs(NewF)) &#123;</Highlight></CodeLine>
<Link id="l04916" /><CodeLine lineNumber="4916"><Highlight kind="normal">                  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Deleting &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l04917" /><CodeLine lineNumber="4917"><Highlight kind="normal">                             <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04918" /><CodeLine lineNumber="4918"><Highlight kind="normal">                  LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04919" /><CodeLine lineNumber="4919"><Highlight kind="normal">                  --i;</Highlight></CodeLine>
<Link id="l04920" /><CodeLine lineNumber="4920"><Highlight kind="normal">                  --<a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a>;</Highlight></CodeLine>
<Link id="l04921" /><CodeLine lineNumber="4921"><Highlight kind="normal">                  <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04922" /><CodeLine lineNumber="4922"><Highlight kind="normal">                  </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04923" /><CodeLine lineNumber="4923"><Highlight kind="normal">                &#125;</Highlight></CodeLine>
<Link id="l04924" /><CodeLine lineNumber="4924"><Highlight kind="normal">              &#125;</Highlight></CodeLine>
<Link id="l04925" /><CodeLine lineNumber="4925"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l04926" /><CodeLine lineNumber="4926"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l04927" /><CodeLine lineNumber="4927"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04928" /><CodeLine lineNumber="4928"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/any">Any</a>)</Highlight></CodeLine>
<Link id="l04929" /><CodeLine lineNumber="4929"><Highlight kind="normal">        LU.RecomputeRegs(LUIdx, RegUses);</Highlight></CodeLine>
<Link id="l04930" /><CodeLine lineNumber="4930"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04931" /><CodeLine lineNumber="4931"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04932" /><CodeLine lineNumber="4932"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After pre-selection:\\n&quot;</Highlight><Highlight kind="normal">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l04933" /><CodeLine lineNumber="4933"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04934" /><CodeLine lineNumber="4934"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l04935" /><CodeLine lineNumber="4935"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l04936" /><CodeLine lineNumber="4936"><Highlight kind="comment">/// When there are many registers for expressions like A, A+1, A+2, etc.,</Highlight></CodeLine>
<Link id="l04937" /><CodeLine lineNumber="4937"><Highlight kind="comment">/// allocate a single register for them.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04938" /><CodeLine lineNumber="4938"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::NarrowSearchSpaceByCollapsingUnrolledCode() &#123;</Highlight></CodeLine>
<Link id="l04939" /><CodeLine lineNumber="4939"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</Highlight></CodeLine>
<Link id="l04940" /><CodeLine lineNumber="4940"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04941" /><CodeLine lineNumber="4941"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04942" /><CodeLine lineNumber="4942"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</Highlight></CodeLine>
<Link id="l04943" /><CodeLine lineNumber="4943"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;The search space is too complex.\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04944" /><CodeLine lineNumber="4944"><Highlight kind="normal">                </Highlight><Highlight kind="stringliteral">&quot;Narrowing the search space by assuming that uses separated &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04945" /><CodeLine lineNumber="4945"><Highlight kind="normal">                </Highlight><Highlight kind="stringliteral">&quot;by a constant offset will use the same registers.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04946" /><CodeLine lineNumber="4946"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04947" /><CodeLine lineNumber="4947"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This is especially useful for unrolled loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04948" /><CodeLine lineNumber="4948"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04949" /><CodeLine lineNumber="4949"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l04950" /><CodeLine lineNumber="4950"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l04951" /><CodeLine lineNumber="4951"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae) &#123;</Highlight></CodeLine>
<Link id="l04952" /><CodeLine lineNumber="4952"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isZero() || (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 0 &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 1))</Highlight></CodeLine>
<Link id="l04953" /><CodeLine lineNumber="4953"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04954" /><CodeLine lineNumber="4954"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04955" /><CodeLine lineNumber="4955"><Highlight kind="normal">      LSRUse &#42;LUThatHas = FindUseWithSimilarFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, LU);</Highlight></CodeLine>
<Link id="l04956" /><CodeLine lineNumber="4956"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LUThatHas)</Highlight></CodeLine>
<Link id="l04957" /><CodeLine lineNumber="4957"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04958" /><CodeLine lineNumber="4958"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04959" /><CodeLine lineNumber="4959"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!reconcileNewOffset(&#42;LUThatHas, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset, </Highlight><Highlight kind="comment">/&#42;HasBaseReg=&#42;/</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l04960" /><CodeLine lineNumber="4960"><Highlight kind="normal">                              LU.Kind, LU.AccessTy))</Highlight></CodeLine>
<Link id="l04961" /><CodeLine lineNumber="4961"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04962" /><CodeLine lineNumber="4962"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04963" /><CodeLine lineNumber="4963"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Deleting use &quot;</Highlight><Highlight kind="normal">; LU.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04964" /><CodeLine lineNumber="4964"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04965" /><CodeLine lineNumber="4965"><Highlight kind="normal">      LUThatHas-&gt;AllFixupsOutsideLoop &amp;= LU.AllFixupsOutsideLoop;</Highlight></CodeLine>
<Link id="l04966" /><CodeLine lineNumber="4966"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04967" /><CodeLine lineNumber="4967"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Transfer the fixups of LU to LUThatHas.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04968" /><CodeLine lineNumber="4968"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : LU.Fixups) &#123;</Highlight></CodeLine>
<Link id="l04969" /><CodeLine lineNumber="4969"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset += <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset;</Highlight></CodeLine>
<Link id="l04970" /><CodeLine lineNumber="4970"><Highlight kind="normal">        LUThatHas-&gt;pushFixup(<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>);</Highlight></CodeLine>
<Link id="l04971" /><CodeLine lineNumber="4971"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;New fixup has offset &quot;</Highlight><Highlight kind="normal"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04972" /><CodeLine lineNumber="4972"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04973" /><CodeLine lineNumber="4973"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04974" /><CodeLine lineNumber="4974"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Delete formulae from the new use which are no longer legal.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04975" /><CodeLine lineNumber="4975"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04976" /><CodeLine lineNumber="4976"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = LUThatHas-&gt;Formulae.size(); i != e; ++i) &#123;</Highlight></CodeLine>
<Link id="l04977" /><CodeLine lineNumber="4977"><Highlight kind="normal">        Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LUThatHas-&gt;Formulae&#91;i&#93;;</Highlight></CodeLine>
<Link id="l04978" /><CodeLine lineNumber="4978"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LUThatHas-&gt;MinOffset, LUThatHas-&gt;MaxOffset,</Highlight></CodeLine>
<Link id="l04979" /><CodeLine lineNumber="4979"><Highlight kind="normal">                        LUThatHas-&gt;Kind, LUThatHas-&gt;AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) &#123;</Highlight></CodeLine>
<Link id="l04980" /><CodeLine lineNumber="4980"><Highlight kind="normal">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Deleting &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l04981" /><CodeLine lineNumber="4981"><Highlight kind="normal">          LUThatHas-&gt;DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l04982" /><CodeLine lineNumber="4982"><Highlight kind="normal">          --i;</Highlight></CodeLine>
<Link id="l04983" /><CodeLine lineNumber="4983"><Highlight kind="normal">          --<a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a>;</Highlight></CodeLine>
<Link id="l04984" /><CodeLine lineNumber="4984"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04985" /><CodeLine lineNumber="4985"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l04986" /><CodeLine lineNumber="4986"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l04987" /><CodeLine lineNumber="4987"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04988" /><CodeLine lineNumber="4988"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/any">Any</a>)</Highlight></CodeLine>
<Link id="l04989" /><CodeLine lineNumber="4989"><Highlight kind="normal">        LUThatHas-&gt;RecomputeRegs(LUThatHas - &amp;<a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.front(), RegUses);</Highlight></CodeLine>
<Link id="l04990" /><CodeLine lineNumber="4990"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04991" /><CodeLine lineNumber="4991"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Delete the old use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04992" /><CodeLine lineNumber="4992"><Highlight kind="normal">      DeleteUse(LU, LUIdx);</Highlight></CodeLine>
<Link id="l04993" /><CodeLine lineNumber="4993"><Highlight kind="normal">      --LUIdx;</Highlight></CodeLine>
<Link id="l04994" /><CodeLine lineNumber="4994"><Highlight kind="normal">      --NumUses;</Highlight></CodeLine>
<Link id="l04995" /><CodeLine lineNumber="4995"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l04996" /><CodeLine lineNumber="4996"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l04997" /><CodeLine lineNumber="4997"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l04998" /><CodeLine lineNumber="4998"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l04999" /><CodeLine lineNumber="4999"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After pre-selection:\\n&quot;</Highlight><Highlight kind="normal">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l05000" /><CodeLine lineNumber="5000"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05001" /><CodeLine lineNumber="5001"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05002" /><CodeLine lineNumber="5002"><Highlight kind="comment">/// Call FilterOutUndesirableDedicatedRegisters again, if necessary, now that</Highlight></CodeLine>
<Link id="l05003" /><CodeLine lineNumber="5003"><Highlight kind="comment">/// we&#39;ve done more filtering, as it may be able to find more formulae to</Highlight></CodeLine>
<Link id="l05004" /><CodeLine lineNumber="5004"><Highlight kind="comment">/// eliminate.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05005" /><CodeLine lineNumber="5005"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::NarrowSearchSpaceByRefilteringUndesirableDedicatedRegisters()&#123;</Highlight></CodeLine>
<Link id="l05006" /><CodeLine lineNumber="5006"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EstimateSearchSpaceComplexity() &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>) &#123;</Highlight></CodeLine>
<Link id="l05007" /><CodeLine lineNumber="5007"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;The search space is too complex.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05008" /><CodeLine lineNumber="5008"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05009" /><CodeLine lineNumber="5009"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Narrowing the search space by re-filtering out &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05010" /><CodeLine lineNumber="5010"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;undesirable dedicated registers.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05011" /><CodeLine lineNumber="5011"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05012" /><CodeLine lineNumber="5012"><Highlight kind="normal">    FilterOutUndesirableDedicatedRegisters();</Highlight></CodeLine>
<Link id="l05013" /><CodeLine lineNumber="5013"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05014" /><CodeLine lineNumber="5014"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After pre-selection:\\n&quot;</Highlight><Highlight kind="normal">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l05015" /><CodeLine lineNumber="5015"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05016" /><CodeLine lineNumber="5016"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05017" /><CodeLine lineNumber="5017"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05018" /><CodeLine lineNumber="5018"><Highlight kind="comment">/// If a LSRUse has multiple formulae with the same ScaledReg and Scale.</Highlight></CodeLine>
<Link id="l05019" /><CodeLine lineNumber="5019"><Highlight kind="comment">/// Pick the best one and delete the others.</Highlight></CodeLine>
<Link id="l05020" /><CodeLine lineNumber="5020"><Highlight kind="comment">/// This narrowing heuristic is to keep as many formulae with different</Highlight></CodeLine>
<Link id="l05021" /><CodeLine lineNumber="5021"><Highlight kind="comment">/// Scale and ScaledReg pair as possible while narrowing the search space.</Highlight></CodeLine>
<Link id="l05022" /><CodeLine lineNumber="5022"><Highlight kind="comment">/// The benefit is that it is more likely to find out a better solution</Highlight></CodeLine>
<Link id="l05023" /><CodeLine lineNumber="5023"><Highlight kind="comment">/// from a formulae set with more Scale and ScaledReg variations than</Highlight></CodeLine>
<Link id="l05024" /><CodeLine lineNumber="5024"><Highlight kind="comment">/// a formulae set with the same Scale and ScaledReg. The picking winner</Highlight></CodeLine>
<Link id="l05025" /><CodeLine lineNumber="5025"><Highlight kind="comment">/// reg heuristic will often keep the formulae with the same Scale and</Highlight></CodeLine>
<Link id="l05026" /><CodeLine lineNumber="5026"><Highlight kind="comment">/// ScaledReg and filter others, and we want to avoid that if possible.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05027" /><CodeLine lineNumber="5027"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::NarrowSearchSpaceByFilterFormulaWithSameScaledReg() &#123;</Highlight></CodeLine>
<Link id="l05028" /><CodeLine lineNumber="5028"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</Highlight></CodeLine>
<Link id="l05029" /><CodeLine lineNumber="5029"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05030" /><CodeLine lineNumber="5030"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05031" /><CodeLine lineNumber="5031"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</Highlight></CodeLine>
<Link id="l05032" /><CodeLine lineNumber="5032"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;The search space is too complex.\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05033" /><CodeLine lineNumber="5033"><Highlight kind="normal">                </Highlight><Highlight kind="stringliteral">&quot;Narrowing the search space by choosing the best Formula &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05034" /><CodeLine lineNumber="5034"><Highlight kind="normal">                </Highlight><Highlight kind="stringliteral">&quot;from the Formulae with the same Scale and ScaledReg.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05035" /><CodeLine lineNumber="5035"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05036" /><CodeLine lineNumber="5036"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Map the &quot;Scale &#42; ScaledReg&quot; pair to the best formula of current LSRUse.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05037" /><CodeLine lineNumber="5037"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">using </Highlight><Highlight kind="normal">BestFormulaeTy = <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;std::pair&lt;const SCEV &#42;, int64&#95;t&gt;</a>, </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal">&gt;;</Highlight></CodeLine>
<Link id="l05038" /><CodeLine lineNumber="5038"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05039" /><CodeLine lineNumber="5039"><Highlight kind="normal">  BestFormulaeTy BestFormulae;</Highlight></CodeLine>
<Link id="l05040" /><CodeLine lineNumber="5040"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05041" /><CodeLine lineNumber="5041"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> ChangedFormulae = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05042" /><CodeLine lineNumber="5042"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05043" /><CodeLine lineNumber="5043"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> VisitedRegs;</Highlight></CodeLine>
<Link id="l05044" /><CodeLine lineNumber="5044"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> Regs;</Highlight></CodeLine>
<Link id="l05045" /><CodeLine lineNumber="5045"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05046" /><CodeLine lineNumber="5046"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l05047" /><CodeLine lineNumber="5047"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l05048" /><CodeLine lineNumber="5048"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Filtering for use &quot;</Highlight><Highlight kind="normal">; LU.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05049" /><CodeLine lineNumber="5049"><Highlight kind="normal">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05050" /><CodeLine lineNumber="5050"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05051" /><CodeLine lineNumber="5051"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Return true if Formula FA is better than Formula FB.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05052" /><CodeLine lineNumber="5052"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> IsBetterThan = &#91;&amp;&#93;(Formula &amp;FA, Formula &amp;FB) &#123;</Highlight></CodeLine>
<Link id="l05053" /><CodeLine lineNumber="5053"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// First we will try to choose the Formula with fewer new registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05054" /><CodeLine lineNumber="5054"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// For a register used by current Formula, the more the register is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05055" /><CodeLine lineNumber="5055"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// shared among LSRUses, the less we increase the register number</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05056" /><CodeLine lineNumber="5056"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// counter of the formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05057" /><CodeLine lineNumber="5057"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> FARegNum = 0;</Highlight></CodeLine>
<Link id="l05058" /><CodeLine lineNumber="5058"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : FA.BaseRegs) &#123;</Highlight></CodeLine>
<Link id="l05059" /><CodeLine lineNumber="5059"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</Highlight></CodeLine>
<Link id="l05060" /><CodeLine lineNumber="5060"><Highlight kind="normal">        FARegNum += (NumUses - UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#ae0307ad5c950df7f6fb56dc8326184ce">count</a>() + 1);</Highlight></CodeLine>
<Link id="l05061" /><CodeLine lineNumber="5061"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05062" /><CodeLine lineNumber="5062"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> FBRegNum = 0;</Highlight></CodeLine>
<Link id="l05063" /><CodeLine lineNumber="5063"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : FB.BaseRegs) &#123;</Highlight></CodeLine>
<Link id="l05064" /><CodeLine lineNumber="5064"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</Highlight></CodeLine>
<Link id="l05065" /><CodeLine lineNumber="5065"><Highlight kind="normal">        FBRegNum += (NumUses - UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#ae0307ad5c950df7f6fb56dc8326184ce">count</a>() + 1);</Highlight></CodeLine>
<Link id="l05066" /><CodeLine lineNumber="5066"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05067" /><CodeLine lineNumber="5067"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FARegNum != FBRegNum)</Highlight></CodeLine>
<Link id="l05068" /><CodeLine lineNumber="5068"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> FARegNum &lt; FBRegNum;</Highlight></CodeLine>
<Link id="l05069" /><CodeLine lineNumber="5069"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05070" /><CodeLine lineNumber="5070"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If the new register numbers are the same, choose the Formula with</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05071" /><CodeLine lineNumber="5071"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// less Cost.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05072" /><CodeLine lineNumber="5072"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CostFA(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</Highlight></CodeLine>
<Link id="l05073" /><CodeLine lineNumber="5073"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CostFB(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</Highlight></CodeLine>
<Link id="l05074" /><CodeLine lineNumber="5074"><Highlight kind="normal">      Regs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</Highlight></CodeLine>
<Link id="l05075" /><CodeLine lineNumber="5075"><Highlight kind="normal">      CostFA.RateFormula(FA, Regs, VisitedRegs, LU);</Highlight></CodeLine>
<Link id="l05076" /><CodeLine lineNumber="5076"><Highlight kind="normal">      Regs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</Highlight></CodeLine>
<Link id="l05077" /><CodeLine lineNumber="5077"><Highlight kind="normal">      CostFB.RateFormula(FB, Regs, VisitedRegs, LU);</Highlight></CodeLine>
<Link id="l05078" /><CodeLine lineNumber="5078"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> CostFA.isLess(CostFB);</Highlight></CodeLine>
<Link id="l05079" /><CodeLine lineNumber="5079"><Highlight kind="normal">    &#125;;</Highlight></CodeLine>
<Link id="l05080" /><CodeLine lineNumber="5080"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05081" /><CodeLine lineNumber="5081"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05082" /><CodeLine lineNumber="5082"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> FIdx = 0, NumForms = LU.Formulae.size(); FIdx != NumForms;</Highlight></CodeLine>
<Link id="l05083" /><CodeLine lineNumber="5083"><Highlight kind="normal">         ++FIdx) &#123;</Highlight></CodeLine>
<Link id="l05084" /><CodeLine lineNumber="5084"><Highlight kind="normal">      Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;FIdx&#93;;</Highlight></CodeLine>
<Link id="l05085" /><CodeLine lineNumber="5085"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg)</Highlight></CodeLine>
<Link id="l05086" /><CodeLine lineNumber="5086"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05087" /><CodeLine lineNumber="5087"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = BestFormulae.insert(&#123;&#123;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale&#125;, FIdx&#125;);</Highlight></CodeLine>
<Link id="l05088" /><CodeLine lineNumber="5088"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second)</Highlight></CodeLine>
<Link id="l05089" /><CodeLine lineNumber="5089"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05090" /><CodeLine lineNumber="5090"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05091" /><CodeLine lineNumber="5091"><Highlight kind="normal">      Formula &amp;Best = LU.Formulae&#91;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;second&#93;;</Highlight></CodeLine>
<Link id="l05092" /><CodeLine lineNumber="5092"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsBetterThan(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Best))</Highlight></CodeLine>
<Link id="l05093" /><CodeLine lineNumber="5093"><Highlight kind="normal">        <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Best);</Highlight></CodeLine>
<Link id="l05094" /><CodeLine lineNumber="5094"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Filtering out formula &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05095" /><CodeLine lineNumber="5095"><Highlight kind="normal">                 <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05096" /><CodeLine lineNumber="5096"><Highlight kind="normal">                           </Highlight><Highlight kind="stringliteral">&quot;    in favor of formula &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05097" /><CodeLine lineNumber="5097"><Highlight kind="normal">                 Best.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05098" /><CodeLine lineNumber="5098"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05099" /><CodeLine lineNumber="5099"><Highlight kind="normal">      ChangedFormulae = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05100" /><CodeLine lineNumber="5100"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05101" /><CodeLine lineNumber="5101"><Highlight kind="normal">      LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l05102" /><CodeLine lineNumber="5102"><Highlight kind="normal">      --FIdx;</Highlight></CodeLine>
<Link id="l05103" /><CodeLine lineNumber="5103"><Highlight kind="normal">      --NumForms;</Highlight></CodeLine>
<Link id="l05104" /><CodeLine lineNumber="5104"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05105" /><CodeLine lineNumber="5105"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05106" /><CodeLine lineNumber="5106"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/any">Any</a>)</Highlight></CodeLine>
<Link id="l05107" /><CodeLine lineNumber="5107"><Highlight kind="normal">      LU.RecomputeRegs(LUIdx, RegUses);</Highlight></CodeLine>
<Link id="l05108" /><CodeLine lineNumber="5108"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05109" /><CodeLine lineNumber="5109"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Reset this to prepare for the next use.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05110" /><CodeLine lineNumber="5110"><Highlight kind="normal">    BestFormulae.clear();</Highlight></CodeLine>
<Link id="l05111" /><CodeLine lineNumber="5111"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05112" /><CodeLine lineNumber="5112"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05113" /><CodeLine lineNumber="5113"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ChangedFormulae) &#123;</Highlight></CodeLine>
<Link id="l05114" /><CodeLine lineNumber="5114"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05115" /><CodeLine lineNumber="5115"><Highlight kind="normal">              </Highlight><Highlight kind="stringliteral">&quot;After filtering out undesirable candidates:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05116" /><CodeLine lineNumber="5116"><Highlight kind="normal">    print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05117" /><CodeLine lineNumber="5117"><Highlight kind="normal">  &#125;);</Highlight></CodeLine>
<Link id="l05118" /><CodeLine lineNumber="5118"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05119" /><CodeLine lineNumber="5119"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05120" /><CodeLine lineNumber="5120"><Highlight kind="comment">/// If we are over the complexity limit, filter out any post-inc prefering</Highlight></CodeLine>
<Link id="l05121" /><CodeLine lineNumber="5121"><Highlight kind="comment">/// variables to only post-inc values.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05122" /><CodeLine lineNumber="5122"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::NarrowSearchSpaceByFilterPostInc() &#123;</Highlight></CodeLine>
<Link id="l05123" /><CodeLine lineNumber="5123"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AMK != <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>)</Highlight></CodeLine>
<Link id="l05124" /><CodeLine lineNumber="5124"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05125" /><CodeLine lineNumber="5125"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</Highlight></CodeLine>
<Link id="l05126" /><CodeLine lineNumber="5126"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05127" /><CodeLine lineNumber="5127"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05128" /><CodeLine lineNumber="5128"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;The search space is too complex.\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05129" /><CodeLine lineNumber="5129"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;Narrowing the search space by choosing the lowest &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05130" /><CodeLine lineNumber="5130"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;register Formula for PostInc Uses.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05131" /><CodeLine lineNumber="5131"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05132" /><CodeLine lineNumber="5132"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l05133" /><CodeLine lineNumber="5133"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l05134" /><CodeLine lineNumber="5134"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05135" /><CodeLine lineNumber="5135"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>)</Highlight></CodeLine>
<Link id="l05136" /><CodeLine lineNumber="5136"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05137" /><CodeLine lineNumber="5137"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedLoadLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, LU.AccessTy.getType()) &amp;&amp;</Highlight></CodeLine>
<Link id="l05138" /><CodeLine lineNumber="5138"><Highlight kind="normal">        !<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedStoreLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, LU.AccessTy.getType()))</Highlight></CodeLine>
<Link id="l05139" /><CodeLine lineNumber="5139"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05140" /><CodeLine lineNumber="5140"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05141" /><CodeLine lineNumber="5141"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> MinRegs = std::numeric&#95;limits&lt;size&#95;t&gt;::max();</Highlight></CodeLine>
<Link id="l05142" /><CodeLine lineNumber="5142"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae)</Highlight></CodeLine>
<Link id="l05143" /><CodeLine lineNumber="5143"><Highlight kind="normal">      MinRegs = std::min(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs(), MinRegs);</Highlight></CodeLine>
<Link id="l05144" /><CodeLine lineNumber="5144"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05145" /><CodeLine lineNumber="5145"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05146" /><CodeLine lineNumber="5146"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> FIdx = 0, NumForms = LU.Formulae.size(); FIdx != NumForms;</Highlight></CodeLine>
<Link id="l05147" /><CodeLine lineNumber="5147"><Highlight kind="normal">         ++FIdx) &#123;</Highlight></CodeLine>
<Link id="l05148" /><CodeLine lineNumber="5148"><Highlight kind="normal">      Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;FIdx&#93;;</Highlight></CodeLine>
<Link id="l05149" /><CodeLine lineNumber="5149"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs() &gt; MinRegs) &#123;</Highlight></CodeLine>
<Link id="l05150" /><CodeLine lineNumber="5150"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Filtering out formula &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05151" /><CodeLine lineNumber="5151"><Highlight kind="normal">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05152" /><CodeLine lineNumber="5152"><Highlight kind="normal">        LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l05153" /><CodeLine lineNumber="5153"><Highlight kind="normal">        --FIdx;</Highlight></CodeLine>
<Link id="l05154" /><CodeLine lineNumber="5154"><Highlight kind="normal">        --NumForms;</Highlight></CodeLine>
<Link id="l05155" /><CodeLine lineNumber="5155"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05156" /><CodeLine lineNumber="5156"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05157" /><CodeLine lineNumber="5157"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05158" /><CodeLine lineNumber="5158"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/any">Any</a>)</Highlight></CodeLine>
<Link id="l05159" /><CodeLine lineNumber="5159"><Highlight kind="normal">      LU.RecomputeRegs(LUIdx, RegUses);</Highlight></CodeLine>
<Link id="l05160" /><CodeLine lineNumber="5160"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05161" /><CodeLine lineNumber="5161"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</Highlight></CodeLine>
<Link id="l05162" /><CodeLine lineNumber="5162"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05163" /><CodeLine lineNumber="5163"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05164" /><CodeLine lineNumber="5164"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05165" /><CodeLine lineNumber="5165"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After pre-selection:\\n&quot;</Highlight><Highlight kind="normal">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l05166" /><CodeLine lineNumber="5166"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05167" /><CodeLine lineNumber="5167"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05168" /><CodeLine lineNumber="5168"><Highlight kind="comment">/// The function delete formulas with high registers number expectation.</Highlight></CodeLine>
<Link id="l05169" /><CodeLine lineNumber="5169"><Highlight kind="comment">/// Assuming we don&#39;t know the value of each formula (already delete</Highlight></CodeLine>
<Link id="l05170" /><CodeLine lineNumber="5170"><Highlight kind="comment">/// all inefficient), generate probability of not selecting for each</Highlight></CodeLine>
<Link id="l05171" /><CodeLine lineNumber="5171"><Highlight kind="comment">/// register.</Highlight></CodeLine>
<Link id="l05172" /><CodeLine lineNumber="5172"><Highlight kind="comment">/// For example,</Highlight></CodeLine>
<Link id="l05173" /><CodeLine lineNumber="5173"><Highlight kind="comment">/// Use1:</Highlight></CodeLine>
<Link id="l05174" /><CodeLine lineNumber="5174"><Highlight kind="comment">///  reg(a) + reg(&#123;0,+,1&#125;)</Highlight></CodeLine>
<Link id="l05175" /><CodeLine lineNumber="5175"><Highlight kind="comment">///  reg(a) + reg(&#123;-1,+,1&#125;) + 1</Highlight></CodeLine>
<Link id="l05176" /><CodeLine lineNumber="5176"><Highlight kind="comment">///  reg(&#123;a,+,1&#125;)</Highlight></CodeLine>
<Link id="l05177" /><CodeLine lineNumber="5177"><Highlight kind="comment">/// Use2:</Highlight></CodeLine>
<Link id="l05178" /><CodeLine lineNumber="5178"><Highlight kind="comment">///  reg(b) + reg(&#123;0,+,1&#125;)</Highlight></CodeLine>
<Link id="l05179" /><CodeLine lineNumber="5179"><Highlight kind="comment">///  reg(b) + reg(&#123;-1,+,1&#125;) + 1</Highlight></CodeLine>
<Link id="l05180" /><CodeLine lineNumber="5180"><Highlight kind="comment">///  reg(&#123;b,+,1&#125;)</Highlight></CodeLine>
<Link id="l05181" /><CodeLine lineNumber="5181"><Highlight kind="comment">/// Use3:</Highlight></CodeLine>
<Link id="l05182" /><CodeLine lineNumber="5182"><Highlight kind="comment">///  reg(c) + reg(b) + reg(&#123;0,+,1&#125;)</Highlight></CodeLine>
<Link id="l05183" /><CodeLine lineNumber="5183"><Highlight kind="comment">///  reg(c) + reg(&#123;b,+,1&#125;)</Highlight></CodeLine>
<Link id="l05184" /><CodeLine lineNumber="5184"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l05185" /><CodeLine lineNumber="5185"><Highlight kind="comment">/// Probability of not selecting</Highlight></CodeLine>
<Link id="l05186" /><CodeLine lineNumber="5186"><Highlight kind="comment">///                 Use1   Use2    Use3</Highlight></CodeLine>
<Link id="l05187" /><CodeLine lineNumber="5187"><Highlight kind="comment">/// reg(a)         (1/3) &#42;   1   &#42;   1</Highlight></CodeLine>
<Link id="l05188" /><CodeLine lineNumber="5188"><Highlight kind="comment">/// reg(b)           1   &#42; (1/3) &#42; (1/2)</Highlight></CodeLine>
<Link id="l05189" /><CodeLine lineNumber="5189"><Highlight kind="comment">/// reg(&#123;0,+,1&#125;)   (2/3) &#42; (2/3) &#42; (1/2)</Highlight></CodeLine>
<Link id="l05190" /><CodeLine lineNumber="5190"><Highlight kind="comment">/// reg(&#123;-1,+,1&#125;)  (2/3) &#42; (2/3) &#42;   1</Highlight></CodeLine>
<Link id="l05191" /><CodeLine lineNumber="5191"><Highlight kind="comment">/// reg(&#123;a,+,1&#125;)   (2/3) &#42;   1   &#42;   1</Highlight></CodeLine>
<Link id="l05192" /><CodeLine lineNumber="5192"><Highlight kind="comment">/// reg(&#123;b,+,1&#125;)     1   &#42; (2/3) &#42; (2/3)</Highlight></CodeLine>
<Link id="l05193" /><CodeLine lineNumber="5193"><Highlight kind="comment">/// reg(c)           1   &#42;   1   &#42;   0</Highlight></CodeLine>
<Link id="l05194" /><CodeLine lineNumber="5194"><Highlight kind="comment">///</Highlight></CodeLine>
<Link id="l05195" /><CodeLine lineNumber="5195"><Highlight kind="comment">/// Now count registers number mathematical expectation for each formula:</Highlight></CodeLine>
<Link id="l05196" /><CodeLine lineNumber="5196"><Highlight kind="comment">/// Note that for each use we exclude probability if not selecting for the use.</Highlight></CodeLine>
<Link id="l05197" /><CodeLine lineNumber="5197"><Highlight kind="comment">/// For example for Use1 probability for reg(a) would be just 1 &#42; 1 (excluding</Highlight></CodeLine>
<Link id="l05198" /><CodeLine lineNumber="5198"><Highlight kind="comment">/// probabilty 1/3 of not selecting for Use1).</Highlight></CodeLine>
<Link id="l05199" /><CodeLine lineNumber="5199"><Highlight kind="comment">/// Use1:</Highlight></CodeLine>
<Link id="l05200" /><CodeLine lineNumber="5200"><Highlight kind="comment">///  reg(a) + reg(&#123;0,+,1&#125;)          1 + 1/3       -- to be deleted</Highlight></CodeLine>
<Link id="l05201" /><CodeLine lineNumber="5201"><Highlight kind="comment">///  reg(a) + reg(&#123;-1,+,1&#125;) + 1     1 + 4/9       -- to be deleted</Highlight></CodeLine>
<Link id="l05202" /><CodeLine lineNumber="5202"><Highlight kind="comment">///  reg(&#123;a,+,1&#125;)                   1</Highlight></CodeLine>
<Link id="l05203" /><CodeLine lineNumber="5203"><Highlight kind="comment">/// Use2:</Highlight></CodeLine>
<Link id="l05204" /><CodeLine lineNumber="5204"><Highlight kind="comment">///  reg(b) + reg(&#123;0,+,1&#125;)          1/2 + 1/3     -- to be deleted</Highlight></CodeLine>
<Link id="l05205" /><CodeLine lineNumber="5205"><Highlight kind="comment">///  reg(b) + reg(&#123;-1,+,1&#125;) + 1     1/2 + 2/3     -- to be deleted</Highlight></CodeLine>
<Link id="l05206" /><CodeLine lineNumber="5206"><Highlight kind="comment">///  reg(&#123;b,+,1&#125;)                   2/3</Highlight></CodeLine>
<Link id="l05207" /><CodeLine lineNumber="5207"><Highlight kind="comment">/// Use3:</Highlight></CodeLine>
<Link id="l05208" /><CodeLine lineNumber="5208"><Highlight kind="comment">///  reg(c) + reg(b) + reg(&#123;0,+,1&#125;) 1 + 1/3 + 4/9 -- to be deleted</Highlight></CodeLine>
<Link id="l05209" /><CodeLine lineNumber="5209"><Highlight kind="comment">///  reg(c) + reg(&#123;b,+,1&#125;)          1 + 2/3</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05210" /><CodeLine lineNumber="5210"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::NarrowSearchSpaceByDeletingCostlyFormulas() &#123;</Highlight></CodeLine>
<Link id="l05211" /><CodeLine lineNumber="5211"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</Highlight></CodeLine>
<Link id="l05212" /><CodeLine lineNumber="5212"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05213" /><CodeLine lineNumber="5213"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ok, we have too many of formulae on our hands to conveniently handle.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05214" /><CodeLine lineNumber="5214"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Use a rough heuristic to thin out the list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05215" /><CodeLine lineNumber="5215"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05216" /><CodeLine lineNumber="5216"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Set of Regs wich will be 100% used in final solution.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05217" /><CodeLine lineNumber="5217"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Used in each formula of a solution (in example above this is reg(c)).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05218" /><CodeLine lineNumber="5218"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We can skip them in calculations.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05219" /><CodeLine lineNumber="5219"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 4&gt;</a> UniqRegs;</Highlight></CodeLine>
<Link id="l05220" /><CodeLine lineNumber="5220"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;The search space is too complex.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05221" /><CodeLine lineNumber="5221"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05222" /><CodeLine lineNumber="5222"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Map each register to probability of not selecting</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05223" /><CodeLine lineNumber="5223"><Highlight kind="normal">  DenseMap &lt;const SCEV &#42;, float&gt; RegNumMap;</Highlight></CodeLine>
<Link id="l05224" /><CodeLine lineNumber="5224"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : RegUses) &#123;</Highlight></CodeLine>
<Link id="l05225" /><CodeLine lineNumber="5225"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</Highlight></CodeLine>
<Link id="l05226" /><CodeLine lineNumber="5226"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05227" /><CodeLine lineNumber="5227"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal"> PNotSel = 1;</Highlight></CodeLine>
<Link id="l05228" /><CodeLine lineNumber="5228"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>) &#123;</Highlight></CodeLine>
<Link id="l05229" /><CodeLine lineNumber="5229"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LU.Regs.count(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</Highlight></CodeLine>
<Link id="l05230" /><CodeLine lineNumber="5230"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05231" /><CodeLine lineNumber="5231"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = LU.getNotSelectedProbability(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</Highlight></CodeLine>
<Link id="l05232" /><CodeLine lineNumber="5232"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> != 0.0)</Highlight></CodeLine>
<Link id="l05233" /><CodeLine lineNumber="5233"><Highlight kind="normal">        PNotSel &#42;= <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</Highlight></CodeLine>
<Link id="l05234" /><CodeLine lineNumber="5234"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05235" /><CodeLine lineNumber="5235"><Highlight kind="normal">        UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</Highlight></CodeLine>
<Link id="l05236" /><CodeLine lineNumber="5236"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05237" /><CodeLine lineNumber="5237"><Highlight kind="normal">    RegNumMap.<a href="/docs/api/classes/llvm/densemapbase/#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(std::make&#95;pair(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, PNotSel));</Highlight></CodeLine>
<Link id="l05238" /><CodeLine lineNumber="5238"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05239" /><CodeLine lineNumber="5239"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05240" /><CodeLine lineNumber="5240"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</Highlight></CodeLine>
<Link id="l05241" /><CodeLine lineNumber="5241"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Narrowing the search space by deleting costly formulas\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05242" /><CodeLine lineNumber="5242"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05243" /><CodeLine lineNumber="5243"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Delete formulas where registers number expectation is high.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05244" /><CodeLine lineNumber="5244"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l05245" /><CodeLine lineNumber="5245"><Highlight kind="normal">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l05246" /><CodeLine lineNumber="5246"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If nothing to delete - continue.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05247" /><CodeLine lineNumber="5247"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Formulae.size() &lt; 2)</Highlight></CodeLine>
<Link id="l05248" /><CodeLine lineNumber="5248"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05249" /><CodeLine lineNumber="5249"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This is temporary solution to test performance. Float should be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05250" /><CodeLine lineNumber="5250"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// replaced with round independent type (based on integers) to avoid</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05251" /><CodeLine lineNumber="5251"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// different results for different target builds.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05252" /><CodeLine lineNumber="5252"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal"> FMinRegNum = LU.Formulae&#91;0&#93;.getNumRegs();</Highlight></CodeLine>
<Link id="l05253" /><CodeLine lineNumber="5253"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal"> FMinARegNum = LU.Formulae&#91;0&#93;.getNumRegs();</Highlight></CodeLine>
<Link id="l05254" /><CodeLine lineNumber="5254"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> MinIdx = 0;</Highlight></CodeLine>
<Link id="l05255" /><CodeLine lineNumber="5255"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = LU.Formulae.size(); i != e; ++i) &#123;</Highlight></CodeLine>
<Link id="l05256" /><CodeLine lineNumber="5256"><Highlight kind="normal">      Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05257" /><CodeLine lineNumber="5257"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal"> FRegNum = 0;</Highlight></CodeLine>
<Link id="l05258" /><CodeLine lineNumber="5258"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">float</Highlight><Highlight kind="normal"> FARegNum = 0;</Highlight></CodeLine>
<Link id="l05259" /><CodeLine lineNumber="5259"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</Highlight></CodeLine>
<Link id="l05260" /><CodeLine lineNumber="5260"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(BaseReg))</Highlight></CodeLine>
<Link id="l05261" /><CodeLine lineNumber="5261"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05262" /><CodeLine lineNumber="5262"><Highlight kind="normal">        FRegNum += RegNumMap&#91;BaseReg&#93; / LU.getNotSelectedProbability(BaseReg);</Highlight></CodeLine>
<Link id="l05263" /><CodeLine lineNumber="5263"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(BaseReg))</Highlight></CodeLine>
<Link id="l05264" /><CodeLine lineNumber="5264"><Highlight kind="normal">          FARegNum +=</Highlight></CodeLine>
<Link id="l05265" /><CodeLine lineNumber="5265"><Highlight kind="normal">              RegNumMap&#91;BaseReg&#93; / LU.getNotSelectedProbability(BaseReg);</Highlight></CodeLine>
<Link id="l05266" /><CodeLine lineNumber="5266"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05267" /><CodeLine lineNumber="5267"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;ScaledReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) &#123;</Highlight></CodeLine>
<Link id="l05268" /><CodeLine lineNumber="5268"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(ScaledReg)) &#123;</Highlight></CodeLine>
<Link id="l05269" /><CodeLine lineNumber="5269"><Highlight kind="normal">          FRegNum +=</Highlight></CodeLine>
<Link id="l05270" /><CodeLine lineNumber="5270"><Highlight kind="normal">              RegNumMap&#91;ScaledReg&#93; / LU.getNotSelectedProbability(ScaledReg);</Highlight></CodeLine>
<Link id="l05271" /><CodeLine lineNumber="5271"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(ScaledReg))</Highlight></CodeLine>
<Link id="l05272" /><CodeLine lineNumber="5272"><Highlight kind="normal">            FARegNum +=</Highlight></CodeLine>
<Link id="l05273" /><CodeLine lineNumber="5273"><Highlight kind="normal">                RegNumMap&#91;ScaledReg&#93; / LU.getNotSelectedProbability(ScaledReg);</Highlight></CodeLine>
<Link id="l05274" /><CodeLine lineNumber="5274"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l05275" /><CodeLine lineNumber="5275"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05276" /><CodeLine lineNumber="5276"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FMinRegNum &gt; FRegNum ||</Highlight></CodeLine>
<Link id="l05277" /><CodeLine lineNumber="5277"><Highlight kind="normal">          (FMinRegNum == FRegNum &amp;&amp; FMinARegNum &gt; FARegNum)) &#123;</Highlight></CodeLine>
<Link id="l05278" /><CodeLine lineNumber="5278"><Highlight kind="normal">        FMinRegNum = FRegNum;</Highlight></CodeLine>
<Link id="l05279" /><CodeLine lineNumber="5279"><Highlight kind="normal">        FMinARegNum = FARegNum;</Highlight></CodeLine>
<Link id="l05280" /><CodeLine lineNumber="5280"><Highlight kind="normal">        MinIdx = i;</Highlight></CodeLine>
<Link id="l05281" /><CodeLine lineNumber="5281"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05282" /><CodeLine lineNumber="5282"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05283" /><CodeLine lineNumber="5283"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  The formula &quot;</Highlight><Highlight kind="normal">; LU.Formulae&#91;MinIdx&#93;.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05284" /><CodeLine lineNumber="5284"><Highlight kind="normal">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; with min reg num &quot;</Highlight><Highlight kind="normal"> &lt;&lt; FMinRegNum &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05285" /><CodeLine lineNumber="5285"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (MinIdx != 0)</Highlight></CodeLine>
<Link id="l05286" /><CodeLine lineNumber="5286"><Highlight kind="normal">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LU.Formulae&#91;MinIdx&#93;, LU.Formulae&#91;0&#93;);</Highlight></CodeLine>
<Link id="l05287" /><CodeLine lineNumber="5287"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (LU.Formulae.size() != 1) &#123;</Highlight></CodeLine>
<Link id="l05288" /><CodeLine lineNumber="5288"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Deleting &quot;</Highlight><Highlight kind="normal">; LU.Formulae.back().<a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05289" /><CodeLine lineNumber="5289"><Highlight kind="normal">                 <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05290" /><CodeLine lineNumber="5290"><Highlight kind="normal">      LU.Formulae.pop&#95;back();</Highlight></CodeLine>
<Link id="l05291" /><CodeLine lineNumber="5291"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05292" /><CodeLine lineNumber="5292"><Highlight kind="normal">    LU.RecomputeRegs(LUIdx, RegUses);</Highlight></CodeLine>
<Link id="l05293" /><CodeLine lineNumber="5293"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LU.Formulae.size() == 1 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Should be exactly 1 min regs formula&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05294" /><CodeLine lineNumber="5294"><Highlight kind="normal">    Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;0&#93;;</Highlight></CodeLine>
<Link id="l05295" /><CodeLine lineNumber="5295"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Leaving only &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05296" /><CodeLine lineNumber="5296"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// When we choose the formula, the regs become unique.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05297" /><CodeLine lineNumber="5297"><Highlight kind="normal">    UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.end());</Highlight></CodeLine>
<Link id="l05298" /><CodeLine lineNumber="5298"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg)</Highlight></CodeLine>
<Link id="l05299" /><CodeLine lineNumber="5299"><Highlight kind="normal">      UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</Highlight></CodeLine>
<Link id="l05300" /><CodeLine lineNumber="5300"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05301" /><CodeLine lineNumber="5301"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After pre-selection:\\n&quot;</Highlight><Highlight kind="normal">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l05302" /><CodeLine lineNumber="5302"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05303" /><CodeLine lineNumber="5303"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05304" /><CodeLine lineNumber="5304"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Check if Best and Reg are SCEVs separated by a constant amount C, and if so</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05305" /><CodeLine lineNumber="5305"><Highlight kind="normal"></Highlight><Highlight kind="comment">// would the addressing offset +C would be legal where the negative offset -C is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05306" /><CodeLine lineNumber="5306"><Highlight kind="normal"></Highlight><Highlight kind="comment">// not.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05307" /><CodeLine lineNumber="5307" lineLink="#a6c630dc63715497e5e49ab1ca9dc6ccb"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a6c630dc63715497e5e49ab1ca9dc6ccb">IsSimplerBaseSCEVForTarget</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l05308" /><CodeLine lineNumber="5308"><Highlight kind="normal">                                       <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Best,</Highlight></CodeLine>
<Link id="l05309" /><CodeLine lineNumber="5309"><Highlight kind="normal">                                       </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</Highlight></CodeLine>
<Link id="l05310" /><CodeLine lineNumber="5310"><Highlight kind="normal">                                       MemAccessTy AccessType) &#123;</Highlight></CodeLine>
<Link id="l05311" /><CodeLine lineNumber="5311"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Best-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>() != <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>-&gt;getType() ||</Highlight></CodeLine>
<Link id="l05312" /><CodeLine lineNumber="5312"><Highlight kind="normal">      (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(Best) &amp;&amp; <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &amp;&amp;</Highlight></CodeLine>
<Link id="l05313" /><CodeLine lineNumber="5313"><Highlight kind="normal">       <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(Best)-&gt;getLoop() !=</Highlight></CodeLine>
<Link id="l05314" /><CodeLine lineNumber="5314"><Highlight kind="normal">           <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)-&gt;getLoop()))</Highlight></CodeLine>
<Link id="l05315" /><CodeLine lineNumber="5315"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05316" /><CodeLine lineNumber="5316"><Highlight kind="normal">  std::optional&lt;APInt&gt; Diff = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ae0ca564918ec63a9b4d2229374fec747">computeConstantDifference</a>(Best, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</Highlight></CodeLine>
<Link id="l05317" /><CodeLine lineNumber="5317"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Diff)</Highlight></CodeLine>
<Link id="l05318" /><CodeLine lineNumber="5318"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05319" /><CodeLine lineNumber="5319"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05320" /><CodeLine lineNumber="5320"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(</Highlight></CodeLine>
<Link id="l05321" /><CodeLine lineNumber="5321"><Highlight kind="normal">             AccessType.MemTy, </Highlight><Highlight kind="comment">/&#42;BaseGV=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05322" /><CodeLine lineNumber="5322"><Highlight kind="normal">             </Highlight><Highlight kind="comment">/&#42;BaseOffset=&#42;/</Highlight><Highlight kind="normal">Diff-&gt;getSExtValue(),</Highlight></CodeLine>
<Link id="l05323" /><CodeLine lineNumber="5323"><Highlight kind="normal">             </Highlight><Highlight kind="comment">/&#42;HasBaseReg=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;Scale=&#42;/</Highlight><Highlight kind="normal">0, AccessType.AddrSpace) &amp;&amp;</Highlight></CodeLine>
<Link id="l05324" /><CodeLine lineNumber="5324"><Highlight kind="normal">         !<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(</Highlight></CodeLine>
<Link id="l05325" /><CodeLine lineNumber="5325"><Highlight kind="normal">             AccessType.MemTy, </Highlight><Highlight kind="comment">/&#42;BaseGV=&#42;/</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05326" /><CodeLine lineNumber="5326"><Highlight kind="normal">             </Highlight><Highlight kind="comment">/&#42;BaseOffset=&#42;/</Highlight><Highlight kind="normal">-Diff-&gt;getSExtValue(),</Highlight></CodeLine>
<Link id="l05327" /><CodeLine lineNumber="5327"><Highlight kind="normal">             </Highlight><Highlight kind="comment">/&#42;HasBaseReg=&#42;/</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="comment">/&#42;Scale=&#42;/</Highlight><Highlight kind="normal">0, AccessType.AddrSpace);</Highlight></CodeLine>
<Link id="l05328" /><CodeLine lineNumber="5328"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05329" /><CodeLine lineNumber="5329"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05330" /><CodeLine lineNumber="5330"><Highlight kind="comment">/// Pick a register which seems likely to be profitable, and then in any use</Highlight></CodeLine>
<Link id="l05331" /><CodeLine lineNumber="5331"><Highlight kind="comment">/// which has any reference to that register, delete all formulae which do not</Highlight></CodeLine>
<Link id="l05332" /><CodeLine lineNumber="5332"><Highlight kind="comment">/// reference that register.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05333" /><CodeLine lineNumber="5333"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::NarrowSearchSpaceByPickingWinnerRegs() &#123;</Highlight></CodeLine>
<Link id="l05334" /><CodeLine lineNumber="5334"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// With all other options exhausted, loop until the system is simple</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05335" /><CodeLine lineNumber="5335"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// enough to handle.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05336" /><CodeLine lineNumber="5336"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 4&gt;</a> Taken;</Highlight></CodeLine>
<Link id="l05337" /><CodeLine lineNumber="5337"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (EstimateSearchSpaceComplexity() &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>) &#123;</Highlight></CodeLine>
<Link id="l05338" /><CodeLine lineNumber="5338"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Ok, we have too many of formulae on our hands to conveniently handle.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05339" /><CodeLine lineNumber="5339"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Use a rough heuristic to thin out the list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05340" /><CodeLine lineNumber="5340"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;The search space is too complex.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05341" /><CodeLine lineNumber="5341"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05342" /><CodeLine lineNumber="5342"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Pick the register which is used by the most LSRUses, which is likely</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05343" /><CodeLine lineNumber="5343"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// to be a good reuse register candidate.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05344" /><CodeLine lineNumber="5344"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Best = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05345" /><CodeLine lineNumber="5345"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> BestNum = 0;</Highlight></CodeLine>
<Link id="l05346" /><CodeLine lineNumber="5346"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : RegUses) &#123;</Highlight></CodeLine>
<Link id="l05347" /><CodeLine lineNumber="5347"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Taken.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</Highlight></CodeLine>
<Link id="l05348" /><CodeLine lineNumber="5348"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05349" /><CodeLine lineNumber="5349"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Best) &#123;</Highlight></CodeLine>
<Link id="l05350" /><CodeLine lineNumber="5350"><Highlight kind="normal">        Best = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</Highlight></CodeLine>
<Link id="l05351" /><CodeLine lineNumber="5351"><Highlight kind="normal">        BestNum = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>).count();</Highlight></CodeLine>
<Link id="l05352" /><CodeLine lineNumber="5352"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05353" /><CodeLine lineNumber="5353"><Highlight kind="normal">        </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a> = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>).count();</Highlight></CodeLine>
<Link id="l05354" /><CodeLine lineNumber="5354"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a> &gt; BestNum) &#123;</Highlight></CodeLine>
<Link id="l05355" /><CodeLine lineNumber="5355"><Highlight kind="normal">          Best = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</Highlight></CodeLine>
<Link id="l05356" /><CodeLine lineNumber="5356"><Highlight kind="normal">          BestNum = <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a>;</Highlight></CodeLine>
<Link id="l05357" /><CodeLine lineNumber="5357"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l05358" /><CodeLine lineNumber="5358"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05359" /><CodeLine lineNumber="5359"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// If the scores are the same, but the Reg is simpler for the target</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05360" /><CodeLine lineNumber="5360"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// (for example &#123;x,+,1&#125; as opposed to &#123;x+C,+,1&#125;, where the target can</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05361" /><CodeLine lineNumber="5361"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// handle +C but not -C), opt for the simpler formula.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05362" /><CodeLine lineNumber="5362"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a> == BestNum) &#123;</Highlight></CodeLine>
<Link id="l05363" /><CodeLine lineNumber="5363"><Highlight kind="normal">          </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> LUIdx = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>).find&#95;first();</Highlight></CodeLine>
<Link id="l05364" /><CodeLine lineNumber="5364"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LUIdx &gt;= 0 &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l05365" /><CodeLine lineNumber="5365"><Highlight kind="normal">              <a href="#a6c630dc63715497e5e49ab1ca9dc6ccb">IsSimplerBaseSCEVForTarget</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, SE, Best, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</Highlight></CodeLine>
<Link id="l05366" /><CodeLine lineNumber="5366"><Highlight kind="normal">                                         <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;.AccessTy)) &#123;</Highlight></CodeLine>
<Link id="l05367" /><CodeLine lineNumber="5367"><Highlight kind="normal">            Best = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</Highlight></CodeLine>
<Link id="l05368" /><CodeLine lineNumber="5368"><Highlight kind="normal">            BestNum = <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a>;</Highlight></CodeLine>
<Link id="l05369" /><CodeLine lineNumber="5369"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l05370" /><CodeLine lineNumber="5370"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l05371" /><CodeLine lineNumber="5371"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05372" /><CodeLine lineNumber="5372"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05373" /><CodeLine lineNumber="5373"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Best &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Failed to find best LSRUse candidate&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05374" /><CodeLine lineNumber="5374"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05375" /><CodeLine lineNumber="5375"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Narrowing the search space by assuming &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Best</Highlight></CodeLine>
<Link id="l05376" /><CodeLine lineNumber="5376"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; will yield profitable reuse.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05377" /><CodeLine lineNumber="5377"><Highlight kind="normal">    Taken.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(Best);</Highlight></CodeLine>
<Link id="l05378" /><CodeLine lineNumber="5378"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05379" /><CodeLine lineNumber="5379"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// In any use with formulae which references this register, delete formulae</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05380" /><CodeLine lineNumber="5380"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// which don&#39;t reference it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05381" /><CodeLine lineNumber="5381"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</Highlight></CodeLine>
<Link id="l05382" /><CodeLine lineNumber="5382"><Highlight kind="normal">      LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</Highlight></CodeLine>
<Link id="l05383" /><CodeLine lineNumber="5383"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LU.Regs.count(Best)) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05384" /><CodeLine lineNumber="5384"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05385" /><CodeLine lineNumber="5385"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05386" /><CodeLine lineNumber="5386"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = LU.Formulae.size(); i != e; ++i) &#123;</Highlight></CodeLine>
<Link id="l05387" /><CodeLine lineNumber="5387"><Highlight kind="normal">        Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;i&#93;;</Highlight></CodeLine>
<Link id="l05388" /><CodeLine lineNumber="5388"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.referencesReg(Best)) &#123;</Highlight></CodeLine>
<Link id="l05389" /><CodeLine lineNumber="5389"><Highlight kind="normal">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  Deleting &quot;</Highlight><Highlight kind="normal">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05390" /><CodeLine lineNumber="5390"><Highlight kind="normal">          LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l05391" /><CodeLine lineNumber="5391"><Highlight kind="normal">          --<a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a>;</Highlight></CodeLine>
<Link id="l05392" /><CodeLine lineNumber="5392"><Highlight kind="normal">          --i;</Highlight></CodeLine>
<Link id="l05393" /><CodeLine lineNumber="5393"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/any">Any</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05394" /><CodeLine lineNumber="5394"><Highlight kind="normal">          <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(e != 0 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Use has no formulae left! Is Regs inconsistent?&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05395" /><CodeLine lineNumber="5395"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05396" /><CodeLine lineNumber="5396"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l05397" /><CodeLine lineNumber="5397"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05398" /><CodeLine lineNumber="5398"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05399" /><CodeLine lineNumber="5399"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/any">Any</a>)</Highlight></CodeLine>
<Link id="l05400" /><CodeLine lineNumber="5400"><Highlight kind="normal">        LU.RecomputeRegs(LUIdx, RegUses);</Highlight></CodeLine>
<Link id="l05401" /><CodeLine lineNumber="5401"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05402" /><CodeLine lineNumber="5402"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05403" /><CodeLine lineNumber="5403"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;After pre-selection:\\n&quot;</Highlight><Highlight kind="normal">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l05404" /><CodeLine lineNumber="5404"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05405" /><CodeLine lineNumber="5405"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05406" /><CodeLine lineNumber="5406"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05407" /><CodeLine lineNumber="5407"><Highlight kind="comment">/// If there are an extraordinary number of formulae to choose from, use some</Highlight></CodeLine>
<Link id="l05408" /><CodeLine lineNumber="5408"><Highlight kind="comment">/// rough heuristics to prune down the number of formulae. This keeps the main</Highlight></CodeLine>
<Link id="l05409" /><CodeLine lineNumber="5409"><Highlight kind="comment">/// solver from taking an extraordinary amount of time in some worst-case</Highlight></CodeLine>
<Link id="l05410" /><CodeLine lineNumber="5410"><Highlight kind="comment">/// scenarios.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05411" /><CodeLine lineNumber="5411"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::NarrowSearchSpaceUsingHeuristics() &#123;</Highlight></CodeLine>
<Link id="l05412" /><CodeLine lineNumber="5412"><Highlight kind="normal">  NarrowSearchSpaceByDetectingSupersets();</Highlight></CodeLine>
<Link id="l05413" /><CodeLine lineNumber="5413"><Highlight kind="normal">  NarrowSearchSpaceByCollapsingUnrolledCode();</Highlight></CodeLine>
<Link id="l05414" /><CodeLine lineNumber="5414"><Highlight kind="normal">  NarrowSearchSpaceByRefilteringUndesirableDedicatedRegisters();</Highlight></CodeLine>
<Link id="l05415" /><CodeLine lineNumber="5415"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#aad3193b74a34d43bf4e02188ce67d3b7">FilterSameScaledReg</a>)</Highlight></CodeLine>
<Link id="l05416" /><CodeLine lineNumber="5416"><Highlight kind="normal">    NarrowSearchSpaceByFilterFormulaWithSameScaledReg();</Highlight></CodeLine>
<Link id="l05417" /><CodeLine lineNumber="5417"><Highlight kind="normal">  NarrowSearchSpaceByFilterPostInc();</Highlight></CodeLine>
<Link id="l05418" /><CodeLine lineNumber="5418"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#aa957fcc885db5c56e419b4646d135311">LSRExpNarrow</a>)</Highlight></CodeLine>
<Link id="l05419" /><CodeLine lineNumber="5419"><Highlight kind="normal">    NarrowSearchSpaceByDeletingCostlyFormulas();</Highlight></CodeLine>
<Link id="l05420" /><CodeLine lineNumber="5420"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05421" /><CodeLine lineNumber="5421"><Highlight kind="normal">    NarrowSearchSpaceByPickingWinnerRegs();</Highlight></CodeLine>
<Link id="l05422" /><CodeLine lineNumber="5422"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05423" /><CodeLine lineNumber="5423"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05424" /><CodeLine lineNumber="5424"><Highlight kind="comment">/// This is the recursive solver.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05425" /><CodeLine lineNumber="5425"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::SolveRecurse(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution,</Highlight></CodeLine>
<Link id="l05426" /><CodeLine lineNumber="5426"><Highlight kind="normal">                               <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> &amp;SolutionCost,</Highlight></CodeLine>
<Link id="l05427" /><CodeLine lineNumber="5427"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Workspace,</Highlight></CodeLine>
<Link id="l05428" /><CodeLine lineNumber="5428"><Highlight kind="normal">                               </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> &amp;CurCost,</Highlight></CodeLine>
<Link id="l05429" /><CodeLine lineNumber="5429"><Highlight kind="normal">                               </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> &amp;CurRegs,</Highlight></CodeLine>
<Link id="l05430" /><CodeLine lineNumber="5430"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> &amp;VisitedRegs)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l05431" /><CodeLine lineNumber="5431"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Some ideas:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05432" /><CodeLine lineNumber="5432"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  - prune more:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05433" /><CodeLine lineNumber="5433"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    - use more aggressive filtering</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05434" /><CodeLine lineNumber="5434"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    - sort the formula so that the most profitable solutions are found first</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05435" /><CodeLine lineNumber="5435"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    - sort the uses too</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05436" /><CodeLine lineNumber="5436"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//  - search faster:</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05437" /><CodeLine lineNumber="5437"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    - don&#39;t compute a cost, and then compare. compare while computing a cost</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05438" /><CodeLine lineNumber="5438"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//      and bail early.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05439" /><CodeLine lineNumber="5439"><Highlight kind="normal">  </Highlight><Highlight kind="comment">//    - track register sets with SmallBitVector</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05440" /><CodeLine lineNumber="5440"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05441" /><CodeLine lineNumber="5441"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>()&#93;;</Highlight></CodeLine>
<Link id="l05442" /><CodeLine lineNumber="5442"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05443" /><CodeLine lineNumber="5443"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If this use references any register that&#39;s already a part of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05444" /><CodeLine lineNumber="5444"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// in-progress solution, consider it a requirement that a formula must</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05445" /><CodeLine lineNumber="5445"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// reference that register in order to be considered. This prunes out</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05446" /><CodeLine lineNumber="5446"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// unprofitable searching.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05447" /><CodeLine lineNumber="5447"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector&lt;const SCEV &#42;, 4&gt;</a> ReqRegs;</Highlight></CodeLine>
<Link id="l05448" /><CodeLine lineNumber="5448"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : CurRegs)</Highlight></CodeLine>
<Link id="l05449" /><CodeLine lineNumber="5449"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Regs.count(S))</Highlight></CodeLine>
<Link id="l05450" /><CodeLine lineNumber="5450"><Highlight kind="normal">      ReqRegs.<a href="/docs/api/classes/llvm/setvector/#af34eb71cc483e84d2eca80575cb9ccde">insert</a>(S);</Highlight></CodeLine>
<Link id="l05451" /><CodeLine lineNumber="5451"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05452" /><CodeLine lineNumber="5452"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> NewRegs;</Highlight></CodeLine>
<Link id="l05453" /><CodeLine lineNumber="5453"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> NewCost(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</Highlight></CodeLine>
<Link id="l05454" /><CodeLine lineNumber="5454"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae) &#123;</Highlight></CodeLine>
<Link id="l05455" /><CodeLine lineNumber="5455"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Ignore formulae which may not be ideal in terms of register reuse of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05456" /><CodeLine lineNumber="5456"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// ReqRegs.  The formula should use all required registers before</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05457" /><CodeLine lineNumber="5457"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// introducing new ones.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05458" /><CodeLine lineNumber="5458"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This can sometimes (notably when trying to favour postinc) lead to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05459" /><CodeLine lineNumber="5459"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// sub-optimial decisions. There it is best left to the cost modelling to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05460" /><CodeLine lineNumber="5460"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// get correct.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05461" /><CodeLine lineNumber="5461"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AMK != <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a> || LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>) &#123;</Highlight></CodeLine>
<Link id="l05462" /><CodeLine lineNumber="5462"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> NumReqRegsToFind = std::min(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs(), ReqRegs.<a href="/docs/api/classes/llvm/setvector/#a1a42c1ba878bd637f374197d05f0a97f">size</a>());</Highlight></CodeLine>
<Link id="l05463" /><CodeLine lineNumber="5463"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : ReqRegs) &#123;</Highlight></CodeLine>
<Link id="l05464" /><CodeLine lineNumber="5464"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> ((<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg == <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) ||</Highlight></CodeLine>
<Link id="l05465" /><CodeLine lineNumber="5465"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/#acd1cd968cb420c82d70926920fcdc7d7">is&#95;contained</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</Highlight></CodeLine>
<Link id="l05466" /><CodeLine lineNumber="5466"><Highlight kind="normal">          --NumReqRegsToFind;</Highlight></CodeLine>
<Link id="l05467" /><CodeLine lineNumber="5467"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumReqRegsToFind == 0)</Highlight></CodeLine>
<Link id="l05468" /><CodeLine lineNumber="5468"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05469" /><CodeLine lineNumber="5469"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l05470" /><CodeLine lineNumber="5470"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05471" /><CodeLine lineNumber="5471"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumReqRegsToFind != 0) &#123;</Highlight></CodeLine>
<Link id="l05472" /><CodeLine lineNumber="5472"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// If none of the formulae satisfied the required registers, then we could</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05473" /><CodeLine lineNumber="5473"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// clear ReqRegs and try again. Currently, we simply give up in this case.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05474" /><CodeLine lineNumber="5474"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05475" /><CodeLine lineNumber="5475"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05476" /><CodeLine lineNumber="5476"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05477" /><CodeLine lineNumber="5477"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05478" /><CodeLine lineNumber="5478"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Evaluate the cost of the current formula. If it&#39;s already worse than</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05479" /><CodeLine lineNumber="5479"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the current best, prune the search at that point.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05480" /><CodeLine lineNumber="5480"><Highlight kind="normal">    NewCost = CurCost;</Highlight></CodeLine>
<Link id="l05481" /><CodeLine lineNumber="5481"><Highlight kind="normal">    NewRegs = CurRegs;</Highlight></CodeLine>
<Link id="l05482" /><CodeLine lineNumber="5482"><Highlight kind="normal">    NewCost.RateFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, NewRegs, VisitedRegs, LU);</Highlight></CodeLine>
<Link id="l05483" /><CodeLine lineNumber="5483"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NewCost.isLess(SolutionCost)) &#123;</Highlight></CodeLine>
<Link id="l05484" /><CodeLine lineNumber="5484"><Highlight kind="normal">      Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</Highlight></CodeLine>
<Link id="l05485" /><CodeLine lineNumber="5485"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() != <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size()) &#123;</Highlight></CodeLine>
<Link id="l05486" /><CodeLine lineNumber="5486"><Highlight kind="normal">        SolveRecurse(Solution, SolutionCost, Workspace, NewCost,</Highlight></CodeLine>
<Link id="l05487" /><CodeLine lineNumber="5487"><Highlight kind="normal">                     NewRegs, VisitedRegs);</Highlight></CodeLine>
<Link id="l05488" /><CodeLine lineNumber="5488"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs() == 1 &amp;&amp; Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == 1)</Highlight></CodeLine>
<Link id="l05489" /><CodeLine lineNumber="5489"><Highlight kind="normal">          VisitedRegs.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg ? <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;0&#93;);</Highlight></CodeLine>
<Link id="l05490" /><CodeLine lineNumber="5490"><Highlight kind="normal">      &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05491" /><CodeLine lineNumber="5491"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;New best at &quot;</Highlight><Highlight kind="normal">; NewCost.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05492" /><CodeLine lineNumber="5492"><Highlight kind="normal">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;.\\nRegs:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05493" /><CodeLine lineNumber="5493"><Highlight kind="normal">                   </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : NewRegs) <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</Highlight></CodeLine>
<Link id="l05494" /><CodeLine lineNumber="5494"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;- &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;S &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05495" /><CodeLine lineNumber="5495"><Highlight kind="normal">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05496" /><CodeLine lineNumber="5496"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05497" /><CodeLine lineNumber="5497"><Highlight kind="normal">        SolutionCost = NewCost;</Highlight></CodeLine>
<Link id="l05498" /><CodeLine lineNumber="5498"><Highlight kind="normal">        Solution = Workspace;</Highlight></CodeLine>
<Link id="l05499" /><CodeLine lineNumber="5499"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05500" /><CodeLine lineNumber="5500"><Highlight kind="normal">      Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#ad97688dfe9cd802e2a0691cbe620218a">pop&#95;back</a>();</Highlight></CodeLine>
<Link id="l05501" /><CodeLine lineNumber="5501"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05502" /><CodeLine lineNumber="5502"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05503" /><CodeLine lineNumber="5503"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05504" /><CodeLine lineNumber="5504"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05505" /><CodeLine lineNumber="5505"><Highlight kind="comment">/// Choose one formula from each use. Return the results in the given Solution</Highlight></CodeLine>
<Link id="l05506" /><CodeLine lineNumber="5506"><Highlight kind="comment">/// vector.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05507" /><CodeLine lineNumber="5507"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::Solve(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l05508" /><CodeLine lineNumber="5508"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const Formula &#42;, 8&gt;</a> Workspace;</Highlight></CodeLine>
<Link id="l05509" /><CodeLine lineNumber="5509"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> SolutionCost(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</Highlight></CodeLine>
<Link id="l05510" /><CodeLine lineNumber="5510"><Highlight kind="normal">  SolutionCost.Lose();</Highlight></CodeLine>
<Link id="l05511" /><CodeLine lineNumber="5511"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CurCost(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</Highlight></CodeLine>
<Link id="l05512" /><CodeLine lineNumber="5512"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> CurRegs;</Highlight></CodeLine>
<Link id="l05513" /><CodeLine lineNumber="5513"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> VisitedRegs;</Highlight></CodeLine>
<Link id="l05514" /><CodeLine lineNumber="5514"><Highlight kind="normal">  Workspace.<a href="/docs/api/classes/llvm/smallvectorimpl/#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(<a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size());</Highlight></CodeLine>
<Link id="l05515" /><CodeLine lineNumber="5515"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05516" /><CodeLine lineNumber="5516"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// SolveRecurse does all the work.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05517" /><CodeLine lineNumber="5517"><Highlight kind="normal">  SolveRecurse(Solution, SolutionCost, Workspace, CurCost,</Highlight></CodeLine>
<Link id="l05518" /><CodeLine lineNumber="5518"><Highlight kind="normal">               CurRegs, VisitedRegs);</Highlight></CodeLine>
<Link id="l05519" /><CodeLine lineNumber="5519"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Solution.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</Highlight></CodeLine>
<Link id="l05520" /><CodeLine lineNumber="5520"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\nNo Satisfactory Solution\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05521" /><CodeLine lineNumber="5521"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05522" /><CodeLine lineNumber="5522"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05523" /><CodeLine lineNumber="5523"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05524" /><CodeLine lineNumber="5524"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ok, we&#39;ve now made all our decisions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05525" /><CodeLine lineNumber="5525"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05526" /><CodeLine lineNumber="5526"><Highlight kind="normal">                       </Highlight><Highlight kind="stringliteral">&quot;The chosen solution requires &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05527" /><CodeLine lineNumber="5527"><Highlight kind="normal">             SolutionCost.<a href="/docs/api/classes/llvm/instructioncost/#a7a0b7d0565cbdb80fcc368365bf86c9c">print</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05528" /><CodeLine lineNumber="5528"><Highlight kind="normal">             </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> i = 0, e = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); i != e; ++i) &#123;</Highlight></CodeLine>
<Link id="l05529" /><CodeLine lineNumber="5529"><Highlight kind="normal">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05530" /><CodeLine lineNumber="5530"><Highlight kind="normal">               <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;i&#93;.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05531" /><CodeLine lineNumber="5531"><Highlight kind="normal">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05532" /><CodeLine lineNumber="5532"><Highlight kind="normal">                         </Highlight><Highlight kind="stringliteral">&quot;    &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05533" /><CodeLine lineNumber="5533"><Highlight kind="normal">               Solution&#91;i&#93;-&gt;print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</Highlight></CodeLine>
<Link id="l05534" /><CodeLine lineNumber="5534"><Highlight kind="normal">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05535" /><CodeLine lineNumber="5535"><Highlight kind="normal">             &#125;);</Highlight></CodeLine>
<Link id="l05536" /><CodeLine lineNumber="5536"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05537" /><CodeLine lineNumber="5537"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Solution.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Malformed solution!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05538" /><CodeLine lineNumber="5538"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05539" /><CodeLine lineNumber="5539"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> EnableDropUnprofitableSolution = &#91;&amp;&#93; &#123;</Highlight></CodeLine>
<Link id="l05540" /><CodeLine lineNumber="5540"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (<a href="#a57a769eb2fe11448940d81a19e0140e2">AllowDropSolutionIfLessProfitable</a>) &#123;</Highlight></CodeLine>
<Link id="l05541" /><CodeLine lineNumber="5541"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44ad7c4bd83c337c86d34f6c2d8eba1e736">cl::BOU&#95;TRUE</a>:</Highlight></CodeLine>
<Link id="l05542" /><CodeLine lineNumber="5542"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05543" /><CodeLine lineNumber="5543"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44a4e55599a5b5277382b14e6e8eb1f63ef">cl::BOU&#95;FALSE</a>:</Highlight></CodeLine>
<Link id="l05544" /><CodeLine lineNumber="5544"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05545" /><CodeLine lineNumber="5545"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44aa5bd521ebe67ddf0e90f1a9e540a6d43">cl::BOU&#95;UNSET</a>:</Highlight></CodeLine>
<Link id="l05546" /><CodeLine lineNumber="5546"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.shouldDropLSRSolutionIfLessProfitable();</Highlight></CodeLine>
<Link id="l05547" /><CodeLine lineNumber="5547"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05548" /><CodeLine lineNumber="5548"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</Highlight><Highlight kind="stringliteral">&quot;Unhandled cl::boolOrDefault enum&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05549" /><CodeLine lineNumber="5549"><Highlight kind="normal">  &#125;();</Highlight></CodeLine>
<Link id="l05550" /><CodeLine lineNumber="5550"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05551" /><CodeLine lineNumber="5551"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BaselineCost.isLess(SolutionCost)) &#123;</Highlight></CodeLine>
<Link id="l05552" /><CodeLine lineNumber="5552"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!EnableDropUnprofitableSolution)</Highlight></CodeLine>
<Link id="l05553" /><CodeLine lineNumber="5553"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</Highlight></CodeLine>
<Link id="l05554" /><CodeLine lineNumber="5554"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Baseline is more profitable than chosen solution, &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05555" /><CodeLine lineNumber="5555"><Highlight kind="normal">                    </Highlight><Highlight kind="stringliteral">&quot;add option &#39;lsr-drop-solution&#39; to drop LSR solution.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05556" /><CodeLine lineNumber="5556"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05557" /><CodeLine lineNumber="5557"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;Baseline is more profitable than chosen &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05558" /><CodeLine lineNumber="5558"><Highlight kind="normal">                           </Highlight><Highlight kind="stringliteral">&quot;solution, dropping LSR solution.\\n&quot;</Highlight><Highlight kind="normal">;);</Highlight></CodeLine>
<Link id="l05559" /><CodeLine lineNumber="5559"><Highlight kind="normal">      Solution.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</Highlight></CodeLine>
<Link id="l05560" /><CodeLine lineNumber="5560"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05561" /><CodeLine lineNumber="5561"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05562" /><CodeLine lineNumber="5562"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05563" /><CodeLine lineNumber="5563"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05564" /><CodeLine lineNumber="5564"><Highlight kind="comment">/// Helper for AdjustInsertPositionForExpand. Climb up the dominator tree far as</Highlight></CodeLine>
<Link id="l05565" /><CodeLine lineNumber="5565"><Highlight kind="comment">/// we can go while still being dominated by the input positions. This helps</Highlight></CodeLine>
<Link id="l05566" /><CodeLine lineNumber="5566"><Highlight kind="comment">/// canonicalize the insert position, which encourages sharing.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05567" /><CodeLine lineNumber="5567"><Highlight kind="normal"><a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a></Highlight></CodeLine>
<Link id="l05568" /><CodeLine lineNumber="5568"><Highlight kind="normal">LSRInstance::HoistInsertPosition(<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</Highlight></CodeLine>
<Link id="l05569" /><CodeLine lineNumber="5569"><Highlight kind="normal">                                 </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Instruction &#42;&gt;</a> &amp;Inputs)</Highlight><Highlight kind="keyword"></Highlight></CodeLine>
<Link id="l05570" /><CodeLine lineNumber="5570"><Highlight kind="keyword">                                                                         const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l05571" /><CodeLine lineNumber="5571"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Tentative = &amp;&#42;IP;</Highlight></CodeLine>
<Link id="l05572" /><CodeLine lineNumber="5572"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l05573" /><CodeLine lineNumber="5573"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> AllDominate = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05574" /><CodeLine lineNumber="5574"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;BetterPos = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05575" /><CodeLine lineNumber="5575"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Don&#39;t bother attempting to insert before a catchswitch, their basic block</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05576" /><CodeLine lineNumber="5576"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// cannot have other non-PHI instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05577" /><CodeLine lineNumber="5577"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(Tentative))</Highlight></CodeLine>
<Link id="l05578" /><CodeLine lineNumber="5578"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IP;</Highlight></CodeLine>
<Link id="l05579" /><CodeLine lineNumber="5579"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05580" /><CodeLine lineNumber="5580"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst : Inputs) &#123;</Highlight></CodeLine>
<Link id="l05581" /><CodeLine lineNumber="5581"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Inst == Tentative || !DT.dominates(Inst, Tentative)) &#123;</Highlight></CodeLine>
<Link id="l05582" /><CodeLine lineNumber="5582"><Highlight kind="normal">        AllDominate = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05583" /><CodeLine lineNumber="5583"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05584" /><CodeLine lineNumber="5584"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05585" /><CodeLine lineNumber="5585"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Attempt to find an insert position in the middle of the block,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05586" /><CodeLine lineNumber="5586"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// instead of at the end, so that it can be used for other expansions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05587" /><CodeLine lineNumber="5587"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Tentative-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() == Inst-&gt;getParent() &amp;&amp;</Highlight></CodeLine>
<Link id="l05588" /><CodeLine lineNumber="5588"><Highlight kind="normal">          (!BetterPos || !DT.dominates(Inst, BetterPos)))</Highlight></CodeLine>
<Link id="l05589" /><CodeLine lineNumber="5589"><Highlight kind="normal">        BetterPos = &amp;&#42;std::next(<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a>(Inst));</Highlight></CodeLine>
<Link id="l05590" /><CodeLine lineNumber="5590"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05591" /><CodeLine lineNumber="5591"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!AllDominate)</Highlight></CodeLine>
<Link id="l05592" /><CodeLine lineNumber="5592"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05593" /><CodeLine lineNumber="5593"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BetterPos)</Highlight></CodeLine>
<Link id="l05594" /><CodeLine lineNumber="5594"><Highlight kind="normal">      IP = BetterPos-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>();</Highlight></CodeLine>
<Link id="l05595" /><CodeLine lineNumber="5595"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05596" /><CodeLine lineNumber="5596"><Highlight kind="normal">      IP = Tentative-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>();</Highlight></CodeLine>
<Link id="l05597" /><CodeLine lineNumber="5597"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05598" /><CodeLine lineNumber="5598"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;IPLoop = LI.getLoopFor(IP-&gt;getParent());</Highlight></CodeLine>
<Link id="l05599" /><CodeLine lineNumber="5599"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IPLoopDepth = IPLoop ? IPLoop-&gt;<a href="/docs/api/classes/llvm/loopbase/#a57994482c17097d9f936acff3a6598ac">getLoopDepth</a>() : 0;</Highlight></CodeLine>
<Link id="l05600" /><CodeLine lineNumber="5600"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05601" /><CodeLine lineNumber="5601"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;IDom;</Highlight></CodeLine>
<Link id="l05602" /><CodeLine lineNumber="5602"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a58b9df85470fc4e2a8066ff6a62e5a34">DomTreeNode</a> &#42;Rung = DT.getNode(IP-&gt;getParent()); ; ) &#123;</Highlight></CodeLine>
<Link id="l05603" /><CodeLine lineNumber="5603"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Rung) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IP;</Highlight></CodeLine>
<Link id="l05604" /><CodeLine lineNumber="5604"><Highlight kind="normal">      Rung = Rung-&gt;getIDom();</Highlight></CodeLine>
<Link id="l05605" /><CodeLine lineNumber="5605"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Rung) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IP;</Highlight></CodeLine>
<Link id="l05606" /><CodeLine lineNumber="5606"><Highlight kind="normal">      IDom = Rung-&gt;getBlock();</Highlight></CodeLine>
<Link id="l05607" /><CodeLine lineNumber="5607"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05608" /><CodeLine lineNumber="5608"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Don&#39;t climb into a loop though.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05609" /><CodeLine lineNumber="5609"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;IDomLoop = LI.getLoopFor(IDom);</Highlight></CodeLine>
<Link id="l05610" /><CodeLine lineNumber="5610"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> IDomDepth = IDomLoop ? IDomLoop-&gt;<a href="/docs/api/classes/llvm/loopbase/#a57994482c17097d9f936acff3a6598ac">getLoopDepth</a>() : 0;</Highlight></CodeLine>
<Link id="l05611" /><CodeLine lineNumber="5611"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IDomDepth &lt;= IPLoopDepth &amp;&amp;</Highlight></CodeLine>
<Link id="l05612" /><CodeLine lineNumber="5612"><Highlight kind="normal">          (IDomDepth != IPLoopDepth || IDomLoop == IPLoop))</Highlight></CodeLine>
<Link id="l05613" /><CodeLine lineNumber="5613"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05614" /><CodeLine lineNumber="5614"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05615" /><CodeLine lineNumber="5615"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05616" /><CodeLine lineNumber="5616"><Highlight kind="normal">    Tentative = IDom-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</Highlight></CodeLine>
<Link id="l05617" /><CodeLine lineNumber="5617"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05618" /><CodeLine lineNumber="5618"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05619" /><CodeLine lineNumber="5619"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IP;</Highlight></CodeLine>
<Link id="l05620" /><CodeLine lineNumber="5620"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05621" /><CodeLine lineNumber="5621"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05622" /><CodeLine lineNumber="5622"><Highlight kind="comment">/// Determine an input position which will be dominated by the operands and</Highlight></CodeLine>
<Link id="l05623" /><CodeLine lineNumber="5623"><Highlight kind="comment">/// which will dominate the result.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05624" /><CodeLine lineNumber="5624"><Highlight kind="normal"><a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> LSRInstance::AdjustInsertPositionForExpand(</Highlight></CodeLine>
<Link id="l05625" /><CodeLine lineNumber="5625"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> LowestIP, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRFixup &amp;LF, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l05626" /><CodeLine lineNumber="5626"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Collect some instructions which must be dominated by the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05627" /><CodeLine lineNumber="5627"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// expanding replacement. These must be dominated by any operands that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05628" /><CodeLine lineNumber="5628"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// will be required in the expansion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05629" /><CodeLine lineNumber="5629"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Instruction &#42;, 4&gt;</a> Inputs;</Highlight></CodeLine>
<Link id="l05630" /><CodeLine lineNumber="5630"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(LF.OperandValToReplace))</Highlight></CodeLine>
<Link id="l05631" /><CodeLine lineNumber="5631"><Highlight kind="normal">    Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l05632" /><CodeLine lineNumber="5632"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>)</Highlight></CodeLine>
<Link id="l05633" /><CodeLine lineNumber="5633"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> =</Highlight></CodeLine>
<Link id="l05634" /><CodeLine lineNumber="5634"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ICmpInst&gt;</a>(LF.UserInst)-&gt;getOperand(1)))</Highlight></CodeLine>
<Link id="l05635" /><CodeLine lineNumber="5635"><Highlight kind="normal">      Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l05636" /><CodeLine lineNumber="5636"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LF.PostIncLoops.count(L)) &#123;</Highlight></CodeLine>
<Link id="l05637" /><CodeLine lineNumber="5637"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LF.isUseFullyOutsideLoop(L))</Highlight></CodeLine>
<Link id="l05638" /><CodeLine lineNumber="5638"><Highlight kind="normal">      Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()-&gt;getTerminator());</Highlight></CodeLine>
<Link id="l05639" /><CodeLine lineNumber="5639"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05640" /><CodeLine lineNumber="5640"><Highlight kind="normal">      Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(IVIncInsertPos);</Highlight></CodeLine>
<Link id="l05641" /><CodeLine lineNumber="5641"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05642" /><CodeLine lineNumber="5642"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The expansion must also be dominated by the increment positions of any</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05643" /><CodeLine lineNumber="5643"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// loops it for which it is using post-inc mode.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05644" /><CodeLine lineNumber="5644"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;PIL : LF.PostIncLoops) &#123;</Highlight></CodeLine>
<Link id="l05645" /><CodeLine lineNumber="5645"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PIL == L) </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05646" /><CodeLine lineNumber="5646"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05647" /><CodeLine lineNumber="5647"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Be dominated by the loop exit.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05648" /><CodeLine lineNumber="5648"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 4&gt;</a> ExitingBlocks;</Highlight></CodeLine>
<Link id="l05649" /><CodeLine lineNumber="5649"><Highlight kind="normal">    PIL-&gt;<a href="/docs/api/classes/llvm/loopbase/#a46880fab7a9d5bd439725f2acc59b80d">getExitingBlocks</a>(ExitingBlocks);</Highlight></CodeLine>
<Link id="l05650" /><CodeLine lineNumber="5650"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!ExitingBlocks.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</Highlight></CodeLine>
<Link id="l05651" /><CodeLine lineNumber="5651"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB = ExitingBlocks&#91;0&#93;;</Highlight></CodeLine>
<Link id="l05652" /><CodeLine lineNumber="5652"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> i = 1, e = ExitingBlocks.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>(); i != e; ++i)</Highlight></CodeLine>
<Link id="l05653" /><CodeLine lineNumber="5653"><Highlight kind="normal">        BB = DT.findNearestCommonDominator(BB, ExitingBlocks&#91;i&#93;);</Highlight></CodeLine>
<Link id="l05654" /><CodeLine lineNumber="5654"><Highlight kind="normal">      Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</Highlight></CodeLine>
<Link id="l05655" /><CodeLine lineNumber="5655"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05656" /><CodeLine lineNumber="5656"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05657" /><CodeLine lineNumber="5657"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05658" /><CodeLine lineNumber="5658"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(LowestIP) &amp;&amp; !LowestIP-&gt;isEHPad()</Highlight></CodeLine>
<Link id="l05659" /><CodeLine lineNumber="5659"><Highlight kind="normal">         &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgInfoIntrinsic&gt;</a>(LowestIP) &amp;&amp;</Highlight></CodeLine>
<Link id="l05660" /><CodeLine lineNumber="5660"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Insertion point must be a normal instruction&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05661" /><CodeLine lineNumber="5661"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05662" /><CodeLine lineNumber="5662"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Then, climb up the immediate dominator tree as far as we can go while</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05663" /><CodeLine lineNumber="5663"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// still being dominated by the input positions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05664" /><CodeLine lineNumber="5664"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP = HoistInsertPosition(LowestIP, Inputs);</Highlight></CodeLine>
<Link id="l05665" /><CodeLine lineNumber="5665"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05666" /><CodeLine lineNumber="5666"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Don&#39;t insert instructions before PHI nodes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05667" /><CodeLine lineNumber="5667"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(IP)) ++IP;</Highlight></CodeLine>
<Link id="l05668" /><CodeLine lineNumber="5668"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05669" /><CodeLine lineNumber="5669"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ignore landingpad instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05670" /><CodeLine lineNumber="5670"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (IP-&gt;isEHPad()) ++IP;</Highlight></CodeLine>
<Link id="l05671" /><CodeLine lineNumber="5671"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05672" /><CodeLine lineNumber="5672"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Ignore debug intrinsics.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05673" /><CodeLine lineNumber="5673"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgInfoIntrinsic&gt;</a>(IP)) ++IP;</Highlight></CodeLine>
<Link id="l05674" /><CodeLine lineNumber="5674"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05675" /><CodeLine lineNumber="5675"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Set IP below instructions recently inserted by SCEVExpander. This keeps the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05676" /><CodeLine lineNumber="5676"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// IP consistent across expansions and allows the previously inserted</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05677" /><CodeLine lineNumber="5677"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// instructions to be reused by subsequent expansion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05678" /><CodeLine lineNumber="5678"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">while</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isInsertedInstruction(&amp;&#42;IP) &amp;&amp; IP != LowestIP)</Highlight></CodeLine>
<Link id="l05679" /><CodeLine lineNumber="5679"><Highlight kind="normal">    ++IP;</Highlight></CodeLine>
<Link id="l05680" /><CodeLine lineNumber="5680"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05681" /><CodeLine lineNumber="5681"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> IP;</Highlight></CodeLine>
<Link id="l05682" /><CodeLine lineNumber="5682"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05683" /><CodeLine lineNumber="5683"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05684" /><CodeLine lineNumber="5684"><Highlight kind="comment">/// Emit instructions for the leading candidate expression for this LSRUse (this</Highlight></CodeLine>
<Link id="l05685" /><CodeLine lineNumber="5685"><Highlight kind="comment">/// is called &quot;expanding&quot;).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05686" /><CodeLine lineNumber="5686"><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;LSRInstance::Expand(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRFixup &amp;LF,</Highlight></CodeLine>
<Link id="l05687" /><CodeLine lineNumber="5687"><Highlight kind="normal">                           </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</Highlight></CodeLine>
<Link id="l05688" /><CodeLine lineNumber="5688"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l05689" /><CodeLine lineNumber="5689"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.RigidFormula)</Highlight></CodeLine>
<Link id="l05690" /><CodeLine lineNumber="5690"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> LF.OperandValToReplace;</Highlight></CodeLine>
<Link id="l05691" /><CodeLine lineNumber="5691"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05692" /><CodeLine lineNumber="5692"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Determine an input position which will be dominated by the operands and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05693" /><CodeLine lineNumber="5693"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// which will dominate the result.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05694" /><CodeLine lineNumber="5694"><Highlight kind="normal">  IP = AdjustInsertPositionForExpand(IP, LF, LU);</Highlight></CodeLine>
<Link id="l05695" /><CodeLine lineNumber="5695"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setInsertPoint(&amp;&#42;IP);</Highlight></CodeLine>
<Link id="l05696" /><CodeLine lineNumber="5696"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05697" /><CodeLine lineNumber="5697"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Inform the Rewriter if we have a post-increment use, so that it can</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05698" /><CodeLine lineNumber="5698"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// perform an advantageous expansion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05699" /><CodeLine lineNumber="5699"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setPostInc(LF.PostIncLoops);</Highlight></CodeLine>
<Link id="l05700" /><CodeLine lineNumber="5700"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05701" /><CodeLine lineNumber="5701"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This is the type that the user actually needs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05702" /><CodeLine lineNumber="5702"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;OpTy = LF.OperandValToReplace-&gt;getType();</Highlight></CodeLine>
<Link id="l05703" /><CodeLine lineNumber="5703"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This will be the type that we&#39;ll initially expand to.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05704" /><CodeLine lineNumber="5704"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getType();</Highlight></CodeLine>
<Link id="l05705" /><CodeLine lineNumber="5705"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Ty)</Highlight></CodeLine>
<Link id="l05706" /><CodeLine lineNumber="5706"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// No type known; just expand directly to the ultimate type.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05707" /><CodeLine lineNumber="5707"><Highlight kind="normal">    Ty = OpTy;</Highlight></CodeLine>
<Link id="l05708" /><CodeLine lineNumber="5708"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.getEffectiveSCEVType(Ty) == SE.getEffectiveSCEVType(OpTy))</Highlight></CodeLine>
<Link id="l05709" /><CodeLine lineNumber="5709"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Expand directly to the ultimate type if it&#39;s the right size.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05710" /><CodeLine lineNumber="5710"><Highlight kind="normal">    Ty = OpTy;</Highlight></CodeLine>
<Link id="l05711" /><CodeLine lineNumber="5711"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// This is the type to do integer arithmetic in.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05712" /><CodeLine lineNumber="5712"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = SE.getEffectiveSCEVType(Ty);</Highlight></CodeLine>
<Link id="l05713" /><CodeLine lineNumber="5713"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05714" /><CodeLine lineNumber="5714"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Build up a list of operands to add together to form the full base.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05715" /><CodeLine lineNumber="5715"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</Highlight></CodeLine>
<Link id="l05716" /><CodeLine lineNumber="5716"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05717" /><CodeLine lineNumber="5717"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Expand the BaseRegs portion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05718" /><CodeLine lineNumber="5718"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</Highlight></CodeLine>
<Link id="l05719" /><CodeLine lineNumber="5719"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>-&gt;isZero() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Zero allocated in a base register!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05720" /><CodeLine lineNumber="5720"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05721" /><CodeLine lineNumber="5721"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If we&#39;re expanding for a post-inc user, make the post-inc adjustment.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05722" /><CodeLine lineNumber="5722"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> = <a href="/docs/api/namespaces/llvm/#a6fb1355b48afff4e97045b546b5f6415">denormalizeForPostIncUse</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, LF.PostIncLoops, SE);</Highlight></CodeLine>
<Link id="l05723" /><CodeLine lineNumber="5723"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)));</Highlight></CodeLine>
<Link id="l05724" /><CodeLine lineNumber="5724"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05725" /><CodeLine lineNumber="5725"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05726" /><CodeLine lineNumber="5726"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Expand the ScaledReg portion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05727" /><CodeLine lineNumber="5727"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;ICmpScaledV = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05728" /><CodeLine lineNumber="5728"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 0) &#123;</Highlight></CodeLine>
<Link id="l05729" /><CodeLine lineNumber="5729"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;ScaledS = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg;</Highlight></CodeLine>
<Link id="l05730" /><CodeLine lineNumber="5730"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05731" /><CodeLine lineNumber="5731"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If we&#39;re expanding for a post-inc user, make the post-inc adjustment.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05732" /><CodeLine lineNumber="5732"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a> = </Highlight><Highlight kind="keyword">const&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> &amp;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(LF.PostIncLoops);</Highlight></CodeLine>
<Link id="l05733" /><CodeLine lineNumber="5733"><Highlight kind="normal">    ScaledS = <a href="/docs/api/namespaces/llvm/#a6fb1355b48afff4e97045b546b5f6415">denormalizeForPostIncUse</a>(ScaledS, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>, SE);</Highlight></CodeLine>
<Link id="l05734" /><CodeLine lineNumber="5734"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05735" /><CodeLine lineNumber="5735"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>) &#123;</Highlight></CodeLine>
<Link id="l05736" /><CodeLine lineNumber="5736"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Expand ScaleReg as if it was part of the base regs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05737" /><CodeLine lineNumber="5737"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 1)</Highlight></CodeLine>
<Link id="l05738" /><CodeLine lineNumber="5738"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(</Highlight></CodeLine>
<Link id="l05739" /><CodeLine lineNumber="5739"><Highlight kind="normal">            SE.getUnknown(<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(ScaledS, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)));</Highlight></CodeLine>
<Link id="l05740" /><CodeLine lineNumber="5740"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05741" /><CodeLine lineNumber="5741"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// An interesting way of &quot;folding&quot; with an icmp is to use a negated</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05742" /><CodeLine lineNumber="5742"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// scale, which we&#39;ll implement by inserting it into the other operand</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05743" /><CodeLine lineNumber="5743"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// of the icmp.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05744" /><CodeLine lineNumber="5744"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == -1 &amp;&amp;</Highlight></CodeLine>
<Link id="l05745" /><CodeLine lineNumber="5745"><Highlight kind="normal">               </Highlight><Highlight kind="stringliteral">&quot;The only scale supported by ICmpZero uses is -1!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05746" /><CodeLine lineNumber="5746"><Highlight kind="normal">        ICmpScaledV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(ScaledS, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05747" /><CodeLine lineNumber="5747"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05748" /><CodeLine lineNumber="5748"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05749" /><CodeLine lineNumber="5749"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Otherwise just expand the scaled register and an explicit scale,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05750" /><CodeLine lineNumber="5750"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// which is expected to be matched as part of the address.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05751" /><CodeLine lineNumber="5751"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05752" /><CodeLine lineNumber="5752"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Flush the operand list to suppress SCEVExpander hoisting address modes.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05753" /><CodeLine lineNumber="5753"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Unless the addressing mode will not be folded.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05754" /><CodeLine lineNumber="5754"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.empty() &amp;&amp; LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> &amp;&amp;</Highlight></CodeLine>
<Link id="l05755" /><CodeLine lineNumber="5755"><Highlight kind="normal">          <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) &#123;</Highlight></CodeLine>
<Link id="l05756" /><CodeLine lineNumber="5756"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>), </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05757" /><CodeLine lineNumber="5757"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.clear();</Highlight></CodeLine>
<Link id="l05758" /><CodeLine lineNumber="5758"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(FullV));</Highlight></CodeLine>
<Link id="l05759" /><CodeLine lineNumber="5759"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05760" /><CodeLine lineNumber="5760"><Highlight kind="normal">      ScaledS = SE.getUnknown(<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(ScaledS, </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">));</Highlight></CodeLine>
<Link id="l05761" /><CodeLine lineNumber="5761"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 1)</Highlight></CodeLine>
<Link id="l05762" /><CodeLine lineNumber="5762"><Highlight kind="normal">        ScaledS =</Highlight></CodeLine>
<Link id="l05763" /><CodeLine lineNumber="5763"><Highlight kind="normal">            SE.getMulExpr(ScaledS, SE.getConstant(ScaledS-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale));</Highlight></CodeLine>
<Link id="l05764" /><CodeLine lineNumber="5764"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(ScaledS);</Highlight></CodeLine>
<Link id="l05765" /><CodeLine lineNumber="5765"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05766" /><CodeLine lineNumber="5766"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05767" /><CodeLine lineNumber="5767"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05768" /><CodeLine lineNumber="5768"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Expand the GV portion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05769" /><CodeLine lineNumber="5769"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV) &#123;</Highlight></CodeLine>
<Link id="l05770" /><CodeLine lineNumber="5770"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Flush the operand list to suppress SCEVExpander hoisting.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05771" /><CodeLine lineNumber="5771"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.empty()) &#123;</Highlight></CodeLine>
<Link id="l05772" /><CodeLine lineNumber="5772"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>), IntTy);</Highlight></CodeLine>
<Link id="l05773" /><CodeLine lineNumber="5773"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.clear();</Highlight></CodeLine>
<Link id="l05774" /><CodeLine lineNumber="5774"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(FullV));</Highlight></CodeLine>
<Link id="l05775" /><CodeLine lineNumber="5775"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05776" /><CodeLine lineNumber="5776"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV));</Highlight></CodeLine>
<Link id="l05777" /><CodeLine lineNumber="5777"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05778" /><CodeLine lineNumber="5778"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05779" /><CodeLine lineNumber="5779"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Flush the operand list to suppress SCEVExpander hoisting of both folded and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05780" /><CodeLine lineNumber="5780"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// unfolded offsets. LSR assumes they both live next to their uses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05781" /><CodeLine lineNumber="5781"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.empty()) &#123;</Highlight></CodeLine>
<Link id="l05782" /><CodeLine lineNumber="5782"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>), Ty);</Highlight></CodeLine>
<Link id="l05783" /><CodeLine lineNumber="5783"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.clear();</Highlight></CodeLine>
<Link id="l05784" /><CodeLine lineNumber="5784"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(FullV));</Highlight></CodeLine>
<Link id="l05785" /><CodeLine lineNumber="5785"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05786" /><CodeLine lineNumber="5786"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05787" /><CodeLine lineNumber="5787"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// FIXME: Are we sure we won&#39;t get a mismatch here? Is there a way to bail</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05788" /><CodeLine lineNumber="5788"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// out at this point, or should we generate a SCEV adding together mixed</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05789" /><CodeLine lineNumber="5789"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// offsets?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05790" /><CodeLine lineNumber="5790"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isCompatibleImmediate(LF.Offset) &amp;&amp;</Highlight></CodeLine>
<Link id="l05791" /><CodeLine lineNumber="5791"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Expanding mismatched offsets\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05792" /><CodeLine lineNumber="5792"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Expand the immediate portion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05793" /><CodeLine lineNumber="5793"><Highlight kind="normal">  Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.addUnsigned(LF.Offset);</Highlight></CodeLine>
<Link id="l05794" /><CodeLine lineNumber="5794"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isNonZero()) &#123;</Highlight></CodeLine>
<Link id="l05795" /><CodeLine lineNumber="5795"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>) &#123;</Highlight></CodeLine>
<Link id="l05796" /><CodeLine lineNumber="5796"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// The other interesting way of &quot;folding&quot; with an ICmpZero is to use a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05797" /><CodeLine lineNumber="5797"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// negated immediate.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05798" /><CodeLine lineNumber="5798"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!ICmpScaledV)</Highlight></CodeLine>
<Link id="l05799" /><CodeLine lineNumber="5799"><Highlight kind="normal">        ICmpScaledV =</Highlight></CodeLine>
<Link id="l05800" /><CodeLine lineNumber="5800"><Highlight kind="normal">            ConstantInt::get(IntTy, -(uint64&#95;t)<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue());</Highlight></CodeLine>
<Link id="l05801" /><CodeLine lineNumber="5801"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05802" /><CodeLine lineNumber="5802"><Highlight kind="normal">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(ICmpScaledV));</Highlight></CodeLine>
<Link id="l05803" /><CodeLine lineNumber="5803"><Highlight kind="normal">        ICmpScaledV = ConstantInt::get(IntTy, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue());</Highlight></CodeLine>
<Link id="l05804" /><CodeLine lineNumber="5804"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05805" /><CodeLine lineNumber="5805"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05806" /><CodeLine lineNumber="5806"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Just add the immediate values. These again are expected to be matched</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05807" /><CodeLine lineNumber="5807"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// as part of the address.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05808" /><CodeLine lineNumber="5808"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getUnknownSCEV(SE, IntTy));</Highlight></CodeLine>
<Link id="l05809" /><CodeLine lineNumber="5809"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05810" /><CodeLine lineNumber="5810"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05811" /><CodeLine lineNumber="5811"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05812" /><CodeLine lineNumber="5812"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Expand the unfolded offset portion.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05813" /><CodeLine lineNumber="5813"><Highlight kind="normal">  Immediate UnfoldedOffset = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset;</Highlight></CodeLine>
<Link id="l05814" /><CodeLine lineNumber="5814"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (UnfoldedOffset.isNonZero()) &#123;</Highlight></CodeLine>
<Link id="l05815" /><CodeLine lineNumber="5815"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Just add the immediate values.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05816" /><CodeLine lineNumber="5816"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(UnfoldedOffset.getUnknownSCEV(SE, IntTy));</Highlight></CodeLine>
<Link id="l05817" /><CodeLine lineNumber="5817"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05818" /><CodeLine lineNumber="5818"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05819" /><CodeLine lineNumber="5819"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Emit instructions summing all the operands.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05820" /><CodeLine lineNumber="5820"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;FullS = <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.empty() ?</Highlight></CodeLine>
<Link id="l05821" /><CodeLine lineNumber="5821"><Highlight kind="normal">                      SE.getConstant(IntTy, 0) :</Highlight></CodeLine>
<Link id="l05822" /><CodeLine lineNumber="5822"><Highlight kind="normal">                      SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>);</Highlight></CodeLine>
<Link id="l05823" /><CodeLine lineNumber="5823"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(FullS, Ty);</Highlight></CodeLine>
<Link id="l05824" /><CodeLine lineNumber="5824"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05825" /><CodeLine lineNumber="5825"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We&#39;re done expanding now, so reset the rewriter.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05826" /><CodeLine lineNumber="5826"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clearPostInc();</Highlight></CodeLine>
<Link id="l05827" /><CodeLine lineNumber="5827"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05828" /><CodeLine lineNumber="5828"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// An ICmpZero Formula represents an ICmp which we&#39;re handling as a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05829" /><CodeLine lineNumber="5829"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// comparison against zero. Now that we&#39;ve expanded an expression for that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05830" /><CodeLine lineNumber="5830"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// form, update the ICmp&#39;s other operand.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05831" /><CodeLine lineNumber="5831"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>) &#123;</Highlight></CodeLine>
<Link id="l05832" /><CodeLine lineNumber="5832"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;CI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ICmpInst&gt;</a>(LF.UserInst);</Highlight></CodeLine>
<Link id="l05833" /><CodeLine lineNumber="5833"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;OperandIsInstr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(CI-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1)))</Highlight></CodeLine>
<Link id="l05834" /><CodeLine lineNumber="5834"><Highlight kind="normal">      DeadInsts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(OperandIsInstr);</Highlight></CodeLine>
<Link id="l05835" /><CodeLine lineNumber="5835"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;ICmp does not support folding a global value and &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05836" /><CodeLine lineNumber="5836"><Highlight kind="normal">                           </Highlight><Highlight kind="stringliteral">&quot;a scale at the same time!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05837" /><CodeLine lineNumber="5837"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == -1) &#123;</Highlight></CodeLine>
<Link id="l05838" /><CodeLine lineNumber="5838"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ICmpScaledV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != OpTy) &#123;</Highlight></CodeLine>
<Link id="l05839" /><CodeLine lineNumber="5839"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Cast = <a href="/docs/api/classes/llvm/castinst/#ad2e0ab6d7096fe67a2216fe349044387">CastInst::Create</a>(</Highlight></CodeLine>
<Link id="l05840" /><CodeLine lineNumber="5840"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/castinst/#a06dc25da1f16f389f5244304e8d33127">CastInst::getCastOpcode</a>(ICmpScaledV, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, OpTy, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l05841" /><CodeLine lineNumber="5841"><Highlight kind="normal">            ICmpScaledV, OpTy, </Highlight><Highlight kind="stringliteral">&quot;tmp&quot;</Highlight><Highlight kind="normal">, CI-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l05842" /><CodeLine lineNumber="5842"><Highlight kind="normal">        ICmpScaledV = Cast;</Highlight></CodeLine>
<Link id="l05843" /><CodeLine lineNumber="5843"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05844" /><CodeLine lineNumber="5844"><Highlight kind="normal">      CI-&gt;<a href="/docs/api/classes/llvm/user/#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, ICmpScaledV);</Highlight></CodeLine>
<Link id="l05845" /><CodeLine lineNumber="5845"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05846" /><CodeLine lineNumber="5846"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// A scale of 1 means that the scale has been expanded as part of the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05847" /><CodeLine lineNumber="5847"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// base regs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05848" /><CodeLine lineNumber="5848"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 0 || <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 1) &amp;&amp;</Highlight></CodeLine>
<Link id="l05849" /><CodeLine lineNumber="5849"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;ICmp does not support folding a global value and &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05850" /><CodeLine lineNumber="5850"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;a scale at the same time!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05851" /><CodeLine lineNumber="5851"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(SE.getEffectiveSCEVType(OpTy),</Highlight></CodeLine>
<Link id="l05852" /><CodeLine lineNumber="5852"><Highlight kind="normal">                                           -(uint64&#95;t)<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue());</Highlight></CodeLine>
<Link id="l05853" /><CodeLine lineNumber="5853"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getType() != OpTy) &#123;</Highlight></CodeLine>
<Link id="l05854" /><CodeLine lineNumber="5854"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a8bf77c90e2fb57af4d4d4aab084f7052">ConstantFoldCastOperand</a>(</Highlight></CodeLine>
<Link id="l05855" /><CodeLine lineNumber="5855"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/castinst/#a06dc25da1f16f389f5244304e8d33127">CastInst::getCastOpcode</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, OpTy, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">), <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, OpTy,</Highlight></CodeLine>
<Link id="l05856" /><CodeLine lineNumber="5856"><Highlight kind="normal">            CI-&gt;<a href="/docs/api/classes/llvm/instruction/#af65afd02332c4f21c2fab7d217d6600f">getDataLayout</a>());</Highlight></CodeLine>
<Link id="l05857" /><CodeLine lineNumber="5857"><Highlight kind="normal">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Cast of ConstantInt should have folded&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l05858" /><CodeLine lineNumber="5858"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05859" /><CodeLine lineNumber="5859"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05860" /><CodeLine lineNumber="5860"><Highlight kind="normal">      CI-&gt;<a href="/docs/api/classes/llvm/user/#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>);</Highlight></CodeLine>
<Link id="l05861" /><CodeLine lineNumber="5861"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05862" /><CodeLine lineNumber="5862"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l05863" /><CodeLine lineNumber="5863"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05864" /><CodeLine lineNumber="5864"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> FullV;</Highlight></CodeLine>
<Link id="l05865" /><CodeLine lineNumber="5865"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05866" /><CodeLine lineNumber="5866"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05867" /><CodeLine lineNumber="5867"><Highlight kind="comment">/// Helper for Rewrite. PHI nodes are special because the use of their operands</Highlight></CodeLine>
<Link id="l05868" /><CodeLine lineNumber="5868"><Highlight kind="comment">/// effectively happens in their predecessor blocks, so the expression may need</Highlight></CodeLine>
<Link id="l05869" /><CodeLine lineNumber="5869"><Highlight kind="comment">/// to be expanded in multiple places.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05870" /><CodeLine lineNumber="5870"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::RewriteForPHI(<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU,</Highlight></CodeLine>
<Link id="l05871" /><CodeLine lineNumber="5871"><Highlight kind="normal">                                </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRFixup &amp;LF, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l05872" /><CodeLine lineNumber="5872"><Highlight kind="normal">                                <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts) &#123;</Highlight></CodeLine>
<Link id="l05873" /><CodeLine lineNumber="5873"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;BasicBlock &#42;, Value &#42;&gt;</a> <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a>;</Highlight></CodeLine>
<Link id="l05874" /><CodeLine lineNumber="5874"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05875" /><CodeLine lineNumber="5875"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> i = 0, e = PN-&gt;<a href="/docs/api/classes/llvm/phinode/#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); i != e; ++i)</Highlight></CodeLine>
<Link id="l05876" /><CodeLine lineNumber="5876"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (PN-&gt;<a href="/docs/api/classes/llvm/phinode/#aca1fd00f3ab63ec8f0f1ccc2093a9f6d">getIncomingValue</a>(i) == LF.OperandValToReplace) &#123;</Highlight></CodeLine>
<Link id="l05877" /><CodeLine lineNumber="5877"><Highlight kind="normal">      </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> needUpdateFixups = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05878" /><CodeLine lineNumber="5878"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB = PN-&gt;<a href="/docs/api/classes/llvm/phinode/#ac53e1aabdf64e91b8b325bcac250d8a9">getIncomingBlock</a>(i);</Highlight></CodeLine>
<Link id="l05879" /><CodeLine lineNumber="5879"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05880" /><CodeLine lineNumber="5880"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If this is a critical edge, split the edge so that we do not insert</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05881" /><CodeLine lineNumber="5881"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// the code on all predecessor/successor paths.  We do this unless this</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05882" /><CodeLine lineNumber="5882"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// is the canonical backedge for this loop, which complicates post-inc</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05883" /><CodeLine lineNumber="5883"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// users.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05884" /><CodeLine lineNumber="5884"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (e != 1 &amp;&amp; BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>() &gt; 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l05885" /><CodeLine lineNumber="5885"><Highlight kind="normal">          !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;IndirectBrInst&gt;</a>(BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()) &amp;&amp;</Highlight></CodeLine>
<Link id="l05886" /><CodeLine lineNumber="5886"><Highlight kind="normal">          !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>())) &#123;</Highlight></CodeLine>
<Link id="l05887" /><CodeLine lineNumber="5887"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Parent = PN-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>();</Highlight></CodeLine>
<Link id="l05888" /><CodeLine lineNumber="5888"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;PNLoop = LI.getLoopFor(Parent);</Highlight></CodeLine>
<Link id="l05889" /><CodeLine lineNumber="5889"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!PNLoop || Parent != PNLoop-&gt;<a href="/docs/api/classes/llvm/loopbase/#a4a75755081e9a3803d2f4ccf6f0cb1f8">getHeader</a>()) &#123;</Highlight></CodeLine>
<Link id="l05890" /><CodeLine lineNumber="5890"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// Split the critical edge.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05891" /><CodeLine lineNumber="5891"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;NewBB = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05892" /><CodeLine lineNumber="5892"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Parent-&gt;<a href="/docs/api/classes/llvm/basicblock/#ac3a2a666b5703b8c9bda318ef18c731c">isLandingPad</a>()) &#123;</Highlight></CodeLine>
<Link id="l05893" /><CodeLine lineNumber="5893"><Highlight kind="normal">            NewBB =</Highlight></CodeLine>
<Link id="l05894" /><CodeLine lineNumber="5894"><Highlight kind="normal">                <a href="/docs/api/namespaces/llvm/#ab61955a622d233750894890e0704da5c">SplitCriticalEdge</a>(BB, Parent,</Highlight></CodeLine>
<Link id="l05895" /><CodeLine lineNumber="5895"><Highlight kind="normal">                                  <a href="/docs/api/structs/llvm/criticaledgesplittingoptions">CriticalEdgeSplittingOptions</a>(&amp;DT, &amp;LI, MSSAU)</Highlight></CodeLine>
<Link id="l05896" /><CodeLine lineNumber="5896"><Highlight kind="normal">                                      .setMergeIdenticalEdges()</Highlight></CodeLine>
<Link id="l05897" /><CodeLine lineNumber="5897"><Highlight kind="normal">                                      .setKeepOneInputPHIs());</Highlight></CodeLine>
<Link id="l05898" /><CodeLine lineNumber="5898"><Highlight kind="normal">          &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05899" /><CodeLine lineNumber="5899"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock&#42;, 2&gt;</a> NewBBs;</Highlight></CodeLine>
<Link id="l05900" /><CodeLine lineNumber="5900"><Highlight kind="normal">            <a href="/docs/api/classes/llvm/domtreeupdater">DomTreeUpdater</a> DTU(DT, DomTreeUpdater::UpdateStrategy::Eager);</Highlight></CodeLine>
<Link id="l05901" /><CodeLine lineNumber="5901"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/#a949b0428c89b8ccf62d469bd325244ed">SplitLandingPadPredecessors</a>(Parent, BB, </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="stringliteral">&quot;&quot;</Highlight><Highlight kind="normal">, NewBBs, &amp;DTU, &amp;LI);</Highlight></CodeLine>
<Link id="l05902" /><CodeLine lineNumber="5902"><Highlight kind="normal">            NewBB = NewBBs&#91;0&#93;;</Highlight></CodeLine>
<Link id="l05903" /><CodeLine lineNumber="5903"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l05904" /><CodeLine lineNumber="5904"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// If NewBB==NULL, then SplitCriticalEdge refused to split because all</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05905" /><CodeLine lineNumber="5905"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// phi predecessors are identical. The simple thing to do is skip</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05906" /><CodeLine lineNumber="5906"><Highlight kind="normal">          </Highlight><Highlight kind="comment">// splitting in this case rather than complicate the API.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05907" /><CodeLine lineNumber="5907"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NewBB) &#123;</Highlight></CodeLine>
<Link id="l05908" /><CodeLine lineNumber="5908"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// If PN is outside of the loop and BB is in the loop, we want to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05909" /><CodeLine lineNumber="5909"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// move the block to be immediately before the PHI block, not</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05910" /><CodeLine lineNumber="5910"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// immediately after BB.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05911" /><CodeLine lineNumber="5911"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(BB) &amp;&amp; !<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(PN))</Highlight></CodeLine>
<Link id="l05912" /><CodeLine lineNumber="5912"><Highlight kind="normal">              NewBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#ac1fd6437bbfce263b87f01767d950ce5">moveBefore</a>(PN-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>());</Highlight></CodeLine>
<Link id="l05913" /><CodeLine lineNumber="5913"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05914" /><CodeLine lineNumber="5914"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// Splitting the edge can reduce the number of PHI entries we have.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05915" /><CodeLine lineNumber="5915"><Highlight kind="normal">            <a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = PN-&gt;<a href="/docs/api/classes/llvm/phinode/#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>();</Highlight></CodeLine>
<Link id="l05916" /><CodeLine lineNumber="5916"><Highlight kind="normal">            BB = NewBB;</Highlight></CodeLine>
<Link id="l05917" /><CodeLine lineNumber="5917"><Highlight kind="normal">            i = PN-&gt;<a href="/docs/api/classes/llvm/phinode/#ae9562b96f6f3fa41bd36538c080035ee">getBasicBlockIndex</a>(BB);</Highlight></CodeLine>
<Link id="l05918" /><CodeLine lineNumber="5918"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05919" /><CodeLine lineNumber="5919"><Highlight kind="normal">            needUpdateFixups = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05920" /><CodeLine lineNumber="5920"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l05921" /><CodeLine lineNumber="5921"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l05922" /><CodeLine lineNumber="5922"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05923" /><CodeLine lineNumber="5923"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05924" /><CodeLine lineNumber="5924"><Highlight kind="normal">      std::pair&lt;DenseMap&lt;BasicBlock &#42;, Value &#42;&gt;::iterator, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal">&gt; Pair =</Highlight></CodeLine>
<Link id="l05925" /><CodeLine lineNumber="5925"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a>.insert(std::make&#95;pair(BB, </Highlight><Highlight kind="keyword">static&#95;cast&lt;</Highlight><Highlight kind="normal"><a href="/docs/api/classes/llvm/value">Value</a> &#42;</Highlight><Highlight kind="keyword">&gt;</Highlight><Highlight kind="normal">(</Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">)));</Highlight></CodeLine>
<Link id="l05926" /><CodeLine lineNumber="5926"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Pair.second)</Highlight></CodeLine>
<Link id="l05927" /><CodeLine lineNumber="5927"><Highlight kind="normal">        PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(i, Pair.first-&gt;second);</Highlight></CodeLine>
<Link id="l05928" /><CodeLine lineNumber="5928"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l05929" /><CodeLine lineNumber="5929"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV =</Highlight></CodeLine>
<Link id="l05930" /><CodeLine lineNumber="5930"><Highlight kind="normal">            Expand(LU, LF, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>(), DeadInsts);</Highlight></CodeLine>
<Link id="l05931" /><CodeLine lineNumber="5931"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05932" /><CodeLine lineNumber="5932"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// If this is reuse-by-noop-cast, insert the noop cast.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05933" /><CodeLine lineNumber="5933"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/type">Type</a> &#42;OpTy = LF.OperandValToReplace-&gt;getType();</Highlight></CodeLine>
<Link id="l05934" /><CodeLine lineNumber="5934"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FullV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != OpTy)</Highlight></CodeLine>
<Link id="l05935" /><CodeLine lineNumber="5935"><Highlight kind="normal">          FullV = <a href="/docs/api/classes/llvm/castinst/#ad2e0ab6d7096fe67a2216fe349044387">CastInst::Create</a>(</Highlight></CodeLine>
<Link id="l05936" /><CodeLine lineNumber="5936"><Highlight kind="normal">              <a href="/docs/api/classes/llvm/castinst/#a06dc25da1f16f389f5244304e8d33127">CastInst::getCastOpcode</a>(FullV, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, OpTy, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">), FullV,</Highlight></CodeLine>
<Link id="l05937" /><CodeLine lineNumber="5937"><Highlight kind="normal">              LF.OperandValToReplace-&gt;getType(), </Highlight><Highlight kind="stringliteral">&quot;tmp&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l05938" /><CodeLine lineNumber="5938"><Highlight kind="normal">              BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</Highlight></CodeLine>
<Link id="l05939" /><CodeLine lineNumber="5939"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05940" /><CodeLine lineNumber="5940"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// If the incoming block for this value is not in the loop, it means the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05941" /><CodeLine lineNumber="5941"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// current PHI is not in a loop exit, so we must create a LCSSA PHI for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05942" /><CodeLine lineNumber="5942"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// the inserted value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05943" /><CodeLine lineNumber="5943"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(FullV))</Highlight></CodeLine>
<Link id="l05944" /><CodeLine lineNumber="5944"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; !<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(BB))</Highlight></CodeLine>
<Link id="l05945" /><CodeLine lineNumber="5945"><Highlight kind="normal">            InsertedNonLCSSAInsts.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l05946" /><CodeLine lineNumber="5946"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05947" /><CodeLine lineNumber="5947"><Highlight kind="normal">        PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(i, FullV);</Highlight></CodeLine>
<Link id="l05948" /><CodeLine lineNumber="5948"><Highlight kind="normal">        Pair.first-&gt;second = FullV;</Highlight></CodeLine>
<Link id="l05949" /><CodeLine lineNumber="5949"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05950" /><CodeLine lineNumber="5950"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05951" /><CodeLine lineNumber="5951"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If LSR splits critical edge and phi node has other pending</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05952" /><CodeLine lineNumber="5952"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// fixup operands, we need to update those pending fixups. Otherwise</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05953" /><CodeLine lineNumber="5953"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// formulae will not be implemented completely and some instructions</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05954" /><CodeLine lineNumber="5954"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// will not be eliminated.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05955" /><CodeLine lineNumber="5955"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (needUpdateFixups) &#123;</Highlight></CodeLine>
<Link id="l05956" /><CodeLine lineNumber="5956"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (LSRUse &amp;LU : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>)</Highlight></CodeLine>
<Link id="l05957" /><CodeLine lineNumber="5957"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : LU.Fixups)</Highlight></CodeLine>
<Link id="l05958" /><CodeLine lineNumber="5958"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// If fixup is supposed to rewrite some operand in the phi</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05959" /><CodeLine lineNumber="5959"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// that was just updated, it may be already moved to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05960" /><CodeLine lineNumber="5960"><Highlight kind="normal">            </Highlight><Highlight kind="comment">// another phi node. Such fixup requires update.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05961" /><CodeLine lineNumber="5961"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst == PN) &#123;</Highlight></CodeLine>
<Link id="l05962" /><CodeLine lineNumber="5962"><Highlight kind="normal">              </Highlight><Highlight kind="comment">// Check if the operand we try to replace still exists in the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05963" /><CodeLine lineNumber="5963"><Highlight kind="normal">              </Highlight><Highlight kind="comment">// original phi.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05964" /><CodeLine lineNumber="5964"><Highlight kind="normal">              </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> foundInOriginalPHI = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05965" /><CodeLine lineNumber="5965"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;val : PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a1f0ff79b64a40d383b891f1baba89c6b">incoming&#95;values</a>())</Highlight></CodeLine>
<Link id="l05966" /><CodeLine lineNumber="5966"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (val == <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.OperandValToReplace) &#123;</Highlight></CodeLine>
<Link id="l05967" /><CodeLine lineNumber="5967"><Highlight kind="normal">                  foundInOriginalPHI = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05968" /><CodeLine lineNumber="5968"><Highlight kind="normal">                  </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05969" /><CodeLine lineNumber="5969"><Highlight kind="normal">                &#125;</Highlight></CodeLine>
<Link id="l05970" /><CodeLine lineNumber="5970"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05971" /><CodeLine lineNumber="5971"><Highlight kind="normal">              </Highlight><Highlight kind="comment">// If fixup operand found in original PHI - nothing to do.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05972" /><CodeLine lineNumber="5972"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (foundInOriginalPHI)</Highlight></CodeLine>
<Link id="l05973" /><CodeLine lineNumber="5973"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l05974" /><CodeLine lineNumber="5974"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05975" /><CodeLine lineNumber="5975"><Highlight kind="normal">              </Highlight><Highlight kind="comment">// Otherwise it might be moved to another PHI and requires update.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05976" /><CodeLine lineNumber="5976"><Highlight kind="normal">              </Highlight><Highlight kind="comment">// If fixup operand not found in any of the incoming blocks that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05977" /><CodeLine lineNumber="5977"><Highlight kind="normal">              </Highlight><Highlight kind="comment">// means we have already rewritten it - nothing to do.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05978" /><CodeLine lineNumber="5978"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> : PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a14cf6d7a36d091cb666cb83221b81d72">blocks</a>())</Highlight></CodeLine>
<Link id="l05979" /><CodeLine lineNumber="5979"><Highlight kind="normal">                </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;begin(); <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l05980" /><CodeLine lineNumber="5980"><Highlight kind="normal">                     ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</Highlight></CodeLine>
<Link id="l05981" /><CodeLine lineNumber="5981"><Highlight kind="normal">                  <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;NewPN = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l05982" /><CodeLine lineNumber="5982"><Highlight kind="normal">                  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;val : NewPN-&gt;<a href="/docs/api/classes/llvm/phinode/#a1f0ff79b64a40d383b891f1baba89c6b">incoming&#95;values</a>())</Highlight></CodeLine>
<Link id="l05983" /><CodeLine lineNumber="5983"><Highlight kind="normal">                    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (val == <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.OperandValToReplace)</Highlight></CodeLine>
<Link id="l05984" /><CodeLine lineNumber="5984"><Highlight kind="normal">                      <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst = NewPN;</Highlight></CodeLine>
<Link id="l05985" /><CodeLine lineNumber="5985"><Highlight kind="normal">                &#125;</Highlight></CodeLine>
<Link id="l05986" /><CodeLine lineNumber="5986"><Highlight kind="normal">            &#125;</Highlight></CodeLine>
<Link id="l05987" /><CodeLine lineNumber="5987"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l05988" /><CodeLine lineNumber="5988"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l05989" /><CodeLine lineNumber="5989"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l05990" /><CodeLine lineNumber="5990"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l05991" /><CodeLine lineNumber="5991"><Highlight kind="comment">/// Emit instructions for the leading candidate expression for this LSRUse (this</Highlight></CodeLine>
<Link id="l05992" /><CodeLine lineNumber="5992"><Highlight kind="comment">/// is called &quot;expanding&quot;), and update the UserInst to reference the newly</Highlight></CodeLine>
<Link id="l05993" /><CodeLine lineNumber="5993"><Highlight kind="comment">/// expanded value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05994" /><CodeLine lineNumber="5994"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::Rewrite(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRFixup &amp;LF,</Highlight></CodeLine>
<Link id="l05995" /><CodeLine lineNumber="5995"><Highlight kind="normal">                          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</Highlight></CodeLine>
<Link id="l05996" /><CodeLine lineNumber="5996"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts) &#123;</Highlight></CodeLine>
<Link id="l05997" /><CodeLine lineNumber="5997"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// First, find an insertion point that dominates UserInst. For PHI nodes,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05998" /><CodeLine lineNumber="5998"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// find the nearest block which dominates all the relevant uses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l05999" /><CodeLine lineNumber="5999"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(LF.UserInst)) &#123;</Highlight></CodeLine>
<Link id="l06000" /><CodeLine lineNumber="6000"><Highlight kind="normal">    RewriteForPHI(PN, LU, LF, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, DeadInsts);</Highlight></CodeLine>
<Link id="l06001" /><CodeLine lineNumber="6001"><Highlight kind="normal">  &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06002" /><CodeLine lineNumber="6002"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = Expand(LU, LF, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, LF.UserInst-&gt;getIterator(), DeadInsts);</Highlight></CodeLine>
<Link id="l06003" /><CodeLine lineNumber="6003"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06004" /><CodeLine lineNumber="6004"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If this is reuse-by-noop-cast, insert the noop cast.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06005" /><CodeLine lineNumber="6005"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;OpTy = LF.OperandValToReplace-&gt;getType();</Highlight></CodeLine>
<Link id="l06006" /><CodeLine lineNumber="6006"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (FullV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != OpTy) &#123;</Highlight></CodeLine>
<Link id="l06007" /><CodeLine lineNumber="6007"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Cast =</Highlight></CodeLine>
<Link id="l06008" /><CodeLine lineNumber="6008"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/castinst/#ad2e0ab6d7096fe67a2216fe349044387">CastInst::Create</a>(<a href="/docs/api/classes/llvm/castinst/#a06dc25da1f16f389f5244304e8d33127">CastInst::getCastOpcode</a>(FullV, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, OpTy, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">),</Highlight></CodeLine>
<Link id="l06009" /><CodeLine lineNumber="6009"><Highlight kind="normal">                           FullV, OpTy, </Highlight><Highlight kind="stringliteral">&quot;tmp&quot;</Highlight><Highlight kind="normal">, LF.UserInst-&gt;getIterator());</Highlight></CodeLine>
<Link id="l06010" /><CodeLine lineNumber="6010"><Highlight kind="normal">      FullV = Cast;</Highlight></CodeLine>
<Link id="l06011" /><CodeLine lineNumber="6011"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06012" /><CodeLine lineNumber="6012"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06013" /><CodeLine lineNumber="6013"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Update the user. ICmpZero is handled specially here (for now) because</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06014" /><CodeLine lineNumber="6014"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Expand may have updated one of the operands of the icmp already, and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06015" /><CodeLine lineNumber="6015"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// its new value may happen to be equal to LF.OperandValToReplace, in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06016" /><CodeLine lineNumber="6016"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// which case doing replaceUsesOfWith leads to replacing both operands</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06017" /><CodeLine lineNumber="6017"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// with the same value. TODO: Reorganize this.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06018" /><CodeLine lineNumber="6018"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>)</Highlight></CodeLine>
<Link id="l06019" /><CodeLine lineNumber="6019"><Highlight kind="normal">      LF.UserInst-&gt;setOperand(0, FullV);</Highlight></CodeLine>
<Link id="l06020" /><CodeLine lineNumber="6020"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06021" /><CodeLine lineNumber="6021"><Highlight kind="normal">      LF.UserInst-&gt;replaceUsesOfWith(LF.OperandValToReplace, FullV);</Highlight></CodeLine>
<Link id="l06022" /><CodeLine lineNumber="6022"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06023" /><CodeLine lineNumber="6023"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06024" /><CodeLine lineNumber="6024"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;OperandIsInstr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(LF.OperandValToReplace))</Highlight></CodeLine>
<Link id="l06025" /><CodeLine lineNumber="6025"><Highlight kind="normal">    DeadInsts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(OperandIsInstr);</Highlight></CodeLine>
<Link id="l06026" /><CodeLine lineNumber="6026"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06027" /><CodeLine lineNumber="6027"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06028" /><CodeLine lineNumber="6028"><Highlight kind="normal"></Highlight><Highlight kind="comment">// Trying to hoist the IVInc to loop header if all IVInc users are in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06029" /><CodeLine lineNumber="6029"><Highlight kind="normal"></Highlight><Highlight kind="comment">// the loop header. It will help backend to generate post index load/store</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06030" /><CodeLine lineNumber="6030"><Highlight kind="normal"></Highlight><Highlight kind="comment">// when the latch block is different from loop header block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06031" /><CodeLine lineNumber="6031" lineLink="#aa12378426474ba414b8bc234a26fd19b"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#aa12378426474ba414b8bc234a26fd19b">canHoistIVInc</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>,</Highlight></CodeLine>
<Link id="l06032" /><CodeLine lineNumber="6032"><Highlight kind="normal">                          </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRUse &amp;LU, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVIncInsertPos,</Highlight></CodeLine>
<Link id="l06033" /><CodeLine lineNumber="6033"><Highlight kind="normal">                          <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L) &#123;</Highlight></CodeLine>
<Link id="l06034" /><CodeLine lineNumber="6034"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>)</Highlight></CodeLine>
<Link id="l06035" /><CodeLine lineNumber="6035"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06036" /><CodeLine lineNumber="6036"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06037" /><CodeLine lineNumber="6037"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// For now this code do the conservative optimization, only work for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06038" /><CodeLine lineNumber="6038"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the header block. Later we can hoist the IVInc to the block post</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06039" /><CodeLine lineNumber="6039"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// dominate all users.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06040" /><CodeLine lineNumber="6040"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;LHeader = L-&gt;getHeader();</Highlight></CodeLine>
<Link id="l06041" /><CodeLine lineNumber="6041"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IVIncInsertPos-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() == LHeader)</Highlight></CodeLine>
<Link id="l06042" /><CodeLine lineNumber="6042"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06043" /><CodeLine lineNumber="6043"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06044" /><CodeLine lineNumber="6044"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.OperandValToReplace ||</Highlight></CodeLine>
<Link id="l06045" /><CodeLine lineNumber="6045"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a61d13d6824ec46c31260a4fd0997eda0">any&#95;of</a>(<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.OperandValToReplace-&gt;users(), &#91;&amp;LHeader&#93;(<a href="/docs/api/classes/llvm/user">User</a> &#42;U) &#123;</Highlight></CodeLine>
<Link id="l06046" /><CodeLine lineNumber="6046"><Highlight kind="normal">        Instruction &#42;UI = cast&lt;Instruction&gt;(U);</Highlight></CodeLine>
<Link id="l06047" /><CodeLine lineNumber="6047"><Highlight kind="normal">        return UI-&gt;getParent() != LHeader;</Highlight></CodeLine>
<Link id="l06048" /><CodeLine lineNumber="6048"><Highlight kind="normal">      &#125;))</Highlight></CodeLine>
<Link id="l06049" /><CodeLine lineNumber="6049"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06050" /><CodeLine lineNumber="6050"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06051" /><CodeLine lineNumber="6051"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst;</Highlight></CodeLine>
<Link id="l06052" /><CodeLine lineNumber="6052"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType();</Highlight></CodeLine>
<Link id="l06053" /><CodeLine lineNumber="6053"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Ty-&gt;isIntegerTy() &amp;&amp;</Highlight></CodeLine>
<Link id="l06054" /><CodeLine lineNumber="6054"><Highlight kind="normal">         ((<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;LoadInst&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedLoadLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, Ty)) ||</Highlight></CodeLine>
<Link id="l06055" /><CodeLine lineNumber="6055"><Highlight kind="normal">          (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;StoreInst&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedStoreLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, Ty)));</Highlight></CodeLine>
<Link id="l06056" /><CodeLine lineNumber="6056"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06057" /><CodeLine lineNumber="6057"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06058" /><CodeLine lineNumber="6058"><Highlight kind="comment">/// Rewrite all the fixup locations with new values, following the chosen</Highlight></CodeLine>
<Link id="l06059" /><CodeLine lineNumber="6059"><Highlight kind="comment">/// solution.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06060" /><CodeLine lineNumber="6060"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LSRInstance::ImplementSolution(</Highlight></CodeLine>
<Link id="l06061" /><CodeLine lineNumber="6061"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution) &#123;</Highlight></CodeLine>
<Link id="l06062" /><CodeLine lineNumber="6062"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Keep track of instructions we may have made dead, so that</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06063" /><CodeLine lineNumber="6063"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// we can remove them after we are done working.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06064" /><CodeLine lineNumber="6064"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WeakTrackingVH, 16&gt;</a> DeadInsts;</Highlight></CodeLine>
<Link id="l06065" /><CodeLine lineNumber="6065"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06066" /><CodeLine lineNumber="6066"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Mark phi nodes that terminate chains so the expander tries to reuse them.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06067" /><CodeLine lineNumber="6067"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> IVChain &amp;Chain : IVChainVec) &#123;</Highlight></CodeLine>
<Link id="l06068" /><CodeLine lineNumber="6068"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.tailUserInst()))</Highlight></CodeLine>
<Link id="l06069" /><CodeLine lineNumber="6069"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setChainedPhi(PN);</Highlight></CodeLine>
<Link id="l06070" /><CodeLine lineNumber="6070"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06071" /><CodeLine lineNumber="6071"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06072" /><CodeLine lineNumber="6072"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Expand the new value definitions and update the users.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06073" /><CodeLine lineNumber="6073"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">size&#95;t</Highlight><Highlight kind="normal"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx)</Highlight></CodeLine>
<Link id="l06074" /><CodeLine lineNumber="6074"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;.Fixups) &#123;</Highlight></CodeLine>
<Link id="l06075" /><CodeLine lineNumber="6075"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;InsertPos =</Highlight></CodeLine>
<Link id="l06076" /><CodeLine lineNumber="6076"><Highlight kind="normal">          <a href="#aa12378426474ba414b8bc234a26fd19b">canHoistIVInc</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>, <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;, IVIncInsertPos, L)</Highlight></CodeLine>
<Link id="l06077" /><CodeLine lineNumber="6077"><Highlight kind="normal">              ? <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getTerminator()</Highlight></CodeLine>
<Link id="l06078" /><CodeLine lineNumber="6078"><Highlight kind="normal">              : IVIncInsertPos;</Highlight></CodeLine>
<Link id="l06079" /><CodeLine lineNumber="6079"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setIVIncInsertPos(L, InsertPos);</Highlight></CodeLine>
<Link id="l06080" /><CodeLine lineNumber="6080"><Highlight kind="normal">      Rewrite(<a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;, <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>, &#42;Solution&#91;LUIdx&#93;, DeadInsts);</Highlight></CodeLine>
<Link id="l06081" /><CodeLine lineNumber="6081"><Highlight kind="normal">      <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06082" /><CodeLine lineNumber="6082"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06083" /><CodeLine lineNumber="6083"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06084" /><CodeLine lineNumber="6084"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> InsertedInsts = InsertedNonLCSSAInsts.takeVector();</Highlight></CodeLine>
<Link id="l06085" /><CodeLine lineNumber="6085"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#ac1c43bfed9a4937c8f7918ac6fb09c56">formLCSSAForInstructions</a>(InsertedInsts, DT, LI, &amp;SE);</Highlight></CodeLine>
<Link id="l06086" /><CodeLine lineNumber="6086"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06087" /><CodeLine lineNumber="6087"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> IVChain &amp;Chain : IVChainVec) &#123;</Highlight></CodeLine>
<Link id="l06088" /><CodeLine lineNumber="6088"><Highlight kind="normal">    GenerateIVChain(Chain, DeadInsts);</Highlight></CodeLine>
<Link id="l06089" /><CodeLine lineNumber="6089"><Highlight kind="normal">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06090" /><CodeLine lineNumber="6090"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06091" /><CodeLine lineNumber="6091"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06092" /><CodeLine lineNumber="6092"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/weakvh">WeakVH</a> &amp;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> : <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.getInsertedIVs())</Highlight></CodeLine>
<Link id="l06093" /><CodeLine lineNumber="6093"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> &amp;&amp; <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(&amp;&#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>)-&gt;<a href="/docs/api/files/lib/lib/analysis/basicaliasanalysis-cpp/#a1b8850f1ed44c12bc3501175a71c251c">getParent</a>())</Highlight></CodeLine>
<Link id="l06094" /><CodeLine lineNumber="6094"><Highlight kind="normal">      ScalarEvolutionIVs.push&#95;back(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>);</Highlight></CodeLine>
<Link id="l06095" /><CodeLine lineNumber="6095"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06096" /><CodeLine lineNumber="6096"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Clean up after ourselves. This must be done before deleting any</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06097" /><CodeLine lineNumber="6097"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06098" /><CodeLine lineNumber="6098"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clear();</Highlight></CodeLine>
<Link id="l06099" /><CodeLine lineNumber="6099"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06100" /><CodeLine lineNumber="6100"><Highlight kind="normal">  <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> |= <a href="/docs/api/namespaces/llvm/#abca8e2c525d8162fbcbb5b444cf04d21">RecursivelyDeleteTriviallyDeadInstructionsPermissive</a>(DeadInsts,</Highlight></CodeLine>
<Link id="l06101" /><CodeLine lineNumber="6101"><Highlight kind="normal">                                                                  &amp;TLI, MSSAU);</Highlight></CodeLine>
<Link id="l06102" /><CodeLine lineNumber="6102"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06103" /><CodeLine lineNumber="6103"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// In our cost analysis above, we assume that each addrec consumes exactly</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06104" /><CodeLine lineNumber="6104"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// one register, and arrange to have increments inserted just before the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06105" /><CodeLine lineNumber="6105"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// latch to maximimize the chance this is true.  However, if we reused</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06106" /><CodeLine lineNumber="6106"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// existing IVs, we now need to move the increments to match our</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06107" /><CodeLine lineNumber="6107"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// expectations.  Otherwise, our cost modeling results in us having a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06108" /><CodeLine lineNumber="6108"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// chosen a non-optimal result for the actual schedule.  (And yes, this</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06109" /><CodeLine lineNumber="6109"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// scheduling decision does impact later codegen.)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06110" /><CodeLine lineNumber="6110"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;PN : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;phis()) &#123;</Highlight></CodeLine>
<Link id="l06111" /><CodeLine lineNumber="6111"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/binaryoperator">BinaryOperator</a> &#42;BO = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06112" /><CodeLine lineNumber="6112"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/memprof/#abee3ddc7c6eb611a3b96fb69489c81caaa6122a65eaa676f700ae68d393054a37">Start</a> = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">, &#42;Step = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06113" /><CodeLine lineNumber="6113"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a5be4877e6cc76e0fe6f8a005c69aa7c2">matchSimpleRecurrence</a>(&amp;PN, BO, Start, Step))</Highlight></CodeLine>
<Link id="l06114" /><CodeLine lineNumber="6114"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06115" /><CodeLine lineNumber="6115"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06116" /><CodeLine lineNumber="6116"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (BO-&gt;<a href="/docs/api/classes/llvm/binaryoperator/#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>()) &#123;</Highlight></CodeLine>
<Link id="l06117" /><CodeLine lineNumber="6117"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Instruction::Sub:</Highlight></CodeLine>
<Link id="l06118" /><CodeLine lineNumber="6118"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BO-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0) != &amp;PN)</Highlight></CodeLine>
<Link id="l06119" /><CodeLine lineNumber="6119"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// sub is non-commutative - match handling elsewhere in LSR</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06120" /><CodeLine lineNumber="6120"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06121" /><CodeLine lineNumber="6121"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06122" /><CodeLine lineNumber="6122"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> Instruction::Add:</Highlight></CodeLine>
<Link id="l06123" /><CodeLine lineNumber="6123"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">break</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06124" /><CodeLine lineNumber="6124"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l06125" /><CodeLine lineNumber="6125"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06126" /><CodeLine lineNumber="6126"><Highlight kind="normal">    &#125;;</Highlight></CodeLine>
<Link id="l06127" /><CodeLine lineNumber="6127"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06128" /><CodeLine lineNumber="6128"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;Constant&gt;</a>(Step))</Highlight></CodeLine>
<Link id="l06129" /><CodeLine lineNumber="6129"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// If not a constant step, might increase register pressure</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06130" /><CodeLine lineNumber="6130"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// (We assume constants have been canonicalized to RHS)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06131" /><CodeLine lineNumber="6131"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06132" /><CodeLine lineNumber="6132"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06133" /><CodeLine lineNumber="6133"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (BO-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() == IVIncInsertPos-&gt;getParent())</Highlight></CodeLine>
<Link id="l06134" /><CodeLine lineNumber="6134"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Only bother moving across blocks.  Isel can handle block local case.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06135" /><CodeLine lineNumber="6135"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06136" /><CodeLine lineNumber="6136"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06137" /><CodeLine lineNumber="6137"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Can we legally schedule inc at the desired point?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06138" /><CodeLine lineNumber="6138"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all&#95;of</a>(BO-&gt;<a href="/docs/api/classes/llvm/value/#abf855b7cd63a0cd7f73759e396f280c9">uses</a>(),</Highlight></CodeLine>
<Link id="l06139" /><CodeLine lineNumber="6139"><Highlight kind="normal">                      &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/use">Use</a> &amp;U) &#123;return DT.dominates(IVIncInsertPos, U);&#125;))</Highlight></CodeLine>
<Link id="l06140" /><CodeLine lineNumber="6140"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06141" /><CodeLine lineNumber="6141"><Highlight kind="normal">    BO-&gt;<a href="/docs/api/classes/llvm/instruction/#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(IVIncInsertPos-&gt;getIterator());</Highlight></CodeLine>
<Link id="l06142" /><CodeLine lineNumber="6142"><Highlight kind="normal">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06143" /><CodeLine lineNumber="6143"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06144" /><CodeLine lineNumber="6144"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06145" /><CodeLine lineNumber="6145"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06146" /><CodeLine lineNumber="6146"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06147" /><CodeLine lineNumber="6147"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06148" /><CodeLine lineNumber="6148" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a9bcf42be7435217d79cd175d4e6993d7"><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a9bcf42be7435217d79cd175d4e6993d7">LSRInstance::LSRInstance</a>(<a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp;IU, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</Highlight></CodeLine>
<Link id="l06149" /><CodeLine lineNumber="6149"><Highlight kind="normal">                         <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;DT, <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI,</Highlight></CodeLine>
<Link id="l06150" /><CodeLine lineNumber="6150"><Highlight kind="normal">                         </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;TTI, <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;AC,</Highlight></CodeLine>
<Link id="l06151" /><CodeLine lineNumber="6151"><Highlight kind="normal">                         <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp;TLI, <a href="/docs/api/classes/llvm/memoryssaupdater">MemorySSAUpdater</a> &#42;MSSAU)</Highlight></CodeLine>
<Link id="l06152" /><CodeLine lineNumber="6152"><Highlight kind="normal">    : IU(IU), SE(SE), DT(DT), LI(LI), AC(AC), TLI(TLI), TTI(TTI), L(L),</Highlight></CodeLine>
<Link id="l06153" /><CodeLine lineNumber="6153"><Highlight kind="normal">      MSSAU(MSSAU), AMK(<a href="#a5ecada6efd95584778cb27661747d9ba">PreferredAddresingMode</a>.getNumOccurrences() &gt; 0</Highlight></CodeLine>
<Link id="l06154" /><CodeLine lineNumber="6154"><Highlight kind="normal">                            ? <a href="#a5ecada6efd95584778cb27661747d9ba">PreferredAddresingMode</a></Highlight></CodeLine>
<Link id="l06155" /><CodeLine lineNumber="6155"><Highlight kind="normal">                            : TTI.getPreferredAddressingMode(L, &amp;SE)),</Highlight></CodeLine>
<Link id="l06156" /><CodeLine lineNumber="6156"><Highlight kind="normal">      Rewriter(SE, L-&gt;getHeader()-&gt;getDataLayout(), </Highlight><Highlight kind="stringliteral">&quot;lsr&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/false">false</a>),</Highlight></CodeLine>
<Link id="l06157" /><CodeLine lineNumber="6157"><Highlight kind="normal">      BaselineCost(L, SE, TTI, AMK) &#123;</Highlight></CodeLine>
<Link id="l06158" /><CodeLine lineNumber="6158"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If LoopSimplify form is not available, stay out of trouble.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06159" /><CodeLine lineNumber="6159"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!L-&gt;isLoopSimplifyForm())</Highlight></CodeLine>
<Link id="l06160" /><CodeLine lineNumber="6160"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06161" /><CodeLine lineNumber="6161"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06162" /><CodeLine lineNumber="6162"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there&#39;s no interesting work to be done, bail early.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06163" /><CodeLine lineNumber="6163"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#acdfbcf188e2d4a80837e89de2ccdffab">if</a> (IU.empty()) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06164" /><CodeLine lineNumber="6164"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06165" /><CodeLine lineNumber="6165"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If there&#39;s too much analysis to be done, bail early. We won&#39;t be able to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06166" /><CodeLine lineNumber="6166"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// model the problem anyway.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06167" /><CodeLine lineNumber="6167"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumUsers = 0;</Highlight></CodeLine>
<Link id="l06168" /><CodeLine lineNumber="6168"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a4cfc8b177e8521a4b496ae2edff6244f">for</a> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;U : IU) &#123;</Highlight></CodeLine>
<Link id="l06169" /><CodeLine lineNumber="6169"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (++NumUsers &gt; <a href="#a73b3c5e7c72bf97886e2ed1f12e28d54">MaxIVUsers</a>) &#123;</Highlight></CodeLine>
<Link id="l06170" /><CodeLine lineNumber="6170"><Highlight kind="normal">      (void)U;</Highlight></CodeLine>
<Link id="l06171" /><CodeLine lineNumber="6171"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;LSR skipping loop, too many IV Users in &quot;</Highlight><Highlight kind="normal"> &lt;&lt; U</Highlight></CodeLine>
<Link id="l06172" /><CodeLine lineNumber="6172"><Highlight kind="normal">                        &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06173" /><CodeLine lineNumber="6173"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06174" /><CodeLine lineNumber="6174"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06175" /><CodeLine lineNumber="6175"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Bail out if we have a PHI on an EHPad that gets a value from a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06176" /><CodeLine lineNumber="6176"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// CatchSwitchInst.  Because the CatchSwitchInst cannot be split, there is</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06177" /><CodeLine lineNumber="6177"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// no good place to stick any instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06178" /><CodeLine lineNumber="6178"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;PN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(U.getUser())) &#123;</Highlight></CodeLine>
<Link id="l06179" /><CodeLine lineNumber="6179"><Highlight kind="normal">       </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> FirstNonPHI = PN-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;getFirstNonPHIIt();</Highlight></CodeLine>
<Link id="l06180" /><CodeLine lineNumber="6180"><Highlight kind="normal">       </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;FuncletPadInst&gt;</a>(FirstNonPHI) ||</Highlight></CodeLine>
<Link id="l06181" /><CodeLine lineNumber="6181"><Highlight kind="normal">           <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(FirstNonPHI))</Highlight></CodeLine>
<Link id="l06182" /><CodeLine lineNumber="6182"><Highlight kind="normal">         </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PredBB : PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a14cf6d7a36d091cb666cb83221b81d72">blocks</a>())</Highlight></CodeLine>
<Link id="l06183" /><CodeLine lineNumber="6183"><Highlight kind="normal">           </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(PredBB-&gt;getFirstNonPHIIt()))</Highlight></CodeLine>
<Link id="l06184" /><CodeLine lineNumber="6184"><Highlight kind="normal">             </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06185" /><CodeLine lineNumber="6185"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06186" /><CodeLine lineNumber="6186"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06187" /><CodeLine lineNumber="6187"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06188" /><CodeLine lineNumber="6188"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\nLSR on loop &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06189" /><CodeLine lineNumber="6189"><Highlight kind="normal">             L-&gt;getHeader()-&gt;printAsOperand(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>(), </Highlight><Highlight kind="comment">/&#42;PrintType=&#42;/</Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06190" /><CodeLine lineNumber="6190"><Highlight kind="normal">             <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;:\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06191" /><CodeLine lineNumber="6191"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06192" /><CodeLine lineNumber="6192"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Configure SCEVExpander already now, so the correct mode is used for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06193" /><CodeLine lineNumber="6193"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// isSafeToExpand() checks.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06194" /><CodeLine lineNumber="6194"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if LLVM&#95;ENABLE&#95;ABI&#95;BREAKING&#95;CHECKS</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06195" /><CodeLine lineNumber="6195"><Highlight kind="normal">  Rewriter.setDebugType(<a href="/docs/api/files/include/include/llvm/include/llvm/adt/genericcycleimpl-h/#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>);</Highlight></CodeLine>
<Link id="l06196" /><CodeLine lineNumber="6196"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06197" /><CodeLine lineNumber="6197"><Highlight kind="normal">  Rewriter.disableCanonicalMode();</Highlight></CodeLine>
<Link id="l06198" /><CodeLine lineNumber="6198"><Highlight kind="normal">  Rewriter.enableLSRMode();</Highlight></CodeLine>
<Link id="l06199" /><CodeLine lineNumber="6199"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06200" /><CodeLine lineNumber="6200"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// First, perform some low-level loop optimizations.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06201" /><CodeLine lineNumber="6201"><Highlight kind="normal">  OptimizeShadowIV();</Highlight></CodeLine>
<Link id="l06202" /><CodeLine lineNumber="6202"><Highlight kind="normal">  OptimizeLoopTermCond();</Highlight></CodeLine>
<Link id="l06203" /><CodeLine lineNumber="6203"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06204" /><CodeLine lineNumber="6204"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If loop preparation eliminates all interesting IV users, bail.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06205" /><CodeLine lineNumber="6205"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IU.empty()) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06206" /><CodeLine lineNumber="6206"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06207" /><CodeLine lineNumber="6207"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Skip nested loops until we can model them better with formulae.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06208" /><CodeLine lineNumber="6208"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!L-&gt;isInnermost()) &#123;</Highlight></CodeLine>
<Link id="l06209" /><CodeLine lineNumber="6209"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;LSR skipping outer loop &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;L &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06210" /><CodeLine lineNumber="6210"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06211" /><CodeLine lineNumber="6211"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06212" /><CodeLine lineNumber="6212"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06213" /><CodeLine lineNumber="6213"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Start collecting data and preparing for the solver.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06214" /><CodeLine lineNumber="6214"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// If number of registers is not the major cost, we cannot benefit from the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06215" /><CodeLine lineNumber="6215"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// current profitable chain optimization which is based on number of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06216" /><CodeLine lineNumber="6216"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// registers.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06217" /><CodeLine lineNumber="6217"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// FIXME: add profitable chain optimization for other kinds major cost, for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06218" /><CodeLine lineNumber="6218"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// example number of instructions.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06219" /><CodeLine lineNumber="6219"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (TTI.isNumRegsMajorCostOfLSR() || <a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>)</Highlight></CodeLine>
<Link id="l06220" /><CodeLine lineNumber="6220"><Highlight kind="normal">    CollectChains();</Highlight></CodeLine>
<Link id="l06221" /><CodeLine lineNumber="6221"><Highlight kind="normal">  CollectInterestingTypesAndFactors();</Highlight></CodeLine>
<Link id="l06222" /><CodeLine lineNumber="6222"><Highlight kind="normal">  CollectFixupsAndInitialFormulae();</Highlight></CodeLine>
<Link id="l06223" /><CodeLine lineNumber="6223"><Highlight kind="normal">  CollectLoopInvariantFixupsAndFormulae();</Highlight></CodeLine>
<Link id="l06224" /><CodeLine lineNumber="6224"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06225" /><CodeLine lineNumber="6225"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Uses.empty())</Highlight></CodeLine>
<Link id="l06226" /><CodeLine lineNumber="6226"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06227" /><CodeLine lineNumber="6227"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06228" /><CodeLine lineNumber="6228"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;LSR found &quot;</Highlight><Highlight kind="normal"> &lt;&lt; Uses.size() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; uses:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06229" /><CodeLine lineNumber="6229"><Highlight kind="normal">             <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a0d604d6453ff8ad118da3e2cadc04c66">print&#95;uses</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</Highlight></CodeLine>
<Link id="l06230" /><CodeLine lineNumber="6230"><Highlight kind="normal">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;The baseline solution requires &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06231" /><CodeLine lineNumber="6231"><Highlight kind="normal">             BaselineCost.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06232" /><CodeLine lineNumber="6232"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06233" /><CodeLine lineNumber="6233"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Now use the reuse data to generate a bunch of interesting ways</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06234" /><CodeLine lineNumber="6234"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// to formulate the values needed for the uses.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06235" /><CodeLine lineNumber="6235"><Highlight kind="normal">  GenerateAllReuseFormulae();</Highlight></CodeLine>
<Link id="l06236" /><CodeLine lineNumber="6236"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06237" /><CodeLine lineNumber="6237"><Highlight kind="normal">  FilterOutUndesirableDedicatedRegisters();</Highlight></CodeLine>
<Link id="l06238" /><CodeLine lineNumber="6238"><Highlight kind="normal">  NarrowSearchSpaceUsingHeuristics();</Highlight></CodeLine>
<Link id="l06239" /><CodeLine lineNumber="6239"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06240" /><CodeLine lineNumber="6240"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const Formula &#42;, 8&gt;</a> Solution;</Highlight></CodeLine>
<Link id="l06241" /><CodeLine lineNumber="6241"><Highlight kind="normal">  Solve(Solution);</Highlight></CodeLine>
<Link id="l06242" /><CodeLine lineNumber="6242"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06243" /><CodeLine lineNumber="6243"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Release memory that is no longer needed.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06244" /><CodeLine lineNumber="6244"><Highlight kind="normal">  Factors.clear();</Highlight></CodeLine>
<Link id="l06245" /><CodeLine lineNumber="6245"><Highlight kind="normal">  Types.clear();</Highlight></CodeLine>
<Link id="l06246" /><CodeLine lineNumber="6246"><Highlight kind="normal">  RegUses.clear();</Highlight></CodeLine>
<Link id="l06247" /><CodeLine lineNumber="6247"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06248" /><CodeLine lineNumber="6248"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Solution.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</Highlight></CodeLine>
<Link id="l06249" /><CodeLine lineNumber="6249"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06250" /><CodeLine lineNumber="6250"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06251" /><CodeLine lineNumber="6251"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#ifndef NDEBUG</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06252" /><CodeLine lineNumber="6252"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Formulae should be legal.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06253" /><CodeLine lineNumber="6253"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU : Uses) &#123;</Highlight></CodeLine>
<Link id="l06254" /><CodeLine lineNumber="6254"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae)</Highlight></CodeLine>
<Link id="l06255" /><CodeLine lineNumber="6255"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(TTI, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy,</Highlight></CodeLine>
<Link id="l06256" /><CodeLine lineNumber="6256"><Highlight kind="normal">                        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Illegal formula generated!&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06257" /><CodeLine lineNumber="6257"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l06258" /><CodeLine lineNumber="6258"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06259" /><CodeLine lineNumber="6259"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06260" /><CodeLine lineNumber="6260"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Now that we&#39;ve decided what we want, make it so.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06261" /><CodeLine lineNumber="6261"><Highlight kind="normal">  ImplementSolution(Solution);</Highlight></CodeLine>
<Link id="l06262" /><CodeLine lineNumber="6262"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06263" /><CodeLine lineNumber="6263"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06264" /><CodeLine lineNumber="6264"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06265" /><CodeLine lineNumber="6265" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#af93b911868eadea967fc026ed208698d"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#af93b911868eadea967fc026ed208698d">LSRInstance::print&#95;factors&#95;and&#95;types</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l06266" /><CodeLine lineNumber="6266"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Factors.empty() &amp;&amp; Types.empty()) </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06267" /><CodeLine lineNumber="6267"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06268" /><CodeLine lineNumber="6268"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;LSR has identified the following interesting factors and types: &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06269" /><CodeLine lineNumber="6269"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06270" /><CodeLine lineNumber="6270"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06271" /><CodeLine lineNumber="6271"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (int64&#95;t Factor : Factors) &#123;</Highlight></CodeLine>
<Link id="l06272" /><CodeLine lineNumber="6272"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06273" /><CodeLine lineNumber="6273"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06274" /><CodeLine lineNumber="6274"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;&#42;&#39;</Highlight><Highlight kind="normal"> &lt;&lt; Factor;</Highlight></CodeLine>
<Link id="l06275" /><CodeLine lineNumber="6275"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06276" /><CodeLine lineNumber="6276"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06277" /><CodeLine lineNumber="6277"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty : Types) &#123;</Highlight></CodeLine>
<Link id="l06278" /><CodeLine lineNumber="6278"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;, &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06279" /><CodeLine lineNumber="6279"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06280" /><CodeLine lineNumber="6280"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;(&#39;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;Ty &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;)&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06281" /><CodeLine lineNumber="6281"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06282" /><CodeLine lineNumber="6282"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06283" /><CodeLine lineNumber="6283"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06284" /><CodeLine lineNumber="6284"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06285" /><CodeLine lineNumber="6285" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a1ed1067b1498e4790ce06d7b0fb995a3"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a1ed1067b1498e4790ce06d7b0fb995a3">LSRInstance::print&#95;fixups</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l06286" /><CodeLine lineNumber="6286"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;LSR is examining the following fixup sites:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06287" /><CodeLine lineNumber="6287"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU : Uses)</Highlight></CodeLine>
<Link id="l06288" /><CodeLine lineNumber="6288"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF : LU.Fixups) &#123;</Highlight></CodeLine>
<Link id="l06289" /><CodeLine lineNumber="6289"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06290" /><CodeLine lineNumber="6290"><Highlight kind="normal">      LF.<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#aa7f24a759cb17285abd90cfa12e030c1">print</a>(OS);</Highlight></CodeLine>
<Link id="l06291" /><CodeLine lineNumber="6291"><Highlight kind="normal">      OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06292" /><CodeLine lineNumber="6292"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06293" /><CodeLine lineNumber="6293"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06294" /><CodeLine lineNumber="6294"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06295" /><CodeLine lineNumber="6295" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a0d604d6453ff8ad118da3e2cadc04c66"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a0d604d6453ff8ad118da3e2cadc04c66">LSRInstance::print&#95;uses</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l06296" /><CodeLine lineNumber="6296"><Highlight kind="normal">  OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;LSR is examining the following uses:\\n&quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06297" /><CodeLine lineNumber="6297"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU : Uses) &#123;</Highlight></CodeLine>
<Link id="l06298" /><CodeLine lineNumber="6298"><Highlight kind="normal">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;  &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06299" /><CodeLine lineNumber="6299"><Highlight kind="normal">    LU.print(OS);</Highlight></CodeLine>
<Link id="l06300" /><CodeLine lineNumber="6300"><Highlight kind="normal">    OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06301" /><CodeLine lineNumber="6301"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae) &#123;</Highlight></CodeLine>
<Link id="l06302" /><CodeLine lineNumber="6302"><Highlight kind="normal">      OS &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;    &quot;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06303" /><CodeLine lineNumber="6303"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(OS);</Highlight></CodeLine>
<Link id="l06304" /><CodeLine lineNumber="6304"><Highlight kind="normal">      OS &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06305" /><CodeLine lineNumber="6305"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06306" /><CodeLine lineNumber="6306"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06307" /><CodeLine lineNumber="6307"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06308" /><CodeLine lineNumber="6308"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06309" /><CodeLine lineNumber="6309" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a154b34752235c9434c21cd366250100f"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a154b34752235c9434c21cd366250100f">LSRInstance::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l06310" /><CodeLine lineNumber="6310"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#af93b911868eadea967fc026ed208698d">print&#95;factors&#95;and&#95;types</a>(OS);</Highlight></CodeLine>
<Link id="l06311" /><CodeLine lineNumber="6311"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a1ed1067b1498e4790ce06d7b0fb995a3">print&#95;fixups</a>(OS);</Highlight></CodeLine>
<Link id="l06312" /><CodeLine lineNumber="6312"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a0d604d6453ff8ad118da3e2cadc04c66">print&#95;uses</a>(OS);</Highlight></CodeLine>
<Link id="l06313" /><CodeLine lineNumber="6313"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06314" /><CodeLine lineNumber="6314"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06315" /><CodeLine lineNumber="6315" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a890ca19e74514f1ec5cbb3e5cdd8d50b"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a890ca19e74514f1ec5cbb3e5cdd8d50b">LSRInstance::dump</a>()</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l06316" /><CodeLine lineNumber="6316"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a154b34752235c9434c21cd366250100f">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06317" /><CodeLine lineNumber="6317"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06318" /><CodeLine lineNumber="6318"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06319" /><CodeLine lineNumber="6319"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06320" /><CodeLine lineNumber="6320"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l06321" /><CodeLine lineNumber="6321"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06322" /><CodeLine lineNumber="6322" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce"><Highlight kind="normal"></Highlight><Highlight kind="keyword">class </Highlight><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#af80949a15e2bf1220022362faa9579e0">LoopStrengthReduce</a> : </Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/looppass/#a4d5799624e630ba03cb9133168951e8a">LoopPass</a> &#123;</Highlight></CodeLine>
<Link id="l06323" /><CodeLine lineNumber="6323"><Highlight kind="normal"></Highlight><Highlight kind="keyword">public</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l06324" /><CodeLine lineNumber="6324" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#a70f981eb6b8f2c9553421cc07b98f8e5"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">char</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#a70f981eb6b8f2c9553421cc07b98f8e5">ID</a>; </Highlight><Highlight kind="comment">// Pass ID, replacement for typeid</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06325" /><CodeLine lineNumber="6325"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06326" /><CodeLine lineNumber="6326"><Highlight kind="normal">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#af80949a15e2bf1220022362faa9579e0">LoopStrengthReduce</a>();</Highlight></CodeLine>
<Link id="l06327" /><CodeLine lineNumber="6327"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06328" /><CodeLine lineNumber="6328"><Highlight kind="normal"></Highlight><Highlight kind="keyword">private</Highlight><Highlight kind="normal">:</Highlight></CodeLine>
<Link id="l06329" /><CodeLine lineNumber="6329"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> runOnLoop(<a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/lppassmanager">LPPassManager</a> &amp;LPM) </Highlight><Highlight kind="keyword">override</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06330" /><CodeLine lineNumber="6330"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> getAnalysisUsage(<a href="/docs/api/classes/llvm/analysisusage">AnalysisUsage</a> &amp;AU) </Highlight><Highlight kind="keyword">const override</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06331" /><CodeLine lineNumber="6331"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l06332" /><CodeLine lineNumber="6332"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06333" /><CodeLine lineNumber="6333"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// end anonymous namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06334" /><CodeLine lineNumber="6334"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06335" /><CodeLine lineNumber="6335" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#af80949a15e2bf1220022362faa9579e0"><Highlight kind="normal"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#af80949a15e2bf1220022362faa9579e0">LoopStrengthReduce::LoopStrengthReduce</a>() : <a href="/docs/api/classes/llvm/looppass/#a4d5799624e630ba03cb9133168951e8a">LoopPass</a>(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#a70f981eb6b8f2c9553421cc07b98f8e5">ID</a>) &#123;</Highlight></CodeLine>
<Link id="l06336" /><CodeLine lineNumber="6336"><Highlight kind="normal">  <a href="/docs/api/namespaces/llvm/#ac36ebb7d8a9874254ba36df4f0cde8b3">initializeLoopStrengthReducePass</a>(&#42;<a href="/docs/api/classes/llvm/passregistry/#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</Highlight></CodeLine>
<Link id="l06337" /><CodeLine lineNumber="6337"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06338" /><CodeLine lineNumber="6338"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06339" /><CodeLine lineNumber="6339"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> LoopStrengthReduce::getAnalysisUsage(<a href="/docs/api/classes/llvm/analysisusage">AnalysisUsage</a> &amp;AU)</Highlight><Highlight kind="keyword"> const </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l06340" /><CodeLine lineNumber="6340"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// We split critical edges, so we change the CFG.  However, we do update</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06341" /><CodeLine lineNumber="6341"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// many analyses if they are around.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06342" /><CodeLine lineNumber="6342"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#a573df5c9c3024ebb646e15cc7450bf91">addPreservedID</a>(<a href="/docs/api/namespaces/llvm/#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</Highlight></CodeLine>
<Link id="l06343" /><CodeLine lineNumber="6343"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06344" /><CodeLine lineNumber="6344"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/loopinfowrapperpass">LoopInfoWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06345" /><CodeLine lineNumber="6345"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/loopinfowrapperpass">LoopInfoWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06346" /><CodeLine lineNumber="6346"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#a053677ebc731b47a534f841b11b5cf0c">addRequiredID</a>(<a href="/docs/api/namespaces/llvm/#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</Highlight></CodeLine>
<Link id="l06347" /><CodeLine lineNumber="6347"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/dominatortreewrapperpass">DominatorTreeWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06348" /><CodeLine lineNumber="6348"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/dominatortreewrapperpass">DominatorTreeWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06349" /><CodeLine lineNumber="6349"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/scalarevolutionwrapperpass">ScalarEvolutionWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06350" /><CodeLine lineNumber="6350"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/scalarevolutionwrapperpass">ScalarEvolutionWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06351" /><CodeLine lineNumber="6351"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/assumptioncachetracker">AssumptionCacheTracker</a>&gt;();</Highlight></CodeLine>
<Link id="l06352" /><CodeLine lineNumber="6352"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/targetlibraryinfowrapperpass">TargetLibraryInfoWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06353" /><CodeLine lineNumber="6353"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Requiring LoopSimplify a second time here prevents IVUsers from running</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06354" /><CodeLine lineNumber="6354"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// twice, since LoopSimplify was invalidated by running ScalarEvolution.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06355" /><CodeLine lineNumber="6355"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#a053677ebc731b47a534f841b11b5cf0c">addRequiredID</a>(<a href="/docs/api/namespaces/llvm/#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</Highlight></CodeLine>
<Link id="l06356" /><CodeLine lineNumber="6356"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/ivuserswrapperpass">IVUsersWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06357" /><CodeLine lineNumber="6357"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/ivuserswrapperpass">IVUsersWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06358" /><CodeLine lineNumber="6358"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/targettransforminfowrapperpass">TargetTransformInfoWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06359" /><CodeLine lineNumber="6359"><Highlight kind="normal">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/memoryssawrapperpass">MemorySSAWrapperPass</a>&gt;();</Highlight></CodeLine>
<Link id="l06360" /><CodeLine lineNumber="6360"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06361" /><CodeLine lineNumber="6361"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06362" /><CodeLine lineNumber="6362"><Highlight kind="normal"></Highlight><Highlight kind="keyword">namespace </Highlight><Highlight kind="normal">&#123;</Highlight></CodeLine>
<Link id="l06363" /><CodeLine lineNumber="6363"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06364" /><CodeLine lineNumber="6364"><Highlight kind="comment">/// Enables more convenient iteration over a DWARF expression vector.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06365" /><CodeLine lineNumber="6365"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/iterator-range">iterator&#95;range&lt;llvm::DIExpression::expr&#95;op&#95;iterator&gt;</a></Highlight></CodeLine>
<Link id="l06366" /><CodeLine lineNumber="6366" lineLink="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-/#a391c5efa7f6eb049718971aeeb9b71d5"><Highlight kind="normal"><a href="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-/#a391c5efa7f6eb049718971aeeb9b71d5">ToDwarfOpIter</a>(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;Expr) &#123;</Highlight></CodeLine>
<Link id="l06367" /><CodeLine lineNumber="6367"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/diexpression/expr-op-iterator">llvm::DIExpression::expr&#95;op&#95;iterator</a> Begin =</Highlight></CodeLine>
<Link id="l06368" /><CodeLine lineNumber="6368"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/diexpression/expr-op-iterator">llvm::DIExpression::expr&#95;op&#95;iterator</a>(Expr.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>());</Highlight></CodeLine>
<Link id="l06369" /><CodeLine lineNumber="6369"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/diexpression/expr-op-iterator">llvm::DIExpression::expr&#95;op&#95;iterator</a> End =</Highlight></CodeLine>
<Link id="l06370" /><CodeLine lineNumber="6370"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/diexpression/expr-op-iterator">llvm::DIExpression::expr&#95;op&#95;iterator</a>(Expr.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>());</Highlight></CodeLine>
<Link id="l06371" /><CodeLine lineNumber="6371"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &#123;Begin, End&#125;;</Highlight></CodeLine>
<Link id="l06372" /><CodeLine lineNumber="6372"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06373" /><CodeLine lineNumber="6373"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06374" /><CodeLine lineNumber="6374" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a> &#123;</Highlight></CodeLine>
<Link id="l06375" /><CodeLine lineNumber="6375" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a>() = </Highlight><Highlight kind="keywordflow">default</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06376" /><CodeLine lineNumber="6376" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a02fa7ab40a4bb47c700385d898d39efa"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a02fa7ab40a4bb47c700385d898d39efa">SCEVDbgValueBuilder</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a62bd6b249b4fa5e6373d70d73fa6237c">clone</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>); &#125;</Highlight></CodeLine>
<Link id="l06377" /><CodeLine lineNumber="6377"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06378" /><CodeLine lineNumber="6378" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a62bd6b249b4fa5e6373d70d73fa6237c"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a62bd6b249b4fa5e6373d70d73fa6237c">clone</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</Highlight></CodeLine>
<Link id="l06379" /><CodeLine lineNumber="6379"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.LocationOps;</Highlight></CodeLine>
<Link id="l06380" /><CodeLine lineNumber="6380"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Expr;</Highlight></CodeLine>
<Link id="l06381" /><CodeLine lineNumber="6381"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06382" /><CodeLine lineNumber="6382"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06383" /><CodeLine lineNumber="6383" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a8f49864522c7db2283185f4067f5e782"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a8f49864522c7db2283185f4067f5e782">clear</a>() &#123;</Highlight></CodeLine>
<Link id="l06384" /><CodeLine lineNumber="6384"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.clear();</Highlight></CodeLine>
<Link id="l06385" /><CodeLine lineNumber="6385"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.clear();</Highlight></CodeLine>
<Link id="l06386" /><CodeLine lineNumber="6386"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06387" /><CodeLine lineNumber="6387"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06388" /><CodeLine lineNumber="6388"><Highlight kind="comment">  /// The DIExpression as we translate the SCEV.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06389" /><CodeLine lineNumber="6389" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;uint64&#95;t, 6&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>;</Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06390" /><CodeLine lineNumber="6390"><Highlight kind="comment">  /// The location ops of the DIExpression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06391" /><CodeLine lineNumber="6391" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 2&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>;</Highlight></CodeLine>
<Link id="l06392" /><CodeLine lineNumber="6392"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06393" /><CodeLine lineNumber="6393" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(uint64&#95;t <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>); &#125;</Highlight></CodeLine>
<Link id="l06394" /><CodeLine lineNumber="6394" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1eccfeb23bb095c15dcaaa5a75837426"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1eccfeb23bb095c15dcaaa5a75837426">pushUInt</a>(uint64&#95;t Operand) &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(Operand); &#125;</Highlight></CodeLine>
<Link id="l06395" /><CodeLine lineNumber="6395"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06396" /><CodeLine lineNumber="6396"><Highlight kind="comment">  /// Add a DW&#95;OP&#95;LLVM&#95;arg to the expression, followed by the index of the value</Highlight></CodeLine>
<Link id="l06397" /><CodeLine lineNumber="6397"><Highlight kind="comment">  /// in the set of values referenced by the expression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06398" /><CodeLine lineNumber="6398" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9">pushLocation</a>(<a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;V) &#123;</Highlight></CodeLine>
<Link id="l06399" /><CodeLine lineNumber="6399"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">llvm::dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>);</Highlight></CodeLine>
<Link id="l06400" /><CodeLine lineNumber="6400"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;It = <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">llvm::find</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>, V);</Highlight></CodeLine>
<Link id="l06401" /><CodeLine lineNumber="6401"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> ArgIndex = 0;</Highlight></CodeLine>
<Link id="l06402" /><CodeLine lineNumber="6402"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (It != <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.end()) &#123;</Highlight></CodeLine>
<Link id="l06403" /><CodeLine lineNumber="6403"><Highlight kind="normal">      ArgIndex = std::distance(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.begin(), It);</Highlight></CodeLine>
<Link id="l06404" /><CodeLine lineNumber="6404"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06405" /><CodeLine lineNumber="6405"><Highlight kind="normal">      ArgIndex = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.size();</Highlight></CodeLine>
<Link id="l06406" /><CodeLine lineNumber="6406"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.push&#95;back(V);</Highlight></CodeLine>
<Link id="l06407" /><CodeLine lineNumber="6407"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06408" /><CodeLine lineNumber="6408"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(ArgIndex);</Highlight></CodeLine>
<Link id="l06409" /><CodeLine lineNumber="6409"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06410" /><CodeLine lineNumber="6410"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06411" /><CodeLine lineNumber="6411" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a673f671a403fc11f472a4c9b4c9505c2"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a673f671a403fc11f472a4c9b4c9505c2">pushValue</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U) &#123;</Highlight></CodeLine>
<Link id="l06412" /><CodeLine lineNumber="6412"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;V = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVUnknown&gt;</a>(U)-&gt;getValue();</Highlight></CodeLine>
<Link id="l06413" /><CodeLine lineNumber="6413"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9">pushLocation</a>(V);</Highlight></CodeLine>
<Link id="l06414" /><CodeLine lineNumber="6414"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06415" /><CodeLine lineNumber="6415"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06416" /><CodeLine lineNumber="6416" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a7b3482ccb17e2b6a7d1a99c57dce9eeb"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a7b3482ccb17e2b6a7d1a99c57dce9eeb">pushConst</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>) &#123;</Highlight></CodeLine>
<Link id="l06417" /><CodeLine lineNumber="6417"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSignificantBits() &gt; 64)</Highlight></CodeLine>
<Link id="l06418" /><CodeLine lineNumber="6418"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06419" /><CodeLine lineNumber="6419"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(llvm::dwarf::DW&#95;OP&#95;consts);</Highlight></CodeLine>
<Link id="l06420" /><CodeLine lineNumber="6420"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSExtValue());</Highlight></CodeLine>
<Link id="l06421" /><CodeLine lineNumber="6421"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06422" /><CodeLine lineNumber="6422"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06423" /><CodeLine lineNumber="6423"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06424" /><CodeLine lineNumber="6424"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Iterating the expression as DWARF ops is convenient when updating</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06425" /><CodeLine lineNumber="6425"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// DWARF&#95;OP&#95;LLVM&#95;args.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06426" /><CodeLine lineNumber="6426" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1fb2fff65491c783042bbbc6716bd5d2"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/iterator-range">iterator&#95;range&lt;llvm::DIExpression::expr&#95;op&#95;iterator&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1fb2fff65491c783042bbbc6716bd5d2">expr&#95;ops</a>() &#123;</Highlight></CodeLine>
<Link id="l06427" /><CodeLine lineNumber="6427"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-/#a391c5efa7f6eb049718971aeeb9b71d5">ToDwarfOpIter</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>);</Highlight></CodeLine>
<Link id="l06428" /><CodeLine lineNumber="6428"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06429" /><CodeLine lineNumber="6429"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06430" /><CodeLine lineNumber="6430"><Highlight kind="comment">  /// Several SCEV types are sequences of the same arithmetic operator applied</Highlight></CodeLine>
<Link id="l06431" /><CodeLine lineNumber="6431"><Highlight kind="comment">  /// to constants and values that may be extended or truncated.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06432" /><CodeLine lineNumber="6432" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a0b92dc455822b15a2cbfdff183ad761c"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a0b92dc455822b15a2cbfdff183ad761c">pushArithmeticExpr</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevcommutativeexpr">llvm::SCEVCommutativeExpr</a> &#42;CommExpr,</Highlight></CodeLine>
<Link id="l06433" /><CodeLine lineNumber="6433"><Highlight kind="normal">                          uint64&#95;t DwarfOp) &#123;</Highlight></CodeLine>
<Link id="l06434" /><CodeLine lineNumber="6434"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;llvm::SCEVAddExpr&gt;</a>(CommExpr) || <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVMulExpr&gt;</a>(CommExpr)) &amp;&amp;</Highlight></CodeLine>
<Link id="l06435" /><CodeLine lineNumber="6435"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Expected arithmetic SCEV type&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06436" /><CodeLine lineNumber="6436"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06437" /><CodeLine lineNumber="6437"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> EmitOperator = 0;</Highlight></CodeLine>
<Link id="l06438" /><CodeLine lineNumber="6438"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : CommExpr-&gt;<a href="/docs/api/classes/llvm/scevnaryexpr/#ae77d0f7b81cbde08d5fd75fcf2fcf36b">operands</a>()) &#123;</Highlight></CodeLine>
<Link id="l06439" /><CodeLine lineNumber="6439"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</Highlight></CodeLine>
<Link id="l06440" /><CodeLine lineNumber="6440"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06441" /><CodeLine lineNumber="6441"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (EmitOperator &gt;= 1)</Highlight></CodeLine>
<Link id="l06442" /><CodeLine lineNumber="6442"><Highlight kind="normal">        <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(DwarfOp);</Highlight></CodeLine>
<Link id="l06443" /><CodeLine lineNumber="6443"><Highlight kind="normal">      ++EmitOperator;</Highlight></CodeLine>
<Link id="l06444" /><CodeLine lineNumber="6444"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06445" /><CodeLine lineNumber="6445"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a>;</Highlight></CodeLine>
<Link id="l06446" /><CodeLine lineNumber="6446"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06447" /><CodeLine lineNumber="6447"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06448" /><CodeLine lineNumber="6448"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Identify and omit noop casts.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06449" /><CodeLine lineNumber="6449" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac685ec5a094330e0ce1e86c573a2e934"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac685ec5a094330e0ce1e86c573a2e934">pushCast</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevcastexpr">llvm::SCEVCastExpr</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> IsSigned) &#123;</Highlight></CodeLine>
<Link id="l06450" /><CodeLine lineNumber="6450"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">llvm::SCEV</a> &#42;Inner = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getOperand(0);</Highlight></CodeLine>
<Link id="l06451" /><CodeLine lineNumber="6451"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/type">llvm::Type</a> &#42;<a href="/docs/api/classes/llvm/type">Type</a> = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getType();</Highlight></CodeLine>
<Link id="l06452" /><CodeLine lineNumber="6452"><Highlight kind="normal">    uint64&#95;t ToWidth = <a href="/docs/api/classes/llvm/type">Type</a>-&gt;<a href="/docs/api/classes/llvm/type/#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>();</Highlight></CodeLine>
<Link id="l06453" /><CodeLine lineNumber="6453"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Inner);</Highlight></CodeLine>
<Link id="l06454" /><CodeLine lineNumber="6454"><Highlight kind="normal">    uint64&#95;t CastOps&#91;&#93; = &#123;<a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0caee0952c3cd8bf8106bbfa0a323c1ca82">dwarf::DW&#95;OP&#95;LLVM&#95;convert</a>, ToWidth,</Highlight></CodeLine>
<Link id="l06455" /><CodeLine lineNumber="6455"><Highlight kind="normal">                          IsSigned ? llvm::dwarf::DW&#95;ATE&#95;signed</Highlight></CodeLine>
<Link id="l06456" /><CodeLine lineNumber="6456"><Highlight kind="normal">                                   : llvm::dwarf::DW&#95;ATE&#95;unsigned&#125;;</Highlight></CodeLine>
<Link id="l06457" /><CodeLine lineNumber="6457"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : CastOps)</Highlight></CodeLine>
<Link id="l06458" /><CodeLine lineNumber="6458"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</Highlight></CodeLine>
<Link id="l06459" /><CodeLine lineNumber="6459"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a>;</Highlight></CodeLine>
<Link id="l06460" /><CodeLine lineNumber="6460"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06461" /><CodeLine lineNumber="6461"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06462" /><CodeLine lineNumber="6462"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: MinMax - although these haven&#39;t been encountered in the test suite.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06463" /><CodeLine lineNumber="6463" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">llvm::SCEV</a> &#42;S) &#123;</Highlight></CodeLine>
<Link id="l06464" /><CodeLine lineNumber="6464"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06465" /><CodeLine lineNumber="6465"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;StartInt = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l06466" /><CodeLine lineNumber="6466"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a7b3482ccb17e2b6a7d1a99c57dce9eeb">pushConst</a>(StartInt);</Highlight></CodeLine>
<Link id="l06467" /><CodeLine lineNumber="6467"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06468" /><CodeLine lineNumber="6468"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l06469" /><CodeLine lineNumber="6469"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!U-&gt;getValue())</Highlight></CodeLine>
<Link id="l06470" /><CodeLine lineNumber="6470"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06471" /><CodeLine lineNumber="6471"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9">pushLocation</a>(U-&gt;getValue());</Highlight></CodeLine>
<Link id="l06472" /><CodeLine lineNumber="6472"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06473" /><CodeLine lineNumber="6473"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;MulRec = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l06474" /><CodeLine lineNumber="6474"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a0b92dc455822b15a2cbfdff183ad761c">pushArithmeticExpr</a>(MulRec, llvm::dwarf::DW&#95;OP&#95;mul);</Highlight></CodeLine>
<Link id="l06475" /><CodeLine lineNumber="6475"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06476" /><CodeLine lineNumber="6476"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevudivexpr">SCEVUDivExpr</a> &#42;UDiv = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUDivExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l06477" /><CodeLine lineNumber="6477"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(UDiv-&gt;getLHS());</Highlight></CodeLine>
<Link id="l06478" /><CodeLine lineNumber="6478"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(UDiv-&gt;getRHS());</Highlight></CodeLine>
<Link id="l06479" /><CodeLine lineNumber="6479"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;div);</Highlight></CodeLine>
<Link id="l06480" /><CodeLine lineNumber="6480"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06481" /><CodeLine lineNumber="6481"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevcastexpr">SCEVCastExpr</a> &#42;Cast = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVCastExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l06482" /><CodeLine lineNumber="6482"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Assert if a new and unknown SCEVCastEXpr type is encountered.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06483" /><CodeLine lineNumber="6483"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVZeroExtendExpr&gt;</a>(Cast) || <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVTruncateExpr&gt;</a>(Cast) ||</Highlight></CodeLine>
<Link id="l06484" /><CodeLine lineNumber="6484"><Highlight kind="normal">              <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVPtrToIntExpr&gt;</a>(Cast) || <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVSignExtendExpr&gt;</a>(Cast)) &amp;&amp;</Highlight></CodeLine>
<Link id="l06485" /><CodeLine lineNumber="6485"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Unexpected cast type in SCEV.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06486" /><CodeLine lineNumber="6486"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac685ec5a094330e0ce1e86c573a2e934">pushCast</a>(Cast, (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVSignExtendExpr&gt;</a>(Cast)));</Highlight></CodeLine>
<Link id="l06487" /><CodeLine lineNumber="6487"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06488" /><CodeLine lineNumber="6488"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;AddExpr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l06489" /><CodeLine lineNumber="6489"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a0b92dc455822b15a2cbfdff183ad761c">pushArithmeticExpr</a>(AddExpr, llvm::dwarf::DW&#95;OP&#95;plus);</Highlight></CodeLine>
<Link id="l06490" /><CodeLine lineNumber="6490"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06491" /><CodeLine lineNumber="6491"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l06492" /><CodeLine lineNumber="6492"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Nested SCEVAddRecExpr are generated by nested loops and are currently</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06493" /><CodeLine lineNumber="6493"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// unsupported.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06494" /><CodeLine lineNumber="6494"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06495" /><CodeLine lineNumber="6495"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06496" /><CodeLine lineNumber="6496"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06497" /><CodeLine lineNumber="6497"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06498" /><CodeLine lineNumber="6498"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06499" /><CodeLine lineNumber="6499"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a>;</Highlight></CodeLine>
<Link id="l06500" /><CodeLine lineNumber="6500"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06501" /><CodeLine lineNumber="6501"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06502" /><CodeLine lineNumber="6502"><Highlight kind="comment">  /// Return true if the combination of arithmetic operator and underlying</Highlight></CodeLine>
<Link id="l06503" /><CodeLine lineNumber="6503"><Highlight kind="comment">  /// SCEV constant value is an identity function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06504" /><CodeLine lineNumber="6504" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(uint64&#95;t <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>, </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</Highlight></CodeLine>
<Link id="l06505" /><CodeLine lineNumber="6505"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(S)) &#123;</Highlight></CodeLine>
<Link id="l06506" /><CodeLine lineNumber="6506"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSignificantBits() &gt; 64)</Highlight></CodeLine>
<Link id="l06507" /><CodeLine lineNumber="6507"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06508" /><CodeLine lineNumber="6508"><Highlight kind="normal">      int64&#95;t <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSExtValue();</Highlight></CodeLine>
<Link id="l06509" /><CodeLine lineNumber="6509"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">switch</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) &#123;</Highlight></CodeLine>
<Link id="l06510" /><CodeLine lineNumber="6510"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> llvm::dwarf::DW&#95;OP&#95;plus:</Highlight></CodeLine>
<Link id="l06511" /><CodeLine lineNumber="6511"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> llvm::dwarf::DW&#95;OP&#95;minus:</Highlight></CodeLine>
<Link id="l06512" /><CodeLine lineNumber="6512"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> == 0;</Highlight></CodeLine>
<Link id="l06513" /><CodeLine lineNumber="6513"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> llvm::dwarf::DW&#95;OP&#95;mul:</Highlight></CodeLine>
<Link id="l06514" /><CodeLine lineNumber="6514"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">case</Highlight><Highlight kind="normal"> llvm::dwarf::DW&#95;OP&#95;div:</Highlight></CodeLine>
<Link id="l06515" /><CodeLine lineNumber="6515"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> == 1;</Highlight></CodeLine>
<Link id="l06516" /><CodeLine lineNumber="6516"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l06517" /><CodeLine lineNumber="6517"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06518" /><CodeLine lineNumber="6518"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06519" /><CodeLine lineNumber="6519"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06520" /><CodeLine lineNumber="6520"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06521" /><CodeLine lineNumber="6521"><Highlight kind="comment">  /// Convert a SCEV of a value to a DIExpression that is pushed onto the</Highlight></CodeLine>
<Link id="l06522" /><CodeLine lineNumber="6522"><Highlight kind="comment">  /// builder&#39;s expression stack. The stack should already contain an</Highlight></CodeLine>
<Link id="l06523" /><CodeLine lineNumber="6523"><Highlight kind="comment">  /// expression for the iteration count, so that it can be multiplied by</Highlight></CodeLine>
<Link id="l06524" /><CodeLine lineNumber="6524"><Highlight kind="comment">  /// the stride and added to the start.</Highlight></CodeLine>
<Link id="l06525" /><CodeLine lineNumber="6525"><Highlight kind="comment">  /// Components of the expression are omitted if they are an identity function.</Highlight></CodeLine>
<Link id="l06526" /><CodeLine lineNumber="6526"><Highlight kind="comment">  /// Chain (non-affine) SCEVs are not supported.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06527" /><CodeLine lineNumber="6527" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aca9e38901fab9929c7c586f376249e9a"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aca9e38901fab9929c7c586f376249e9a">SCEVToValueExpr</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">llvm::SCEVAddRecExpr</a> &amp;SAR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l06528" /><CodeLine lineNumber="6528"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected affine SCEV&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06529" /><CodeLine lineNumber="6529"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// TODO: Is this check needed?</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06530" /><CodeLine lineNumber="6530"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>()))</Highlight></CodeLine>
<Link id="l06531" /><CodeLine lineNumber="6531"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06532" /><CodeLine lineNumber="6532"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06533" /><CodeLine lineNumber="6533"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Start = SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>();</Highlight></CodeLine>
<Link id="l06534" /><CodeLine lineNumber="6534"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Stride = SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE);</Highlight></CodeLine>
<Link id="l06535" /><CodeLine lineNumber="6535"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06536" /><CodeLine lineNumber="6536"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Skip pushing arithmetic noops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06537" /><CodeLine lineNumber="6537"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(llvm::dwarf::DW&#95;OP&#95;mul, Stride)) &#123;</Highlight></CodeLine>
<Link id="l06538" /><CodeLine lineNumber="6538"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Stride))</Highlight></CodeLine>
<Link id="l06539" /><CodeLine lineNumber="6539"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06540" /><CodeLine lineNumber="6540"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;mul);</Highlight></CodeLine>
<Link id="l06541" /><CodeLine lineNumber="6541"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06542" /><CodeLine lineNumber="6542"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(llvm::dwarf::DW&#95;OP&#95;plus, Start)) &#123;</Highlight></CodeLine>
<Link id="l06543" /><CodeLine lineNumber="6543"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Start))</Highlight></CodeLine>
<Link id="l06544" /><CodeLine lineNumber="6544"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06545" /><CodeLine lineNumber="6545"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;plus);</Highlight></CodeLine>
<Link id="l06546" /><CodeLine lineNumber="6546"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06547" /><CodeLine lineNumber="6547"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06548" /><CodeLine lineNumber="6548"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06549" /><CodeLine lineNumber="6549"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06550" /><CodeLine lineNumber="6550"><Highlight kind="comment">  /// Create an expression that is an offset from a value (usually the IV).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06551" /><CodeLine lineNumber="6551" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a86078042131d19e2f2316d66815279cd"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a86078042131d19e2f2316d66815279cd">createOffsetExpr</a>(int64&#95;t <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;OffsetValue) &#123;</Highlight></CodeLine>
<Link id="l06552" /><CodeLine lineNumber="6552"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9">pushLocation</a>(OffsetValue);</Highlight></CodeLine>
<Link id="l06553" /><CodeLine lineNumber="6553"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/diexpression/#a272fe723d8c234f2137d34621a5cef78">DIExpression::appendOffset</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</Highlight></CodeLine>
<Link id="l06554" /><CodeLine lineNumber="6554"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</Highlight></CodeLine>
<Link id="l06555" /><CodeLine lineNumber="6555"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: Generated IV offset expression. Offset: &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06556" /><CodeLine lineNumber="6556"><Highlight kind="normal">               &lt;&lt; std::to&#95;string(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06557" /><CodeLine lineNumber="6557"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06558" /><CodeLine lineNumber="6558"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06559" /><CodeLine lineNumber="6559"><Highlight kind="comment">  /// Combine a translation of the SCEV and the IV to create an expression that</Highlight></CodeLine>
<Link id="l06560" /><CodeLine lineNumber="6560"><Highlight kind="comment">  /// recovers a location&#39;s value.</Highlight></CodeLine>
<Link id="l06561" /><CodeLine lineNumber="6561"><Highlight kind="comment">  /// returns true if an expression was created.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06562" /><CodeLine lineNumber="6562" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac651c1875f806ba7d3b74b6e32323048"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac651c1875f806ba7d3b74b6e32323048">createIterCountExpr</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S,</Highlight></CodeLine>
<Link id="l06563" /><CodeLine lineNumber="6563"><Highlight kind="normal">                           </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a> &amp;IterationCount,</Highlight></CodeLine>
<Link id="l06564" /><CodeLine lineNumber="6564"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l06565" /><CodeLine lineNumber="6565"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// SCEVs for SSA values are most frquently of the form</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06566" /><CodeLine lineNumber="6566"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// &#123;start,+,stride&#125;, but sometimes they are (&#123;start,+,stride&#125; + %a + ..).</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06567" /><CodeLine lineNumber="6567"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// This is because %a is a PHI node that is not the IV. However, these</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06568" /><CodeLine lineNumber="6568"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// SCEVs have not been observed to result in debuginfo-lossy optimisations,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06569" /><CodeLine lineNumber="6569"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// so its not expected this point will be reached.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06570" /><CodeLine lineNumber="6570"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(S))</Highlight></CodeLine>
<Link id="l06571" /><CodeLine lineNumber="6571"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06572" /><CodeLine lineNumber="6572"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06573" /><CodeLine lineNumber="6573"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: Location to salvage SCEV: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;S</Highlight></CodeLine>
<Link id="l06574" /><CodeLine lineNumber="6574"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06575" /><CodeLine lineNumber="6575"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06576" /><CodeLine lineNumber="6576"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;Rec = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(S);</Highlight></CodeLine>
<Link id="l06577" /><CodeLine lineNumber="6577"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!Rec-&gt;isAffine())</Highlight></CodeLine>
<Link id="l06578" /><CodeLine lineNumber="6578"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06579" /><CodeLine lineNumber="6579"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06580" /><CodeLine lineNumber="6580"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (S-&gt;<a href="/docs/api/classes/llvm/scev/#a102c99af586cd76e0d9ff32ac0e825e0">getExpressionSize</a>() &gt; <a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">MaxSCEVSalvageExpressionSize</a>)</Highlight></CodeLine>
<Link id="l06581" /><CodeLine lineNumber="6581"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06582" /><CodeLine lineNumber="6582"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06583" /><CodeLine lineNumber="6583"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Initialise a new builder with the iteration count expression. In</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06584" /><CodeLine lineNumber="6584"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// combination with the value&#39;s SCEV this enables recovery.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06585" /><CodeLine lineNumber="6585"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a62bd6b249b4fa5e6373d70d73fa6237c">clone</a>(IterationCount);</Highlight></CodeLine>
<Link id="l06586" /><CodeLine lineNumber="6586"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aca9e38901fab9929c7c586f376249e9a">SCEVToValueExpr</a>(&#42;Rec, SE))</Highlight></CodeLine>
<Link id="l06587" /><CodeLine lineNumber="6587"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06588" /><CodeLine lineNumber="6588"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06589" /><CodeLine lineNumber="6589"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06590" /><CodeLine lineNumber="6590"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06591" /><CodeLine lineNumber="6591"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06592" /><CodeLine lineNumber="6592"><Highlight kind="comment">  /// Convert a SCEV of a value to a DIExpression that is pushed onto the</Highlight></CodeLine>
<Link id="l06593" /><CodeLine lineNumber="6593"><Highlight kind="comment">  /// builder&#39;s expression stack. The stack should already contain an</Highlight></CodeLine>
<Link id="l06594" /><CodeLine lineNumber="6594"><Highlight kind="comment">  /// expression for the iteration count, so that it can be multiplied by</Highlight></CodeLine>
<Link id="l06595" /><CodeLine lineNumber="6595"><Highlight kind="comment">  /// the stride and added to the start.</Highlight></CodeLine>
<Link id="l06596" /><CodeLine lineNumber="6596"><Highlight kind="comment">  /// Components of the expression are omitted if they are an identity function.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06597" /><CodeLine lineNumber="6597" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a152f85e50f38db96586836800a9e2da4"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a152f85e50f38db96586836800a9e2da4">SCEVToIterCountExpr</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">llvm::SCEVAddRecExpr</a> &amp;SAR,</Highlight></CodeLine>
<Link id="l06598" /><CodeLine lineNumber="6598"><Highlight kind="normal">                           <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</Highlight></CodeLine>
<Link id="l06599" /><CodeLine lineNumber="6599"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>() &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected affine SCEV&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06600" /><CodeLine lineNumber="6600"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>())) &#123;</Highlight></CodeLine>
<Link id="l06601" /><CodeLine lineNumber="6601"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: IV SCEV. Unsupported nested AddRec: &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06602" /><CodeLine lineNumber="6602"><Highlight kind="normal">                        &lt;&lt; SAR &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06603" /><CodeLine lineNumber="6603"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06604" /><CodeLine lineNumber="6604"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06605" /><CodeLine lineNumber="6605"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Start = SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>();</Highlight></CodeLine>
<Link id="l06606" /><CodeLine lineNumber="6606"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Stride = SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE);</Highlight></CodeLine>
<Link id="l06607" /><CodeLine lineNumber="6607"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06608" /><CodeLine lineNumber="6608"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Skip pushing arithmetic noops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06609" /><CodeLine lineNumber="6609"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(llvm::dwarf::DW&#95;OP&#95;minus, Start)) &#123;</Highlight></CodeLine>
<Link id="l06610" /><CodeLine lineNumber="6610"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Start))</Highlight></CodeLine>
<Link id="l06611" /><CodeLine lineNumber="6611"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06612" /><CodeLine lineNumber="6612"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;minus);</Highlight></CodeLine>
<Link id="l06613" /><CodeLine lineNumber="6613"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06614" /><CodeLine lineNumber="6614"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(llvm::dwarf::DW&#95;OP&#95;div, Stride)) &#123;</Highlight></CodeLine>
<Link id="l06615" /><CodeLine lineNumber="6615"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Stride))</Highlight></CodeLine>
<Link id="l06616" /><CodeLine lineNumber="6616"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06617" /><CodeLine lineNumber="6617"><Highlight kind="normal">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;div);</Highlight></CodeLine>
<Link id="l06618" /><CodeLine lineNumber="6618"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06619" /><CodeLine lineNumber="6619"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06620" /><CodeLine lineNumber="6620"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06621" /><CodeLine lineNumber="6621"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06622" /><CodeLine lineNumber="6622"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Append the current expression and locations to a location list and an</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06623" /><CodeLine lineNumber="6623"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// expression list. Modify the DW&#95;OP&#95;LLVM&#95;arg indexes to account for</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06624" /><CodeLine lineNumber="6624"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the locations already present in the destination list.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06625" /><CodeLine lineNumber="6625" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a08fddb3d382c1c806dee38774e6464d7"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a08fddb3d382c1c806dee38774e6464d7">appendToVectors</a>(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;DestExpr,</Highlight></CodeLine>
<Link id="l06626" /><CodeLine lineNumber="6626"><Highlight kind="normal">                       <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;DestLocations) &#123;</Highlight></CodeLine>
<Link id="l06627" /><CodeLine lineNumber="6627"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>() &amp;&amp;</Highlight></CodeLine>
<Link id="l06628" /><CodeLine lineNumber="6628"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Expected the locations vector to contain the IV&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06629" /><CodeLine lineNumber="6629"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The DWARF&#95;OP&#95;LLVM&#95;arg arguments of the expression being appended must be</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06630" /><CodeLine lineNumber="6630"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// modified to account for the locations already in the destination vector.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06631" /><CodeLine lineNumber="6631"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// All builders contain the IV as the first location op.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06632" /><CodeLine lineNumber="6632"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.empty() &amp;&amp;</Highlight></CodeLine>
<Link id="l06633" /><CodeLine lineNumber="6633"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Expected the location ops to contain the IV.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06634" /><CodeLine lineNumber="6634"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// DestIndexMap&#91;n&#93; contains the index in DestLocations for the nth</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06635" /><CodeLine lineNumber="6635"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// location in this SCEVDbgValueBuilder.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06636" /><CodeLine lineNumber="6636"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;uint64&#95;t, 2&gt;</a> DestIndexMap;</Highlight></CodeLine>
<Link id="l06637" /><CodeLine lineNumber="6637"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>) &#123;</Highlight></CodeLine>
<Link id="l06638" /><CodeLine lineNumber="6638"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> It = <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">find</a>(DestLocations, <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</Highlight></CodeLine>
<Link id="l06639" /><CodeLine lineNumber="6639"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (It != DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>()) &#123;</Highlight></CodeLine>
<Link id="l06640" /><CodeLine lineNumber="6640"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Location already exists in DestLocations, reuse existing ArgIndex.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06641" /><CodeLine lineNumber="6641"><Highlight kind="normal">        DestIndexMap.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(std::distance(DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), It));</Highlight></CodeLine>
<Link id="l06642" /><CodeLine lineNumber="6642"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06643" /><CodeLine lineNumber="6643"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l06644" /><CodeLine lineNumber="6644"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Location is not in DestLocations, add it.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06645" /><CodeLine lineNumber="6645"><Highlight kind="normal">      DestIndexMap.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>());</Highlight></CodeLine>
<Link id="l06646" /><CodeLine lineNumber="6646"><Highlight kind="normal">      DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</Highlight></CodeLine>
<Link id="l06647" /><CodeLine lineNumber="6647"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06648" /><CodeLine lineNumber="6648"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06649" /><CodeLine lineNumber="6649"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1fb2fff65491c783042bbbc6716bd5d2">expr&#95;ops</a>()) &#123;</Highlight></CodeLine>
<Link id="l06650" /><CodeLine lineNumber="6650"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getOp() != <a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>) &#123;</Highlight></CodeLine>
<Link id="l06651" /><CodeLine lineNumber="6651"><Highlight kind="normal">        <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.appendToVector(DestExpr);</Highlight></CodeLine>
<Link id="l06652" /><CodeLine lineNumber="6652"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06653" /><CodeLine lineNumber="6653"><Highlight kind="normal">      &#125; </Highlight></CodeLine>
<Link id="l06654" /><CodeLine lineNumber="6654"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06655" /><CodeLine lineNumber="6655"><Highlight kind="normal">      DestExpr.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>);</Highlight></CodeLine>
<Link id="l06656" /><CodeLine lineNumber="6656"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// &#96;DW&#95;OP&#95;LLVM&#95;arg n&#96; represents the nth LocationOp in this SCEV,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06657" /><CodeLine lineNumber="6657"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// DestIndexMap&#91;n&#93; contains its new index in DestLocations.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06658" /><CodeLine lineNumber="6658"><Highlight kind="normal">      uint64&#95;t NewIndex = DestIndexMap&#91;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getArg(0)&#93;;</Highlight></CodeLine>
<Link id="l06659" /><CodeLine lineNumber="6659"><Highlight kind="normal">      DestExpr.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NewIndex);</Highlight></CodeLine>
<Link id="l06660" /><CodeLine lineNumber="6660"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06661" /><CodeLine lineNumber="6661"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06662" /><CodeLine lineNumber="6662"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l06663" /><CodeLine lineNumber="6663"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06664" /><CodeLine lineNumber="6664"><Highlight kind="comment">/// Holds all the required data to salvage a dbg.value using the pre-LSR SCEVs</Highlight></CodeLine>
<Link id="l06665" /><CodeLine lineNumber="6665"><Highlight kind="comment">/// and DIExpression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06666" /><CodeLine lineNumber="6666" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec"><Highlight kind="normal"></Highlight><Highlight kind="keyword">struct </Highlight><Highlight kind="normal"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a257452550319ec63f0ee22b1b51a6f7d">DVIRecoveryRec</a> &#123;</Highlight></CodeLine>
<Link id="l06667" /><CodeLine lineNumber="6667" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a257452550319ec63f0ee22b1b51a6f7d"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a257452550319ec63f0ee22b1b51a6f7d">DVIRecoveryRec</a>(<a href="/docs/api/classes/llvm/dbgvalueinst">DbgValueInst</a> &#42;<a href="/docs/api/classes/livedebugvalues/dbgvalue">DbgValue</a>)</Highlight></CodeLine>
<Link id="l06668" /><CodeLine lineNumber="6668"><Highlight kind="normal">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a553ab2b381cedfabe8fe036dce1d0ef7">DbgRef</a>(<a href="/docs/api/classes/livedebugvalues/dbgvalue">DbgValue</a>), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a4e708234dce59260f06d8ea797bb02ac">Expr</a>(<a href="/docs/api/classes/livedebugvalues/dbgvalue">DbgValue</a>-&gt;getExpression()),</Highlight></CodeLine>
<Link id="l06669" /><CodeLine lineNumber="6669"><Highlight kind="normal">        <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af84ec7c45a639a818a0f1e4302282a39">HadLocationArgList</a>(<a href="/docs/api/namespaces/false">false</a>) &#123;&#125;</Highlight></CodeLine>
<Link id="l06670" /><CodeLine lineNumber="6670" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1539ca80a2b86d985988d03787b3c83c"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1539ca80a2b86d985988d03787b3c83c">DVIRecoveryRec</a>(<a href="/docs/api/classes/llvm/dbgvariablerecord">DbgVariableRecord</a> &#42;DVR)</Highlight></CodeLine>
<Link id="l06671" /><CodeLine lineNumber="6671"><Highlight kind="normal">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a553ab2b381cedfabe8fe036dce1d0ef7">DbgRef</a>(DVR), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a4e708234dce59260f06d8ea797bb02ac">Expr</a>(DVR-&gt;getExpression()), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af84ec7c45a639a818a0f1e4302282a39">HadLocationArgList</a>(<a href="/docs/api/namespaces/false">false</a>) &#123;&#125;</Highlight></CodeLine>
<Link id="l06672" /><CodeLine lineNumber="6672"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06673" /><CodeLine lineNumber="6673" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a553ab2b381cedfabe8fe036dce1d0ef7"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/pointerunion">PointerUnion&lt;DbgValueInst &#42;, DbgVariableRecord &#42;&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a553ab2b381cedfabe8fe036dce1d0ef7">DbgRef</a>;</Highlight></CodeLine>
<Link id="l06674" /><CodeLine lineNumber="6674" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a4e708234dce59260f06d8ea797bb02ac"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/diexpression">DIExpression</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a4e708234dce59260f06d8ea797bb02ac">Expr</a>;</Highlight></CodeLine>
<Link id="l06675" /><CodeLine lineNumber="6675" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af84ec7c45a639a818a0f1e4302282a39"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af84ec7c45a639a818a0f1e4302282a39">HadLocationArgList</a>;</Highlight></CodeLine>
<Link id="l06676" /><CodeLine lineNumber="6676" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af395aaa694d852ba81d636ce8eb9ebd1"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WeakVH, 2&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af395aaa694d852ba81d636ce8eb9ebd1">LocationOps</a>;</Highlight></CodeLine>
<Link id="l06677" /><CodeLine lineNumber="6677" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af54c2e7898cc927115bb676ca15cb6fb"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const llvm::SCEV &#42;, 2&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af54c2e7898cc927115bb676ca15cb6fb">SCEVs</a>;</Highlight></CodeLine>
<Link id="l06678" /><CodeLine lineNumber="6678" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a9acdeb65c154488191ef5ba620e64125"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::unique&#95;ptr&lt;SCEVDbgValueBuilder&gt;</a>, 2&gt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a9acdeb65c154488191ef5ba620e64125">RecoveryExprs</a>;</Highlight></CodeLine>
<Link id="l06679" /><CodeLine lineNumber="6679"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06680" /><CodeLine lineNumber="6680" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1f1964f2d7132dd4b5a4aa871d765465"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1f1964f2d7132dd4b5a4aa871d765465">clear</a>() &#123;</Highlight></CodeLine>
<Link id="l06681" /><CodeLine lineNumber="6681"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;RE : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a9acdeb65c154488191ef5ba620e64125">RecoveryExprs</a>)</Highlight></CodeLine>
<Link id="l06682" /><CodeLine lineNumber="6682"><Highlight kind="normal">      RE.reset();</Highlight></CodeLine>
<Link id="l06683" /><CodeLine lineNumber="6683"><Highlight kind="normal">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a9acdeb65c154488191ef5ba620e64125">RecoveryExprs</a>.clear();</Highlight></CodeLine>
<Link id="l06684" /><CodeLine lineNumber="6684"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06685" /><CodeLine lineNumber="6685"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06686" /><CodeLine lineNumber="6686" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#aa935bd072ea71a4c50979580de6f13ed"><Highlight kind="normal">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#aa935bd072ea71a4c50979580de6f13ed">~DVIRecoveryRec</a>() &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1f1964f2d7132dd4b5a4aa871d765465">clear</a>(); &#125;</Highlight></CodeLine>
<Link id="l06687" /><CodeLine lineNumber="6687"><Highlight kind="normal">&#125;;</Highlight></CodeLine>
<Link id="l06688" /><CodeLine lineNumber="6688"><Highlight kind="normal">&#125; </Highlight><Highlight kind="comment">// namespace</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06689" /><CodeLine lineNumber="6689"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06690" /><CodeLine lineNumber="6690"><Highlight kind="comment">/// Returns the total number of DW&#95;OP&#95;llvm&#95;arg operands in the expression.</Highlight></CodeLine>
<Link id="l06691" /><CodeLine lineNumber="6691"><Highlight kind="comment">/// This helps in determining if a DIArglist is necessary or can be omitted from</Highlight></CodeLine>
<Link id="l06692" /><CodeLine lineNumber="6692"><Highlight kind="comment">/// the dbg.value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06693" /><CodeLine lineNumber="6693" lineLink="#a80e922a79a22107b2f70e851825d098e"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a>(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;Expr) &#123;</Highlight></CodeLine>
<Link id="l06694" /><CodeLine lineNumber="6694"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> expr&#95;ops = <a href="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-/#a391c5efa7f6eb049718971aeeb9b71d5">ToDwarfOpIter</a>(Expr);</Highlight></CodeLine>
<Link id="l06695" /><CodeLine lineNumber="6695"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a> = 0;</Highlight></CodeLine>
<Link id="l06696" /><CodeLine lineNumber="6696"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : expr&#95;ops)</Highlight></CodeLine>
<Link id="l06697" /><CodeLine lineNumber="6697"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getOp() == <a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>)</Highlight></CodeLine>
<Link id="l06698" /><CodeLine lineNumber="6698"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a>++;</Highlight></CodeLine>
<Link id="l06699" /><CodeLine lineNumber="6699"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a>;</Highlight></CodeLine>
<Link id="l06700" /><CodeLine lineNumber="6700"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06701" /><CodeLine lineNumber="6701"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06702" /><CodeLine lineNumber="6702"><Highlight kind="comment">/// Overwrites DVI with the location and Ops as the DIExpression. This will</Highlight></CodeLine>
<Link id="l06703" /><CodeLine lineNumber="6703"><Highlight kind="comment">/// create an invalid expression if Ops has any dwarf::DW&#95;OP&#95;llvm&#95;arg operands,</Highlight></CodeLine>
<Link id="l06704" /><CodeLine lineNumber="6704"><Highlight kind="comment">/// because a DIArglist is not created for the first argument of the dbg.value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06705" /><CodeLine lineNumber="6705"><Highlight kind="normal"></Highlight><Highlight kind="keyword">template</Highlight><Highlight kind="normal"> &lt;</Highlight><Highlight kind="keyword">typename</Highlight><Highlight kind="normal"> T&gt;</Highlight></CodeLine>
<Link id="l06706" /><CodeLine lineNumber="6706" lineLink="#a4d8f7ff97b22c5203b332a778c88b088"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a4d8f7ff97b22c5203b332a778c88b088">updateDVIWithLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a> &amp;DbgVal, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Location,</Highlight></CodeLine>
<Link id="l06707" /><CodeLine lineNumber="6707"><Highlight kind="normal">                                  <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) &#123;</Highlight></CodeLine>
<Link id="l06708" /><CodeLine lineNumber="6708"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) == 0 &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected expression that does not &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06709" /><CodeLine lineNumber="6709"><Highlight kind="normal">                                    </Highlight><Highlight kind="stringliteral">&quot;contain any DW&#95;OP&#95;llvm&#95;arg operands.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06710" /><CodeLine lineNumber="6710"><Highlight kind="normal">  DbgVal.setRawLocation(<a href="/docs/api/classes/llvm/valueasmetadata/#a53fc78b63202142110d0e86dd1a71fbe">ValueAsMetadata::get</a>(Location));</Highlight></CodeLine>
<Link id="l06711" /><CodeLine lineNumber="6711"><Highlight kind="normal">  DbgVal.setExpression(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DIExpression::get</a>(DbgVal.getContext(), <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</Highlight></CodeLine>
<Link id="l06712" /><CodeLine lineNumber="6712"><Highlight kind="normal">  DbgVal.setExpression(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DIExpression::get</a>(DbgVal.getContext(), <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</Highlight></CodeLine>
<Link id="l06713" /><CodeLine lineNumber="6713"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06714" /><CodeLine lineNumber="6714"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06715" /><CodeLine lineNumber="6715"><Highlight kind="comment">/// Overwrite DVI with locations placed into a DIArglist.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06716" /><CodeLine lineNumber="6716"><Highlight kind="normal"></Highlight><Highlight kind="keyword">template</Highlight><Highlight kind="normal"> &lt;</Highlight><Highlight kind="keyword">typename</Highlight><Highlight kind="normal"> T&gt;</Highlight></CodeLine>
<Link id="l06717" /><CodeLine lineNumber="6717" lineLink="#ab2e6fc08d8f586e4979511620c12ffa8"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#ab2e6fc08d8f586e4979511620c12ffa8">updateDVIWithLocations</a>(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a> &amp;DbgVal,</Highlight></CodeLine>
<Link id="l06718" /><CodeLine lineNumber="6718"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;Locations,</Highlight></CodeLine>
<Link id="l06719" /><CodeLine lineNumber="6719"><Highlight kind="normal">                                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) &#123;</Highlight></CodeLine>
<Link id="l06720" /><CodeLine lineNumber="6720"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) != 0 &amp;&amp;</Highlight></CodeLine>
<Link id="l06721" /><CodeLine lineNumber="6721"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Expected expression that references DIArglist locations using &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06722" /><CodeLine lineNumber="6722"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;DW&#95;OP&#95;llvm&#95;arg operands.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06723" /><CodeLine lineNumber="6723"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ValueAsMetadata &#42;, 3&gt;</a> MetadataLocs;</Highlight></CodeLine>
<Link id="l06724" /><CodeLine lineNumber="6724"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/value">Value</a> &#42;V : Locations)</Highlight></CodeLine>
<Link id="l06725" /><CodeLine lineNumber="6725"><Highlight kind="normal">    MetadataLocs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/classes/llvm/valueasmetadata/#a53fc78b63202142110d0e86dd1a71fbe">ValueAsMetadata::get</a>(V));</Highlight></CodeLine>
<Link id="l06726" /><CodeLine lineNumber="6726"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> ValArrayRef = <a href="/docs/api/classes/llvm/arrayref">llvm::ArrayRef&lt;llvm::ValueAsMetadata &#42;&gt;</a>(MetadataLocs);</Highlight></CodeLine>
<Link id="l06727" /><CodeLine lineNumber="6727"><Highlight kind="normal">  DbgVal.setRawLocation(<a href="/docs/api/classes/llvm/diarglist/#a51072a9980c37f5cce2a30e9dc4b3057">llvm::DIArgList::get</a>(DbgVal.getContext(), ValArrayRef));</Highlight></CodeLine>
<Link id="l06728" /><CodeLine lineNumber="6728"><Highlight kind="normal">  DbgVal.setExpression(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DIExpression::get</a>(DbgVal.getContext(), <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</Highlight></CodeLine>
<Link id="l06729" /><CodeLine lineNumber="6729"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06730" /><CodeLine lineNumber="6730"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06731" /><CodeLine lineNumber="6731"><Highlight kind="comment">/// Write the new expression and new location ops for the dbg.value. If possible</Highlight></CodeLine>
<Link id="l06732" /><CodeLine lineNumber="6732"><Highlight kind="comment">/// reduce the szie of the dbg.value intrinsic by omitting DIArglist. This</Highlight></CodeLine>
<Link id="l06733" /><CodeLine lineNumber="6733"><Highlight kind="comment">/// can be omitted if:</Highlight></CodeLine>
<Link id="l06734" /><CodeLine lineNumber="6734"><Highlight kind="comment">/// 1 There is only a single location, refenced by a single DW&#95;OP&#95;llvm&#95;arg.</Highlight></CodeLine>
<Link id="l06735" /><CodeLine lineNumber="6735"><Highlight kind="comment">/// 2 The DW&#95;OP&#95;LLVM&#95;arg is the first operand in the expression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06736" /><CodeLine lineNumber="6736" lineLink="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0">UpdateDbgValueInst</a>(DVIRecoveryRec &amp;DVIRec,</Highlight></CodeLine>
<Link id="l06737" /><CodeLine lineNumber="6737"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;NewLocationOps,</Highlight></CodeLine>
<Link id="l06738" /><CodeLine lineNumber="6738"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;<a href="/docs/api/classes/newexpr">NewExpr</a>) &#123;</Highlight></CodeLine>
<Link id="l06739" /><CodeLine lineNumber="6739"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> UpdateDbgValueInstImpl = &#91;&amp;&#93;(</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;DbgVal) &#123;</Highlight></CodeLine>
<Link id="l06740" /><CodeLine lineNumber="6740"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> NumLLVMArgs = <a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a>(<a href="/docs/api/classes/newexpr">NewExpr</a>);</Highlight></CodeLine>
<Link id="l06741" /><CodeLine lineNumber="6741"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumLLVMArgs == 0) &#123;</Highlight></CodeLine>
<Link id="l06742" /><CodeLine lineNumber="6742"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Location assumed to be on the stack.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06743" /><CodeLine lineNumber="6743"><Highlight kind="normal">      <a href="#a4d8f7ff97b22c5203b332a778c88b088">updateDVIWithLocation</a>(&#42;DbgVal, NewLocationOps&#91;0&#93;, <a href="/docs/api/classes/newexpr">NewExpr</a>);</Highlight></CodeLine>
<Link id="l06744" /><CodeLine lineNumber="6744"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (NumLLVMArgs == 1 &amp;&amp; <a href="/docs/api/classes/newexpr">NewExpr</a>&#91;0&#93; == <a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>) &#123;</Highlight></CodeLine>
<Link id="l06745" /><CodeLine lineNumber="6745"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// There is only a single DW&#95;OP&#95;llvm&#95;arg at the start of the expression,</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06746" /><CodeLine lineNumber="6746"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// so it can be omitted along with DIArglist.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06747" /><CodeLine lineNumber="6747"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/newexpr">NewExpr</a>&#91;1&#93; == 0 &amp;&amp;</Highlight></CodeLine>
<Link id="l06748" /><CodeLine lineNumber="6748"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Lone LLVM&#95;arg in a DIExpression should refer to location-op 0.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06749" /><CodeLine lineNumber="6749"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/smallvector">llvm::SmallVector&lt;uint64&#95;t, 6&gt;</a> ShortenedOps(<a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">llvm::drop&#95;begin</a>(<a href="/docs/api/classes/newexpr">NewExpr</a>, 2));</Highlight></CodeLine>
<Link id="l06750" /><CodeLine lineNumber="6750"><Highlight kind="normal">      <a href="#a4d8f7ff97b22c5203b332a778c88b088">updateDVIWithLocation</a>(&#42;DbgVal, NewLocationOps&#91;0&#93;, ShortenedOps);</Highlight></CodeLine>
<Link id="l06751" /><CodeLine lineNumber="6751"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06752" /><CodeLine lineNumber="6752"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// Multiple DW&#95;OP&#95;llvm&#95;arg, so DIArgList is strictly necessary.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06753" /><CodeLine lineNumber="6753"><Highlight kind="normal">      <a href="#ab2e6fc08d8f586e4979511620c12ffa8">updateDVIWithLocations</a>(&#42;DbgVal, NewLocationOps, <a href="/docs/api/classes/newexpr">NewExpr</a>);</Highlight></CodeLine>
<Link id="l06754" /><CodeLine lineNumber="6754"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06755" /><CodeLine lineNumber="6755"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06756" /><CodeLine lineNumber="6756"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// If the DIExpression was previously empty then add the stack terminator.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06757" /><CodeLine lineNumber="6757"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Non-empty expressions have only had elements inserted into them and so</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06758" /><CodeLine lineNumber="6758"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// the terminator should already be present e.g. stack&#95;value or fragment.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06759" /><CodeLine lineNumber="6759"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/diexpression">DIExpression</a> &#42;SalvageExpr = DbgVal-&gt;getExpression();</Highlight></CodeLine>
<Link id="l06760" /><CodeLine lineNumber="6760"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DVIRec.Expr-&gt;isComplex() &amp;&amp; SalvageExpr-&gt;<a href="/docs/api/classes/llvm/diexpression/#a7926734793677673e68d8cff410552ec">isComplex</a>()) &#123;</Highlight></CodeLine>
<Link id="l06761" /><CodeLine lineNumber="6761"><Highlight kind="normal">      SalvageExpr =</Highlight></CodeLine>
<Link id="l06762" /><CodeLine lineNumber="6762"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/diexpression/#a15f4de7989cc83855e8f65792ae94bc4">DIExpression::append</a>(SalvageExpr, &#123;dwarf::DW&#95;OP&#95;stack&#95;value&#125;);</Highlight></CodeLine>
<Link id="l06763" /><CodeLine lineNumber="6763"><Highlight kind="normal">      DbgVal-&gt;setExpression(SalvageExpr);</Highlight></CodeLine>
<Link id="l06764" /><CodeLine lineNumber="6764"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06765" /><CodeLine lineNumber="6765"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l06766" /><CodeLine lineNumber="6766"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef))</Highlight></CodeLine>
<Link id="l06767" /><CodeLine lineNumber="6767"><Highlight kind="normal">    UpdateDbgValueInstImpl(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef));</Highlight></CodeLine>
<Link id="l06768" /><CodeLine lineNumber="6768"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06769" /><CodeLine lineNumber="6769"><Highlight kind="normal">    UpdateDbgValueInstImpl(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgVariableRecord &#42;&gt;</a>(DVIRec.DbgRef));</Highlight></CodeLine>
<Link id="l06770" /><CodeLine lineNumber="6770"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06771" /><CodeLine lineNumber="6771"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06772" /><CodeLine lineNumber="6772"><Highlight kind="comment">/// Cached location ops may be erased during LSR, in which case a poison is</Highlight></CodeLine>
<Link id="l06773" /><CodeLine lineNumber="6773"><Highlight kind="comment">/// required when restoring from the cache. The type of that location is no</Highlight></CodeLine>
<Link id="l06774" /><CodeLine lineNumber="6774"><Highlight kind="comment">/// longer available, so just use int8. The poison will be replaced by one or</Highlight></CodeLine>
<Link id="l06775" /><CodeLine lineNumber="6775"><Highlight kind="comment">/// more locations later when a SCEVDbgValueBuilder selects alternative</Highlight></CodeLine>
<Link id="l06776" /><CodeLine lineNumber="6776"><Highlight kind="comment">/// locations to use for the salvage.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06777" /><CodeLine lineNumber="6777" lineLink="#a7c340cc26f0c6d27219747cac55a2dc2"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="#a7c340cc26f0c6d27219747cac55a2dc2">getValueOrPoison</a>(<a href="/docs/api/classes/llvm/weakvh">WeakVH</a> &amp;VH, <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>) &#123;</Highlight></CodeLine>
<Link id="l06778" /><CodeLine lineNumber="6778"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> (VH) ? VH : <a href="/docs/api/classes/llvm/poisonvalue/#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(<a href="/docs/api/classes/llvm/type/#a7ba5de75f50bb4a4ba920698edf39b28">llvm::Type::getInt8Ty</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>));</Highlight></CodeLine>
<Link id="l06779" /><CodeLine lineNumber="6779"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06780" /><CodeLine lineNumber="6780"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06781" /><CodeLine lineNumber="6781"><Highlight kind="comment">/// Restore the DVI&#39;s pre-LSR arguments. Substitute undef for any erased values.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06782" /><CodeLine lineNumber="6782" lineLink="#a196b104079c33f7ccd4ad4816376b9a7"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a196b104079c33f7ccd4ad4816376b9a7">restorePreTransformState</a>(DVIRecoveryRec &amp;DVIRec) &#123;</Highlight></CodeLine>
<Link id="l06783" /><CodeLine lineNumber="6783"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> RestorePreTransformStateImpl = &#91;&amp;&#93;(</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;DbgVal) &#123;</Highlight></CodeLine>
<Link id="l06784" /><CodeLine lineNumber="6784"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: restore dbg.value to pre-LSR state\\n&quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06785" /><CodeLine lineNumber="6785"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: post-LSR: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;DbgVal &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06786" /><CodeLine lineNumber="6786"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVIRec.Expr &amp;&amp; </Highlight><Highlight kind="stringliteral">&quot;Expected an expression&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06787" /><CodeLine lineNumber="6787"><Highlight kind="normal">    DbgVal-&gt;setExpression(DVIRec.Expr);</Highlight></CodeLine>
<Link id="l06788" /><CodeLine lineNumber="6788"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06789" /><CodeLine lineNumber="6789"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Even a single location-op may be inside a DIArgList and referenced with</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06790" /><CodeLine lineNumber="6790"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// DW&#95;OP&#95;LLVM&#95;arg, which is valid only with a DIArgList.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06791" /><CodeLine lineNumber="6791"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DVIRec.HadLocationArgList) &#123;</Highlight></CodeLine>
<Link id="l06792" /><CodeLine lineNumber="6792"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVIRec.LocationOps.size() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l06793" /><CodeLine lineNumber="6793"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Unexpected number of location ops.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06794" /><CodeLine lineNumber="6794"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// LSR&#39;s unsuccessful salvage attempt may have added DIArgList, which in</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06795" /><CodeLine lineNumber="6795"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// this case was not present before, so force the location back to a</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06796" /><CodeLine lineNumber="6796"><Highlight kind="normal">      </Highlight><Highlight kind="comment">// single uncontained Value.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06797" /><CodeLine lineNumber="6797"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;CachedValue =</Highlight></CodeLine>
<Link id="l06798" /><CodeLine lineNumber="6798"><Highlight kind="normal">          <a href="#a7c340cc26f0c6d27219747cac55a2dc2">getValueOrPoison</a>(DVIRec.LocationOps&#91;0&#93;, DbgVal-&gt;getContext());</Highlight></CodeLine>
<Link id="l06799" /><CodeLine lineNumber="6799"><Highlight kind="normal">      DbgVal-&gt;setRawLocation(<a href="/docs/api/classes/llvm/valueasmetadata/#a53fc78b63202142110d0e86dd1a71fbe">ValueAsMetadata::get</a>(CachedValue));</Highlight></CodeLine>
<Link id="l06800" /><CodeLine lineNumber="6800"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06801" /><CodeLine lineNumber="6801"><Highlight kind="normal">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ValueAsMetadata &#42;, 3&gt;</a> MetadataLocs;</Highlight></CodeLine>
<Link id="l06802" /><CodeLine lineNumber="6802"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/weakvh">WeakVH</a> VH : DVIRec.LocationOps) &#123;</Highlight></CodeLine>
<Link id="l06803" /><CodeLine lineNumber="6803"><Highlight kind="normal">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;CachedValue = <a href="#a7c340cc26f0c6d27219747cac55a2dc2">getValueOrPoison</a>(VH, DbgVal-&gt;getContext());</Highlight></CodeLine>
<Link id="l06804" /><CodeLine lineNumber="6804"><Highlight kind="normal">        MetadataLocs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/classes/llvm/valueasmetadata/#a53fc78b63202142110d0e86dd1a71fbe">ValueAsMetadata::get</a>(CachedValue));</Highlight></CodeLine>
<Link id="l06805" /><CodeLine lineNumber="6805"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l06806" /><CodeLine lineNumber="6806"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> ValArrayRef = <a href="/docs/api/classes/llvm/arrayref">llvm::ArrayRef&lt;llvm::ValueAsMetadata &#42;&gt;</a>(MetadataLocs);</Highlight></CodeLine>
<Link id="l06807" /><CodeLine lineNumber="6807"><Highlight kind="normal">      DbgVal-&gt;setRawLocation(</Highlight></CodeLine>
<Link id="l06808" /><CodeLine lineNumber="6808"><Highlight kind="normal">          <a href="/docs/api/classes/llvm/diarglist/#a51072a9980c37f5cce2a30e9dc4b3057">llvm::DIArgList::get</a>(DbgVal-&gt;getContext(), ValArrayRef));</Highlight></CodeLine>
<Link id="l06809" /><CodeLine lineNumber="6809"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06810" /><CodeLine lineNumber="6810"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: pre-LSR: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;DbgVal &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06811" /><CodeLine lineNumber="6811"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l06812" /><CodeLine lineNumber="6812"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef))</Highlight></CodeLine>
<Link id="l06813" /><CodeLine lineNumber="6813"><Highlight kind="normal">    RestorePreTransformStateImpl(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef));</Highlight></CodeLine>
<Link id="l06814" /><CodeLine lineNumber="6814"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06815" /><CodeLine lineNumber="6815"><Highlight kind="normal">    RestorePreTransformStateImpl(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgVariableRecord &#42;&gt;</a>(DVIRec.DbgRef));</Highlight></CodeLine>
<Link id="l06816" /><CodeLine lineNumber="6816"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06817" /><CodeLine lineNumber="6817"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06818" /><CodeLine lineNumber="6818" lineLink="#a02cf9d6ac96ae27b406798da5c2eb7ea"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#a02cf9d6ac96ae27b406798da5c2eb7ea">SalvageDVI</a>(<a href="/docs/api/classes/llvm/loop">llvm::Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</Highlight></CodeLine>
<Link id="l06819" /><CodeLine lineNumber="6819"><Highlight kind="normal">                       <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;LSRInductionVar, DVIRecoveryRec &amp;DVIRec,</Highlight></CodeLine>
<Link id="l06820" /><CodeLine lineNumber="6820"><Highlight kind="normal">                       </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;SCEVInductionVar,</Highlight></CodeLine>
<Link id="l06821" /><CodeLine lineNumber="6821"><Highlight kind="normal">                       SCEVDbgValueBuilder IterCountExpr) &#123;</Highlight></CodeLine>
<Link id="l06822" /><CodeLine lineNumber="6822"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06823" /><CodeLine lineNumber="6823"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef)</Highlight></CodeLine>
<Link id="l06824" /><CodeLine lineNumber="6824"><Highlight kind="normal">          ? !<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef)-&gt;isKillLocation()</Highlight></CodeLine>
<Link id="l06825" /><CodeLine lineNumber="6825"><Highlight kind="normal">          : !<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgVariableRecord &#42;&gt;</a>(DVIRec.DbgRef)-&gt;isKillLocation())</Highlight></CodeLine>
<Link id="l06826" /><CodeLine lineNumber="6826"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06827" /><CodeLine lineNumber="6827"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06828" /><CodeLine lineNumber="6828"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// LSR may have caused several changes to the dbg.value in the failed salvage</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06829" /><CodeLine lineNumber="6829"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// attempt. So restore the DIExpression, the location ops and also the</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06830" /><CodeLine lineNumber="6830"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// location ops format, which is always DIArglist for multiple ops, but only</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06831" /><CodeLine lineNumber="6831"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// sometimes for a single op.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06832" /><CodeLine lineNumber="6832"><Highlight kind="normal">  <a href="#a196b104079c33f7ccd4ad4816376b9a7">restorePreTransformState</a>(DVIRec);</Highlight></CodeLine>
<Link id="l06833" /><CodeLine lineNumber="6833"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06834" /><CodeLine lineNumber="6834"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// LocationOpIndexMap&#91;i&#93; will store the post-LSR location index of</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06835" /><CodeLine lineNumber="6835"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// the non-optimised out location at pre-LSR index i.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06836" /><CodeLine lineNumber="6836"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;int64&#95;t, 2&gt;</a> LocationOpIndexMap;</Highlight></CodeLine>
<Link id="l06837" /><CodeLine lineNumber="6837"><Highlight kind="normal">  LocationOpIndexMap.<a href="/docs/api/classes/llvm/smallvectorimpl/#a38c50aa8e3e9588f4f968c2e03a0cee0">assign</a>(DVIRec.LocationOps.size(), -1);</Highlight></CodeLine>
<Link id="l06838" /><CodeLine lineNumber="6838"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 2&gt;</a> NewLocationOps;</Highlight></CodeLine>
<Link id="l06839" /><CodeLine lineNumber="6839"><Highlight kind="normal">  NewLocationOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LSRInductionVar);</Highlight></CodeLine>
<Link id="l06840" /><CodeLine lineNumber="6840"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06841" /><CodeLine lineNumber="6841"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> i = 0; i &lt; DVIRec.LocationOps.size(); i++) &#123;</Highlight></CodeLine>
<Link id="l06842" /><CodeLine lineNumber="6842"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/weakvh">WeakVH</a> VH = DVIRec.LocationOps&#91;i&#93;;</Highlight></CodeLine>
<Link id="l06843" /><CodeLine lineNumber="6843"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Place the locations not optimised out in the list first, avoiding</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06844" /><CodeLine lineNumber="6844"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// inserts later. The map is used to update the DIExpression&#39;s</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06845" /><CodeLine lineNumber="6845"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// DW&#95;OP&#95;LLVM&#95;arg arguments as the expression is updated.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06846" /><CodeLine lineNumber="6846"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (VH &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;UndefValue&gt;</a>(VH)) &#123;</Highlight></CodeLine>
<Link id="l06847" /><CodeLine lineNumber="6847"><Highlight kind="normal">      NewLocationOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(VH);</Highlight></CodeLine>
<Link id="l06848" /><CodeLine lineNumber="6848"><Highlight kind="normal">      LocationOpIndexMap&#91;i&#93; = NewLocationOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() - 1;</Highlight></CodeLine>
<Link id="l06849" /><CodeLine lineNumber="6849"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: Location index &quot;</Highlight><Highlight kind="normal"> &lt;&lt; i</Highlight></CodeLine>
<Link id="l06850" /><CodeLine lineNumber="6850"><Highlight kind="normal">                        &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; now at index &quot;</Highlight><Highlight kind="normal"> &lt;&lt; LocationOpIndexMap&#91;i&#93; &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06851" /><CodeLine lineNumber="6851"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06852" /><CodeLine lineNumber="6852"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06853" /><CodeLine lineNumber="6853"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06854" /><CodeLine lineNumber="6854"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// It&#39;s possible that a value referred to in the SCEV may have been</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06855" /><CodeLine lineNumber="6855"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// optimised out by LSR.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06856" /><CodeLine lineNumber="6856"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.<a href="/docs/api/classes/llvm/scalarevolution/#af327db7ab1b1996680bd467f6ce109bc">containsErasedValue</a>(DVIRec.SCEVs&#91;i&#93;) ||</Highlight></CodeLine>
<Link id="l06857" /><CodeLine lineNumber="6857"><Highlight kind="normal">        SE.<a href="/docs/api/classes/llvm/scalarevolution/#aa8d280cc2c5792b3144274e675e36385">containsUndefs</a>(DVIRec.SCEVs&#91;i&#93;)) &#123;</Highlight></CodeLine>
<Link id="l06858" /><CodeLine lineNumber="6858"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: SCEV for location at index: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; i</Highlight></CodeLine>
<Link id="l06859" /><CodeLine lineNumber="6859"><Highlight kind="normal">                        &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; refers to a location that is now undef or erased. &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06860" /><CodeLine lineNumber="6860"><Highlight kind="normal">                           </Highlight><Highlight kind="stringliteral">&quot;Salvage abandoned.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06861" /><CodeLine lineNumber="6861"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06862" /><CodeLine lineNumber="6862"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06863" /><CodeLine lineNumber="6863"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06864" /><CodeLine lineNumber="6864"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: salvaging location at index &quot;</Highlight><Highlight kind="normal"> &lt;&lt; i</Highlight></CodeLine>
<Link id="l06865" /><CodeLine lineNumber="6865"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot; with SCEV: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;DVIRec.SCEVs&#91;i&#93; &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06866" /><CodeLine lineNumber="6866"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06867" /><CodeLine lineNumber="6867"><Highlight kind="normal">    DVIRec.RecoveryExprs&#91;i&#93; = std::make&#95;unique&lt;SCEVDbgValueBuilder&gt;();</Highlight></CodeLine>
<Link id="l06868" /><CodeLine lineNumber="6868"><Highlight kind="normal">    SCEVDbgValueBuilder &#42;SalvageExpr = DVIRec.RecoveryExprs&#91;i&#93;.get();</Highlight></CodeLine>
<Link id="l06869" /><CodeLine lineNumber="6869"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06870" /><CodeLine lineNumber="6870"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Create an offset-based salvage expression if possible, as it requires</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06871" /><CodeLine lineNumber="6871"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// less DWARF ops than an iteration count-based expression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06872" /><CodeLine lineNumber="6872"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (std::optional&lt;APInt&gt; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> =</Highlight></CodeLine>
<Link id="l06873" /><CodeLine lineNumber="6873"><Highlight kind="normal">            SE.<a href="/docs/api/classes/llvm/scalarevolution/#ae0ca564918ec63a9b4d2229374fec747">computeConstantDifference</a>(DVIRec.SCEVs&#91;i&#93;, SCEVInductionVar)) &#123;</Highlight></CodeLine>
<Link id="l06874" /><CodeLine lineNumber="6874"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>-&gt;getSignificantBits() &lt;= 64)</Highlight></CodeLine>
<Link id="l06875" /><CodeLine lineNumber="6875"><Highlight kind="normal">        SalvageExpr-&gt;createOffsetExpr(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>-&gt;getSExtValue(), LSRInductionVar);</Highlight></CodeLine>
<Link id="l06876" /><CodeLine lineNumber="6876"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06877" /><CodeLine lineNumber="6877"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06878" /><CodeLine lineNumber="6878"><Highlight kind="normal">    &#125; </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SalvageExpr-&gt;createIterCountExpr(DVIRec.SCEVs&#91;i&#93;, IterCountExpr,</Highlight></CodeLine>
<Link id="l06879" /><CodeLine lineNumber="6879"><Highlight kind="normal">                                                 SE))</Highlight></CodeLine>
<Link id="l06880" /><CodeLine lineNumber="6880"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06881" /><CodeLine lineNumber="6881"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06882" /><CodeLine lineNumber="6882"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06883" /><CodeLine lineNumber="6883"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Merge the DbgValueBuilder generated expressions and the original</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06884" /><CodeLine lineNumber="6884"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// DIExpression, place the result into an new vector.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06885" /><CodeLine lineNumber="6885"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;uint64&#95;t, 3&gt;</a> <a href="/docs/api/classes/newexpr">NewExpr</a>;</Highlight></CodeLine>
<Link id="l06886" /><CodeLine lineNumber="6886"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DVIRec.Expr-&gt;getNumElements() == 0) &#123;</Highlight></CodeLine>
<Link id="l06887" /><CodeLine lineNumber="6887"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVIRec.RecoveryExprs.size() == 1 &amp;&amp;</Highlight></CodeLine>
<Link id="l06888" /><CodeLine lineNumber="6888"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Expected only a single recovery expression for an empty &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06889" /><CodeLine lineNumber="6889"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;DIExpression.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06890" /><CodeLine lineNumber="6890"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVIRec.RecoveryExprs&#91;0&#93; &amp;&amp;</Highlight></CodeLine>
<Link id="l06891" /><CodeLine lineNumber="6891"><Highlight kind="normal">           </Highlight><Highlight kind="stringliteral">&quot;Expected a SCEVDbgSalvageBuilder for location 0&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06892" /><CodeLine lineNumber="6892"><Highlight kind="normal">    SCEVDbgValueBuilder &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a> = DVIRec.RecoveryExprs&#91;0&#93;.get();</Highlight></CodeLine>
<Link id="l06893" /><CodeLine lineNumber="6893"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;appendToVectors(<a href="/docs/api/classes/newexpr">NewExpr</a>, NewLocationOps);</Highlight></CodeLine>
<Link id="l06894" /><CodeLine lineNumber="6894"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06895" /><CodeLine lineNumber="6895"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : DVIRec.Expr-&gt;expr&#95;ops()) &#123;</Highlight></CodeLine>
<Link id="l06896" /><CodeLine lineNumber="6896"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Most Ops needn&#39;t be updated.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06897" /><CodeLine lineNumber="6897"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getOp() != <a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>) &#123;</Highlight></CodeLine>
<Link id="l06898" /><CodeLine lineNumber="6898"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.appendToVector(<a href="/docs/api/classes/newexpr">NewExpr</a>);</Highlight></CodeLine>
<Link id="l06899" /><CodeLine lineNumber="6899"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06900" /><CodeLine lineNumber="6900"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06901" /><CodeLine lineNumber="6901"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06902" /><CodeLine lineNumber="6902"><Highlight kind="normal">    uint64&#95;t LocationArgIndex = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getArg(0);</Highlight></CodeLine>
<Link id="l06903" /><CodeLine lineNumber="6903"><Highlight kind="normal">    SCEVDbgValueBuilder &#42;DbgBuilder =</Highlight></CodeLine>
<Link id="l06904" /><CodeLine lineNumber="6904"><Highlight kind="normal">        DVIRec.RecoveryExprs&#91;LocationArgIndex&#93;.get();</Highlight></CodeLine>
<Link id="l06905" /><CodeLine lineNumber="6905"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The location doesn&#39;t have s SCEVDbgValueBuilder, so LSR did not</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06906" /><CodeLine lineNumber="6906"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// optimise it away. So just translate the argument to the updated</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06907" /><CodeLine lineNumber="6907"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// location index.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06908" /><CodeLine lineNumber="6908"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DbgBuilder) &#123;</Highlight></CodeLine>
<Link id="l06909" /><CodeLine lineNumber="6909"><Highlight kind="normal">      <a href="/docs/api/classes/newexpr">NewExpr</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>);</Highlight></CodeLine>
<Link id="l06910" /><CodeLine lineNumber="6910"><Highlight kind="normal">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LocationOpIndexMap&#91;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getArg(0)&#93; != -1 &amp;&amp;</Highlight></CodeLine>
<Link id="l06911" /><CodeLine lineNumber="6911"><Highlight kind="normal">             </Highlight><Highlight kind="stringliteral">&quot;Expected a positive index for the location-op position.&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06912" /><CodeLine lineNumber="6912"><Highlight kind="normal">      <a href="/docs/api/classes/newexpr">NewExpr</a>.push&#95;back(LocationOpIndexMap&#91;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getArg(0)&#93;);</Highlight></CodeLine>
<Link id="l06913" /><CodeLine lineNumber="6913"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06914" /><CodeLine lineNumber="6914"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06915" /><CodeLine lineNumber="6915"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The location has a recovery expression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06916" /><CodeLine lineNumber="6916"><Highlight kind="normal">    DbgBuilder-&gt;appendToVectors(<a href="/docs/api/classes/newexpr">NewExpr</a>, NewLocationOps);</Highlight></CodeLine>
<Link id="l06917" /><CodeLine lineNumber="6917"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06918" /><CodeLine lineNumber="6918"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06919" /><CodeLine lineNumber="6919"><Highlight kind="normal">  <a href="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0">UpdateDbgValueInst</a>(DVIRec, NewLocationOps, <a href="/docs/api/classes/newexpr">NewExpr</a>);</Highlight></CodeLine>
<Link id="l06920" /><CodeLine lineNumber="6920"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef))</Highlight></CodeLine>
<Link id="l06921" /><CodeLine lineNumber="6921"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: Updated DVI: &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06922" /><CodeLine lineNumber="6922"><Highlight kind="normal">                      &lt;&lt; &#42;<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef) &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06923" /><CodeLine lineNumber="6923"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06924" /><CodeLine lineNumber="6924"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: Updated DVI: &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06925" /><CodeLine lineNumber="6925"><Highlight kind="normal">                      &lt;&lt; &#42;<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgVariableRecord &#42;&gt;</a>(DVIRec.DbgRef) &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06926" /><CodeLine lineNumber="6926"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06927" /><CodeLine lineNumber="6927"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06928" /><CodeLine lineNumber="6928"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06929" /><CodeLine lineNumber="6929"><Highlight kind="comment">/// Obtain an expression for the iteration count, then attempt to salvage the</Highlight></CodeLine>
<Link id="l06930" /><CodeLine lineNumber="6930"><Highlight kind="comment">/// dbg.value intrinsics.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06931" /><CodeLine lineNumber="6931" lineLink="#a9188ba3c048bf8057af2b2ac144b9f0f"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a9188ba3c048bf8057af2b2ac144b9f0f">DbgRewriteSalvageableDVIs</a>(</Highlight></CodeLine>
<Link id="l06932" /><CodeLine lineNumber="6932"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/loop">llvm::Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;LSRInductionVar,</Highlight></CodeLine>
<Link id="l06933" /><CodeLine lineNumber="6933"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt;std::unique&#95;ptr&lt;DVIRecoveryRec&gt;, 2&gt; &amp;DVIToUpdate) &#123;</Highlight></CodeLine>
<Link id="l06934" /><CodeLine lineNumber="6934"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DVIToUpdate.empty())</Highlight></CodeLine>
<Link id="l06935" /><CodeLine lineNumber="6935"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06936" /><CodeLine lineNumber="6936"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06937" /><CodeLine lineNumber="6937"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">llvm::SCEV</a> &#42;SCEVInductionVar = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(LSRInductionVar);</Highlight></CodeLine>
<Link id="l06938" /><CodeLine lineNumber="6938"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SCEVInductionVar &amp;&amp;</Highlight></CodeLine>
<Link id="l06939" /><CodeLine lineNumber="6939"><Highlight kind="normal">         </Highlight><Highlight kind="stringliteral">&quot;Anticipated a SCEV for the post-LSR induction variable&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06940" /><CodeLine lineNumber="6940"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06941" /><CodeLine lineNumber="6941"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;IVAddRec =</Highlight></CodeLine>
<Link id="l06942" /><CodeLine lineNumber="6942"><Highlight kind="normal">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(SCEVInductionVar)) &#123;</Highlight></CodeLine>
<Link id="l06943" /><CodeLine lineNumber="6943"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IVAddRec-&gt;isAffine())</Highlight></CodeLine>
<Link id="l06944" /><CodeLine lineNumber="6944"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06945" /><CodeLine lineNumber="6945"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06946" /><CodeLine lineNumber="6946"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// Prevent translation using excessive resources.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06947" /><CodeLine lineNumber="6947"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IVAddRec-&gt;getExpressionSize() &gt; <a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">MaxSCEVSalvageExpressionSize</a>)</Highlight></CodeLine>
<Link id="l06948" /><CodeLine lineNumber="6948"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06949" /><CodeLine lineNumber="6949"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06950" /><CodeLine lineNumber="6950"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// The iteration count is required to recover location values.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06951" /><CodeLine lineNumber="6951"><Highlight kind="normal">    SCEVDbgValueBuilder IterCountExpr;</Highlight></CodeLine>
<Link id="l06952" /><CodeLine lineNumber="6952"><Highlight kind="normal">    IterCountExpr.pushLocation(LSRInductionVar);</Highlight></CodeLine>
<Link id="l06953" /><CodeLine lineNumber="6953"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!IterCountExpr.SCEVToIterCountExpr(&#42;IVAddRec, SE))</Highlight></CodeLine>
<Link id="l06954" /><CodeLine lineNumber="6954"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06955" /><CodeLine lineNumber="6955"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06956" /><CodeLine lineNumber="6956"><Highlight kind="normal">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: IV SCEV: &quot;</Highlight><Highlight kind="normal"> &lt;&lt; &#42;SCEVInductionVar</Highlight></CodeLine>
<Link id="l06957" /><CodeLine lineNumber="6957"><Highlight kind="normal">                      &lt;&lt; </Highlight><Highlight kind="charliteral">&#39;\\n&#39;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l06958" /><CodeLine lineNumber="6958"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06959" /><CodeLine lineNumber="6959"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;DVIRec : DVIToUpdate) &#123;</Highlight></CodeLine>
<Link id="l06960" /><CodeLine lineNumber="6960"><Highlight kind="normal">      <a href="#a02cf9d6ac96ae27b406798da5c2eb7ea">SalvageDVI</a>(L, SE, LSRInductionVar, &#42;DVIRec, SCEVInductionVar,</Highlight></CodeLine>
<Link id="l06961" /><CodeLine lineNumber="6961"><Highlight kind="normal">                 IterCountExpr);</Highlight></CodeLine>
<Link id="l06962" /><CodeLine lineNumber="6962"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l06963" /><CodeLine lineNumber="6963"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l06964" /><CodeLine lineNumber="6964"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l06965" /><CodeLine lineNumber="6965"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l06966" /><CodeLine lineNumber="6966"><Highlight kind="comment">/// Identify and cache salvageable DVI locations and expressions along with the</Highlight></CodeLine>
<Link id="l06967" /><CodeLine lineNumber="6967"><Highlight kind="comment">/// corresponding SCEV(s). Also ensure that the DVI is not deleted between</Highlight></CodeLine>
<Link id="l06968" /><CodeLine lineNumber="6968"><Highlight kind="comment">/// cacheing and salvaging.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06969" /><CodeLine lineNumber="6969" lineLink="#a9766c807d5c90cf726463e300d0787d8"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">void</Highlight><Highlight kind="normal"> <a href="#a9766c807d5c90cf726463e300d0787d8">DbgGatherSalvagableDVI</a>(</Highlight></CodeLine>
<Link id="l06970" /><CodeLine lineNumber="6970"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</Highlight></CodeLine>
<Link id="l06971" /><CodeLine lineNumber="6971"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt;std::unique&#95;ptr&lt;DVIRecoveryRec&gt;, 2&gt; &amp;SalvageableDVISCEVs,</Highlight></CodeLine>
<Link id="l06972" /><CodeLine lineNumber="6972"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallset">SmallSet</a>&lt;<a href="/docs/api/classes/llvm/assertingvh">AssertingVH&lt;DbgValueInst&gt;</a>, 2&gt; &amp;DVIHandles) &#123;</Highlight></CodeLine>
<Link id="l06973" /><CodeLine lineNumber="6973"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a> : L-&gt;getBlocks()) &#123;</Highlight></CodeLine>
<Link id="l06974" /><CodeLine lineNumber="6974"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>) &#123;</Highlight></CodeLine>
<Link id="l06975" /><CodeLine lineNumber="6975"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> ProcessDbgValue = &#91;&amp;&#93;(</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;DbgVal) -&gt; </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06976" /><CodeLine lineNumber="6976"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Ensure that if any location op is undef that the dbg.vlue is not</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06977" /><CodeLine lineNumber="6977"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// cached.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06978" /><CodeLine lineNumber="6978"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DbgVal-&gt;isKillLocation())</Highlight></CodeLine>
<Link id="l06979" /><CodeLine lineNumber="6979"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06980" /><CodeLine lineNumber="6980"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06981" /><CodeLine lineNumber="6981"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Check that the location op SCEVs are suitable for translation to</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06982" /><CodeLine lineNumber="6982"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// DIExpression.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06983" /><CodeLine lineNumber="6983"><Highlight kind="normal">        </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;HasTranslatableLocationOps =</Highlight></CodeLine>
<Link id="l06984" /><CodeLine lineNumber="6984"><Highlight kind="normal">            &#91;&amp;&#93;(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;DbgValToTranslate) -&gt; </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l06985" /><CodeLine lineNumber="6985"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> LocOp : DbgValToTranslate-&gt;location&#95;ops()) &#123;</Highlight></CodeLine>
<Link id="l06986" /><CodeLine lineNumber="6986"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!LocOp)</Highlight></CodeLine>
<Link id="l06987" /><CodeLine lineNumber="6987"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06988" /><CodeLine lineNumber="6988"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06989" /><CodeLine lineNumber="6989"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(LocOp-&gt;getType()))</Highlight></CodeLine>
<Link id="l06990" /><CodeLine lineNumber="6990"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06991" /><CodeLine lineNumber="6991"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06992" /><CodeLine lineNumber="6992"><Highlight kind="normal">            </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(LocOp);</Highlight></CodeLine>
<Link id="l06993" /><CodeLine lineNumber="6993"><Highlight kind="normal">            </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SE.<a href="/docs/api/classes/llvm/scalarevolution/#aa8d280cc2c5792b3144274e675e36385">containsUndefs</a>(S))</Highlight></CodeLine>
<Link id="l06994" /><CodeLine lineNumber="6994"><Highlight kind="normal">              </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06995" /><CodeLine lineNumber="6995"><Highlight kind="normal">          &#125;</Highlight></CodeLine>
<Link id="l06996" /><CodeLine lineNumber="6996"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l06997" /><CodeLine lineNumber="6997"><Highlight kind="normal">        &#125;;</Highlight></CodeLine>
<Link id="l06998" /><CodeLine lineNumber="6998"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l06999" /><CodeLine lineNumber="6999"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!HasTranslatableLocationOps(DbgVal))</Highlight></CodeLine>
<Link id="l07000" /><CodeLine lineNumber="7000"><Highlight kind="normal">          </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07001" /><CodeLine lineNumber="7001"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07002" /><CodeLine lineNumber="7002"><Highlight kind="normal">        std::unique&#95;ptr&lt;DVIRecoveryRec&gt; NewRec =</Highlight></CodeLine>
<Link id="l07003" /><CodeLine lineNumber="7003"><Highlight kind="normal">            std::make&#95;unique&lt;DVIRecoveryRec&gt;(DbgVal);</Highlight></CodeLine>
<Link id="l07004" /><CodeLine lineNumber="7004"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// Each location Op may need a SCEVDbgValueBuilder in order to recover</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07005" /><CodeLine lineNumber="7005"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// it. Pre-allocating a vector will enable quick lookups of the builder</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07006" /><CodeLine lineNumber="7006"><Highlight kind="normal">        </Highlight><Highlight kind="comment">// later during the salvage.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07007" /><CodeLine lineNumber="7007"><Highlight kind="normal">        NewRec-&gt;RecoveryExprs.resize(DbgVal-&gt;getNumVariableLocationOps());</Highlight></CodeLine>
<Link id="l07008" /><CodeLine lineNumber="7008"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> LocOp : DbgVal-&gt;location&#95;ops()) &#123;</Highlight></CodeLine>
<Link id="l07009" /><CodeLine lineNumber="7009"><Highlight kind="normal">          NewRec-&gt;SCEVs.push&#95;back(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(LocOp));</Highlight></CodeLine>
<Link id="l07010" /><CodeLine lineNumber="7010"><Highlight kind="normal">          NewRec-&gt;LocationOps.push&#95;back(LocOp);</Highlight></CodeLine>
<Link id="l07011" /><CodeLine lineNumber="7011"><Highlight kind="normal">          NewRec-&gt;HadLocationArgList = DbgVal-&gt;hasArgList();</Highlight></CodeLine>
<Link id="l07012" /><CodeLine lineNumber="7012"><Highlight kind="normal">        &#125;</Highlight></CodeLine>
<Link id="l07013" /><CodeLine lineNumber="7013"><Highlight kind="normal">        SalvageableDVISCEVs.push&#95;back(std::move(NewRec));</Highlight></CodeLine>
<Link id="l07014" /><CodeLine lineNumber="7014"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07015" /><CodeLine lineNumber="7015"><Highlight kind="normal">      &#125;;</Highlight></CodeLine>
<Link id="l07016" /><CodeLine lineNumber="7016"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/dbgvariablerecord">DbgVariableRecord</a> &amp;DVR : <a href="/docs/api/namespaces/llvm/#ae876eb96b89c1afcc3e9cd285cc3f08c">filterDbgVars</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDbgRecordRange())) &#123;</Highlight></CodeLine>
<Link id="l07017" /><CodeLine lineNumber="7017"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (DVR.isDbgValue() || DVR.isDbgAssign())</Highlight></CodeLine>
<Link id="l07018" /><CodeLine lineNumber="7018"><Highlight kind="normal">          ProcessDbgValue(&amp;DVR);</Highlight></CodeLine>
<Link id="l07019" /><CodeLine lineNumber="7019"><Highlight kind="normal">      &#125;</Highlight></CodeLine>
<Link id="l07020" /><CodeLine lineNumber="7020"><Highlight kind="normal">      </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> DVI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;DbgValueInst&gt;</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</Highlight></CodeLine>
<Link id="l07021" /><CodeLine lineNumber="7021"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!DVI)</Highlight></CodeLine>
<Link id="l07022" /><CodeLine lineNumber="7022"><Highlight kind="normal">        </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07023" /><CodeLine lineNumber="7023"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (ProcessDbgValue(DVI))</Highlight></CodeLine>
<Link id="l07024" /><CodeLine lineNumber="7024"><Highlight kind="normal">        DVIHandles.insert(DVI);</Highlight></CodeLine>
<Link id="l07025" /><CodeLine lineNumber="7025"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07026" /><CodeLine lineNumber="7026"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07027" /><CodeLine lineNumber="7027"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07028" /><CodeLine lineNumber="7028"><Highlight kind="normal"></Highlight><Highlight kind="comment"></Highlight></CodeLine>
<Link id="l07029" /><CodeLine lineNumber="7029"><Highlight kind="comment">/// Ideally pick the PHI IV inserted by ScalarEvolutionExpander. As a fallback</Highlight></CodeLine>
<Link id="l07030" /><CodeLine lineNumber="7030"><Highlight kind="comment">/// any PHi from the loop header is usable, but may have less chance of</Highlight></CodeLine>
<Link id="l07031" /><CodeLine lineNumber="7031"><Highlight kind="comment">/// surviving subsequent transforms.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07032" /><CodeLine lineNumber="7032" lineLink="#a6612c20f7ca23077265026ea4991e2b6"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;<a href="#a6612c20f7ca23077265026ea4991e2b6">GetInductionVariable</a>(</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</Highlight></CodeLine>
<Link id="l07033" /><CodeLine lineNumber="7033"><Highlight kind="normal">                                           </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRInstance &amp;LSR) &#123;</Highlight></CodeLine>
<Link id="l07034" /><CodeLine lineNumber="7034"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07035" /><CodeLine lineNumber="7035"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> IsSuitableIV = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>) &#123;</Highlight></CodeLine>
<Link id="l07036" /><CodeLine lineNumber="7036"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>-&gt;getType()))</Highlight></CodeLine>
<Link id="l07037" /><CodeLine lineNumber="7037"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07038" /><CodeLine lineNumber="7038"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;Rec = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>)))</Highlight></CodeLine>
<Link id="l07039" /><CodeLine lineNumber="7039"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> Rec-&gt;isAffine() &amp;&amp; !SE.<a href="/docs/api/classes/llvm/scalarevolution/#aa8d280cc2c5792b3144274e675e36385">containsUndefs</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>));</Highlight></CodeLine>
<Link id="l07040" /><CodeLine lineNumber="7040"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07041" /><CodeLine lineNumber="7041"><Highlight kind="normal">  &#125;;</Highlight></CodeLine>
<Link id="l07042" /><CodeLine lineNumber="7042"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07043" /><CodeLine lineNumber="7043"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// For now, just pick the first IV that was generated and inserted by</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07044" /><CodeLine lineNumber="7044"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// ScalarEvolution. Ideally pick an IV that is unlikely to be optimised away</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07045" /><CodeLine lineNumber="7045"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// by subsequent transforms.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07046" /><CodeLine lineNumber="7046"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/weakvh">WeakVH</a> &amp;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> : LSR.getScalarEvolutionIVs()) &#123;</Highlight></CodeLine>
<Link id="l07047" /><CodeLine lineNumber="7047"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>)</Highlight></CodeLine>
<Link id="l07048" /><CodeLine lineNumber="7048"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">continue</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07049" /><CodeLine lineNumber="7049"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07050" /><CodeLine lineNumber="7050"><Highlight kind="normal">    </Highlight><Highlight kind="comment">// There should only be PHI node IVs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07051" /><CodeLine lineNumber="7051"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(&amp;&#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>);</Highlight></CodeLine>
<Link id="l07052" /><CodeLine lineNumber="7052"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07053" /><CodeLine lineNumber="7053"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsSuitableIV(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>))</Highlight></CodeLine>
<Link id="l07054" /><CodeLine lineNumber="7054"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</Highlight></CodeLine>
<Link id="l07055" /><CodeLine lineNumber="7055"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07056" /><CodeLine lineNumber="7056"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07057" /><CodeLine lineNumber="7057"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : L.getHeader()-&gt;phis()) &#123;</Highlight></CodeLine>
<Link id="l07058" /><CodeLine lineNumber="7058"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (IsSuitableIV(&amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>))</Highlight></CodeLine>
<Link id="l07059" /><CodeLine lineNumber="7059"><Highlight kind="normal">      </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</Highlight></CodeLine>
<Link id="l07060" /><CodeLine lineNumber="7060"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07061" /><CodeLine lineNumber="7061"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07062" /><CodeLine lineNumber="7062"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07063" /><CodeLine lineNumber="7063"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07064" /><CodeLine lineNumber="7064" lineLink="#ac33f356faceb9655cb64611d2971d24f"><Highlight kind="normal"></Highlight><Highlight kind="keyword">static</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="#ac33f356faceb9655cb64611d2971d24f">ReduceLoopStrength</a>(<a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp;IU, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</Highlight></CodeLine>
<Link id="l07065" /><CodeLine lineNumber="7065"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;DT, <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI,</Highlight></CodeLine>
<Link id="l07066" /><CodeLine lineNumber="7066"><Highlight kind="normal">                               </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</Highlight></CodeLine>
<Link id="l07067" /><CodeLine lineNumber="7067"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;AC, <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp;TLI,</Highlight></CodeLine>
<Link id="l07068" /><CodeLine lineNumber="7068"><Highlight kind="normal">                               <a href="/docs/api/classes/llvm/memoryssa">MemorySSA</a> &#42;MSSA) &#123;</Highlight></CodeLine>
<Link id="l07069" /><CodeLine lineNumber="7069"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07070" /><CodeLine lineNumber="7070"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Debug preservation - before we start removing anything identify which DVI</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07071" /><CodeLine lineNumber="7071"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// meet the salvageable criteria and store their DIExpression and SCEVs.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07072" /><CodeLine lineNumber="7072"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::unique&#95;ptr&lt;DVIRecoveryRec&gt;</a>, 2&gt; SalvageableDVIRecords;</Highlight></CodeLine>
<Link id="l07073" /><CodeLine lineNumber="7073"><Highlight kind="normal">  <a href="/docs/api/classes/llvm/smallset">SmallSet&lt;AssertingVH&lt;DbgValueInst&gt;</a>, 2&gt; DVIHandles;</Highlight></CodeLine>
<Link id="l07074" /><CodeLine lineNumber="7074"><Highlight kind="normal">  <a href="#a9766c807d5c90cf726463e300d0787d8">DbgGatherSalvagableDVI</a>(L, SE, SalvageableDVIRecords, DVIHandles);</Highlight></CodeLine>
<Link id="l07075" /><CodeLine lineNumber="7075"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07076" /><CodeLine lineNumber="7076"><Highlight kind="normal">  </Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07077" /><CodeLine lineNumber="7077"><Highlight kind="normal">  std::unique&#95;ptr&lt;MemorySSAUpdater&gt; MSSAU;</Highlight></CodeLine>
<Link id="l07078" /><CodeLine lineNumber="7078"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (MSSA)</Highlight></CodeLine>
<Link id="l07079" /><CodeLine lineNumber="7079"><Highlight kind="normal">    MSSAU = std::make&#95;unique&lt;MemorySSAUpdater&gt;(MSSA);</Highlight></CodeLine>
<Link id="l07080" /><CodeLine lineNumber="7080"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07081" /><CodeLine lineNumber="7081"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Run the main LSR transformation.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07082" /><CodeLine lineNumber="7082"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> LSRInstance &amp;Reducer =</Highlight></CodeLine>
<Link id="l07083" /><CodeLine lineNumber="7083"><Highlight kind="normal">      LSRInstance(L, IU, SE, DT, LI, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AC, TLI, MSSAU.get());</Highlight></CodeLine>
<Link id="l07084" /><CodeLine lineNumber="7084"><Highlight kind="normal">  <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> |= Reducer.getChanged();</Highlight></CodeLine>
<Link id="l07085" /><CodeLine lineNumber="7085"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07086" /><CodeLine lineNumber="7086"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Remove any extra phis created by processing inner loops.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07087" /><CodeLine lineNumber="7087"><Highlight kind="normal">  <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> |= <a href="/docs/api/namespaces/llvm/#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(L-&gt;getHeader(), &amp;TLI, MSSAU.get());</Highlight></CodeLine>
<Link id="l07088" /><CodeLine lineNumber="7088"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="#a94a7203d75d594f7012f80d9130dcadf">EnablePhiElim</a> &amp;&amp; L-&gt;isLoopSimplifyForm()) &#123;</Highlight></CodeLine>
<Link id="l07089" /><CodeLine lineNumber="7089"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WeakTrackingVH, 16&gt;</a> DeadInsts;</Highlight></CodeLine>
<Link id="l07090" /><CodeLine lineNumber="7090"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/datalayout">DataLayout</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = L-&gt;getHeader()-&gt;getDataLayout();</Highlight></CodeLine>
<Link id="l07091" /><CodeLine lineNumber="7091"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/scevexpander">SCEVExpander</a> <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(SE, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, </Highlight><Highlight kind="stringliteral">&quot;lsr&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07092" /><CodeLine lineNumber="7092"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#if LLVM&#95;ENABLE&#95;ABI&#95;BREAKING&#95;CHECKS</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07093" /><CodeLine lineNumber="7093"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setDebugType(<a href="/docs/api/files/include/include/llvm/include/llvm/adt/genericcycleimpl-h/#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>);</Highlight></CodeLine>
<Link id="l07094" /><CodeLine lineNumber="7094"><Highlight kind="normal"></Highlight><Highlight kind="preprocessor">#endif</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07095" /><CodeLine lineNumber="7095"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">unsigned</Highlight><Highlight kind="normal"> numFolded = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.replaceCongruentIVs(L, &amp;DT, DeadInsts, &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>);</Highlight></CodeLine>
<Link id="l07096" /><CodeLine lineNumber="7096"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clear();</Highlight></CodeLine>
<Link id="l07097" /><CodeLine lineNumber="7097"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (numFolded) &#123;</Highlight></CodeLine>
<Link id="l07098" /><CodeLine lineNumber="7098"><Highlight kind="normal">      <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07099" /><CodeLine lineNumber="7099"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#abca8e2c525d8162fbcbb5b444cf04d21">RecursivelyDeleteTriviallyDeadInstructionsPermissive</a>(DeadInsts, &amp;TLI,</Highlight></CodeLine>
<Link id="l07100" /><CodeLine lineNumber="7100"><Highlight kind="normal">                                                           MSSAU.get());</Highlight></CodeLine>
<Link id="l07101" /><CodeLine lineNumber="7101"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(L-&gt;getHeader(), &amp;TLI, MSSAU.get());</Highlight></CodeLine>
<Link id="l07102" /><CodeLine lineNumber="7102"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07103" /><CodeLine lineNumber="7103"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07104" /><CodeLine lineNumber="7104"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// LSR may at times remove all uses of an induction variable from a loop.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07105" /><CodeLine lineNumber="7105"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// The only remaining use is the PHI in the exit block.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07106" /><CodeLine lineNumber="7106"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// When this is the case, if the exit value of the IV can be calculated using</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07107" /><CodeLine lineNumber="7107"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// SCEV, we can replace the exit block PHI with the final value of the IV and</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07108" /><CodeLine lineNumber="7108"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// skip the updates in each loop iteration.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07109" /><CodeLine lineNumber="7109"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (L-&gt;isRecursivelyLCSSAForm(DT, LI) &amp;&amp; L-&gt;getExitBlock()) &#123;</Highlight></CodeLine>
<Link id="l07110" /><CodeLine lineNumber="7110"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WeakTrackingVH, 16&gt;</a> DeadInsts;</Highlight></CodeLine>
<Link id="l07111" /><CodeLine lineNumber="7111"><Highlight kind="normal">    </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/datalayout">DataLayout</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = L-&gt;getHeader()-&gt;getDataLayout();</Highlight></CodeLine>
<Link id="l07112" /><CodeLine lineNumber="7112"><Highlight kind="normal">    <a href="/docs/api/classes/llvm/scevexpander">SCEVExpander</a> <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(SE, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, </Highlight><Highlight kind="stringliteral">&quot;lsr&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07113" /><CodeLine lineNumber="7113"><Highlight kind="normal">    </Highlight><Highlight kind="keywordtype">int</Highlight><Highlight kind="normal"> Rewrites = <a href="/docs/api/namespaces/llvm/#acb5b48f89efd60ea799bb09abc1971ba">rewriteLoopExitValues</a>(L, &amp;LI, &amp;TLI, &amp;SE, &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>, &amp;DT,</Highlight></CodeLine>
<Link id="l07114" /><CodeLine lineNumber="7114"><Highlight kind="normal">                                         <a href="/docs/api/namespaces/llvm/#ad711012ae6f56de75424c48f31538986a0cba5d71f8085f5b0bd4c61555d86bb6">UnusedIndVarInLoop</a>, DeadInsts);</Highlight></CodeLine>
<Link id="l07115" /><CodeLine lineNumber="7115"><Highlight kind="normal">    <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clear();</Highlight></CodeLine>
<Link id="l07116" /><CodeLine lineNumber="7116"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (Rewrites) &#123;</Highlight></CodeLine>
<Link id="l07117" /><CodeLine lineNumber="7117"><Highlight kind="normal">      <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </Highlight><Highlight kind="keyword">true</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07118" /><CodeLine lineNumber="7118"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#abca8e2c525d8162fbcbb5b444cf04d21">RecursivelyDeleteTriviallyDeadInstructionsPermissive</a>(DeadInsts, &amp;TLI,</Highlight></CodeLine>
<Link id="l07119" /><CodeLine lineNumber="7119"><Highlight kind="normal">                                                           MSSAU.get());</Highlight></CodeLine>
<Link id="l07120" /><CodeLine lineNumber="7120"><Highlight kind="normal">      <a href="/docs/api/namespaces/llvm/#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(L-&gt;getHeader(), &amp;TLI, MSSAU.get());</Highlight></CodeLine>
<Link id="l07121" /><CodeLine lineNumber="7121"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07122" /><CodeLine lineNumber="7122"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07123" /><CodeLine lineNumber="7123"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07124" /><CodeLine lineNumber="7124"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (SalvageableDVIRecords.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</Highlight></CodeLine>
<Link id="l07125" /><CodeLine lineNumber="7125"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</Highlight></CodeLine>
<Link id="l07126" /><CodeLine lineNumber="7126"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07127" /><CodeLine lineNumber="7127"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// Obtain relevant IVs and attempt to rewrite the salvageable DVIs with</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07128" /><CodeLine lineNumber="7128"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// expressions composed using the derived iteration count.</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07129" /><CodeLine lineNumber="7129"><Highlight kind="normal">  </Highlight><Highlight kind="comment">// TODO: Allow for multiple IV references for nested AddRecSCEVs</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07130" /><CodeLine lineNumber="7130"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;L : LI) &#123;</Highlight></CodeLine>
<Link id="l07131" /><CodeLine lineNumber="7131"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> = <a href="#a6612c20f7ca23077265026ea4991e2b6">GetInductionVariable</a>(&#42;L, SE, Reducer))</Highlight></CodeLine>
<Link id="l07132" /><CodeLine lineNumber="7132"><Highlight kind="normal">      <a href="#a9188ba3c048bf8057af2b2ac144b9f0f">DbgRewriteSalvageableDVIs</a>(L, SE, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>, SalvageableDVIRecords);</Highlight></CodeLine>
<Link id="l07133" /><CodeLine lineNumber="7133"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">else</Highlight><Highlight kind="normal"> &#123;</Highlight></CodeLine>
<Link id="l07134" /><CodeLine lineNumber="7134"><Highlight kind="normal">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </Highlight><Highlight kind="stringliteral">&quot;scev-salvage: SCEV salvaging not possible. An IV &quot;</Highlight><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07135" /><CodeLine lineNumber="7135"><Highlight kind="normal">                           </Highlight><Highlight kind="stringliteral">&quot;could not be identified.\\n&quot;</Highlight><Highlight kind="normal">);</Highlight></CodeLine>
<Link id="l07136" /><CodeLine lineNumber="7136"><Highlight kind="normal">    &#125;</Highlight></CodeLine>
<Link id="l07137" /><CodeLine lineNumber="7137"><Highlight kind="normal">  &#125;</Highlight></CodeLine>
<Link id="l07138" /><CodeLine lineNumber="7138"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07139" /><CodeLine lineNumber="7139"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">for</Highlight><Highlight kind="normal"> (</Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;Rec : SalvageableDVIRecords)</Highlight></CodeLine>
<Link id="l07140" /><CodeLine lineNumber="7140"><Highlight kind="normal">    Rec-&gt;clear();</Highlight></CodeLine>
<Link id="l07141" /><CodeLine lineNumber="7141"><Highlight kind="normal">  SalvageableDVIRecords.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</Highlight></CodeLine>
<Link id="l07142" /><CodeLine lineNumber="7142"><Highlight kind="normal">  DVIHandles.<a href="/docs/api/classes/llvm/smallset/#a76b3fc7c102561fb5210d5151531e409">clear</a>();</Highlight></CodeLine>
<Link id="l07143" /><CodeLine lineNumber="7143"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</Highlight></CodeLine>
<Link id="l07144" /><CodeLine lineNumber="7144"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07145" /><CodeLine lineNumber="7145"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07146" /><CodeLine lineNumber="7146"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">bool</Highlight><Highlight kind="normal"> LoopStrengthReduce::runOnLoop(Loop &#42;L, LPPassManager &amp; </Highlight><Highlight kind="comment">/&#42;LPM&#42;/</Highlight><Highlight kind="normal">) &#123;</Highlight></CodeLine>
<Link id="l07147" /><CodeLine lineNumber="7147"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (<a href="/docs/api/classes/llvm/looppass/#ac97db8f0e4f4a0946dddf617f45f6c8b">skipLoop</a>(L))</Highlight></CodeLine>
<Link id="l07148" /><CodeLine lineNumber="7148"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07149" /><CodeLine lineNumber="7149"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07150" /><CodeLine lineNumber="7150"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;IU = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;IVUsersWrapperPass&gt;</a>().getIU();</Highlight></CodeLine>
<Link id="l07151" /><CodeLine lineNumber="7151"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;SE = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;ScalarEvolutionWrapperPass&gt;</a>().getSE();</Highlight></CodeLine>
<Link id="l07152" /><CodeLine lineNumber="7152"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;DT = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;DominatorTreeWrapperPass&gt;</a>().getDomTree();</Highlight></CodeLine>
<Link id="l07153" /><CodeLine lineNumber="7153"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;LI = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;LoopInfoWrapperPass&gt;</a>().getLoopInfo();</Highlight></CodeLine>
<Link id="l07154" /><CodeLine lineNumber="7154"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">const</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a> = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;TargetTransformInfoWrapperPass&gt;</a>().getTTI(</Highlight></CodeLine>
<Link id="l07155" /><CodeLine lineNumber="7155"><Highlight kind="normal">      &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getParent());</Highlight></CodeLine>
<Link id="l07156" /><CodeLine lineNumber="7156"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;AC = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;AssumptionCacheTracker&gt;</a>().getAssumptionCache(</Highlight></CodeLine>
<Link id="l07157" /><CodeLine lineNumber="7157"><Highlight kind="normal">      &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getParent());</Highlight></CodeLine>
<Link id="l07158" /><CodeLine lineNumber="7158"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &amp;TLI = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;TargetLibraryInfoWrapperPass&gt;</a>().getTLI(</Highlight></CodeLine>
<Link id="l07159" /><CodeLine lineNumber="7159"><Highlight kind="normal">      &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getParent());</Highlight></CodeLine>
<Link id="l07160" /><CodeLine lineNumber="7160"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> &#42;MSSAAnalysis = <a href="/docs/api/classes/llvm/pass/#af94c014e968489e96c7d4353a84ad7f5">getAnalysisIfAvailable&lt;MemorySSAWrapperPass&gt;</a>();</Highlight></CodeLine>
<Link id="l07161" /><CodeLine lineNumber="7161"><Highlight kind="normal">  <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/earlycse-cpp/#a8dbb9a70b80f850edc8194bde1b5b305">MemorySSA</a> &#42;MSSA = </Highlight><Highlight kind="keyword">nullptr</Highlight><Highlight kind="normal">;</Highlight></CodeLine>
<Link id="l07162" /><CodeLine lineNumber="7162"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (MSSAAnalysis)</Highlight></CodeLine>
<Link id="l07163" /><CodeLine lineNumber="7163"><Highlight kind="normal">    MSSA = &amp;MSSAAnalysis-&gt;getMSSA();</Highlight></CodeLine>
<Link id="l07164" /><CodeLine lineNumber="7164"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="#ac33f356faceb9655cb64611d2971d24f">ReduceLoopStrength</a>(L, IU, SE, DT, LI, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AC, TLI, MSSA);</Highlight></CodeLine>
<Link id="l07165" /><CodeLine lineNumber="7165"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07166" /><CodeLine lineNumber="7166"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07167" /><CodeLine lineNumber="7167" lineLink="/docs/api/classes/llvm/loopstrengthreducepass/#a4e475c0fcd6ade09109db20acb073a77"><Highlight kind="normal"><a href="/docs/api/classes/llvm/preservedanalyses">PreservedAnalyses</a> <a href="/docs/api/classes/llvm/loopstrengthreducepass/#a4e475c0fcd6ade09109db20acb073a77">LoopStrengthReducePass::run</a>(<a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L, <a href="/docs/api/namespaces/llvm/#a58dde534a0ea2a23cb6c779c5c283f75">LoopAnalysisManager</a> &amp;AM,</Highlight></CodeLine>
<Link id="l07168" /><CodeLine lineNumber="7168"><Highlight kind="normal">                                              <a href="/docs/api/structs/llvm/loopstandardanalysisresults">LoopStandardAnalysisResults</a> &amp;AR,</Highlight></CodeLine>
<Link id="l07169" /><CodeLine lineNumber="7169"><Highlight kind="normal">                                              <a href="/docs/api/classes/llvm/lpmupdater">LPMUpdater</a> &amp;) &#123;</Highlight></CodeLine>
<Link id="l07170" /><CodeLine lineNumber="7170"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (!<a href="#ac33f356faceb9655cb64611d2971d24f">ReduceLoopStrength</a>(&amp;L, AM.<a href="/docs/api/classes/llvm/analysismanager/#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a href="/docs/api/classes/llvm/ivusersanalysis">IVUsersAnalysis</a>&gt;(L, AR), AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a124376878e24aef4252795ba9fea420f">SE</a>,</Highlight></CodeLine>
<Link id="l07171" /><CodeLine lineNumber="7171"><Highlight kind="normal">                          AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#aaa96df870a1b3d7ffc56bec3eb0b0cff">DT</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#aa09379aa4435be95eb717dd9b5d8b4c5">LI</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a3444a9359f5f17f1694f82c41d5fd574">TTI</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a902b4712394a3b3450893634b3302893">AC</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a9e363c1eaf112166372e2d52704981fb">TLI</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a1cfb392c267da10531478c2f42baa603">MSSA</a>))</Highlight></CodeLine>
<Link id="l07172" /><CodeLine lineNumber="7172"><Highlight kind="normal">    </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/llvm/preservedanalyses/#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</Highlight></CodeLine>
<Link id="l07173" /><CodeLine lineNumber="7173"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07174" /><CodeLine lineNumber="7174"><Highlight kind="normal">  </Highlight><Highlight kind="keyword">auto</Highlight><Highlight kind="normal"> PA = <a href="/docs/api/namespaces/llvm/#ac7294ba4e105807674fe3a394437fcc1">getLoopPassPreservedAnalyses</a>();</Highlight></CodeLine>
<Link id="l07175" /><CodeLine lineNumber="7175"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">if</Highlight><Highlight kind="normal"> (AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a1cfb392c267da10531478c2f42baa603">MSSA</a>)</Highlight></CodeLine>
<Link id="l07176" /><CodeLine lineNumber="7176"><Highlight kind="normal">    PA.preserve&lt;<a href="/docs/api/classes/llvm/memoryssaanalysis">MemorySSAAnalysis</a>&gt;();</Highlight></CodeLine>
<Link id="l07177" /><CodeLine lineNumber="7177"><Highlight kind="normal">  </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> PA;</Highlight></CodeLine>
<Link id="l07178" /><CodeLine lineNumber="7178"><Highlight kind="normal">&#125;</Highlight></CodeLine>
<Link id="l07179" /><CodeLine lineNumber="7179"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07180" /><CodeLine lineNumber="7180"><Highlight kind="normal"></Highlight><Highlight kind="keywordtype">char</Highlight><Highlight kind="normal"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#a70f981eb6b8f2c9553421cc07b98f8e5">LoopStrengthReduce::ID</a> = 0;</Highlight></CodeLine>
<Link id="l07181" /><CodeLine lineNumber="7181"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07182" /><CodeLine lineNumber="7182" lineLink="#a0cf26a507ec1ff72dd6624ac9b69d05c"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/passsupport-h/#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE&#95;PASS&#95;BEGIN</a>(LoopStrengthReduce, </Highlight><Highlight kind="stringliteral">&quot;loop-reduce&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l07183" /><CodeLine lineNumber="7183"><Highlight kind="normal">                      </Highlight><Highlight kind="stringliteral">&quot;Loop Strength Reduction&quot;</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">, </Highlight><Highlight kind="keyword">false</Highlight><Highlight kind="normal">)</Highlight></CodeLine>
<Link id="l07184" /><CodeLine lineNumber="7184"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/targettransforminfowrapperpass">TargetTransformInfoWrapperPass</a>)</Highlight></CodeLine>
<Link id="l07185" /><CodeLine lineNumber="7185"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/dominatortreewrapperpass">DominatorTreeWrapperPass</a>)</Highlight></CodeLine>
<Link id="l07186" /><CodeLine lineNumber="7186"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/scalarevolutionwrapperpass">ScalarEvolutionWrapperPass</a>)</Highlight></CodeLine>
<Link id="l07187" /><CodeLine lineNumber="7187"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/ivuserswrapperpass">IVUsersWrapperPass</a>)</Highlight></CodeLine>
<Link id="l07188" /><CodeLine lineNumber="7188"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/loopinfowrapperpass">LoopInfoWrapperPass</a>)</Highlight></CodeLine>
<Link id="l07189" /><CodeLine lineNumber="7189"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(LoopSimplify)</Highlight></CodeLine>
<Link id="l07190" /><CodeLine lineNumber="7190" lineLink="#a6d827fc34f1b4371a0b7183d3ca5bcac"><Highlight kind="normal"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a74ce8276b89067e806f67c45a6d92575">INITIALIZE&#95;PASS&#95;END</a>(LoopStrengthReduce, </Highlight><Highlight kind="stringliteral">&quot;loop-reduce&quot;</Highlight><Highlight kind="normal">,</Highlight></CodeLine>
<Link id="l07191" /><CodeLine lineNumber="7191" lineLink="#a81103f81d98fb1888c83e3f13d71d043"><Highlight kind="normal">                    </Highlight><Highlight kind="stringliteral">&quot;Loop Strength Reduction&quot;</Highlight><Highlight kind="normal">, <a href="/docs/api/namespaces/false">false</a>, <a href="/docs/api/namespaces/false">false</a>)</Highlight></CodeLine>
<Link id="l07192" /><CodeLine lineNumber="7192"><Highlight kind="normal"></Highlight></CodeLine>
<Link id="l07193" /><CodeLine lineNumber="7193" lineLink="/docs/api/namespaces/llvm/#ab5e38bfb20e37867b8f1c51c75a38a0a"><Highlight kind="normal"><a href="/docs/api/classes/llvm/pass">Pass</a> &#42;<a href="/docs/api/namespaces/llvm">llvm</a>::<a href="/docs/api/namespaces/llvm/#ab5e38bfb20e37867b8f1c51c75a38a0a">createLoopStrengthReducePass</a>() &#123; </Highlight><Highlight kind="keywordflow">return</Highlight><Highlight kind="normal"> </Highlight><Highlight kind="keyword">new</Highlight><Highlight kind="normal"> LoopStrengthReduce(); &#125;</Highlight></CodeLine>

</ProgramListing>


</DoxygenPage>
