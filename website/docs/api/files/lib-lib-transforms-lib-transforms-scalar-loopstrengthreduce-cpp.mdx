---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - file

---

import Link from '@docusaurus/Link'

import CodeLine from '@xpack/docusaurus-plugin-doxygen/components/CodeLine'
import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import IncludesList from '@xpack/docusaurus-plugin-doxygen/components/IncludesList'
import IncludesListItem from '@xpack/docusaurus-plugin-doxygen/components/IncludesListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import ProgramListing from '@xpack/docusaurus-plugin-doxygen/components/ProgramListing'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `LoopStrengthReduce.cpp` File Reference

<DoxygenPage pluginConfig={pluginConfig}>



## Included Headers

<IncludesList>
<IncludesListItem
  filePath="llvm/Transforms/Scalar/LoopStrengthReduce.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/scalar/loopstrengthreduce-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/APInt.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/apint-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/DenseMap.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/densemap-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/DenseSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/denseset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/Hashing.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/hashing-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/PointerIntPair.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/pointerintpair-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/STLExtras.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/stlextras-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SetVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/setvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallBitVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallbitvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallPtrSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallptrset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/Statistic.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/iterator_range.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/iterator-range-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/AssumptionCache.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/assumptioncache-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/DomTreeUpdater.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/domtreeupdater-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/IVUsers.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/ivusers-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/LoopAnalysisManager.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/loopanalysismanager-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/LoopInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/loopinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/LoopPass.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/looppass-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/MemorySSA.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/memoryssa-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/MemorySSAUpdater.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/memoryssaupdater-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ScalarEvolution.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolution-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ScalarEvolutionExpressions.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolutionexpressions-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ScalarEvolutionNormalization.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolutionnormalization-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/TargetLibraryInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/targetlibraryinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/TargetTransformInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/targettransforminfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/ValueTracking.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/valuetracking-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/BinaryFormat/Dwarf.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/binaryformat/dwarf-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Config/llvm-config.h"
  permalink=""
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/BasicBlock.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/basicblock-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Constant.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/constant-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Constants.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/constants-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DebugInfoMetadata.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/debuginfometadata-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DerivedTypes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/derivedtypes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Dominators.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/dominators-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/GlobalValue.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/globalvalue-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/IRBuilder.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/irbuilder-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/InstrTypes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/instrtypes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Instruction.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/instruction-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Instructions.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/instructions-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/IntrinsicInst.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/intrinsicinst-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Module.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/module-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Operator.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/operator-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Type.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/type-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Use.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/use-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/User.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/user-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Value.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/value-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/ValueHandle.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/valuehandle-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/InitializePasses.h"
  permalink="/docs/api/files/include/include/llvm/initializepasses-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Pass.h"
  permalink="/docs/api/files/include/include/llvm/pass-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Casting.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/casting-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/CommandLine.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Compiler.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Debug.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/debug-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/ErrorHandling.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/MathExtras.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/mathextras-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/raw_ostream.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/raw-ostream-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Scalar.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/scalar-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/utils-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/BasicBlockUtils.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/basicblockutils-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/Local.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/local-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/LoopUtils.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/looputils-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/ScalarEvolutionExpander.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/scalarevolutionexpander-h"
  isLocal="true" />
<IncludesListItem
  filePath="algorithm"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cassert"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cstddef"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cstdint"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="iterator"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="limits"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="map"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="numeric"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="optional"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="utility"
  permalink=""
  isLocal="false" />
</IncludesList>

## Namespaces Index

<MembersIndex>

<MembersIndexItem
  type="namespace"
  name={<><a href="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-">anonymous&#123;LoopStrengthReduce.cpp&#125;</a></>}>
</MembersIndexItem>

</MembersIndex>

## Classes Index

<MembersIndex>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a></>}>
This class holds data which is used to order reuse candidates. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate">KeyOrderTargetImmediate</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate">KeyOrderSizeTAndImmediate</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a></>}>
Map register candidates to information about how they are used. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a></>}>
This class holds information that describes a formula for computing satisfying a use. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a></>}>
This class is used to measure and compare candidate formulae. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a></>}>
An operand value in an instruction which is to be replaced with some equivalent, possibly strength-reduced, replacement. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo">UniquifierDenseMapInfo</a></>}>
A <a href="/docs/api/structs/llvm/densemapinfo">DenseMapInfo</a> implementation for holding DenseMaps and DenseSets of sorted SmallVectors of const SCEV&#42;. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a></>}>
This class holds the state that LSR keeps for each use in <a href="/docs/api/classes/llvm/ivusers">IVUsers</a>, as well as uses invented by LSR itself. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a></>}>
An individual increment in a Chain of IV increments. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers">ChainUsers</a></>}>
Helper for CollectChains to track multiple IV increment uses. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance">LSRInstance</a></>}>
This class holds state for the main loop strength reduction logic. <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem">WorkItem</a></>}>
Helper class for GenerateCrossUseConstantOffsets. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce">LoopStrengthReduce</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder">SCEVDbgValueBuilder</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec">DVIRecoveryRec</a></>}>
Holds all the required data to salvage a dbg.value using the pre-LSR SCEVs and <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>. <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#details">More...</a>
</MembersIndexItem>

</MembersIndex>

## Functions Index

<MembersIndex>

<MembersIndexItem
  type="bool"
  name={<><a href="#ad35b9a85ea52062375c0c870be5cd228">canFoldIVIncExpr</a> (const SCEV &#42;IncExpr, Instruction &#42;UserInst, Value &#42;Operand, const TargetTransformInfo &amp;TTI)</>}>
Return true if the <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> can be folded into an addressing mode. <a href="#ad35b9a85ea52062375c0c870be5cd228">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aa12378426474ba414b8bc234a26fd19b">canHoistIVInc</a> (const TargetTransformInfo &amp;TTI, const LSRFixup &amp;Fixup, const LSRUse &amp;LU, Instruction &#42;IVIncInsertPos, Loop &#42;L)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</>}
  name={<><a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a> (const SCEV &#42;S, const SCEVConstant &#42;C, SmallVectorImpl&lt; const SCEV &#42; &gt; &amp;Ops, const Loop &#42;L, ScalarEvolution &amp;SE, unsigned Depth=0)</>}>
Split S into subexpressions which can be pulled out into separate registers. <a href="#ad0531a07d7868c1577980524cf2add3a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a> (const SCEV &#42;S, const Loop &amp;L)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a9766c807d5c90cf726463e300d0787d8">DbgGatherSalvagableDVI</a> (Loop &#42;L, ScalarEvolution &amp;SE, SmallVector&lt; std::unique&#95;ptr&lt; DVIRecoveryRec &gt;, 2 &gt; &amp;SalvageableDVISCEVs, SmallSet&lt; AssertingVH&lt; DbgValueInst &gt;, 2 &gt; &amp;DVIHandles)</>}>
Identify and cache salvageable DVI locations and expressions along with the corresponding SCEV(s). <a href="#a9766c807d5c90cf726463e300d0787d8">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a9188ba3c048bf8057af2b2ac144b9f0f">DbgRewriteSalvageableDVIs</a> (llvm::Loop &#42;L, ScalarEvolution &amp;SE, llvm::PHINode &#42;LSRInductionVar, SmallVector&lt; std::unique&#95;ptr&lt; DVIRecoveryRec &gt;, 2 &gt; &amp;DVIToUpdate)</>}>
Obtain an expression for the iteration count, then attempt to salvage the dbg.value intrinsics. <a href="#a9188ba3c048bf8057af2b2ac144b9f0f">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a> (const SCEV &#42;S, Loop &#42;L, SmallVectorImpl&lt; const SCEV &#42; &gt; &amp;Good, SmallVectorImpl&lt; const SCEV &#42; &gt; &amp;Bad, ScalarEvolution &amp;SE)</>}>
Recursion helper for initialMatch. <a href="#aa59a46776e15b1f1bd597c4e1e769f59">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="Immediate"
  name={<><a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a> (const SCEV &#42;&amp;S, ScalarEvolution &amp;SE)</>}>
If S involves the addition of a constant integer value, return that integer value, and mutate S to point to a new <a href="/docs/api/classes/llvm/scev">SCEV</a> with that value excluded. <a href="#a1a0afc5106fca20f0a81eac37db70ab9">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;</>}
  name={<><a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a> (const SCEV &#42;&amp;S, ScalarEvolution &amp;SE)</>}>
If S involves the addition of a <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> address, return that symbol, and mutate S to point to a new <a href="/docs/api/classes/llvm/scev">SCEV</a> with that value excluded. <a href="#a45b1664e25bf2a7220367462f2580044">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a></>}
  name={<><a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a> (User::op&#95;iterator OI, User::op&#95;iterator OE, Loop &#42;L, ScalarEvolution &amp;SE)</>}>
Helper for CollectChains that finds an IV operand (computed by an AddRec in this loop) within &#91;OI,OE) or returns OE. <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="MemAccessTy"
  name={<><a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a> (const TargetTransformInfo &amp;TTI, Instruction &#42;Inst, Value &#42;OperandVal)</>}>
Return the type of the memory being accessed. <a href="#a7f4680b383ce7138bc2c12de282b14b4">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</>}
  name={<><a href="#ae0228f64a74eb3e9fc5343b024ab9a42">getAnyExtendConsideringPostIncUses</a> (ArrayRef&lt; PostIncLoopSet &gt; Loops, const SCEV &#42;Expr, Type &#42;ToTy, ScalarEvolution &amp;SE)</>}>
Extend/Truncate <code>Expr</code> to <code>ToTy</code> considering post-inc uses in <code>Loops</code>. <a href="#ae0228f64a74eb3e9fc5343b024ab9a42">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</>}
  name={<><a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a> (const SCEV &#42;LHS, const SCEV &#42;RHS, ScalarEvolution &amp;SE, bool IgnoreSignificantBits=false)</>}>
Return an expression for LHS /s RHS, if it can be determined and if the remainder is known to be zero, or null otherwise. <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</>}
  name={<><a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a> (const SCEV &#42;S)</>}>
Return an approximation of this <a href="/docs/api/classes/llvm/scev">SCEV</a> expression&#39;s &quot;base&quot;, or NULL for any constant. <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;</>}
  name={<><a href="#a6612c20f7ca23077265026ea4991e2b6">GetInductionVariable</a> (const Loop &amp;L, ScalarEvolution &amp;SE, const LSRInstance &amp;LSR)</>}>
Ideally pick the PHI IV inserted by ScalarEvolutionExpander. <a href="#a6612c20f7ca23077265026ea4991e2b6">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a></>}
  name={<><a href="#a3cbf7279944dc2f0f99a6896501277f9">getScalingFactorCost</a> (const TargetTransformInfo &amp;TTI, const LSRUse &amp;LU, const Formula &amp;F, const Loop &amp;L)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="unsigned"
  name={<><a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a> (const SCEV &#42;Reg, unsigned Depth)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">Value</a> &#42;</>}
  name={<><a href="#a7c340cc26f0c6d27219747cac55a2dc2">getValueOrPoison</a> (WeakVH &amp;VH, LLVMContext &amp;C)</>}>
Cached location ops may be erased during LSR, in which case a poison is required when restoring from the cache. <a href="#a7c340cc26f0c6d27219747cac55a2dc2">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/value">Value</a> &#42;</>}
  name={<><a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a> (Value &#42;Oper)</>}>
<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a> logic must consistently peek base <a href="/docs/api/classes/llvm/truncinst">TruncInst</a> operands, so wrap it in a convenient helper. <a href="#a0ef5c4bf982afaa71a03555b138aba58">More...</a>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a0cf26a507ec1ff72dd6624ac9b69d05c">INITIALIZE&#95;PASS&#95;BEGIN</a> (LoopStrengthReduce, &quot;loop-reduce&quot;, &quot;Loop Strength Reduction&quot;, false, false) INITIALIZE&#95;PASS&#95;END(LoopStrengthReduce</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a9b6b892760677b9b11c517eb5a46557f">isAddRecSExtable</a> (const SCEVAddRecExpr &#42;AR, ScalarEvolution &amp;SE)</>}>
Return true if the given addrec can be sign-extended without changing its value. <a href="#a9b6b892760677b9b11c517eb5a46557f">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a> (const TargetTransformInfo &amp;TTI, Instruction &#42;Inst, Value &#42;OperandVal)</>}>
Returns true if the specified instruction is using the specified value as an address. <a href="#a4120d81bd505176f5cadf647f5b8c7ef">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a1509f8a0c11e955037b00ce7542e24a7">isAddSExtable</a> (const SCEVAddExpr &#42;A, ScalarEvolution &amp;SE)</>}>
Return true if the given add can be sign-extended without changing its value. <a href="#a1509f8a0c11e955037b00ce7542e24a7">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a> (const TargetTransformInfo &amp;TTI, LSRUse::KindType Kind, MemAccessTy AccessTy, GlobalValue &#42;BaseGV, Immediate BaseOffset, bool HasBaseReg)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a290c161463cbfb7720d6499dba1310ad">isAlwaysFoldable</a> (const TargetTransformInfo &amp;TTI, ScalarEvolution &amp;SE, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, const SCEV &#42;S, bool HasBaseReg)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a> (const TargetTransformInfo &amp;TTI, const LSRUse &amp;LU, const Formula &amp;F)</>}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if the addressing mode defined by <code>F</code> is completely folded in <code>LU</code> at isel time. <a href="#aa847a3eff7b875035d9f887587291940">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a07e234e9b040a89b10635c52640987c9">isAMCompletelyFolded</a> (const TargetTransformInfo &amp;TTI, LSRUse::KindType Kind, MemAccessTy AccessTy, GlobalValue &#42;BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale, Instruction &#42;Fixup=nullptr)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a111eaa1963537539371757fda03a8d07">isAMCompletelyFolded</a> (const TargetTransformInfo &amp;TTI, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, GlobalValue &#42;BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aa4449f10e66ebab87164f4bf5bfd67d9">isAMCompletelyFolded</a> (const TargetTransformInfo &amp;TTI, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, const Formula &amp;F, const Loop &amp;L)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a3c81223cabf643af27adba3b3ceb680c">isExistingPhi</a> (const SCEVAddRecExpr &#42;AR, ScalarEvolution &amp;SE)</>}>
Return true if this AddRec is already a phi in its loop. <a href="#a3c81223cabf643af27adba3b3ceb680c">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a> (const SCEV &#42;S, SmallPtrSetImpl&lt; const SCEV &#42; &gt; &amp;Processed, ScalarEvolution &amp;SE)</>}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if expanding this expression is likely to incur significant cost. <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a52f2bc4870549427a397721a7de9849f">isLegalAddImmediate</a> (const TargetTransformInfo &amp;TTI, Immediate Offset)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a> (const TargetTransformInfo &amp;TTI, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, GlobalValue &#42;BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale)</>}>
Test whether we know how to expand the current formula. <a href="#a2e520a15f4578a464f9caaac2f4758ae">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a0cde97c20a134a57a746859698291aaa">isLegalUse</a> (const TargetTransformInfo &amp;TTI, Immediate MinOffset, Immediate MaxOffset, LSRUse::KindType Kind, MemAccessTy AccessTy, const Formula &amp;F)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a32cdb4a97c185f1acbe11f45fcc70d12">isMulSExtable</a> (const SCEVMulExpr &#42;M, ScalarEvolution &amp;SE)</>}>
Return true if the given mul can be sign-extended without changing its value. <a href="#a32cdb4a97c185f1acbe11f45fcc70d12">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#aca012302770ad32503de5e2c62344290">isProfitableChain</a> (IVChain &amp;Chain, SmallPtrSetImpl&lt; Instruction &#42; &gt; &amp;Users, ScalarEvolution &amp;SE, const TargetTransformInfo &amp;TTI)</>}>
Return true if the number of registers needed for the chain is estimated to be less than the number required for the individual IV users. <a href="#aca012302770ad32503de5e2c62344290">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a6c630dc63715497e5e49ab1ca9dc6ccb">IsSimplerBaseSCEVForTarget</a> (const TargetTransformInfo &amp;TTI, ScalarEvolution &amp;SE, const SCEV &#42;Best, const SCEV &#42;Reg, MemAccessTy AccessType)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a187751c86d349fac41ddc1b807b40b22">mayUsePostIncMode</a> (const TargetTransformInfo &amp;TTI, LSRUse &amp;LU, const SCEV &#42;S, const Loop &#42;L, ScalarEvolution &amp;SE)</>}>
Return true if the <a href="/docs/api/classes/llvm/scev">SCEV</a> represents a value that may end up as a post-increment operation. <a href="#a187751c86d349fac41ddc1b807b40b22">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="unsigned"
  name={<><a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a> (SmallVectorImpl&lt; uint64&#95;t &gt; &amp;Expr)</>}>
Returns the total number of DW&#95;OP&#95;llvm&#95;arg operands in the expression. <a href="#a80e922a79a22107b2f70e851825d098e">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#ac33f356faceb9655cb64611d2971d24f">ReduceLoopStrength</a> (Loop &#42;L, IVUsers &amp;IU, ScalarEvolution &amp;SE, DominatorTree &amp;DT, LoopInfo &amp;LI, const TargetTransformInfo &amp;TTI, AssumptionCache &amp;AC, TargetLibraryInfo &amp;TLI, MemorySSA &#42;MSSA)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#a196b104079c33f7ccd4ad4816376b9a7">restorePreTransformState</a> (DVIRecoveryRec &amp;DVIRec)</>}>
Restore the DVI&#39;s pre-LSR arguments. Substitute undef for any erased values. <a href="#a196b104079c33f7ccd4ad4816376b9a7">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a02cf9d6ac96ae27b406798da5c2eb7ea">SalvageDVI</a> (llvm::Loop &#42;L, ScalarEvolution &amp;SE, llvm::PHINode &#42;LSRInductionVar, DVIRecoveryRec &amp;DVIRec, const SCEV &#42;SCEVInductionVar, SCEVDbgValueBuilder IterCountExpr)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="void"
  name={<><a href="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0">UpdateDbgValueInst</a> (DVIRecoveryRec &amp;DVIRec, SmallVectorImpl&lt; Value &#42; &gt; &amp;NewLocationOps, SmallVectorImpl&lt; uint64&#95;t &gt; &amp;NewExpr)</>}>
Write the new expression and new location ops for the dbg.value. <a href="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0">More...</a>
</MembersIndexItem>

<MembersIndexItem
  template={<>template &lt;typename T&gt;</>}
  type="void"
  name={<><a href="#a4d8f7ff97b22c5203b332a778c88b088">updateDVIWithLocation</a> (T &amp;DbgVal, Value &#42;Location, SmallVectorImpl&lt; uint64&#95;t &gt; &amp;Ops)</>}>
Overwrites DVI with the location and Ops as the <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>. <a href="#a4d8f7ff97b22c5203b332a778c88b088">More...</a>
</MembersIndexItem>

<MembersIndexItem
  template={<>template &lt;typename T&gt;</>}
  type="void"
  name={<><a href="#ab2e6fc08d8f586e4979511620c12ffa8">updateDVIWithLocations</a> (T &amp;DbgVal, SmallVectorImpl&lt; Value &#42; &gt; &amp;Locations, SmallVectorImpl&lt; uint64&#95;t &gt; &amp;Ops)</>}>
Overwrite DVI with locations placed into a DIArglist. <a href="#ab2e6fc08d8f586e4979511620c12ffa8">More...</a>
</MembersIndexItem>

</MembersIndex>

## Variables Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44">cl::boolOrDefault</a> &gt;</>}
  name={<><a href="#a57a769eb2fe11448940d81a19e0140e2">AllowDropSolutionIfLessProfitable</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; unsigned &gt;</>}
  name={<><a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a0ce46a19f824c65a4ddace1f4e9ac529">DropScaledForVScale</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a94a7203d75d594f7012f80d9130dcadf">EnablePhiElim</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a5ca5d2aa868eb59998bc43f224fec74f">EnableVScaleImmediates</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<>loop <a href="/docs/api/classes/llvm/loop">Loop</a> Strength</>}
  name={<><a href="#a81103f81d98fb1888c83e3f13d71d043">false</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#aad3193b74a34d43bf4e02188ce67d3b7">FilterSameScaledReg</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#aa957fcc885db5c56e419b4646d135311">LSRExpNarrow</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> unsigned</>}
  name={<><a href="#a73b3c5e7c72bf97886e2ed1f12e28d54">MaxIVUsers</a> = 200</>}>
MaxIVUsers is an arbitrary threshold that provides an early opportunity for bail out. <a href="#a73b3c5e7c72bf97886e2ed1f12e28d54">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> unsigned</>}
  name={<><a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">MaxSCEVSalvageExpressionSize</a> = 64</>}>
Limit the size of expression that SCEV-based salvaging will attempt to translate into a <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>. <a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43">TTI::AddressingModeKind</a> &gt;</>}
  name={<><a href="#a5ecada6efd95584778cb27661747d9ba">PreferredAddresingMode</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="loop"
  name={<><a href="#a6d827fc34f1b4371a0b7183d3ca5bcac">reduce</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<>loop <a href="/docs/api/classes/llvm/loop">Loop</a> Strength</>}
  name={<><a href="#a175f1f53cc9c3619505ffbd13aca087f">Reduction</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; unsigned &gt;</>}
  name={<><a href="#af7597e13dc8bb8a3af795f41314f157f">SetupCostDepthLimit</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a></>}>
</MembersIndexItem>

</MembersIndex>

## Defines Index

<MembersIndex>

<MembersIndexItem
  type="#define"
  name={<><a href="#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>&nbsp;&nbsp;&nbsp;&quot;loop-reduce&quot;</>}>
</MembersIndexItem>

</MembersIndex>


<SectionDefinition>

## Functions

### canFoldIVIncExpr() {#ad35b9a85ea52062375c0c870be5cd228}

<MemberDefinition
  prototype={<>static bool canFoldIVIncExpr (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; IncExpr, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; UserInst, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Operand, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI)</>}
  labels = {["static"]}>
Return true if the <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> can be folded into an addressing mode.

Definition at line <a href="#l03359">3359</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### canHoistIVInc() {#aa12378426474ba414b8bc234a26fd19b}

<MemberDefinition
  prototype={<>static bool canHoistIVInc (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRFixup &amp; Fixup, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRUse &amp; LU, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; IVIncInsertPos, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L)</>}
  labels = {["static"]}>

Definition at line <a href="#l06031">6031</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### CollectSubexprs() {#ad0531a07d7868c1577980524cf2add3a}

<MemberDefinition
  prototype={<>static const SCEV &#42; CollectSubexprs (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42; C, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; &gt; &amp; Ops, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, unsigned Depth=0)</>}
  labels = {["static"]}>
Split S into subexpressions which can be pulled out into separate registers.

If C is non-null, multiply each subexpression by C.

Return remainder expression after factoring the subexpressions captured by Ops. If Ops is complete, return NULL.

Definition at line <a href="#l03835">3835</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### containsAddRecDependentOnLoop() {#a1fb9d2e9aea7544f9453aa3e2df38109}

<MemberDefinition
  prototype={<>static bool containsAddRecDependentOnLoop (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp; L)</>}
  labels = {["static"]}>

Definition at line <a href="#l00614">614</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### DbgGatherSalvagableDVI() {#a9766c807d5c90cf726463e300d0787d8}

<MemberDefinition
  prototype={<>static void DbgGatherSalvagableDVI (<a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; std::unique&#95;ptr&lt; DVIRecoveryRec &gt;, 2 &gt; &amp; SalvageableDVISCEVs, <a href="/docs/api/classes/llvm/smallset">SmallSet</a>&lt; <a href="/docs/api/classes/llvm/assertingvh">AssertingVH</a>&lt; <a href="/docs/api/classes/llvm/dbgvalueinst">DbgValueInst</a> &gt;, 2 &gt; &amp; DVIHandles)</>}
  labels = {["static"]}>
Identify and cache salvageable DVI locations and expressions along with the corresponding SCEV(s).

Also ensure that the DVI is not deleted between cacheing and salvaging.

Definition at line <a href="#l06969">6969</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### DbgRewriteSalvageableDVIs() {#a9188ba3c048bf8057af2b2ac144b9f0f}

<MemberDefinition
  prototype={<>static void DbgRewriteSalvageableDVIs (<a href="/docs/api/classes/llvm/loop">llvm::Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42; LSRInductionVar, <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt; std::unique&#95;ptr&lt; DVIRecoveryRec &gt;, 2 &gt; &amp; DVIToUpdate)</>}
  labels = {["static"]}>
Obtain an expression for the iteration count, then attempt to salvage the dbg.value intrinsics.

Definition at line <a href="#l06931">6931</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### DoInitialMatch() {#aa59a46776e15b1f1bd597c4e1e769f59}

<MemberDefinition
  prototype={<>static void DoInitialMatch (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; &gt; &amp; Good, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; &gt; &amp; Bad, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Recursion helper for initialMatch.

Definition at line <a href="#l00541">541</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### ExtractImmediate() {#a1a0afc5106fca20f0a81eac37db70ab9}

<MemberDefinition
  prototype={<>static Immediate ExtractImmediate (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp; S, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
If S involves the addition of a constant integer value, return that integer value, and mutate S to point to a new <a href="/docs/api/classes/llvm/scev">SCEV</a> with that value excluded.

Definition at line <a href="#l00924">924</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### ExtractSymbol() {#a45b1664e25bf2a7220367462f2580044}

<MemberDefinition
  prototype={<>static GlobalValue &#42; ExtractSymbol (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp; S, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
If S involves the addition of a <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> address, return that symbol, and mutate S to point to a new <a href="/docs/api/classes/llvm/scev">SCEV</a> with that value excluded.

Definition at line <a href="#l00958">958</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### findIVOperand() {#a262aeb2eecfb752ae2eecb90bab7ec8a}

<MemberDefinition
  prototype={<>static User::op&#95;iterator findIVOperand (<a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> OI, <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> OE, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Helper for CollectChains that finds an IV operand (computed by an AddRec in this loop) within &#91;OI,OE) or returns OE.

If <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> mapped Instructions to IVStrideUses, we could partially skip this.

Definition at line <a href="#l02964">2964</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getAccessType() {#a7f4680b383ce7138bc2c12de282b14b4}

<MemberDefinition
  prototype={<>static MemAccessTy getAccessType (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; Inst, <a href="/docs/api/classes/llvm/value">Value</a> &#42; OperandVal)</>}
  labels = {["static"]}>
Return the type of the memory being accessed.

Definition at line <a href="#l01029">1029</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getAnyExtendConsideringPostIncUses() {#ae0228f64a74eb3e9fc5343b024ab9a42}

<MemberDefinition
  prototype={<>static const SCEV &#42; getAnyExtendConsideringPostIncUses (<a href="/docs/api/classes/llvm/arrayref">ArrayRef</a>&lt; <a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> &gt; Loops, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; Expr, <a href="/docs/api/classes/llvm/type">Type</a> &#42; ToTy, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Extend/Truncate <code>Expr</code> to <code>ToTy</code> considering post-inc uses in <code>Loops</code>.

For all PostIncLoopSets in <code>Loops</code>, first de-normalize <code>Expr</code>, then perform the extension/truncate and normalize again, as the normalized form can result in folds that are not valid in the post-inc use contexts. The expressions for all PostIncLoopSets must match, otherwise return nullptr.

Definition at line <a href="#l04400">4400</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getExactSDiv() {#ad0ad0c0f486f8ea43158a1227e610a9c}

<MemberDefinition
  prototype={<>static const SCEV &#42; getExactSDiv (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; LHS, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; RHS, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, bool IgnoreSignificantBits=false)</>}
  labels = {["static"]}>
Return an expression for LHS /s RHS, if it can be determined and if the remainder is known to be zero, or null otherwise.

If IgnoreSignificantBits is true, expressions like (X &#42; Y) /s Y are simplified to X, ignoring that the multiplication may overflow, which is useful when the result will be used in a context where the most significant bits are ignored.

Definition at line <a href="#l00819">819</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getExprBase() {#a60008b3cbf2b4ef3e3d14af04beb6a06}

<MemberDefinition
  prototype={<>static const SCEV &#42; getExprBase (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S)</>}
  labels = {["static"]}>
Return an approximation of this <a href="/docs/api/classes/llvm/scev">SCEV</a> expression&#39;s &quot;base&quot;, or NULL for any constant.

Returning the expression itself is conservative. Returning a deeper subexpression is more precise and valid as long as it isn&#39;t less complex than another subexpression. For expressions involving multiple unscaled values, we need to return the pointer-type <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a>. This avoids forming chains across objects, such as: PrevOper==a&#91;i&#93;, IVOper==b&#91;i&#93;, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a>==b-a.

Since <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> is the rightmost type, and pointers are the rightmost <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a>, we simply return the rightmost <a href="/docs/api/classes/llvm/scev">SCEV</a> operand.

Definition at line <a href="#l02999">2999</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### GetInductionVariable() {#a6612c20f7ca23077265026ea4991e2b6}

<MemberDefinition
  prototype={<>static llvm::PHINode &#42; GetInductionVariable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRInstance &amp; LSR)</>}
  labels = {["static"]}>
Ideally pick the PHI IV inserted by ScalarEvolutionExpander.

As a fallback any PHi from the loop header is usable, but may have less chance of surviving subsequent transforms.

Definition at line <a href="#l07032">7032</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getScalingFactorCost() {#a3cbf7279944dc2f0f99a6896501277f9}

<MemberDefinition
  prototype={<>static InstructionCost getScalingFactorCost (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRUse &amp; LU, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> Formula &amp; F, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp; L)</>}
  labels = {["static"]}>

Definition at line <a href="#l01963">1963</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getSetupCost() {#ae51d322caa9d6592ff524f98563eac36}

<MemberDefinition
  prototype={<>static unsigned getSetupCost (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; Reg, unsigned Depth)</>}
  labels = {["static"]}>

Definition at line <a href="#l01392">1392</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getValueOrPoison() {#a7c340cc26f0c6d27219747cac55a2dc2}

<MemberDefinition
  prototype={<>static Value &#42; getValueOrPoison (<a href="/docs/api/classes/llvm/weakvh">WeakVH</a> &amp; VH, <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp; C)</>}
  labels = {["static"]}>
Cached location ops may be erased during LSR, in which case a poison is required when restoring from the cache.

The type of that location is no longer available, so just use int8. The poison will be replaced by one or more locations later when a <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder">SCEVDbgValueBuilder</a> selects alternative locations to use for the salvage.

Definition at line <a href="#l06777">6777</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### getWideOperand() {#a0ef5c4bf982afaa71a03555b138aba58}

<MemberDefinition
  prototype={<>static Value &#42; getWideOperand (<a href="/docs/api/classes/llvm/value">Value</a> &#42; Oper)</>}
  labels = {["static"]}>
<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a> logic must consistently peek base <a href="/docs/api/classes/llvm/truncinst">TruncInst</a> operands, so wrap it in a convenient helper.

Definition at line <a href="#l02983">2983</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### INITIALIZE&#95;PASS&#95;BEGIN() {#a0cf26a507ec1ff72dd6624ac9b69d05c}

<MemberDefinition
  prototype={<>INITIALIZE&#95;PASS&#95;BEGIN (LoopStrengthReduce, &quot;loop-reduce&quot;, &quot;Loop Strength Reduction&quot;, false, false)</>}>

Definition at line <a href="#l07182">7182</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAddRecSExtable() {#a9b6b892760677b9b11c517eb5a46557f}

<MemberDefinition
  prototype={<>static bool isAddRecSExtable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42; AR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if the given addrec can be sign-extended without changing its value.

Definition at line <a href="#l00791">791</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAddressUse() {#a4120d81bd505176f5cadf647f5b8c7ef}

<MemberDefinition
  prototype={<>static bool isAddressUse (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; Inst, <a href="/docs/api/classes/llvm/value">Value</a> &#42; OperandVal)</>}
  labels = {["static"]}>
Returns true if the specified instruction is using the specified value as an address.

Definition at line <a href="#l00984">984</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAddSExtable() {#a1509f8a0c11e955037b00ce7542e24a7}

<MemberDefinition
  prototype={<>static bool isAddSExtable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42; A, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if the given add can be sign-extended without changing its value.

Definition at line <a href="#l00799">799</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAlwaysFoldable() {#a626659c8868b0e423f831bfc2b98091e}

<MemberDefinition
  prototype={<>static bool isAlwaysFoldable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42; BaseGV, Immediate BaseOffset, bool HasBaseReg)</>}
  labels = {["static"]}>

Definition at line <a href="#l02008">2008</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAlwaysFoldable() {#a290c161463cbfb7720d6499dba1310ad}

<MemberDefinition
  prototype={<>static bool isAlwaysFoldable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, bool HasBaseReg)</>}
  labels = {["static"]}>

Definition at line <a href="#l02040">2040</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAMCompletelyFolded() {#aa847a3eff7b875035d9f887587291940}

<MemberDefinition
  prototype={<>static bool isAMCompletelyFolded (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> LSRUse &amp; LU, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> Formula &amp; F)</>}
  labels = {["static"]}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if the addressing mode defined by <code>F</code> is completely folded in <code>LU</code> at isel time.

This includes address-mode folding and special icmp tricks. This function returns true if <code>LU</code> can accommodate what <code>F</code> defines and up to 1 base + 1 scaled + offset. In other words, if <code>F</code> has several base registers, this function may still return true. Therefore, users still need to account for additional base registers and/or unfolded offsets to derive an accurate cost model.

Definition at line <a href="#l01946">1946</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAMCompletelyFolded() {#a07e234e9b040a89b10635c52640987c9}

<MemberDefinition
  prototype={<>static bool isAMCompletelyFolded (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42; BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; Fixup=nullptr)</>}
  labels = {["static"]}>

Definition at line <a href="#l01810">1810</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAMCompletelyFolded() {#a111eaa1963537539371757fda03a8d07}

<MemberDefinition
  prototype={<>static bool isAMCompletelyFolded (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42; BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale)</>}
  labels = {["static"]}>

Definition at line <a href="#l01874">1874</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isAMCompletelyFolded() {#aa4449f10e66ebab87164f4bf5bfd67d9}

<MemberDefinition
  prototype={<>static bool isAMCompletelyFolded (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> Formula &amp; F, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp; L)</>}
  labels = {["static"]}>

Definition at line <a href="#l01900">1900</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isExistingPhi() {#a3c81223cabf643af27adba3b3ceb680c}

<MemberDefinition
  prototype={<>static bool isExistingPhi (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42; AR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if this AddRec is already a phi in its loop.

Definition at line <a href="#l01082">1082</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isHighCostExpansion() {#a7ac21134b2aaca2a7d55f6ff9d92f5b2}

<MemberDefinition
  prototype={<>static bool isHighCostExpansion (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl</a>&lt; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; &gt; &amp; Processed, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if expanding this expression is likely to incur significant cost.

This is tricky because <a href="/docs/api/classes/llvm/scev">SCEV</a> doesn&#39;t track which expressions are actually computed by the current IR.

We currently allow expansion of IV increments that involve adds, multiplication by constants, and AddRecs from existing phis.

TODO: Allow UDivExpr if we can find an existing IV increment that is an obvious multiple of the UDivExpr.

Definition at line <a href="#l01102">1102</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isLegalAddImmediate() {#a52f2bc4870549427a397721a7de9849f}

<MemberDefinition
  prototype={<>static bool isLegalAddImmediate (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate Offset)</>}
  labels = {["static"]}>

Definition at line <a href="#l01938">1938</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isLegalUse() {#a2e520a15f4578a464f9caaac2f4758ae}

<MemberDefinition
  prototype={<>static bool isLegalUse (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42; BaseGV, Immediate BaseOffset, bool HasBaseReg, int64&#95;t Scale)</>}
  labels = {["static"]}>
Test whether we know how to expand the current formula.

Definition at line <a href="#l01917">1917</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isLegalUse() {#a0cde97c20a134a57a746859698291aaa}

<MemberDefinition
  prototype={<>static bool isLegalUse (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, Immediate MinOffset, Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> Formula &amp; F)</>}
  labels = {["static"]}>

Definition at line <a href="#l01931">1931</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isMulSExtable() {#a32cdb4a97c185f1acbe11f45fcc70d12}

<MemberDefinition
  prototype={<>static bool isMulSExtable (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42; M, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if the given mul can be sign-extended without changing its value.

Definition at line <a href="#l00807">807</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### isProfitableChain() {#aca012302770ad32503de5e2c62344290}

<MemberDefinition
  prototype={<>static bool isProfitableChain (IVChain &amp; Chain, <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl</a>&lt; <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42; &gt; &amp; Users, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI)</>}
  labels = {["static"]}>
Return true if the number of registers needed for the chain is estimated to be less than the number required for the individual IV users.

First prohibit any IV users that keep the IV live across increments (the Users set should be empty). Next count the number and type of increments in the chain.

Chaining IVs can lead to considerable code bloat if ISEL doesn&#39;t effectively use postinc addressing modes. Only consider it profitable it the increments can be computed in fewer registers when chained.

TODO: Consider <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> free if it&#39;s already used in another chains.

Definition at line <a href="#l03066">3066</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### IsSimplerBaseSCEVForTarget() {#a6c630dc63715497e5e49ab1ca9dc6ccb}

<MemberDefinition
  prototype={<>static bool IsSimplerBaseSCEVForTarget (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; Best, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; Reg, MemAccessTy AccessType)</>}
  labels = {["static"]}>

Definition at line <a href="#l05307">5307</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### mayUsePostIncMode() {#a187751c86d349fac41ddc1b807b40b22}

<MemberDefinition
  prototype={<>static bool mayUsePostIncMode (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, LSRUse &amp; LU, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; S, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE)</>}
  labels = {["static"]}>
Return true if the <a href="/docs/api/classes/llvm/scev">SCEV</a> represents a value that may end up as a post-increment operation.

Definition at line <a href="#l03893">3893</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### numLLVMArgOps() {#a80e922a79a22107b2f70e851825d098e}

<MemberDefinition
  prototype={<>static unsigned numLLVMArgOps (<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; uint64&#95;t &gt; &amp; Expr)</>}
  labels = {["static"]}>
Returns the total number of DW&#95;OP&#95;llvm&#95;arg operands in the expression.

This helps in determining if a DIArglist is necessary or can be omitted from the dbg.value.

Definition at line <a href="#l06693">6693</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### ReduceLoopStrength() {#ac33f356faceb9655cb64611d2971d24f}

<MemberDefinition
  prototype={<>static bool ReduceLoopStrength (<a href="/docs/api/classes/llvm/loop">Loop</a> &#42; L, <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp; IU, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp; DT, <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp; LI, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp; TTI, <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp; AC, <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp; TLI, <a href="/docs/api/classes/llvm/memoryssa">MemorySSA</a> &#42; MSSA)</>}
  labels = {["static"]}>

Definition at line <a href="#l07064">7064</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### restorePreTransformState() {#a196b104079c33f7ccd4ad4816376b9a7}

<MemberDefinition
  prototype={<>static void restorePreTransformState (DVIRecoveryRec &amp; DVIRec)</>}
  labels = {["static"]}>
Restore the DVI&#39;s pre-LSR arguments. Substitute undef for any erased values.

Definition at line <a href="#l06782">6782</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### SalvageDVI() {#a02cf9d6ac96ae27b406798da5c2eb7ea}

<MemberDefinition
  prototype={<>static bool SalvageDVI (<a href="/docs/api/classes/llvm/loop">llvm::Loop</a> &#42; L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp; SE, <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42; LSRInductionVar, DVIRecoveryRec &amp; DVIRec, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42; SCEVInductionVar, SCEVDbgValueBuilder IterCountExpr)</>}
  labels = {["static"]}>

Definition at line <a href="#l06818">6818</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### UpdateDbgValueInst() {#ab8a7ab37beb2d225c6cb1e9c6c20d0d0}

<MemberDefinition
  prototype={<>static void UpdateDbgValueInst (DVIRecoveryRec &amp; DVIRec, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/value">Value</a> &#42; &gt; &amp; NewLocationOps, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; uint64&#95;t &gt; &amp; NewExpr)</>}
  labels = {["static"]}>
Write the new expression and new location ops for the dbg.value.

If possible reduce the szie of the dbg.value intrinsic by omitting DIArglist. This can be omitted if:
<ul>
<li>There is only a single location, refenced by a single DW&#95;OP&#95;llvm&#95;arg.</li>
<li>The DW&#95;OP&#95;LLVM&#95;arg is the first operand in the expression.</li>
</ul>

Definition at line <a href="#l06736">6736</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### updateDVIWithLocation() {#a4d8f7ff97b22c5203b332a778c88b088}

<MemberDefinition
  template={<>template &lt;typename T&gt;</>}
  prototype={<>static void updateDVIWithLocation (T &amp; DbgVal, <a href="/docs/api/classes/llvm/value">Value</a> &#42; Location, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; uint64&#95;t &gt; &amp; Ops)</>}
  labels = {["static"]}>
Overwrites DVI with the location and Ops as the <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>.

This will create an invalid expression if Ops has any dwarf::DW&#95;OP&#95;llvm&#95;arg operands, because a DIArglist is not created for the first argument of the dbg.value.

Definition at line <a href="#l06706">6706</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### updateDVIWithLocations() {#ab2e6fc08d8f586e4979511620c12ffa8}

<MemberDefinition
  template={<>template &lt;typename T&gt;</>}
  prototype={<>static void updateDVIWithLocations (T &amp; DbgVal, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; <a href="/docs/api/classes/llvm/value">Value</a> &#42; &gt; &amp; Locations, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt; uint64&#95;t &gt; &amp; Ops)</>}
  labels = {["static"]}>
Overwrite DVI with locations placed into a DIArglist.

Definition at line <a href="#l06717">6717</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Variables

### AllowDropSolutionIfLessProfitable {#a57a769eb2fe11448940d81a19e0140e2}

<MemberDefinition
  prototype={<>cl::opt&lt; cl::boolOrDefault &gt; AllowDropSolutionIfLessProfitable(&quot;lsr-drop-solution&quot;, cl::Hidden, cl::desc(&quot;Attempt to drop solution if it is less profitable&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00191">191</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### ComplexityLimit {#ab5189d9a0612b4e660ef0320a77b2894}

<MemberDefinition
  prototype={<>cl::opt&lt; unsigned &gt; ComplexityLimit(&quot;lsr-complexity-limit&quot;, cl::Hidden, cl::init(std::numeric&#95;limits&lt; uint16&#95;t &gt;::max()), cl::desc(&quot;LSR search space complexity limit&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00182">182</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### DropScaledForVScale {#a0ce46a19f824c65a4ddace1f4e9ac529}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; DropScaledForVScale(&quot;lsr-drop-scaled-reg-for-vscale&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Avoid using scaled registers with vscale-relative addressing&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00199">199</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### EnablePhiElim {#a94a7203d75d594f7012f80d9130dcadf}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; EnablePhiElim(&quot;enable-lsr-phielim&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Enable LSR phi elimination&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00147">147</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### EnableVScaleImmediates {#a5ca5d2aa868eb59998bc43f224fec74f}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; EnableVScaleImmediates(&quot;lsr-enable-vscale-immediates&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Enable analysis of vscale-relative immediates in LSR&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00195">195</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### false {#a81103f81d98fb1888c83e3f13d71d043}

<MemberDefinition
  prototype="loop Loop Strength false">

Definition at line <a href="#l07191">7191</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### FilterSameScaledReg {#aad3193b74a34d43bf4e02188ce67d3b7}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; FilterSameScaledReg(&quot;lsr-filter-same-scaled-reg&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Narrow LSR search space by filtering non-optimal formulae&quot; &quot; with the same ScaledReg and Scale&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00164">164</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### InsnsCost {#a3d46ca97222c953c0d38e65b728e0f7b}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; InsnsCost(&quot;lsr-insns-cost&quot;, cl::Hidden, cl::init(true), cl::desc(&quot;Add instruction count to a LSR cost model&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00152">152</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### LSRExpNarrow {#aa957fcc885db5c56e419b4646d135311}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; LSRExpNarrow(&quot;lsr-exp-narrow&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Narrow LSR complex solution using&quot; &quot; expectation of registers number&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00157">157</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### MaxIVUsers {#a73b3c5e7c72bf97886e2ed1f12e28d54}

<MemberDefinition
  prototype="const unsigned MaxIVUsers = 200"
  labels = {["static"]}>
MaxIVUsers is an arbitrary threshold that provides an early opportunity for bail out.

This threshold is far beyond the number of users that LSR can conceivably solve, so it should not affect generated code, but catches the worst cases before LSR burns too much compile time and stack space.

Definition at line <a href="#l00138">138</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### MaxSCEVSalvageExpressionSize {#a35e8d876ca1d9ef72efaa8b320bd4f36}

<MemberDefinition
  prototype="const unsigned MaxSCEVSalvageExpressionSize = 64"
  labels = {["static"]}>
Limit the size of expression that SCEV-based salvaging will attempt to translate into a <a href="/docs/api/classes/llvm/diexpression">DIExpression</a>.

Choose a maximum size such that debuginfo is not excessively increased and the salvaging is not too expensive for the compiler.

Definition at line <a href="#l00144">144</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### PreferredAddresingMode {#a5ecada6efd95584778cb27661747d9ba}

<MemberDefinition
  prototype={<>cl::opt&lt; TTI::AddressingModeKind &gt; PreferredAddresingMode(&quot;lsr-preferred-addressing-mode&quot;, cl::Hidden, cl::init(TTI::AMK&#95;None), cl::desc(&quot;A flag that overrides the target&#39;s preferred addressing mode.&quot;), cl::values(clEnumValN(TTI::AMK&#95;None, &quot;none&quot;, &quot;Don&#39;t prefer any addressing mode&quot;), clEnumValN(TTI::AMK&#95;PreIndexed, &quot;preindexed&quot;, &quot;Prefer pre-indexed addressing mode&quot;), clEnumValN(TTI::AMK&#95;PostIndexed, &quot;postindexed&quot;, &quot;Prefer post-indexed addressing mode&quot;)))</>}
  labels = {["static"]}>

Definition at line <a href="#l00169">169</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### reduce {#a6d827fc34f1b4371a0b7183d3ca5bcac}

<MemberDefinition
  prototype="loop reduce">

Definition at line <a href="#l07190">7190</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### Reduction {#a175f1f53cc9c3619505ffbd13aca087f}

<MemberDefinition
  prototype="loop Loop Strength Reduction">

Definition at line <a href="#l07191">7191</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### SetupCostDepthLimit {#af7597e13dc8bb8a3af795f41314f157f}

<MemberDefinition
  prototype={<>cl::opt&lt; unsigned &gt; SetupCostDepthLimit(&quot;lsr-setupcost-depth-limit&quot;, cl::Hidden, cl::init(7), cl::desc(&quot;The limit on recursion depth for LSRs setup cost&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00187">187</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

### StressIVChain {#a3dbd582073ac67026ef5be72da94d4a3}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; StressIVChain(&quot;stress-ivchain&quot;, cl::Hidden, cl::init(false), cl::desc(&quot;Stress test LSR IV chains&quot;))</>}
  labels = {["static"]}>

Definition at line <a href="#l00205">205</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Defines

### DEBUG&#95;TYPE {#ad78e062f62e0d6e453941fb4ca843e4d}

<MemberDefinition
  prototype={<>#define DEBUG&#95;TYPE&nbsp;&nbsp;&nbsp;&quot;loop-reduce&quot;</>}>

Definition at line <a href="#l00132">132</a> of file <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/loopstrengthreduce-cpp">LoopStrengthReduce.cpp</a>.
</MemberDefinition>

</SectionDefinition>

## File Listing

The file content with the documentation metadata removed is:

<ProgramListing>

<Link id="l00001" /><CodeLine lineNumber="1"><span class="doxyHighlightComment">//===- LoopStrengthReduce.cpp - Strength Reduce IVs in Loops --------------===//</span></CodeLine>
<Link id="l00002" /><CodeLine lineNumber="2"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00003" /><CodeLine lineNumber="3"><span class="doxyHighlightComment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></CodeLine>
<Link id="l00004" /><CodeLine lineNumber="4"><span class="doxyHighlightComment">// See https://llvm.org/LICENSE.txt for license information.</span></CodeLine>
<Link id="l00005" /><CodeLine lineNumber="5"><span class="doxyHighlightComment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></CodeLine>
<Link id="l00006" /><CodeLine lineNumber="6"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00007" /><CodeLine lineNumber="7"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00008" /><CodeLine lineNumber="8"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00009" /><CodeLine lineNumber="9"><span class="doxyHighlightComment">// This transformation analyzes and transforms the induction variables (and</span></CodeLine>
<Link id="l00010" /><CodeLine lineNumber="10"><span class="doxyHighlightComment">// computations derived from them) into forms suitable for efficient execution</span></CodeLine>
<Link id="l00011" /><CodeLine lineNumber="11"><span class="doxyHighlightComment">// on the target.</span></CodeLine>
<Link id="l00012" /><CodeLine lineNumber="12"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00013" /><CodeLine lineNumber="13"><span class="doxyHighlightComment">// This pass performs a strength reduction on array references inside loops that</span></CodeLine>
<Link id="l00014" /><CodeLine lineNumber="14"><span class="doxyHighlightComment">// have as one or more of their components the loop induction variable, it</span></CodeLine>
<Link id="l00015" /><CodeLine lineNumber="15"><span class="doxyHighlightComment">// rewrites expressions to take advantage of scaled-index addressing modes</span></CodeLine>
<Link id="l00016" /><CodeLine lineNumber="16"><span class="doxyHighlightComment">// available on the target, and it performs a variety of other optimizations</span></CodeLine>
<Link id="l00017" /><CodeLine lineNumber="17"><span class="doxyHighlightComment">// related to loop induction variables.</span></CodeLine>
<Link id="l00018" /><CodeLine lineNumber="18"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00019" /><CodeLine lineNumber="19"><span class="doxyHighlightComment">// Terminology note: this code has a lot of handling for &quot;post-increment&quot; or</span></CodeLine>
<Link id="l00020" /><CodeLine lineNumber="20"><span class="doxyHighlightComment">// &quot;post-inc&quot; users. This is not talking about post-increment addressing modes;</span></CodeLine>
<Link id="l00021" /><CodeLine lineNumber="21"><span class="doxyHighlightComment">// it is instead talking about code like this:</span></CodeLine>
<Link id="l00022" /><CodeLine lineNumber="22"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00023" /><CodeLine lineNumber="23"><span class="doxyHighlightComment">//   %i = phi &#91; 0, %entry &#93;, &#91; %i.next, %latch &#93;</span></CodeLine>
<Link id="l00024" /><CodeLine lineNumber="24"><span class="doxyHighlightComment">//   ...</span></CodeLine>
<Link id="l00025" /><CodeLine lineNumber="25"><span class="doxyHighlightComment">//   %i.next = add %i, 1</span></CodeLine>
<Link id="l00026" /><CodeLine lineNumber="26"><span class="doxyHighlightComment">//   %c = icmp eq %i.next, %n</span></CodeLine>
<Link id="l00027" /><CodeLine lineNumber="27"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00028" /><CodeLine lineNumber="28"><span class="doxyHighlightComment">// The SCEV for %i is &#123;0,+,1&#125;&lt;%L&gt;. The SCEV for %i.next is &#123;1,+,1&#125;&lt;%L&gt;, however</span></CodeLine>
<Link id="l00029" /><CodeLine lineNumber="29"><span class="doxyHighlightComment">// it&#39;s useful to think about these as the same register, with some uses using</span></CodeLine>
<Link id="l00030" /><CodeLine lineNumber="30"><span class="doxyHighlightComment">// the value of the register before the add and some using it after. In this</span></CodeLine>
<Link id="l00031" /><CodeLine lineNumber="31"><span class="doxyHighlightComment">// example, the icmp is a post-increment user, since it uses %i.next, which is</span></CodeLine>
<Link id="l00032" /><CodeLine lineNumber="32"><span class="doxyHighlightComment">// the value of the induction variable after the increment. The other common</span></CodeLine>
<Link id="l00033" /><CodeLine lineNumber="33"><span class="doxyHighlightComment">// case of post-increment users is users outside the loop.</span></CodeLine>
<Link id="l00034" /><CodeLine lineNumber="34"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00035" /><CodeLine lineNumber="35"><span class="doxyHighlightComment">// TODO: More sophistication in the way Formulae are generated and filtered.</span></CodeLine>
<Link id="l00036" /><CodeLine lineNumber="36"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00037" /><CodeLine lineNumber="37"><span class="doxyHighlightComment">// TODO: Handle multiple loops at a time.</span></CodeLine>
<Link id="l00038" /><CodeLine lineNumber="38"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00039" /><CodeLine lineNumber="39"><span class="doxyHighlightComment">// TODO: Should the addressing mode BaseGV be changed to a ConstantExpr instead</span></CodeLine>
<Link id="l00040" /><CodeLine lineNumber="40"><span class="doxyHighlightComment">//       of a GlobalValue?</span></CodeLine>
<Link id="l00041" /><CodeLine lineNumber="41"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00042" /><CodeLine lineNumber="42"><span class="doxyHighlightComment">// TODO: When truncation is free, truncate ICmp users&#39; operands to make it a</span></CodeLine>
<Link id="l00043" /><CodeLine lineNumber="43"><span class="doxyHighlightComment">//       smaller encoding (on x86 at least).</span></CodeLine>
<Link id="l00044" /><CodeLine lineNumber="44"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00045" /><CodeLine lineNumber="45"><span class="doxyHighlightComment">// TODO: When a negated register is used by an add (such as in a list of</span></CodeLine>
<Link id="l00046" /><CodeLine lineNumber="46"><span class="doxyHighlightComment">//       multiple base registers, or as the increment expression in an addrec),</span></CodeLine>
<Link id="l00047" /><CodeLine lineNumber="47"><span class="doxyHighlightComment">//       we may not actually need both reg and (-1 &#42; reg) in registers; the</span></CodeLine>
<Link id="l00048" /><CodeLine lineNumber="48"><span class="doxyHighlightComment">//       negation can be implemented by using a sub instead of an add. The</span></CodeLine>
<Link id="l00049" /><CodeLine lineNumber="49"><span class="doxyHighlightComment">//       lack of support for taking this into consideration when making</span></CodeLine>
<Link id="l00050" /><CodeLine lineNumber="50"><span class="doxyHighlightComment">//       register pressure decisions is partly worked around by the &quot;Special&quot;</span></CodeLine>
<Link id="l00051" /><CodeLine lineNumber="51"><span class="doxyHighlightComment">//       use kind.</span></CodeLine>
<Link id="l00052" /><CodeLine lineNumber="52"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00053" /><CodeLine lineNumber="53"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00054" /><CodeLine lineNumber="54"></CodeLine>
<Link id="l00055" /><CodeLine lineNumber="55"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/scalar/loopstrengthreduce-h">llvm/Transforms/Scalar/LoopStrengthReduce.h</a>&quot;</span></CodeLine>
<Link id="l00056" /><CodeLine lineNumber="56"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/apint-h">llvm/ADT/APInt.h</a>&quot;</span></CodeLine>
<Link id="l00057" /><CodeLine lineNumber="57"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/densemap-h">llvm/ADT/DenseMap.h</a>&quot;</span></CodeLine>
<Link id="l00058" /><CodeLine lineNumber="58"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/denseset-h">llvm/ADT/DenseSet.h</a>&quot;</span></CodeLine>
<Link id="l00059" /><CodeLine lineNumber="59"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/hashing-h">llvm/ADT/Hashing.h</a>&quot;</span></CodeLine>
<Link id="l00060" /><CodeLine lineNumber="60"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/pointerintpair-h">llvm/ADT/PointerIntPair.h</a>&quot;</span></CodeLine>
<Link id="l00061" /><CodeLine lineNumber="61"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/stlextras-h">llvm/ADT/STLExtras.h</a>&quot;</span></CodeLine>
<Link id="l00062" /><CodeLine lineNumber="62"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/setvector-h">llvm/ADT/SetVector.h</a>&quot;</span></CodeLine>
<Link id="l00063" /><CodeLine lineNumber="63"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallbitvector-h">llvm/ADT/SmallBitVector.h</a>&quot;</span></CodeLine>
<Link id="l00064" /><CodeLine lineNumber="64"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallptrset-h">llvm/ADT/SmallPtrSet.h</a>&quot;</span></CodeLine>
<Link id="l00065" /><CodeLine lineNumber="65"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallset-h">llvm/ADT/SmallSet.h</a>&quot;</span></CodeLine>
<Link id="l00066" /><CodeLine lineNumber="66"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallvector-h">llvm/ADT/SmallVector.h</a>&quot;</span></CodeLine>
<Link id="l00067" /><CodeLine lineNumber="67"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h">llvm/ADT/Statistic.h</a>&quot;</span></CodeLine>
<Link id="l00068" /><CodeLine lineNumber="68"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/iterator-range-h">llvm/ADT/iterator&#95;range.h</a>&quot;</span></CodeLine>
<Link id="l00069" /><CodeLine lineNumber="69"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/assumptioncache-h">llvm/Analysis/AssumptionCache.h</a>&quot;</span></CodeLine>
<Link id="l00070" /><CodeLine lineNumber="70"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/domtreeupdater-h">llvm/Analysis/DomTreeUpdater.h</a>&quot;</span></CodeLine>
<Link id="l00071" /><CodeLine lineNumber="71"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/ivusers-h">llvm/Analysis/IVUsers.h</a>&quot;</span></CodeLine>
<Link id="l00072" /><CodeLine lineNumber="72"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/loopanalysismanager-h">llvm/Analysis/LoopAnalysisManager.h</a>&quot;</span></CodeLine>
<Link id="l00073" /><CodeLine lineNumber="73"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/loopinfo-h">llvm/Analysis/LoopInfo.h</a>&quot;</span></CodeLine>
<Link id="l00074" /><CodeLine lineNumber="74"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/looppass-h">llvm/Analysis/LoopPass.h</a>&quot;</span></CodeLine>
<Link id="l00075" /><CodeLine lineNumber="75"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/memoryssa-h">llvm/Analysis/MemorySSA.h</a>&quot;</span></CodeLine>
<Link id="l00076" /><CodeLine lineNumber="76"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/memoryssaupdater-h">llvm/Analysis/MemorySSAUpdater.h</a>&quot;</span></CodeLine>
<Link id="l00077" /><CodeLine lineNumber="77"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolution-h">llvm/Analysis/ScalarEvolution.h</a>&quot;</span></CodeLine>
<Link id="l00078" /><CodeLine lineNumber="78"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolutionexpressions-h">llvm/Analysis/ScalarEvolutionExpressions.h</a>&quot;</span></CodeLine>
<Link id="l00079" /><CodeLine lineNumber="79"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/scalarevolutionnormalization-h">llvm/Analysis/ScalarEvolutionNormalization.h</a>&quot;</span></CodeLine>
<Link id="l00080" /><CodeLine lineNumber="80"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/targetlibraryinfo-h">llvm/Analysis/TargetLibraryInfo.h</a>&quot;</span></CodeLine>
<Link id="l00081" /><CodeLine lineNumber="81"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/targettransforminfo-h">llvm/Analysis/TargetTransformInfo.h</a>&quot;</span></CodeLine>
<Link id="l00082" /><CodeLine lineNumber="82"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/valuetracking-h">llvm/Analysis/ValueTracking.h</a>&quot;</span></CodeLine>
<Link id="l00083" /><CodeLine lineNumber="83"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/binaryformat/dwarf-h">llvm/BinaryFormat/Dwarf.h</a>&quot;</span></CodeLine>
<Link id="l00084" /><CodeLine lineNumber="84"><span class="doxyHighlightPreprocessor">#include &quot;llvm/Config/llvm-config.h&quot;</span></CodeLine>
<Link id="l00085" /><CodeLine lineNumber="85"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/basicblock-h">llvm/IR/BasicBlock.h</a>&quot;</span></CodeLine>
<Link id="l00086" /><CodeLine lineNumber="86"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/constant-h">llvm/IR/Constant.h</a>&quot;</span></CodeLine>
<Link id="l00087" /><CodeLine lineNumber="87"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/constants-h">llvm/IR/Constants.h</a>&quot;</span></CodeLine>
<Link id="l00088" /><CodeLine lineNumber="88"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/debuginfometadata-h">llvm/IR/DebugInfoMetadata.h</a>&quot;</span></CodeLine>
<Link id="l00089" /><CodeLine lineNumber="89"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/derivedtypes-h">llvm/IR/DerivedTypes.h</a>&quot;</span></CodeLine>
<Link id="l00090" /><CodeLine lineNumber="90"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/dominators-h">llvm/IR/Dominators.h</a>&quot;</span></CodeLine>
<Link id="l00091" /><CodeLine lineNumber="91"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/globalvalue-h">llvm/IR/GlobalValue.h</a>&quot;</span></CodeLine>
<Link id="l00092" /><CodeLine lineNumber="92"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/irbuilder-h">llvm/IR/IRBuilder.h</a>&quot;</span></CodeLine>
<Link id="l00093" /><CodeLine lineNumber="93"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/instrtypes-h">llvm/IR/InstrTypes.h</a>&quot;</span></CodeLine>
<Link id="l00094" /><CodeLine lineNumber="94"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/instruction-h">llvm/IR/Instruction.h</a>&quot;</span></CodeLine>
<Link id="l00095" /><CodeLine lineNumber="95"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/instructions-h">llvm/IR/Instructions.h</a>&quot;</span></CodeLine>
<Link id="l00096" /><CodeLine lineNumber="96"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/intrinsicinst-h">llvm/IR/IntrinsicInst.h</a>&quot;</span></CodeLine>
<Link id="l00097" /><CodeLine lineNumber="97"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/module-h">llvm/IR/Module.h</a>&quot;</span></CodeLine>
<Link id="l00098" /><CodeLine lineNumber="98"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/operator-h">llvm/IR/Operator.h</a>&quot;</span></CodeLine>
<Link id="l00099" /><CodeLine lineNumber="99"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/type-h">llvm/IR/Type.h</a>&quot;</span></CodeLine>
<Link id="l00100" /><CodeLine lineNumber="100"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/use-h">llvm/IR/Use.h</a>&quot;</span></CodeLine>
<Link id="l00101" /><CodeLine lineNumber="101"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/user-h">llvm/IR/User.h</a>&quot;</span></CodeLine>
<Link id="l00102" /><CodeLine lineNumber="102"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/value-h">llvm/IR/Value.h</a>&quot;</span></CodeLine>
<Link id="l00103" /><CodeLine lineNumber="103"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/valuehandle-h">llvm/IR/ValueHandle.h</a>&quot;</span></CodeLine>
<Link id="l00104" /><CodeLine lineNumber="104"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/initializepasses-h">llvm/InitializePasses.h</a>&quot;</span></CodeLine>
<Link id="l00105" /><CodeLine lineNumber="105"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/pass-h">llvm/Pass.h</a>&quot;</span></CodeLine>
<Link id="l00106" /><CodeLine lineNumber="106"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/casting-h">llvm/Support/Casting.h</a>&quot;</span></CodeLine>
<Link id="l00107" /><CodeLine lineNumber="107"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h">llvm/Support/CommandLine.h</a>&quot;</span></CodeLine>
<Link id="l00108" /><CodeLine lineNumber="108"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h">llvm/Support/Compiler.h</a>&quot;</span></CodeLine>
<Link id="l00109" /><CodeLine lineNumber="109"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h">llvm/Support/Debug.h</a>&quot;</span></CodeLine>
<Link id="l00110" /><CodeLine lineNumber="110"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h">llvm/Support/ErrorHandling.h</a>&quot;</span></CodeLine>
<Link id="l00111" /><CodeLine lineNumber="111"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/mathextras-h">llvm/Support/MathExtras.h</a>&quot;</span></CodeLine>
<Link id="l00112" /><CodeLine lineNumber="112"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/raw-ostream-h">llvm/Support/raw&#95;ostream.h</a>&quot;</span></CodeLine>
<Link id="l00113" /><CodeLine lineNumber="113"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/scalar-h">llvm/Transforms/Scalar.h</a>&quot;</span></CodeLine>
<Link id="l00114" /><CodeLine lineNumber="114"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/utils-h">llvm/Transforms/Utils.h</a>&quot;</span></CodeLine>
<Link id="l00115" /><CodeLine lineNumber="115"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/basicblockutils-h">llvm/Transforms/Utils/BasicBlockUtils.h</a>&quot;</span></CodeLine>
<Link id="l00116" /><CodeLine lineNumber="116"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/local-h">llvm/Transforms/Utils/Local.h</a>&quot;</span></CodeLine>
<Link id="l00117" /><CodeLine lineNumber="117"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/looputils-h">llvm/Transforms/Utils/LoopUtils.h</a>&quot;</span></CodeLine>
<Link id="l00118" /><CodeLine lineNumber="118"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/scalarevolutionexpander-h">llvm/Transforms/Utils/ScalarEvolutionExpander.h</a>&quot;</span></CodeLine>
<Link id="l00119" /><CodeLine lineNumber="119"><span class="doxyHighlightPreprocessor">#include &lt;algorithm&gt;</span></CodeLine>
<Link id="l00120" /><CodeLine lineNumber="120"><span class="doxyHighlightPreprocessor">#include &lt;cassert&gt;</span></CodeLine>
<Link id="l00121" /><CodeLine lineNumber="121"><span class="doxyHighlightPreprocessor">#include &lt;cstddef&gt;</span></CodeLine>
<Link id="l00122" /><CodeLine lineNumber="122"><span class="doxyHighlightPreprocessor">#include &lt;cstdint&gt;</span></CodeLine>
<Link id="l00123" /><CodeLine lineNumber="123"><span class="doxyHighlightPreprocessor">#include &lt;iterator&gt;</span></CodeLine>
<Link id="l00124" /><CodeLine lineNumber="124"><span class="doxyHighlightPreprocessor">#include &lt;limits&gt;</span></CodeLine>
<Link id="l00125" /><CodeLine lineNumber="125"><span class="doxyHighlightPreprocessor">#include &lt;map&gt;</span></CodeLine>
<Link id="l00126" /><CodeLine lineNumber="126"><span class="doxyHighlightPreprocessor">#include &lt;numeric&gt;</span></CodeLine>
<Link id="l00127" /><CodeLine lineNumber="127"><span class="doxyHighlightPreprocessor">#include &lt;optional&gt;</span></CodeLine>
<Link id="l00128" /><CodeLine lineNumber="128"><span class="doxyHighlightPreprocessor">#include &lt;utility&gt;</span></CodeLine>
<Link id="l00129" /><CodeLine lineNumber="129"></CodeLine>
<Link id="l00130" /><CodeLine lineNumber="130"><span class="doxyHighlightKeyword">using namespace </span><span class="doxyHighlight"><a href="/docs/api/namespaces/llvm">llvm</a>;</span></CodeLine>
<Link id="l00131" /><CodeLine lineNumber="131"></CodeLine>
<Link id="l00132" /><CodeLine lineNumber="132" lineLink="#ad78e062f62e0d6e453941fb4ca843e4d"><span class="doxyHighlightPreprocessor">#define DEBUG&#95;TYPE &quot;loop-reduce&quot;</span></CodeLine>
<Link id="l00133" /><CodeLine lineNumber="133"></CodeLine>
<Link id="l00134" /><CodeLine lineNumber="134"><span class="doxyHighlightComment">/// MaxIVUsers is an arbitrary threshold that provides an early opportunity for</span></CodeLine>
<Link id="l00135" /><CodeLine lineNumber="135"><span class="doxyHighlightComment">/// bail out. This threshold is far beyond the number of users that LSR can</span></CodeLine>
<Link id="l00136" /><CodeLine lineNumber="136"><span class="doxyHighlightComment">/// conceivably solve, so it should not affect generated code, but catches the</span></CodeLine>
<Link id="l00137" /><CodeLine lineNumber="137"><span class="doxyHighlightComment">/// worst cases before LSR burns too much compile time and stack space.</span></CodeLine>
<Link id="l00138" /><CodeLine lineNumber="138" lineLink="#a73b3c5e7c72bf97886e2ed1f12e28d54"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="#a73b3c5e7c72bf97886e2ed1f12e28d54">MaxIVUsers</a> = 200;</span></CodeLine>
<Link id="l00139" /><CodeLine lineNumber="139"></CodeLine>
<Link id="l00140" /><CodeLine lineNumber="140"><span class="doxyHighlightComment">/// Limit the size of expression that SCEV-based salvaging will attempt to</span></CodeLine>
<Link id="l00141" /><CodeLine lineNumber="141"><span class="doxyHighlightComment">/// translate into a DIExpression.</span></CodeLine>
<Link id="l00142" /><CodeLine lineNumber="142"><span class="doxyHighlightComment">/// Choose a maximum size such that debuginfo is not excessively increased and</span></CodeLine>
<Link id="l00143" /><CodeLine lineNumber="143"><span class="doxyHighlightComment">/// the salvaging is not too expensive for the compiler.</span></CodeLine>
<Link id="l00144" /><CodeLine lineNumber="144" lineLink="#a35e8d876ca1d9ef72efaa8b320bd4f36"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">MaxSCEVSalvageExpressionSize</a> = 64;</span></CodeLine>
<Link id="l00145" /><CodeLine lineNumber="145"></CodeLine>
<Link id="l00146" /><CodeLine lineNumber="146"><span class="doxyHighlightComment">// Cleanup congruent phis after LSR phi expansion.</span></CodeLine>
<Link id="l00147" /><CodeLine lineNumber="147" lineLink="#a94a7203d75d594f7012f80d9130dcadf"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a94a7203d75d594f7012f80d9130dcadf">EnablePhiElim</a>(</span></CodeLine>
<Link id="l00148" /><CodeLine lineNumber="148"><span class="doxyHighlight">  </span><span class="doxyHighlightStringLiteral">&quot;enable-lsr-phielim&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00149" /><CodeLine lineNumber="149"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Enable LSR phi elimination&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00150" /><CodeLine lineNumber="150"></CodeLine>
<Link id="l00151" /><CodeLine lineNumber="151"><span class="doxyHighlightComment">// The flag adds instruction count to solutions cost comparison.</span></CodeLine>
<Link id="l00152" /><CodeLine lineNumber="152" lineLink="#a3d46ca97222c953c0d38e65b728e0f7b"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a>(</span></CodeLine>
<Link id="l00153" /><CodeLine lineNumber="153"><span class="doxyHighlight">  </span><span class="doxyHighlightStringLiteral">&quot;lsr-insns-cost&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00154" /><CodeLine lineNumber="154"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Add instruction count to a LSR cost model&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00155" /><CodeLine lineNumber="155"></CodeLine>
<Link id="l00156" /><CodeLine lineNumber="156"><span class="doxyHighlightComment">// Flag to choose how to narrow complex lsr solution</span></CodeLine>
<Link id="l00157" /><CodeLine lineNumber="157" lineLink="#aa957fcc885db5c56e419b4646d135311"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#aa957fcc885db5c56e419b4646d135311">LSRExpNarrow</a>(</span></CodeLine>
<Link id="l00158" /><CodeLine lineNumber="158"><span class="doxyHighlight">  </span><span class="doxyHighlightStringLiteral">&quot;lsr-exp-narrow&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00159" /><CodeLine lineNumber="159"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Narrow LSR complex solution using&quot;</span></CodeLine>
<Link id="l00160" /><CodeLine lineNumber="160"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot; expectation of registers number&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00161" /><CodeLine lineNumber="161"></CodeLine>
<Link id="l00162" /><CodeLine lineNumber="162"><span class="doxyHighlightComment">// Flag to narrow search space by filtering non-optimal formulae with</span></CodeLine>
<Link id="l00163" /><CodeLine lineNumber="163"><span class="doxyHighlightComment">// the same ScaledReg and Scale.</span></CodeLine>
<Link id="l00164" /><CodeLine lineNumber="164" lineLink="#aad3193b74a34d43bf4e02188ce67d3b7"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#aad3193b74a34d43bf4e02188ce67d3b7">FilterSameScaledReg</a>(</span></CodeLine>
<Link id="l00165" /><CodeLine lineNumber="165"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;lsr-filter-same-scaled-reg&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00166" /><CodeLine lineNumber="166"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Narrow LSR search space by filtering non-optimal formulae&quot;</span></CodeLine>
<Link id="l00167" /><CodeLine lineNumber="167"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot; with the same ScaledReg and Scale&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00168" /><CodeLine lineNumber="168"></CodeLine>
<Link id="l00169" /><CodeLine lineNumber="169" lineLink="#a5ecada6efd95584778cb27661747d9ba"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;TTI::AddressingModeKind&gt;</a> <a href="#a5ecada6efd95584778cb27661747d9ba">PreferredAddresingMode</a>(</span></CodeLine>
<Link id="l00170" /><CodeLine lineNumber="170"><span class="doxyHighlight">  </span><span class="doxyHighlightStringLiteral">&quot;lsr-preferred-addressing-mode&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43afcb500aacd74955fc04edc890f5e5d1a">TTI::AMK&#95;None</a>),</span></CodeLine>
<Link id="l00171" /><CodeLine lineNumber="171"><span class="doxyHighlight">   <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;A flag that overrides the target&#39;s preferred addressing mode.&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00172" /><CodeLine lineNumber="172"><span class="doxyHighlight">   <a href="/docs/api/namespaces/llvm/cl/#a8fa743aa76b6902028f8a643dfb87171">cl::values</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h/#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43afcb500aacd74955fc04edc890f5e5d1a">TTI::AMK&#95;None</a>,</span></CodeLine>
<Link id="l00173" /><CodeLine lineNumber="173"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;none&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00174" /><CodeLine lineNumber="174"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;Don&#39;t prefer any addressing mode&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00175" /><CodeLine lineNumber="175"><span class="doxyHighlight">              <a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h/#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a7cb26b7792c751612e634c36dce16f9a">TTI::AMK&#95;PreIndexed</a>,</span></CodeLine>
<Link id="l00176" /><CodeLine lineNumber="176"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;preindexed&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00177" /><CodeLine lineNumber="177"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;Prefer pre-indexed addressing mode&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00178" /><CodeLine lineNumber="178"><span class="doxyHighlight">              <a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h/#a187fd767976b311c09dff5e05ac0c1bc">clEnumValN</a>(<a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>,</span></CodeLine>
<Link id="l00179" /><CodeLine lineNumber="179"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;postindexed&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00180" /><CodeLine lineNumber="180"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;Prefer post-indexed addressing mode&quot;</span><span class="doxyHighlight">)));</span></CodeLine>
<Link id="l00181" /><CodeLine lineNumber="181"></CodeLine>
<Link id="l00182" /><CodeLine lineNumber="182" lineLink="#ab5189d9a0612b4e660ef0320a77b2894"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;unsigned&gt;</a> <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>(</span></CodeLine>
<Link id="l00183" /><CodeLine lineNumber="183"><span class="doxyHighlight">  </span><span class="doxyHighlightStringLiteral">&quot;lsr-complexity-limit&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</span></CodeLine>
<Link id="l00184" /><CodeLine lineNumber="184"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(std::numeric&#95;limits&lt;uint16&#95;t&gt;::max()),</span></CodeLine>
<Link id="l00185" /><CodeLine lineNumber="185"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;LSR search space complexity limit&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00186" /><CodeLine lineNumber="186"></CodeLine>
<Link id="l00187" /><CodeLine lineNumber="187" lineLink="#af7597e13dc8bb8a3af795f41314f157f"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;unsigned&gt;</a> <a href="#af7597e13dc8bb8a3af795f41314f157f">SetupCostDepthLimit</a>(</span></CodeLine>
<Link id="l00188" /><CodeLine lineNumber="188"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;lsr-setupcost-depth-limit&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(7),</span></CodeLine>
<Link id="l00189" /><CodeLine lineNumber="189"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;The limit on recursion depth for LSRs setup cost&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00190" /><CodeLine lineNumber="190"></CodeLine>
<Link id="l00191" /><CodeLine lineNumber="191" lineLink="#a57a769eb2fe11448940d81a19e0140e2"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;cl::boolOrDefault&gt;</a> <a href="#a57a769eb2fe11448940d81a19e0140e2">AllowDropSolutionIfLessProfitable</a>(</span></CodeLine>
<Link id="l00192" /><CodeLine lineNumber="192"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;lsr-drop-solution&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</span></CodeLine>
<Link id="l00193" /><CodeLine lineNumber="193"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Attempt to drop solution if it is less profitable&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00194" /><CodeLine lineNumber="194"></CodeLine>
<Link id="l00195" /><CodeLine lineNumber="195" lineLink="#a5ca5d2aa868eb59998bc43f224fec74f"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a5ca5d2aa868eb59998bc43f224fec74f">EnableVScaleImmediates</a>(</span></CodeLine>
<Link id="l00196" /><CodeLine lineNumber="196"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;lsr-enable-vscale-immediates&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00197" /><CodeLine lineNumber="197"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Enable analysis of vscale-relative immediates in LSR&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00198" /><CodeLine lineNumber="198"></CodeLine>
<Link id="l00199" /><CodeLine lineNumber="199" lineLink="#a0ce46a19f824c65a4ddace1f4e9ac529"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a0ce46a19f824c65a4ddace1f4e9ac529">DropScaledForVScale</a>(</span></CodeLine>
<Link id="l00200" /><CodeLine lineNumber="200"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;lsr-drop-scaled-reg-for-vscale&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00201" /><CodeLine lineNumber="201"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Avoid using scaled registers with vscale-relative addressing&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00202" /><CodeLine lineNumber="202"></CodeLine>
<Link id="l00203" /><CodeLine lineNumber="203"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l00204" /><CodeLine lineNumber="204"><span class="doxyHighlightComment">// Stress test IV chain generation.</span></CodeLine>
<Link id="l00205" /><CodeLine lineNumber="205" lineLink="#a3dbd582073ac67026ef5be72da94d4a3"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>(</span></CodeLine>
<Link id="l00206" /><CodeLine lineNumber="206"><span class="doxyHighlight">  </span><span class="doxyHighlightStringLiteral">&quot;stress-ivchain&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>, <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00207" /><CodeLine lineNumber="207"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Stress test LSR IV chains&quot;</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00208" /><CodeLine lineNumber="208"><span class="doxyHighlightPreprocessor">#else</span></CodeLine>
<Link id="l00209" /><CodeLine lineNumber="209"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00210" /><CodeLine lineNumber="210"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l00211" /><CodeLine lineNumber="211"></CodeLine>
<Link id="l00212" /><CodeLine lineNumber="212" lineLink="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00213" /><CodeLine lineNumber="213"></CodeLine>
<Link id="l00214" /><CodeLine lineNumber="214" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> &#123;</span></CodeLine>
<Link id="l00215" /><CodeLine lineNumber="215"><span class="doxyHighlightComment">  /// Used in situations where the accessed memory type is unknown.</span></CodeLine>
<Link id="l00216" /><CodeLine lineNumber="216" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a4ee10cdfa2006d2b20dc564ae2995ee1"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a4ee10cdfa2006d2b20dc564ae2995ee1">UnknownAddressSpace</a> =</span></CodeLine>
<Link id="l00217" /><CodeLine lineNumber="217"><span class="doxyHighlight">      std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l00218" /><CodeLine lineNumber="218"></CodeLine>
<Link id="l00219" /><CodeLine lineNumber="219" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9">MemTy</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00220" /><CodeLine lineNumber="220" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#abcb8fc2f380d99384c4d7601a22ea5d4"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#abcb8fc2f380d99384c4d7601a22ea5d4">AddrSpace</a> = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a4ee10cdfa2006d2b20dc564ae2995ee1">UnknownAddressSpace</a>;</span></CodeLine>
<Link id="l00221" /><CodeLine lineNumber="221"></CodeLine>
<Link id="l00222" /><CodeLine lineNumber="222" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a>() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00223" /><CodeLine lineNumber="223" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#ae6e8a4160a8933052075b0dab6e34d37"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#ae6e8a4160a8933052075b0dab6e34d37">MemAccessTy</a>(<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> AS) : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9">MemTy</a>(Ty), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#abcb8fc2f380d99384c4d7601a22ea5d4">AddrSpace</a>(AS) &#123;&#125;</span></CodeLine>
<Link id="l00224" /><CodeLine lineNumber="224"></CodeLine>
<Link id="l00225" /><CodeLine lineNumber="225" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a7183efe5ec28296357354f7c4a96fe90"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a7183efe5ec28296357354f7c4a96fe90">operator==</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00226" /><CodeLine lineNumber="226"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9">MemTy</a> == <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.MemTy &amp;&amp; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#abcb8fc2f380d99384c4d7601a22ea5d4">AddrSpace</a> == <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.AddrSpace;</span></CodeLine>
<Link id="l00227" /><CodeLine lineNumber="227"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00228" /><CodeLine lineNumber="228"></CodeLine>
<Link id="l00229" /><CodeLine lineNumber="229" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a60fd54d9eedf54e07ae485542a6fdddb"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a60fd54d9eedf54e07ae485542a6fdddb">operator!=</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !(&#42;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight"> == <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>); &#125;</span></CodeLine>
<Link id="l00230" /><CodeLine lineNumber="230"></CodeLine>
<Link id="l00231" /><CodeLine lineNumber="231" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a153bbcee36817bcedb110f30d95b2368"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a153bbcee36817bcedb110f30d95b2368">getUnknown</a>(<a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Ctx,</span></CodeLine>
<Link id="l00232" /><CodeLine lineNumber="232"><span class="doxyHighlight">                                </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> AS = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a4ee10cdfa2006d2b20dc564ae2995ee1">UnknownAddressSpace</a>) &#123;</span></CodeLine>
<Link id="l00233" /><CodeLine lineNumber="233"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a>(<a href="/docs/api/classes/llvm/type/#a6e20e76960d952de088354cbcd14c3ab">Type::getVoidTy</a>(Ctx), AS);</span></CodeLine>
<Link id="l00234" /><CodeLine lineNumber="234"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00235" /><CodeLine lineNumber="235"></CodeLine>
<Link id="l00236" /><CodeLine lineNumber="236" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#ad0cbf9c432ea20b9cb91c7b7402b2fb0"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#ad0cbf9c432ea20b9cb91c7b7402b2fb0">getType</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#aa3d1d271ec7b1930cbca198d3c71e1c9">MemTy</a>; &#125;</span></CodeLine>
<Link id="l00237" /><CodeLine lineNumber="237"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00238" /><CodeLine lineNumber="238"></CodeLine>
<Link id="l00239" /><CodeLine lineNumber="239"><span class="doxyHighlightComment">/// This class holds data which is used to order reuse candidates.</span></CodeLine>
<Link id="l00240" /><CodeLine lineNumber="240" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a> &#123;</span></CodeLine>
<Link id="l00241" /><CodeLine lineNumber="241"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00242" /><CodeLine lineNumber="242"><span class="doxyHighlightComment">  /// This represents the set of LSRUse indices which reference</span></CodeLine>
<Link id="l00243" /><CodeLine lineNumber="243"><span class="doxyHighlightComment">  /// a particular register.</span></CodeLine>
<Link id="l00244" /><CodeLine lineNumber="244" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>;</span></CodeLine>
<Link id="l00245" /><CodeLine lineNumber="245"></CodeLine>
<Link id="l00246" /><CodeLine lineNumber="246"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00247" /><CodeLine lineNumber="247"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00248" /><CodeLine lineNumber="248"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00249" /><CodeLine lineNumber="249"></CodeLine>
<Link id="l00250" /><CodeLine lineNumber="250"><span class="doxyHighlightComment">// An offset from an address that is either scalable or fixed. Used for</span></CodeLine>
<Link id="l00251" /><CodeLine lineNumber="251"><span class="doxyHighlightComment">// per-target optimizations of addressing modes.</span></CodeLine>
<Link id="l00252" /><CodeLine lineNumber="252" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight">Immediate : </span><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity">details::FixedOrScalableQuantity</a>&lt;Immediate, int64&#95;t&gt; &#123;</span></CodeLine>
<Link id="l00253" /><CodeLine lineNumber="253"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate(<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> MinVal, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>)</span></CodeLine>
<Link id="l00254" /><CodeLine lineNumber="254"><span class="doxyHighlight">      : <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a57beba2321012fb9cb702573f26fefff">FixedOrScalableQuantity</a>(MinVal, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>) &#123;&#125;</span></CodeLine>
<Link id="l00255" /><CodeLine lineNumber="255"></CodeLine>
<Link id="l00256" /><CodeLine lineNumber="256"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a57beba2321012fb9cb702573f26fefff">FixedOrScalableQuantity&lt;Immediate, int64&#95;t&gt;</a> &amp;V)</span></CodeLine>
<Link id="l00257" /><CodeLine lineNumber="257"><span class="doxyHighlight">      : <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a57beba2321012fb9cb702573f26fefff">FixedOrScalableQuantity</a>(V) &#123;&#125;</span></CodeLine>
<Link id="l00258" /><CodeLine lineNumber="258"></CodeLine>
<Link id="l00259" /><CodeLine lineNumber="259"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00260" /><CodeLine lineNumber="260" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a>() = </span><span class="doxyHighlightKeyword">delete</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00261" /><CodeLine lineNumber="261"></CodeLine>
<Link id="l00262" /><CodeLine lineNumber="262" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">getFixed</a>(<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> MinVal) &#123;</span></CodeLine>
<Link id="l00263" /><CodeLine lineNumber="263"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;MinVal, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00264" /><CodeLine lineNumber="264"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00265" /><CodeLine lineNumber="265" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ac7030e0a5d4b154f205b3d85dde0644b"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ac7030e0a5d4b154f205b3d85dde0644b">getScalable</a>(<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> MinVal) &#123;</span></CodeLine>
<Link id="l00266" /><CodeLine lineNumber="266"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;MinVal, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00267" /><CodeLine lineNumber="267"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00268" /><CodeLine lineNumber="268" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341">get</a>(<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> MinVal, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>) &#123;</span></CodeLine>
<Link id="l00269" /><CodeLine lineNumber="269"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;MinVal, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>&#125;;</span></CodeLine>
<Link id="l00270" /><CodeLine lineNumber="270"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00271" /><CodeLine lineNumber="271" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">getZero</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;0, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;; &#125;</span></CodeLine>
<Link id="l00272" /><CodeLine lineNumber="272" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a691a45579958cfd41dd9dcff39646ca0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a691a45579958cfd41dd9dcff39646ca0">getFixedMin</a>() &#123;</span></CodeLine>
<Link id="l00273" /><CodeLine lineNumber="273"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;std::numeric&#95;limits&lt;int64&#95;t&gt;::min(), </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00274" /><CodeLine lineNumber="274"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00275" /><CodeLine lineNumber="275" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a23392dbe6d771d111f00d09560f87f0d"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a23392dbe6d771d111f00d09560f87f0d">getFixedMax</a>() &#123;</span></CodeLine>
<Link id="l00276" /><CodeLine lineNumber="276"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;std::numeric&#95;limits&lt;int64&#95;t&gt;::max(), </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00277" /><CodeLine lineNumber="277"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00278" /><CodeLine lineNumber="278" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#addbe1dedb40bb3add88146d6f912ab8d"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#addbe1dedb40bb3add88146d6f912ab8d">getScalableMin</a>() &#123;</span></CodeLine>
<Link id="l00279" /><CodeLine lineNumber="279"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;std::numeric&#95;limits&lt;int64&#95;t&gt;::min(), </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00280" /><CodeLine lineNumber="280"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00281" /><CodeLine lineNumber="281" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a7b628b6318570ab9f5c98bf6a81d0c8c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a7b628b6318570ab9f5c98bf6a81d0c8c">getScalableMax</a>() &#123;</span></CodeLine>
<Link id="l00282" /><CodeLine lineNumber="282"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;std::numeric&#95;limits&lt;int64&#95;t&gt;::max(), </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00283" /><CodeLine lineNumber="283"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00284" /><CodeLine lineNumber="284"></CodeLine>
<Link id="l00285" /><CodeLine lineNumber="285" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a09fbb09d8e3de5323f1bf48d5f6ce4d3"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a09fbb09d8e3de5323f1bf48d5f6ce4d3">isLessThanZero</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> &lt; 0; &#125;</span></CodeLine>
<Link id="l00286" /><CodeLine lineNumber="286"></CodeLine>
<Link id="l00287" /><CodeLine lineNumber="287" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#af83345cd673ad0ac4c8e054676d99e20"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#af83345cd673ad0ac4c8e054676d99e20">isGreaterThanZero</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> &gt; 0; &#125;</span></CodeLine>
<Link id="l00288" /><CodeLine lineNumber="288"></CodeLine>
<Link id="l00289" /><CodeLine lineNumber="289" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a17247f3e579ad4a489daa1eec47d02fc"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a17247f3e579ad4a489daa1eec47d02fc">isCompatibleImmediate</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Immediate &amp;Imm)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00290" /><CodeLine lineNumber="290"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/lint-cpp/#a45005634b54e2126cb3e6ec0dbc9ade4">isZero</a>() || Imm.isZero() || Imm.Scalable == <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>;</span></CodeLine>
<Link id="l00291" /><CodeLine lineNumber="291"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00292" /><CodeLine lineNumber="292"></CodeLine>
<Link id="l00293" /><CodeLine lineNumber="293" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#af9e551c149ce95daab0aea2894c9e57e"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#af9e551c149ce95daab0aea2894c9e57e">isMin</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00294" /><CodeLine lineNumber="294"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> == std::numeric&#95;limits&lt;ScalarTy&gt;::min();</span></CodeLine>
<Link id="l00295" /><CodeLine lineNumber="295"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00296" /><CodeLine lineNumber="296"></CodeLine>
<Link id="l00297" /><CodeLine lineNumber="297" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a823489f1b0ab38e3bbc2e19d87e53f4d"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a823489f1b0ab38e3bbc2e19d87e53f4d">isMax</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00298" /><CodeLine lineNumber="298"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> == std::numeric&#95;limits&lt;ScalarTy&gt;::max();</span></CodeLine>
<Link id="l00299" /><CodeLine lineNumber="299"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00300" /><CodeLine lineNumber="300"></CodeLine>
<Link id="l00301" /><CodeLine lineNumber="301"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Arithmetic &#39;operators&#39; that cast to unsigned types first.</span></CodeLine>
<Link id="l00302" /><CodeLine lineNumber="302" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a94f015c2cf77ee4c5f81b8fef5347372"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a94f015c2cf77ee4c5f81b8fef5347372">addUnsigned</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Immediate &amp;RHS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00303" /><CodeLine lineNumber="303"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a17247f3e579ad4a489daa1eec47d02fc">isCompatibleImmediate</a>(RHS) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Incompatible Immediates&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00304" /><CodeLine lineNumber="304"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> <a href="/docs/api/classes/llvm/value">Value</a> = (uint64&#95;t)<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> + RHS.getKnownMinValue();</span></CodeLine>
<Link id="l00305" /><CodeLine lineNumber="305"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;<a href="/docs/api/classes/llvm/value">Value</a>, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a> || RHS.isScalable()&#125;;</span></CodeLine>
<Link id="l00306" /><CodeLine lineNumber="306"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00307" /><CodeLine lineNumber="307"></CodeLine>
<Link id="l00308" /><CodeLine lineNumber="308" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ab49fcf96665935bc0bc9d4cbd0a61a5d"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ab49fcf96665935bc0bc9d4cbd0a61a5d">subUnsigned</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Immediate &amp;RHS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00309" /><CodeLine lineNumber="309"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a17247f3e579ad4a489daa1eec47d02fc">isCompatibleImmediate</a>(RHS) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Incompatible Immediates&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00310" /><CodeLine lineNumber="310"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> <a href="/docs/api/classes/llvm/value">Value</a> = (uint64&#95;t)<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> - RHS.getKnownMinValue();</span></CodeLine>
<Link id="l00311" /><CodeLine lineNumber="311"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;<a href="/docs/api/classes/llvm/value">Value</a>, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a> || RHS.isScalable()&#125;;</span></CodeLine>
<Link id="l00312" /><CodeLine lineNumber="312"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00313" /><CodeLine lineNumber="313"></CodeLine>
<Link id="l00314" /><CodeLine lineNumber="314"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Scale the quantity by a constant without caring about runtime scalability.</span></CodeLine>
<Link id="l00315" /><CodeLine lineNumber="315" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#aaee2861110d67f49f009585108f84fe9"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">constexpr</span><span class="doxyHighlight"> Immediate <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#aaee2861110d67f49f009585108f84fe9">mulUnsigned</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> RHS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00316" /><CodeLine lineNumber="316"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#acedfd762498bd93768c82e145023a2e9">ScalarTy</a> <a href="/docs/api/classes/llvm/value">Value</a> = (uint64&#95;t)<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a> &#42; RHS;</span></CodeLine>
<Link id="l00317" /><CodeLine lineNumber="317"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;<a href="/docs/api/classes/llvm/value">Value</a>, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>&#125;;</span></CodeLine>
<Link id="l00318" /><CodeLine lineNumber="318"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00319" /><CodeLine lineNumber="319"></CodeLine>
<Link id="l00320" /><CodeLine lineNumber="320"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Helpers for generating SCEVs with vscale terms where needed.</span></CodeLine>
<Link id="l00321" /><CodeLine lineNumber="321" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a51c730254cd6b346d9fa4588c58a7517"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a51c730254cd6b346d9fa4588c58a7517">getSCEV</a>(<a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00322" /><CodeLine lineNumber="322"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(Ty, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a>);</span></CodeLine>
<Link id="l00323" /><CodeLine lineNumber="323"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>)</span></CodeLine>
<Link id="l00324" /><CodeLine lineNumber="324"><span class="doxyHighlight">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(S, SE.<a href="/docs/api/classes/llvm/scalarevolution/#abc6d543083aac1a4e161c0ed02b9b30a">getVScale</a>(S-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</span></CodeLine>
<Link id="l00325" /><CodeLine lineNumber="325"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> S;</span></CodeLine>
<Link id="l00326" /><CodeLine lineNumber="326"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00327" /><CodeLine lineNumber="327"></CodeLine>
<Link id="l00328" /><CodeLine lineNumber="328" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a81bada52d17e453e10221581a1bda050"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a81bada52d17e453e10221581a1bda050">getNegativeSCEV</a>(<a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00329" /><CodeLine lineNumber="329"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NegS = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(Ty, -(uint64&#95;t)<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a>);</span></CodeLine>
<Link id="l00330" /><CodeLine lineNumber="330"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>)</span></CodeLine>
<Link id="l00331" /><CodeLine lineNumber="331"><span class="doxyHighlight">      NegS = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(NegS, SE.<a href="/docs/api/classes/llvm/scalarevolution/#abc6d543083aac1a4e161c0ed02b9b30a">getVScale</a>(NegS-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</span></CodeLine>
<Link id="l00332" /><CodeLine lineNumber="332"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> NegS;</span></CodeLine>
<Link id="l00333" /><CodeLine lineNumber="333"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00334" /><CodeLine lineNumber="334"></CodeLine>
<Link id="l00335" /><CodeLine lineNumber="335" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a8829aacd47e6a4f3dbaf6c359d5afdfb"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a8829aacd47e6a4f3dbaf6c359d5afdfb">getUnknownSCEV</a>(<a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00336" /><CodeLine lineNumber="336"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;SU = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad8e4f5b2ced08ad7d138b598aefdd338">getUnknown</a>(<a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(Ty, <a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a00f7f73f257f28c032fec06f21b7d42e">Quantity</a>));</span></CodeLine>
<Link id="l00337" /><CodeLine lineNumber="337"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#aea2efb72b66f0b71d52898a155f20ab0">Scalable</a>)</span></CodeLine>
<Link id="l00338" /><CodeLine lineNumber="338"><span class="doxyHighlight">      SU = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(SU, SE.<a href="/docs/api/classes/llvm/scalarevolution/#abc6d543083aac1a4e161c0ed02b9b30a">getVScale</a>(SU-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</span></CodeLine>
<Link id="l00339" /><CodeLine lineNumber="339"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SU;</span></CodeLine>
<Link id="l00340" /><CodeLine lineNumber="340"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00341" /><CodeLine lineNumber="341"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00342" /><CodeLine lineNumber="342"></CodeLine>
<Link id="l00343" /><CodeLine lineNumber="343"><span class="doxyHighlightComment">// This is needed for the Compare type of std::map when Immediate is used</span></CodeLine>
<Link id="l00344" /><CodeLine lineNumber="344"><span class="doxyHighlightComment">// as a key. We don&#39;t need it to be fully correct against any value of vscale,</span></CodeLine>
<Link id="l00345" /><CodeLine lineNumber="345"><span class="doxyHighlightComment">// just to make sure that vscale-related terms in the map are considered against</span></CodeLine>
<Link id="l00346" /><CodeLine lineNumber="346"><span class="doxyHighlightComment">// each other rather than being mixed up and potentially missing opportunities.</span></CodeLine>
<Link id="l00347" /><CodeLine lineNumber="347" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate">KeyOrderTargetImmediate</a> &#123;</span></CodeLine>
<Link id="l00348" /><CodeLine lineNumber="348" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate/#aeaef27a0b75edede472740694b20ca90"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate/#aeaef27a0b75edede472740694b20ca90">operator()</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> &amp;LHS, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> &amp;RHS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00349" /><CodeLine lineNumber="349"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LHS.isScalable() &amp;&amp; !RHS.isScalable())</span></CodeLine>
<Link id="l00350" /><CodeLine lineNumber="350"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00351" /><CodeLine lineNumber="351"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LHS.isScalable() &amp;&amp; RHS.isScalable())</span></CodeLine>
<Link id="l00352" /><CodeLine lineNumber="352"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00353" /><CodeLine lineNumber="353"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> LHS.getKnownMinValue() &lt; RHS.getKnownMinValue();</span></CodeLine>
<Link id="l00354" /><CodeLine lineNumber="354"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00355" /><CodeLine lineNumber="355"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00356" /><CodeLine lineNumber="356"></CodeLine>
<Link id="l00357" /><CodeLine lineNumber="357"><span class="doxyHighlightComment">// This would be nicer if we could be generic instead of directly using size&#95;t,</span></CodeLine>
<Link id="l00358" /><CodeLine lineNumber="358"><span class="doxyHighlightComment">// but there doesn&#39;t seem to be a type trait for is&#95;orderable or</span></CodeLine>
<Link id="l00359" /><CodeLine lineNumber="359"><span class="doxyHighlightComment">// is&#95;lessthan&#95;comparable or similar.</span></CodeLine>
<Link id="l00360" /><CodeLine lineNumber="360" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate">KeyOrderSizeTAndImmediate</a> &#123;</span></CodeLine>
<Link id="l00361" /><CodeLine lineNumber="361" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate/#a839eca6f38e94cf573f5614ef356342e"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordersizetandimmediate/#a839eca6f38e94cf573f5614ef356342e">operator()</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> std::pair&lt;size&#95;t, Immediate&gt; &amp;LHS,</span></CodeLine>
<Link id="l00362" /><CodeLine lineNumber="362"><span class="doxyHighlight">                  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> std::pair&lt;size&#95;t, Immediate&gt; &amp;RHS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00363" /><CodeLine lineNumber="363"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LSize = LHS.first;</span></CodeLine>
<Link id="l00364" /><CodeLine lineNumber="364"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> RSize = RHS.first;</span></CodeLine>
<Link id="l00365" /><CodeLine lineNumber="365"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LSize != RSize)</span></CodeLine>
<Link id="l00366" /><CodeLine lineNumber="366"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> LSize &lt; RSize;</span></CodeLine>
<Link id="l00367" /><CodeLine lineNumber="367"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/keyordertargetimmediate">KeyOrderTargetImmediate</a>()(LHS.second, RHS.second);</span></CodeLine>
<Link id="l00368" /><CodeLine lineNumber="368"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00369" /><CodeLine lineNumber="369"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00370" /><CodeLine lineNumber="370"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l00371" /><CodeLine lineNumber="371"></CodeLine>
<Link id="l00372" /><CodeLine lineNumber="372"><span class="doxyHighlightPreprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</span></CodeLine>
<Link id="l00373" /><CodeLine lineNumber="373" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#a4238146a308b03c91ba9bfb8f7096da5"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#a4238146a308b03c91ba9bfb8f7096da5">RegSortData::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00374" /><CodeLine lineNumber="374"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&#91;NumUses=&quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.count() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;&#93;&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00375" /><CodeLine lineNumber="375"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00376" /><CodeLine lineNumber="376"></CodeLine>
<Link id="l00377" /><CodeLine lineNumber="377" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#a8efa96a6fa3836082f6d19af59855749"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#a8efa96a6fa3836082f6d19af59855749">RegSortData::dump</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00378" /><CodeLine lineNumber="378"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00379" /><CodeLine lineNumber="379"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00380" /><CodeLine lineNumber="380"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l00381" /><CodeLine lineNumber="381"></CodeLine>
<Link id="l00382" /><CodeLine lineNumber="382"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00383" /><CodeLine lineNumber="383"></CodeLine>
<Link id="l00384" /><CodeLine lineNumber="384"><span class="doxyHighlightComment">/// Map register candidates to information about how they are used.</span></CodeLine>
<Link id="l00385" /><CodeLine lineNumber="385" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &#123;</span></CodeLine>
<Link id="l00386" /><CodeLine lineNumber="386"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight">RegUsesTy = <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;const SCEV &#42;, RegSortData&gt;</a>;</span></CodeLine>
<Link id="l00387" /><CodeLine lineNumber="387"></CodeLine>
<Link id="l00388" /><CodeLine lineNumber="388"><span class="doxyHighlight">  RegUsesTy RegUsesMap;</span></CodeLine>
<Link id="l00389" /><CodeLine lineNumber="389"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 16&gt;</a> RegSequence;</span></CodeLine>
<Link id="l00390" /><CodeLine lineNumber="390"></CodeLine>
<Link id="l00391" /><CodeLine lineNumber="391"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00392" /><CodeLine lineNumber="392"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a13a5af062b4806f2bd27402b3c6d96ff">countRegister</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx);</span></CodeLine>
<Link id="l00393" /><CodeLine lineNumber="393"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a6a56d58ef201c3111c594b541bfef549">dropRegister</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx);</span></CodeLine>
<Link id="l00394" /><CodeLine lineNumber="394"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a3eb3a081cacc38c1381cf09b9bb18896">swapAndDropUse</a>(</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LastLUIdx);</span></CodeLine>
<Link id="l00395" /><CodeLine lineNumber="395"></CodeLine>
<Link id="l00396" /><CodeLine lineNumber="396"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8">isRegUsedByUsesOtherThan</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00397" /><CodeLine lineNumber="397"></CodeLine>
<Link id="l00398" /><CodeLine lineNumber="398"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#ab1c14aaffa1b779ce5a92c7dcc05f82e">getUsedByIndices</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00399" /><CodeLine lineNumber="399"></CodeLine>
<Link id="l00400" /><CodeLine lineNumber="400"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a14ad095be362f7dd688c153d7ba9a175">clear</a>();</span></CodeLine>
<Link id="l00401" /><CodeLine lineNumber="401"></CodeLine>
<Link id="l00402" /><CodeLine lineNumber="402" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a21aba04f31017f55f43d2e7cf3c1c1bf"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a21aba04f31017f55f43d2e7cf3c1c1bf">iterator</a> = <a href="/docs/api/classes/llvm/smallvectorimpl/#ac5b936169badf0b703567eb960278648">SmallVectorImpl&lt;const SCEV &#42;&gt;::iterator</a>;</span></CodeLine>
<Link id="l00403" /><CodeLine lineNumber="403" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a5a0d256358eb9a6994ec926a8cd18274"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a5a0d256358eb9a6994ec926a8cd18274">const&#95;iterator</a> = <a href="/docs/api/classes/llvm/smallvectorimpl/#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;const SCEV &#42;&gt;::const&#95;iterator</a>;</span></CodeLine>
<Link id="l00404" /><CodeLine lineNumber="404"></CodeLine>
<Link id="l00405" /><CodeLine lineNumber="405" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a24db856ac6d50aff7b2ab43995f15d6d"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a21aba04f31017f55f43d2e7cf3c1c1bf">iterator</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a24db856ac6d50aff7b2ab43995f15d6d">begin</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> RegSequence.begin(); &#125;</span></CodeLine>
<Link id="l00406" /><CodeLine lineNumber="406" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a83e3936deef3bb1c920cb7c38a550a54"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a21aba04f31017f55f43d2e7cf3c1c1bf">iterator</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a83e3936deef3bb1c920cb7c38a550a54">end</a>()   &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> RegSequence.end(); &#125;</span></CodeLine>
<Link id="l00407" /><CodeLine lineNumber="407" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a7c7496da55decd93c55e294066609e5f"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a5a0d256358eb9a6994ec926a8cd18274">const&#95;iterator</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a7c7496da55decd93c55e294066609e5f">begin</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> RegSequence.begin(); &#125;</span></CodeLine>
<Link id="l00408" /><CodeLine lineNumber="408" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a70480517636076003c44cb6107ea0d70"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a5a0d256358eb9a6994ec926a8cd18274">const&#95;iterator</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a70480517636076003c44cb6107ea0d70">end</a>()</span><span class="doxyHighlightKeyword"> const   </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> RegSequence.end(); &#125;</span></CodeLine>
<Link id="l00409" /><CodeLine lineNumber="409"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00410" /><CodeLine lineNumber="410"></CodeLine>
<Link id="l00411" /><CodeLine lineNumber="411"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l00412" /><CodeLine lineNumber="412"></CodeLine>
<Link id="l00413" /><CodeLine lineNumber="413"><span class="doxyHighlightKeywordType">void</span></CodeLine>
<Link id="l00414" /><CodeLine lineNumber="414" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a13a5af062b4806f2bd27402b3c6d96ff"><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a13a5af062b4806f2bd27402b3c6d96ff">RegUseTracker::countRegister</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx) &#123;</span></CodeLine>
<Link id="l00415" /><CodeLine lineNumber="415"><span class="doxyHighlight">  std::pair&lt;RegUsesTy::iterator, bool&gt; Pair =</span></CodeLine>
<Link id="l00416" /><CodeLine lineNumber="416"><span class="doxyHighlight">    RegUsesMap.insert(std::make&#95;pair(Reg, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a>()));</span></CodeLine>
<Link id="l00417" /><CodeLine lineNumber="417"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a> &amp;RSD = Pair.first-&gt;second;</span></CodeLine>
<Link id="l00418" /><CodeLine lineNumber="418"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Pair.second)</span></CodeLine>
<Link id="l00419" /><CodeLine lineNumber="419"><span class="doxyHighlight">    RegSequence.push&#95;back(Reg);</span></CodeLine>
<Link id="l00420" /><CodeLine lineNumber="420"><span class="doxyHighlight">  RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#aa79d9a55d612eb330a0e25dc4170470d">resize</a>(std::max(RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>(), LUIdx + 1));</span></CodeLine>
<Link id="l00421" /><CodeLine lineNumber="421"><span class="doxyHighlight">  RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#a18e2d7efe05987370dc6b5c54797fcf5">set</a>(LUIdx);</span></CodeLine>
<Link id="l00422" /><CodeLine lineNumber="422"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00423" /><CodeLine lineNumber="423"></CodeLine>
<Link id="l00424" /><CodeLine lineNumber="424"><span class="doxyHighlightKeywordType">void</span></CodeLine>
<Link id="l00425" /><CodeLine lineNumber="425" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a6a56d58ef201c3111c594b541bfef549"><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a6a56d58ef201c3111c594b541bfef549">RegUseTracker::dropRegister</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx) &#123;</span></CodeLine>
<Link id="l00426" /><CodeLine lineNumber="426"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemapbase/#a214e872d61db2ea8cb023f127cafd0b9">RegUsesTy::iterator</a> It = RegUsesMap.find(Reg);</span></CodeLine>
<Link id="l00427" /><CodeLine lineNumber="427"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It != RegUsesMap.end());</span></CodeLine>
<Link id="l00428" /><CodeLine lineNumber="428"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata">RegSortData</a> &amp;RSD = It-&gt;second;</span></CodeLine>
<Link id="l00429" /><CodeLine lineNumber="429"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>() &gt; LUIdx);</span></CodeLine>
<Link id="l00430" /><CodeLine lineNumber="430"><span class="doxyHighlight">  RSD.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regsortdata/#ac7bab4893aaf1c5f94c9087c69d79534">UsedByIndices</a>.<a href="/docs/api/classes/llvm/smallbitvector/#af1232d0679de538d35381496f43e303a">reset</a>(LUIdx);</span></CodeLine>
<Link id="l00431" /><CodeLine lineNumber="431"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00432" /><CodeLine lineNumber="432"></CodeLine>
<Link id="l00433" /><CodeLine lineNumber="433"><span class="doxyHighlightKeywordType">void</span></CodeLine>
<Link id="l00434" /><CodeLine lineNumber="434" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a3eb3a081cacc38c1381cf09b9bb18896"><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a3eb3a081cacc38c1381cf09b9bb18896">RegUseTracker::swapAndDropUse</a>(</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LastLUIdx) &#123;</span></CodeLine>
<Link id="l00435" /><CodeLine lineNumber="435"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LUIdx &lt;= LastLUIdx);</span></CodeLine>
<Link id="l00436" /><CodeLine lineNumber="436"></CodeLine>
<Link id="l00437" /><CodeLine lineNumber="437"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Update RegUses. The data structure is not optimized for this purpose;</span></CodeLine>
<Link id="l00438" /><CodeLine lineNumber="438"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// we must iterate through it and update each of the bit vectors.</span></CodeLine>
<Link id="l00439" /><CodeLine lineNumber="439"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Pair : RegUsesMap) &#123;</span></CodeLine>
<Link id="l00440" /><CodeLine lineNumber="440"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = Pair.second.UsedByIndices;</span></CodeLine>
<Link id="l00441" /><CodeLine lineNumber="441"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LUIdx &lt; UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>())</span></CodeLine>
<Link id="l00442" /><CodeLine lineNumber="442"><span class="doxyHighlight">      UsedByIndices&#91;LUIdx&#93; =</span></CodeLine>
<Link id="l00443" /><CodeLine lineNumber="443"><span class="doxyHighlight">        LastLUIdx &lt; UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>() ? UsedByIndices&#91;LastLUIdx&#93; : </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00444" /><CodeLine lineNumber="444"><span class="doxyHighlight">    UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#aa79d9a55d612eb330a0e25dc4170470d">resize</a>(std::min(UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#aa4dce99d953b67f83ef932810a44e21f">size</a>(), LastLUIdx));</span></CodeLine>
<Link id="l00445" /><CodeLine lineNumber="445"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00446" /><CodeLine lineNumber="446"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00447" /><CodeLine lineNumber="447"></CodeLine>
<Link id="l00448" /><CodeLine lineNumber="448"><span class="doxyHighlightKeywordType">bool</span></CodeLine>
<Link id="l00449" /><CodeLine lineNumber="449" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8"><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8">RegUseTracker::isRegUsedByUsesOtherThan</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00450" /><CodeLine lineNumber="450"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemapbase/#a5784c312872bef21d9344dae0a0e8fc0">RegUsesTy::const&#95;iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = RegUsesMap.find(Reg);</span></CodeLine>
<Link id="l00451" /><CodeLine lineNumber="451"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> == RegUsesMap.end())</span></CodeLine>
<Link id="l00452" /><CodeLine lineNumber="452"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00453" /><CodeLine lineNumber="453"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;second.UsedByIndices;</span></CodeLine>
<Link id="l00454" /><CodeLine lineNumber="454"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> i = UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#a12297e7775aa1fc62fbea882aef623fc">find&#95;first</a>();</span></CodeLine>
<Link id="l00455" /><CodeLine lineNumber="455"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i == -1) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00456" /><CodeLine lineNumber="456"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight">)i != LUIdx) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00457" /><CodeLine lineNumber="457"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#a823f7f9343d9bb1e02104ae3b2d3edb9">find&#95;next</a>(i) != -1;</span></CodeLine>
<Link id="l00458" /><CodeLine lineNumber="458"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00459" /><CodeLine lineNumber="459"></CodeLine>
<Link id="l00460" /><CodeLine lineNumber="460" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#ab1c14aaffa1b779ce5a92c7dcc05f82e"><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#ab1c14aaffa1b779ce5a92c7dcc05f82e">RegUseTracker::getUsedByIndices</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00461" /><CodeLine lineNumber="461"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemapbase/#a5784c312872bef21d9344dae0a0e8fc0">RegUsesTy::const&#95;iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = RegUsesMap.find(Reg);</span></CodeLine>
<Link id="l00462" /><CodeLine lineNumber="462"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != RegUsesMap.end() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Unknown register!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00463" /><CodeLine lineNumber="463"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;second.UsedByIndices;</span></CodeLine>
<Link id="l00464" /><CodeLine lineNumber="464"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00465" /><CodeLine lineNumber="465"></CodeLine>
<Link id="l00466" /><CodeLine lineNumber="466" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a14ad095be362f7dd688c153d7ba9a175"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a14ad095be362f7dd688c153d7ba9a175">RegUseTracker::clear</a>() &#123;</span></CodeLine>
<Link id="l00467" /><CodeLine lineNumber="467"><span class="doxyHighlight">  RegUsesMap.clear();</span></CodeLine>
<Link id="l00468" /><CodeLine lineNumber="468"><span class="doxyHighlight">  RegSequence.clear();</span></CodeLine>
<Link id="l00469" /><CodeLine lineNumber="469"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00470" /><CodeLine lineNumber="470"></CodeLine>
<Link id="l00471" /><CodeLine lineNumber="471"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00472" /><CodeLine lineNumber="472"></CodeLine>
<Link id="l00473" /><CodeLine lineNumber="473"><span class="doxyHighlightComment">/// This class holds information that describes a formula for computing</span></CodeLine>
<Link id="l00474" /><CodeLine lineNumber="474"><span class="doxyHighlightComment">/// satisfying a use. It may include broken-out immediates and scaled registers.</span></CodeLine>
<Link id="l00475" /><CodeLine lineNumber="475" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a0d4735864020dc6d7bef7067c9a16a3d">Formula</a> &#123;</span></CodeLine>
<Link id="l00476" /><CodeLine lineNumber="476"><span class="doxyHighlightComment">  /// Global base address used for complex addressing.</span></CodeLine>
<Link id="l00477" /><CodeLine lineNumber="477" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00478" /><CodeLine lineNumber="478"></CodeLine>
<Link id="l00479" /><CodeLine lineNumber="479"><span class="doxyHighlightComment">  /// Base offset for complex addressing.</span></CodeLine>
<Link id="l00480" /><CodeLine lineNumber="480" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152">BaseOffset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</span></CodeLine>
<Link id="l00481" /><CodeLine lineNumber="481"></CodeLine>
<Link id="l00482" /><CodeLine lineNumber="482"><span class="doxyHighlightComment">  /// Whether any complex addressing has a base register.</span></CodeLine>
<Link id="l00483" /><CodeLine lineNumber="483" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00484" /><CodeLine lineNumber="484"></CodeLine>
<Link id="l00485" /><CodeLine lineNumber="485"><span class="doxyHighlightComment">  /// The scale of any complex addressing.</span></CodeLine>
<Link id="l00486" /><CodeLine lineNumber="486" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48"><span class="doxyHighlight">  int64&#95;t <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> = 0;</span></CodeLine>
<Link id="l00487" /><CodeLine lineNumber="487"></CodeLine>
<Link id="l00488" /><CodeLine lineNumber="488"><span class="doxyHighlightComment">  /// The list of &quot;base&quot; registers for this use. When this is non-empty. The</span></CodeLine>
<Link id="l00489" /><CodeLine lineNumber="489"><span class="doxyHighlightComment">  /// canonical representation of a formula is</span></CodeLine>
<Link id="l00490" /><CodeLine lineNumber="490"><span class="doxyHighlightComment">  /// 1 BaseRegs.size &gt; 1 implies ScaledReg != NULL and</span></CodeLine>
<Link id="l00491" /><CodeLine lineNumber="491"><span class="doxyHighlightComment">  /// 2 ScaledReg != NULL implies Scale != 1 || !BaseRegs.empty().</span></CodeLine>
<Link id="l00492" /><CodeLine lineNumber="492"><span class="doxyHighlightComment">  /// 3 The reg containing recurrent expr related with currect loop in the</span></CodeLine>
<Link id="l00493" /><CodeLine lineNumber="493"><span class="doxyHighlightComment">  /// formula should be put in the ScaledReg.</span></CodeLine>
<Link id="l00494" /><CodeLine lineNumber="494"><span class="doxyHighlightComment">  /// #1 enforces that the scaled register is always used when at least two</span></CodeLine>
<Link id="l00495" /><CodeLine lineNumber="495"><span class="doxyHighlightComment">  /// registers are needed by the formula: e.g., reg1 + reg2 is reg1 + 1 &#42; reg2.</span></CodeLine>
<Link id="l00496" /><CodeLine lineNumber="496"><span class="doxyHighlightComment">  /// #2 enforces that 1 &#42; reg is reg.</span></CodeLine>
<Link id="l00497" /><CodeLine lineNumber="497"><span class="doxyHighlightComment">  /// #3 ensures invariant regs with respect to current loop can be combined</span></CodeLine>
<Link id="l00498" /><CodeLine lineNumber="498"><span class="doxyHighlightComment">  /// together in LSR codegen.</span></CodeLine>
<Link id="l00499" /><CodeLine lineNumber="499"><span class="doxyHighlightComment">  /// This invariant can be temporarily broken while building a formula.</span></CodeLine>
<Link id="l00500" /><CodeLine lineNumber="500"><span class="doxyHighlightComment">  /// However, every formula inserted into the LSRInstance must be in canonical</span></CodeLine>
<Link id="l00501" /><CodeLine lineNumber="501"><span class="doxyHighlightComment">  /// form.</span></CodeLine>
<Link id="l00502" /><CodeLine lineNumber="502" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>;</span></CodeLine>
<Link id="l00503" /><CodeLine lineNumber="503"></CodeLine>
<Link id="l00504" /><CodeLine lineNumber="504"><span class="doxyHighlightComment">  /// The &#39;scaled&#39; register for this use. This should be non-null when Scale is</span></CodeLine>
<Link id="l00505" /><CodeLine lineNumber="505"><span class="doxyHighlightComment">  /// not zero.</span></CodeLine>
<Link id="l00506" /><CodeLine lineNumber="506" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00507" /><CodeLine lineNumber="507"></CodeLine>
<Link id="l00508" /><CodeLine lineNumber="508"><span class="doxyHighlightComment">  /// An additional constant offset which added near the use. This requires a</span></CodeLine>
<Link id="l00509" /><CodeLine lineNumber="509"><span class="doxyHighlightComment">  /// temporary register, but the offset itself can live in an add immediate</span></CodeLine>
<Link id="l00510" /><CodeLine lineNumber="510"><span class="doxyHighlightComment">  /// field rather than a register.</span></CodeLine>
<Link id="l00511" /><CodeLine lineNumber="511" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3">UnfoldedOffset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</span></CodeLine>
<Link id="l00512" /><CodeLine lineNumber="512"></CodeLine>
<Link id="l00513" /><CodeLine lineNumber="513" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a0d4735864020dc6d7bef7067c9a16a3d"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a0d4735864020dc6d7bef7067c9a16a3d">Formula</a>() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00514" /><CodeLine lineNumber="514"></CodeLine>
<Link id="l00515" /><CodeLine lineNumber="515"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5e104e7ceecb5b2eddfc08e66e925c09">initialMatch</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE);</span></CodeLine>
<Link id="l00516" /><CodeLine lineNumber="516"></CodeLine>
<Link id="l00517" /><CodeLine lineNumber="517"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/ir/debuginfometadata-cpp/#a97d418be7ec7fc90283cc2fee34599ce">isCanonical</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00518" /><CodeLine lineNumber="518"></CodeLine>
<Link id="l00519" /><CodeLine lineNumber="519"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aef242a2293780c65ed1974184bc17193">canonicalize</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L);</span></CodeLine>
<Link id="l00520" /><CodeLine lineNumber="520"></CodeLine>
<Link id="l00521" /><CodeLine lineNumber="521"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad02fff210996fa6f08b890aabf0f10ca">unscale</a>();</span></CodeLine>
<Link id="l00522" /><CodeLine lineNumber="522"></CodeLine>
<Link id="l00523" /><CodeLine lineNumber="523"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2fab594af348068066d23af810379fff">hasZeroEnd</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00524" /><CodeLine lineNumber="524"></CodeLine>
<Link id="l00525" /><CodeLine lineNumber="525"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a326e8d43b798acbc2b57c0ed8573b492">getNumRegs</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00526" /><CodeLine lineNumber="526"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/files/lib/lib/object/tapifile-cpp/#a913a691648e20063bbd278e8f02d8430">getType</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00527" /><CodeLine lineNumber="527"></CodeLine>
<Link id="l00528" /><CodeLine lineNumber="528"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a3ae8c31aeebb77960343a102ce36adcb">deleteBaseReg</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;S);</span></CodeLine>
<Link id="l00529" /><CodeLine lineNumber="529"></CodeLine>
<Link id="l00530" /><CodeLine lineNumber="530"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7984ece4636cc86706ac5bdfefe3bc6d">referencesReg</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00531" /><CodeLine lineNumber="531"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a98e7bf1bb1d9378c9867e4168a7bfa89">hasRegsUsedByUsesOtherThan</a>(</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l00532" /><CodeLine lineNumber="532"><span class="doxyHighlight">                                  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &amp;RegUses) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00533" /><CodeLine lineNumber="533"></CodeLine>
<Link id="l00534" /><CodeLine lineNumber="534"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00535" /><CodeLine lineNumber="535"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00536" /><CodeLine lineNumber="536"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00537" /><CodeLine lineNumber="537"></CodeLine>
<Link id="l00538" /><CodeLine lineNumber="538"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l00539" /><CodeLine lineNumber="539"></CodeLine>
<Link id="l00540" /><CodeLine lineNumber="540"><span class="doxyHighlightComment">/// Recursion helper for initialMatch.</span></CodeLine>
<Link id="l00541" /><CodeLine lineNumber="541" lineLink="#aa59a46776e15b1f1bd597c4e1e769f59"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L,</span></CodeLine>
<Link id="l00542" /><CodeLine lineNumber="542"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const SCEV &#42;&gt;</a> &amp;Good,</span></CodeLine>
<Link id="l00543" /><CodeLine lineNumber="543"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const SCEV &#42;&gt;</a> &amp;Bad,</span></CodeLine>
<Link id="l00544" /><CodeLine lineNumber="544"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l00545" /><CodeLine lineNumber="545"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Collect expressions which properly dominate the loop header.</span></CodeLine>
<Link id="l00546" /><CodeLine lineNumber="546"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.<a href="/docs/api/classes/llvm/scalarevolution/#ae0d036af111b8aafe90db0771b8e9ce3">properlyDominates</a>(S, L-&gt;getHeader())) &#123;</span></CodeLine>
<Link id="l00547" /><CodeLine lineNumber="547"><span class="doxyHighlight">    Good.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(S);</span></CodeLine>
<Link id="l00548" /><CodeLine lineNumber="548"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00549" /><CodeLine lineNumber="549"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00550" /><CodeLine lineNumber="550"></CodeLine>
<Link id="l00551" /><CodeLine lineNumber="551"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Look at add operands.</span></CodeLine>
<Link id="l00552" /><CodeLine lineNumber="552"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l00553" /><CodeLine lineNumber="553"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands())</span></CodeLine>
<Link id="l00554" /><CodeLine lineNumber="554"><span class="doxyHighlight">      <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(S, L, Good, Bad, SE);</span></CodeLine>
<Link id="l00555" /><CodeLine lineNumber="555"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00556" /><CodeLine lineNumber="556"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00557" /><CodeLine lineNumber="557"></CodeLine>
<Link id="l00558" /><CodeLine lineNumber="558"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Look at addrec operands.</span></CodeLine>
<Link id="l00559" /><CodeLine lineNumber="559"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S))</span></CodeLine>
<Link id="l00560" /><CodeLine lineNumber="560"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!AR-&gt;getStart()-&gt;isZero() &amp;&amp; AR-&gt;isAffine()) &#123;</span></CodeLine>
<Link id="l00561" /><CodeLine lineNumber="561"><span class="doxyHighlight">      <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(AR-&gt;getStart(), L, Good, Bad, SE);</span></CodeLine>
<Link id="l00562" /><CodeLine lineNumber="562"><span class="doxyHighlight">      <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(AR-&gt;getType(), 0),</span></CodeLine>
<Link id="l00563" /><CodeLine lineNumber="563"><span class="doxyHighlight">                                      AR-&gt;getStepRecurrence(SE),</span></CodeLine>
<Link id="l00564" /><CodeLine lineNumber="564"><span class="doxyHighlight">                                      </span><span class="doxyHighlightComment">// FIXME: AR-&gt;getNoWrapFlags()</span></CodeLine>
<Link id="l00565" /><CodeLine lineNumber="565"><span class="doxyHighlight">                                      AR-&gt;getLoop(), <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>),</span></CodeLine>
<Link id="l00566" /><CodeLine lineNumber="566"><span class="doxyHighlight">                     L, Good, Bad, SE);</span></CodeLine>
<Link id="l00567" /><CodeLine lineNumber="567"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00568" /><CodeLine lineNumber="568"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00569" /><CodeLine lineNumber="569"></CodeLine>
<Link id="l00570" /><CodeLine lineNumber="570"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Handle a multiplication by -1 (negation) if it didn&#39;t fold.</span></CodeLine>
<Link id="l00571" /><CodeLine lineNumber="571"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S))</span></CodeLine>
<Link id="l00572" /><CodeLine lineNumber="572"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(0)-&gt;isAllOnesValue()) &#123;</span></CodeLine>
<Link id="l00573" /><CodeLine lineNumber="573"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>(<a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">drop&#95;begin</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;operands()));</span></CodeLine>
<Link id="l00574" /><CodeLine lineNumber="574"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewMul = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>);</span></CodeLine>
<Link id="l00575" /><CodeLine lineNumber="575"></CodeLine>
<Link id="l00576" /><CodeLine lineNumber="576"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> MyGood;</span></CodeLine>
<Link id="l00577" /><CodeLine lineNumber="577"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> MyBad;</span></CodeLine>
<Link id="l00578" /><CodeLine lineNumber="578"><span class="doxyHighlight">      <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(NewMul, L, MyGood, MyBad, SE);</span></CodeLine>
<Link id="l00579" /><CodeLine lineNumber="579"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NegOne = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a href="/docs/api/classes/llvm/constant/#a4d51384de6e1798bb6aa875aebeea9f0">ConstantInt::getAllOnesValue</a>(</span></CodeLine>
<Link id="l00580" /><CodeLine lineNumber="580"><span class="doxyHighlight">        SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6dcfa69ce27cf214caaf50f21bfe1f2f">getEffectiveSCEVType</a>(NewMul-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>())));</span></CodeLine>
<Link id="l00581" /><CodeLine lineNumber="581"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : MyGood)</span></CodeLine>
<Link id="l00582" /><CodeLine lineNumber="582"><span class="doxyHighlight">        Good.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(NegOne, S));</span></CodeLine>
<Link id="l00583" /><CodeLine lineNumber="583"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : MyBad)</span></CodeLine>
<Link id="l00584" /><CodeLine lineNumber="584"><span class="doxyHighlight">        Bad.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(NegOne, S));</span></CodeLine>
<Link id="l00585" /><CodeLine lineNumber="585"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00586" /><CodeLine lineNumber="586"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00587" /><CodeLine lineNumber="587"></CodeLine>
<Link id="l00588" /><CodeLine lineNumber="588"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Ok, we can&#39;t do anything interesting. Just stuff the whole thing into a</span></CodeLine>
<Link id="l00589" /><CodeLine lineNumber="589"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// register and hope for the best.</span></CodeLine>
<Link id="l00590" /><CodeLine lineNumber="590"><span class="doxyHighlight">  Bad.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(S);</span></CodeLine>
<Link id="l00591" /><CodeLine lineNumber="591"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00592" /><CodeLine lineNumber="592"></CodeLine>
<Link id="l00593" /><CodeLine lineNumber="593"><span class="doxyHighlightComment">/// Incorporate loop-variant parts of S into this Formula, attempting to keep</span></CodeLine>
<Link id="l00594" /><CodeLine lineNumber="594"><span class="doxyHighlightComment">/// all loop-invariant and loop-computable values in a single base register.</span></CodeLine>
<Link id="l00595" /><CodeLine lineNumber="595" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5e104e7ceecb5b2eddfc08e66e925c09"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5e104e7ceecb5b2eddfc08e66e925c09">Formula::initialMatch</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l00596" /><CodeLine lineNumber="596"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> Good;</span></CodeLine>
<Link id="l00597" /><CodeLine lineNumber="597"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> Bad;</span></CodeLine>
<Link id="l00598" /><CodeLine lineNumber="598"><span class="doxyHighlight">  <a href="#aa59a46776e15b1f1bd597c4e1e769f59">DoInitialMatch</a>(S, L, Good, Bad, SE);</span></CodeLine>
<Link id="l00599" /><CodeLine lineNumber="599"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Good.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l00600" /><CodeLine lineNumber="600"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Sum = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(Good);</span></CodeLine>
<Link id="l00601" /><CodeLine lineNumber="601"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Sum-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</span></CodeLine>
<Link id="l00602" /><CodeLine lineNumber="602"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.push&#95;back(Sum);</span></CodeLine>
<Link id="l00603" /><CodeLine lineNumber="603"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00604" /><CodeLine lineNumber="604"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00605" /><CodeLine lineNumber="605"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Bad.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l00606" /><CodeLine lineNumber="606"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Sum = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(Bad);</span></CodeLine>
<Link id="l00607" /><CodeLine lineNumber="607"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Sum-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</span></CodeLine>
<Link id="l00608" /><CodeLine lineNumber="608"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.push&#95;back(Sum);</span></CodeLine>
<Link id="l00609" /><CodeLine lineNumber="609"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00610" /><CodeLine lineNumber="610"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00611" /><CodeLine lineNumber="611"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aef242a2293780c65ed1974184bc17193">canonicalize</a>(&#42;L);</span></CodeLine>
<Link id="l00612" /><CodeLine lineNumber="612"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00613" /><CodeLine lineNumber="613"></CodeLine>
<Link id="l00614" /><CodeLine lineNumber="614" lineLink="#a1fb9d2e9aea7544f9453aa3e2df38109"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</span></CodeLine>
<Link id="l00615" /><CodeLine lineNumber="615"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#affb88623037a9864e030154052747ba1">SCEVExprContains</a>(S, &#91;&amp;L&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</span></CodeLine>
<Link id="l00616" /><CodeLine lineNumber="616"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(S) &amp;&amp; (<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(S)-&gt;getLoop() == &amp;L);</span></CodeLine>
<Link id="l00617" /><CodeLine lineNumber="617"><span class="doxyHighlight">  &#125;);</span></CodeLine>
<Link id="l00618" /><CodeLine lineNumber="618"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00619" /><CodeLine lineNumber="619"></CodeLine>
<Link id="l00620" /><CodeLine lineNumber="620"><span class="doxyHighlightComment">/// Check whether or not this formula satisfies the canonical</span></CodeLine>
<Link id="l00621" /><CodeLine lineNumber="621"><span class="doxyHighlightComment">/// representation.</span></CodeLine>
<Link id="l00622" /><CodeLine lineNumber="622"><span class="doxyHighlightComment">/// \\see Formula::BaseRegs.</span></CodeLine>
<Link id="l00623" /><CodeLine lineNumber="623" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a315b16382757c50cd6c367fb26e1b15b"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a315b16382757c50cd6c367fb26e1b15b">Formula::isCanonical</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00624" /><CodeLine lineNumber="624"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> == 0 || <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>) &amp;&amp;</span></CodeLine>
<Link id="l00625" /><CodeLine lineNumber="625"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;ScaledReg must be non-null if Scale is non-zero&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00626" /><CodeLine lineNumber="626"></CodeLine>
<Link id="l00627" /><CodeLine lineNumber="627"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>)</span></CodeLine>
<Link id="l00628" /><CodeLine lineNumber="628"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.size() &lt;= 1;</span></CodeLine>
<Link id="l00629" /><CodeLine lineNumber="629"></CodeLine>
<Link id="l00630" /><CodeLine lineNumber="630"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> != 1)</span></CodeLine>
<Link id="l00631" /><CodeLine lineNumber="631"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00632" /><CodeLine lineNumber="632"></CodeLine>
<Link id="l00633" /><CodeLine lineNumber="633"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> == 1 &amp;&amp; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty())</span></CodeLine>
<Link id="l00634" /><CodeLine lineNumber="634"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00635" /><CodeLine lineNumber="635"></CodeLine>
<Link id="l00636" /><CodeLine lineNumber="636"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>, L))</span></CodeLine>
<Link id="l00637" /><CodeLine lineNumber="637"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00638" /><CodeLine lineNumber="638"></CodeLine>
<Link id="l00639" /><CodeLine lineNumber="639"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If ScaledReg is not a recurrent expr, or it is but its loop is not current</span></CodeLine>
<Link id="l00640" /><CodeLine lineNumber="640"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// loop, meanwhile BaseRegs contains a recurrent expr reg related with current</span></CodeLine>
<Link id="l00641" /><CodeLine lineNumber="641"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// loop, we want to swap the reg in BaseRegs with ScaledReg.</span></CodeLine>
<Link id="l00642" /><CodeLine lineNumber="642"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a7dc3069afa2ce5ea62ac2eb183e51c00">none&#95;of</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>, &#91;&amp;L&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</span></CodeLine>
<Link id="l00643" /><CodeLine lineNumber="643"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(S, L);</span></CodeLine>
<Link id="l00644" /><CodeLine lineNumber="644"><span class="doxyHighlight">  &#125;);</span></CodeLine>
<Link id="l00645" /><CodeLine lineNumber="645"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00646" /><CodeLine lineNumber="646"></CodeLine>
<Link id="l00647" /><CodeLine lineNumber="647"><span class="doxyHighlightComment">/// Helper method to morph a formula into its canonical representation.</span></CodeLine>
<Link id="l00648" /><CodeLine lineNumber="648"><span class="doxyHighlightComment">/// \\see Formula::BaseRegs.</span></CodeLine>
<Link id="l00649" /><CodeLine lineNumber="649"><span class="doxyHighlightComment">/// Every formula having more than one base register, must use the ScaledReg</span></CodeLine>
<Link id="l00650" /><CodeLine lineNumber="650"><span class="doxyHighlightComment">/// field. Otherwise, we would have to do special cases everywhere in LSR</span></CodeLine>
<Link id="l00651" /><CodeLine lineNumber="651"><span class="doxyHighlightComment">/// to treat reg1 + reg2 + ... the same way as reg1 + 1&#42;reg2 + ...</span></CodeLine>
<Link id="l00652" /><CodeLine lineNumber="652"><span class="doxyHighlightComment">/// On the other hand, 1&#42;reg should be canonicalized into reg.</span></CodeLine>
<Link id="l00653" /><CodeLine lineNumber="653" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aef242a2293780c65ed1974184bc17193"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aef242a2293780c65ed1974184bc17193">Formula::canonicalize</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</span></CodeLine>
<Link id="l00654" /><CodeLine lineNumber="654"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/ir/debuginfometadata-cpp/#a97d418be7ec7fc90283cc2fee34599ce">isCanonical</a>(L))</span></CodeLine>
<Link id="l00655" /><CodeLine lineNumber="655"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00656" /><CodeLine lineNumber="656"></CodeLine>
<Link id="l00657" /><CodeLine lineNumber="657"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty()) &#123;</span></CodeLine>
<Link id="l00658" /><CodeLine lineNumber="658"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// No base reg? Use scale reg with scale = 1 as such.</span></CodeLine>
<Link id="l00659" /><CodeLine lineNumber="659"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Expected 1&#42;reg =&gt; reg&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00660" /><CodeLine lineNumber="660"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> == 1 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Expected 1&#42;reg =&gt; reg&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00661" /><CodeLine lineNumber="661"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.push&#95;back(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>);</span></CodeLine>
<Link id="l00662" /><CodeLine lineNumber="662"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> = 0;</span></CodeLine>
<Link id="l00663" /><CodeLine lineNumber="663"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00664" /><CodeLine lineNumber="664"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00665" /><CodeLine lineNumber="665"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00666" /><CodeLine lineNumber="666"></CodeLine>
<Link id="l00667" /><CodeLine lineNumber="667"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Keep the invariant sum in BaseRegs and one of the variant sum in ScaledReg.</span></CodeLine>
<Link id="l00668" /><CodeLine lineNumber="668"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>) &#123;</span></CodeLine>
<Link id="l00669" /><CodeLine lineNumber="669"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.pop&#95;back&#95;val();</span></CodeLine>
<Link id="l00670" /><CodeLine lineNumber="670"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> = 1;</span></CodeLine>
<Link id="l00671" /><CodeLine lineNumber="671"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00672" /><CodeLine lineNumber="672"></CodeLine>
<Link id="l00673" /><CodeLine lineNumber="673"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If ScaledReg is an invariant with respect to L, find the reg from</span></CodeLine>
<Link id="l00674" /><CodeLine lineNumber="674"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// BaseRegs containing the recurrent expr related with Loop L. Swap the</span></CodeLine>
<Link id="l00675" /><CodeLine lineNumber="675"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// reg with ScaledReg.</span></CodeLine>
<Link id="l00676" /><CodeLine lineNumber="676"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>, L)) &#123;</span></CodeLine>
<Link id="l00677" /><CodeLine lineNumber="677"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/#ac78c09ae232b2ce188ff590d51e3c268">find&#95;if</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>, &#91;&amp;L&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</span></CodeLine>
<Link id="l00678" /><CodeLine lineNumber="678"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a1fb9d2e9aea7544f9453aa3e2df38109">containsAddRecDependentOnLoop</a>(S, L);</span></CodeLine>
<Link id="l00679" /><CodeLine lineNumber="679"><span class="doxyHighlight">    &#125;);</span></CodeLine>
<Link id="l00680" /><CodeLine lineNumber="680"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.end())</span></CodeLine>
<Link id="l00681" /><CodeLine lineNumber="681"><span class="doxyHighlight">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>, &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l00682" /><CodeLine lineNumber="682"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00683" /><CodeLine lineNumber="683"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/ir/debuginfometadata-cpp/#a97d418be7ec7fc90283cc2fee34599ce">isCanonical</a>(L) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Failed to canonicalize?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00684" /><CodeLine lineNumber="684"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00685" /><CodeLine lineNumber="685"></CodeLine>
<Link id="l00686" /><CodeLine lineNumber="686"><span class="doxyHighlightComment">/// Get rid of the scale in the formula.</span></CodeLine>
<Link id="l00687" /><CodeLine lineNumber="687"><span class="doxyHighlightComment">/// In other words, this method morphes reg1 + 1&#42;reg2 into reg1 + reg2.</span></CodeLine>
<Link id="l00688" /><CodeLine lineNumber="688"><span class="doxyHighlightComment">/// \\return true if it was possible to get rid of the scale, false otherwise.</span></CodeLine>
<Link id="l00689" /><CodeLine lineNumber="689"><span class="doxyHighlightComment">/// \\note After this operation the formula may not be in the canonical form.</span></CodeLine>
<Link id="l00690" /><CodeLine lineNumber="690" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad02fff210996fa6f08b890aabf0f10ca"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad02fff210996fa6f08b890aabf0f10ca">Formula::unscale</a>() &#123;</span></CodeLine>
<Link id="l00691" /><CodeLine lineNumber="691"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> != 1)</span></CodeLine>
<Link id="l00692" /><CodeLine lineNumber="692"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00693" /><CodeLine lineNumber="693"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> = 0;</span></CodeLine>
<Link id="l00694" /><CodeLine lineNumber="694"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.push&#95;back(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>);</span></CodeLine>
<Link id="l00695" /><CodeLine lineNumber="695"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00696" /><CodeLine lineNumber="696"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00697" /><CodeLine lineNumber="697"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00698" /><CodeLine lineNumber="698"></CodeLine>
<Link id="l00699" /><CodeLine lineNumber="699" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2fab594af348068066d23af810379fff"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2fab594af348068066d23af810379fff">Formula::hasZeroEnd</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00700" /><CodeLine lineNumber="700"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3">UnfoldedOffset</a> || <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152">BaseOffset</a>)</span></CodeLine>
<Link id="l00701" /><CodeLine lineNumber="701"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00702" /><CodeLine lineNumber="702"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.size() != 1 || <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>)</span></CodeLine>
<Link id="l00703" /><CodeLine lineNumber="703"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00704" /><CodeLine lineNumber="704"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00705" /><CodeLine lineNumber="705"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00706" /><CodeLine lineNumber="706"></CodeLine>
<Link id="l00707" /><CodeLine lineNumber="707"><span class="doxyHighlightComment">/// Return the total number of register operands used by this formula. This does</span></CodeLine>
<Link id="l00708" /><CodeLine lineNumber="708"><span class="doxyHighlightComment">/// not include register uses implied by non-constant addrec strides.</span></CodeLine>
<Link id="l00709" /><CodeLine lineNumber="709" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a326e8d43b798acbc2b57c0ed8573b492"><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a326e8d43b798acbc2b57c0ed8573b492">Formula::getNumRegs</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00710" /><CodeLine lineNumber="710"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> + <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.size();</span></CodeLine>
<Link id="l00711" /><CodeLine lineNumber="711"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00712" /><CodeLine lineNumber="712"></CodeLine>
<Link id="l00713" /><CodeLine lineNumber="713"><span class="doxyHighlightComment">/// Return the type of this formula, if it has one, or null otherwise. This type</span></CodeLine>
<Link id="l00714" /><CodeLine lineNumber="714"><span class="doxyHighlightComment">/// is meaningless except for the bit size.</span></CodeLine>
<Link id="l00715" /><CodeLine lineNumber="715" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2ee5737cd553c4eec111f7fbf9894f37"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a2ee5737cd553c4eec111f7fbf9894f37">Formula::getType</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00716" /><CodeLine lineNumber="716"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty() ? <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.front()-&gt;getType() :</span></CodeLine>
<Link id="l00717" /><CodeLine lineNumber="717"><span class="doxyHighlight">         <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> ? <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>-&gt;getType() :</span></CodeLine>
<Link id="l00718" /><CodeLine lineNumber="718"><span class="doxyHighlight">         <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a> ? <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a>-&gt;getType() :</span></CodeLine>
<Link id="l00719" /><CodeLine lineNumber="719"><span class="doxyHighlight">         </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00720" /><CodeLine lineNumber="720"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00721" /><CodeLine lineNumber="721"></CodeLine>
<Link id="l00722" /><CodeLine lineNumber="722"><span class="doxyHighlightComment">/// Delete the given base reg from the BaseRegs list.</span></CodeLine>
<Link id="l00723" /><CodeLine lineNumber="723" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a3ae8c31aeebb77960343a102ce36adcb"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a3ae8c31aeebb77960343a102ce36adcb">Formula::deleteBaseReg</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;S) &#123;</span></CodeLine>
<Link id="l00724" /><CodeLine lineNumber="724"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&amp;S != &amp;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.back())</span></CodeLine>
<Link id="l00725" /><CodeLine lineNumber="725"><span class="doxyHighlight">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(S, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.back());</span></CodeLine>
<Link id="l00726" /><CodeLine lineNumber="726"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.pop&#95;back();</span></CodeLine>
<Link id="l00727" /><CodeLine lineNumber="727"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00728" /><CodeLine lineNumber="728"></CodeLine>
<Link id="l00729" /><CodeLine lineNumber="729"><span class="doxyHighlightComment">/// Test if this formula references the given register.</span></CodeLine>
<Link id="l00730" /><CodeLine lineNumber="730" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7984ece4636cc86706ac5bdfefe3bc6d"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7984ece4636cc86706ac5bdfefe3bc6d">Formula::referencesReg</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00731" /><CodeLine lineNumber="731"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> S == <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a> || <a href="/docs/api/namespaces/llvm/#acd1cd968cb420c82d70926920fcdc7d7">is&#95;contained</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>, S);</span></CodeLine>
<Link id="l00732" /><CodeLine lineNumber="732"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00733" /><CodeLine lineNumber="733"></CodeLine>
<Link id="l00734" /><CodeLine lineNumber="734"><span class="doxyHighlightComment">/// Test whether this formula uses registers which are used by uses other than</span></CodeLine>
<Link id="l00735" /><CodeLine lineNumber="735"><span class="doxyHighlightComment">/// the use with the given index.</span></CodeLine>
<Link id="l00736" /><CodeLine lineNumber="736" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a98e7bf1bb1d9378c9867e4168a7bfa89"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a98e7bf1bb1d9378c9867e4168a7bfa89">Formula::hasRegsUsedByUsesOtherThan</a>(</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l00737" /><CodeLine lineNumber="737"><span class="doxyHighlight">                                         </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &amp;RegUses)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00738" /><CodeLine lineNumber="738"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>)</span></CodeLine>
<Link id="l00739" /><CodeLine lineNumber="739"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RegUses.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8">isRegUsedByUsesOtherThan</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>, LUIdx))</span></CodeLine>
<Link id="l00740" /><CodeLine lineNumber="740"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00741" /><CodeLine lineNumber="741"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>)</span></CodeLine>
<Link id="l00742" /><CodeLine lineNumber="742"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RegUses.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a048ddb994fd2688e1940fe34f7d706f8">isRegUsedByUsesOtherThan</a>(BaseReg, LUIdx))</span></CodeLine>
<Link id="l00743" /><CodeLine lineNumber="743"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00744" /><CodeLine lineNumber="744"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00745" /><CodeLine lineNumber="745"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00746" /><CodeLine lineNumber="746"></CodeLine>
<Link id="l00747" /><CodeLine lineNumber="747"><span class="doxyHighlightPreprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</span></CodeLine>
<Link id="l00748" /><CodeLine lineNumber="748" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ab6da05c123f7ca65ecc1163ebf739f01"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ab6da05c123f7ca65ecc1163ebf739f01">Formula::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00749" /><CodeLine lineNumber="749"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00750" /><CodeLine lineNumber="750"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a>) &#123;</span></CodeLine>
<Link id="l00751" /><CodeLine lineNumber="751"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; + &quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00752" /><CodeLine lineNumber="752"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a49a86e7759b7ea04a2a99995e9dc11b5">BaseGV</a>-&gt;printAsOperand(OS, </span><span class="doxyHighlightComment">/&#42;PrintType=&#42;/</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00753" /><CodeLine lineNumber="753"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00754" /><CodeLine lineNumber="754"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152">BaseOffset</a>.isNonZero()) &#123;</span></CodeLine>
<Link id="l00755" /><CodeLine lineNumber="755"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; + &quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00756" /><CodeLine lineNumber="756"><span class="doxyHighlight">    OS &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a7fd970b2e850c6b038ec1c331132f152">BaseOffset</a>;</span></CodeLine>
<Link id="l00757" /><CodeLine lineNumber="757"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00758" /><CodeLine lineNumber="758"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>) &#123;</span></CodeLine>
<Link id="l00759" /><CodeLine lineNumber="759"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; + &quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00760" /><CodeLine lineNumber="760"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;reg(&quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;BaseReg &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;)&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00761" /><CodeLine lineNumber="761"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00762" /><CodeLine lineNumber="762"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> &amp;&amp; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty()) &#123;</span></CodeLine>
<Link id="l00763" /><CodeLine lineNumber="763"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; + &quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00764" /><CodeLine lineNumber="764"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&#42;&#42;error: HasBaseReg&#42;&#42;&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00765" /><CodeLine lineNumber="765"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a5dd38ab56c263b0c9684cb7ad90a17b8">HasBaseReg</a> &amp;&amp; !<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#ad1246f472c53ef21f95da9e3f6b3f3c2">BaseRegs</a>.empty()) &#123;</span></CodeLine>
<Link id="l00766" /><CodeLine lineNumber="766"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; + &quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00767" /><CodeLine lineNumber="767"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&#42;&#42;error: !HasBaseReg&#42;&#42;&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00768" /><CodeLine lineNumber="768"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00769" /><CodeLine lineNumber="769"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> != 0) &#123;</span></CodeLine>
<Link id="l00770" /><CodeLine lineNumber="770"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; + &quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00771" /><CodeLine lineNumber="771"><span class="doxyHighlight">    OS &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#aa82546abf6797d53c3c4ba478ac27c48">Scale</a> &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&#42;reg(&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00772" /><CodeLine lineNumber="772"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>)</span></CodeLine>
<Link id="l00773" /><CodeLine lineNumber="773"><span class="doxyHighlight">      OS &lt;&lt; &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a10f8f397229c512b481d8067dc0111db">ScaledReg</a>;</span></CodeLine>
<Link id="l00774" /><CodeLine lineNumber="774"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00775" /><CodeLine lineNumber="775"><span class="doxyHighlight">      OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&lt;unknown&gt;&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00776" /><CodeLine lineNumber="776"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;)&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00777" /><CodeLine lineNumber="777"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00778" /><CodeLine lineNumber="778"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3">UnfoldedOffset</a>.isNonZero()) &#123;</span></CodeLine>
<Link id="l00779" /><CodeLine lineNumber="779"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; + &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00780" /><CodeLine lineNumber="780"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;imm(&quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a12e25533d4ccb07257ed404f527196b3">UnfoldedOffset</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;)&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00781" /><CodeLine lineNumber="781"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00782" /><CodeLine lineNumber="782"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00783" /><CodeLine lineNumber="783"></CodeLine>
<Link id="l00784" /><CodeLine lineNumber="784" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a376acc2ec7fd1a216d5ec9fb9f04c99a"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula/#a376acc2ec7fd1a216d5ec9fb9f04c99a">Formula::dump</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00785" /><CodeLine lineNumber="785"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00786" /><CodeLine lineNumber="786"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00787" /><CodeLine lineNumber="787"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l00788" /><CodeLine lineNumber="788"></CodeLine>
<Link id="l00789" /><CodeLine lineNumber="789"><span class="doxyHighlightComment">/// Return true if the given addrec can be sign-extended without changing its</span></CodeLine>
<Link id="l00790" /><CodeLine lineNumber="790"><span class="doxyHighlightComment">/// value.</span></CodeLine>
<Link id="l00791" /><CodeLine lineNumber="791" lineLink="#a9b6b892760677b9b11c517eb5a46557f"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a9b6b892760677b9b11c517eb5a46557f">isAddRecSExtable</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l00792" /><CodeLine lineNumber="792"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;WideTy =</span></CodeLine>
<Link id="l00793" /><CodeLine lineNumber="793"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#aff9e533399d91febd63fa4bfe82a42a7">getContext</a>(), SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>()) + 1);</span></CodeLine>
<Link id="l00794" /><CodeLine lineNumber="794"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(AR, WideTy));</span></CodeLine>
<Link id="l00795" /><CodeLine lineNumber="795"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00796" /><CodeLine lineNumber="796"></CodeLine>
<Link id="l00797" /><CodeLine lineNumber="797"><span class="doxyHighlightComment">/// Return true if the given add can be sign-extended without changing its</span></CodeLine>
<Link id="l00798" /><CodeLine lineNumber="798"><span class="doxyHighlightComment">/// value.</span></CodeLine>
<Link id="l00799" /><CodeLine lineNumber="799" lineLink="#a1509f8a0c11e955037b00ce7542e24a7"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a1509f8a0c11e955037b00ce7542e24a7">isAddSExtable</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l00800" /><CodeLine lineNumber="800"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;WideTy =</span></CodeLine>
<Link id="l00801" /><CodeLine lineNumber="801"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#aff9e533399d91febd63fa4bfe82a42a7">getContext</a>(), SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getType()) + 1);</span></CodeLine>
<Link id="l00802" /><CodeLine lineNumber="802"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, WideTy));</span></CodeLine>
<Link id="l00803" /><CodeLine lineNumber="803"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00804" /><CodeLine lineNumber="804"></CodeLine>
<Link id="l00805" /><CodeLine lineNumber="805"><span class="doxyHighlightComment">/// Return true if the given mul can be sign-extended without changing its</span></CodeLine>
<Link id="l00806" /><CodeLine lineNumber="806"><span class="doxyHighlightComment">/// value.</span></CodeLine>
<Link id="l00807" /><CodeLine lineNumber="807" lineLink="#a32cdb4a97c185f1acbe11f45fcc70d12"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a32cdb4a97c185f1acbe11f45fcc70d12">isMulSExtable</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;M, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l00808" /><CodeLine lineNumber="808"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;WideTy =</span></CodeLine>
<Link id="l00809" /><CodeLine lineNumber="809"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/integertype/#a14f7b4f1aed38192fb6b7772eb506bdb">IntegerType::get</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#aff9e533399d91febd63fa4bfe82a42a7">getContext</a>(),</span></CodeLine>
<Link id="l00810" /><CodeLine lineNumber="810"><span class="doxyHighlight">                     SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2c96114e89e8cf2122ebe8bc4d929c7c">getTypeSizeInBits</a>(M-&gt;getType()) &#42; M-&gt;getNumOperands());</span></CodeLine>
<Link id="l00811" /><CodeLine lineNumber="811"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVMulExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ab26bea71791cf347c631d2072e41cfb5">getSignExtendExpr</a>(M, WideTy));</span></CodeLine>
<Link id="l00812" /><CodeLine lineNumber="812"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00813" /><CodeLine lineNumber="813"></CodeLine>
<Link id="l00814" /><CodeLine lineNumber="814"><span class="doxyHighlightComment">/// Return an expression for LHS /s RHS, if it can be determined and if the</span></CodeLine>
<Link id="l00815" /><CodeLine lineNumber="815"><span class="doxyHighlightComment">/// remainder is known to be zero, or null otherwise. If IgnoreSignificantBits</span></CodeLine>
<Link id="l00816" /><CodeLine lineNumber="816"><span class="doxyHighlightComment">/// is true, expressions like (X &#42; Y) /s Y are simplified to X, ignoring that</span></CodeLine>
<Link id="l00817" /><CodeLine lineNumber="817"><span class="doxyHighlightComment">/// the multiplication may overflow, which is useful when the result will be</span></CodeLine>
<Link id="l00818" /><CodeLine lineNumber="818"><span class="doxyHighlightComment">/// used in a context where the most significant bits are ignored.</span></CodeLine>
<Link id="l00819" /><CodeLine lineNumber="819" lineLink="#ad0ad0c0f486f8ea43158a1227e610a9c"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</span></CodeLine>
<Link id="l00820" /><CodeLine lineNumber="820"><span class="doxyHighlight">                                <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</span></CodeLine>
<Link id="l00821" /><CodeLine lineNumber="821"><span class="doxyHighlight">                                </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IgnoreSignificantBits = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l00822" /><CodeLine lineNumber="822"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Handle the trivial case, which works for any SCEV type.</span></CodeLine>
<Link id="l00823" /><CodeLine lineNumber="823"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> == <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)</span></CodeLine>
<Link id="l00824" /><CodeLine lineNumber="824"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;getType(), 1);</span></CodeLine>
<Link id="l00825" /><CodeLine lineNumber="825"></CodeLine>
<Link id="l00826" /><CodeLine lineNumber="826"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Handle a few RHS special cases.</span></CodeLine>
<Link id="l00827" /><CodeLine lineNumber="827"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;RC = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>);</span></CodeLine>
<Link id="l00828" /><CodeLine lineNumber="828"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RC) &#123;</span></CodeLine>
<Link id="l00829" /><CodeLine lineNumber="829"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/apint">APInt</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a> = RC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a6caf7f3a0a4303e4c0bc06ed8e205126">getAPInt</a>();</span></CodeLine>
<Link id="l00830" /><CodeLine lineNumber="830"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Handle x /s -1 as x &#42; -1, to give ScalarEvolution a chance to do</span></CodeLine>
<Link id="l00831" /><CodeLine lineNumber="831"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// some folding.</span></CodeLine>
<Link id="l00832" /><CodeLine lineNumber="832"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a>.isAllOnes()) &#123;</span></CodeLine>
<Link id="l00833" /><CodeLine lineNumber="833"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;getType()-&gt;isPointerTy())</span></CodeLine>
<Link id="l00834" /><CodeLine lineNumber="834"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00835" /><CodeLine lineNumber="835"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, RC);</span></CodeLine>
<Link id="l00836" /><CodeLine lineNumber="836"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00837" /><CodeLine lineNumber="837"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Handle x /s 1 as x.</span></CodeLine>
<Link id="l00838" /><CodeLine lineNumber="838"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a> == 1)</span></CodeLine>
<Link id="l00839" /><CodeLine lineNumber="839"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>;</span></CodeLine>
<Link id="l00840" /><CodeLine lineNumber="840"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00841" /><CodeLine lineNumber="841"></CodeLine>
<Link id="l00842" /><CodeLine lineNumber="842"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check for a division of a constant by a constant.</span></CodeLine>
<Link id="l00843" /><CodeLine lineNumber="843"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) &#123;</span></CodeLine>
<Link id="l00844" /><CodeLine lineNumber="844"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!RC)</span></CodeLine>
<Link id="l00845" /><CodeLine lineNumber="845"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00846" /><CodeLine lineNumber="846"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/apint">APInt</a> &amp;LA = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt();</span></CodeLine>
<Link id="l00847" /><CodeLine lineNumber="847"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/apint">APInt</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a> = RC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a6caf7f3a0a4303e4c0bc06ed8e205126">getAPInt</a>();</span></CodeLine>
<Link id="l00848" /><CodeLine lineNumber="848"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LA.<a href="/docs/api/classes/llvm/apint/#ac131d830427393332e440e1d6e3013b6">srem</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a>) != 0)</span></CodeLine>
<Link id="l00849" /><CodeLine lineNumber="849"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00850" /><CodeLine lineNumber="850"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(LA.<a href="/docs/api/classes/llvm/apint/#a71f7f6e3a4774296efc7274196a74793">sdiv</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sioptimizeexecmaskingprera-cpp/#a3e47bdb3e296b00df96eff7896fa57bf">RA</a>));</span></CodeLine>
<Link id="l00851" /><CodeLine lineNumber="851"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00852" /><CodeLine lineNumber="852"></CodeLine>
<Link id="l00853" /><CodeLine lineNumber="853"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Distribute the sdiv over addrec operands, if the addrec doesn&#39;t overflow.</span></CodeLine>
<Link id="l00854" /><CodeLine lineNumber="854"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) &#123;</span></CodeLine>
<Link id="l00855" /><CodeLine lineNumber="855"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((IgnoreSignificantBits || <a href="#a9b6b892760677b9b11c517eb5a46557f">isAddRecSExtable</a>(AR, SE)) &amp;&amp; AR-&gt;isAffine()) &#123;</span></CodeLine>
<Link id="l00856" /><CodeLine lineNumber="856"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Step = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(AR-&gt;getStepRecurrence(SE), <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, SE,</span></CodeLine>
<Link id="l00857" /><CodeLine lineNumber="857"><span class="doxyHighlight">                                      IgnoreSignificantBits);</span></CodeLine>
<Link id="l00858" /><CodeLine lineNumber="858"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Step) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00859" /><CodeLine lineNumber="859"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Start = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(AR-&gt;getStart(), <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, SE,</span></CodeLine>
<Link id="l00860" /><CodeLine lineNumber="860"><span class="doxyHighlight">                                       IgnoreSignificantBits);</span></CodeLine>
<Link id="l00861" /><CodeLine lineNumber="861"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Start) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00862" /><CodeLine lineNumber="862"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// FlagNW is independent of the start value, step direction, and is</span></CodeLine>
<Link id="l00863" /><CodeLine lineNumber="863"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// preserved with smaller magnitude steps.</span></CodeLine>
<Link id="l00864" /><CodeLine lineNumber="864"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// FIXME: AR-&gt;getNoWrapFlags(SCEV::FlagNW)</span></CodeLine>
<Link id="l00865" /><CodeLine lineNumber="865"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(Start, Step, AR-&gt;getLoop(), <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>);</span></CodeLine>
<Link id="l00866" /><CodeLine lineNumber="866"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00867" /><CodeLine lineNumber="867"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00868" /><CodeLine lineNumber="868"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00869" /><CodeLine lineNumber="869"></CodeLine>
<Link id="l00870" /><CodeLine lineNumber="870"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Distribute the sdiv over add operands, if the add doesn&#39;t overflow.</span></CodeLine>
<Link id="l00871" /><CodeLine lineNumber="871"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) &#123;</span></CodeLine>
<Link id="l00872" /><CodeLine lineNumber="872"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IgnoreSignificantBits || <a href="#a1509f8a0c11e955037b00ce7542e24a7">isAddSExtable</a>(<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>, SE)) &#123;</span></CodeLine>
<Link id="l00873" /><CodeLine lineNumber="873"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</span></CodeLine>
<Link id="l00874" /><CodeLine lineNumber="874"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands()) &#123;</span></CodeLine>
<Link id="l00875" /><CodeLine lineNumber="875"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(S, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, SE, IgnoreSignificantBits);</span></CodeLine>
<Link id="l00876" /><CodeLine lineNumber="876"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00877" /><CodeLine lineNumber="877"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</span></CodeLine>
<Link id="l00878" /><CodeLine lineNumber="878"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00879" /><CodeLine lineNumber="879"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>);</span></CodeLine>
<Link id="l00880" /><CodeLine lineNumber="880"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00881" /><CodeLine lineNumber="881"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00882" /><CodeLine lineNumber="882"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00883" /><CodeLine lineNumber="883"></CodeLine>
<Link id="l00884" /><CodeLine lineNumber="884"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check for a multiply operand that we can pull RHS out of.</span></CodeLine>
<Link id="l00885" /><CodeLine lineNumber="885"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>)) &#123;</span></CodeLine>
<Link id="l00886" /><CodeLine lineNumber="886"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IgnoreSignificantBits || <a href="#a32cdb4a97c185f1acbe11f45fcc70d12">isMulSExtable</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>, SE)) &#123;</span></CodeLine>
<Link id="l00887" /><CodeLine lineNumber="887"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Handle special case C1&#42;X&#42;Y /s C2&#42;X&#42;Y.</span></CodeLine>
<Link id="l00888" /><CodeLine lineNumber="888"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;MulRHS = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)) &#123;</span></CodeLine>
<Link id="l00889" /><CodeLine lineNumber="889"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IgnoreSignificantBits || <a href="#a32cdb4a97c185f1acbe11f45fcc70d12">isMulSExtable</a>(MulRHS, SE)) &#123;</span></CodeLine>
<Link id="l00890" /><CodeLine lineNumber="890"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;LC = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(0));</span></CodeLine>
<Link id="l00891" /><CodeLine lineNumber="891"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;RC =</span></CodeLine>
<Link id="l00892" /><CodeLine lineNumber="892"><span class="doxyHighlight">              <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(MulRHS-&gt;getOperand(0));</span></CodeLine>
<Link id="l00893" /><CodeLine lineNumber="893"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LC &amp;&amp; RC) &#123;</span></CodeLine>
<Link id="l00894" /><CodeLine lineNumber="894"><span class="doxyHighlight">            <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> LOps(<a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">drop&#95;begin</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;operands()));</span></CodeLine>
<Link id="l00895" /><CodeLine lineNumber="895"><span class="doxyHighlight">            <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> ROps(<a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">drop&#95;begin</a>(MulRHS-&gt;operands()));</span></CodeLine>
<Link id="l00896" /><CodeLine lineNumber="896"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LOps == ROps)</span></CodeLine>
<Link id="l00897" /><CodeLine lineNumber="897"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(LC, RC, SE, IgnoreSignificantBits);</span></CodeLine>
<Link id="l00898" /><CodeLine lineNumber="898"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l00899" /><CodeLine lineNumber="899"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l00900" /><CodeLine lineNumber="900"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00901" /><CodeLine lineNumber="901"></CodeLine>
<Link id="l00902" /><CodeLine lineNumber="902"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</span></CodeLine>
<Link id="l00903" /><CodeLine lineNumber="903"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Found = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00904" /><CodeLine lineNumber="904"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;operands()) &#123;</span></CodeLine>
<Link id="l00905" /><CodeLine lineNumber="905"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Found)</span></CodeLine>
<Link id="l00906" /><CodeLine lineNumber="906"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Q = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(S, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, SE,</span></CodeLine>
<Link id="l00907" /><CodeLine lineNumber="907"><span class="doxyHighlight">                                           IgnoreSignificantBits)) &#123;</span></CodeLine>
<Link id="l00908" /><CodeLine lineNumber="908"><span class="doxyHighlight">            S = Q;</span></CodeLine>
<Link id="l00909" /><CodeLine lineNumber="909"><span class="doxyHighlight">            Found = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00910" /><CodeLine lineNumber="910"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l00911" /><CodeLine lineNumber="911"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(S);</span></CodeLine>
<Link id="l00912" /><CodeLine lineNumber="912"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00913" /><CodeLine lineNumber="913"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Found ? SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) : </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00914" /><CodeLine lineNumber="914"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00915" /><CodeLine lineNumber="915"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00916" /><CodeLine lineNumber="916"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00917" /><CodeLine lineNumber="917"></CodeLine>
<Link id="l00918" /><CodeLine lineNumber="918"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Otherwise we don&#39;t know.</span></CodeLine>
<Link id="l00919" /><CodeLine lineNumber="919"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00920" /><CodeLine lineNumber="920"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00921" /><CodeLine lineNumber="921"></CodeLine>
<Link id="l00922" /><CodeLine lineNumber="922"><span class="doxyHighlightComment">/// If S involves the addition of a constant integer value, return that integer</span></CodeLine>
<Link id="l00923" /><CodeLine lineNumber="923"><span class="doxyHighlightComment">/// value, and mutate S to point to a new SCEV with that value excluded.</span></CodeLine>
<Link id="l00924" /><CodeLine lineNumber="924" lineLink="#a1a0afc5106fca20f0a81eac37db70ab9"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a> <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;S, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l00925" /><CodeLine lineNumber="925"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l00926" /><CodeLine lineNumber="926"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSignificantBits() &lt;= 64) &#123;</span></CodeLine>
<Link id="l00927" /><CodeLine lineNumber="927"><span class="doxyHighlight">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getType(), 0);</span></CodeLine>
<Link id="l00928" /><CodeLine lineNumber="928"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue()-&gt;getSExtValue());</span></CodeLine>
<Link id="l00929" /><CodeLine lineNumber="929"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00930" /><CodeLine lineNumber="930"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l00931" /><CodeLine lineNumber="931"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> NewOps(<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands());</span></CodeLine>
<Link id="l00932" /><CodeLine lineNumber="932"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a> Result = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(NewOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>(), SE);</span></CodeLine>
<Link id="l00933" /><CodeLine lineNumber="933"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Result.isNonZero())</span></CodeLine>
<Link id="l00934" /><CodeLine lineNumber="934"><span class="doxyHighlight">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(NewOps);</span></CodeLine>
<Link id="l00935" /><CodeLine lineNumber="935"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Result;</span></CodeLine>
<Link id="l00936" /><CodeLine lineNumber="936"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l00937" /><CodeLine lineNumber="937"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> NewOps(AR-&gt;operands());</span></CodeLine>
<Link id="l00938" /><CodeLine lineNumber="938"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a> Result = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(NewOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>(), SE);</span></CodeLine>
<Link id="l00939" /><CodeLine lineNumber="939"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Result.isNonZero())</span></CodeLine>
<Link id="l00940" /><CodeLine lineNumber="940"><span class="doxyHighlight">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(NewOps, AR-&gt;getLoop(),</span></CodeLine>
<Link id="l00941" /><CodeLine lineNumber="941"><span class="doxyHighlight">                           </span><span class="doxyHighlightComment">// FIXME: AR-&gt;getNoWrapFlags(SCEV::FlagNW)</span></CodeLine>
<Link id="l00942" /><CodeLine lineNumber="942"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>);</span></CodeLine>
<Link id="l00943" /><CodeLine lineNumber="943"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Result;</span></CodeLine>
<Link id="l00944" /><CodeLine lineNumber="944"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;M = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l00945" /><CodeLine lineNumber="945"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a5ca5d2aa868eb59998bc43f224fec74f">EnableVScaleImmediates</a> &amp;&amp; M-&gt;getNumOperands() == 2) &#123;</span></CodeLine>
<Link id="l00946" /><CodeLine lineNumber="946"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(M-&gt;getOperand(0)))</span></CodeLine>
<Link id="l00947" /><CodeLine lineNumber="947"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVVScale&gt;</a>(M-&gt;getOperand(1))) &#123;</span></CodeLine>
<Link id="l00948" /><CodeLine lineNumber="948"><span class="doxyHighlight">          S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(M-&gt;getType(), 0);</span></CodeLine>
<Link id="l00949" /><CodeLine lineNumber="949"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ac7030e0a5d4b154f205b3d85dde0644b">Immediate::getScalable</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue()-&gt;getSExtValue());</span></CodeLine>
<Link id="l00950" /><CodeLine lineNumber="950"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l00951" /><CodeLine lineNumber="951"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00952" /><CodeLine lineNumber="952"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00953" /><CodeLine lineNumber="953"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</span></CodeLine>
<Link id="l00954" /><CodeLine lineNumber="954"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00955" /><CodeLine lineNumber="955"></CodeLine>
<Link id="l00956" /><CodeLine lineNumber="956"><span class="doxyHighlightComment">/// If S involves the addition of a GlobalValue address, return that symbol, and</span></CodeLine>
<Link id="l00957" /><CodeLine lineNumber="957"><span class="doxyHighlightComment">/// mutate S to point to a new SCEV with that value excluded.</span></CodeLine>
<Link id="l00958" /><CodeLine lineNumber="958" lineLink="#a45b1664e25bf2a7220367462f2580044"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;<a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;S, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l00959" /><CodeLine lineNumber="959"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l00960" /><CodeLine lineNumber="960"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;GV = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;GlobalValue&gt;</a>(U-&gt;getValue())) &#123;</span></CodeLine>
<Link id="l00961" /><CodeLine lineNumber="961"><span class="doxyHighlight">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(GV-&gt;getType(), 0);</span></CodeLine>
<Link id="l00962" /><CodeLine lineNumber="962"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> GV;</span></CodeLine>
<Link id="l00963" /><CodeLine lineNumber="963"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00964" /><CodeLine lineNumber="964"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l00965" /><CodeLine lineNumber="965"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> NewOps(<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands());</span></CodeLine>
<Link id="l00966" /><CodeLine lineNumber="966"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;Result = <a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(NewOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>(), SE);</span></CodeLine>
<Link id="l00967" /><CodeLine lineNumber="967"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Result)</span></CodeLine>
<Link id="l00968" /><CodeLine lineNumber="968"><span class="doxyHighlight">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aef6d2bea715d1793e956f41ddeea2320">getAddExpr</a>(NewOps);</span></CodeLine>
<Link id="l00969" /><CodeLine lineNumber="969"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Result;</span></CodeLine>
<Link id="l00970" /><CodeLine lineNumber="970"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l00971" /><CodeLine lineNumber="971"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> NewOps(AR-&gt;operands());</span></CodeLine>
<Link id="l00972" /><CodeLine lineNumber="972"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;Result = <a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(NewOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>(), SE);</span></CodeLine>
<Link id="l00973" /><CodeLine lineNumber="973"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Result)</span></CodeLine>
<Link id="l00974" /><CodeLine lineNumber="974"><span class="doxyHighlight">      S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(NewOps, AR-&gt;getLoop(),</span></CodeLine>
<Link id="l00975" /><CodeLine lineNumber="975"><span class="doxyHighlight">                           </span><span class="doxyHighlightComment">// FIXME: AR-&gt;getNoWrapFlags(SCEV::FlagNW)</span></CodeLine>
<Link id="l00976" /><CodeLine lineNumber="976"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>);</span></CodeLine>
<Link id="l00977" /><CodeLine lineNumber="977"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Result;</span></CodeLine>
<Link id="l00978" /><CodeLine lineNumber="978"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00979" /><CodeLine lineNumber="979"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00980" /><CodeLine lineNumber="980"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00981" /><CodeLine lineNumber="981"></CodeLine>
<Link id="l00982" /><CodeLine lineNumber="982"><span class="doxyHighlightComment">/// Returns true if the specified instruction is using the specified value as an</span></CodeLine>
<Link id="l00983" /><CodeLine lineNumber="983"><span class="doxyHighlightComment">/// address.</span></CodeLine>
<Link id="l00984" /><CodeLine lineNumber="984" lineLink="#a4120d81bd505176f5cadf647f5b8c7ef"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l00985" /><CodeLine lineNumber="985"><span class="doxyHighlight">                         <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst, <a href="/docs/api/classes/llvm/value">Value</a> &#42;OperandVal) &#123;</span></CodeLine>
<Link id="l00986" /><CodeLine lineNumber="986"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> isAddress = <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;LoadInst&gt;</a>(Inst);</span></CodeLine>
<Link id="l00987" /><CodeLine lineNumber="987"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/storeinst">StoreInst</a> &#42;<a href="/docs/api/namespaces/llvm/si">SI</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StoreInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l00988" /><CodeLine lineNumber="988"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/si">SI</a>-&gt;getPointerOperand() == OperandVal)</span></CodeLine>
<Link id="l00989" /><CodeLine lineNumber="989"><span class="doxyHighlight">      isAddress = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00990" /><CodeLine lineNumber="990"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/intrinsicinst">IntrinsicInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;IntrinsicInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l00991" /><CodeLine lineNumber="991"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Addressing modes can also be folded into prefetches and a variety</span></CodeLine>
<Link id="l00992" /><CodeLine lineNumber="992"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// of intrinsics.</span></CodeLine>
<Link id="l00993" /><CodeLine lineNumber="993"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getIntrinsicID()) &#123;</span></CodeLine>
<Link id="l00994" /><CodeLine lineNumber="994"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::memset:</span></CodeLine>
<Link id="l00995" /><CodeLine lineNumber="995"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::prefetch:</span></CodeLine>
<Link id="l00996" /><CodeLine lineNumber="996"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::masked&#95;load:</span></CodeLine>
<Link id="l00997" /><CodeLine lineNumber="997"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(0) == OperandVal)</span></CodeLine>
<Link id="l00998" /><CodeLine lineNumber="998"><span class="doxyHighlight">        isAddress = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00999" /><CodeLine lineNumber="999"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01000" /><CodeLine lineNumber="1000"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::masked&#95;store:</span></CodeLine>
<Link id="l01001" /><CodeLine lineNumber="1001"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(1) == OperandVal)</span></CodeLine>
<Link id="l01002" /><CodeLine lineNumber="1002"><span class="doxyHighlight">        isAddress = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01003" /><CodeLine lineNumber="1003"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01004" /><CodeLine lineNumber="1004"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::memmove:</span></CodeLine>
<Link id="l01005" /><CodeLine lineNumber="1005"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::memcpy:</span></CodeLine>
<Link id="l01006" /><CodeLine lineNumber="1006"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(0) == OperandVal ||</span></CodeLine>
<Link id="l01007" /><CodeLine lineNumber="1007"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(1) == OperandVal)</span></CodeLine>
<Link id="l01008" /><CodeLine lineNumber="1008"><span class="doxyHighlight">        isAddress = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01009" /><CodeLine lineNumber="1009"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01010" /><CodeLine lineNumber="1010"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">: &#123;</span></CodeLine>
<Link id="l01011" /><CodeLine lineNumber="1011"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/memintrinsicinfo">MemIntrinsicInfo</a> IntrInfo;</span></CodeLine>
<Link id="l01012" /><CodeLine lineNumber="1012"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.getTgtMemIntrinsic(<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>, IntrInfo)) &#123;</span></CodeLine>
<Link id="l01013" /><CodeLine lineNumber="1013"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IntrInfo.<a href="/docs/api/structs/llvm/memintrinsicinfo/#a96d9e7ee9af6f300d2544d8f7b97c234">PtrVal</a> == OperandVal)</span></CodeLine>
<Link id="l01014" /><CodeLine lineNumber="1014"><span class="doxyHighlight">          isAddress = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01015" /><CodeLine lineNumber="1015"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01016" /><CodeLine lineNumber="1016"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01017" /><CodeLine lineNumber="1017"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01018" /><CodeLine lineNumber="1018"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/atomicrmwinst">AtomicRMWInst</a> &#42;RMW = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AtomicRMWInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l01019" /><CodeLine lineNumber="1019"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RMW-&gt;getPointerOperand() == OperandVal)</span></CodeLine>
<Link id="l01020" /><CodeLine lineNumber="1020"><span class="doxyHighlight">      isAddress = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01021" /><CodeLine lineNumber="1021"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/atomiccmpxchginst">AtomicCmpXchgInst</a> &#42;CmpX = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AtomicCmpXchgInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l01022" /><CodeLine lineNumber="1022"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CmpX-&gt;getPointerOperand() == OperandVal)</span></CodeLine>
<Link id="l01023" /><CodeLine lineNumber="1023"><span class="doxyHighlight">      isAddress = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01024" /><CodeLine lineNumber="1024"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01025" /><CodeLine lineNumber="1025"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> isAddress;</span></CodeLine>
<Link id="l01026" /><CodeLine lineNumber="1026"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01027" /><CodeLine lineNumber="1027"></CodeLine>
<Link id="l01028" /><CodeLine lineNumber="1028"><span class="doxyHighlightComment">/// Return the type of the memory being accessed.</span></CodeLine>
<Link id="l01029" /><CodeLine lineNumber="1029" lineLink="#a7f4680b383ce7138bc2c12de282b14b4"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> <a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01030" /><CodeLine lineNumber="1030"><span class="doxyHighlight">                                 <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst, <a href="/docs/api/classes/llvm/value">Value</a> &#42;OperandVal) &#123;</span></CodeLine>
<Link id="l01031" /><CodeLine lineNumber="1031"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> AccessTy = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a153bbcee36817bcedb110f30d95b2368">MemAccessTy::getUnknown</a>(Inst-&gt;<a href="/docs/api/classes/llvm/value/#ab3fc0225d8aaf8434026c3573f961f2c">getContext</a>());</span></CodeLine>
<Link id="l01032" /><CodeLine lineNumber="1032"></CodeLine>
<Link id="l01033" /><CodeLine lineNumber="1033"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// First get the type of memory being accessed.</span></CodeLine>
<Link id="l01034" /><CodeLine lineNumber="1034"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty = Inst-&gt;<a href="/docs/api/classes/llvm/instruction/#a765d7abba7daa905e301027dd2fd1086">getAccessType</a>())</span></CodeLine>
<Link id="l01035" /><CodeLine lineNumber="1035"><span class="doxyHighlight">    AccessTy.MemTy = Ty;</span></CodeLine>
<Link id="l01036" /><CodeLine lineNumber="1036"></CodeLine>
<Link id="l01037" /><CodeLine lineNumber="1037"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Then get the pointer address space.</span></CodeLine>
<Link id="l01038" /><CodeLine lineNumber="1038"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/storeinst">StoreInst</a> &#42;<a href="/docs/api/namespaces/llvm/si">SI</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StoreInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l01039" /><CodeLine lineNumber="1039"><span class="doxyHighlight">    AccessTy.AddrSpace = <a href="/docs/api/namespaces/llvm/si">SI</a>-&gt;getPointerAddressSpace();</span></CodeLine>
<Link id="l01040" /><CodeLine lineNumber="1040"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loadinst">LoadInst</a> &#42;LI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;LoadInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l01041" /><CodeLine lineNumber="1041"><span class="doxyHighlight">    AccessTy.AddrSpace = LI-&gt;getPointerAddressSpace();</span></CodeLine>
<Link id="l01042" /><CodeLine lineNumber="1042"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/atomicrmwinst">AtomicRMWInst</a> &#42;RMW = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AtomicRMWInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l01043" /><CodeLine lineNumber="1043"><span class="doxyHighlight">    AccessTy.AddrSpace = RMW-&gt;getPointerAddressSpace();</span></CodeLine>
<Link id="l01044" /><CodeLine lineNumber="1044"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/atomiccmpxchginst">AtomicCmpXchgInst</a> &#42;CmpX = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AtomicCmpXchgInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l01045" /><CodeLine lineNumber="1045"><span class="doxyHighlight">    AccessTy.AddrSpace = CmpX-&gt;getPointerAddressSpace();</span></CodeLine>
<Link id="l01046" /><CodeLine lineNumber="1046"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/intrinsicinst">IntrinsicInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;IntrinsicInst&gt;</a>(Inst)) &#123;</span></CodeLine>
<Link id="l01047" /><CodeLine lineNumber="1047"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getIntrinsicID()) &#123;</span></CodeLine>
<Link id="l01048" /><CodeLine lineNumber="1048"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::prefetch:</span></CodeLine>
<Link id="l01049" /><CodeLine lineNumber="1049"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::memset:</span></CodeLine>
<Link id="l01050" /><CodeLine lineNumber="1050"><span class="doxyHighlight">      AccessTy.AddrSpace = <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(0)-&gt;getType()-&gt;getPointerAddressSpace();</span></CodeLine>
<Link id="l01051" /><CodeLine lineNumber="1051"><span class="doxyHighlight">      AccessTy.MemTy = OperandVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</span></CodeLine>
<Link id="l01052" /><CodeLine lineNumber="1052"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01053" /><CodeLine lineNumber="1053"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::memmove:</span></CodeLine>
<Link id="l01054" /><CodeLine lineNumber="1054"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::memcpy:</span></CodeLine>
<Link id="l01055" /><CodeLine lineNumber="1055"><span class="doxyHighlight">      AccessTy.AddrSpace = OperandVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</span></CodeLine>
<Link id="l01056" /><CodeLine lineNumber="1056"><span class="doxyHighlight">      AccessTy.MemTy = OperandVal-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</span></CodeLine>
<Link id="l01057" /><CodeLine lineNumber="1057"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01058" /><CodeLine lineNumber="1058"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::masked&#95;load:</span></CodeLine>
<Link id="l01059" /><CodeLine lineNumber="1059"><span class="doxyHighlight">      AccessTy.AddrSpace =</span></CodeLine>
<Link id="l01060" /><CodeLine lineNumber="1060"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(0)-&gt;getType()-&gt;getPointerAddressSpace();</span></CodeLine>
<Link id="l01061" /><CodeLine lineNumber="1061"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01062" /><CodeLine lineNumber="1062"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Intrinsic::masked&#95;store:</span></CodeLine>
<Link id="l01063" /><CodeLine lineNumber="1063"><span class="doxyHighlight">      AccessTy.AddrSpace =</span></CodeLine>
<Link id="l01064" /><CodeLine lineNumber="1064"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>-&gt;getArgOperand(1)-&gt;getType()-&gt;getPointerAddressSpace();</span></CodeLine>
<Link id="l01065" /><CodeLine lineNumber="1065"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01066" /><CodeLine lineNumber="1066"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">: &#123;</span></CodeLine>
<Link id="l01067" /><CodeLine lineNumber="1067"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/memintrinsicinfo">MemIntrinsicInfo</a> IntrInfo;</span></CodeLine>
<Link id="l01068" /><CodeLine lineNumber="1068"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.getTgtMemIntrinsic(<a href="/docs/api/files/lib/lib/target/lib/target/nvptx/nvvmintrrange-cpp/#ac5804672fc0850438d63caec770647f8">II</a>, IntrInfo) &amp;&amp; IntrInfo.<a href="/docs/api/structs/llvm/memintrinsicinfo/#a96d9e7ee9af6f300d2544d8f7b97c234">PtrVal</a>) &#123;</span></CodeLine>
<Link id="l01069" /><CodeLine lineNumber="1069"><span class="doxyHighlight">        AccessTy.AddrSpace</span></CodeLine>
<Link id="l01070" /><CodeLine lineNumber="1070"><span class="doxyHighlight">          = IntrInfo.<a href="/docs/api/structs/llvm/memintrinsicinfo/#a96d9e7ee9af6f300d2544d8f7b97c234">PtrVal</a>-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#a5ab2d0b0f0b8ceec3b907184e7567197">getPointerAddressSpace</a>();</span></CodeLine>
<Link id="l01071" /><CodeLine lineNumber="1071"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01072" /><CodeLine lineNumber="1072"></CodeLine>
<Link id="l01073" /><CodeLine lineNumber="1073"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01074" /><CodeLine lineNumber="1074"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01075" /><CodeLine lineNumber="1075"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01076" /><CodeLine lineNumber="1076"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01077" /><CodeLine lineNumber="1077"></CodeLine>
<Link id="l01078" /><CodeLine lineNumber="1078"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> AccessTy;</span></CodeLine>
<Link id="l01079" /><CodeLine lineNumber="1079"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01080" /><CodeLine lineNumber="1080"></CodeLine>
<Link id="l01081" /><CodeLine lineNumber="1081"><span class="doxyHighlightComment">/// Return true if this AddRec is already a phi in its loop.</span></CodeLine>
<Link id="l01082" /><CodeLine lineNumber="1082" lineLink="#a3c81223cabf643af27adba3b3ceb680c"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a3c81223cabf643af27adba3b3ceb680c">isExistingPhi</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l01083" /><CodeLine lineNumber="1083"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;PN : AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>()-&gt;<a href="/docs/api/classes/llvm/loopbase/#a4a75755081e9a3803d2f4ccf6f0cb1f8">getHeader</a>()-&gt;<a href="/docs/api/classes/llvm/basicblock/#a13da92d2694197fbcb5b95fd94e7570d">phis</a>()) &#123;</span></CodeLine>
<Link id="l01084" /><CodeLine lineNumber="1084"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(PN.getType()) &amp;&amp;</span></CodeLine>
<Link id="l01085" /><CodeLine lineNumber="1085"><span class="doxyHighlight">        (SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6dcfa69ce27cf214caaf50f21bfe1f2f">getEffectiveSCEVType</a>(PN.getType()) ==</span></CodeLine>
<Link id="l01086" /><CodeLine lineNumber="1086"><span class="doxyHighlight">         SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6dcfa69ce27cf214caaf50f21bfe1f2f">getEffectiveSCEVType</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>())) &amp;&amp;</span></CodeLine>
<Link id="l01087" /><CodeLine lineNumber="1087"><span class="doxyHighlight">        SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(&amp;PN) == AR)</span></CodeLine>
<Link id="l01088" /><CodeLine lineNumber="1088"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01089" /><CodeLine lineNumber="1089"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01090" /><CodeLine lineNumber="1090"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01091" /><CodeLine lineNumber="1091"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01092" /><CodeLine lineNumber="1092"></CodeLine>
<Link id="l01093" /><CodeLine lineNumber="1093"><span class="doxyHighlightComment">/// Check if expanding this expression is likely to incur significant cost. This</span></CodeLine>
<Link id="l01094" /><CodeLine lineNumber="1094"><span class="doxyHighlightComment">/// is tricky because SCEV doesn&#39;t track which expressions are actually computed</span></CodeLine>
<Link id="l01095" /><CodeLine lineNumber="1095"><span class="doxyHighlightComment">/// by the current IR.</span></CodeLine>
<Link id="l01096" /><CodeLine lineNumber="1096"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l01097" /><CodeLine lineNumber="1097"><span class="doxyHighlightComment">/// We currently allow expansion of IV increments that involve adds,</span></CodeLine>
<Link id="l01098" /><CodeLine lineNumber="1098"><span class="doxyHighlightComment">/// multiplication by constants, and AddRecs from existing phis.</span></CodeLine>
<Link id="l01099" /><CodeLine lineNumber="1099"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l01100" /><CodeLine lineNumber="1100"><span class="doxyHighlightComment">/// TODO: Allow UDivExpr if we can find an existing IV increment that is an</span></CodeLine>
<Link id="l01101" /><CodeLine lineNumber="1101"><span class="doxyHighlightComment">/// obvious multiple of the UDivExpr.</span></CodeLine>
<Link id="l01102" /><CodeLine lineNumber="1102" lineLink="#a7ac21134b2aaca2a7d55f6ff9d92f5b2"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S,</span></CodeLine>
<Link id="l01103" /><CodeLine lineNumber="1103"><span class="doxyHighlight">                                <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV&#42;&gt;</a> &amp;Processed,</span></CodeLine>
<Link id="l01104" /><CodeLine lineNumber="1104"><span class="doxyHighlight">                                <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l01105" /><CodeLine lineNumber="1105"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Zero/One operand expressions</span></CodeLine>
<Link id="l01106" /><CodeLine lineNumber="1106"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (S-&gt;<a href="/docs/api/classes/llvm/scev/#ad4f956914bf94bdcd1058badb5bd90e6">getSCEVType</a>()) &#123;</span></CodeLine>
<Link id="l01107" /><CodeLine lineNumber="1107"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea80488550b42b6548ec4d5c7118c7ff1d">scUnknown</a>:</span></CodeLine>
<Link id="l01108" /><CodeLine lineNumber="1108"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eabcb1f797cb330e61a5879fc260aaec5b">scConstant</a>:</span></CodeLine>
<Link id="l01109" /><CodeLine lineNumber="1109"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea61df12d6bb21842a8f766c4433c85717">scVScale</a>:</span></CodeLine>
<Link id="l01110" /><CodeLine lineNumber="1110"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01111" /><CodeLine lineNumber="1111"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ead3656bcc84af213cc488acb56c60de22">scTruncate</a>:</span></CodeLine>
<Link id="l01112" /><CodeLine lineNumber="1112"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVTruncateExpr&gt;</a>(S)-&gt;getOperand(),</span></CodeLine>
<Link id="l01113" /><CodeLine lineNumber="1113"><span class="doxyHighlight">                               Processed, SE);</span></CodeLine>
<Link id="l01114" /><CodeLine lineNumber="1114"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eadd4a8d5cb0d78c9be22d01e1546bafc6">scZeroExtend</a>:</span></CodeLine>
<Link id="l01115" /><CodeLine lineNumber="1115"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVZeroExtendExpr&gt;</a>(S)-&gt;getOperand(),</span></CodeLine>
<Link id="l01116" /><CodeLine lineNumber="1116"><span class="doxyHighlight">                               Processed, SE);</span></CodeLine>
<Link id="l01117" /><CodeLine lineNumber="1117"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ead05711646a19cb20775cfbc8ef0a8c09">scSignExtend</a>:</span></CodeLine>
<Link id="l01118" /><CodeLine lineNumber="1118"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVSignExtendExpr&gt;</a>(S)-&gt;getOperand(),</span></CodeLine>
<Link id="l01119" /><CodeLine lineNumber="1119"><span class="doxyHighlight">                               Processed, SE);</span></CodeLine>
<Link id="l01120" /><CodeLine lineNumber="1120"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l01121" /><CodeLine lineNumber="1121"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01122" /><CodeLine lineNumber="1122"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01123" /><CodeLine lineNumber="1123"></CodeLine>
<Link id="l01124" /><CodeLine lineNumber="1124"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Processed.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(S).second)</span></CodeLine>
<Link id="l01125" /><CodeLine lineNumber="1125"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01126" /><CodeLine lineNumber="1126"></CodeLine>
<Link id="l01127" /><CodeLine lineNumber="1127"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l01128" /><CodeLine lineNumber="1128"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands()) &#123;</span></CodeLine>
<Link id="l01129" /><CodeLine lineNumber="1129"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(S, Processed, SE))</span></CodeLine>
<Link id="l01130" /><CodeLine lineNumber="1130"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01131" /><CodeLine lineNumber="1131"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01132" /><CodeLine lineNumber="1132"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01133" /><CodeLine lineNumber="1133"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01134" /><CodeLine lineNumber="1134"></CodeLine>
<Link id="l01135" /><CodeLine lineNumber="1135"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l01136" /><CodeLine lineNumber="1136"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getNumOperands() == 2) &#123;</span></CodeLine>
<Link id="l01137" /><CodeLine lineNumber="1137"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Multiplication by a constant is ok</span></CodeLine>
<Link id="l01138" /><CodeLine lineNumber="1138"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(0)))</span></CodeLine>
<Link id="l01139" /><CodeLine lineNumber="1139"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(1), Processed, SE);</span></CodeLine>
<Link id="l01140" /><CodeLine lineNumber="1140"></CodeLine>
<Link id="l01141" /><CodeLine lineNumber="1141"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If we have the value of one operand, check if an existing</span></CodeLine>
<Link id="l01142" /><CodeLine lineNumber="1142"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// multiplication already generates this expression.</span></CodeLine>
<Link id="l01143" /><CodeLine lineNumber="1143"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(1))) &#123;</span></CodeLine>
<Link id="l01144" /><CodeLine lineNumber="1144"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;UVal = U-&gt;getValue();</span></CodeLine>
<Link id="l01145" /><CodeLine lineNumber="1145"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/user">User</a> &#42;UR : UVal-&gt;<a href="/docs/api/classes/llvm/value/#a411cf3e3932f209ce3374cb31adc1da6">users</a>()) &#123;</span></CodeLine>
<Link id="l01146" /><CodeLine lineNumber="1146"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// If U is a constant, it may be used by a ConstantExpr.</span></CodeLine>
<Link id="l01147" /><CodeLine lineNumber="1147"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(UR);</span></CodeLine>
<Link id="l01148" /><CodeLine lineNumber="1148"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UI &amp;&amp; UI-&gt;<a href="/docs/api/classes/llvm/instruction/#ab4e05d690df389b8b1477c90387b575f">getOpcode</a>() == Instruction::Mul &amp;&amp;</span></CodeLine>
<Link id="l01149" /><CodeLine lineNumber="1149"><span class="doxyHighlight">              SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(UI-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())) &#123;</span></CodeLine>
<Link id="l01150" /><CodeLine lineNumber="1150"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(UI) == <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>;</span></CodeLine>
<Link id="l01151" /><CodeLine lineNumber="1151"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l01152" /><CodeLine lineNumber="1152"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01153" /><CodeLine lineNumber="1153"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01154" /><CodeLine lineNumber="1154"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01155" /><CodeLine lineNumber="1155"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01156" /><CodeLine lineNumber="1156"></CodeLine>
<Link id="l01157" /><CodeLine lineNumber="1157"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l01158" /><CodeLine lineNumber="1158"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a3c81223cabf643af27adba3b3ceb680c">isExistingPhi</a>(AR, SE))</span></CodeLine>
<Link id="l01159" /><CodeLine lineNumber="1159"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01160" /><CodeLine lineNumber="1160"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01161" /><CodeLine lineNumber="1161"></CodeLine>
<Link id="l01162" /><CodeLine lineNumber="1162"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Fow now, consider any other type of expression (div/mul/min/max) high cost.</span></CodeLine>
<Link id="l01163" /><CodeLine lineNumber="1163"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01164" /><CodeLine lineNumber="1164"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01165" /><CodeLine lineNumber="1165"></CodeLine>
<Link id="l01166" /><CodeLine lineNumber="1166"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01167" /><CodeLine lineNumber="1167"></CodeLine>
<Link id="l01168" /><CodeLine lineNumber="1168"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a>;</span></CodeLine>
<Link id="l01169" /><CodeLine lineNumber="1169"></CodeLine>
<Link id="l01170" /><CodeLine lineNumber="1170"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l01171" /><CodeLine lineNumber="1171"></CodeLine>
<Link id="l01172" /><CodeLine lineNumber="1172"><span class="doxyHighlightComment">/// Check if the addressing mode defined by \\p F is completely</span></CodeLine>
<Link id="l01173" /><CodeLine lineNumber="1173"><span class="doxyHighlightComment">/// folded in \\p LU at isel time.</span></CodeLine>
<Link id="l01174" /><CodeLine lineNumber="1174"><span class="doxyHighlightComment">/// This includes address-mode folding and special icmp tricks.</span></CodeLine>
<Link id="l01175" /><CodeLine lineNumber="1175"><span class="doxyHighlightComment">/// This function returns true if \\p LU can accommodate what \\p F</span></CodeLine>
<Link id="l01176" /><CodeLine lineNumber="1176"><span class="doxyHighlightComment">/// defines and up to 1 base + 1 scaled + offset.</span></CodeLine>
<Link id="l01177" /><CodeLine lineNumber="1177"><span class="doxyHighlightComment">/// In other words, if \\p F has several base registers, this function may</span></CodeLine>
<Link id="l01178" /><CodeLine lineNumber="1178"><span class="doxyHighlightComment">/// still return true. Therefore, users still need to account for</span></CodeLine>
<Link id="l01179" /><CodeLine lineNumber="1179"><span class="doxyHighlightComment">/// additional base registers and/or unfolded offsets to derive an</span></CodeLine>
<Link id="l01180" /><CodeLine lineNumber="1180"><span class="doxyHighlightComment">/// accurate cost model.</span></CodeLine>
<Link id="l01181" /><CodeLine lineNumber="1181"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01182" /><CodeLine lineNumber="1182"><span class="doxyHighlight">                                 </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l01183" /><CodeLine lineNumber="1183"></CodeLine>
<Link id="l01184" /><CodeLine lineNumber="1184"><span class="doxyHighlightComment">// Get the cost of the scaling factor used in F for LU.</span></CodeLine>
<Link id="l01185" /><CodeLine lineNumber="1185"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a> <a href="#a3cbf7279944dc2f0f99a6896501277f9">getScalingFactorCost</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01186" /><CodeLine lineNumber="1186"><span class="doxyHighlight">                                            </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l01187" /><CodeLine lineNumber="1187"><span class="doxyHighlight">                                            </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L);</span></CodeLine>
<Link id="l01188" /><CodeLine lineNumber="1188"></CodeLine>
<Link id="l01189" /><CodeLine lineNumber="1189"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01190" /><CodeLine lineNumber="1190"></CodeLine>
<Link id="l01191" /><CodeLine lineNumber="1191"><span class="doxyHighlightComment">/// This class is used to measure and compare candidate formulae.</span></CodeLine>
<Link id="l01192" /><CodeLine lineNumber="1192" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad60603979ceadc6c0b683403e7131646">Cost</a> &#123;</span></CodeLine>
<Link id="l01193" /><CodeLine lineNumber="1193"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01194" /><CodeLine lineNumber="1194"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &#42;SE = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01195" /><CodeLine lineNumber="1195"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &#42;TTI = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01196" /><CodeLine lineNumber="1196"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/targettransforminfo/lsrcost">TargetTransformInfo::LSRCost</a> C;</span></CodeLine>
<Link id="l01197" /><CodeLine lineNumber="1197"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43">TTI::AddressingModeKind</a> AMK = <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43afcb500aacd74955fc04edc890f5e5d1a">TTI::AMK&#95;None</a>;</span></CodeLine>
<Link id="l01198" /><CodeLine lineNumber="1198"></CodeLine>
<Link id="l01199" /><CodeLine lineNumber="1199"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l01200" /><CodeLine lineNumber="1200" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad60603979ceadc6c0b683403e7131646"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad60603979ceadc6c0b683403e7131646">Cost</a>() = </span><span class="doxyHighlightKeyword">delete</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01201" /><CodeLine lineNumber="1201" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1d7a221dcf14ef35df4e30ecd319dab6"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1d7a221dcf14ef35df4e30ecd319dab6">Cost</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;TTI,</span></CodeLine>
<Link id="l01202" /><CodeLine lineNumber="1202"><span class="doxyHighlight">       <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43">TTI::AddressingModeKind</a> AMK) :</span></CodeLine>
<Link id="l01203" /><CodeLine lineNumber="1203"><span class="doxyHighlight">    L(L), SE(&amp;SE), TTI(&amp;TTI), AMK(AMK) &#123;</span></CodeLine>
<Link id="l01204" /><CodeLine lineNumber="1204"><span class="doxyHighlight">    C.Insns = 0;</span></CodeLine>
<Link id="l01205" /><CodeLine lineNumber="1205"><span class="doxyHighlight">    C.NumRegs = 0;</span></CodeLine>
<Link id="l01206" /><CodeLine lineNumber="1206"><span class="doxyHighlight">    C.AddRecCost = 0;</span></CodeLine>
<Link id="l01207" /><CodeLine lineNumber="1207"><span class="doxyHighlight">    C.NumIVMuls = 0;</span></CodeLine>
<Link id="l01208" /><CodeLine lineNumber="1208"><span class="doxyHighlight">    C.NumBaseAdds = 0;</span></CodeLine>
<Link id="l01209" /><CodeLine lineNumber="1209"><span class="doxyHighlight">    C.ImmCost = 0;</span></CodeLine>
<Link id="l01210" /><CodeLine lineNumber="1210"><span class="doxyHighlight">    C.SetupCost = 0;</span></CodeLine>
<Link id="l01211" /><CodeLine lineNumber="1211"><span class="doxyHighlight">    C.ScaleCost = 0;</span></CodeLine>
<Link id="l01212" /><CodeLine lineNumber="1212"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01213" /><CodeLine lineNumber="1213"></CodeLine>
<Link id="l01214" /><CodeLine lineNumber="1214"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> isLess(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01215" /><CodeLine lineNumber="1215"></CodeLine>
<Link id="l01216" /><CodeLine lineNumber="1216"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> Lose();</span></CodeLine>
<Link id="l01217" /><CodeLine lineNumber="1217"></CodeLine>
<Link id="l01218" /><CodeLine lineNumber="1218"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l01219" /><CodeLine lineNumber="1219"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Once any of the metrics loses, they must all remain losers.</span></CodeLine>
<Link id="l01220" /><CodeLine lineNumber="1220" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1c9e1a8d2f818a4369919bc3fb731c03"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1c9e1a8d2f818a4369919bc3fb731c03">isValid</a>() &#123;</span></CodeLine>
<Link id="l01221" /><CodeLine lineNumber="1221"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> ((C.Insns | C.NumRegs | C.AddRecCost | C.NumIVMuls | C.NumBaseAdds</span></CodeLine>
<Link id="l01222" /><CodeLine lineNumber="1222"><span class="doxyHighlight">             | C.ImmCost | C.SetupCost | C.ScaleCost) != ~0u)</span></CodeLine>
<Link id="l01223" /><CodeLine lineNumber="1223"><span class="doxyHighlight">      || ((C.Insns &amp; C.NumRegs &amp; C.AddRecCost &amp; C.NumIVMuls &amp; C.NumBaseAdds</span></CodeLine>
<Link id="l01224" /><CodeLine lineNumber="1224"><span class="doxyHighlight">           &amp; C.ImmCost &amp; C.SetupCost &amp; C.ScaleCost) == ~0u);</span></CodeLine>
<Link id="l01225" /><CodeLine lineNumber="1225"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01226" /><CodeLine lineNumber="1226"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01227" /><CodeLine lineNumber="1227"></CodeLine>
<Link id="l01228" /><CodeLine lineNumber="1228" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed">isLoser</a>() &#123;</span></CodeLine>
<Link id="l01229" /><CodeLine lineNumber="1229"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/demangle/rustdemangle-cpp/#a103d8cfe62c1651cd70e181746f8a840">isValid</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;invalid cost&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01230" /><CodeLine lineNumber="1230"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> C.NumRegs == ~0u;</span></CodeLine>
<Link id="l01231" /><CodeLine lineNumber="1231"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01232" /><CodeLine lineNumber="1232"></CodeLine>
<Link id="l01233" /><CodeLine lineNumber="1233"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RateFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l01234" /><CodeLine lineNumber="1234"><span class="doxyHighlight">                   <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs,</span></CodeLine>
<Link id="l01235" /><CodeLine lineNumber="1235"><span class="doxyHighlight">                   </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> &amp;VisitedRegs,</span></CodeLine>
<Link id="l01236" /><CodeLine lineNumber="1236"><span class="doxyHighlight">                   </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU,</span></CodeLine>
<Link id="l01237" /><CodeLine lineNumber="1237"><span class="doxyHighlight">                   <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &#42;LoserRegs = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01238" /><CodeLine lineNumber="1238"></CodeLine>
<Link id="l01239" /><CodeLine lineNumber="1239" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1df4626320d0227de1e9763ac846ac34"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a1df4626320d0227de1e9763ac846ac34">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01240" /><CodeLine lineNumber="1240"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01241" /><CodeLine lineNumber="1241"></CodeLine>
<Link id="l01242" /><CodeLine lineNumber="1242"><span class="doxyHighlightKeyword">private</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l01243" /><CodeLine lineNumber="1243"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RateRegister(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg,</span></CodeLine>
<Link id="l01244" /><CodeLine lineNumber="1244"><span class="doxyHighlight">                    <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs);</span></CodeLine>
<Link id="l01245" /><CodeLine lineNumber="1245"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RatePrimaryRegister(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg,</span></CodeLine>
<Link id="l01246" /><CodeLine lineNumber="1246"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs,</span></CodeLine>
<Link id="l01247" /><CodeLine lineNumber="1247"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &#42;LoserRegs);</span></CodeLine>
<Link id="l01248" /><CodeLine lineNumber="1248"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l01249" /><CodeLine lineNumber="1249"></CodeLine>
<Link id="l01250" /><CodeLine lineNumber="1250"><span class="doxyHighlightComment">/// An operand value in an instruction which is to be replaced with some</span></CodeLine>
<Link id="l01251" /><CodeLine lineNumber="1251"><span class="doxyHighlightComment">/// equivalent, possibly strength-reduced, replacement.</span></CodeLine>
<Link id="l01252" /><CodeLine lineNumber="1252" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ad0a66a1f097b56f42f484be7080b23c0">LSRFixup</a> &#123;</span></CodeLine>
<Link id="l01253" /><CodeLine lineNumber="1253"><span class="doxyHighlightComment">  /// The instruction which will be updated.</span></CodeLine>
<Link id="l01254" /><CodeLine lineNumber="1254" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01255" /><CodeLine lineNumber="1255"></CodeLine>
<Link id="l01256" /><CodeLine lineNumber="1256"><span class="doxyHighlightComment">  /// The operand of the instruction which will be replaced. The operand may be</span></CodeLine>
<Link id="l01257" /><CodeLine lineNumber="1257"><span class="doxyHighlightComment">  /// used more than once; every instance will be replaced.</span></CodeLine>
<Link id="l01258" /><CodeLine lineNumber="1258" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a2ee07fa1e186cc7e152f3e5ed2a1c3cc"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a2ee07fa1e186cc7e152f3e5ed2a1c3cc">OperandValToReplace</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01259" /><CodeLine lineNumber="1259"></CodeLine>
<Link id="l01260" /><CodeLine lineNumber="1260"><span class="doxyHighlightComment">  /// If this user is to use the post-incremented value of an induction</span></CodeLine>
<Link id="l01261" /><CodeLine lineNumber="1261"><span class="doxyHighlightComment">  /// variable, this set is non-empty and holds the loops associated with the</span></CodeLine>
<Link id="l01262" /><CodeLine lineNumber="1262"><span class="doxyHighlightComment">  /// induction variable.</span></CodeLine>
<Link id="l01263" /><CodeLine lineNumber="1263" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a70aa44719a26fecd9a48e86edcb69b51"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a70aa44719a26fecd9a48e86edcb69b51">PostIncLoops</a>;</span></CodeLine>
<Link id="l01264" /><CodeLine lineNumber="1264"></CodeLine>
<Link id="l01265" /><CodeLine lineNumber="1265"><span class="doxyHighlightComment">  /// A constant offset to be added to the LSRUse expression.  This allows</span></CodeLine>
<Link id="l01266" /><CodeLine lineNumber="1266"><span class="doxyHighlightComment">  /// multiple fixups to share the same LSRUse with different offsets, for</span></CodeLine>
<Link id="l01267" /><CodeLine lineNumber="1267"><span class="doxyHighlightComment">  /// example in an unrolled loop.</span></CodeLine>
<Link id="l01268" /><CodeLine lineNumber="1268" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a6d9b5bf6278b280c61b1c37375cad241"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a6d9b5bf6278b280c61b1c37375cad241">Offset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</span></CodeLine>
<Link id="l01269" /><CodeLine lineNumber="1269"></CodeLine>
<Link id="l01270" /><CodeLine lineNumber="1270" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ad0a66a1f097b56f42f484be7080b23c0"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ad0a66a1f097b56f42f484be7080b23c0">LSRFixup</a>() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01271" /><CodeLine lineNumber="1271"></CodeLine>
<Link id="l01272" /><CodeLine lineNumber="1272"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ab5814e2a785fccd6bdcfccc78286fc10">isUseFullyOutsideLoop</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01273" /><CodeLine lineNumber="1273"></CodeLine>
<Link id="l01274" /><CodeLine lineNumber="1274"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01275" /><CodeLine lineNumber="1275"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01276" /><CodeLine lineNumber="1276"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l01277" /><CodeLine lineNumber="1277"></CodeLine>
<Link id="l01278" /><CodeLine lineNumber="1278"><span class="doxyHighlightComment">/// A DenseMapInfo implementation for holding DenseMaps and DenseSets of sorted</span></CodeLine>
<Link id="l01279" /><CodeLine lineNumber="1279"><span class="doxyHighlightComment">/// SmallVectors of const SCEV&#42;.</span></CodeLine>
<Link id="l01280" /><CodeLine lineNumber="1280" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo">UniquifierDenseMapInfo</a> &#123;</span></CodeLine>
<Link id="l01281" /><CodeLine lineNumber="1281" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#a896950a0629ca3b63bbb06660a1e4ad0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#a896950a0629ca3b63bbb06660a1e4ad0">getEmptyKey</a>() &#123;</span></CodeLine>
<Link id="l01282" /><CodeLine lineNumber="1282"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a>  V;</span></CodeLine>
<Link id="l01283" /><CodeLine lineNumber="1283"><span class="doxyHighlight">    V.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</span><span class="doxyHighlightKeyword">reinterpret&#95;cast&lt;</span><span class="doxyHighlightKeyword">const </span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(-1));</span></CodeLine>
<Link id="l01284" /><CodeLine lineNumber="1284"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> V;</span></CodeLine>
<Link id="l01285" /><CodeLine lineNumber="1285"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01286" /><CodeLine lineNumber="1286"></CodeLine>
<Link id="l01287" /><CodeLine lineNumber="1287" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#ab342fc50b3fc95a5028ba25d3646b3f0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#ab342fc50b3fc95a5028ba25d3646b3f0">getTombstoneKey</a>() &#123;</span></CodeLine>
<Link id="l01288" /><CodeLine lineNumber="1288"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> V;</span></CodeLine>
<Link id="l01289" /><CodeLine lineNumber="1289"><span class="doxyHighlight">    V.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</span><span class="doxyHighlightKeyword">reinterpret&#95;cast&lt;</span><span class="doxyHighlightKeyword">const </span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(-2));</span></CodeLine>
<Link id="l01290" /><CodeLine lineNumber="1290"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> V;</span></CodeLine>
<Link id="l01291" /><CodeLine lineNumber="1291"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01292" /><CodeLine lineNumber="1292"></CodeLine>
<Link id="l01293" /><CodeLine lineNumber="1293" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#ab0b5ece0e00938bdfa4f083ac4e11736"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#ab0b5ece0e00938bdfa4f083ac4e11736">getHashValue</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> &amp;V) &#123;</span></CodeLine>
<Link id="l01294" /><CodeLine lineNumber="1294"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">static&#95;cast&lt;</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(<a href="/docs/api/namespaces/llvm/#af80edfc5e42059e045aa7bf7fe42bee3">hash&#95;combine&#95;range</a>(V.begin(), V.end()));</span></CodeLine>
<Link id="l01295" /><CodeLine lineNumber="1295"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01296" /><CodeLine lineNumber="1296"></CodeLine>
<Link id="l01297" /><CodeLine lineNumber="1297" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#a599e877e85a0f8ddde1453d036629750"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo/#a599e877e85a0f8ddde1453d036629750">isEqual</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> &amp;LHS,</span></CodeLine>
<Link id="l01298" /><CodeLine lineNumber="1298"><span class="doxyHighlight">                      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> &amp;RHS) &#123;</span></CodeLine>
<Link id="l01299" /><CodeLine lineNumber="1299"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> LHS == RHS;</span></CodeLine>
<Link id="l01300" /><CodeLine lineNumber="1300"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01301" /><CodeLine lineNumber="1301"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l01302" /><CodeLine lineNumber="1302"></CodeLine>
<Link id="l01303" /><CodeLine lineNumber="1303"><span class="doxyHighlightComment">/// This class holds the state that LSR keeps for each use in IVUsers, as well</span></CodeLine>
<Link id="l01304" /><CodeLine lineNumber="1304"><span class="doxyHighlightComment">/// as uses invented by LSR itself. It includes information about what kinds of</span></CodeLine>
<Link id="l01305" /><CodeLine lineNumber="1305"><span class="doxyHighlightComment">/// things can be folded into the user, information about the user itself, and</span></CodeLine>
<Link id="l01306" /><CodeLine lineNumber="1306"><span class="doxyHighlightComment">/// information about how the use may be satisfied.  TODO: Represent multiple</span></CodeLine>
<Link id="l01307" /><CodeLine lineNumber="1307"><span class="doxyHighlightComment">/// users of the same expression in common?</span></CodeLine>
<Link id="l01308" /><CodeLine lineNumber="1308" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a> &#123;</span></CodeLine>
<Link id="l01309" /><CodeLine lineNumber="1309"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;SmallVector&lt;const SCEV &#42;, 4&gt;</a>, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/uniquifierdensemapinfo">UniquifierDenseMapInfo</a>&gt; Uniquifier;</span></CodeLine>
<Link id="l01310" /><CodeLine lineNumber="1310"></CodeLine>
<Link id="l01311" /><CodeLine lineNumber="1311"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l01312" /><CodeLine lineNumber="1312"><span class="doxyHighlightComment">  /// An enum for a kind of use, indicating what types of scaled and immediate</span></CodeLine>
<Link id="l01313" /><CodeLine lineNumber="1313"><span class="doxyHighlightComment">  /// operands it might support.</span></CodeLine>
<Link id="l01314" /><CodeLine lineNumber="1314" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">enum</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">KindType</a> &#123;</span></CodeLine>
<Link id="l01315" /><CodeLine lineNumber="1315" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">Basic</a>,   </span><span class="doxyHighlightComment">///&lt; A normal use, with no folding.</span></CodeLine>
<Link id="l01316" /><CodeLine lineNumber="1316" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">Special</a>, </span><span class="doxyHighlightComment">///&lt; A special case of basic, allowing -1 scales.</span></CodeLine>
<Link id="l01317" /><CodeLine lineNumber="1317" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">Address</a>, </span><span class="doxyHighlightComment">///&lt; An address use; folding according to TargetLowering</span></CodeLine>
<Link id="l01318" /><CodeLine lineNumber="1318" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">ICmpZero</a> </span><span class="doxyHighlightComment">///&lt; An equality icmp with both operands folded into one.</span></CodeLine>
<Link id="l01319" /><CodeLine lineNumber="1319"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// TODO: Add a generic icmp too?</span></CodeLine>
<Link id="l01320" /><CodeLine lineNumber="1320"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l01321" /><CodeLine lineNumber="1321"></CodeLine>
<Link id="l01322" /><CodeLine lineNumber="1322" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a4a62881e0181b4f2dc498eff32edf764"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a4a62881e0181b4f2dc498eff32edf764">SCEVUseKindPair</a> = <a href="/docs/api/classes/llvm/pointerintpair">PointerIntPair&lt;const SCEV &#42;, 2, KindType&gt;</a>;</span></CodeLine>
<Link id="l01323" /><CodeLine lineNumber="1323"></CodeLine>
<Link id="l01324" /><CodeLine lineNumber="1324" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af414d3b8902f3db57e9f08d3232fc17c"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">KindType</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af414d3b8902f3db57e9f08d3232fc17c">Kind</a>;</span></CodeLine>
<Link id="l01325" /><CodeLine lineNumber="1325" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>;</span></CodeLine>
<Link id="l01326" /><CodeLine lineNumber="1326"></CodeLine>
<Link id="l01327" /><CodeLine lineNumber="1327"><span class="doxyHighlightComment">  /// The list of operands which are to be replaced.</span></CodeLine>
<Link id="l01328" /><CodeLine lineNumber="1328" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;LSRFixup, 8&gt;</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>;</span></CodeLine>
<Link id="l01329" /><CodeLine lineNumber="1329"></CodeLine>
<Link id="l01330" /><CodeLine lineNumber="1330"><span class="doxyHighlightComment">  /// Keep track of the min and max offsets of the fixups.</span></CodeLine>
<Link id="l01331" /><CodeLine lineNumber="1331" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a445b231c7c14ab0d460f9a4d70367c8e"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a445b231c7c14ab0d460f9a4d70367c8e">MinOffset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a23392dbe6d771d111f00d09560f87f0d">Immediate::getFixedMax</a>();</span></CodeLine>
<Link id="l01332" /><CodeLine lineNumber="1332" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#afb7a640470c15f82dc8df85e033d8619"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#afb7a640470c15f82dc8df85e033d8619">MaxOffset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a691a45579958cfd41dd9dcff39646ca0">Immediate::getFixedMin</a>();</span></CodeLine>
<Link id="l01333" /><CodeLine lineNumber="1333"></CodeLine>
<Link id="l01334" /><CodeLine lineNumber="1334"><span class="doxyHighlightComment">  /// This records whether all of the fixups using this LSRUse are outside of</span></CodeLine>
<Link id="l01335" /><CodeLine lineNumber="1335"><span class="doxyHighlightComment">  /// the loop, in which case some special-case heuristics may be used.</span></CodeLine>
<Link id="l01336" /><CodeLine lineNumber="1336" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aac7deb997535d3d9a445dd87bd0f2192"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aac7deb997535d3d9a445dd87bd0f2192">AllFixupsOutsideLoop</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01337" /><CodeLine lineNumber="1337"></CodeLine>
<Link id="l01338" /><CodeLine lineNumber="1338"><span class="doxyHighlightComment">  /// RigidFormula is set to true to guarantee that this use will be associated</span></CodeLine>
<Link id="l01339" /><CodeLine lineNumber="1339"><span class="doxyHighlightComment">  /// with a single formula--the one that initially matched. Some SCEV</span></CodeLine>
<Link id="l01340" /><CodeLine lineNumber="1340"><span class="doxyHighlightComment">  /// expressions cannot be expanded. This allows LSR to consider the registers</span></CodeLine>
<Link id="l01341" /><CodeLine lineNumber="1341"><span class="doxyHighlightComment">  /// used by those expressions without the need to expand them later after</span></CodeLine>
<Link id="l01342" /><CodeLine lineNumber="1342"><span class="doxyHighlightComment">  /// changing the formula.</span></CodeLine>
<Link id="l01343" /><CodeLine lineNumber="1343" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aa45af5caf29ddb4040ef123166ba800a"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aa45af5caf29ddb4040ef123166ba800a">RigidFormula</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01344" /><CodeLine lineNumber="1344"></CodeLine>
<Link id="l01345" /><CodeLine lineNumber="1345"><span class="doxyHighlightComment">  /// This records the widest use type for any fixup using this</span></CodeLine>
<Link id="l01346" /><CodeLine lineNumber="1346"><span class="doxyHighlightComment">  /// LSRUse. FindUseWithSimilarFormula can&#39;t consider uses with different max</span></CodeLine>
<Link id="l01347" /><CodeLine lineNumber="1347"><span class="doxyHighlightComment">  /// fixup widths to be equivalent, because the narrower one may be relying on</span></CodeLine>
<Link id="l01348" /><CodeLine lineNumber="1348"><span class="doxyHighlightComment">  /// the implicit truncation to truncate away bogus bits.</span></CodeLine>
<Link id="l01349" /><CodeLine lineNumber="1349" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ac6eb6d8e22eb1da2d816c5cb38fe166d"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ac6eb6d8e22eb1da2d816c5cb38fe166d">WidestFixupType</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01350" /><CodeLine lineNumber="1350"></CodeLine>
<Link id="l01351" /><CodeLine lineNumber="1351"><span class="doxyHighlightComment">  /// A list of ways to build a value that can satisfy this user.  After the</span></CodeLine>
<Link id="l01352" /><CodeLine lineNumber="1352"><span class="doxyHighlightComment">  /// list is populated, one of these is selected heuristically and used to</span></CodeLine>
<Link id="l01353" /><CodeLine lineNumber="1353"><span class="doxyHighlightComment">  /// formulate a replacement for OperandValToReplace in UserInst.</span></CodeLine>
<Link id="l01354" /><CodeLine lineNumber="1354" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Formula, 12&gt;</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>;</span></CodeLine>
<Link id="l01355" /><CodeLine lineNumber="1355"></CodeLine>
<Link id="l01356" /><CodeLine lineNumber="1356"><span class="doxyHighlightComment">  /// The set of register candidates used by all formulae in this LSRUse.</span></CodeLine>
<Link id="l01357" /><CodeLine lineNumber="1357" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>;</span></CodeLine>
<Link id="l01358" /><CodeLine lineNumber="1358"></CodeLine>
<Link id="l01359" /><CodeLine lineNumber="1359" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a84a56cc4bd6da1581440b16c21eef5ab">LSRUse</a>(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">KindType</a> K, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a> AT) : <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af414d3b8902f3db57e9f08d3232fc17c">Kind</a>(K), <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>(AT) &#123;&#125;</span></CodeLine>
<Link id="l01360" /><CodeLine lineNumber="1360"></CodeLine>
<Link id="l01361" /><CodeLine lineNumber="1361" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a2fe504663d9ae4f9f4b7d30c6d1b6d69"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a2fe504663d9ae4f9f4b7d30c6d1b6d69">getNewFixup</a>() &#123;</span></CodeLine>
<Link id="l01362" /><CodeLine lineNumber="1362"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>.push&#95;back(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a>());</span></CodeLine>
<Link id="l01363" /><CodeLine lineNumber="1363"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>.back();</span></CodeLine>
<Link id="l01364" /><CodeLine lineNumber="1364"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01365" /><CodeLine lineNumber="1365"></CodeLine>
<Link id="l01366" /><CodeLine lineNumber="1366" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ae24f15680876cc6aab9d451d3b7906dd"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ae24f15680876cc6aab9d451d3b7906dd">pushFixup</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;f) &#123;</span></CodeLine>
<Link id="l01367" /><CodeLine lineNumber="1367"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>.push&#95;back(f);</span></CodeLine>
<Link id="l01368" /><CodeLine lineNumber="1368"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#addaa86bfa4ca26b7f366cbdd868f99bf">Immediate::isKnownGT</a>(f.Offset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#afb7a640470c15f82dc8df85e033d8619">MaxOffset</a>))</span></CodeLine>
<Link id="l01369" /><CodeLine lineNumber="1369"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#afb7a640470c15f82dc8df85e033d8619">MaxOffset</a> = f.Offset;</span></CodeLine>
<Link id="l01370" /><CodeLine lineNumber="1370"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a83e6442f8ebefccdb5e089732fe397ac">Immediate::isKnownLT</a>(f.Offset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a445b231c7c14ab0d460f9a4d70367c8e">MinOffset</a>))</span></CodeLine>
<Link id="l01371" /><CodeLine lineNumber="1371"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a445b231c7c14ab0d460f9a4d70367c8e">MinOffset</a> = f.Offset;</span></CodeLine>
<Link id="l01372" /><CodeLine lineNumber="1372"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01373" /><CodeLine lineNumber="1373"></CodeLine>
<Link id="l01374" /><CodeLine lineNumber="1374"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasFormulaWithSameRegs(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01375" /><CodeLine lineNumber="1375"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight"> getNotSelectedProbability(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01376" /><CodeLine lineNumber="1376"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InsertFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L);</span></CodeLine>
<Link id="l01377" /><CodeLine lineNumber="1377"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> DeleteFormula(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l01378" /><CodeLine lineNumber="1378"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RecomputeRegs(</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &amp;Reguses);</span></CodeLine>
<Link id="l01379" /><CodeLine lineNumber="1379"></CodeLine>
<Link id="l01380" /><CodeLine lineNumber="1380"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01381" /><CodeLine lineNumber="1381"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01382" /><CodeLine lineNumber="1382"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l01383" /><CodeLine lineNumber="1383"></CodeLine>
<Link id="l01384" /><CodeLine lineNumber="1384"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l01385" /><CodeLine lineNumber="1385"></CodeLine>
<Link id="l01386" /><CodeLine lineNumber="1386"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01387" /><CodeLine lineNumber="1387"><span class="doxyHighlight">                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a5e2e44c44911f6002b944a117f686595">MemAccessTy</a> AccessTy,</span></CodeLine>
<Link id="l01388" /><CodeLine lineNumber="1388"><span class="doxyHighlight">                                 <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a0f69a88a74a9c75266b70084a23c7715">Immediate</a> BaseOffset,</span></CodeLine>
<Link id="l01389" /><CodeLine lineNumber="1389"><span class="doxyHighlight">                                 </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasBaseReg, int64&#95;t Scale,</span></CodeLine>
<Link id="l01390" /><CodeLine lineNumber="1390"><span class="doxyHighlight">                                 <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01391" /><CodeLine lineNumber="1391"></CodeLine>
<Link id="l01392" /><CodeLine lineNumber="1392" lineLink="#ae51d322caa9d6592ff524f98563eac36"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>) &#123;</span></CodeLine>
<Link id="l01393" /><CodeLine lineNumber="1393"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) || <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01394" /><CodeLine lineNumber="1394"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> 1;</span></CodeLine>
<Link id="l01395" /><CodeLine lineNumber="1395"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> == 0)</span></CodeLine>
<Link id="l01396" /><CodeLine lineNumber="1396"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> 0;</span></CodeLine>
<Link id="l01397" /><CodeLine lineNumber="1397"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01398" /><CodeLine lineNumber="1398"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(S-&gt;getStart(), <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> - 1);</span></CodeLine>
<Link id="l01399" /><CodeLine lineNumber="1399"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVIntegralCastExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01400" /><CodeLine lineNumber="1400"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(S-&gt;getOperand(), <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> - 1);</span></CodeLine>
<Link id="l01401" /><CodeLine lineNumber="1401"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVNAryExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01402" /><CodeLine lineNumber="1402"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::accumulate(S-&gt;operands().begin(), S-&gt;operands().end(), 0,</span></CodeLine>
<Link id="l01403" /><CodeLine lineNumber="1403"><span class="doxyHighlight">                           &#91;&amp;&#93;(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &#123;</span></CodeLine>
<Link id="l01404" /><CodeLine lineNumber="1404"><span class="doxyHighlight">                             return i + getSetupCost(Reg, Depth - 1);</span></CodeLine>
<Link id="l01405" /><CodeLine lineNumber="1405"><span class="doxyHighlight">                           &#125;);</span></CodeLine>
<Link id="l01406" /><CodeLine lineNumber="1406"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUDivExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01407" /><CodeLine lineNumber="1407"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(S-&gt;getLHS(), <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> - 1) +</span></CodeLine>
<Link id="l01408" /><CodeLine lineNumber="1408"><span class="doxyHighlight">           <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(S-&gt;getRHS(), <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> - 1);</span></CodeLine>
<Link id="l01409" /><CodeLine lineNumber="1409"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> 0;</span></CodeLine>
<Link id="l01410" /><CodeLine lineNumber="1410"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01411" /><CodeLine lineNumber="1411"></CodeLine>
<Link id="l01412" /><CodeLine lineNumber="1412"><span class="doxyHighlightComment">/// Tally up interesting quantities from the given register.</span></CodeLine>
<Link id="l01413" /><CodeLine lineNumber="1413"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> Cost::RateRegister(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</span></CodeLine>
<Link id="l01414" /><CodeLine lineNumber="1414"><span class="doxyHighlight">                        <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs) &#123;</span></CodeLine>
<Link id="l01415" /><CodeLine lineNumber="1415"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> SCEVAddRecExpr &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</span></CodeLine>
<Link id="l01416" /><CodeLine lineNumber="1416"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this is an addrec for another loop, it should be an invariant</span></CodeLine>
<Link id="l01417" /><CodeLine lineNumber="1417"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// with respect to L since L is the innermost loop (at least</span></CodeLine>
<Link id="l01418" /><CodeLine lineNumber="1418"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// for now LSR only handles innermost loops).</span></CodeLine>
<Link id="l01419" /><CodeLine lineNumber="1419"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AR-&gt;getLoop() != L) &#123;</span></CodeLine>
<Link id="l01420" /><CodeLine lineNumber="1420"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If the AddRec exists, consider it&#39;s register free and leave it alone.</span></CodeLine>
<Link id="l01421" /><CodeLine lineNumber="1421"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a3c81223cabf643af27adba3b3ceb680c">isExistingPhi</a>(AR, &#42;SE) &amp;&amp; AMK != <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>)</span></CodeLine>
<Link id="l01422" /><CodeLine lineNumber="1422"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01423" /><CodeLine lineNumber="1423"></CodeLine>
<Link id="l01424" /><CodeLine lineNumber="1424"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// It is bad to allow LSR for current loop to add induction variables</span></CodeLine>
<Link id="l01425" /><CodeLine lineNumber="1425"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// for its sibling loops.</span></CodeLine>
<Link id="l01426" /><CodeLine lineNumber="1426"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!AR-&gt;getLoop()-&gt;contains(L)) &#123;</span></CodeLine>
<Link id="l01427" /><CodeLine lineNumber="1427"><span class="doxyHighlight">        Lose();</span></CodeLine>
<Link id="l01428" /><CodeLine lineNumber="1428"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01429" /><CodeLine lineNumber="1429"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01430" /><CodeLine lineNumber="1430"></CodeLine>
<Link id="l01431" /><CodeLine lineNumber="1431"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Otherwise, it will be an invariant with respect to Loop L.</span></CodeLine>
<Link id="l01432" /><CodeLine lineNumber="1432"><span class="doxyHighlight">      ++<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumRegs;</span></CodeLine>
<Link id="l01433" /><CodeLine lineNumber="1433"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01434" /><CodeLine lineNumber="1434"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01435" /><CodeLine lineNumber="1435"></CodeLine>
<Link id="l01436" /><CodeLine lineNumber="1436"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LoopCost = 1;</span></CodeLine>
<Link id="l01437" /><CodeLine lineNumber="1437"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>-&gt;<a href="/docs/api/classes/llvm/targettransforminfo/#a7716bda26c61738e624214efa149e83e">isIndexedLoadLegal</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>-&gt;<a href="/docs/api/classes/llvm/targettransforminfo/#acf5cc8324c33cb1f59869456263f9f4ba3a471f30b7a193785b57c081776ad3cb">MIM&#95;PostInc</a>, AR-&gt;getType()) ||</span></CodeLine>
<Link id="l01438" /><CodeLine lineNumber="1438"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>-&gt;<a href="/docs/api/classes/llvm/targettransforminfo/#a5a768ef7bcf1b5059f409327c1f83591">isIndexedStoreLegal</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>-&gt;<a href="/docs/api/classes/llvm/targettransforminfo/#acf5cc8324c33cb1f59869456263f9f4ba3a471f30b7a193785b57c081776ad3cb">MIM&#95;PostInc</a>, AR-&gt;getType())) &#123;</span></CodeLine>
<Link id="l01439" /><CodeLine lineNumber="1439"></CodeLine>
<Link id="l01440" /><CodeLine lineNumber="1440"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If the step size matches the base offset, we could use pre-indexed</span></CodeLine>
<Link id="l01441" /><CodeLine lineNumber="1441"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// addressing.</span></CodeLine>
<Link id="l01442" /><CodeLine lineNumber="1442"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a7cb26b7792c751612e634c36dce16f9a">TTI::AMK&#95;PreIndexed</a> &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isFixed()) &#123;</span></CodeLine>
<Link id="l01443" /><CodeLine lineNumber="1443"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;Step = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(AR-&gt;getStepRecurrence(&#42;SE)))</span></CodeLine>
<Link id="l01444" /><CodeLine lineNumber="1444"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Step-&gt;getAPInt() == <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.getFixedValue())</span></CodeLine>
<Link id="l01445" /><CodeLine lineNumber="1445"><span class="doxyHighlight">            LoopCost = 0;</span></CodeLine>
<Link id="l01446" /><CodeLine lineNumber="1446"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>) &#123;</span></CodeLine>
<Link id="l01447" /><CodeLine lineNumber="1447"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> SCEV &#42;LoopStep = AR-&gt;getStepRecurrence(&#42;SE);</span></CodeLine>
<Link id="l01448" /><CodeLine lineNumber="1448"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(LoopStep)) &#123;</span></CodeLine>
<Link id="l01449" /><CodeLine lineNumber="1449"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> SCEV &#42;LoopStart = AR-&gt;getStart();</span></CodeLine>
<Link id="l01450" /><CodeLine lineNumber="1450"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(LoopStart) &amp;&amp;</span></CodeLine>
<Link id="l01451" /><CodeLine lineNumber="1451"><span class="doxyHighlight">              SE-&gt;isLoopInvariant(LoopStart, L))</span></CodeLine>
<Link id="l01452" /><CodeLine lineNumber="1452"><span class="doxyHighlight">            LoopCost = 0;</span></CodeLine>
<Link id="l01453" /><CodeLine lineNumber="1453"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01454" /><CodeLine lineNumber="1454"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01455" /><CodeLine lineNumber="1455"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01456" /><CodeLine lineNumber="1456"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.AddRecCost += LoopCost;</span></CodeLine>
<Link id="l01457" /><CodeLine lineNumber="1457"></CodeLine>
<Link id="l01458" /><CodeLine lineNumber="1458"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Add the step value register, if it needs one.</span></CodeLine>
<Link id="l01459" /><CodeLine lineNumber="1459"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// TODO: The non-affine case isn&#39;t precisely modeled here.</span></CodeLine>
<Link id="l01460" /><CodeLine lineNumber="1460"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!AR-&gt;isAffine() || !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(AR-&gt;getOperand(1))) &#123;</span></CodeLine>
<Link id="l01461" /><CodeLine lineNumber="1461"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Regs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(AR-&gt;getOperand(1))) &#123;</span></CodeLine>
<Link id="l01462" /><CodeLine lineNumber="1462"><span class="doxyHighlight">        RateRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, AR-&gt;getOperand(1), Regs);</span></CodeLine>
<Link id="l01463" /><CodeLine lineNumber="1463"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (isLoser())</span></CodeLine>
<Link id="l01464" /><CodeLine lineNumber="1464"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01465" /><CodeLine lineNumber="1465"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01466" /><CodeLine lineNumber="1466"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01467" /><CodeLine lineNumber="1467"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01468" /><CodeLine lineNumber="1468"><span class="doxyHighlight">  ++<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumRegs;</span></CodeLine>
<Link id="l01469" /><CodeLine lineNumber="1469"></CodeLine>
<Link id="l01470" /><CodeLine lineNumber="1470"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Rough heuristic; favor registers which don&#39;t require extra setup</span></CodeLine>
<Link id="l01471" /><CodeLine lineNumber="1471"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instructions in the preheader.</span></CodeLine>
<Link id="l01472" /><CodeLine lineNumber="1472"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost += <a href="#ae51d322caa9d6592ff524f98563eac36">getSetupCost</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, <a href="#af7597e13dc8bb8a3af795f41314f157f">SetupCostDepthLimit</a>);</span></CodeLine>
<Link id="l01473" /><CodeLine lineNumber="1473"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Ensure we don&#39;t, even with the recusion limit, produce invalid costs.</span></CodeLine>
<Link id="l01474" /><CodeLine lineNumber="1474"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost = std::min&lt;unsigned&gt;(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost, 1 &lt;&lt; 16);</span></CodeLine>
<Link id="l01475" /><CodeLine lineNumber="1475"></CodeLine>
<Link id="l01476" /><CodeLine lineNumber="1476"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumIVMuls += <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVMulExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &amp;&amp;</span></CodeLine>
<Link id="l01477" /><CodeLine lineNumber="1477"><span class="doxyHighlight">               SE-&gt;hasComputableLoopEvolution(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, L);</span></CodeLine>
<Link id="l01478" /><CodeLine lineNumber="1478"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01479" /><CodeLine lineNumber="1479"></CodeLine>
<Link id="l01480" /><CodeLine lineNumber="1480"><span class="doxyHighlightComment">/// Record this register in the set. If we haven&#39;t seen it before, rate</span></CodeLine>
<Link id="l01481" /><CodeLine lineNumber="1481"><span class="doxyHighlightComment">/// it. Optional LoserRegs provides a way to declare any formula that refers to</span></CodeLine>
<Link id="l01482" /><CodeLine lineNumber="1482"><span class="doxyHighlightComment">/// one of those regs an instant loser.</span></CodeLine>
<Link id="l01483" /><CodeLine lineNumber="1483"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> Cost::RatePrimaryRegister(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</span></CodeLine>
<Link id="l01484" /><CodeLine lineNumber="1484"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs,</span></CodeLine>
<Link id="l01485" /><CodeLine lineNumber="1485"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &#42;LoserRegs) &#123;</span></CodeLine>
<Link id="l01486" /><CodeLine lineNumber="1486"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LoserRegs &amp;&amp; LoserRegs-&gt;<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</span></CodeLine>
<Link id="l01487" /><CodeLine lineNumber="1487"><span class="doxyHighlight">    Lose();</span></CodeLine>
<Link id="l01488" /><CodeLine lineNumber="1488"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01489" /><CodeLine lineNumber="1489"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01490" /><CodeLine lineNumber="1490"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Regs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>).second) &#123;</span></CodeLine>
<Link id="l01491" /><CodeLine lineNumber="1491"><span class="doxyHighlight">    RateRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, Regs);</span></CodeLine>
<Link id="l01492" /><CodeLine lineNumber="1492"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LoserRegs &amp;&amp; isLoser())</span></CodeLine>
<Link id="l01493" /><CodeLine lineNumber="1493"><span class="doxyHighlight">      LoserRegs-&gt;<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l01494" /><CodeLine lineNumber="1494"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01495" /><CodeLine lineNumber="1495"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01496" /><CodeLine lineNumber="1496"></CodeLine>
<Link id="l01497" /><CodeLine lineNumber="1497" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#abd90406531e76ab0007b8cf6ebe8b34d"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> Cost::RateFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l01498" /><CodeLine lineNumber="1498"><span class="doxyHighlight">                       <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &amp;Regs,</span></CodeLine>
<Link id="l01499" /><CodeLine lineNumber="1499"><span class="doxyHighlight">                       </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> &amp;VisitedRegs,</span></CodeLine>
<Link id="l01500" /><CodeLine lineNumber="1500"><span class="doxyHighlight">                       </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU,</span></CodeLine>
<Link id="l01501" /><CodeLine lineNumber="1501"><span class="doxyHighlight">                       <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const SCEV &#42;&gt;</a> &#42;LoserRegs) &#123;</span></CodeLine>
<Link id="l01502" /><CodeLine lineNumber="1502"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed">isLoser</a>())</span></CodeLine>
<Link id="l01503" /><CodeLine lineNumber="1503"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01504" /><CodeLine lineNumber="1504"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isCanonical(&#42;L) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Cost is accurate only for canonical formula&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01505" /><CodeLine lineNumber="1505"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Tally up the registers.</span></CodeLine>
<Link id="l01506" /><CodeLine lineNumber="1506"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> PrevAddRecCost = C.AddRecCost;</span></CodeLine>
<Link id="l01507" /><CodeLine lineNumber="1507"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> PrevNumRegs = C.NumRegs;</span></CodeLine>
<Link id="l01508" /><CodeLine lineNumber="1508"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> PrevNumBaseAdds = C.NumBaseAdds;</span></CodeLine>
<Link id="l01509" /><CodeLine lineNumber="1509"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;ScaledReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) &#123;</span></CodeLine>
<Link id="l01510" /><CodeLine lineNumber="1510"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VisitedRegs.<a href="/docs/api/classes/llvm/detail/densesetimpl/#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(ScaledReg)) &#123;</span></CodeLine>
<Link id="l01511" /><CodeLine lineNumber="1511"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad3242d77b21293a7423564fc64997620">Lose</a>();</span></CodeLine>
<Link id="l01512" /><CodeLine lineNumber="1512"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01513" /><CodeLine lineNumber="1513"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01514" /><CodeLine lineNumber="1514"><span class="doxyHighlight">    RatePrimaryRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, ScaledReg, Regs, LoserRegs);</span></CodeLine>
<Link id="l01515" /><CodeLine lineNumber="1515"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed">isLoser</a>())</span></CodeLine>
<Link id="l01516" /><CodeLine lineNumber="1516"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01517" /><CodeLine lineNumber="1517"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01518" /><CodeLine lineNumber="1518"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</span></CodeLine>
<Link id="l01519" /><CodeLine lineNumber="1519"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VisitedRegs.<a href="/docs/api/classes/llvm/detail/densesetimpl/#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(BaseReg)) &#123;</span></CodeLine>
<Link id="l01520" /><CodeLine lineNumber="1520"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad3242d77b21293a7423564fc64997620">Lose</a>();</span></CodeLine>
<Link id="l01521" /><CodeLine lineNumber="1521"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01522" /><CodeLine lineNumber="1522"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01523" /><CodeLine lineNumber="1523"><span class="doxyHighlight">    RatePrimaryRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, BaseReg, Regs, LoserRegs);</span></CodeLine>
<Link id="l01524" /><CodeLine lineNumber="1524"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a63672bd06cae85a3209b2752fd27b5ed">isLoser</a>())</span></CodeLine>
<Link id="l01525" /><CodeLine lineNumber="1525"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01526" /><CodeLine lineNumber="1526"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01527" /><CodeLine lineNumber="1527"></CodeLine>
<Link id="l01528" /><CodeLine lineNumber="1528"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Determine how many (unfolded) adds we&#39;ll need inside the loop.</span></CodeLine>
<Link id="l01529" /><CodeLine lineNumber="1529"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> NumBaseParts = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs();</span></CodeLine>
<Link id="l01530" /><CodeLine lineNumber="1530"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NumBaseParts &gt; 1)</span></CodeLine>
<Link id="l01531" /><CodeLine lineNumber="1531"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Do not count the base and a possible second register if the target</span></CodeLine>
<Link id="l01532" /><CodeLine lineNumber="1532"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// allows to fold 2 registers.</span></CodeLine>
<Link id="l01533" /><CodeLine lineNumber="1533"><span class="doxyHighlight">    C.NumBaseAdds +=</span></CodeLine>
<Link id="l01534" /><CodeLine lineNumber="1534"><span class="doxyHighlight">        NumBaseParts - (1 + (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale &amp;&amp; <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(&#42;TTI, LU, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)));</span></CodeLine>
<Link id="l01535" /><CodeLine lineNumber="1535"><span class="doxyHighlight">  C.NumBaseAdds += (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isNonZero());</span></CodeLine>
<Link id="l01536" /><CodeLine lineNumber="1536"></CodeLine>
<Link id="l01537" /><CodeLine lineNumber="1537"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Accumulate non-free scaling amounts.</span></CodeLine>
<Link id="l01538" /><CodeLine lineNumber="1538"><span class="doxyHighlight">  C.ScaleCost += &#42;<a href="#a3cbf7279944dc2f0f99a6896501277f9">getScalingFactorCost</a>(&#42;TTI, LU, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &#42;L).<a href="/docs/api/classes/llvm/instructioncost/#a9b642067999075ba996ecdee40b52b68">getValue</a>();</span></CodeLine>
<Link id="l01539" /><CodeLine lineNumber="1539"></CodeLine>
<Link id="l01540" /><CodeLine lineNumber="1540"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Tally up the non-zero immediates.</span></CodeLine>
<Link id="l01541" /><CodeLine lineNumber="1541"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : LU.Fixups) &#123;</span></CodeLine>
<Link id="l01542" /><CodeLine lineNumber="1542"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset.isCompatibleImmediate(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset)) &#123;</span></CodeLine>
<Link id="l01543" /><CodeLine lineNumber="1543"><span class="doxyHighlight">      <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset.addUnsigned(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset);</span></CodeLine>
<Link id="l01544" /><CodeLine lineNumber="1544"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV)</span></CodeLine>
<Link id="l01545" /><CodeLine lineNumber="1545"><span class="doxyHighlight">        C.ImmCost += 64; </span><span class="doxyHighlightComment">// Handle symbolic values conservatively.</span></CodeLine>
<Link id="l01546" /><CodeLine lineNumber="1546"><span class="doxyHighlight">                         </span><span class="doxyHighlightComment">// TODO: This should probably be the pointer size.</span></CodeLine>
<Link id="l01547" /><CodeLine lineNumber="1547"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isNonZero())</span></CodeLine>
<Link id="l01548" /><CodeLine lineNumber="1548"><span class="doxyHighlight">        C.ImmCost +=</span></CodeLine>
<Link id="l01549" /><CodeLine lineNumber="1549"><span class="doxyHighlight">            <a href="/docs/api/classes/llvm/apint">APInt</a>(64, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getKnownMinValue(), </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">).<a href="/docs/api/classes/llvm/apint/#a9f78d7e839322a6bfc0c665d29052242">getSignificantBits</a>();</span></CodeLine>
<Link id="l01550" /><CodeLine lineNumber="1550"></CodeLine>
<Link id="l01551" /><CodeLine lineNumber="1551"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Check with target if this offset with this instruction is</span></CodeLine>
<Link id="l01552" /><CodeLine lineNumber="1552"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// specifically not supported.</span></CodeLine>
<Link id="l01553" /><CodeLine lineNumber="1553"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> &amp;&amp; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isNonZero() &amp;&amp;</span></CodeLine>
<Link id="l01554" /><CodeLine lineNumber="1554"><span class="doxyHighlight">          !<a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(&#42;TTI, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV,</span></CodeLine>
<Link id="l01555" /><CodeLine lineNumber="1555"><span class="doxyHighlight">                                <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale, <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst))</span></CodeLine>
<Link id="l01556" /><CodeLine lineNumber="1556"><span class="doxyHighlight">        C.NumBaseAdds++;</span></CodeLine>
<Link id="l01557" /><CodeLine lineNumber="1557"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01558" /><CodeLine lineNumber="1558"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Incompatible immediate type, increase cost to avoid using</span></CodeLine>
<Link id="l01559" /><CodeLine lineNumber="1559"><span class="doxyHighlight">      C.ImmCost += 2048;</span></CodeLine>
<Link id="l01560" /><CodeLine lineNumber="1560"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01561" /><CodeLine lineNumber="1561"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01562" /><CodeLine lineNumber="1562"></CodeLine>
<Link id="l01563" /><CodeLine lineNumber="1563"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we don&#39;t count instruction cost exit here.</span></CodeLine>
<Link id="l01564" /><CodeLine lineNumber="1564"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a>) &#123;</span></CodeLine>
<Link id="l01565" /><CodeLine lineNumber="1565"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/instructioncost/#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;invalid cost&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01566" /><CodeLine lineNumber="1566"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01567" /><CodeLine lineNumber="1567"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01568" /><CodeLine lineNumber="1568"></CodeLine>
<Link id="l01569" /><CodeLine lineNumber="1569"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Treat every new register that exceeds TTI.getNumberOfRegisters() - 1 as</span></CodeLine>
<Link id="l01570" /><CodeLine lineNumber="1570"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// additional instruction (at least fill).</span></CodeLine>
<Link id="l01571" /><CodeLine lineNumber="1571"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: Need distinguish register class?</span></CodeLine>
<Link id="l01572" /><CodeLine lineNumber="1572"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> TTIRegNum = TTI-&gt;getNumberOfRegisters(</span></CodeLine>
<Link id="l01573" /><CodeLine lineNumber="1573"><span class="doxyHighlight">                       TTI-&gt;getRegisterClassForType(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getType())) - 1;</span></CodeLine>
<Link id="l01574" /><CodeLine lineNumber="1574"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (C.NumRegs &gt; TTIRegNum) &#123;</span></CodeLine>
<Link id="l01575" /><CodeLine lineNumber="1575"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Cost already exceeded TTIRegNum, then only newly added register can add</span></CodeLine>
<Link id="l01576" /><CodeLine lineNumber="1576"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// new instructions.</span></CodeLine>
<Link id="l01577" /><CodeLine lineNumber="1577"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PrevNumRegs &gt; TTIRegNum)</span></CodeLine>
<Link id="l01578" /><CodeLine lineNumber="1578"><span class="doxyHighlight">      C.Insns += (C.NumRegs - PrevNumRegs);</span></CodeLine>
<Link id="l01579" /><CodeLine lineNumber="1579"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l01580" /><CodeLine lineNumber="1580"><span class="doxyHighlight">      C.Insns += (C.NumRegs - TTIRegNum);</span></CodeLine>
<Link id="l01581" /><CodeLine lineNumber="1581"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01582" /><CodeLine lineNumber="1582"></CodeLine>
<Link id="l01583" /><CodeLine lineNumber="1583"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If ICmpZero formula ends with not 0, it could not be replaced by</span></CodeLine>
<Link id="l01584" /><CodeLine lineNumber="1584"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// just add or sub. We&#39;ll need to compare final result of AddRec.</span></CodeLine>
<Link id="l01585" /><CodeLine lineNumber="1585"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// That means we&#39;ll need an additional instruction. But if the target can</span></CodeLine>
<Link id="l01586" /><CodeLine lineNumber="1586"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// macro-fuse a compare with a branch, don&#39;t count this extra instruction.</span></CodeLine>
<Link id="l01587" /><CodeLine lineNumber="1587"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For -10 + &#123;0, +, 1&#125;:</span></CodeLine>
<Link id="l01588" /><CodeLine lineNumber="1588"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// i = i + 1;</span></CodeLine>
<Link id="l01589" /><CodeLine lineNumber="1589"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// cmp i, 10</span></CodeLine>
<Link id="l01590" /><CodeLine lineNumber="1590"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01591" /><CodeLine lineNumber="1591"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For &#123;-10, +, 1&#125;:</span></CodeLine>
<Link id="l01592" /><CodeLine lineNumber="1592"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// i = i + 1;</span></CodeLine>
<Link id="l01593" /><CodeLine lineNumber="1593"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> &amp;&amp; !<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasZeroEnd() &amp;&amp;</span></CodeLine>
<Link id="l01594" /><CodeLine lineNumber="1594"><span class="doxyHighlight">      !TTI-&gt;canMacroFuseCmp())</span></CodeLine>
<Link id="l01595" /><CodeLine lineNumber="1595"><span class="doxyHighlight">    C.Insns++;</span></CodeLine>
<Link id="l01596" /><CodeLine lineNumber="1596"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Each new AddRec adds 1 instruction to calculation.</span></CodeLine>
<Link id="l01597" /><CodeLine lineNumber="1597"><span class="doxyHighlight">  C.Insns += (C.AddRecCost - PrevAddRecCost);</span></CodeLine>
<Link id="l01598" /><CodeLine lineNumber="1598"></CodeLine>
<Link id="l01599" /><CodeLine lineNumber="1599"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// BaseAdds adds instructions for unfolded registers.</span></CodeLine>
<Link id="l01600" /><CodeLine lineNumber="1600"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>)</span></CodeLine>
<Link id="l01601" /><CodeLine lineNumber="1601"><span class="doxyHighlight">    C.Insns += C.NumBaseAdds - PrevNumBaseAdds;</span></CodeLine>
<Link id="l01602" /><CodeLine lineNumber="1602"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/instructioncost/#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;invalid cost&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01603" /><CodeLine lineNumber="1603"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01604" /><CodeLine lineNumber="1604"></CodeLine>
<Link id="l01605" /><CodeLine lineNumber="1605"><span class="doxyHighlightComment">/// Set this cost to a losing value.</span></CodeLine>
<Link id="l01606" /><CodeLine lineNumber="1606" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad3242d77b21293a7423564fc64997620"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> Cost::Lose() &#123;</span></CodeLine>
<Link id="l01607" /><CodeLine lineNumber="1607"><span class="doxyHighlight">  C.Insns = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l01608" /><CodeLine lineNumber="1608"><span class="doxyHighlight">  C.NumRegs = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l01609" /><CodeLine lineNumber="1609"><span class="doxyHighlight">  C.AddRecCost = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l01610" /><CodeLine lineNumber="1610"><span class="doxyHighlight">  C.NumIVMuls = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l01611" /><CodeLine lineNumber="1611"><span class="doxyHighlight">  C.NumBaseAdds = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l01612" /><CodeLine lineNumber="1612"><span class="doxyHighlight">  C.ImmCost = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l01613" /><CodeLine lineNumber="1613"><span class="doxyHighlight">  C.SetupCost = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l01614" /><CodeLine lineNumber="1614"><span class="doxyHighlight">  C.ScaleCost = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l01615" /><CodeLine lineNumber="1615"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01616" /><CodeLine lineNumber="1616"></CodeLine>
<Link id="l01617" /><CodeLine lineNumber="1617"><span class="doxyHighlightComment">/// Choose the lower cost.</span></CodeLine>
<Link id="l01618" /><CodeLine lineNumber="1618" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#a60988944a715f927e4c1210fe049f3fa"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Cost::isLess(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ad60603979ceadc6c0b683403e7131646">Cost</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01619" /><CodeLine lineNumber="1619"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a>.getNumOccurrences() &gt; 0 &amp;&amp; <a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a> &amp;&amp;</span></CodeLine>
<Link id="l01620" /><CodeLine lineNumber="1620"><span class="doxyHighlight">      C.Insns != <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.C.Insns)</span></CodeLine>
<Link id="l01621" /><CodeLine lineNumber="1621"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> C.Insns &lt; <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.C.Insns;</span></CodeLine>
<Link id="l01622" /><CodeLine lineNumber="1622"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> TTI-&gt;isLSRCostLess(C, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.C);</span></CodeLine>
<Link id="l01623" /><CodeLine lineNumber="1623"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01624" /><CodeLine lineNumber="1624"></CodeLine>
<Link id="l01625" /><CodeLine lineNumber="1625"><span class="doxyHighlightPreprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</span></CodeLine>
<Link id="l01626" /><CodeLine lineNumber="1626"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/instructioncost/#a7a0b7d0565cbdb80fcc368365bf86c9c">Cost::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01627" /><CodeLine lineNumber="1627"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a3d46ca97222c953c0d38e65b728e0f7b">InsnsCost</a>)</span></CodeLine>
<Link id="l01628" /><CodeLine lineNumber="1628"><span class="doxyHighlight">    OS &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.Insns &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; instruction&quot;</span><span class="doxyHighlight"> &lt;&lt; (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.Insns == 1 ? </span><span class="doxyHighlightStringLiteral">&quot; &quot;</span><span class="doxyHighlight"> : </span><span class="doxyHighlightStringLiteral">&quot;s &quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01629" /><CodeLine lineNumber="1629"><span class="doxyHighlight">  OS &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumRegs &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; reg&quot;</span><span class="doxyHighlight"> &lt;&lt; (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumRegs == 1 ? </span><span class="doxyHighlightStringLiteral">&quot;&quot;</span><span class="doxyHighlight"> : </span><span class="doxyHighlightStringLiteral">&quot;s&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01630" /><CodeLine lineNumber="1630"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.AddRecCost != 0)</span></CodeLine>
<Link id="l01631" /><CodeLine lineNumber="1631"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, with addrec cost &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.AddRecCost;</span></CodeLine>
<Link id="l01632" /><CodeLine lineNumber="1632"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumIVMuls != 0)</span></CodeLine>
<Link id="l01633" /><CodeLine lineNumber="1633"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, plus &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumIVMuls &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; IV mul&quot;</span></CodeLine>
<Link id="l01634" /><CodeLine lineNumber="1634"><span class="doxyHighlight">       &lt;&lt; (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumIVMuls == 1 ? </span><span class="doxyHighlightStringLiteral">&quot;&quot;</span><span class="doxyHighlight"> : </span><span class="doxyHighlightStringLiteral">&quot;s&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01635" /><CodeLine lineNumber="1635"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumBaseAdds != 0)</span></CodeLine>
<Link id="l01636" /><CodeLine lineNumber="1636"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, plus &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumBaseAdds &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; base add&quot;</span></CodeLine>
<Link id="l01637" /><CodeLine lineNumber="1637"><span class="doxyHighlight">       &lt;&lt; (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.NumBaseAdds == 1 ? </span><span class="doxyHighlightStringLiteral">&quot;&quot;</span><span class="doxyHighlight"> : </span><span class="doxyHighlightStringLiteral">&quot;s&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01638" /><CodeLine lineNumber="1638"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.ScaleCost != 0)</span></CodeLine>
<Link id="l01639" /><CodeLine lineNumber="1639"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, plus &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.ScaleCost &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; scale cost&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01640" /><CodeLine lineNumber="1640"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.ImmCost != 0)</span></CodeLine>
<Link id="l01641" /><CodeLine lineNumber="1641"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, plus &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.ImmCost &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; imm cost&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01642" /><CodeLine lineNumber="1642"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost != 0)</span></CodeLine>
<Link id="l01643" /><CodeLine lineNumber="1643"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, plus &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>.SetupCost &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; setup cost&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01644" /><CodeLine lineNumber="1644"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01645" /><CodeLine lineNumber="1645"></CodeLine>
<Link id="l01646" /><CodeLine lineNumber="1646" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost/#ab9ff5264fbc3faf5b26768f683a43e59"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> Cost::dump()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01647" /><CodeLine lineNumber="1647"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/instructioncost/#a7a0b7d0565cbdb80fcc368365bf86c9c">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01648" /><CodeLine lineNumber="1648"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01649" /><CodeLine lineNumber="1649"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01650" /><CodeLine lineNumber="1650"></CodeLine>
<Link id="l01651" /><CodeLine lineNumber="1651"><span class="doxyHighlightComment">/// Test whether this fixup always uses its value outside of the given loop.</span></CodeLine>
<Link id="l01652" /><CodeLine lineNumber="1652" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ab5814e2a785fccd6bdcfccc78286fc10"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#ab5814e2a785fccd6bdcfccc78286fc10">LSRFixup::isUseFullyOutsideLoop</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01653" /><CodeLine lineNumber="1653"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// PHI nodes use their value in their incoming blocks.</span></CodeLine>
<Link id="l01654" /><CodeLine lineNumber="1654"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>)) &#123;</span></CodeLine>
<Link id="l01655" /><CodeLine lineNumber="1655"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = PN-&gt;getNumIncomingValues(); i != e; ++i)</span></CodeLine>
<Link id="l01656" /><CodeLine lineNumber="1656"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PN-&gt;getIncomingValue(i) == <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a2ee07fa1e186cc7e152f3e5ed2a1c3cc">OperandValToReplace</a> &amp;&amp;</span></CodeLine>
<Link id="l01657" /><CodeLine lineNumber="1657"><span class="doxyHighlight">          L-&gt;contains(PN-&gt;getIncomingBlock(i)))</span></CodeLine>
<Link id="l01658" /><CodeLine lineNumber="1658"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01659" /><CodeLine lineNumber="1659"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01660" /><CodeLine lineNumber="1660"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01661" /><CodeLine lineNumber="1661"></CodeLine>
<Link id="l01662" /><CodeLine lineNumber="1662"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !L-&gt;contains(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>);</span></CodeLine>
<Link id="l01663" /><CodeLine lineNumber="1663"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01664" /><CodeLine lineNumber="1664"></CodeLine>
<Link id="l01665" /><CodeLine lineNumber="1665"><span class="doxyHighlightPreprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</span></CodeLine>
<Link id="l01666" /><CodeLine lineNumber="1666" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#aa7f24a759cb17285abd90cfa12e030c1"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#aa7f24a759cb17285abd90cfa12e030c1">LSRFixup::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01667" /><CodeLine lineNumber="1667"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;UserInst=&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01668" /><CodeLine lineNumber="1668"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Store is common and interesting enough to be worth special-casing.</span></CodeLine>
<Link id="l01669" /><CodeLine lineNumber="1669"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/storeinst">StoreInst</a> &#42;Store = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;StoreInst&gt;</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>)) &#123;</span></CodeLine>
<Link id="l01670" /><CodeLine lineNumber="1670"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;store &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01671" /><CodeLine lineNumber="1671"><span class="doxyHighlight">    Store-&gt;getOperand(0)-&gt;printAsOperand(OS, </span><span class="doxyHighlightComment">/&#42;PrintType=&#42;/</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01672" /><CodeLine lineNumber="1672"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>-&gt;getType()-&gt;isVoidTy())</span></CodeLine>
<Link id="l01673" /><CodeLine lineNumber="1673"><span class="doxyHighlight">    OS &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>-&gt;getOpcodeName();</span></CodeLine>
<Link id="l01674" /><CodeLine lineNumber="1674"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l01675" /><CodeLine lineNumber="1675"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a7460d287f210b8a72e8e9af4685f4684">UserInst</a>-&gt;printAsOperand(OS, </span><span class="doxyHighlightComment">/&#42;PrintType=&#42;/</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01676" /><CodeLine lineNumber="1676"></CodeLine>
<Link id="l01677" /><CodeLine lineNumber="1677"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, OperandValToReplace=&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01678" /><CodeLine lineNumber="1678"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a2ee07fa1e186cc7e152f3e5ed2a1c3cc">OperandValToReplace</a>-&gt;printAsOperand(OS, </span><span class="doxyHighlightComment">/&#42;PrintType=&#42;/</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01679" /><CodeLine lineNumber="1679"></CodeLine>
<Link id="l01680" /><CodeLine lineNumber="1680"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;PIL : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a70aa44719a26fecd9a48e86edcb69b51">PostIncLoops</a>) &#123;</span></CodeLine>
<Link id="l01681" /><CodeLine lineNumber="1681"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, PostIncLoop=&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01682" /><CodeLine lineNumber="1682"><span class="doxyHighlight">    PIL-&gt;getHeader()-&gt;printAsOperand(OS, </span><span class="doxyHighlightComment">/&#42;PrintType=&#42;/</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01683" /><CodeLine lineNumber="1683"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01684" /><CodeLine lineNumber="1684"></CodeLine>
<Link id="l01685" /><CodeLine lineNumber="1685"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a6d9b5bf6278b280c61b1c37375cad241">Offset</a>.isNonZero())</span></CodeLine>
<Link id="l01686" /><CodeLine lineNumber="1686"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, Offset=&quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a6d9b5bf6278b280c61b1c37375cad241">Offset</a>;</span></CodeLine>
<Link id="l01687" /><CodeLine lineNumber="1687"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01688" /><CodeLine lineNumber="1688"></CodeLine>
<Link id="l01689" /><CodeLine lineNumber="1689" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a17103d1dadfcbedb1b4455345d844dc1"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#a17103d1dadfcbedb1b4455345d844dc1">LSRFixup::dump</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01690" /><CodeLine lineNumber="1690"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01691" /><CodeLine lineNumber="1691"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01692" /><CodeLine lineNumber="1692"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01693" /><CodeLine lineNumber="1693"></CodeLine>
<Link id="l01694" /><CodeLine lineNumber="1694"><span class="doxyHighlightComment">/// Test whether this use as a formula which has the same registers as the given</span></CodeLine>
<Link id="l01695" /><CodeLine lineNumber="1695"><span class="doxyHighlightComment">/// formula.</span></CodeLine>
<Link id="l01696" /><CodeLine lineNumber="1696" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a389c4d3c542f309b3ad61e8966fb930a"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a389c4d3c542f309b3ad61e8966fb930a">LSRUse::HasFormulaWithSameRegs</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01697" /><CodeLine lineNumber="1697"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs;</span></CodeLine>
<Link id="l01698" /><CodeLine lineNumber="1698"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>.push&#95;back(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</span></CodeLine>
<Link id="l01699" /><CodeLine lineNumber="1699"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Unstable sort by host order ok, because this is only used for uniquifying.</span></CodeLine>
<Link id="l01700" /><CodeLine lineNumber="1700"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>);</span></CodeLine>
<Link id="l01701" /><CodeLine lineNumber="1701"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Uniquifier.count(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>);</span></CodeLine>
<Link id="l01702" /><CodeLine lineNumber="1702"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01703" /><CodeLine lineNumber="1703"></CodeLine>
<Link id="l01704" /><CodeLine lineNumber="1704"><span class="doxyHighlightComment">/// The function returns a probability of selecting formula without Reg.</span></CodeLine>
<Link id="l01705" /><CodeLine lineNumber="1705" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a99ba1cdbe93816bffc94d88e85b97de7"><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a99ba1cdbe93816bffc94d88e85b97de7">LSRUse::getNotSelectedProbability</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01706" /><CodeLine lineNumber="1706"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> FNum = 0;</span></CodeLine>
<Link id="l01707" /><CodeLine lineNumber="1707"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>)</span></CodeLine>
<Link id="l01708" /><CodeLine lineNumber="1708"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.referencesReg(Reg))</span></CodeLine>
<Link id="l01709" /><CodeLine lineNumber="1709"><span class="doxyHighlight">      FNum++;</span></CodeLine>
<Link id="l01710" /><CodeLine lineNumber="1710"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> ((</span><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight">)(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.size() - FNum)) / <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.size();</span></CodeLine>
<Link id="l01711" /><CodeLine lineNumber="1711"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01712" /><CodeLine lineNumber="1712"></CodeLine>
<Link id="l01713" /><CodeLine lineNumber="1713"><span class="doxyHighlightComment">/// If the given formula has not yet been inserted, add it to the list, and</span></CodeLine>
<Link id="l01714" /><CodeLine lineNumber="1714"><span class="doxyHighlightComment">/// return true. Return false otherwise.  The formula must be in canonical form.</span></CodeLine>
<Link id="l01715" /><CodeLine lineNumber="1715" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ab2507970e8b86d818892ad183328b450"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ab2507970e8b86d818892ad183328b450">LSRUse::InsertFormula</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</span></CodeLine>
<Link id="l01716" /><CodeLine lineNumber="1716"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isCanonical(L) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Invalid canonical representation&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01717" /><CodeLine lineNumber="1717"></CodeLine>
<Link id="l01718" /><CodeLine lineNumber="1718"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.empty() &amp;&amp; <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aa45af5caf29ddb4040ef123166ba800a">RigidFormula</a>)</span></CodeLine>
<Link id="l01719" /><CodeLine lineNumber="1719"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01720" /><CodeLine lineNumber="1720"></CodeLine>
<Link id="l01721" /><CodeLine lineNumber="1721"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs;</span></CodeLine>
<Link id="l01722" /><CodeLine lineNumber="1722"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>.push&#95;back(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</span></CodeLine>
<Link id="l01723" /><CodeLine lineNumber="1723"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Unstable sort by host order ok, because this is only used for uniquifying.</span></CodeLine>
<Link id="l01724" /><CodeLine lineNumber="1724"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>);</span></CodeLine>
<Link id="l01725" /><CodeLine lineNumber="1725"></CodeLine>
<Link id="l01726" /><CodeLine lineNumber="1726"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Uniquifier.insert(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>).second)</span></CodeLine>
<Link id="l01727" /><CodeLine lineNumber="1727"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01728" /><CodeLine lineNumber="1728"></CodeLine>
<Link id="l01729" /><CodeLine lineNumber="1729"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Using a register to hold the value of 0 is not profitable.</span></CodeLine>
<Link id="l01730" /><CodeLine lineNumber="1730"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg || !<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg-&gt;isZero()) &amp;&amp;</span></CodeLine>
<Link id="l01731" /><CodeLine lineNumber="1731"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Zero allocated in a scaled register!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01732" /><CodeLine lineNumber="1732"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l01733" /><CodeLine lineNumber="1733"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs)</span></CodeLine>
<Link id="l01734" /><CodeLine lineNumber="1734"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!BaseReg-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Zero allocated in a base register!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01735" /><CodeLine lineNumber="1735"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01736" /><CodeLine lineNumber="1736"></CodeLine>
<Link id="l01737" /><CodeLine lineNumber="1737"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Add the formula to the list.</span></CodeLine>
<Link id="l01738" /><CodeLine lineNumber="1738"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.push&#95;back(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l01739" /><CodeLine lineNumber="1739"></CodeLine>
<Link id="l01740" /><CodeLine lineNumber="1740"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Record registers now being used by this use.</span></CodeLine>
<Link id="l01741" /><CodeLine lineNumber="1741"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.end());</span></CodeLine>
<Link id="l01742" /><CodeLine lineNumber="1742"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg)</span></CodeLine>
<Link id="l01743" /><CodeLine lineNumber="1743"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</span></CodeLine>
<Link id="l01744" /><CodeLine lineNumber="1744"></CodeLine>
<Link id="l01745" /><CodeLine lineNumber="1745"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01746" /><CodeLine lineNumber="1746"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01747" /><CodeLine lineNumber="1747"></CodeLine>
<Link id="l01748" /><CodeLine lineNumber="1748"><span class="doxyHighlightComment">/// Remove the given formula from this use&#39;s list.</span></CodeLine>
<Link id="l01749" /><CodeLine lineNumber="1749" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#abc6f1cb20b27dcacac8a3ca73baf84df"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#abc6f1cb20b27dcacac8a3ca73baf84df">LSRUse::DeleteFormula</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</span></CodeLine>
<Link id="l01750" /><CodeLine lineNumber="1750"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> != &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.back())</span></CodeLine>
<Link id="l01751" /><CodeLine lineNumber="1751"><span class="doxyHighlight">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.back());</span></CodeLine>
<Link id="l01752" /><CodeLine lineNumber="1752"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>.pop&#95;back();</span></CodeLine>
<Link id="l01753" /><CodeLine lineNumber="1753"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01754" /><CodeLine lineNumber="1754"></CodeLine>
<Link id="l01755" /><CodeLine lineNumber="1755"><span class="doxyHighlightComment">/// Recompute the Regs field, and update RegUses.</span></CodeLine>
<Link id="l01756" /><CodeLine lineNumber="1756" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ae5e9a6e4934a1c3f5194b6940b9b85fc"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ae5e9a6e4934a1c3f5194b6940b9b85fc">LSRUse::RecomputeRegs</a>(</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> &amp;RegUses) &#123;</span></CodeLine>
<Link id="l01757" /><CodeLine lineNumber="1757"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now that we&#39;ve filtered out some formulae, recompute the Regs set.</span></CodeLine>
<Link id="l01758" /><CodeLine lineNumber="1758"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 4&gt;</a> OldRegs = std::move(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>);</span></CodeLine>
<Link id="l01759" /><CodeLine lineNumber="1759"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.clear();</span></CodeLine>
<Link id="l01760" /><CodeLine lineNumber="1760"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a8edee80f0644aef0363b9bc0a7593182">Formulae</a>) &#123;</span></CodeLine>
<Link id="l01761" /><CodeLine lineNumber="1761"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</span></CodeLine>
<Link id="l01762" /><CodeLine lineNumber="1762"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.end());</span></CodeLine>
<Link id="l01763" /><CodeLine lineNumber="1763"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01764" /><CodeLine lineNumber="1764"></CodeLine>
<Link id="l01765" /><CodeLine lineNumber="1765"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Update the RegTracker.</span></CodeLine>
<Link id="l01766" /><CodeLine lineNumber="1766"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : OldRegs)</span></CodeLine>
<Link id="l01767" /><CodeLine lineNumber="1767"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#acfc1d18c4ab614170ff65151e6eb2a60">Regs</a>.count(S))</span></CodeLine>
<Link id="l01768" /><CodeLine lineNumber="1768"><span class="doxyHighlight">      RegUses.<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker/#a6a56d58ef201c3111c594b541bfef549">dropRegister</a>(S, LUIdx);</span></CodeLine>
<Link id="l01769" /><CodeLine lineNumber="1769"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01770" /><CodeLine lineNumber="1770"></CodeLine>
<Link id="l01771" /><CodeLine lineNumber="1771"><span class="doxyHighlightPreprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</span></CodeLine>
<Link id="l01772" /><CodeLine lineNumber="1772" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a223ebe6602a0309788a0c3906a683175"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a223ebe6602a0309788a0c3906a683175">LSRUse::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01773" /><CodeLine lineNumber="1773"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;LSR Use: Kind=&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01774" /><CodeLine lineNumber="1774"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af414d3b8902f3db57e9f08d3232fc17c">Kind</a>) &#123;</span></CodeLine>
<Link id="l01775" /><CodeLine lineNumber="1775"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">Basic</a>:    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Basic&quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01776" /><CodeLine lineNumber="1776"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">Special</a>:  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Special&quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01777" /><CodeLine lineNumber="1777"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">ICmpZero</a>: OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;ICmpZero&quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01778" /><CodeLine lineNumber="1778"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">Address</a>:</span></CodeLine>
<Link id="l01779" /><CodeLine lineNumber="1779"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Address of &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01780" /><CodeLine lineNumber="1780"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>.MemTy-&gt;isPointerTy())</span></CodeLine>
<Link id="l01781" /><CodeLine lineNumber="1781"><span class="doxyHighlight">      OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;pointer&quot;</span><span class="doxyHighlight">; </span><span class="doxyHighlightComment">// the full pointer type could be really verbose</span></CodeLine>
<Link id="l01782" /><CodeLine lineNumber="1782"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01783" /><CodeLine lineNumber="1783"><span class="doxyHighlight">      OS &lt;&lt; &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>.MemTy;</span></CodeLine>
<Link id="l01784" /><CodeLine lineNumber="1784"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01785" /><CodeLine lineNumber="1785"></CodeLine>
<Link id="l01786" /><CodeLine lineNumber="1786"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; in addrspace(&quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a7e2278fe0c13095375e2cb49a04ebd59">AccessTy</a>.AddrSpace &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;)&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01787" /><CodeLine lineNumber="1787"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01788" /><CodeLine lineNumber="1788"></CodeLine>
<Link id="l01789" /><CodeLine lineNumber="1789"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, Offsets=&#123;&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01790" /><CodeLine lineNumber="1790"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> NeedComma = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01791" /><CodeLine lineNumber="1791"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a260c70810f34f4da69f1f8fb1aeac273">Fixups</a>) &#123;</span></CodeLine>
<Link id="l01792" /><CodeLine lineNumber="1792"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NeedComma) OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;,&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01793" /><CodeLine lineNumber="1793"><span class="doxyHighlight">    OS &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset;</span></CodeLine>
<Link id="l01794" /><CodeLine lineNumber="1794"><span class="doxyHighlight">    NeedComma = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01795" /><CodeLine lineNumber="1795"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01796" /><CodeLine lineNumber="1796"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;&#125;&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01797" /><CodeLine lineNumber="1797"></CodeLine>
<Link id="l01798" /><CodeLine lineNumber="1798"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#aac7deb997535d3d9a445dd87bd0f2192">AllFixupsOutsideLoop</a>)</span></CodeLine>
<Link id="l01799" /><CodeLine lineNumber="1799"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, all-fixups-outside-loop&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01800" /><CodeLine lineNumber="1800"></CodeLine>
<Link id="l01801" /><CodeLine lineNumber="1801"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ac6eb6d8e22eb1da2d816c5cb38fe166d">WidestFixupType</a>)</span></CodeLine>
<Link id="l01802" /><CodeLine lineNumber="1802"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, widest fixup type: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#ac6eb6d8e22eb1da2d816c5cb38fe166d">WidestFixupType</a>;</span></CodeLine>
<Link id="l01803" /><CodeLine lineNumber="1803"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01804" /><CodeLine lineNumber="1804"></CodeLine>
<Link id="l01805" /><CodeLine lineNumber="1805" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af5eebe76701b28ce106d5ffd86fbcc27"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#af5eebe76701b28ce106d5ffd86fbcc27">LSRUse::dump</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01806" /><CodeLine lineNumber="1806"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01807" /><CodeLine lineNumber="1807"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01808" /><CodeLine lineNumber="1808"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01809" /><CodeLine lineNumber="1809"></CodeLine>
<Link id="l01810" /><CodeLine lineNumber="1810" lineLink="#a07e234e9b040a89b10635c52640987c9"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01811" /><CodeLine lineNumber="1811"><span class="doxyHighlight">                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy,</span></CodeLine>
<Link id="l01812" /><CodeLine lineNumber="1812"><span class="doxyHighlight">                                 <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV, Immediate BaseOffset,</span></CodeLine>
<Link id="l01813" /><CodeLine lineNumber="1813"><span class="doxyHighlight">                                 </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasBaseReg, int64&#95;t Scale,</span></CodeLine>
<Link id="l01814" /><CodeLine lineNumber="1814"><span class="doxyHighlight">                                 <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> </span><span class="doxyHighlightComment">/&#42; = nullptr &#42;/</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l01815" /><CodeLine lineNumber="1815"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (Kind) &#123;</span></CodeLine>
<Link id="l01816" /><CodeLine lineNumber="1816"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>: &#123;</span></CodeLine>
<Link id="l01817" /><CodeLine lineNumber="1817"><span class="doxyHighlight">    int64&#95;t FixedOffset =</span></CodeLine>
<Link id="l01818" /><CodeLine lineNumber="1818"><span class="doxyHighlight">        BaseOffset.isScalable() ? 0 : BaseOffset.getFixedValue();</span></CodeLine>
<Link id="l01819" /><CodeLine lineNumber="1819"><span class="doxyHighlight">    int64&#95;t ScalableOffset =</span></CodeLine>
<Link id="l01820" /><CodeLine lineNumber="1820"><span class="doxyHighlight">        BaseOffset.isScalable() ? BaseOffset.getKnownMinValue() : 0;</span></CodeLine>
<Link id="l01821" /><CodeLine lineNumber="1821"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(AccessTy.MemTy, BaseGV, FixedOffset,</span></CodeLine>
<Link id="l01822" /><CodeLine lineNumber="1822"><span class="doxyHighlight">                                     HasBaseReg, Scale, AccessTy.AddrSpace,</span></CodeLine>
<Link id="l01823" /><CodeLine lineNumber="1823"><span class="doxyHighlight">                                     <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>, ScalableOffset);</span></CodeLine>
<Link id="l01824" /><CodeLine lineNumber="1824"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01825" /><CodeLine lineNumber="1825"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>:</span></CodeLine>
<Link id="l01826" /><CodeLine lineNumber="1826"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// There&#39;s not even a target hook for querying whether it would be legal to</span></CodeLine>
<Link id="l01827" /><CodeLine lineNumber="1827"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// fold a GV into an ICmp.</span></CodeLine>
<Link id="l01828" /><CodeLine lineNumber="1828"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseGV)</span></CodeLine>
<Link id="l01829" /><CodeLine lineNumber="1829"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01830" /><CodeLine lineNumber="1830"></CodeLine>
<Link id="l01831" /><CodeLine lineNumber="1831"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ICmp only has two operands; don&#39;t allow more than two non-trivial parts.</span></CodeLine>
<Link id="l01832" /><CodeLine lineNumber="1832"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Scale != 0 &amp;&amp; HasBaseReg &amp;&amp; BaseOffset.isNonZero())</span></CodeLine>
<Link id="l01833" /><CodeLine lineNumber="1833"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01834" /><CodeLine lineNumber="1834"></CodeLine>
<Link id="l01835" /><CodeLine lineNumber="1835"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ICmp only supports no scale or a -1 scale, as we can &quot;fold&quot; a -1 scale by</span></CodeLine>
<Link id="l01836" /><CodeLine lineNumber="1836"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// putting the scaled register in the other operand of the icmp.</span></CodeLine>
<Link id="l01837" /><CodeLine lineNumber="1837"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Scale != 0 &amp;&amp; Scale != -1)</span></CodeLine>
<Link id="l01838" /><CodeLine lineNumber="1838"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01839" /><CodeLine lineNumber="1839"></CodeLine>
<Link id="l01840" /><CodeLine lineNumber="1840"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we have low-level target information, ask the target if it can fold an</span></CodeLine>
<Link id="l01841" /><CodeLine lineNumber="1841"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// integer immediate on an icmp.</span></CodeLine>
<Link id="l01842" /><CodeLine lineNumber="1842"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseOffset.isNonZero()) &#123;</span></CodeLine>
<Link id="l01843" /><CodeLine lineNumber="1843"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We don&#39;t have an interface to query whether the target supports</span></CodeLine>
<Link id="l01844" /><CodeLine lineNumber="1844"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// icmpzero against scalable quantities yet.</span></CodeLine>
<Link id="l01845" /><CodeLine lineNumber="1845"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseOffset.isScalable())</span></CodeLine>
<Link id="l01846" /><CodeLine lineNumber="1846"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01847" /><CodeLine lineNumber="1847"></CodeLine>
<Link id="l01848" /><CodeLine lineNumber="1848"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We have one of:</span></CodeLine>
<Link id="l01849" /><CodeLine lineNumber="1849"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// ICmpZero     BaseReg + BaseOffset =&gt; ICmp BaseReg, -BaseOffset</span></CodeLine>
<Link id="l01850" /><CodeLine lineNumber="1850"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// ICmpZero -1&#42;ScaleReg + BaseOffset =&gt; ICmp ScaleReg, BaseOffset</span></CodeLine>
<Link id="l01851" /><CodeLine lineNumber="1851"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Offs is the ICmp immediate.</span></CodeLine>
<Link id="l01852" /><CodeLine lineNumber="1852"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Scale == 0)</span></CodeLine>
<Link id="l01853" /><CodeLine lineNumber="1853"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// The cast does the right thing with</span></CodeLine>
<Link id="l01854" /><CodeLine lineNumber="1854"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// std::numeric&#95;limits&lt;int64&#95;t&gt;::min().</span></CodeLine>
<Link id="l01855" /><CodeLine lineNumber="1855"><span class="doxyHighlight">        BaseOffset = BaseOffset.getFixed(-(uint64&#95;t)BaseOffset.getFixedValue());</span></CodeLine>
<Link id="l01856" /><CodeLine lineNumber="1856"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalICmpImmediate(BaseOffset.getFixedValue());</span></CodeLine>
<Link id="l01857" /><CodeLine lineNumber="1857"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01858" /><CodeLine lineNumber="1858"></CodeLine>
<Link id="l01859" /><CodeLine lineNumber="1859"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ICmpZero BaseReg + -1&#42;ScaleReg =&gt; ICmp BaseReg, ScaleReg</span></CodeLine>
<Link id="l01860" /><CodeLine lineNumber="1860"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01861" /><CodeLine lineNumber="1861"></CodeLine>
<Link id="l01862" /><CodeLine lineNumber="1862"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a>:</span></CodeLine>
<Link id="l01863" /><CodeLine lineNumber="1863"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Only handle single-register values.</span></CodeLine>
<Link id="l01864" /><CodeLine lineNumber="1864"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !BaseGV &amp;&amp; Scale == 0 &amp;&amp; BaseOffset.isZero();</span></CodeLine>
<Link id="l01865" /><CodeLine lineNumber="1865"></CodeLine>
<Link id="l01866" /><CodeLine lineNumber="1866"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">LSRUse::Special</a>:</span></CodeLine>
<Link id="l01867" /><CodeLine lineNumber="1867"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Special case Basic to handle -1 scales.</span></CodeLine>
<Link id="l01868" /><CodeLine lineNumber="1868"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !BaseGV &amp;&amp; (Scale == 0 || Scale == -1) &amp;&amp; BaseOffset.isZero();</span></CodeLine>
<Link id="l01869" /><CodeLine lineNumber="1869"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01870" /><CodeLine lineNumber="1870"></CodeLine>
<Link id="l01871" /><CodeLine lineNumber="1871"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</span><span class="doxyHighlightStringLiteral">&quot;Invalid LSRUse Kind!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01872" /><CodeLine lineNumber="1872"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01873" /><CodeLine lineNumber="1873"></CodeLine>
<Link id="l01874" /><CodeLine lineNumber="1874" lineLink="#a111eaa1963537539371757fda03a8d07"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01875" /><CodeLine lineNumber="1875"><span class="doxyHighlight">                                 Immediate MinOffset, Immediate MaxOffset,</span></CodeLine>
<Link id="l01876" /><CodeLine lineNumber="1876"><span class="doxyHighlight">                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy,</span></CodeLine>
<Link id="l01877" /><CodeLine lineNumber="1877"><span class="doxyHighlight">                                 <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV, Immediate BaseOffset,</span></CodeLine>
<Link id="l01878" /><CodeLine lineNumber="1878"><span class="doxyHighlight">                                 </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasBaseReg, int64&#95;t Scale) &#123;</span></CodeLine>
<Link id="l01879" /><CodeLine lineNumber="1879"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseOffset.isNonZero() &amp;&amp;</span></CodeLine>
<Link id="l01880" /><CodeLine lineNumber="1880"><span class="doxyHighlight">      (BaseOffset.isScalable() != MinOffset.isScalable() ||</span></CodeLine>
<Link id="l01881" /><CodeLine lineNumber="1881"><span class="doxyHighlight">       BaseOffset.isScalable() != MaxOffset.isScalable()))</span></CodeLine>
<Link id="l01882" /><CodeLine lineNumber="1882"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01883" /><CodeLine lineNumber="1883"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check for overflow.</span></CodeLine>
<Link id="l01884" /><CodeLine lineNumber="1884"><span class="doxyHighlight">  int64&#95;t <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = BaseOffset.getKnownMinValue();</span></CodeLine>
<Link id="l01885" /><CodeLine lineNumber="1885"><span class="doxyHighlight">  int64&#95;t Min = MinOffset.getKnownMinValue();</span></CodeLine>
<Link id="l01886" /><CodeLine lineNumber="1886"><span class="doxyHighlight">  int64&#95;t Max = MaxOffset.getKnownMinValue();</span></CodeLine>
<Link id="l01887" /><CodeLine lineNumber="1887"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (((int64&#95;t)((uint64&#95;t)<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> + Min) &gt; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) != (Min &gt; 0))</span></CodeLine>
<Link id="l01888" /><CodeLine lineNumber="1888"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01889" /><CodeLine lineNumber="1889"><span class="doxyHighlight">  MinOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341">Immediate::get</a>((uint64&#95;t)<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> + Min, MinOffset.isScalable());</span></CodeLine>
<Link id="l01890" /><CodeLine lineNumber="1890"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (((int64&#95;t)((uint64&#95;t)<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> + Max) &gt; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) != (Max &gt; 0))</span></CodeLine>
<Link id="l01891" /><CodeLine lineNumber="1891"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01892" /><CodeLine lineNumber="1892"><span class="doxyHighlight">  MaxOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341">Immediate::get</a>((uint64&#95;t)<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> + Max, MaxOffset.isScalable());</span></CodeLine>
<Link id="l01893" /><CodeLine lineNumber="1893"></CodeLine>
<Link id="l01894" /><CodeLine lineNumber="1894"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, AccessTy, BaseGV, MinOffset,</span></CodeLine>
<Link id="l01895" /><CodeLine lineNumber="1895"><span class="doxyHighlight">                              HasBaseReg, Scale) &amp;&amp;</span></CodeLine>
<Link id="l01896" /><CodeLine lineNumber="1896"><span class="doxyHighlight">         <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, AccessTy, BaseGV, MaxOffset,</span></CodeLine>
<Link id="l01897" /><CodeLine lineNumber="1897"><span class="doxyHighlight">                              HasBaseReg, Scale);</span></CodeLine>
<Link id="l01898" /><CodeLine lineNumber="1898"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01899" /><CodeLine lineNumber="1899"></CodeLine>
<Link id="l01900" /><CodeLine lineNumber="1900" lineLink="#aa4449f10e66ebab87164f4bf5bfd67d9"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01901" /><CodeLine lineNumber="1901"><span class="doxyHighlight">                                 Immediate MinOffset, Immediate MaxOffset,</span></CodeLine>
<Link id="l01902" /><CodeLine lineNumber="1902"><span class="doxyHighlight">                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy,</span></CodeLine>
<Link id="l01903" /><CodeLine lineNumber="1903"><span class="doxyHighlight">                                 </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</span></CodeLine>
<Link id="l01904" /><CodeLine lineNumber="1904"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For the purpose of isAMCompletelyFolded either having a canonical formula</span></CodeLine>
<Link id="l01905" /><CodeLine lineNumber="1905"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// or a scale not equal to zero is correct.</span></CodeLine>
<Link id="l01906" /><CodeLine lineNumber="1906"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Problems may arise from non canonical formulae having a scale == 0</span></CodeLine>
<Link id="l01907" /><CodeLine lineNumber="1907"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Strictly speaking it would best to just rely on canonical formulae.</span></CodeLine>
<Link id="l01908" /><CodeLine lineNumber="1908"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// However, when we generate the scaled formulae, we first check that the</span></CodeLine>
<Link id="l01909" /><CodeLine lineNumber="1909"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// scaling factor is profitable before computing the actual ScaledReg for</span></CodeLine>
<Link id="l01910" /><CodeLine lineNumber="1910"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// compile time sake.</span></CodeLine>
<Link id="l01911" /><CodeLine lineNumber="1911"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.isCanonical(L) || <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 0));</span></CodeLine>
<Link id="l01912" /><CodeLine lineNumber="1912"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy,</span></CodeLine>
<Link id="l01913" /><CodeLine lineNumber="1913"><span class="doxyHighlight">                              <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale);</span></CodeLine>
<Link id="l01914" /><CodeLine lineNumber="1914"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01915" /><CodeLine lineNumber="1915"></CodeLine>
<Link id="l01916" /><CodeLine lineNumber="1916"><span class="doxyHighlightComment">/// Test whether we know how to expand the current formula.</span></CodeLine>
<Link id="l01917" /><CodeLine lineNumber="1917" lineLink="#a2e520a15f4578a464f9caaac2f4758ae"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Immediate MinOffset,</span></CodeLine>
<Link id="l01918" /><CodeLine lineNumber="1918"><span class="doxyHighlight">                       Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</span></CodeLine>
<Link id="l01919" /><CodeLine lineNumber="1919"><span class="doxyHighlight">                       MemAccessTy AccessTy, <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV,</span></CodeLine>
<Link id="l01920" /><CodeLine lineNumber="1920"><span class="doxyHighlight">                       Immediate BaseOffset, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasBaseReg, int64&#95;t Scale) &#123;</span></CodeLine>
<Link id="l01921" /><CodeLine lineNumber="1921"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We know how to expand completely foldable formulae.</span></CodeLine>
<Link id="l01922" /><CodeLine lineNumber="1922"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy, BaseGV,</span></CodeLine>
<Link id="l01923" /><CodeLine lineNumber="1923"><span class="doxyHighlight">                              BaseOffset, HasBaseReg, Scale) ||</span></CodeLine>
<Link id="l01924" /><CodeLine lineNumber="1924"><span class="doxyHighlight">         </span><span class="doxyHighlightComment">// Or formulae that use a base register produced by a sum of base</span></CodeLine>
<Link id="l01925" /><CodeLine lineNumber="1925"><span class="doxyHighlight">         </span><span class="doxyHighlightComment">// registers.</span></CodeLine>
<Link id="l01926" /><CodeLine lineNumber="1926"><span class="doxyHighlight">         (Scale == 1 &amp;&amp;</span></CodeLine>
<Link id="l01927" /><CodeLine lineNumber="1927"><span class="doxyHighlight">          <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy,</span></CodeLine>
<Link id="l01928" /><CodeLine lineNumber="1928"><span class="doxyHighlight">                               BaseGV, BaseOffset, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, 0));</span></CodeLine>
<Link id="l01929" /><CodeLine lineNumber="1929"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01930" /><CodeLine lineNumber="1930"></CodeLine>
<Link id="l01931" /><CodeLine lineNumber="1931" lineLink="#a0cde97c20a134a57a746859698291aaa"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Immediate MinOffset,</span></CodeLine>
<Link id="l01932" /><CodeLine lineNumber="1932"><span class="doxyHighlight">                       Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</span></CodeLine>
<Link id="l01933" /><CodeLine lineNumber="1933"><span class="doxyHighlight">                       MemAccessTy AccessTy, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</span></CodeLine>
<Link id="l01934" /><CodeLine lineNumber="1934"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV,</span></CodeLine>
<Link id="l01935" /><CodeLine lineNumber="1935"><span class="doxyHighlight">                    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale);</span></CodeLine>
<Link id="l01936" /><CodeLine lineNumber="1936"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01937" /><CodeLine lineNumber="1937"></CodeLine>
<Link id="l01938" /><CodeLine lineNumber="1938" lineLink="#a52f2bc4870549427a397721a7de9849f"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a52f2bc4870549427a397721a7de9849f">isLegalAddImmediate</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01939" /><CodeLine lineNumber="1939"><span class="doxyHighlight">                                Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &#123;</span></CodeLine>
<Link id="l01940" /><CodeLine lineNumber="1940"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isScalable())</span></CodeLine>
<Link id="l01941" /><CodeLine lineNumber="1941"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddScalableImmediate(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getKnownMinValue());</span></CodeLine>
<Link id="l01942" /><CodeLine lineNumber="1942"></CodeLine>
<Link id="l01943" /><CodeLine lineNumber="1943"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddImmediate(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue());</span></CodeLine>
<Link id="l01944" /><CodeLine lineNumber="1944"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01945" /><CodeLine lineNumber="1945"></CodeLine>
<Link id="l01946" /><CodeLine lineNumber="1946" lineLink="#aa847a3eff7b875035d9f887587291940"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01947" /><CodeLine lineNumber="1947"><span class="doxyHighlight">                                 </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</span></CodeLine>
<Link id="l01948" /><CodeLine lineNumber="1948"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Target may want to look at the user instructions.</span></CodeLine>
<Link id="l01949" /><CodeLine lineNumber="1949"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> &amp;&amp; <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.LSRWithInstrQueries()) &#123;</span></CodeLine>
<Link id="l01950" /><CodeLine lineNumber="1950"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : LU.Fixups)</span></CodeLine>
<Link id="l01951" /><CodeLine lineNumber="1951"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV,</span></CodeLine>
<Link id="l01952" /><CodeLine lineNumber="1952"><span class="doxyHighlight">                                (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg,</span></CodeLine>
<Link id="l01953" /><CodeLine lineNumber="1953"><span class="doxyHighlight">                                <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale, <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst))</span></CodeLine>
<Link id="l01954" /><CodeLine lineNumber="1954"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01955" /><CodeLine lineNumber="1955"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01956" /><CodeLine lineNumber="1956"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01957" /><CodeLine lineNumber="1957"></CodeLine>
<Link id="l01958" /><CodeLine lineNumber="1958"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind,</span></CodeLine>
<Link id="l01959" /><CodeLine lineNumber="1959"><span class="doxyHighlight">                              LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg,</span></CodeLine>
<Link id="l01960" /><CodeLine lineNumber="1960"><span class="doxyHighlight">                              <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale);</span></CodeLine>
<Link id="l01961" /><CodeLine lineNumber="1961"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01962" /><CodeLine lineNumber="1962"></CodeLine>
<Link id="l01963" /><CodeLine lineNumber="1963" lineLink="#a3cbf7279944dc2f0f99a6896501277f9"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a> <a href="#a3cbf7279944dc2f0f99a6896501277f9">getScalingFactorCost</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l01964" /><CodeLine lineNumber="1964"><span class="doxyHighlight">                                            </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l01965" /><CodeLine lineNumber="1965"><span class="doxyHighlight">                                            </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L) &#123;</span></CodeLine>
<Link id="l01966" /><CodeLine lineNumber="1966"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale)</span></CodeLine>
<Link id="l01967" /><CodeLine lineNumber="1967"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> 0;</span></CodeLine>
<Link id="l01968" /><CodeLine lineNumber="1968"></CodeLine>
<Link id="l01969" /><CodeLine lineNumber="1969"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the use is not completely folded in that instruction, we will have to</span></CodeLine>
<Link id="l01970" /><CodeLine lineNumber="1970"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// pay an extra cost only for scale != 1</span></CodeLine>
<Link id="l01971" /><CodeLine lineNumber="1971"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind,</span></CodeLine>
<Link id="l01972" /><CodeLine lineNumber="1972"><span class="doxyHighlight">                            LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, L))</span></CodeLine>
<Link id="l01973" /><CodeLine lineNumber="1973"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 1;</span></CodeLine>
<Link id="l01974" /><CodeLine lineNumber="1974"></CodeLine>
<Link id="l01975" /><CodeLine lineNumber="1975"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (LU.Kind) &#123;</span></CodeLine>
<Link id="l01976" /><CodeLine lineNumber="1976"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>: &#123;</span></CodeLine>
<Link id="l01977" /><CodeLine lineNumber="1977"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check the scaling factor cost with both the min and max offsets.</span></CodeLine>
<Link id="l01978" /><CodeLine lineNumber="1978"><span class="doxyHighlight">    int64&#95;t ScalableMin = 0, ScalableMax = 0, FixedMin = 0, FixedMax = 0;</span></CodeLine>
<Link id="l01979" /><CodeLine lineNumber="1979"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isScalable()) &#123;</span></CodeLine>
<Link id="l01980" /><CodeLine lineNumber="1980"><span class="doxyHighlight">      ScalableMin = (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + LU.MinOffset).getKnownMinValue();</span></CodeLine>
<Link id="l01981" /><CodeLine lineNumber="1981"><span class="doxyHighlight">      ScalableMax = (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + LU.MaxOffset).getKnownMinValue();</span></CodeLine>
<Link id="l01982" /><CodeLine lineNumber="1982"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01983" /><CodeLine lineNumber="1983"><span class="doxyHighlight">      FixedMin = (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + LU.MinOffset).getFixedValue();</span></CodeLine>
<Link id="l01984" /><CodeLine lineNumber="1984"><span class="doxyHighlight">      FixedMax = (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset + LU.MaxOffset).getFixedValue();</span></CodeLine>
<Link id="l01985" /><CodeLine lineNumber="1985"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01986" /><CodeLine lineNumber="1986"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a> ScaleCostMinOffset = <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.getScalingFactorCost(</span></CodeLine>
<Link id="l01987" /><CodeLine lineNumber="1987"><span class="doxyHighlight">        LU.AccessTy.MemTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV, <a href="/docs/api/classes/llvm/stackoffset/#aab735eb6b844f1b683d12013a083b4e2">StackOffset::get</a>(FixedMin, ScalableMin),</span></CodeLine>
<Link id="l01988" /><CodeLine lineNumber="1988"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale, LU.AccessTy.AddrSpace);</span></CodeLine>
<Link id="l01989" /><CodeLine lineNumber="1989"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/instructioncost">InstructionCost</a> ScaleCostMaxOffset = <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.getScalingFactorCost(</span></CodeLine>
<Link id="l01990" /><CodeLine lineNumber="1990"><span class="doxyHighlight">        LU.AccessTy.MemTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV, <a href="/docs/api/classes/llvm/stackoffset/#aab735eb6b844f1b683d12013a083b4e2">StackOffset::get</a>(FixedMax, ScalableMax),</span></CodeLine>
<Link id="l01991" /><CodeLine lineNumber="1991"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale, LU.AccessTy.AddrSpace);</span></CodeLine>
<Link id="l01992" /><CodeLine lineNumber="1992"></CodeLine>
<Link id="l01993" /><CodeLine lineNumber="1993"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ScaleCostMinOffset.<a href="/docs/api/classes/llvm/instructioncost/#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp; ScaleCostMaxOffset.<a href="/docs/api/classes/llvm/instructioncost/#ae01c5ced9fe2fe50f421ae121483ef04">isValid</a>() &amp;&amp;</span></CodeLine>
<Link id="l01994" /><CodeLine lineNumber="1994"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Legal addressing mode has an illegal cost!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01995" /><CodeLine lineNumber="1995"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::max(ScaleCostMinOffset, ScaleCostMaxOffset);</span></CodeLine>
<Link id="l01996" /><CodeLine lineNumber="1996"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01997" /><CodeLine lineNumber="1997"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>:</span></CodeLine>
<Link id="l01998" /><CodeLine lineNumber="1998"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a>:</span></CodeLine>
<Link id="l01999" /><CodeLine lineNumber="1999"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">LSRUse::Special</a>:</span></CodeLine>
<Link id="l02000" /><CodeLine lineNumber="2000"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The use is completely folded, i.e., everything is folded into the</span></CodeLine>
<Link id="l02001" /><CodeLine lineNumber="2001"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// instruction.</span></CodeLine>
<Link id="l02002" /><CodeLine lineNumber="2002"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> 0;</span></CodeLine>
<Link id="l02003" /><CodeLine lineNumber="2003"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02004" /><CodeLine lineNumber="2004"></CodeLine>
<Link id="l02005" /><CodeLine lineNumber="2005"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</span><span class="doxyHighlightStringLiteral">&quot;Invalid LSRUse Kind!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02006" /><CodeLine lineNumber="2006"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02007" /><CodeLine lineNumber="2007"></CodeLine>
<Link id="l02008" /><CodeLine lineNumber="2008" lineLink="#a626659c8868b0e423f831bfc2b98091e"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l02009" /><CodeLine lineNumber="2009"><span class="doxyHighlight">                             <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, MemAccessTy AccessTy,</span></CodeLine>
<Link id="l02010" /><CodeLine lineNumber="2010"><span class="doxyHighlight">                             <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV, Immediate BaseOffset,</span></CodeLine>
<Link id="l02011" /><CodeLine lineNumber="2011"><span class="doxyHighlight">                             </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasBaseReg) &#123;</span></CodeLine>
<Link id="l02012" /><CodeLine lineNumber="2012"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Fast-path: zero is always foldable.</span></CodeLine>
<Link id="l02013" /><CodeLine lineNumber="2013"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseOffset.isZero() &amp;&amp; !BaseGV)</span></CodeLine>
<Link id="l02014" /><CodeLine lineNumber="2014"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02015" /><CodeLine lineNumber="2015"></CodeLine>
<Link id="l02016" /><CodeLine lineNumber="2016"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Conservatively, create an address with an immediate and a</span></CodeLine>
<Link id="l02017" /><CodeLine lineNumber="2017"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// base and a scale.</span></CodeLine>
<Link id="l02018" /><CodeLine lineNumber="2018"><span class="doxyHighlight">  int64&#95;t Scale = Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> ? -1 : 1;</span></CodeLine>
<Link id="l02019" /><CodeLine lineNumber="2019"></CodeLine>
<Link id="l02020" /><CodeLine lineNumber="2020"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Canonicalize a scale of 1 to a base register if the formula doesn&#39;t</span></CodeLine>
<Link id="l02021" /><CodeLine lineNumber="2021"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// already have a base register.</span></CodeLine>
<Link id="l02022" /><CodeLine lineNumber="2022"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!HasBaseReg &amp;&amp; Scale == 1) &#123;</span></CodeLine>
<Link id="l02023" /><CodeLine lineNumber="2023"><span class="doxyHighlight">    Scale = 0;</span></CodeLine>
<Link id="l02024" /><CodeLine lineNumber="2024"><span class="doxyHighlight">    HasBaseReg = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02025" /><CodeLine lineNumber="2025"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02026" /><CodeLine lineNumber="2026"></CodeLine>
<Link id="l02027" /><CodeLine lineNumber="2027"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// FIXME: Try with + without a scale? Maybe based on TTI?</span></CodeLine>
<Link id="l02028" /><CodeLine lineNumber="2028"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// I think basereg + scaledreg + immediateoffset isn&#39;t a good &#39;conservative&#39;</span></CodeLine>
<Link id="l02029" /><CodeLine lineNumber="2029"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// default for many architectures, not just AArch64 SVE. More investigation</span></CodeLine>
<Link id="l02030" /><CodeLine lineNumber="2030"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// needed later to determine if this should be used more widely than just</span></CodeLine>
<Link id="l02031" /><CodeLine lineNumber="2031"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// on scalable types.</span></CodeLine>
<Link id="l02032" /><CodeLine lineNumber="2032"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (HasBaseReg &amp;&amp; BaseOffset.isNonZero() &amp;&amp; Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> &amp;&amp;</span></CodeLine>
<Link id="l02033" /><CodeLine lineNumber="2033"><span class="doxyHighlight">      AccessTy.MemTy &amp;&amp; AccessTy.MemTy-&gt;isScalableTy() &amp;&amp; <a href="#a0ce46a19f824c65a4ddace1f4e9ac529">DropScaledForVScale</a>)</span></CodeLine>
<Link id="l02034" /><CodeLine lineNumber="2034"><span class="doxyHighlight">    Scale = 0;</span></CodeLine>
<Link id="l02035" /><CodeLine lineNumber="2035"></CodeLine>
<Link id="l02036" /><CodeLine lineNumber="2036"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, AccessTy, BaseGV, BaseOffset,</span></CodeLine>
<Link id="l02037" /><CodeLine lineNumber="2037"><span class="doxyHighlight">                              HasBaseReg, Scale);</span></CodeLine>
<Link id="l02038" /><CodeLine lineNumber="2038"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02039" /><CodeLine lineNumber="2039"></CodeLine>
<Link id="l02040" /><CodeLine lineNumber="2040" lineLink="#a290c161463cbfb7720d6499dba1310ad"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l02041" /><CodeLine lineNumber="2041"><span class="doxyHighlight">                             <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, Immediate MinOffset,</span></CodeLine>
<Link id="l02042" /><CodeLine lineNumber="2042"><span class="doxyHighlight">                             Immediate MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</span></CodeLine>
<Link id="l02043" /><CodeLine lineNumber="2043"><span class="doxyHighlight">                             MemAccessTy AccessTy, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S,</span></CodeLine>
<Link id="l02044" /><CodeLine lineNumber="2044"><span class="doxyHighlight">                             </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasBaseReg) &#123;</span></CodeLine>
<Link id="l02045" /><CodeLine lineNumber="2045"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Fast-path: zero is always foldable.</span></CodeLine>
<Link id="l02046" /><CodeLine lineNumber="2046"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (S-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02047" /><CodeLine lineNumber="2047"></CodeLine>
<Link id="l02048" /><CodeLine lineNumber="2048"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Conservatively, create an address with an immediate and a</span></CodeLine>
<Link id="l02049" /><CodeLine lineNumber="2049"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// base and a scale.</span></CodeLine>
<Link id="l02050" /><CodeLine lineNumber="2050"><span class="doxyHighlight">  Immediate BaseOffset = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(S, SE);</span></CodeLine>
<Link id="l02051" /><CodeLine lineNumber="2051"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;BaseGV = <a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(S, SE);</span></CodeLine>
<Link id="l02052" /><CodeLine lineNumber="2052"></CodeLine>
<Link id="l02053" /><CodeLine lineNumber="2053"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there&#39;s anything else involved, it&#39;s not foldable.</span></CodeLine>
<Link id="l02054" /><CodeLine lineNumber="2054"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!S-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02055" /><CodeLine lineNumber="2055"></CodeLine>
<Link id="l02056" /><CodeLine lineNumber="2056"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Fast-path: zero is always foldable.</span></CodeLine>
<Link id="l02057" /><CodeLine lineNumber="2057"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseOffset.isZero() &amp;&amp; !BaseGV)</span></CodeLine>
<Link id="l02058" /><CodeLine lineNumber="2058"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02059" /><CodeLine lineNumber="2059"></CodeLine>
<Link id="l02060" /><CodeLine lineNumber="2060"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseOffset.isScalable())</span></CodeLine>
<Link id="l02061" /><CodeLine lineNumber="2061"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02062" /><CodeLine lineNumber="2062"></CodeLine>
<Link id="l02063" /><CodeLine lineNumber="2063"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Conservatively, create an address with an immediate and a</span></CodeLine>
<Link id="l02064" /><CodeLine lineNumber="2064"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// base and a scale.</span></CodeLine>
<Link id="l02065" /><CodeLine lineNumber="2065"><span class="doxyHighlight">  int64&#95;t Scale = Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> ? -1 : 1;</span></CodeLine>
<Link id="l02066" /><CodeLine lineNumber="2066"></CodeLine>
<Link id="l02067" /><CodeLine lineNumber="2067"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, MinOffset, MaxOffset, Kind, AccessTy, BaseGV,</span></CodeLine>
<Link id="l02068" /><CodeLine lineNumber="2068"><span class="doxyHighlight">                              BaseOffset, HasBaseReg, Scale);</span></CodeLine>
<Link id="l02069" /><CodeLine lineNumber="2069"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02070" /><CodeLine lineNumber="2070"></CodeLine>
<Link id="l02071" /><CodeLine lineNumber="2071"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02072" /><CodeLine lineNumber="2072"></CodeLine>
<Link id="l02073" /><CodeLine lineNumber="2073"><span class="doxyHighlightComment">/// An individual increment in a Chain of IV increments.  Relate an IV user to</span></CodeLine>
<Link id="l02074" /><CodeLine lineNumber="2074"><span class="doxyHighlightComment">/// an expression that computes the IV it uses from the IV used by the previous</span></CodeLine>
<Link id="l02075" /><CodeLine lineNumber="2075"><span class="doxyHighlightComment">/// link in the Chain.</span></CodeLine>
<Link id="l02076" /><CodeLine lineNumber="2076"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02077" /><CodeLine lineNumber="2077"><span class="doxyHighlightComment">/// For the head of a chain, IncExpr holds the absolute SCEV expression for the</span></CodeLine>
<Link id="l02078" /><CodeLine lineNumber="2078"><span class="doxyHighlightComment">/// original IVOperand. The head of the chain&#39;s IVOperand is only valid during</span></CodeLine>
<Link id="l02079" /><CodeLine lineNumber="2079"><span class="doxyHighlightComment">/// chain collection, before LSR replaces IV users. During chain generation,</span></CodeLine>
<Link id="l02080" /><CodeLine lineNumber="2080"><span class="doxyHighlightComment">/// IncExpr can be used to find the new IVOperand that computes the same</span></CodeLine>
<Link id="l02081" /><CodeLine lineNumber="2081"><span class="doxyHighlightComment">/// expression.</span></CodeLine>
<Link id="l02082" /><CodeLine lineNumber="2082" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a4a00efb2c77fbadba8355cf70a0c46da">IVInc</a> &#123;</span></CodeLine>
<Link id="l02083" /><CodeLine lineNumber="2083" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a24dd72fbb252cd525690013aae6688db"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a24dd72fbb252cd525690013aae6688db">UserInst</a>;</span></CodeLine>
<Link id="l02084" /><CodeLine lineNumber="2084" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a89eb1b3a3d8c73618179b2ca0ac8bfd6"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/value">Value</a>&#42; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a89eb1b3a3d8c73618179b2ca0ac8bfd6">IVOperand</a>;</span></CodeLine>
<Link id="l02085" /><CodeLine lineNumber="2085" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#aad35bcf540910bcaecb50636e153c55c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#aad35bcf540910bcaecb50636e153c55c">IncExpr</a>;</span></CodeLine>
<Link id="l02086" /><CodeLine lineNumber="2086"></CodeLine>
<Link id="l02087" /><CodeLine lineNumber="2087" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a4a00efb2c77fbadba8355cf70a0c46da"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a4a00efb2c77fbadba8355cf70a0c46da">IVInc</a>(<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;U, <a href="/docs/api/classes/llvm/value">Value</a> &#42;O, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;E)</span></CodeLine>
<Link id="l02088" /><CodeLine lineNumber="2088"><span class="doxyHighlight">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a24dd72fbb252cd525690013aae6688db">UserInst</a>(U), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#a89eb1b3a3d8c73618179b2ca0ac8bfd6">IVOperand</a>(O), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc/#aad35bcf540910bcaecb50636e153c55c">IncExpr</a>(E) &#123;&#125;</span></CodeLine>
<Link id="l02089" /><CodeLine lineNumber="2089"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l02090" /><CodeLine lineNumber="2090"></CodeLine>
<Link id="l02091" /><CodeLine lineNumber="2091"><span class="doxyHighlightComment">// The list of IV increments in program order.  We typically add the head of a</span></CodeLine>
<Link id="l02092" /><CodeLine lineNumber="2092"><span class="doxyHighlightComment">// chain without finding subsequent links.</span></CodeLine>
<Link id="l02093" /><CodeLine lineNumber="2093" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a02ff66a22299f873b2bcf73f03d50707">IVChain</a> &#123;</span></CodeLine>
<Link id="l02094" /><CodeLine lineNumber="2094" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;IVInc, 1&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>;</span></CodeLine>
<Link id="l02095" /><CodeLine lineNumber="2095" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a43345861037b44e75b6240b17c3e7965"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a43345861037b44e75b6240b17c3e7965">ExprBase</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02096" /><CodeLine lineNumber="2096"></CodeLine>
<Link id="l02097" /><CodeLine lineNumber="2097" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a02ff66a22299f873b2bcf73f03d50707"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a02ff66a22299f873b2bcf73f03d50707">IVChain</a>() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02098" /><CodeLine lineNumber="2098" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a79cdd382de7e2c08c536aec18f2bb17a"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a79cdd382de7e2c08c536aec18f2bb17a">IVChain</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> &amp;Head, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>)</span></CodeLine>
<Link id="l02099" /><CodeLine lineNumber="2099"><span class="doxyHighlight">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>(1, Head), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a43345861037b44e75b6240b17c3e7965">ExprBase</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;&#125;</span></CodeLine>
<Link id="l02100" /><CodeLine lineNumber="2100"></CodeLine>
<Link id="l02101" /><CodeLine lineNumber="2101" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">const&#95;iterator</a> = <a href="/docs/api/classes/llvm/smallvectorimpl/#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;IVInc&gt;::const&#95;iterator</a>;</span></CodeLine>
<Link id="l02102" /><CodeLine lineNumber="2102"></CodeLine>
<Link id="l02103" /><CodeLine lineNumber="2103"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Return the first increment in the chain.</span></CodeLine>
<Link id="l02104" /><CodeLine lineNumber="2104" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a0d9bed9a63ddbf560eb0e5a5bd9a977d"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">const&#95;iterator</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a0d9bed9a63ddbf560eb0e5a5bd9a977d">begin</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02105" /><CodeLine lineNumber="2105"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.empty());</span></CodeLine>
<Link id="l02106" /><CodeLine lineNumber="2106"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::next(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.begin());</span></CodeLine>
<Link id="l02107" /><CodeLine lineNumber="2107"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02108" /><CodeLine lineNumber="2108" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a99ebaa4bf34d0ae2bacfc305101006df"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">const&#95;iterator</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a99ebaa4bf34d0ae2bacfc305101006df">end</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02109" /><CodeLine lineNumber="2109"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.end();</span></CodeLine>
<Link id="l02110" /><CodeLine lineNumber="2110"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02111" /><CodeLine lineNumber="2111"></CodeLine>
<Link id="l02112" /><CodeLine lineNumber="2112"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Returns true if this chain contains any increments.</span></CodeLine>
<Link id="l02113" /><CodeLine lineNumber="2113" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a80714456485921f3145c280a15cd9a0d"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a80714456485921f3145c280a15cd9a0d">hasIncs</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.size() &gt;= 2; &#125;</span></CodeLine>
<Link id="l02114" /><CodeLine lineNumber="2114"></CodeLine>
<Link id="l02115" /><CodeLine lineNumber="2115"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Add an IVInc to the end of this chain.</span></CodeLine>
<Link id="l02116" /><CodeLine lineNumber="2116" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a74b61b4ed15354a4d7a40a72045bda49"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a74b61b4ed15354a4d7a40a72045bda49">add</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivinc">IVInc</a> &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>) &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.push&#95;back(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>); &#125;</span></CodeLine>
<Link id="l02117" /><CodeLine lineNumber="2117"></CodeLine>
<Link id="l02118" /><CodeLine lineNumber="2118"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Returns the last UserInst in the chain.</span></CodeLine>
<Link id="l02119" /><CodeLine lineNumber="2119" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3c7f16fc2b68e37e493102584cd94445"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3c7f16fc2b68e37e493102584cd94445">tailUserInst</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>.back().UserInst; &#125;</span></CodeLine>
<Link id="l02120" /><CodeLine lineNumber="2120"></CodeLine>
<Link id="l02121" /><CodeLine lineNumber="2121"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Returns true if IncExpr can be profitably added to this chain.</span></CodeLine>
<Link id="l02122" /><CodeLine lineNumber="2122"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> isProfitableIncrement(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OperExpr,</span></CodeLine>
<Link id="l02123" /><CodeLine lineNumber="2123"><span class="doxyHighlight">                             </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr,</span></CodeLine>
<Link id="l02124" /><CodeLine lineNumber="2124"><span class="doxyHighlight">                             <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a>&amp;);</span></CodeLine>
<Link id="l02125" /><CodeLine lineNumber="2125"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l02126" /><CodeLine lineNumber="2126"></CodeLine>
<Link id="l02127" /><CodeLine lineNumber="2127"><span class="doxyHighlightComment">/// Helper for CollectChains to track multiple IV increment uses.  Distinguish</span></CodeLine>
<Link id="l02128" /><CodeLine lineNumber="2128"><span class="doxyHighlightComment">/// between FarUsers that definitely cross IV increments and NearUsers that may</span></CodeLine>
<Link id="l02129" /><CodeLine lineNumber="2129"><span class="doxyHighlightComment">/// be used between IV increments.</span></CodeLine>
<Link id="l02130" /><CodeLine lineNumber="2130" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers">ChainUsers</a> &#123;</span></CodeLine>
<Link id="l02131" /><CodeLine lineNumber="2131" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#ae20ff1d73c2a85f990a86d2369df5d11"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction&#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#ae20ff1d73c2a85f990a86d2369df5d11">FarUsers</a>;</span></CodeLine>
<Link id="l02132" /><CodeLine lineNumber="2132" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#a9c5fc8575e447cda16ba00faa25afb5c"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction&#42;, 4&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/chainusers/#a9c5fc8575e447cda16ba00faa25afb5c">NearUsers</a>;</span></CodeLine>
<Link id="l02133" /><CodeLine lineNumber="2133"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l02134" /><CodeLine lineNumber="2134"></CodeLine>
<Link id="l02135" /><CodeLine lineNumber="2135"><span class="doxyHighlightComment">/// This class holds state for the main loop strength reduction logic.</span></CodeLine>
<Link id="l02136" /><CodeLine lineNumber="2136" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a9bcf42be7435217d79cd175d4e6993d7">LSRInstance</a> &#123;</span></CodeLine>
<Link id="l02137" /><CodeLine lineNumber="2137"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp;IU;</span></CodeLine>
<Link id="l02138" /><CodeLine lineNumber="2138"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE;</span></CodeLine>
<Link id="l02139" /><CodeLine lineNumber="2139"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;DT;</span></CodeLine>
<Link id="l02140" /><CodeLine lineNumber="2140"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI;</span></CodeLine>
<Link id="l02141" /><CodeLine lineNumber="2141"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;AC;</span></CodeLine>
<Link id="l02142" /><CodeLine lineNumber="2142"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp;TLI;</span></CodeLine>
<Link id="l02143" /><CodeLine lineNumber="2143"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;TTI;</span></CodeLine>
<Link id="l02144" /><CodeLine lineNumber="2144"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> L;</span></CodeLine>
<Link id="l02145" /><CodeLine lineNumber="2145"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/memoryssaupdater">MemorySSAUpdater</a> &#42;MSSAU;</span></CodeLine>
<Link id="l02146" /><CodeLine lineNumber="2146"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43">TTI::AddressingModeKind</a> AMK;</span></CodeLine>
<Link id="l02147" /><CodeLine lineNumber="2147"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">mutable</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevexpander">SCEVExpander</a> Rewriter;</span></CodeLine>
<Link id="l02148" /><CodeLine lineNumber="2148"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Changed = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02149" /><CodeLine lineNumber="2149"></CodeLine>
<Link id="l02150" /><CodeLine lineNumber="2150"><span class="doxyHighlightComment">  /// This is the insert position that the current loop&#39;s induction variable</span></CodeLine>
<Link id="l02151" /><CodeLine lineNumber="2151"><span class="doxyHighlightComment">  /// increment should be placed. In simple loops, this is the latch block&#39;s</span></CodeLine>
<Link id="l02152" /><CodeLine lineNumber="2152"><span class="doxyHighlightComment">  /// terminator. But in more complicated cases, this is a position which will</span></CodeLine>
<Link id="l02153" /><CodeLine lineNumber="2153"><span class="doxyHighlightComment">  /// dominate all the in-loop post-increment users.</span></CodeLine>
<Link id="l02154" /><CodeLine lineNumber="2154"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVIncInsertPos = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02155" /><CodeLine lineNumber="2155"></CodeLine>
<Link id="l02156" /><CodeLine lineNumber="2156"><span class="doxyHighlightComment">  /// Interesting factors between use strides.</span></CodeLine>
<Link id="l02157" /><CodeLine lineNumber="2157"><span class="doxyHighlightComment">  ///</span></CodeLine>
<Link id="l02158" /><CodeLine lineNumber="2158"><span class="doxyHighlightComment">  /// We explicitly use a SetVector which contains a SmallSet, instead of the</span></CodeLine>
<Link id="l02159" /><CodeLine lineNumber="2159"><span class="doxyHighlightComment">  /// default, a SmallDenseSet, because we need to use the full range of</span></CodeLine>
<Link id="l02160" /><CodeLine lineNumber="2160"><span class="doxyHighlightComment">  /// int64&#95;ts, and there&#39;s currently no good way of doing that with</span></CodeLine>
<Link id="l02161" /><CodeLine lineNumber="2161"><span class="doxyHighlightComment">  /// SmallDenseSet.</span></CodeLine>
<Link id="l02162" /><CodeLine lineNumber="2162"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/setvector">SetVector&lt;int64&#95;t, SmallVector&lt;int64&#95;t, 8&gt;</a>, <a href="/docs/api/classes/llvm/smallset">SmallSet&lt;int64&#95;t, 8&gt;</a>&gt; Factors;</span></CodeLine>
<Link id="l02163" /><CodeLine lineNumber="2163"></CodeLine>
<Link id="l02164" /><CodeLine lineNumber="2164"><span class="doxyHighlightComment">  /// The cost of the current SCEV, the best solution by LSR will be dropped if</span></CodeLine>
<Link id="l02165" /><CodeLine lineNumber="2165"><span class="doxyHighlightComment">  /// the solution is not profitable.</span></CodeLine>
<Link id="l02166" /><CodeLine lineNumber="2166"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a> BaselineCost;</span></CodeLine>
<Link id="l02167" /><CodeLine lineNumber="2167"></CodeLine>
<Link id="l02168" /><CodeLine lineNumber="2168"><span class="doxyHighlightComment">  /// Interesting use types, to facilitate truncation reuse.</span></CodeLine>
<Link id="l02169" /><CodeLine lineNumber="2169"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector&lt;Type &#42;, 4&gt;</a> Types;</span></CodeLine>
<Link id="l02170" /><CodeLine lineNumber="2170"></CodeLine>
<Link id="l02171" /><CodeLine lineNumber="2171"><span class="doxyHighlightComment">  /// The list of interesting uses.</span></CodeLine>
<Link id="l02172" /><CodeLine lineNumber="2172"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">mutable</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;LSRUse, 16&gt;</a> Uses;</span></CodeLine>
<Link id="l02173" /><CodeLine lineNumber="2173"></CodeLine>
<Link id="l02174" /><CodeLine lineNumber="2174"><span class="doxyHighlightComment">  /// Track which uses use which register candidates.</span></CodeLine>
<Link id="l02175" /><CodeLine lineNumber="2175"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/regusetracker">RegUseTracker</a> RegUses;</span></CodeLine>
<Link id="l02176" /><CodeLine lineNumber="2176"></CodeLine>
<Link id="l02177" /><CodeLine lineNumber="2177"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Limit the number of chains to avoid quadratic behavior. We don&#39;t expect to</span></CodeLine>
<Link id="l02178" /><CodeLine lineNumber="2178"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// have more than a few IV increment chains in a loop. Missing a Chain falls</span></CodeLine>
<Link id="l02179" /><CodeLine lineNumber="2179"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// back to normal LSR behavior for those uses.</span></CodeLine>
<Link id="l02180" /><CodeLine lineNumber="2180"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> MaxChains = 8;</span></CodeLine>
<Link id="l02181" /><CodeLine lineNumber="2181"></CodeLine>
<Link id="l02182" /><CodeLine lineNumber="2182"><span class="doxyHighlightComment">  /// IV users can form a chain of IV increments.</span></CodeLine>
<Link id="l02183" /><CodeLine lineNumber="2183"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;IVChain, MaxChains&gt;</a> IVChainVec;</span></CodeLine>
<Link id="l02184" /><CodeLine lineNumber="2184"></CodeLine>
<Link id="l02185" /><CodeLine lineNumber="2185"><span class="doxyHighlightComment">  /// IV users that belong to profitable IVChains.</span></CodeLine>
<Link id="l02186" /><CodeLine lineNumber="2186"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Use&#42;, MaxChains&gt;</a> IVIncSet;</span></CodeLine>
<Link id="l02187" /><CodeLine lineNumber="2187"></CodeLine>
<Link id="l02188" /><CodeLine lineNumber="2188"><span class="doxyHighlightComment">  /// Induction variables that were generated and inserted by the SCEV Expander.</span></CodeLine>
<Link id="l02189" /><CodeLine lineNumber="2189"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;llvm::WeakVH, 2&gt;</a> ScalarEvolutionIVs;</span></CodeLine>
<Link id="l02190" /><CodeLine lineNumber="2190"></CodeLine>
<Link id="l02191" /><CodeLine lineNumber="2191"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Inserting instructions in the loop and using them as PHI&#39;s input could</span></CodeLine>
<Link id="l02192" /><CodeLine lineNumber="2192"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// break LCSSA in case if PHI&#39;s parent block is not a loop exit (i.e. the</span></CodeLine>
<Link id="l02193" /><CodeLine lineNumber="2193"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// corresponding incoming block is not loop exiting). So collect all such</span></CodeLine>
<Link id="l02194" /><CodeLine lineNumber="2194"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instructions to form LCSSA for them later.</span></CodeLine>
<Link id="l02195" /><CodeLine lineNumber="2195"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector&lt;Instruction &#42;, 4&gt;</a> InsertedNonLCSSAInsts;</span></CodeLine>
<Link id="l02196" /><CodeLine lineNumber="2196"></CodeLine>
<Link id="l02197" /><CodeLine lineNumber="2197"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> OptimizeShadowIV();</span></CodeLine>
<Link id="l02198" /><CodeLine lineNumber="2198"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> FindIVUserForCond(<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &#42;&amp;CondUse);</span></CodeLine>
<Link id="l02199" /><CodeLine lineNumber="2199"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;OptimizeMax(<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a>&#42; &amp;CondUse);</span></CodeLine>
<Link id="l02200" /><CodeLine lineNumber="2200"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> OptimizeLoopTermCond();</span></CodeLine>
<Link id="l02201" /><CodeLine lineNumber="2201"></CodeLine>
<Link id="l02202" /><CodeLine lineNumber="2202"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> ChainInstruction(<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVOper,</span></CodeLine>
<Link id="l02203" /><CodeLine lineNumber="2203"><span class="doxyHighlight">                        <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;ChainUsers&gt;</a> &amp;ChainUsersVec);</span></CodeLine>
<Link id="l02204" /><CodeLine lineNumber="2204"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> FinalizeChain(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a> &amp;Chain);</span></CodeLine>
<Link id="l02205" /><CodeLine lineNumber="2205"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> CollectChains();</span></CodeLine>
<Link id="l02206" /><CodeLine lineNumber="2206"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateIVChain(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain">IVChain</a> &amp;Chain,</span></CodeLine>
<Link id="l02207" /><CodeLine lineNumber="2207"><span class="doxyHighlight">                       <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts);</span></CodeLine>
<Link id="l02208" /><CodeLine lineNumber="2208"></CodeLine>
<Link id="l02209" /><CodeLine lineNumber="2209"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> CollectInterestingTypesAndFactors();</span></CodeLine>
<Link id="l02210" /><CodeLine lineNumber="2210"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> CollectFixupsAndInitialFormulae();</span></CodeLine>
<Link id="l02211" /><CodeLine lineNumber="2211"></CodeLine>
<Link id="l02212" /><CodeLine lineNumber="2212"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Support for sharing of LSRUses between LSRFixups.</span></CodeLine>
<Link id="l02213" /><CodeLine lineNumber="2213"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight">UseMapTy = <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;LSRUse::SCEVUseKindPair, size&#95;t&gt;</a>;</span></CodeLine>
<Link id="l02214" /><CodeLine lineNumber="2214"><span class="doxyHighlight">  UseMapTy UseMap;</span></CodeLine>
<Link id="l02215" /><CodeLine lineNumber="2215"></CodeLine>
<Link id="l02216" /><CodeLine lineNumber="2216"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> reconcileNewOffset(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> NewOffset, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasBaseReg,</span></CodeLine>
<Link id="l02217" /><CodeLine lineNumber="2217"><span class="doxyHighlight">                          <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a> AccessTy);</span></CodeLine>
<Link id="l02218" /><CodeLine lineNumber="2218"></CodeLine>
<Link id="l02219" /><CodeLine lineNumber="2219"><span class="doxyHighlight">  std::pair&lt;size&#95;t, Immediate&gt; getUse(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;Expr, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</span></CodeLine>
<Link id="l02220" /><CodeLine lineNumber="2220"><span class="doxyHighlight">                                      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty">MemAccessTy</a> AccessTy);</span></CodeLine>
<Link id="l02221" /><CodeLine lineNumber="2221"></CodeLine>
<Link id="l02222" /><CodeLine lineNumber="2222"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> DeleteUse(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx);</span></CodeLine>
<Link id="l02223" /><CodeLine lineNumber="2223"></CodeLine>
<Link id="l02224" /><CodeLine lineNumber="2224"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &#42;FindUseWithSimilarFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;OrigLU);</span></CodeLine>
<Link id="l02225" /><CodeLine lineNumber="2225"></CodeLine>
<Link id="l02226" /><CodeLine lineNumber="2226"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InsertInitialFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx);</span></CodeLine>
<Link id="l02227" /><CodeLine lineNumber="2227"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InsertSupplementalFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx);</span></CodeLine>
<Link id="l02228" /><CodeLine lineNumber="2228"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> CountRegisters(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx);</span></CodeLine>
<Link id="l02229" /><CodeLine lineNumber="2229"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InsertFormula(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l02230" /><CodeLine lineNumber="2230"></CodeLine>
<Link id="l02231" /><CodeLine lineNumber="2231"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> CollectLoopInvariantFixupsAndFormulae();</span></CodeLine>
<Link id="l02232" /><CodeLine lineNumber="2232"></CodeLine>
<Link id="l02233" /><CodeLine lineNumber="2233"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateReassociations(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</span></CodeLine>
<Link id="l02234" /><CodeLine lineNumber="2234"><span class="doxyHighlight">                              </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> = 0);</span></CodeLine>
<Link id="l02235" /><CodeLine lineNumber="2235"></CodeLine>
<Link id="l02236" /><CodeLine lineNumber="2236"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateReassociationsImpl(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l02237" /><CodeLine lineNumber="2237"><span class="doxyHighlight">                                  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>,</span></CodeLine>
<Link id="l02238" /><CodeLine lineNumber="2238"><span class="doxyHighlight">                                  </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> Idx, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsScaledReg = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02239" /><CodeLine lineNumber="2239"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateCombinations(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</span></CodeLine>
<Link id="l02240" /><CodeLine lineNumber="2240"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateSymbolicOffsetsImpl(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l02241" /><CodeLine lineNumber="2241"><span class="doxyHighlight">                                   </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> Idx,</span></CodeLine>
<Link id="l02242" /><CodeLine lineNumber="2242"><span class="doxyHighlight">                                   </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsScaledReg = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02243" /><CodeLine lineNumber="2243"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateSymbolicOffsets(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</span></CodeLine>
<Link id="l02244" /><CodeLine lineNumber="2244"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateConstantOffsetsImpl(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l02245" /><CodeLine lineNumber="2245"><span class="doxyHighlight">                                   </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</span></CodeLine>
<Link id="l02246" /><CodeLine lineNumber="2246"><span class="doxyHighlight">                                   </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Immediate&gt;</a> &amp;Worklist,</span></CodeLine>
<Link id="l02247" /><CodeLine lineNumber="2247"><span class="doxyHighlight">                                   </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> Idx, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsScaledReg = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02248" /><CodeLine lineNumber="2248"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateConstantOffsets(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</span></CodeLine>
<Link id="l02249" /><CodeLine lineNumber="2249"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateICmpZeroScales(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</span></CodeLine>
<Link id="l02250" /><CodeLine lineNumber="2250"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateScales(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</span></CodeLine>
<Link id="l02251" /><CodeLine lineNumber="2251"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateTruncates(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</span></CodeLine>
<Link id="l02252" /><CodeLine lineNumber="2252"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateCrossUseConstantOffsets();</span></CodeLine>
<Link id="l02253" /><CodeLine lineNumber="2253"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> GenerateAllReuseFormulae();</span></CodeLine>
<Link id="l02254" /><CodeLine lineNumber="2254"></CodeLine>
<Link id="l02255" /><CodeLine lineNumber="2255"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> FilterOutUndesirableDedicatedRegisters();</span></CodeLine>
<Link id="l02256" /><CodeLine lineNumber="2256"></CodeLine>
<Link id="l02257" /><CodeLine lineNumber="2257"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> EstimateSearchSpaceComplexity() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02258" /><CodeLine lineNumber="2258"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> NarrowSearchSpaceByDetectingSupersets();</span></CodeLine>
<Link id="l02259" /><CodeLine lineNumber="2259"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> NarrowSearchSpaceByCollapsingUnrolledCode();</span></CodeLine>
<Link id="l02260" /><CodeLine lineNumber="2260"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> NarrowSearchSpaceByRefilteringUndesirableDedicatedRegisters();</span></CodeLine>
<Link id="l02261" /><CodeLine lineNumber="2261"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> NarrowSearchSpaceByFilterFormulaWithSameScaledReg();</span></CodeLine>
<Link id="l02262" /><CodeLine lineNumber="2262"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> NarrowSearchSpaceByFilterPostInc();</span></CodeLine>
<Link id="l02263" /><CodeLine lineNumber="2263"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> NarrowSearchSpaceByDeletingCostlyFormulas();</span></CodeLine>
<Link id="l02264" /><CodeLine lineNumber="2264"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> NarrowSearchSpaceByPickingWinnerRegs();</span></CodeLine>
<Link id="l02265" /><CodeLine lineNumber="2265"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> NarrowSearchSpaceUsingHeuristics();</span></CodeLine>
<Link id="l02266" /><CodeLine lineNumber="2266"></CodeLine>
<Link id="l02267" /><CodeLine lineNumber="2267"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> SolveRecurse(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution,</span></CodeLine>
<Link id="l02268" /><CodeLine lineNumber="2268"><span class="doxyHighlight">                    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a> &amp;SolutionCost,</span></CodeLine>
<Link id="l02269" /><CodeLine lineNumber="2269"><span class="doxyHighlight">                    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Workspace,</span></CodeLine>
<Link id="l02270" /><CodeLine lineNumber="2270"><span class="doxyHighlight">                    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/cost">Cost</a> &amp;CurCost,</span></CodeLine>
<Link id="l02271" /><CodeLine lineNumber="2271"><span class="doxyHighlight">                    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> &amp;CurRegs,</span></CodeLine>
<Link id="l02272" /><CodeLine lineNumber="2272"><span class="doxyHighlight">                    <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> &amp;VisitedRegs) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02273" /><CodeLine lineNumber="2273"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> Solve(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02274" /><CodeLine lineNumber="2274"></CodeLine>
<Link id="l02275" /><CodeLine lineNumber="2275"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a></span></CodeLine>
<Link id="l02276" /><CodeLine lineNumber="2276"><span class="doxyHighlight">  HoistInsertPosition(<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</span></CodeLine>
<Link id="l02277" /><CodeLine lineNumber="2277"><span class="doxyHighlight">                      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Instruction &#42;&gt;</a> &amp;Inputs) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02278" /><CodeLine lineNumber="2278"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> AdjustInsertPositionForExpand(<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</span></CodeLine>
<Link id="l02279" /><CodeLine lineNumber="2279"><span class="doxyHighlight">                                                     </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF,</span></CodeLine>
<Link id="l02280" /><CodeLine lineNumber="2280"><span class="doxyHighlight">                                                     </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02281" /><CodeLine lineNumber="2281"></CodeLine>
<Link id="l02282" /><CodeLine lineNumber="2282"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;Expand(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l02283" /><CodeLine lineNumber="2283"><span class="doxyHighlight">                <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</span></CodeLine>
<Link id="l02284" /><CodeLine lineNumber="2284"><span class="doxyHighlight">                <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02285" /><CodeLine lineNumber="2285"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RewriteForPHI(<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF,</span></CodeLine>
<Link id="l02286" /><CodeLine lineNumber="2286"><span class="doxyHighlight">                     </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l02287" /><CodeLine lineNumber="2287"><span class="doxyHighlight">                     <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts);</span></CodeLine>
<Link id="l02288" /><CodeLine lineNumber="2288"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> Rewrite(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l02289" /><CodeLine lineNumber="2289"><span class="doxyHighlight">               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts);</span></CodeLine>
<Link id="l02290" /><CodeLine lineNumber="2290"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> ImplementSolution(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution);</span></CodeLine>
<Link id="l02291" /><CodeLine lineNumber="2291"></CodeLine>
<Link id="l02292" /><CodeLine lineNumber="2292"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l02293" /><CodeLine lineNumber="2293"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a9bcf42be7435217d79cd175d4e6993d7">LSRInstance</a>(<a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp;IU, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;DT,</span></CodeLine>
<Link id="l02294" /><CodeLine lineNumber="2294"><span class="doxyHighlight">              <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;TTI, <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;AC,</span></CodeLine>
<Link id="l02295" /><CodeLine lineNumber="2295"><span class="doxyHighlight">              <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp;TLI, <a href="/docs/api/classes/llvm/memoryssaupdater">MemorySSAUpdater</a> &#42;MSSAU);</span></CodeLine>
<Link id="l02296" /><CodeLine lineNumber="2296"></CodeLine>
<Link id="l02297" /><CodeLine lineNumber="2297" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a93ebde9d4c2fe184724a11d3c1184124"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a93ebde9d4c2fe184724a11d3c1184124">getChanged</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Changed; &#125;</span></CodeLine>
<Link id="l02298" /><CodeLine lineNumber="2298" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a34d7093fa45e90e82de2073b08157efc"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakVH&gt;</a> &amp;<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a34d7093fa45e90e82de2073b08157efc">getScalarEvolutionIVs</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02299" /><CodeLine lineNumber="2299"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> ScalarEvolutionIVs;</span></CodeLine>
<Link id="l02300" /><CodeLine lineNumber="2300"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02301" /><CodeLine lineNumber="2301"></CodeLine>
<Link id="l02302" /><CodeLine lineNumber="2302"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> print&#95;factors&#95;and&#95;types(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02303" /><CodeLine lineNumber="2303"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> print&#95;fixups(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02304" /><CodeLine lineNumber="2304"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> print&#95;uses(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02305" /><CodeLine lineNumber="2305"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02306" /><CodeLine lineNumber="2306"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02307" /><CodeLine lineNumber="2307"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l02308" /><CodeLine lineNumber="2308"></CodeLine>
<Link id="l02309" /><CodeLine lineNumber="2309"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l02310" /><CodeLine lineNumber="2310"></CodeLine>
<Link id="l02311" /><CodeLine lineNumber="2311"><span class="doxyHighlightComment">/// If IV is used in a int-to-float cast inside the loop then try to eliminate</span></CodeLine>
<Link id="l02312" /><CodeLine lineNumber="2312"><span class="doxyHighlightComment">/// the cast operation.</span></CodeLine>
<Link id="l02313" /><CodeLine lineNumber="2313"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::OptimizeShadowIV() &#123;</span></CodeLine>
<Link id="l02314" /><CodeLine lineNumber="2314"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BackedgeTakenCount = SE.getBackedgeTakenCount(L);</span></CodeLine>
<Link id="l02315" /><CodeLine lineNumber="2315"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVCouldNotCompute&gt;</a>(BackedgeTakenCount))</span></CodeLine>
<Link id="l02316" /><CodeLine lineNumber="2316"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02317" /><CodeLine lineNumber="2317"></CodeLine>
<Link id="l02318" /><CodeLine lineNumber="2318"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/ivusers/#a1ac1243c7bc2878be52de359bd652680">IVUsers::const&#95;iterator</a> UI = IU.begin(), <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = IU.end();</span></CodeLine>
<Link id="l02319" /><CodeLine lineNumber="2319"><span class="doxyHighlight">       UI != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; </span><span class="doxyHighlightComment">/&#42; empty &#42;/</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l02320" /><CodeLine lineNumber="2320"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/ivusers/#a1ac1243c7bc2878be52de359bd652680">IVUsers::const&#95;iterator</a> CandidateUI = UI;</span></CodeLine>
<Link id="l02321" /><CodeLine lineNumber="2321"><span class="doxyHighlight">    ++UI;</span></CodeLine>
<Link id="l02322" /><CodeLine lineNumber="2322"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;ShadowUse = CandidateUI-&gt;getUser();</span></CodeLine>
<Link id="l02323" /><CodeLine lineNumber="2323"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;DestTy = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02324" /><CodeLine lineNumber="2324"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsSigned = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02325" /><CodeLine lineNumber="2325"></CodeLine>
<Link id="l02326" /><CodeLine lineNumber="2326"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">/&#42; If shadow use is a int-&gt;float cast then insert a second IV</span></CodeLine>
<Link id="l02327" /><CodeLine lineNumber="2327"><span class="doxyHighlightComment">       to eliminate this cast.</span></CodeLine>
<Link id="l02328" /><CodeLine lineNumber="2328"></CodeLine>
<Link id="l02329" /><CodeLine lineNumber="2329"><span class="doxyHighlightComment">         for (unsigned i = 0; i &lt; n; ++i)</span></CodeLine>
<Link id="l02330" /><CodeLine lineNumber="2330"><span class="doxyHighlightComment">           foo((double)i);</span></CodeLine>
<Link id="l02331" /><CodeLine lineNumber="2331"></CodeLine>
<Link id="l02332" /><CodeLine lineNumber="2332"><span class="doxyHighlightComment">       is transformed into</span></CodeLine>
<Link id="l02333" /><CodeLine lineNumber="2333"></CodeLine>
<Link id="l02334" /><CodeLine lineNumber="2334"><span class="doxyHighlightComment">         double d = 0.0;</span></CodeLine>
<Link id="l02335" /><CodeLine lineNumber="2335"><span class="doxyHighlightComment">         for (unsigned i = 0; i &lt; n; ++i, ++d)</span></CodeLine>
<Link id="l02336" /><CodeLine lineNumber="2336"><span class="doxyHighlightComment">           foo(d);</span></CodeLine>
<Link id="l02337" /><CodeLine lineNumber="2337"><span class="doxyHighlightComment">    &#42;/</span></CodeLine>
<Link id="l02338" /><CodeLine lineNumber="2338"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/uitofpinst">UIToFPInst</a> &#42;UCast = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;UIToFPInst&gt;</a>(CandidateUI-&gt;getUser())) &#123;</span></CodeLine>
<Link id="l02339" /><CodeLine lineNumber="2339"><span class="doxyHighlight">      IsSigned = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02340" /><CodeLine lineNumber="2340"><span class="doxyHighlight">      DestTy = UCast-&gt;getDestTy();</span></CodeLine>
<Link id="l02341" /><CodeLine lineNumber="2341"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02342" /><CodeLine lineNumber="2342"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/sitofpinst">SIToFPInst</a> &#42;SCast = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SIToFPInst&gt;</a>(CandidateUI-&gt;getUser())) &#123;</span></CodeLine>
<Link id="l02343" /><CodeLine lineNumber="2343"><span class="doxyHighlight">      IsSigned = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02344" /><CodeLine lineNumber="2344"><span class="doxyHighlight">      DestTy = SCast-&gt;getDestTy();</span></CodeLine>
<Link id="l02345" /><CodeLine lineNumber="2345"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02346" /><CodeLine lineNumber="2346"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DestTy) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02347" /><CodeLine lineNumber="2347"></CodeLine>
<Link id="l02348" /><CodeLine lineNumber="2348"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If target does not support DestTy natively then do not apply</span></CodeLine>
<Link id="l02349" /><CodeLine lineNumber="2349"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// this transformation.</span></CodeLine>
<Link id="l02350" /><CodeLine lineNumber="2350"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isTypeLegal(DestTy)) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02351" /><CodeLine lineNumber="2351"></CodeLine>
<Link id="l02352" /><CodeLine lineNumber="2352"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PH = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(ShadowUse-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0));</span></CodeLine>
<Link id="l02353" /><CodeLine lineNumber="2353"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!PH) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02354" /><CodeLine lineNumber="2354"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PH-&gt;<a href="/docs/api/classes/llvm/phinode/#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>() != 2) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02355" /><CodeLine lineNumber="2355"></CodeLine>
<Link id="l02356" /><CodeLine lineNumber="2356"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the calculation in integers overflows, the result in FP type will</span></CodeLine>
<Link id="l02357" /><CodeLine lineNumber="2357"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// differ. So we only can do this transformation if we are guaranteed to not</span></CodeLine>
<Link id="l02358" /><CodeLine lineNumber="2358"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// deal with overflowing values</span></CodeLine>
<Link id="l02359" /><CodeLine lineNumber="2359"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(SE.getSCEV(PH));</span></CodeLine>
<Link id="l02360" /><CodeLine lineNumber="2360"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!AR) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02361" /><CodeLine lineNumber="2361"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsSigned &amp;&amp; !AR-&gt;<a href="/docs/api/classes/llvm/scevnaryexpr/#a71deee7ef49ab5407b7e1aa758b6ec0a">hasNoSignedWrap</a>()) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02362" /><CodeLine lineNumber="2362"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IsSigned &amp;&amp; !AR-&gt;<a href="/docs/api/classes/llvm/scevnaryexpr/#a09cc70290a71475141063b6dff42a5d2">hasNoUnsignedWrap</a>()) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02363" /><CodeLine lineNumber="2363"></CodeLine>
<Link id="l02364" /><CodeLine lineNumber="2364"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;SrcTy = PH-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</span></CodeLine>
<Link id="l02365" /><CodeLine lineNumber="2365"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> Mantissa = DestTy-&gt;<a href="/docs/api/classes/llvm/type/#ad9b99a13e459cb18bb386ddd610ecf8c">getFPMantissaWidth</a>();</span></CodeLine>
<Link id="l02366" /><CodeLine lineNumber="2366"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Mantissa == -1) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02367" /><CodeLine lineNumber="2367"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((</span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight">)SE.getTypeSizeInBits(SrcTy) &gt; Mantissa)</span></CodeLine>
<Link id="l02368" /><CodeLine lineNumber="2368"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02369" /><CodeLine lineNumber="2369"></CodeLine>
<Link id="l02370" /><CodeLine lineNumber="2370"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/coff/#ae7629a0652411dc2be61aea4fee2b39caadd024eaaab0666500593f30456bbc43">Entry</a>, Latch;</span></CodeLine>
<Link id="l02371" /><CodeLine lineNumber="2371"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PH-&gt;<a href="/docs/api/classes/llvm/phinode/#ac53e1aabdf64e91b8b325bcac250d8a9">getIncomingBlock</a>(0) == <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopPreheader()) &#123;</span></CodeLine>
<Link id="l02372" /><CodeLine lineNumber="2372"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/coff/#ae7629a0652411dc2be61aea4fee2b39caadd024eaaab0666500593f30456bbc43">Entry</a> = 0;</span></CodeLine>
<Link id="l02373" /><CodeLine lineNumber="2373"><span class="doxyHighlight">      Latch = 1;</span></CodeLine>
<Link id="l02374" /><CodeLine lineNumber="2374"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02375" /><CodeLine lineNumber="2375"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/coff/#ae7629a0652411dc2be61aea4fee2b39caadd024eaaab0666500593f30456bbc43">Entry</a> = 1;</span></CodeLine>
<Link id="l02376" /><CodeLine lineNumber="2376"><span class="doxyHighlight">      Latch = 0;</span></CodeLine>
<Link id="l02377" /><CodeLine lineNumber="2377"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02378" /><CodeLine lineNumber="2378"></CodeLine>
<Link id="l02379" /><CodeLine lineNumber="2379"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;<a href="/docs/api/classes/llvm/init">Init</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(PH-&gt;<a href="/docs/api/classes/llvm/phinode/#aca1fd00f3ab63ec8f0f1ccc2093a9f6d">getIncomingValue</a>(Entry));</span></CodeLine>
<Link id="l02380" /><CodeLine lineNumber="2380"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/llvm/init">Init</a>) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02381" /><CodeLine lineNumber="2381"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;NewInit = ConstantFP::get(DestTy, IsSigned ?</span></CodeLine>
<Link id="l02382" /><CodeLine lineNumber="2382"><span class="doxyHighlight">                                        (</span><span class="doxyHighlightKeywordType">double</span><span class="doxyHighlight">)<a href="/docs/api/classes/llvm/init">Init</a>-&gt;getSExtValue() :</span></CodeLine>
<Link id="l02383" /><CodeLine lineNumber="2383"><span class="doxyHighlight">                                        (</span><span class="doxyHighlightKeywordType">double</span><span class="doxyHighlight">)<a href="/docs/api/classes/llvm/init">Init</a>-&gt;getZExtValue());</span></CodeLine>
<Link id="l02384" /><CodeLine lineNumber="2384"></CodeLine>
<Link id="l02385" /><CodeLine lineNumber="2385"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/binaryoperator">BinaryOperator</a> &#42;Incr =</span></CodeLine>
<Link id="l02386" /><CodeLine lineNumber="2386"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;BinaryOperator&gt;</a>(PH-&gt;<a href="/docs/api/classes/llvm/phinode/#aca1fd00f3ab63ec8f0f1ccc2093a9f6d">getIncomingValue</a>(Latch));</span></CodeLine>
<Link id="l02387" /><CodeLine lineNumber="2387"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Incr) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02388" /><CodeLine lineNumber="2388"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Incr-&gt;<a href="/docs/api/classes/llvm/binaryoperator/#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() != Instruction::Add</span></CodeLine>
<Link id="l02389" /><CodeLine lineNumber="2389"><span class="doxyHighlight">        &amp;&amp; Incr-&gt;<a href="/docs/api/classes/llvm/binaryoperator/#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() != Instruction::Sub)</span></CodeLine>
<Link id="l02390" /><CodeLine lineNumber="2390"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02391" /><CodeLine lineNumber="2391"></CodeLine>
<Link id="l02392" /><CodeLine lineNumber="2392"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">/&#42; Initialize new IV, double d = 0 in above example. &#42;/</span></CodeLine>
<Link id="l02393" /><CodeLine lineNumber="2393"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02394" /><CodeLine lineNumber="2394"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Incr-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0) == PH)</span></CodeLine>
<Link id="l02395" /><CodeLine lineNumber="2395"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(Incr-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1));</span></CodeLine>
<Link id="l02396" /><CodeLine lineNumber="2396"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Incr-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1) == PH)</span></CodeLine>
<Link id="l02397" /><CodeLine lineNumber="2397"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(Incr-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0));</span></CodeLine>
<Link id="l02398" /><CodeLine lineNumber="2398"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l02399" /><CodeLine lineNumber="2399"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02400" /><CodeLine lineNumber="2400"></CodeLine>
<Link id="l02401" /><CodeLine lineNumber="2401"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02402" /><CodeLine lineNumber="2402"></CodeLine>
<Link id="l02403" /><CodeLine lineNumber="2403"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Ignore negative constants, as the code below doesn&#39;t handle them</span></CodeLine>
<Link id="l02404" /><CodeLine lineNumber="2404"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// correctly. TODO: Remove this restriction.</span></CodeLine>
<Link id="l02405" /><CodeLine lineNumber="2405"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue().isStrictlyPositive())</span></CodeLine>
<Link id="l02406" /><CodeLine lineNumber="2406"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02407" /><CodeLine lineNumber="2407"></CodeLine>
<Link id="l02408" /><CodeLine lineNumber="2408"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">/&#42; Add new PHINode. &#42;/</span></CodeLine>
<Link id="l02409" /><CodeLine lineNumber="2409"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;NewPH = <a href="/docs/api/classes/llvm/phinode/#af4aba918a76ca15bde1be3e14572e475">PHINode::Create</a>(DestTy, 2, </span><span class="doxyHighlightStringLiteral">&quot;IV.S.&quot;</span><span class="doxyHighlight">, PH-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</span></CodeLine>
<Link id="l02410" /><CodeLine lineNumber="2410"><span class="doxyHighlight">    NewPH-&gt;<a href="/docs/api/classes/llvm/instruction/#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(PH-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</span></CodeLine>
<Link id="l02411" /><CodeLine lineNumber="2411"></CodeLine>
<Link id="l02412" /><CodeLine lineNumber="2412"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">/&#42; create new increment. &#39;++d&#39; in above example. &#42;/</span></CodeLine>
<Link id="l02413" /><CodeLine lineNumber="2413"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;CFP = ConstantFP::get(DestTy, <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getZExtValue());</span></CodeLine>
<Link id="l02414" /><CodeLine lineNumber="2414"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/binaryoperator">BinaryOperator</a> &#42;NewIncr = <a href="/docs/api/classes/llvm/binaryoperator/#a8f385eda0f71b4e8199b296fbc8e0da9">BinaryOperator::Create</a>(</span></CodeLine>
<Link id="l02415" /><CodeLine lineNumber="2415"><span class="doxyHighlight">        Incr-&gt;<a href="/docs/api/classes/llvm/binaryoperator/#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>() == Instruction::Add ? Instruction::FAdd</span></CodeLine>
<Link id="l02416" /><CodeLine lineNumber="2416"><span class="doxyHighlight">                                              : Instruction::FSub,</span></CodeLine>
<Link id="l02417" /><CodeLine lineNumber="2417"><span class="doxyHighlight">        NewPH, CFP, </span><span class="doxyHighlightStringLiteral">&quot;IV.S.next.&quot;</span><span class="doxyHighlight">, Incr-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</span></CodeLine>
<Link id="l02418" /><CodeLine lineNumber="2418"><span class="doxyHighlight">    NewIncr-&gt;<a href="/docs/api/classes/llvm/instruction/#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(Incr-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</span></CodeLine>
<Link id="l02419" /><CodeLine lineNumber="2419"></CodeLine>
<Link id="l02420" /><CodeLine lineNumber="2420"><span class="doxyHighlight">    NewPH-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewInit, PH-&gt;<a href="/docs/api/classes/llvm/phinode/#ac53e1aabdf64e91b8b325bcac250d8a9">getIncomingBlock</a>(Entry));</span></CodeLine>
<Link id="l02421" /><CodeLine lineNumber="2421"><span class="doxyHighlight">    NewPH-&gt;<a href="/docs/api/classes/llvm/phinode/#a089cccb6f231efee72abc76d0f9c695f">addIncoming</a>(NewIncr, PH-&gt;<a href="/docs/api/classes/llvm/phinode/#ac53e1aabdf64e91b8b325bcac250d8a9">getIncomingBlock</a>(Latch));</span></CodeLine>
<Link id="l02422" /><CodeLine lineNumber="2422"></CodeLine>
<Link id="l02423" /><CodeLine lineNumber="2423"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">/&#42; Remove cast operation &#42;/</span></CodeLine>
<Link id="l02424" /><CodeLine lineNumber="2424"><span class="doxyHighlight">    ShadowUse-&gt;<a href="/docs/api/classes/llvm/value/#a3ab5fc45117b450e8bb04e564cb6e5f2">replaceAllUsesWith</a>(NewPH);</span></CodeLine>
<Link id="l02425" /><CodeLine lineNumber="2425"><span class="doxyHighlight">    ShadowUse-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</span></CodeLine>
<Link id="l02426" /><CodeLine lineNumber="2426"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02427" /><CodeLine lineNumber="2427"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02428" /><CodeLine lineNumber="2428"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02429" /><CodeLine lineNumber="2429"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02430" /><CodeLine lineNumber="2430"></CodeLine>
<Link id="l02431" /><CodeLine lineNumber="2431"><span class="doxyHighlightComment">/// If Cond has an operand that is an expression of an IV, set the IV user and</span></CodeLine>
<Link id="l02432" /><CodeLine lineNumber="2432"><span class="doxyHighlightComment">/// stride information and return true, otherwise return false.</span></CodeLine>
<Link id="l02433" /><CodeLine lineNumber="2433"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> LSRInstance::FindIVUserForCond(<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &#42;&amp;CondUse) &#123;</span></CodeLine>
<Link id="l02434" /><CodeLine lineNumber="2434"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;U : IU)</span></CodeLine>
<Link id="l02435" /><CodeLine lineNumber="2435"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser() == <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>) &#123;</span></CodeLine>
<Link id="l02436" /><CodeLine lineNumber="2436"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// NOTE: we could handle setcc instructions with multiple uses here, but</span></CodeLine>
<Link id="l02437" /><CodeLine lineNumber="2437"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// InstCombine does it as well for simple uses, it&#39;s not clear that it</span></CodeLine>
<Link id="l02438" /><CodeLine lineNumber="2438"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// occurs enough in real life to handle.</span></CodeLine>
<Link id="l02439" /><CodeLine lineNumber="2439"><span class="doxyHighlight">      CondUse = &amp;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>;</span></CodeLine>
<Link id="l02440" /><CodeLine lineNumber="2440"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02441" /><CodeLine lineNumber="2441"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02442" /><CodeLine lineNumber="2442"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02443" /><CodeLine lineNumber="2443"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02444" /><CodeLine lineNumber="2444"></CodeLine>
<Link id="l02445" /><CodeLine lineNumber="2445"><span class="doxyHighlightComment">/// Rewrite the loop&#39;s terminating condition if it uses a max computation.</span></CodeLine>
<Link id="l02446" /><CodeLine lineNumber="2446"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02447" /><CodeLine lineNumber="2447"><span class="doxyHighlightComment">/// This is a narrow solution to a specific, but acute, problem. For loops</span></CodeLine>
<Link id="l02448" /><CodeLine lineNumber="2448"><span class="doxyHighlightComment">/// like this:</span></CodeLine>
<Link id="l02449" /><CodeLine lineNumber="2449"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02450" /><CodeLine lineNumber="2450"><span class="doxyHighlightComment">///   i = 0;</span></CodeLine>
<Link id="l02451" /><CodeLine lineNumber="2451"><span class="doxyHighlightComment">///   do &#123;</span></CodeLine>
<Link id="l02452" /><CodeLine lineNumber="2452"><span class="doxyHighlightComment">///     p&#91;i&#93; = 0.0;</span></CodeLine>
<Link id="l02453" /><CodeLine lineNumber="2453"><span class="doxyHighlightComment">///   &#125; while (++i &lt; n);</span></CodeLine>
<Link id="l02454" /><CodeLine lineNumber="2454"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02455" /><CodeLine lineNumber="2455"><span class="doxyHighlightComment">/// the trip count isn&#39;t just &#39;n&#39;, because &#39;n&#39; might not be positive. And</span></CodeLine>
<Link id="l02456" /><CodeLine lineNumber="2456"><span class="doxyHighlightComment">/// unfortunately this can come up even for loops where the user didn&#39;t use</span></CodeLine>
<Link id="l02457" /><CodeLine lineNumber="2457"><span class="doxyHighlightComment">/// a C do-while loop. For example, seemingly well-behaved top-test loops</span></CodeLine>
<Link id="l02458" /><CodeLine lineNumber="2458"><span class="doxyHighlightComment">/// will commonly be lowered like this:</span></CodeLine>
<Link id="l02459" /><CodeLine lineNumber="2459"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02460" /><CodeLine lineNumber="2460"><span class="doxyHighlightComment">///   if (n &gt; 0) &#123;</span></CodeLine>
<Link id="l02461" /><CodeLine lineNumber="2461"><span class="doxyHighlightComment">///     i = 0;</span></CodeLine>
<Link id="l02462" /><CodeLine lineNumber="2462"><span class="doxyHighlightComment">///     do &#123;</span></CodeLine>
<Link id="l02463" /><CodeLine lineNumber="2463"><span class="doxyHighlightComment">///       p&#91;i&#93; = 0.0;</span></CodeLine>
<Link id="l02464" /><CodeLine lineNumber="2464"><span class="doxyHighlightComment">///     &#125; while (++i &lt; n);</span></CodeLine>
<Link id="l02465" /><CodeLine lineNumber="2465"><span class="doxyHighlightComment">///   &#125;</span></CodeLine>
<Link id="l02466" /><CodeLine lineNumber="2466"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02467" /><CodeLine lineNumber="2467"><span class="doxyHighlightComment">/// and then it&#39;s possible for subsequent optimization to obscure the if</span></CodeLine>
<Link id="l02468" /><CodeLine lineNumber="2468"><span class="doxyHighlightComment">/// test in such a way that indvars can&#39;t find it.</span></CodeLine>
<Link id="l02469" /><CodeLine lineNumber="2469"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02470" /><CodeLine lineNumber="2470"><span class="doxyHighlightComment">/// When indvars can&#39;t find the if test in loops like this, it creates a</span></CodeLine>
<Link id="l02471" /><CodeLine lineNumber="2471"><span class="doxyHighlightComment">/// max expression, which allows it to give the loop a canonical</span></CodeLine>
<Link id="l02472" /><CodeLine lineNumber="2472"><span class="doxyHighlightComment">/// induction variable:</span></CodeLine>
<Link id="l02473" /><CodeLine lineNumber="2473"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02474" /><CodeLine lineNumber="2474"><span class="doxyHighlightComment">///   i = 0;</span></CodeLine>
<Link id="l02475" /><CodeLine lineNumber="2475"><span class="doxyHighlightComment">///   max = n &lt; 1 ? 1 : n;</span></CodeLine>
<Link id="l02476" /><CodeLine lineNumber="2476"><span class="doxyHighlightComment">///   do &#123;</span></CodeLine>
<Link id="l02477" /><CodeLine lineNumber="2477"><span class="doxyHighlightComment">///     p&#91;i&#93; = 0.0;</span></CodeLine>
<Link id="l02478" /><CodeLine lineNumber="2478"><span class="doxyHighlightComment">///   &#125; while (++i != max);</span></CodeLine>
<Link id="l02479" /><CodeLine lineNumber="2479"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02480" /><CodeLine lineNumber="2480"><span class="doxyHighlightComment">/// Canonical induction variables are necessary because the loop passes</span></CodeLine>
<Link id="l02481" /><CodeLine lineNumber="2481"><span class="doxyHighlightComment">/// are designed around them. The most obvious example of this is the</span></CodeLine>
<Link id="l02482" /><CodeLine lineNumber="2482"><span class="doxyHighlightComment">/// LoopInfo analysis, which doesn&#39;t remember trip count values. It</span></CodeLine>
<Link id="l02483" /><CodeLine lineNumber="2483"><span class="doxyHighlightComment">/// expects to be able to rediscover the trip count each time it is</span></CodeLine>
<Link id="l02484" /><CodeLine lineNumber="2484"><span class="doxyHighlightComment">/// needed, and it does this using a simple analysis that only succeeds if</span></CodeLine>
<Link id="l02485" /><CodeLine lineNumber="2485"><span class="doxyHighlightComment">/// the loop has a canonical induction variable.</span></CodeLine>
<Link id="l02486" /><CodeLine lineNumber="2486"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02487" /><CodeLine lineNumber="2487"><span class="doxyHighlightComment">/// However, when it comes time to generate code, the maximum operation</span></CodeLine>
<Link id="l02488" /><CodeLine lineNumber="2488"><span class="doxyHighlightComment">/// can be quite costly, especially if it&#39;s inside of an outer loop.</span></CodeLine>
<Link id="l02489" /><CodeLine lineNumber="2489"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02490" /><CodeLine lineNumber="2490"><span class="doxyHighlightComment">/// This function solves this problem by detecting this type of loop and</span></CodeLine>
<Link id="l02491" /><CodeLine lineNumber="2491"><span class="doxyHighlightComment">/// rewriting their conditions from ICMP&#95;NE back to ICMP&#95;SLT, and deleting</span></CodeLine>
<Link id="l02492" /><CodeLine lineNumber="2492"><span class="doxyHighlightComment">/// the instructions for the maximum computation.</span></CodeLine>
<Link id="l02493" /><CodeLine lineNumber="2493"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;LSRInstance::OptimizeMax(<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a>&#42; &amp;CondUse) &#123;</span></CodeLine>
<Link id="l02494" /><CodeLine lineNumber="2494"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check that the loop matches the pattern we&#39;re looking for.</span></CodeLine>
<Link id="l02495" /><CodeLine lineNumber="2495"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getPredicate() != <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP&#95;EQ</a> &amp;&amp;</span></CodeLine>
<Link id="l02496" /><CodeLine lineNumber="2496"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getPredicate() != <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78bac17897ebf2f6a6986280fc3bdf28a30a">CmpInst::ICMP&#95;NE</a>)</span></CodeLine>
<Link id="l02497" /><CodeLine lineNumber="2497"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02498" /><CodeLine lineNumber="2498"></CodeLine>
<Link id="l02499" /><CodeLine lineNumber="2499"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/selectinst">SelectInst</a> &#42;Sel = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SelectInst&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getOperand(1));</span></CodeLine>
<Link id="l02500" /><CodeLine lineNumber="2500"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Sel || !Sel-&gt;<a href="/docs/api/classes/llvm/value/#a3a402430a1bbe70a9282dcb0e0b6a2cd">hasOneUse</a>()) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02501" /><CodeLine lineNumber="2501"></CodeLine>
<Link id="l02502" /><CodeLine lineNumber="2502"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BackedgeTakenCount = SE.getBackedgeTakenCount(L);</span></CodeLine>
<Link id="l02503" /><CodeLine lineNumber="2503"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVCouldNotCompute&gt;</a>(BackedgeTakenCount))</span></CodeLine>
<Link id="l02504" /><CodeLine lineNumber="2504"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02505" /><CodeLine lineNumber="2505"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;One = SE.getConstant(BackedgeTakenCount-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>(), 1);</span></CodeLine>
<Link id="l02506" /><CodeLine lineNumber="2506"></CodeLine>
<Link id="l02507" /><CodeLine lineNumber="2507"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Add one to the backedge-taken count to get the trip count.</span></CodeLine>
<Link id="l02508" /><CodeLine lineNumber="2508"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IterationCount = SE.getAddExpr(One, BackedgeTakenCount);</span></CodeLine>
<Link id="l02509" /><CodeLine lineNumber="2509"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IterationCount != SE.getSCEV(Sel)) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02510" /><CodeLine lineNumber="2510"></CodeLine>
<Link id="l02511" /><CodeLine lineNumber="2511"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check for a max calculation that matches the pattern. There&#39;s no check</span></CodeLine>
<Link id="l02512" /><CodeLine lineNumber="2512"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// for ICMP&#95;ULE here because the comparison would be with zero, which</span></CodeLine>
<Link id="l02513" /><CodeLine lineNumber="2513"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// isn&#39;t interesting.</span></CodeLine>
<Link id="l02514" /><CodeLine lineNumber="2514"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78b">CmpInst::Predicate</a> Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba07aee43ffb66908a25c55c77ce4c0d05">ICmpInst::BAD&#95;ICMP&#95;PREDICATE</a>;</span></CodeLine>
<Link id="l02515" /><CodeLine lineNumber="2515"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevnaryexpr">SCEVNAryExpr</a> &#42;<a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02516" /><CodeLine lineNumber="2516"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevsmaxexpr">SCEVSMaxExpr</a> &#42;S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVSMaxExpr&gt;</a>(BackedgeTakenCount)) &#123;</span></CodeLine>
<Link id="l02517" /><CodeLine lineNumber="2517"><span class="doxyHighlight">    Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba2751d6136a2819749dcef65dc19a4246">ICmpInst::ICMP&#95;SLE</a>;</span></CodeLine>
<Link id="l02518" /><CodeLine lineNumber="2518"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = S;</span></CodeLine>
<Link id="l02519" /><CodeLine lineNumber="2519"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevsmaxexpr">SCEVSMaxExpr</a> &#42;S = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVSMaxExpr&gt;</a>(IterationCount)) &#123;</span></CodeLine>
<Link id="l02520" /><CodeLine lineNumber="2520"><span class="doxyHighlight">    Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba15ae464950ac676919c2f0c7aafc706c">ICmpInst::ICMP&#95;SLT</a>;</span></CodeLine>
<Link id="l02521" /><CodeLine lineNumber="2521"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = S;</span></CodeLine>
<Link id="l02522" /><CodeLine lineNumber="2522"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevumaxexpr">SCEVUMaxExpr</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUMaxExpr&gt;</a>(IterationCount)) &#123;</span></CodeLine>
<Link id="l02523" /><CodeLine lineNumber="2523"><span class="doxyHighlight">    Pred = <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78ba91d86a4753c8bd7624e01bf565d87f8e">ICmpInst::ICMP&#95;ULT</a>;</span></CodeLine>
<Link id="l02524" /><CodeLine lineNumber="2524"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a> = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>;</span></CodeLine>
<Link id="l02525" /><CodeLine lineNumber="2525"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02526" /><CodeLine lineNumber="2526"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// No match; bail.</span></CodeLine>
<Link id="l02527" /><CodeLine lineNumber="2527"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02528" /><CodeLine lineNumber="2528"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02529" /><CodeLine lineNumber="2529"></CodeLine>
<Link id="l02530" /><CodeLine lineNumber="2530"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// To handle a max with more than two operands, this optimization would</span></CodeLine>
<Link id="l02531" /><CodeLine lineNumber="2531"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// require additional checking and setup.</span></CodeLine>
<Link id="l02532" /><CodeLine lineNumber="2532"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a>-&gt;getNumOperands() != 2)</span></CodeLine>
<Link id="l02533" /><CodeLine lineNumber="2533"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02534" /><CodeLine lineNumber="2534"></CodeLine>
<Link id="l02535" /><CodeLine lineNumber="2535"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;MaxLHS = <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a>-&gt;getOperand(0);</span></CodeLine>
<Link id="l02536" /><CodeLine lineNumber="2536"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;MaxRHS = <a href="/docs/api/namespaces/llvm/pdb/#a81a0fae24e6bdfe240da4249a8da5978a6a061313d22e51e0f25b7cd4dc065233">Max</a>-&gt;getOperand(1);</span></CodeLine>
<Link id="l02537" /><CodeLine lineNumber="2537"></CodeLine>
<Link id="l02538" /><CodeLine lineNumber="2538"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ScalarEvolution canonicalizes constants to the left. For &lt; and &gt;, look</span></CodeLine>
<Link id="l02539" /><CodeLine lineNumber="2539"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// for a comparison with 1 For &lt;= and &gt;=, a comparison with zero.</span></CodeLine>
<Link id="l02540" /><CodeLine lineNumber="2540"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!MaxLHS ||</span></CodeLine>
<Link id="l02541" /><CodeLine lineNumber="2541"><span class="doxyHighlight">      (<a href="/docs/api/classes/llvm/cmpinst/#a5ba8484cef2818d14b85640a903b2598">ICmpInst::isTrueWhenEqual</a>(Pred) ? !MaxLHS-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>() : (MaxLHS != One)))</span></CodeLine>
<Link id="l02542" /><CodeLine lineNumber="2542"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02543" /><CodeLine lineNumber="2543"></CodeLine>
<Link id="l02544" /><CodeLine lineNumber="2544"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check the relevant induction variable for conformance to</span></CodeLine>
<Link id="l02545" /><CodeLine lineNumber="2545"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the pattern.</span></CodeLine>
<Link id="l02546" /><CodeLine lineNumber="2546"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> = SE.getSCEV(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getOperand(0));</span></CodeLine>
<Link id="l02547" /><CodeLine lineNumber="2547"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>);</span></CodeLine>
<Link id="l02548" /><CodeLine lineNumber="2548"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!AR || !AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>() ||</span></CodeLine>
<Link id="l02549" /><CodeLine lineNumber="2549"><span class="doxyHighlight">      AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>() != One ||</span></CodeLine>
<Link id="l02550" /><CodeLine lineNumber="2550"><span class="doxyHighlight">      AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE) != One)</span></CodeLine>
<Link id="l02551" /><CodeLine lineNumber="2551"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02552" /><CodeLine lineNumber="2552"></CodeLine>
<Link id="l02553" /><CodeLine lineNumber="2553"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L &amp;&amp;</span></CodeLine>
<Link id="l02554" /><CodeLine lineNumber="2554"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Loop condition operand is an addrec in a different loop!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02555" /><CodeLine lineNumber="2555"></CodeLine>
<Link id="l02556" /><CodeLine lineNumber="2556"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check the right operand of the select, and remember it, as it will</span></CodeLine>
<Link id="l02557" /><CodeLine lineNumber="2557"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// be used in the new comparison instruction.</span></CodeLine>
<Link id="l02558" /><CodeLine lineNumber="2558"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;NewRHS = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02559" /><CodeLine lineNumber="2559"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/cmpinst/#a5ba8484cef2818d14b85640a903b2598">ICmpInst::isTrueWhenEqual</a>(Pred)) &#123;</span></CodeLine>
<Link id="l02560" /><CodeLine lineNumber="2560"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Look for n+1, and grab n.</span></CodeLine>
<Link id="l02561" /><CodeLine lineNumber="2561"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/addoperator">AddOperator</a> &#42;BO = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AddOperator&gt;</a>(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1)))</span></CodeLine>
<Link id="l02562" /><CodeLine lineNumber="2562"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;BO1 = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(BO-&gt;getOperand(1)))</span></CodeLine>
<Link id="l02563" /><CodeLine lineNumber="2563"><span class="doxyHighlight">         </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BO1-&gt;isOne() &amp;&amp; SE.getSCEV(BO-&gt;getOperand(0)) == MaxRHS)</span></CodeLine>
<Link id="l02564" /><CodeLine lineNumber="2564"><span class="doxyHighlight">           NewRHS = BO-&gt;getOperand(0);</span></CodeLine>
<Link id="l02565" /><CodeLine lineNumber="2565"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/addoperator">AddOperator</a> &#42;BO = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;AddOperator&gt;</a>(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(2)))</span></CodeLine>
<Link id="l02566" /><CodeLine lineNumber="2566"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;BO1 = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ConstantInt&gt;</a>(BO-&gt;getOperand(1)))</span></CodeLine>
<Link id="l02567" /><CodeLine lineNumber="2567"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BO1-&gt;isOne() &amp;&amp; SE.getSCEV(BO-&gt;getOperand(0)) == MaxRHS)</span></CodeLine>
<Link id="l02568" /><CodeLine lineNumber="2568"><span class="doxyHighlight">          NewRHS = BO-&gt;getOperand(0);</span></CodeLine>
<Link id="l02569" /><CodeLine lineNumber="2569"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewRHS)</span></CodeLine>
<Link id="l02570" /><CodeLine lineNumber="2570"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02571" /><CodeLine lineNumber="2571"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getSCEV(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1)) == MaxRHS)</span></CodeLine>
<Link id="l02572" /><CodeLine lineNumber="2572"><span class="doxyHighlight">    NewRHS = Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1);</span></CodeLine>
<Link id="l02573" /><CodeLine lineNumber="2573"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getSCEV(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(2)) == MaxRHS)</span></CodeLine>
<Link id="l02574" /><CodeLine lineNumber="2574"><span class="doxyHighlight">    NewRHS = Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(2);</span></CodeLine>
<Link id="l02575" /><CodeLine lineNumber="2575"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;SU = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(MaxRHS))</span></CodeLine>
<Link id="l02576" /><CodeLine lineNumber="2576"><span class="doxyHighlight">    NewRHS = SU-&gt;getValue();</span></CodeLine>
<Link id="l02577" /><CodeLine lineNumber="2577"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l02578" /><CodeLine lineNumber="2578"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Max doesn&#39;t match expected pattern.</span></CodeLine>
<Link id="l02579" /><CodeLine lineNumber="2579"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02580" /><CodeLine lineNumber="2580"></CodeLine>
<Link id="l02581" /><CodeLine lineNumber="2581"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Determine the new comparison opcode. It may be signed or unsigned,</span></CodeLine>
<Link id="l02582" /><CodeLine lineNumber="2582"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// and the original comparison may be either equality or inequality.</span></CodeLine>
<Link id="l02583" /><CodeLine lineNumber="2583"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getPredicate() == <a href="/docs/api/classes/llvm/cmpinst/#a2be3583dac92a031fa1458d4d992c78baa719225e2de4059f93fd3209e1f48218">CmpInst::ICMP&#95;EQ</a>)</span></CodeLine>
<Link id="l02584" /><CodeLine lineNumber="2584"><span class="doxyHighlight">    Pred = <a href="/docs/api/classes/llvm/cmpinst/#aa2a54b545d237ecfe450fd1292f7675e">CmpInst::getInversePredicate</a>(Pred);</span></CodeLine>
<Link id="l02585" /><CodeLine lineNumber="2585"></CodeLine>
<Link id="l02586" /><CodeLine lineNumber="2586"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Ok, everything looks ok to change the condition into an SLT or SGE and</span></CodeLine>
<Link id="l02587" /><CodeLine lineNumber="2587"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// delete the max calculation.</span></CodeLine>
<Link id="l02588" /><CodeLine lineNumber="2588"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;NewCond = </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getIterator(), Pred,</span></CodeLine>
<Link id="l02589" /><CodeLine lineNumber="2589"><span class="doxyHighlight">                                   <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getOperand(0), NewRHS, </span><span class="doxyHighlightStringLiteral">&quot;scmp&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02590" /><CodeLine lineNumber="2590"></CodeLine>
<Link id="l02591" /><CodeLine lineNumber="2591"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Delete the max calculation instructions.</span></CodeLine>
<Link id="l02592" /><CodeLine lineNumber="2592"><span class="doxyHighlight">  NewCond-&gt;<a href="/docs/api/classes/llvm/instruction/#ae8f5bf5cc06f696b52c709677df00fbf">setDebugLoc</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getDebugLoc());</span></CodeLine>
<Link id="l02593" /><CodeLine lineNumber="2593"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;replaceAllUsesWith(NewCond);</span></CodeLine>
<Link id="l02594" /><CodeLine lineNumber="2594"><span class="doxyHighlight">  CondUse-&gt;<a href="/docs/api/classes/llvm/ivstrideuse/#acb8718e691dfd2e5d5a3e0d876e35cc9">setUser</a>(NewCond);</span></CodeLine>
<Link id="l02595" /><CodeLine lineNumber="2595"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(Sel-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0));</span></CodeLine>
<Link id="l02596" /><CodeLine lineNumber="2596"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;eraseFromParent();</span></CodeLine>
<Link id="l02597" /><CodeLine lineNumber="2597"><span class="doxyHighlight">  Sel-&gt;<a href="/docs/api/classes/llvm/instruction/#a601ee49a4c4e0babf29bd1cf09036570">eraseFromParent</a>();</span></CodeLine>
<Link id="l02598" /><CodeLine lineNumber="2598"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;use&#95;empty())</span></CodeLine>
<Link id="l02599" /><CodeLine lineNumber="2599"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a>-&gt;eraseFromParent();</span></CodeLine>
<Link id="l02600" /><CodeLine lineNumber="2600"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> NewCond;</span></CodeLine>
<Link id="l02601" /><CodeLine lineNumber="2601"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02602" /><CodeLine lineNumber="2602"></CodeLine>
<Link id="l02603" /><CodeLine lineNumber="2603"><span class="doxyHighlightComment">/// Change loop terminating condition to use the postinc iv when possible.</span></CodeLine>
<Link id="l02604" /><CodeLine lineNumber="2604"><span class="doxyHighlightKeywordType">void</span></CodeLine>
<Link id="l02605" /><CodeLine lineNumber="2605"><span class="doxyHighlight">LSRInstance::OptimizeLoopTermCond() &#123;</span></CodeLine>
<Link id="l02606" /><CodeLine lineNumber="2606"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction &#42;, 4&gt;</a> PostIncs;</span></CodeLine>
<Link id="l02607" /><CodeLine lineNumber="2607"></CodeLine>
<Link id="l02608" /><CodeLine lineNumber="2608"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We need a different set of heuristics for rotated and non-rotated loops.</span></CodeLine>
<Link id="l02609" /><CodeLine lineNumber="2609"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If a loop is rotated then the latch is also the backedge, so inserting</span></CodeLine>
<Link id="l02610" /><CodeLine lineNumber="2610"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// post-inc expressions just before the latch is ideal. To reduce live ranges</span></CodeLine>
<Link id="l02611" /><CodeLine lineNumber="2611"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// it also makes sense to rewrite terminating conditions to use post-inc</span></CodeLine>
<Link id="l02612" /><CodeLine lineNumber="2612"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// expressions.</span></CodeLine>
<Link id="l02613" /><CodeLine lineNumber="2613"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02614" /><CodeLine lineNumber="2614"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the loop is not rotated then the latch is not a backedge; the latch</span></CodeLine>
<Link id="l02615" /><CodeLine lineNumber="2615"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// check is done in the loop head. Adding post-inc expressions before the</span></CodeLine>
<Link id="l02616" /><CodeLine lineNumber="2616"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// latch will cause overlapping live-ranges of pre-inc and post-inc expressions</span></CodeLine>
<Link id="l02617" /><CodeLine lineNumber="2617"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// in the loop body. In this case we do &#42;not&#42; want to use post-inc expressions</span></CodeLine>
<Link id="l02618" /><CodeLine lineNumber="2618"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// in the latch check, and we want to insert post-inc expressions before</span></CodeLine>
<Link id="l02619" /><CodeLine lineNumber="2619"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the backedge.</span></CodeLine>
<Link id="l02620" /><CodeLine lineNumber="2620"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;LatchBlock = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch();</span></CodeLine>
<Link id="l02621" /><CodeLine lineNumber="2621"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock&#42;, 8&gt;</a> ExitingBlocks;</span></CodeLine>
<Link id="l02622" /><CodeLine lineNumber="2622"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getExitingBlocks(ExitingBlocks);</span></CodeLine>
<Link id="l02623" /><CodeLine lineNumber="2623"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#acd1cd968cb420c82d70926920fcdc7d7">llvm::is&#95;contained</a>(ExitingBlocks, LatchBlock)) &#123;</span></CodeLine>
<Link id="l02624" /><CodeLine lineNumber="2624"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The backedge doesn&#39;t exit the loop; treat this as a head-tested loop.</span></CodeLine>
<Link id="l02625" /><CodeLine lineNumber="2625"><span class="doxyHighlight">    IVIncInsertPos = LatchBlock-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</span></CodeLine>
<Link id="l02626" /><CodeLine lineNumber="2626"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02627" /><CodeLine lineNumber="2627"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02628" /><CodeLine lineNumber="2628"></CodeLine>
<Link id="l02629" /><CodeLine lineNumber="2629"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Otherwise treat this as a rotated loop.</span></CodeLine>
<Link id="l02630" /><CodeLine lineNumber="2630"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;ExitingBlock : ExitingBlocks) &#123;</span></CodeLine>
<Link id="l02631" /><CodeLine lineNumber="2631"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Get the terminating condition for the loop if possible.  If we</span></CodeLine>
<Link id="l02632" /><CodeLine lineNumber="2632"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// can, we want to change it to use a post-incremented version of its</span></CodeLine>
<Link id="l02633" /><CodeLine lineNumber="2633"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// induction variable, to allow coalescing the live ranges for the IV into</span></CodeLine>
<Link id="l02634" /><CodeLine lineNumber="2634"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// one register value.</span></CodeLine>
<Link id="l02635" /><CodeLine lineNumber="2635"></CodeLine>
<Link id="l02636" /><CodeLine lineNumber="2636"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/branchinst">BranchInst</a> &#42;TermBr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;BranchInst&gt;</a>(ExitingBlock-&gt;getTerminator());</span></CodeLine>
<Link id="l02637" /><CodeLine lineNumber="2637"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!TermBr)</span></CodeLine>
<Link id="l02638" /><CodeLine lineNumber="2638"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02639" /><CodeLine lineNumber="2639"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// FIXME: Overly conservative, termination condition could be an &#39;or&#39; etc..</span></CodeLine>
<Link id="l02640" /><CodeLine lineNumber="2640"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TermBr-&gt;<a href="/docs/api/classes/llvm/branchinst/#ad56f6a9b5cd05940017c4544df48bc30">isUnconditional</a>() || !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;ICmpInst&gt;</a>(TermBr-&gt;<a href="/docs/api/classes/llvm/branchinst/#aebd4af5642453ce3169094f08dd3d7b8">getCondition</a>()))</span></CodeLine>
<Link id="l02641" /><CodeLine lineNumber="2641"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02642" /><CodeLine lineNumber="2642"></CodeLine>
<Link id="l02643" /><CodeLine lineNumber="2643"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Search IVUsesByStride to find Cond&#39;s IVUse if there is one.</span></CodeLine>
<Link id="l02644" /><CodeLine lineNumber="2644"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &#42;CondUse = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02645" /><CodeLine lineNumber="2645"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ICmpInst&gt;</a>(TermBr-&gt;<a href="/docs/api/classes/llvm/branchinst/#aebd4af5642453ce3169094f08dd3d7b8">getCondition</a>());</span></CodeLine>
<Link id="l02646" /><CodeLine lineNumber="2646"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!FindIVUserForCond(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, CondUse))</span></CodeLine>
<Link id="l02647" /><CodeLine lineNumber="2647"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02648" /><CodeLine lineNumber="2648"></CodeLine>
<Link id="l02649" /><CodeLine lineNumber="2649"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the trip count is computed in terms of a max (due to ScalarEvolution</span></CodeLine>
<Link id="l02650" /><CodeLine lineNumber="2650"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// being unable to find a sufficient guard, for example), change the loop</span></CodeLine>
<Link id="l02651" /><CodeLine lineNumber="2651"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// comparison to use SLT or ULT instead of NE.</span></CodeLine>
<Link id="l02652" /><CodeLine lineNumber="2652"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// One consequence of doing this now is that it disrupts the count-down</span></CodeLine>
<Link id="l02653" /><CodeLine lineNumber="2653"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// optimization. That&#39;s not always a bad thing though, because in such</span></CodeLine>
<Link id="l02654" /><CodeLine lineNumber="2654"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// cases it may still be worthwhile to avoid a max.</span></CodeLine>
<Link id="l02655" /><CodeLine lineNumber="2655"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = OptimizeMax(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, CondUse);</span></CodeLine>
<Link id="l02656" /><CodeLine lineNumber="2656"></CodeLine>
<Link id="l02657" /><CodeLine lineNumber="2657"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this exiting block dominates the latch block, it may also use</span></CodeLine>
<Link id="l02658" /><CodeLine lineNumber="2658"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the post-inc value if it won&#39;t be shared with other uses.</span></CodeLine>
<Link id="l02659" /><CodeLine lineNumber="2659"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check for dominance.</span></CodeLine>
<Link id="l02660" /><CodeLine lineNumber="2660"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DT.dominates(ExitingBlock, LatchBlock))</span></CodeLine>
<Link id="l02661" /><CodeLine lineNumber="2661"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02662" /><CodeLine lineNumber="2662"></CodeLine>
<Link id="l02663" /><CodeLine lineNumber="2663"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Conservatively avoid trying to use the post-inc value in non-latch</span></CodeLine>
<Link id="l02664" /><CodeLine lineNumber="2664"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// exits if there may be pre-inc users in intervening blocks.</span></CodeLine>
<Link id="l02665" /><CodeLine lineNumber="2665"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LatchBlock != ExitingBlock)</span></CodeLine>
<Link id="l02666" /><CodeLine lineNumber="2666"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;UI : IU)</span></CodeLine>
<Link id="l02667" /><CodeLine lineNumber="2667"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Test if the use is reachable from the exiting block. This dominator</span></CodeLine>
<Link id="l02668" /><CodeLine lineNumber="2668"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// query is a conservative approximation of reachability.</span></CodeLine>
<Link id="l02669" /><CodeLine lineNumber="2669"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&amp;UI != CondUse &amp;&amp;</span></CodeLine>
<Link id="l02670" /><CodeLine lineNumber="2670"><span class="doxyHighlight">            !DT.properlyDominates(UI.getUser()-&gt;getParent(), ExitingBlock)) &#123;</span></CodeLine>
<Link id="l02671" /><CodeLine lineNumber="2671"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Conservatively assume there may be reuse if the quotient of their</span></CodeLine>
<Link id="l02672" /><CodeLine lineNumber="2672"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// strides could be a legal scale.</span></CodeLine>
<Link id="l02673" /><CodeLine lineNumber="2673"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a> = IU.getStride(&#42;CondUse, L);</span></CodeLine>
<Link id="l02674" /><CodeLine lineNumber="2674"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a> = IU.getStride(UI, L);</span></CodeLine>
<Link id="l02675" /><CodeLine lineNumber="2675"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a> || !<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02676" /><CodeLine lineNumber="2676"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getTypeSizeInBits(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getType()) !=</span></CodeLine>
<Link id="l02677" /><CodeLine lineNumber="2677"><span class="doxyHighlight">              SE.getTypeSizeInBits(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;getType())) &#123;</span></CodeLine>
<Link id="l02678" /><CodeLine lineNumber="2678"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getTypeSizeInBits(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getType()) &gt;</span></CodeLine>
<Link id="l02679" /><CodeLine lineNumber="2679"><span class="doxyHighlight">                SE.getTypeSizeInBits(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;getType()))</span></CodeLine>
<Link id="l02680" /><CodeLine lineNumber="2680"><span class="doxyHighlight">              <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a> = SE.getSignExtendExpr(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getType());</span></CodeLine>
<Link id="l02681" /><CodeLine lineNumber="2681"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l02682" /><CodeLine lineNumber="2682"><span class="doxyHighlight">              <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a> = SE.getSignExtendExpr(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;getType());</span></CodeLine>
<Link id="l02683" /><CodeLine lineNumber="2683"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l02684" /><CodeLine lineNumber="2684"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a> =</span></CodeLine>
<Link id="l02685" /><CodeLine lineNumber="2685"><span class="doxyHighlight">                <a href="/docs/api/namespaces/llvm/#a5f6182886dc2f96c204299e92c1565d5">dyn&#95;cast&#95;or&#95;null&lt;SCEVConstant&gt;</a>(<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>, <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, SE))) &#123;</span></CodeLine>
<Link id="l02686" /><CodeLine lineNumber="2686"><span class="doxyHighlight">            </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/constantint">ConstantInt</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>-&gt;getValue();</span></CodeLine>
<Link id="l02687" /><CodeLine lineNumber="2687"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// Stride of one or negative one can have reuse with non-addresses.</span></CodeLine>
<Link id="l02688" /><CodeLine lineNumber="2688"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;isOne() || <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;isMinusOne())</span></CodeLine>
<Link id="l02689" /><CodeLine lineNumber="2689"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">goto</span><span class="doxyHighlight"> decline&#95;post&#95;inc;</span></CodeLine>
<Link id="l02690" /><CodeLine lineNumber="2690"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// Avoid weird situations.</span></CodeLine>
<Link id="l02691" /><CodeLine lineNumber="2691"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue().getSignificantBits() &gt;= 64 ||</span></CodeLine>
<Link id="l02692" /><CodeLine lineNumber="2692"><span class="doxyHighlight">                <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue().isMinSignedValue())</span></CodeLine>
<Link id="l02693" /><CodeLine lineNumber="2693"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">goto</span><span class="doxyHighlight"> decline&#95;post&#95;inc;</span></CodeLine>
<Link id="l02694" /><CodeLine lineNumber="2694"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// Check for possible scaled-address reuse.</span></CodeLine>
<Link id="l02695" /><CodeLine lineNumber="2695"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UI.getUser(), UI.getOperandValToReplace())) &#123;</span></CodeLine>
<Link id="l02696" /><CodeLine lineNumber="2696"><span class="doxyHighlight">              MemAccessTy AccessTy =</span></CodeLine>
<Link id="l02697" /><CodeLine lineNumber="2697"><span class="doxyHighlight">                  <a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UI.getUser(), UI.getOperandValToReplace());</span></CodeLine>
<Link id="l02698" /><CodeLine lineNumber="2698"><span class="doxyHighlight">              int64&#95;t Scale = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getSExtValue();</span></CodeLine>
<Link id="l02699" /><CodeLine lineNumber="2699"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(AccessTy.MemTy, </span><span class="doxyHighlightComment">/&#42;BaseGV=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l02700" /><CodeLine lineNumber="2700"><span class="doxyHighlight">                                            </span><span class="doxyHighlightComment">/&#42;BaseOffset=&#42;/</span><span class="doxyHighlight">0,</span></CodeLine>
<Link id="l02701" /><CodeLine lineNumber="2701"><span class="doxyHighlight">                                            </span><span class="doxyHighlightComment">/&#42;HasBaseReg=&#42;/</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, Scale,</span></CodeLine>
<Link id="l02702" /><CodeLine lineNumber="2702"><span class="doxyHighlight">                                            AccessTy.AddrSpace))</span></CodeLine>
<Link id="l02703" /><CodeLine lineNumber="2703"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">goto</span><span class="doxyHighlight"> decline&#95;post&#95;inc;</span></CodeLine>
<Link id="l02704" /><CodeLine lineNumber="2704"><span class="doxyHighlight">              Scale = -Scale;</span></CodeLine>
<Link id="l02705" /><CodeLine lineNumber="2705"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(AccessTy.MemTy, </span><span class="doxyHighlightComment">/&#42;BaseGV=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l02706" /><CodeLine lineNumber="2706"><span class="doxyHighlight">                                            </span><span class="doxyHighlightComment">/&#42;BaseOffset=&#42;/</span><span class="doxyHighlight">0,</span></CodeLine>
<Link id="l02707" /><CodeLine lineNumber="2707"><span class="doxyHighlight">                                            </span><span class="doxyHighlightComment">/&#42;HasBaseReg=&#42;/</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, Scale,</span></CodeLine>
<Link id="l02708" /><CodeLine lineNumber="2708"><span class="doxyHighlight">                                            AccessTy.AddrSpace))</span></CodeLine>
<Link id="l02709" /><CodeLine lineNumber="2709"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">goto</span><span class="doxyHighlight"> decline&#95;post&#95;inc;</span></CodeLine>
<Link id="l02710" /><CodeLine lineNumber="2710"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l02711" /><CodeLine lineNumber="2711"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l02712" /><CodeLine lineNumber="2712"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02713" /><CodeLine lineNumber="2713"></CodeLine>
<Link id="l02714" /><CodeLine lineNumber="2714"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Change loop exiting icmp to use postinc iv: &quot;</span></CodeLine>
<Link id="l02715" /><CodeLine lineNumber="2715"><span class="doxyHighlight">                      &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02716" /><CodeLine lineNumber="2716"></CodeLine>
<Link id="l02717" /><CodeLine lineNumber="2717"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// It&#39;s possible for the setcc instruction to be anywhere in the loop, and</span></CodeLine>
<Link id="l02718" /><CodeLine lineNumber="2718"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// possible for it to have multiple users.  If it is not immediately before</span></CodeLine>
<Link id="l02719" /><CodeLine lineNumber="2719"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the exiting block branch, move it.</span></CodeLine>
<Link id="l02720" /><CodeLine lineNumber="2720"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;getNextNonDebugInstruction() != TermBr) &#123;</span></CodeLine>
<Link id="l02721" /><CodeLine lineNumber="2721"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;hasOneUse()) &#123;</span></CodeLine>
<Link id="l02722" /><CodeLine lineNumber="2722"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;moveBefore(TermBr-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</span></CodeLine>
<Link id="l02723" /><CodeLine lineNumber="2723"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02724" /><CodeLine lineNumber="2724"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Clone the terminating condition and insert into the loopend.</span></CodeLine>
<Link id="l02725" /><CodeLine lineNumber="2725"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;OldCond = <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>;</span></CodeLine>
<Link id="l02726" /><CodeLine lineNumber="2726"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ICmpInst&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;clone());</span></CodeLine>
<Link id="l02727" /><CodeLine lineNumber="2727"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;setName(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getName() + </span><span class="doxyHighlightStringLiteral">&quot;.termcond&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02728" /><CodeLine lineNumber="2728"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>-&gt;insertInto(ExitingBlock, TermBr-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</span></CodeLine>
<Link id="l02729" /><CodeLine lineNumber="2729"></CodeLine>
<Link id="l02730" /><CodeLine lineNumber="2730"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Clone the IVUse, as the old use still exists!</span></CodeLine>
<Link id="l02731" /><CodeLine lineNumber="2731"><span class="doxyHighlight">        CondUse = &amp;IU.AddUser(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>, CondUse-&gt;<a href="/docs/api/classes/llvm/ivstrideuse/#a850ce8990175a8dc4e5a641df3db14aa">getOperandValToReplace</a>());</span></CodeLine>
<Link id="l02732" /><CodeLine lineNumber="2732"><span class="doxyHighlight">        TermBr-&gt;<a href="/docs/api/classes/llvm/user/#a1600c7959045cb6b6a5f5a1d427ec67e">replaceUsesOfWith</a>(OldCond, <a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>);</span></CodeLine>
<Link id="l02733" /><CodeLine lineNumber="2733"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02734" /><CodeLine lineNumber="2734"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02735" /><CodeLine lineNumber="2735"></CodeLine>
<Link id="l02736" /><CodeLine lineNumber="2736"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we get to here, we know that we can transform the setcc instruction to</span></CodeLine>
<Link id="l02737" /><CodeLine lineNumber="2737"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// use the post-incremented version of the IV, allowing us to coalesce the</span></CodeLine>
<Link id="l02738" /><CodeLine lineNumber="2738"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// live ranges for the IV correctly.</span></CodeLine>
<Link id="l02739" /><CodeLine lineNumber="2739"><span class="doxyHighlight">    CondUse-&gt;<a href="/docs/api/classes/llvm/ivstrideuse/#a8433a09d9b66df4f5c8a4d1414dc8ec9">transformToPostInc</a>(L);</span></CodeLine>
<Link id="l02740" /><CodeLine lineNumber="2740"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02741" /><CodeLine lineNumber="2741"></CodeLine>
<Link id="l02742" /><CodeLine lineNumber="2742"><span class="doxyHighlight">    PostIncs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/riscv/riscvredundantcopyelimination-cpp/#a193847098793cdbab306803186676899">Cond</a>);</span></CodeLine>
<Link id="l02743" /><CodeLine lineNumber="2743"><span class="doxyHighlight">  decline&#95;post&#95;inc:;</span></CodeLine>
<Link id="l02744" /><CodeLine lineNumber="2744"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02745" /><CodeLine lineNumber="2745"></CodeLine>
<Link id="l02746" /><CodeLine lineNumber="2746"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Determine an insertion point for the loop induction variable increment. It</span></CodeLine>
<Link id="l02747" /><CodeLine lineNumber="2747"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// must dominate all the post-inc comparisons we just set up, and it must</span></CodeLine>
<Link id="l02748" /><CodeLine lineNumber="2748"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// dominate the loop latch edge.</span></CodeLine>
<Link id="l02749" /><CodeLine lineNumber="2749"><span class="doxyHighlight">  IVIncInsertPos = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()-&gt;getTerminator();</span></CodeLine>
<Link id="l02750" /><CodeLine lineNumber="2750"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst : PostIncs)</span></CodeLine>
<Link id="l02751" /><CodeLine lineNumber="2751"><span class="doxyHighlight">    IVIncInsertPos = DT.findNearestCommonDominator(IVIncInsertPos, Inst);</span></CodeLine>
<Link id="l02752" /><CodeLine lineNumber="2752"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02753" /><CodeLine lineNumber="2753"></CodeLine>
<Link id="l02754" /><CodeLine lineNumber="2754"><span class="doxyHighlightComment">/// Determine if the given use can accommodate a fixup at the given offset and</span></CodeLine>
<Link id="l02755" /><CodeLine lineNumber="2755"><span class="doxyHighlightComment">/// other details. If so, update the use and return true.</span></CodeLine>
<Link id="l02756" /><CodeLine lineNumber="2756"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> LSRInstance::reconcileNewOffset(LSRUse &amp;LU, Immediate NewOffset,</span></CodeLine>
<Link id="l02757" /><CodeLine lineNumber="2757"><span class="doxyHighlight">                                     </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasBaseReg, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</span></CodeLine>
<Link id="l02758" /><CodeLine lineNumber="2758"><span class="doxyHighlight">                                     MemAccessTy AccessTy) &#123;</span></CodeLine>
<Link id="l02759" /><CodeLine lineNumber="2759"><span class="doxyHighlight">  Immediate NewMinOffset = LU.MinOffset;</span></CodeLine>
<Link id="l02760" /><CodeLine lineNumber="2760"><span class="doxyHighlight">  Immediate NewMaxOffset = LU.MaxOffset;</span></CodeLine>
<Link id="l02761" /><CodeLine lineNumber="2761"><span class="doxyHighlight">  MemAccessTy NewAccessTy = AccessTy;</span></CodeLine>
<Link id="l02762" /><CodeLine lineNumber="2762"></CodeLine>
<Link id="l02763" /><CodeLine lineNumber="2763"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check for a mismatched kind. It&#39;s tempting to collapse mismatched kinds to</span></CodeLine>
<Link id="l02764" /><CodeLine lineNumber="2764"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// something conservative, however this can pessimize in the case that one of</span></CodeLine>
<Link id="l02765" /><CodeLine lineNumber="2765"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the uses will have all its uses outside the loop, for example.</span></CodeLine>
<Link id="l02766" /><CodeLine lineNumber="2766"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind != Kind)</span></CodeLine>
<Link id="l02767" /><CodeLine lineNumber="2767"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02768" /><CodeLine lineNumber="2768"></CodeLine>
<Link id="l02769" /><CodeLine lineNumber="2769"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check for a mismatched access type, and fall back conservatively as needed.</span></CodeLine>
<Link id="l02770" /><CodeLine lineNumber="2770"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: Be less conservative when the type is similar and can use the same</span></CodeLine>
<Link id="l02771" /><CodeLine lineNumber="2771"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// addressing modes.</span></CodeLine>
<Link id="l02772" /><CodeLine lineNumber="2772"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>) &#123;</span></CodeLine>
<Link id="l02773" /><CodeLine lineNumber="2773"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AccessTy.MemTy != LU.AccessTy.MemTy) &#123;</span></CodeLine>
<Link id="l02774" /><CodeLine lineNumber="2774"><span class="doxyHighlight">      NewAccessTy = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/memaccessty/#a153bbcee36817bcedb110f30d95b2368">MemAccessTy::getUnknown</a>(AccessTy.MemTy-&gt;getContext(),</span></CodeLine>
<Link id="l02775" /><CodeLine lineNumber="2775"><span class="doxyHighlight">                                            AccessTy.AddrSpace);</span></CodeLine>
<Link id="l02776" /><CodeLine lineNumber="2776"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02777" /><CodeLine lineNumber="2777"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02778" /><CodeLine lineNumber="2778"></CodeLine>
<Link id="l02779" /><CodeLine lineNumber="2779"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Conservatively assume HasBaseReg is true for now.</span></CodeLine>
<Link id="l02780" /><CodeLine lineNumber="2780"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#a83e6442f8ebefccdb5e089732fe397ac">Immediate::isKnownLT</a>(NewOffset, LU.MinOffset)) &#123;</span></CodeLine>
<Link id="l02781" /><CodeLine lineNumber="2781"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, NewAccessTy, </span><span class="doxyHighlightComment">/&#42;BaseGV=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l02782" /><CodeLine lineNumber="2782"><span class="doxyHighlight">                          LU.MaxOffset - NewOffset, HasBaseReg))</span></CodeLine>
<Link id="l02783" /><CodeLine lineNumber="2783"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02784" /><CodeLine lineNumber="2784"><span class="doxyHighlight">    NewMinOffset = NewOffset;</span></CodeLine>
<Link id="l02785" /><CodeLine lineNumber="2785"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/details/fixedorscalablequantity/#addaa86bfa4ca26b7f366cbdd868f99bf">Immediate::isKnownGT</a>(NewOffset, LU.MaxOffset)) &#123;</span></CodeLine>
<Link id="l02786" /><CodeLine lineNumber="2786"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, NewAccessTy, </span><span class="doxyHighlightComment">/&#42;BaseGV=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l02787" /><CodeLine lineNumber="2787"><span class="doxyHighlight">                          NewOffset - LU.MinOffset, HasBaseReg))</span></CodeLine>
<Link id="l02788" /><CodeLine lineNumber="2788"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02789" /><CodeLine lineNumber="2789"><span class="doxyHighlight">    NewMaxOffset = NewOffset;</span></CodeLine>
<Link id="l02790" /><CodeLine lineNumber="2790"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02791" /><CodeLine lineNumber="2791"></CodeLine>
<Link id="l02792" /><CodeLine lineNumber="2792"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// FIXME: We should be able to handle some level of scalable offset support</span></CodeLine>
<Link id="l02793" /><CodeLine lineNumber="2793"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// for &#39;void&#39;, but in order to get basic support up and running this is</span></CodeLine>
<Link id="l02794" /><CodeLine lineNumber="2794"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// being left out.</span></CodeLine>
<Link id="l02795" /><CodeLine lineNumber="2795"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewAccessTy.MemTy &amp;&amp; NewAccessTy.MemTy-&gt;isVoidTy() &amp;&amp;</span></CodeLine>
<Link id="l02796" /><CodeLine lineNumber="2796"><span class="doxyHighlight">      (NewMinOffset.isScalable() || NewMaxOffset.isScalable()))</span></CodeLine>
<Link id="l02797" /><CodeLine lineNumber="2797"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02798" /><CodeLine lineNumber="2798"></CodeLine>
<Link id="l02799" /><CodeLine lineNumber="2799"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Update the use.</span></CodeLine>
<Link id="l02800" /><CodeLine lineNumber="2800"><span class="doxyHighlight">  LU.MinOffset = NewMinOffset;</span></CodeLine>
<Link id="l02801" /><CodeLine lineNumber="2801"><span class="doxyHighlight">  LU.MaxOffset = NewMaxOffset;</span></CodeLine>
<Link id="l02802" /><CodeLine lineNumber="2802"><span class="doxyHighlight">  LU.AccessTy = NewAccessTy;</span></CodeLine>
<Link id="l02803" /><CodeLine lineNumber="2803"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02804" /><CodeLine lineNumber="2804"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02805" /><CodeLine lineNumber="2805"></CodeLine>
<Link id="l02806" /><CodeLine lineNumber="2806"><span class="doxyHighlightComment">/// Return an LSRUse index and an offset value for a fixup which needs the given</span></CodeLine>
<Link id="l02807" /><CodeLine lineNumber="2807"><span class="doxyHighlightComment">/// expression, with the given kind and optional access type.  Either reuse an</span></CodeLine>
<Link id="l02808" /><CodeLine lineNumber="2808"><span class="doxyHighlightComment">/// existing use or create a new one, as needed.</span></CodeLine>
<Link id="l02809" /><CodeLine lineNumber="2809"><span class="doxyHighlight">std::pair&lt;size&#95;t, Immediate&gt; LSRInstance::getUse(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;Expr,</span></CodeLine>
<Link id="l02810" /><CodeLine lineNumber="2810"><span class="doxyHighlight">                                                 <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> Kind,</span></CodeLine>
<Link id="l02811" /><CodeLine lineNumber="2811"><span class="doxyHighlight">                                                 MemAccessTy AccessTy) &#123;</span></CodeLine>
<Link id="l02812" /><CodeLine lineNumber="2812"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/namespaces/llvm/codeview/#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a> = Expr;</span></CodeLine>
<Link id="l02813" /><CodeLine lineNumber="2813"><span class="doxyHighlight">  Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(Expr, SE);</span></CodeLine>
<Link id="l02814" /><CodeLine lineNumber="2814"></CodeLine>
<Link id="l02815" /><CodeLine lineNumber="2815"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Basic uses can&#39;t accept any offset, for example.</span></CodeLine>
<Link id="l02816" /><CodeLine lineNumber="2816"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, Kind, AccessTy, </span><span class="doxyHighlightComment">/&#42;BaseGV=&#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l02817" /><CodeLine lineNumber="2817"><span class="doxyHighlight">                        <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, </span><span class="doxyHighlightComment">/&#42;HasBaseReg=&#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">)) &#123;</span></CodeLine>
<Link id="l02818" /><CodeLine lineNumber="2818"><span class="doxyHighlight">    Expr = <a href="/docs/api/namespaces/llvm/codeview/#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>;</span></CodeLine>
<Link id="l02819" /><CodeLine lineNumber="2819"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(0);</span></CodeLine>
<Link id="l02820" /><CodeLine lineNumber="2820"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02821" /><CodeLine lineNumber="2821"></CodeLine>
<Link id="l02822" /><CodeLine lineNumber="2822"><span class="doxyHighlight">  std::pair&lt;UseMapTy::iterator, bool&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> =</span></CodeLine>
<Link id="l02823" /><CodeLine lineNumber="2823"><span class="doxyHighlight">    UseMap.insert(std::make&#95;pair(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a4a62881e0181b4f2dc498eff32edf764">LSRUse::SCEVUseKindPair</a>(Expr, Kind), 0));</span></CodeLine>
<Link id="l02824" /><CodeLine lineNumber="2824"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second) &#123;</span></CodeLine>
<Link id="l02825" /><CodeLine lineNumber="2825"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// A use already existed with this base.</span></CodeLine>
<Link id="l02826" /><CodeLine lineNumber="2826"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;second;</span></CodeLine>
<Link id="l02827" /><CodeLine lineNumber="2827"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l02828" /><CodeLine lineNumber="2828"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (reconcileNewOffset(LU, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, </span><span class="doxyHighlightComment">/&#42;HasBaseReg=&#42;/</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, Kind, AccessTy))</span></CodeLine>
<Link id="l02829" /><CodeLine lineNumber="2829"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Reuse this use.</span></CodeLine>
<Link id="l02830" /><CodeLine lineNumber="2830"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::make&#95;pair(LUIdx, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</span></CodeLine>
<Link id="l02831" /><CodeLine lineNumber="2831"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02832" /><CodeLine lineNumber="2832"></CodeLine>
<Link id="l02833" /><CodeLine lineNumber="2833"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Create a new use.</span></CodeLine>
<Link id="l02834" /><CodeLine lineNumber="2834"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size();</span></CodeLine>
<Link id="l02835" /><CodeLine lineNumber="2835"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;second = LUIdx;</span></CodeLine>
<Link id="l02836" /><CodeLine lineNumber="2836"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.push&#95;back(LSRUse(Kind, AccessTy));</span></CodeLine>
<Link id="l02837" /><CodeLine lineNumber="2837"><span class="doxyHighlight">  LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l02838" /><CodeLine lineNumber="2838"></CodeLine>
<Link id="l02839" /><CodeLine lineNumber="2839"><span class="doxyHighlight">  LU.MinOffset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</span></CodeLine>
<Link id="l02840" /><CodeLine lineNumber="2840"><span class="doxyHighlight">  LU.MaxOffset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</span></CodeLine>
<Link id="l02841" /><CodeLine lineNumber="2841"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::make&#95;pair(LUIdx, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</span></CodeLine>
<Link id="l02842" /><CodeLine lineNumber="2842"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02843" /><CodeLine lineNumber="2843"></CodeLine>
<Link id="l02844" /><CodeLine lineNumber="2844"><span class="doxyHighlightComment">/// Delete the given use from the Uses list.</span></CodeLine>
<Link id="l02845" /><CodeLine lineNumber="2845"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::DeleteUse(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx) &#123;</span></CodeLine>
<Link id="l02846" /><CodeLine lineNumber="2846"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&amp;LU != &amp;<a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.back())</span></CodeLine>
<Link id="l02847" /><CodeLine lineNumber="2847"><span class="doxyHighlight">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LU, <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.back());</span></CodeLine>
<Link id="l02848" /><CodeLine lineNumber="2848"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.pop&#95;back();</span></CodeLine>
<Link id="l02849" /><CodeLine lineNumber="2849"></CodeLine>
<Link id="l02850" /><CodeLine lineNumber="2850"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Update RegUses.</span></CodeLine>
<Link id="l02851" /><CodeLine lineNumber="2851"><span class="doxyHighlight">  RegUses.swapAndDropUse(LUIdx, <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size());</span></CodeLine>
<Link id="l02852" /><CodeLine lineNumber="2852"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02853" /><CodeLine lineNumber="2853"></CodeLine>
<Link id="l02854" /><CodeLine lineNumber="2854"><span class="doxyHighlightComment">/// Look for a use distinct from OrigLU which is has a formula that has the same</span></CodeLine>
<Link id="l02855" /><CodeLine lineNumber="2855"><span class="doxyHighlightComment">/// registers as the given formula.</span></CodeLine>
<Link id="l02856" /><CodeLine lineNumber="2856"><span class="doxyHighlight">LSRUse &#42;</span></CodeLine>
<Link id="l02857" /><CodeLine lineNumber="2857"><span class="doxyHighlight">LSRInstance::FindUseWithSimilarFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;OrigF,</span></CodeLine>
<Link id="l02858" /><CodeLine lineNumber="2858"><span class="doxyHighlight">                                       </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;OrigLU) &#123;</span></CodeLine>
<Link id="l02859" /><CodeLine lineNumber="2859"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Search all uses for the formula. This could be more clever.</span></CodeLine>
<Link id="l02860" /><CodeLine lineNumber="2860"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (LSRUse &amp;LU : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>) &#123;</span></CodeLine>
<Link id="l02861" /><CodeLine lineNumber="2861"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check whether this use is close enough to OrigLU, to see whether it&#39;s</span></CodeLine>
<Link id="l02862" /><CodeLine lineNumber="2862"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// worthwhile looking through its formulae.</span></CodeLine>
<Link id="l02863" /><CodeLine lineNumber="2863"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Ignore ICmpZero uses because they may contain formulae generated by</span></CodeLine>
<Link id="l02864" /><CodeLine lineNumber="2864"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// GenerateICmpZeroScales, in which case adding fixup offsets may</span></CodeLine>
<Link id="l02865" /><CodeLine lineNumber="2865"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// be invalid.</span></CodeLine>
<Link id="l02866" /><CodeLine lineNumber="2866"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&amp;LU != &amp;OrigLU &amp;&amp;</span></CodeLine>
<Link id="l02867" /><CodeLine lineNumber="2867"><span class="doxyHighlight">        LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> &amp;&amp;</span></CodeLine>
<Link id="l02868" /><CodeLine lineNumber="2868"><span class="doxyHighlight">        LU.Kind == OrigLU.Kind &amp;&amp; OrigLU.AccessTy == LU.AccessTy &amp;&amp;</span></CodeLine>
<Link id="l02869" /><CodeLine lineNumber="2869"><span class="doxyHighlight">        LU.WidestFixupType == OrigLU.WidestFixupType &amp;&amp;</span></CodeLine>
<Link id="l02870" /><CodeLine lineNumber="2870"><span class="doxyHighlight">        LU.HasFormulaWithSameRegs(OrigF)) &#123;</span></CodeLine>
<Link id="l02871" /><CodeLine lineNumber="2871"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Scan through this use&#39;s formulae.</span></CodeLine>
<Link id="l02872" /><CodeLine lineNumber="2872"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae) &#123;</span></CodeLine>
<Link id="l02873" /><CodeLine lineNumber="2873"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Check to see if this formula has the same registers and symbols</span></CodeLine>
<Link id="l02874" /><CodeLine lineNumber="2874"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// as OrigF.</span></CodeLine>
<Link id="l02875" /><CodeLine lineNumber="2875"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs == OrigF.BaseRegs &amp;&amp;</span></CodeLine>
<Link id="l02876" /><CodeLine lineNumber="2876"><span class="doxyHighlight">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg == OrigF.ScaledReg &amp;&amp;</span></CodeLine>
<Link id="l02877" /><CodeLine lineNumber="2877"><span class="doxyHighlight">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV == OrigF.BaseGV &amp;&amp;</span></CodeLine>
<Link id="l02878" /><CodeLine lineNumber="2878"><span class="doxyHighlight">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == OrigF.Scale &amp;&amp;</span></CodeLine>
<Link id="l02879" /><CodeLine lineNumber="2879"><span class="doxyHighlight">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset == OrigF.UnfoldedOffset) &#123;</span></CodeLine>
<Link id="l02880" /><CodeLine lineNumber="2880"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isZero())</span></CodeLine>
<Link id="l02881" /><CodeLine lineNumber="2881"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &amp;LU;</span></CodeLine>
<Link id="l02882" /><CodeLine lineNumber="2882"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// This is the formula where all the registers and symbols matched;</span></CodeLine>
<Link id="l02883" /><CodeLine lineNumber="2883"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// there aren&#39;t going to be any others. Since we declined it, we</span></CodeLine>
<Link id="l02884" /><CodeLine lineNumber="2884"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// can skip the rest of the formulae and proceed to the next LSRUse.</span></CodeLine>
<Link id="l02885" /><CodeLine lineNumber="2885"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02886" /><CodeLine lineNumber="2886"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02887" /><CodeLine lineNumber="2887"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02888" /><CodeLine lineNumber="2888"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02889" /><CodeLine lineNumber="2889"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02890" /><CodeLine lineNumber="2890"></CodeLine>
<Link id="l02891" /><CodeLine lineNumber="2891"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Nothing looked good.</span></CodeLine>
<Link id="l02892" /><CodeLine lineNumber="2892"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02893" /><CodeLine lineNumber="2893"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02894" /><CodeLine lineNumber="2894"></CodeLine>
<Link id="l02895" /><CodeLine lineNumber="2895"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::CollectInterestingTypesAndFactors() &#123;</span></CodeLine>
<Link id="l02896" /><CodeLine lineNumber="2896"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector&lt;const SCEV &#42;, 4&gt;</a> Strides;</span></CodeLine>
<Link id="l02897" /><CodeLine lineNumber="2897"></CodeLine>
<Link id="l02898" /><CodeLine lineNumber="2898"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Collect interesting types and strides.</span></CodeLine>
<Link id="l02899" /><CodeLine lineNumber="2899"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> Worklist;</span></CodeLine>
<Link id="l02900" /><CodeLine lineNumber="2900"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;U : IU) &#123;</span></CodeLine>
<Link id="l02901" /><CodeLine lineNumber="2901"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Expr = IU.getExpr(U);</span></CodeLine>
<Link id="l02902" /><CodeLine lineNumber="2902"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Expr)</span></CodeLine>
<Link id="l02903" /><CodeLine lineNumber="2903"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02904" /><CodeLine lineNumber="2904"></CodeLine>
<Link id="l02905" /><CodeLine lineNumber="2905"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Collect interesting types.</span></CodeLine>
<Link id="l02906" /><CodeLine lineNumber="2906"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/logicalview/#a90c9f20715929cbe06c523bf8546c38baf2d346b1bb7c1c85ab6f7f21e3666b9f">Types</a>.insert(SE.getEffectiveSCEVType(Expr-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()));</span></CodeLine>
<Link id="l02907" /><CodeLine lineNumber="2907"></CodeLine>
<Link id="l02908" /><CodeLine lineNumber="2908"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Add strides for mentioned loops.</span></CodeLine>
<Link id="l02909" /><CodeLine lineNumber="2909"><span class="doxyHighlight">    Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Expr);</span></CodeLine>
<Link id="l02910" /><CodeLine lineNumber="2910"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">do</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02911" /><CodeLine lineNumber="2911"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = Worklist.<a href="/docs/api/classes/llvm/smallvectorimpl/#a0c8ffe664a36e30d49c84d0aded2fe08">pop&#95;back&#95;val</a>();</span></CodeLine>
<Link id="l02912" /><CodeLine lineNumber="2912"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l02913" /><CodeLine lineNumber="2913"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L)</span></CodeLine>
<Link id="l02914" /><CodeLine lineNumber="2914"><span class="doxyHighlight">          Strides.<a href="/docs/api/classes/llvm/setvector/#af34eb71cc483e84d2eca80575cb9ccde">insert</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE));</span></CodeLine>
<Link id="l02915" /><CodeLine lineNumber="2915"><span class="doxyHighlight">        Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>());</span></CodeLine>
<Link id="l02916" /><CodeLine lineNumber="2916"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l02917" /><CodeLine lineNumber="2917"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a39d3d23a084c4544ee5903203db10e8a">append&#95;range</a>(Worklist, <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands());</span></CodeLine>
<Link id="l02918" /><CodeLine lineNumber="2918"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02919" /><CodeLine lineNumber="2919"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>());</span></CodeLine>
<Link id="l02920" /><CodeLine lineNumber="2920"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02921" /><CodeLine lineNumber="2921"></CodeLine>
<Link id="l02922" /><CodeLine lineNumber="2922"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Compute interesting factors from the set of interesting strides.</span></CodeLine>
<Link id="l02923" /><CodeLine lineNumber="2923"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/setvector/#a954de16c021e57fb3c8e8143bdb428ca">SmallSetVector&lt;const SCEV &#42;, 4&gt;::const&#95;iterator</a></span></CodeLine>
<Link id="l02924" /><CodeLine lineNumber="2924"><span class="doxyHighlight">       <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = Strides.<a href="/docs/api/classes/llvm/setvector/#ad0bf95396cec46a41371341460d14a1c">begin</a>(), <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = Strides.<a href="/docs/api/classes/llvm/setvector/#a889cc0df630d4b01e12d359517e26670">end</a>(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)</span></CodeLine>
<Link id="l02925" /><CodeLine lineNumber="2925"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/setvector/#a954de16c021e57fb3c8e8143bdb428ca">SmallSetVector&lt;const SCEV &#42;, 4&gt;::const&#95;iterator</a> NewStrideIter =</span></CodeLine>
<Link id="l02926" /><CodeLine lineNumber="2926"><span class="doxyHighlight">         std::next(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>); NewStrideIter != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++NewStrideIter) &#123;</span></CodeLine>
<Link id="l02927" /><CodeLine lineNumber="2927"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OldStride = &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</span></CodeLine>
<Link id="l02928" /><CodeLine lineNumber="2928"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewStride = &#42;NewStrideIter;</span></CodeLine>
<Link id="l02929" /><CodeLine lineNumber="2929"></CodeLine>
<Link id="l02930" /><CodeLine lineNumber="2930"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getTypeSizeInBits(OldStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()) !=</span></CodeLine>
<Link id="l02931" /><CodeLine lineNumber="2931"><span class="doxyHighlight">          SE.getTypeSizeInBits(NewStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>())) &#123;</span></CodeLine>
<Link id="l02932" /><CodeLine lineNumber="2932"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getTypeSizeInBits(OldStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()) &gt;</span></CodeLine>
<Link id="l02933" /><CodeLine lineNumber="2933"><span class="doxyHighlight">            SE.getTypeSizeInBits(NewStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()))</span></CodeLine>
<Link id="l02934" /><CodeLine lineNumber="2934"><span class="doxyHighlight">          NewStride = SE.getSignExtendExpr(NewStride, OldStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>());</span></CodeLine>
<Link id="l02935" /><CodeLine lineNumber="2935"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l02936" /><CodeLine lineNumber="2936"><span class="doxyHighlight">          OldStride = SE.getSignExtendExpr(OldStride, NewStride-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>());</span></CodeLine>
<Link id="l02937" /><CodeLine lineNumber="2937"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02938" /><CodeLine lineNumber="2938"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;Factor =</span></CodeLine>
<Link id="l02939" /><CodeLine lineNumber="2939"><span class="doxyHighlight">            <a href="/docs/api/namespaces/llvm/#a5f6182886dc2f96c204299e92c1565d5">dyn&#95;cast&#95;or&#95;null&lt;SCEVConstant&gt;</a>(<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(NewStride, OldStride,</span></CodeLine>
<Link id="l02940" /><CodeLine lineNumber="2940"><span class="doxyHighlight">                                                        SE, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">))) &#123;</span></CodeLine>
<Link id="l02941" /><CodeLine lineNumber="2941"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Factor-&gt;getAPInt().getSignificantBits() &lt;= 64 &amp;&amp; !Factor-&gt;isZero())</span></CodeLine>
<Link id="l02942" /><CodeLine lineNumber="2942"><span class="doxyHighlight">          Factors.insert(Factor-&gt;getAPInt().getSExtValue());</span></CodeLine>
<Link id="l02943" /><CodeLine lineNumber="2943"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;Factor =</span></CodeLine>
<Link id="l02944" /><CodeLine lineNumber="2944"><span class="doxyHighlight">                   <a href="/docs/api/namespaces/llvm/#a5f6182886dc2f96c204299e92c1565d5">dyn&#95;cast&#95;or&#95;null&lt;SCEVConstant&gt;</a>(<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(OldStride,</span></CodeLine>
<Link id="l02945" /><CodeLine lineNumber="2945"><span class="doxyHighlight">                                                               NewStride,</span></CodeLine>
<Link id="l02946" /><CodeLine lineNumber="2946"><span class="doxyHighlight">                                                               SE, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">))) &#123;</span></CodeLine>
<Link id="l02947" /><CodeLine lineNumber="2947"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Factor-&gt;getAPInt().getSignificantBits() &lt;= 64 &amp;&amp; !Factor-&gt;isZero())</span></CodeLine>
<Link id="l02948" /><CodeLine lineNumber="2948"><span class="doxyHighlight">          Factors.insert(Factor-&gt;getAPInt().getSExtValue());</span></CodeLine>
<Link id="l02949" /><CodeLine lineNumber="2949"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02950" /><CodeLine lineNumber="2950"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02951" /><CodeLine lineNumber="2951"></CodeLine>
<Link id="l02952" /><CodeLine lineNumber="2952"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If all uses use the same type, don&#39;t bother looking for truncation-based</span></CodeLine>
<Link id="l02953" /><CodeLine lineNumber="2953"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// reuse.</span></CodeLine>
<Link id="l02954" /><CodeLine lineNumber="2954"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/logicalview/#a90c9f20715929cbe06c523bf8546c38baf2d346b1bb7c1c85ab6f7f21e3666b9f">Types</a>.size() == 1)</span></CodeLine>
<Link id="l02955" /><CodeLine lineNumber="2955"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/logicalview/#a90c9f20715929cbe06c523bf8546c38baf2d346b1bb7c1c85ab6f7f21e3666b9f">Types</a>.clear();</span></CodeLine>
<Link id="l02956" /><CodeLine lineNumber="2956"></CodeLine>
<Link id="l02957" /><CodeLine lineNumber="2957"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(print&#95;factors&#95;and&#95;types(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l02958" /><CodeLine lineNumber="2958"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02959" /><CodeLine lineNumber="2959"></CodeLine>
<Link id="l02960" /><CodeLine lineNumber="2960"><span class="doxyHighlightComment">/// Helper for CollectChains that finds an IV operand (computed by an AddRec in</span></CodeLine>
<Link id="l02961" /><CodeLine lineNumber="2961"><span class="doxyHighlightComment">/// this loop) within &#91;OI,OE) or returns OE. If IVUsers mapped Instructions to</span></CodeLine>
<Link id="l02962" /><CodeLine lineNumber="2962"><span class="doxyHighlightComment">/// IVStrideUses, we could partially skip this.</span></CodeLine>
<Link id="l02963" /><CodeLine lineNumber="2963"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a></span></CodeLine>
<Link id="l02964" /><CodeLine lineNumber="2964" lineLink="#a262aeb2eecfb752ae2eecb90bab7ec8a"><span class="doxyHighlight"><a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(<a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> OI, <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> OE,</span></CodeLine>
<Link id="l02965" /><CodeLine lineNumber="2965"><span class="doxyHighlight">              <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l02966" /><CodeLine lineNumber="2966"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight">(; OI != OE; ++OI) &#123;</span></CodeLine>
<Link id="l02967" /><CodeLine lineNumber="2967"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Oper = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(&#42;OI)) &#123;</span></CodeLine>
<Link id="l02968" /><CodeLine lineNumber="2968"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(Oper-&gt;getType()))</span></CodeLine>
<Link id="l02969" /><CodeLine lineNumber="2969"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02970" /><CodeLine lineNumber="2970"></CodeLine>
<Link id="l02971" /><CodeLine lineNumber="2971"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR =</span></CodeLine>
<Link id="l02972" /><CodeLine lineNumber="2972"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Oper))) &#123;</span></CodeLine>
<Link id="l02973" /><CodeLine lineNumber="2973"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L)</span></CodeLine>
<Link id="l02974" /><CodeLine lineNumber="2974"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02975" /><CodeLine lineNumber="2975"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02976" /><CodeLine lineNumber="2976"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02977" /><CodeLine lineNumber="2977"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02978" /><CodeLine lineNumber="2978"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> OI;</span></CodeLine>
<Link id="l02979" /><CodeLine lineNumber="2979"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02980" /><CodeLine lineNumber="2980"></CodeLine>
<Link id="l02981" /><CodeLine lineNumber="2981"><span class="doxyHighlightComment">/// IVChain logic must consistently peek base TruncInst operands, so wrap it in</span></CodeLine>
<Link id="l02982" /><CodeLine lineNumber="2982"><span class="doxyHighlightComment">/// a convenient helper.</span></CodeLine>
<Link id="l02983" /><CodeLine lineNumber="2983" lineLink="#a0ef5c4bf982afaa71a03555b138aba58"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(<a href="/docs/api/classes/llvm/value">Value</a> &#42;Oper) &#123;</span></CodeLine>
<Link id="l02984" /><CodeLine lineNumber="2984"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/truncinst">TruncInst</a> &#42;Trunc = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;TruncInst&gt;</a>(Oper))</span></CodeLine>
<Link id="l02985" /><CodeLine lineNumber="2985"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Trunc-&gt;getOperand(0);</span></CodeLine>
<Link id="l02986" /><CodeLine lineNumber="2986"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Oper;</span></CodeLine>
<Link id="l02987" /><CodeLine lineNumber="2987"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02988" /><CodeLine lineNumber="2988"></CodeLine>
<Link id="l02989" /><CodeLine lineNumber="2989"><span class="doxyHighlightComment">/// Return an approximation of this SCEV expression&#39;s &quot;base&quot;, or NULL for any</span></CodeLine>
<Link id="l02990" /><CodeLine lineNumber="2990"><span class="doxyHighlightComment">/// constant. Returning the expression itself is conservative. Returning a</span></CodeLine>
<Link id="l02991" /><CodeLine lineNumber="2991"><span class="doxyHighlightComment">/// deeper subexpression is more precise and valid as long as it isn&#39;t less</span></CodeLine>
<Link id="l02992" /><CodeLine lineNumber="2992"><span class="doxyHighlightComment">/// complex than another subexpression. For expressions involving multiple</span></CodeLine>
<Link id="l02993" /><CodeLine lineNumber="2993"><span class="doxyHighlightComment">/// unscaled values, we need to return the pointer-type SCEVUnknown. This avoids</span></CodeLine>
<Link id="l02994" /><CodeLine lineNumber="2994"><span class="doxyHighlightComment">/// forming chains across objects, such as: PrevOper==a&#91;i&#93;, IVOper==b&#91;i&#93;,</span></CodeLine>
<Link id="l02995" /><CodeLine lineNumber="2995"><span class="doxyHighlightComment">/// IVInc==b-a.</span></CodeLine>
<Link id="l02996" /><CodeLine lineNumber="2996"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l02997" /><CodeLine lineNumber="2997"><span class="doxyHighlightComment">/// Since SCEVUnknown is the rightmost type, and pointers are the rightmost</span></CodeLine>
<Link id="l02998" /><CodeLine lineNumber="2998"><span class="doxyHighlightComment">/// SCEVUnknown, we simply return the rightmost SCEV operand.</span></CodeLine>
<Link id="l02999" /><CodeLine lineNumber="2999" lineLink="#a60008b3cbf2b4ef3e3d14af04beb6a06"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</span></CodeLine>
<Link id="l03000" /><CodeLine lineNumber="3000"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (S-&gt;<a href="/docs/api/classes/llvm/scev/#ad4f956914bf94bdcd1058badb5bd90e6">getSCEVType</a>()) &#123;</span></CodeLine>
<Link id="l03001" /><CodeLine lineNumber="3001"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">: </span><span class="doxyHighlightComment">// including scUnknown.</span></CodeLine>
<Link id="l03002" /><CodeLine lineNumber="3002"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> S;</span></CodeLine>
<Link id="l03003" /><CodeLine lineNumber="3003"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eabcb1f797cb330e61a5879fc260aaec5b">scConstant</a>:</span></CodeLine>
<Link id="l03004" /><CodeLine lineNumber="3004"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea61df12d6bb21842a8f766c4433c85717">scVScale</a>:</span></CodeLine>
<Link id="l03005" /><CodeLine lineNumber="3005"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03006" /><CodeLine lineNumber="3006"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ead3656bcc84af213cc488acb56c60de22">scTruncate</a>:</span></CodeLine>
<Link id="l03007" /><CodeLine lineNumber="3007"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVTruncateExpr&gt;</a>(S)-&gt;getOperand());</span></CodeLine>
<Link id="l03008" /><CodeLine lineNumber="3008"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eadd4a8d5cb0d78c9be22d01e1546bafc6">scZeroExtend</a>:</span></CodeLine>
<Link id="l03009" /><CodeLine lineNumber="3009"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVZeroExtendExpr&gt;</a>(S)-&gt;getOperand());</span></CodeLine>
<Link id="l03010" /><CodeLine lineNumber="3010"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ead05711646a19cb20775cfbc8ef0a8c09">scSignExtend</a>:</span></CodeLine>
<Link id="l03011" /><CodeLine lineNumber="3011"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVSignExtendExpr&gt;</a>(S)-&gt;getOperand());</span></CodeLine>
<Link id="l03012" /><CodeLine lineNumber="3012"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea3a80b1a7dda48464be1849ee1fb85868">scAddExpr</a>: &#123;</span></CodeLine>
<Link id="l03013" /><CodeLine lineNumber="3013"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Skip over scaled operands (scMulExpr) to follow add operands as long as</span></CodeLine>
<Link id="l03014" /><CodeLine lineNumber="3014"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// there&#39;s nothing more complex.</span></CodeLine>
<Link id="l03015" /><CodeLine lineNumber="3015"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// FIXME: not sure if we want to recognize negation.</span></CodeLine>
<Link id="l03016" /><CodeLine lineNumber="3016"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddExpr&gt;</a>(S);</span></CodeLine>
<Link id="l03017" /><CodeLine lineNumber="3017"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;SubExpr : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands())) &#123;</span></CodeLine>
<Link id="l03018" /><CodeLine lineNumber="3018"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubExpr-&gt;getSCEVType() == <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea3a80b1a7dda48464be1849ee1fb85868">scAddExpr</a>)</span></CodeLine>
<Link id="l03019" /><CodeLine lineNumber="3019"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(SubExpr);</span></CodeLine>
<Link id="l03020" /><CodeLine lineNumber="3020"></CodeLine>
<Link id="l03021" /><CodeLine lineNumber="3021"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubExpr-&gt;getSCEVType() != <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5eafd56f054da3d1f9b827ae1003da3a38b">scMulExpr</a>)</span></CodeLine>
<Link id="l03022" /><CodeLine lineNumber="3022"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SubExpr;</span></CodeLine>
<Link id="l03023" /><CodeLine lineNumber="3023"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03024" /><CodeLine lineNumber="3024"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> S; </span><span class="doxyHighlightComment">// all operands are scaled, be conservative.</span></CodeLine>
<Link id="l03025" /><CodeLine lineNumber="3025"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03026" /><CodeLine lineNumber="3026"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad409632178dd00316abd4c35d3e14b5ea222c9c7b5d5e742d5d1238a3256b1ea5">scAddRecExpr</a>:</span></CodeLine>
<Link id="l03027" /><CodeLine lineNumber="3027"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(S)-&gt;getStart());</span></CodeLine>
<Link id="l03028" /><CodeLine lineNumber="3028"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03029" /><CodeLine lineNumber="3029"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</span><span class="doxyHighlightStringLiteral">&quot;Unknown SCEV kind!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03030" /><CodeLine lineNumber="3030"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03031" /><CodeLine lineNumber="3031"></CodeLine>
<Link id="l03032" /><CodeLine lineNumber="3032"><span class="doxyHighlightComment">/// Return true if the chain increment is profitable to expand into a loop</span></CodeLine>
<Link id="l03033" /><CodeLine lineNumber="3033"><span class="doxyHighlightComment">/// invariant value, which may require its own register. A profitable chain</span></CodeLine>
<Link id="l03034" /><CodeLine lineNumber="3034"><span class="doxyHighlightComment">/// increment will be an offset relative to the same base. We allow such offsets</span></CodeLine>
<Link id="l03035" /><CodeLine lineNumber="3035"><span class="doxyHighlightComment">/// to potentially be used as chain increment as long as it&#39;s not obviously</span></CodeLine>
<Link id="l03036" /><CodeLine lineNumber="3036"><span class="doxyHighlightComment">/// expensive to expand using real instructions.</span></CodeLine>
<Link id="l03037" /><CodeLine lineNumber="3037" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#ade9271834ae6b0312cf662fe231a75c4"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#ade9271834ae6b0312cf662fe231a75c4">IVChain::isProfitableIncrement</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OperExpr,</span></CodeLine>
<Link id="l03038" /><CodeLine lineNumber="3038"><span class="doxyHighlight">                                    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr,</span></CodeLine>
<Link id="l03039" /><CodeLine lineNumber="3039"><span class="doxyHighlight">                                    <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l03040" /><CodeLine lineNumber="3040"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Aggressively form chains when -stress-ivchain.</span></CodeLine>
<Link id="l03041" /><CodeLine lineNumber="3041"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>)</span></CodeLine>
<Link id="l03042" /><CodeLine lineNumber="3042"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03043" /><CodeLine lineNumber="3043"></CodeLine>
<Link id="l03044" /><CodeLine lineNumber="3044"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Do not replace a constant offset from IV head with a nonconstant IV</span></CodeLine>
<Link id="l03045" /><CodeLine lineNumber="3045"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// increment.</span></CodeLine>
<Link id="l03046" /><CodeLine lineNumber="3046"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(IncExpr)) &#123;</span></CodeLine>
<Link id="l03047" /><CodeLine lineNumber="3047"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;HeadExpr = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a786dbc082f07587eed95f354b4556cec">Incs</a>&#91;0&#93;.IVOperand));</span></CodeLine>
<Link id="l03048" /><CodeLine lineNumber="3048"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a8bcb86d8d126d95b0dc05f09e8f3df96">getMinusSCEV</a>(OperExpr, HeadExpr)))</span></CodeLine>
<Link id="l03049" /><CodeLine lineNumber="3049"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03050" /><CodeLine lineNumber="3050"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03051" /><CodeLine lineNumber="3051"></CodeLine>
<Link id="l03052" /><CodeLine lineNumber="3052"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV&#42;, 8&gt;</a> Processed;</span></CodeLine>
<Link id="l03053" /><CodeLine lineNumber="3053"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !<a href="#a7ac21134b2aaca2a7d55f6ff9d92f5b2">isHighCostExpansion</a>(IncExpr, Processed, SE);</span></CodeLine>
<Link id="l03054" /><CodeLine lineNumber="3054"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03055" /><CodeLine lineNumber="3055"></CodeLine>
<Link id="l03056" /><CodeLine lineNumber="3056"><span class="doxyHighlightComment">/// Return true if the number of registers needed for the chain is estimated to</span></CodeLine>
<Link id="l03057" /><CodeLine lineNumber="3057"><span class="doxyHighlightComment">/// be less than the number required for the individual IV users. First prohibit</span></CodeLine>
<Link id="l03058" /><CodeLine lineNumber="3058"><span class="doxyHighlightComment">/// any IV users that keep the IV live across increments (the Users set should</span></CodeLine>
<Link id="l03059" /><CodeLine lineNumber="3059"><span class="doxyHighlightComment">/// be empty). Next count the number and type of increments in the chain.</span></CodeLine>
<Link id="l03060" /><CodeLine lineNumber="3060"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03061" /><CodeLine lineNumber="3061"><span class="doxyHighlightComment">/// Chaining IVs can lead to considerable code bloat if ISEL doesn&#39;t</span></CodeLine>
<Link id="l03062" /><CodeLine lineNumber="3062"><span class="doxyHighlightComment">/// effectively use postinc addressing modes. Only consider it profitable it the</span></CodeLine>
<Link id="l03063" /><CodeLine lineNumber="3063"><span class="doxyHighlightComment">/// increments can be computed in fewer registers when chained.</span></CodeLine>
<Link id="l03064" /><CodeLine lineNumber="3064"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03065" /><CodeLine lineNumber="3065"><span class="doxyHighlightComment">/// TODO: Consider IVInc free if it&#39;s already used in another chains.</span></CodeLine>
<Link id="l03066" /><CodeLine lineNumber="3066" lineLink="#aca012302770ad32503de5e2c62344290"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aca012302770ad32503de5e2c62344290">isProfitableChain</a>(IVChain &amp;Chain,</span></CodeLine>
<Link id="l03067" /><CodeLine lineNumber="3067"><span class="doxyHighlight">                              <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;Instruction &#42;&gt;</a> &amp;<a href="/docs/api/files/lib/lib/analysis/ivusers-cpp/#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>,</span></CodeLine>
<Link id="l03068" /><CodeLine lineNumber="3068"><span class="doxyHighlight">                              <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</span></CodeLine>
<Link id="l03069" /><CodeLine lineNumber="3069"><span class="doxyHighlight">                              </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>) &#123;</span></CodeLine>
<Link id="l03070" /><CodeLine lineNumber="3070"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>)</span></CodeLine>
<Link id="l03071" /><CodeLine lineNumber="3071"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03072" /><CodeLine lineNumber="3072"></CodeLine>
<Link id="l03073" /><CodeLine lineNumber="3073"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Chain.hasIncs())</span></CodeLine>
<Link id="l03074" /><CodeLine lineNumber="3074"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03075" /><CodeLine lineNumber="3075"></CodeLine>
<Link id="l03076" /><CodeLine lineNumber="3076"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/analysis/ivusers-cpp/#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>.empty()) &#123;</span></CodeLine>
<Link id="l03077" /><CodeLine lineNumber="3077"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Chain: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;Chain.Incs&#91;0&#93;.UserInst &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; users:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03078" /><CodeLine lineNumber="3078"><span class="doxyHighlight">               <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a4cfc8b177e8521a4b496ae2edff6244f">for</a> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst</span></CodeLine>
<Link id="l03079" /><CodeLine lineNumber="3079"><span class="doxyHighlight">                    : <a href="/docs/api/files/lib/lib/analysis/ivusers-cpp/#a4e5b9edb51eec9dbca592075eb64dfcb">Users</a>) &#123; <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;Inst &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">; &#125;);</span></CodeLine>
<Link id="l03080" /><CodeLine lineNumber="3080"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03081" /><CodeLine lineNumber="3081"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03082" /><CodeLine lineNumber="3082"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Chain.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;empty IV chains are not allowed&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03083" /><CodeLine lineNumber="3083"></CodeLine>
<Link id="l03084" /><CodeLine lineNumber="3084"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The chain itself may require a register, so intialize cost to 1</span></CodeLine>
<Link id="l03085" /><CodeLine lineNumber="3085"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> cost = 1;</span></CodeLine>
<Link id="l03086" /><CodeLine lineNumber="3086"></CodeLine>
<Link id="l03087" /><CodeLine lineNumber="3087"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// A complete chain likely eliminates the need for keeping the original IV in</span></CodeLine>
<Link id="l03088" /><CodeLine lineNumber="3088"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// a register. LSR does not currently know how to form a complete chain unless</span></CodeLine>
<Link id="l03089" /><CodeLine lineNumber="3089"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the header phi already exists.</span></CodeLine>
<Link id="l03090" /><CodeLine lineNumber="3090"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(Chain.tailUserInst())</span></CodeLine>
<Link id="l03091" /><CodeLine lineNumber="3091"><span class="doxyHighlight">      &amp;&amp; SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(Chain.tailUserInst()) == Chain.Incs&#91;0&#93;.IncExpr) &#123;</span></CodeLine>
<Link id="l03092" /><CodeLine lineNumber="3092"><span class="doxyHighlight">    --cost;</span></CodeLine>
<Link id="l03093" /><CodeLine lineNumber="3093"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03094" /><CodeLine lineNumber="3094"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LastIncExpr = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03095" /><CodeLine lineNumber="3095"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumConstIncrements = 0;</span></CodeLine>
<Link id="l03096" /><CodeLine lineNumber="3096"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumVarIncrements = 0;</span></CodeLine>
<Link id="l03097" /><CodeLine lineNumber="3097"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumReusedIncrements = 0;</span></CodeLine>
<Link id="l03098" /><CodeLine lineNumber="3098"></CodeLine>
<Link id="l03099" /><CodeLine lineNumber="3099"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isProfitableLSRChainElement(Chain.Incs&#91;0&#93;.UserInst))</span></CodeLine>
<Link id="l03100" /><CodeLine lineNumber="3100"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03101" /><CodeLine lineNumber="3101"></CodeLine>
<Link id="l03102" /><CodeLine lineNumber="3102"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> IVInc &amp;Inc : Chain) &#123;</span></CodeLine>
<Link id="l03103" /><CodeLine lineNumber="3103"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isProfitableLSRChainElement(Inc.UserInst))</span></CodeLine>
<Link id="l03104" /><CodeLine lineNumber="3104"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03105" /><CodeLine lineNumber="3105"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Inc.IncExpr-&gt;isZero())</span></CodeLine>
<Link id="l03106" /><CodeLine lineNumber="3106"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03107" /><CodeLine lineNumber="3107"></CodeLine>
<Link id="l03108" /><CodeLine lineNumber="3108"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Incrementing by zero or some constant is neutral. We assume constants can</span></CodeLine>
<Link id="l03109" /><CodeLine lineNumber="3109"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// be folded into an addressing mode or an add&#39;s immediate operand.</span></CodeLine>
<Link id="l03110" /><CodeLine lineNumber="3110"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(Inc.IncExpr)) &#123;</span></CodeLine>
<Link id="l03111" /><CodeLine lineNumber="3111"><span class="doxyHighlight">      ++NumConstIncrements;</span></CodeLine>
<Link id="l03112" /><CodeLine lineNumber="3112"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03113" /><CodeLine lineNumber="3113"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03114" /><CodeLine lineNumber="3114"></CodeLine>
<Link id="l03115" /><CodeLine lineNumber="3115"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Inc.IncExpr == LastIncExpr)</span></CodeLine>
<Link id="l03116" /><CodeLine lineNumber="3116"><span class="doxyHighlight">      ++NumReusedIncrements;</span></CodeLine>
<Link id="l03117" /><CodeLine lineNumber="3117"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l03118" /><CodeLine lineNumber="3118"><span class="doxyHighlight">      ++NumVarIncrements;</span></CodeLine>
<Link id="l03119" /><CodeLine lineNumber="3119"></CodeLine>
<Link id="l03120" /><CodeLine lineNumber="3120"><span class="doxyHighlight">    LastIncExpr = Inc.IncExpr;</span></CodeLine>
<Link id="l03121" /><CodeLine lineNumber="3121"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03122" /><CodeLine lineNumber="3122"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// An IV chain with a single increment is handled by LSR&#39;s postinc</span></CodeLine>
<Link id="l03123" /><CodeLine lineNumber="3123"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// uses. However, a chain with multiple increments requires keeping the IV&#39;s</span></CodeLine>
<Link id="l03124" /><CodeLine lineNumber="3124"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value live longer than it needs to be if chained.</span></CodeLine>
<Link id="l03125" /><CodeLine lineNumber="3125"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NumConstIncrements &gt; 1)</span></CodeLine>
<Link id="l03126" /><CodeLine lineNumber="3126"><span class="doxyHighlight">    --cost;</span></CodeLine>
<Link id="l03127" /><CodeLine lineNumber="3127"></CodeLine>
<Link id="l03128" /><CodeLine lineNumber="3128"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Materializing increment expressions in the preheader that didn&#39;t exist in</span></CodeLine>
<Link id="l03129" /><CodeLine lineNumber="3129"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the original code may cost a register. For example, sign-extended array</span></CodeLine>
<Link id="l03130" /><CodeLine lineNumber="3130"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// indices can produce ridiculous increments like this:</span></CodeLine>
<Link id="l03131" /><CodeLine lineNumber="3131"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// IV + ((sext i32 (2 &#42; %s) to i64) + (-1 &#42; (sext i32 %s to i64)))</span></CodeLine>
<Link id="l03132" /><CodeLine lineNumber="3132"><span class="doxyHighlight">  cost += NumVarIncrements;</span></CodeLine>
<Link id="l03133" /><CodeLine lineNumber="3133"></CodeLine>
<Link id="l03134" /><CodeLine lineNumber="3134"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Reusing variable increments likely saves a register to hold the multiple of</span></CodeLine>
<Link id="l03135" /><CodeLine lineNumber="3135"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the stride.</span></CodeLine>
<Link id="l03136" /><CodeLine lineNumber="3136"><span class="doxyHighlight">  cost -= NumReusedIncrements;</span></CodeLine>
<Link id="l03137" /><CodeLine lineNumber="3137"></CodeLine>
<Link id="l03138" /><CodeLine lineNumber="3138"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Chain: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;Chain.Incs&#91;0&#93;.UserInst &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; Cost: &quot;</span><span class="doxyHighlight"> &lt;&lt; cost</span></CodeLine>
<Link id="l03139" /><CodeLine lineNumber="3139"><span class="doxyHighlight">                    &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03140" /><CodeLine lineNumber="3140"></CodeLine>
<Link id="l03141" /><CodeLine lineNumber="3141"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> cost &lt; 0;</span></CodeLine>
<Link id="l03142" /><CodeLine lineNumber="3142"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03143" /><CodeLine lineNumber="3143"></CodeLine>
<Link id="l03144" /><CodeLine lineNumber="3144"><span class="doxyHighlightComment">/// Add this IV user to an existing chain or make it the head of a new chain.</span></CodeLine>
<Link id="l03145" /><CodeLine lineNumber="3145"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::ChainInstruction(<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVOper,</span></CodeLine>
<Link id="l03146" /><CodeLine lineNumber="3146"><span class="doxyHighlight">                                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;ChainUsers&gt;</a> &amp;ChainUsersVec) &#123;</span></CodeLine>
<Link id="l03147" /><CodeLine lineNumber="3147"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// When IVs are used as types of varying widths, they are generally converted</span></CodeLine>
<Link id="l03148" /><CodeLine lineNumber="3148"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to a wider type with some uses remaining narrow under a (free) trunc.</span></CodeLine>
<Link id="l03149" /><CodeLine lineNumber="3149"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> NextIV = <a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(IVOper);</span></CodeLine>
<Link id="l03150" /><CodeLine lineNumber="3150"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> OperExpr = SE.getSCEV(NextIV);</span></CodeLine>
<Link id="l03151" /><CodeLine lineNumber="3151"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> OperExprBase = <a href="#a60008b3cbf2b4ef3e3d14af04beb6a06">getExprBase</a>(OperExpr);</span></CodeLine>
<Link id="l03152" /><CodeLine lineNumber="3152"></CodeLine>
<Link id="l03153" /><CodeLine lineNumber="3153"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Visit all existing chains. Check if its IVOper can be computed as a</span></CodeLine>
<Link id="l03154" /><CodeLine lineNumber="3154"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// profitable loop invariant increment from the last link in the Chain.</span></CodeLine>
<Link id="l03155" /><CodeLine lineNumber="3155"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ChainIdx = 0, NChains = IVChainVec.size();</span></CodeLine>
<Link id="l03156" /><CodeLine lineNumber="3156"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LastIncExpr = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03157" /><CodeLine lineNumber="3157"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (; ChainIdx &lt; NChains; ++ChainIdx) &#123;</span></CodeLine>
<Link id="l03158" /><CodeLine lineNumber="3158"><span class="doxyHighlight">    IVChain &amp;<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a> = IVChainVec&#91;ChainIdx&#93;;</span></CodeLine>
<Link id="l03159" /><CodeLine lineNumber="3159"></CodeLine>
<Link id="l03160" /><CodeLine lineNumber="3160"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Prune the solution space aggressively by checking that both IV operands</span></CodeLine>
<Link id="l03161" /><CodeLine lineNumber="3161"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// are expressions that operate on the same unscaled SCEVUnknown. This</span></CodeLine>
<Link id="l03162" /><CodeLine lineNumber="3162"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// &quot;base&quot; will be canceled by the subsequent getMinusSCEV call. Checking</span></CodeLine>
<Link id="l03163" /><CodeLine lineNumber="3163"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// first avoids creating extra SCEV expressions.</span></CodeLine>
<Link id="l03164" /><CodeLine lineNumber="3164"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a> &amp;&amp; <a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.ExprBase != OperExprBase)</span></CodeLine>
<Link id="l03165" /><CodeLine lineNumber="3165"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03166" /><CodeLine lineNumber="3166"></CodeLine>
<Link id="l03167" /><CodeLine lineNumber="3167"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;PrevIV = <a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>().IVOperand);</span></CodeLine>
<Link id="l03168" /><CodeLine lineNumber="3168"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PrevIV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != NextIV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())</span></CodeLine>
<Link id="l03169" /><CodeLine lineNumber="3169"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03170" /><CodeLine lineNumber="3170"></CodeLine>
<Link id="l03171" /><CodeLine lineNumber="3171"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// A phi node terminates a chain.</span></CodeLine>
<Link id="l03172" /><CodeLine lineNumber="3172"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(UserInst) &amp;&amp; <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.tailUserInst()))</span></CodeLine>
<Link id="l03173" /><CodeLine lineNumber="3173"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03174" /><CodeLine lineNumber="3174"></CodeLine>
<Link id="l03175" /><CodeLine lineNumber="3175"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The increment must be loop-invariant so it can be kept in a register.</span></CodeLine>
<Link id="l03176" /><CodeLine lineNumber="3176"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;PrevExpr = SE.getSCEV(PrevIV);</span></CodeLine>
<Link id="l03177" /><CodeLine lineNumber="3177"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr = SE.getMinusSCEV(OperExpr, PrevExpr);</span></CodeLine>
<Link id="l03178" /><CodeLine lineNumber="3178"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVCouldNotCompute&gt;</a>(IncExpr) || !SE.isLoopInvariant(IncExpr, L))</span></CodeLine>
<Link id="l03179" /><CodeLine lineNumber="3179"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03180" /><CodeLine lineNumber="3180"></CodeLine>
<Link id="l03181" /><CodeLine lineNumber="3181"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.isProfitableIncrement(OperExpr, IncExpr, SE)) &#123;</span></CodeLine>
<Link id="l03182" /><CodeLine lineNumber="3182"><span class="doxyHighlight">      LastIncExpr = IncExpr;</span></CodeLine>
<Link id="l03183" /><CodeLine lineNumber="3183"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03184" /><CodeLine lineNumber="3184"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03185" /><CodeLine lineNumber="3185"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03186" /><CodeLine lineNumber="3186"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we haven&#39;t found a chain, create a new one, unless we hit the max. Don&#39;t</span></CodeLine>
<Link id="l03187" /><CodeLine lineNumber="3187"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// bother for phi nodes, because they must be last in the chain.</span></CodeLine>
<Link id="l03188" /><CodeLine lineNumber="3188"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ChainIdx == NChains) &#123;</span></CodeLine>
<Link id="l03189" /><CodeLine lineNumber="3189"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(UserInst))</span></CodeLine>
<Link id="l03190" /><CodeLine lineNumber="3190"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03191" /><CodeLine lineNumber="3191"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NChains &gt;= MaxChains &amp;&amp; !<a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>) &#123;</span></CodeLine>
<Link id="l03192" /><CodeLine lineNumber="3192"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;IV Chain Limit\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03193" /><CodeLine lineNumber="3193"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03194" /><CodeLine lineNumber="3194"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03195" /><CodeLine lineNumber="3195"><span class="doxyHighlight">    LastIncExpr = OperExpr;</span></CodeLine>
<Link id="l03196" /><CodeLine lineNumber="3196"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// IVUsers may have skipped over sign/zero extensions. We don&#39;t currently</span></CodeLine>
<Link id="l03197" /><CodeLine lineNumber="3197"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// attempt to form chains involving extensions unless they can be hoisted</span></CodeLine>
<Link id="l03198" /><CodeLine lineNumber="3198"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// into this loop&#39;s AddRec.</span></CodeLine>
<Link id="l03199" /><CodeLine lineNumber="3199"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(LastIncExpr))</span></CodeLine>
<Link id="l03200" /><CodeLine lineNumber="3200"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03201" /><CodeLine lineNumber="3201"><span class="doxyHighlight">    ++NChains;</span></CodeLine>
<Link id="l03202" /><CodeLine lineNumber="3202"><span class="doxyHighlight">    IVChainVec.push&#95;back(IVChain(IVInc(UserInst, IVOper, LastIncExpr),</span></CodeLine>
<Link id="l03203" /><CodeLine lineNumber="3203"><span class="doxyHighlight">                                 OperExprBase));</span></CodeLine>
<Link id="l03204" /><CodeLine lineNumber="3204"><span class="doxyHighlight">    ChainUsersVec.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(NChains);</span></CodeLine>
<Link id="l03205" /><CodeLine lineNumber="3205"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;IV Chain#&quot;</span><span class="doxyHighlight"> &lt;&lt; ChainIdx &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; Head: (&quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;UserInst</span></CodeLine>
<Link id="l03206" /><CodeLine lineNumber="3206"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;) IV=&quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;LastIncExpr &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03207" /><CodeLine lineNumber="3207"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03208" /><CodeLine lineNumber="3208"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;IV Chain#&quot;</span><span class="doxyHighlight"> &lt;&lt; ChainIdx &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Inc: (&quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;UserInst</span></CodeLine>
<Link id="l03209" /><CodeLine lineNumber="3209"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;) IV+&quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;LastIncExpr &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03210" /><CodeLine lineNumber="3210"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Add this IV user to the end of the chain.</span></CodeLine>
<Link id="l03211" /><CodeLine lineNumber="3211"><span class="doxyHighlight">    IVChainVec&#91;ChainIdx&#93;.add(IVInc(UserInst, IVOper, LastIncExpr));</span></CodeLine>
<Link id="l03212" /><CodeLine lineNumber="3212"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03213" /><CodeLine lineNumber="3213"><span class="doxyHighlight">  IVChain &amp;<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a> = IVChainVec&#91;ChainIdx&#93;;</span></CodeLine>
<Link id="l03214" /><CodeLine lineNumber="3214"></CodeLine>
<Link id="l03215" /><CodeLine lineNumber="3215"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction&#42;,4&gt;</a> &amp;NearUsers = ChainUsersVec&#91;ChainIdx&#93;.NearUsers;</span></CodeLine>
<Link id="l03216" /><CodeLine lineNumber="3216"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This chain&#39;s NearUsers become FarUsers.</span></CodeLine>
<Link id="l03217" /><CodeLine lineNumber="3217"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LastIncExpr-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</span></CodeLine>
<Link id="l03218" /><CodeLine lineNumber="3218"><span class="doxyHighlight">    ChainUsersVec&#91;ChainIdx&#93;.FarUsers.<a href="/docs/api/classes/llvm/smallvectorimpl/#a94d23373106467003722f7d6c17b1528">insert</a>(NearUsers.<a href="/docs/api/classes/llvm/smallptrsetimpl/#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>(),</span></CodeLine>
<Link id="l03219" /><CodeLine lineNumber="3219"><span class="doxyHighlight">                                            NearUsers.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a7004354fbee1c8cd74ed9001915e1db5">end</a>());</span></CodeLine>
<Link id="l03220" /><CodeLine lineNumber="3220"><span class="doxyHighlight">    NearUsers.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</span></CodeLine>
<Link id="l03221" /><CodeLine lineNumber="3221"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03222" /><CodeLine lineNumber="3222"></CodeLine>
<Link id="l03223" /><CodeLine lineNumber="3223"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// All other uses of IVOperand become near uses of the chain.</span></CodeLine>
<Link id="l03224" /><CodeLine lineNumber="3224"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We currently ignore intermediate values within SCEV expressions, assuming</span></CodeLine>
<Link id="l03225" /><CodeLine lineNumber="3225"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// they will eventually be used be the current chain, or can be computed</span></CodeLine>
<Link id="l03226" /><CodeLine lineNumber="3226"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// from one of the chain increments. To be more precise we could</span></CodeLine>
<Link id="l03227" /><CodeLine lineNumber="3227"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// transitively follow its user and only add leaf IV users to the set.</span></CodeLine>
<Link id="l03228" /><CodeLine lineNumber="3228"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/user">User</a> &#42;U : IVOper-&gt;<a href="/docs/api/classes/llvm/value/#a411cf3e3932f209ce3374cb31adc1da6">users</a>()) &#123;</span></CodeLine>
<Link id="l03229" /><CodeLine lineNumber="3229"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;OtherUse = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(U);</span></CodeLine>
<Link id="l03230" /><CodeLine lineNumber="3230"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!OtherUse)</span></CodeLine>
<Link id="l03231" /><CodeLine lineNumber="3231"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03232" /><CodeLine lineNumber="3232"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Uses in the chain will no longer be uses if the chain is formed.</span></CodeLine>
<Link id="l03233" /><CodeLine lineNumber="3233"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Include the head of the chain in this iteration (not Chain.begin()).</span></CodeLine>
<Link id="l03234" /><CodeLine lineNumber="3234"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">IVChain::const&#95;iterator</a> IncIter = <a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>();</span></CodeLine>
<Link id="l03235" /><CodeLine lineNumber="3235"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/ivchain/#a3bc464eef5bdea273fe15d9bac7bf266">IVChain::const&#95;iterator</a> IncEnd = <a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>();</span></CodeLine>
<Link id="l03236" /><CodeLine lineNumber="3236"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight">( ; IncIter != IncEnd; ++IncIter) &#123;</span></CodeLine>
<Link id="l03237" /><CodeLine lineNumber="3237"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IncIter-&gt;UserInst == OtherUse)</span></CodeLine>
<Link id="l03238" /><CodeLine lineNumber="3238"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03239" /><CodeLine lineNumber="3239"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03240" /><CodeLine lineNumber="3240"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IncIter != IncEnd)</span></CodeLine>
<Link id="l03241" /><CodeLine lineNumber="3241"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03242" /><CodeLine lineNumber="3242"></CodeLine>
<Link id="l03243" /><CodeLine lineNumber="3243"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.isSCEVable(OtherUse-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())</span></CodeLine>
<Link id="l03244" /><CodeLine lineNumber="3244"><span class="doxyHighlight">        &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(SE.getSCEV(OtherUse))</span></CodeLine>
<Link id="l03245" /><CodeLine lineNumber="3245"><span class="doxyHighlight">        &amp;&amp; IU.isIVUserOrOperand(OtherUse)) &#123;</span></CodeLine>
<Link id="l03246" /><CodeLine lineNumber="3246"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03247" /><CodeLine lineNumber="3247"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03248" /><CodeLine lineNumber="3248"><span class="doxyHighlight">    NearUsers.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(OtherUse);</span></CodeLine>
<Link id="l03249" /><CodeLine lineNumber="3249"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03250" /><CodeLine lineNumber="3250"></CodeLine>
<Link id="l03251" /><CodeLine lineNumber="3251"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Since this user is part of the chain, it&#39;s no longer considered a use</span></CodeLine>
<Link id="l03252" /><CodeLine lineNumber="3252"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// of the chain.</span></CodeLine>
<Link id="l03253" /><CodeLine lineNumber="3253"><span class="doxyHighlight">  ChainUsersVec&#91;ChainIdx&#93;.FarUsers.<a href="/docs/api/classes/llvm/smallvectorimpl/#a563ffc2ff61c499b3be2e00100cb72fa">erase</a>(UserInst);</span></CodeLine>
<Link id="l03254" /><CodeLine lineNumber="3254"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03255" /><CodeLine lineNumber="3255"></CodeLine>
<Link id="l03256" /><CodeLine lineNumber="3256"><span class="doxyHighlightComment">/// Populate the vector of Chains.</span></CodeLine>
<Link id="l03257" /><CodeLine lineNumber="3257"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03258" /><CodeLine lineNumber="3258"><span class="doxyHighlightComment">/// This decreases ILP at the architecture level. Targets with ample registers,</span></CodeLine>
<Link id="l03259" /><CodeLine lineNumber="3259"><span class="doxyHighlightComment">/// multiple memory ports, and no register renaming probably don&#39;t want</span></CodeLine>
<Link id="l03260" /><CodeLine lineNumber="3260"><span class="doxyHighlightComment">/// this. However, such targets should probably disable LSR altogether.</span></CodeLine>
<Link id="l03261" /><CodeLine lineNumber="3261"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03262" /><CodeLine lineNumber="3262"><span class="doxyHighlightComment">/// The job of LSR is to make a reasonable choice of induction variables across</span></CodeLine>
<Link id="l03263" /><CodeLine lineNumber="3263"><span class="doxyHighlightComment">/// the loop. Subsequent passes can easily &quot;unchain&quot; computation exposing more</span></CodeLine>
<Link id="l03264" /><CodeLine lineNumber="3264"><span class="doxyHighlightComment">/// ILP &#42;within the loop&#42; if the target wants it.</span></CodeLine>
<Link id="l03265" /><CodeLine lineNumber="3265"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03266" /><CodeLine lineNumber="3266"><span class="doxyHighlightComment">/// Finding the best IV chain is potentially a scheduling problem. Since LSR</span></CodeLine>
<Link id="l03267" /><CodeLine lineNumber="3267"><span class="doxyHighlightComment">/// will not reorder memory operations, it will recognize this as a chain, but</span></CodeLine>
<Link id="l03268" /><CodeLine lineNumber="3268"><span class="doxyHighlightComment">/// will generate redundant IV increments. Ideally this would be corrected later</span></CodeLine>
<Link id="l03269" /><CodeLine lineNumber="3269"><span class="doxyHighlightComment">/// by a smart scheduler:</span></CodeLine>
<Link id="l03270" /><CodeLine lineNumber="3270"><span class="doxyHighlightComment">///        = A&#91;i&#93;</span></CodeLine>
<Link id="l03271" /><CodeLine lineNumber="3271"><span class="doxyHighlightComment">///        = A&#91;i+x&#93;</span></CodeLine>
<Link id="l03272" /><CodeLine lineNumber="3272"><span class="doxyHighlightComment">/// A&#91;i&#93;   =</span></CodeLine>
<Link id="l03273" /><CodeLine lineNumber="3273"><span class="doxyHighlightComment">/// A&#91;i+x&#93; =</span></CodeLine>
<Link id="l03274" /><CodeLine lineNumber="3274"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03275" /><CodeLine lineNumber="3275"><span class="doxyHighlightComment">/// TODO: Walk the entire domtree within this loop, not just the path to the</span></CodeLine>
<Link id="l03276" /><CodeLine lineNumber="3276"><span class="doxyHighlightComment">/// loop latch. This will discover chains on side paths, but requires</span></CodeLine>
<Link id="l03277" /><CodeLine lineNumber="3277"><span class="doxyHighlightComment">/// maintaining multiple copies of the Chains state.</span></CodeLine>
<Link id="l03278" /><CodeLine lineNumber="3278"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::CollectChains() &#123;</span></CodeLine>
<Link id="l03279" /><CodeLine lineNumber="3279"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Collecting IV Chains.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03280" /><CodeLine lineNumber="3280"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ChainUsers, 8&gt;</a> ChainUsersVec;</span></CodeLine>
<Link id="l03281" /><CodeLine lineNumber="3281"></CodeLine>
<Link id="l03282" /><CodeLine lineNumber="3282"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;,8&gt;</a> LatchPath;</span></CodeLine>
<Link id="l03283" /><CodeLine lineNumber="3283"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;LoopHeader = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader();</span></CodeLine>
<Link id="l03284" /><CodeLine lineNumber="3284"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a58b9df85470fc4e2a8066ff6a62e5a34">DomTreeNode</a> &#42;Rung = DT.getNode(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch());</span></CodeLine>
<Link id="l03285" /><CodeLine lineNumber="3285"><span class="doxyHighlight">       Rung-&gt;getBlock() != LoopHeader; Rung = Rung-&gt;getIDom()) &#123;</span></CodeLine>
<Link id="l03286" /><CodeLine lineNumber="3286"><span class="doxyHighlight">    LatchPath.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Rung-&gt;getBlock());</span></CodeLine>
<Link id="l03287" /><CodeLine lineNumber="3287"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03288" /><CodeLine lineNumber="3288"><span class="doxyHighlight">  LatchPath.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LoopHeader);</span></CodeLine>
<Link id="l03289" /><CodeLine lineNumber="3289"></CodeLine>
<Link id="l03290" /><CodeLine lineNumber="3290"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Walk the instruction stream from the loop header to the loop latch.</span></CodeLine>
<Link id="l03291" /><CodeLine lineNumber="3291"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(LatchPath)) &#123;</span></CodeLine>
<Link id="l03292" /><CodeLine lineNumber="3292"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : &#42;BB) &#123;</span></CodeLine>
<Link id="l03293" /><CodeLine lineNumber="3293"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Skip instructions that weren&#39;t seen by IVUsers analysis.</span></CodeLine>
<Link id="l03294" /><CodeLine lineNumber="3294"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) || !IU.isIVUserOrOperand(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>))</span></CodeLine>
<Link id="l03295" /><CodeLine lineNumber="3295"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03296" /><CodeLine lineNumber="3296"></CodeLine>
<Link id="l03297" /><CodeLine lineNumber="3297"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Ignore users that are part of a SCEV expression. This way we only</span></CodeLine>
<Link id="l03298" /><CodeLine lineNumber="3298"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// consider leaf IV Users. This effectively rediscovers a portion of</span></CodeLine>
<Link id="l03299" /><CodeLine lineNumber="3299"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// IVUsers analysis but in program order this time.</span></CodeLine>
<Link id="l03300" /><CodeLine lineNumber="3300"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.isSCEVable(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getType()) &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(SE.getSCEV(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)))</span></CodeLine>
<Link id="l03301" /><CodeLine lineNumber="3301"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03302" /><CodeLine lineNumber="3302"></CodeLine>
<Link id="l03303" /><CodeLine lineNumber="3303"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Remove this instruction from any NearUsers set it may be in.</span></CodeLine>
<Link id="l03304" /><CodeLine lineNumber="3304"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ChainIdx = 0, NChains = IVChainVec.size();</span></CodeLine>
<Link id="l03305" /><CodeLine lineNumber="3305"><span class="doxyHighlight">           ChainIdx &lt; NChains; ++ChainIdx) &#123;</span></CodeLine>
<Link id="l03306" /><CodeLine lineNumber="3306"><span class="doxyHighlight">        ChainUsersVec&#91;ChainIdx&#93;.NearUsers.<a href="/docs/api/classes/llvm/smallvectorimpl/#a563ffc2ff61c499b3be2e00100cb72fa">erase</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l03307" /><CodeLine lineNumber="3307"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03308" /><CodeLine lineNumber="3308"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Search for operands that can be chained.</span></CodeLine>
<Link id="l03309" /><CodeLine lineNumber="3309"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;Instruction&#42;, 4&gt;</a> UniqueOperands;</span></CodeLine>
<Link id="l03310" /><CodeLine lineNumber="3310"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> IVOpEnd = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.op&#95;end();</span></CodeLine>
<Link id="l03311" /><CodeLine lineNumber="3311"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> IVOpIter = <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.op&#95;begin(), IVOpEnd, L, SE);</span></CodeLine>
<Link id="l03312" /><CodeLine lineNumber="3312"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (IVOpIter != IVOpEnd) &#123;</span></CodeLine>
<Link id="l03313" /><CodeLine lineNumber="3313"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVOpInst = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(&#42;IVOpIter);</span></CodeLine>
<Link id="l03314" /><CodeLine lineNumber="3314"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UniqueOperands.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(IVOpInst).second)</span></CodeLine>
<Link id="l03315" /><CodeLine lineNumber="3315"><span class="doxyHighlight">          ChainInstruction(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, IVOpInst, ChainUsersVec);</span></CodeLine>
<Link id="l03316" /><CodeLine lineNumber="3316"><span class="doxyHighlight">        IVOpIter = <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(std::next(IVOpIter), IVOpEnd, L, SE);</span></CodeLine>
<Link id="l03317" /><CodeLine lineNumber="3317"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03318" /><CodeLine lineNumber="3318"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightComment">// Continue walking down the instructions.</span></CodeLine>
<Link id="l03319" /><CodeLine lineNumber="3319"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightComment">// Continue walking down the domtree.</span></CodeLine>
<Link id="l03320" /><CodeLine lineNumber="3320"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Visit phi backedges to determine if the chain can generate the IV postinc.</span></CodeLine>
<Link id="l03321" /><CodeLine lineNumber="3321"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;PN : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;phis()) &#123;</span></CodeLine>
<Link id="l03322" /><CodeLine lineNumber="3322"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SE.isSCEVable(PN.getType()))</span></CodeLine>
<Link id="l03323" /><CodeLine lineNumber="3323"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03324" /><CodeLine lineNumber="3324"></CodeLine>
<Link id="l03325" /><CodeLine lineNumber="3325"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IncV =</span></CodeLine>
<Link id="l03326" /><CodeLine lineNumber="3326"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(PN.getIncomingValueForBlock(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()));</span></CodeLine>
<Link id="l03327" /><CodeLine lineNumber="3327"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IncV)</span></CodeLine>
<Link id="l03328" /><CodeLine lineNumber="3328"><span class="doxyHighlight">      ChainInstruction(&amp;PN, IncV, ChainUsersVec);</span></CodeLine>
<Link id="l03329" /><CodeLine lineNumber="3329"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03330" /><CodeLine lineNumber="3330"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Remove any unprofitable chains.</span></CodeLine>
<Link id="l03331" /><CodeLine lineNumber="3331"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ChainIdx = 0;</span></CodeLine>
<Link id="l03332" /><CodeLine lineNumber="3332"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> UsersIdx = 0, NChains = IVChainVec.size();</span></CodeLine>
<Link id="l03333" /><CodeLine lineNumber="3333"><span class="doxyHighlight">       UsersIdx &lt; NChains; ++UsersIdx) &#123;</span></CodeLine>
<Link id="l03334" /><CodeLine lineNumber="3334"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aca012302770ad32503de5e2c62344290">isProfitableChain</a>(IVChainVec&#91;UsersIdx&#93;,</span></CodeLine>
<Link id="l03335" /><CodeLine lineNumber="3335"><span class="doxyHighlight">                           ChainUsersVec&#91;UsersIdx&#93;.FarUsers, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>))</span></CodeLine>
<Link id="l03336" /><CodeLine lineNumber="3336"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03337" /><CodeLine lineNumber="3337"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Preserve the chain at UsesIdx.</span></CodeLine>
<Link id="l03338" /><CodeLine lineNumber="3338"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ChainIdx != UsersIdx)</span></CodeLine>
<Link id="l03339" /><CodeLine lineNumber="3339"><span class="doxyHighlight">      IVChainVec&#91;ChainIdx&#93; = IVChainVec&#91;UsersIdx&#93;;</span></CodeLine>
<Link id="l03340" /><CodeLine lineNumber="3340"><span class="doxyHighlight">    FinalizeChain(IVChainVec&#91;ChainIdx&#93;);</span></CodeLine>
<Link id="l03341" /><CodeLine lineNumber="3341"><span class="doxyHighlight">    ++ChainIdx;</span></CodeLine>
<Link id="l03342" /><CodeLine lineNumber="3342"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03343" /><CodeLine lineNumber="3343"><span class="doxyHighlight">  IVChainVec.resize(ChainIdx);</span></CodeLine>
<Link id="l03344" /><CodeLine lineNumber="3344"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03345" /><CodeLine lineNumber="3345"></CodeLine>
<Link id="l03346" /><CodeLine lineNumber="3346"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::FinalizeChain(IVChain &amp;Chain) &#123;</span></CodeLine>
<Link id="l03347" /><CodeLine lineNumber="3347"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;empty IV chains are not allowed&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03348" /><CodeLine lineNumber="3348"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Final Chain: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs&#91;0&#93;.UserInst &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03349" /><CodeLine lineNumber="3349"><span class="doxyHighlight">  </span></CodeLine>
<Link id="l03350" /><CodeLine lineNumber="3350"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> IVInc &amp;Inc : Chain) &#123;</span></CodeLine>
<Link id="l03351" /><CodeLine lineNumber="3351"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;        Inc: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;Inc.UserInst &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03352" /><CodeLine lineNumber="3352"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> UseI = <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">find</a>(Inc.UserInst-&gt;operands(), Inc.IVOperand);</span></CodeLine>
<Link id="l03353" /><CodeLine lineNumber="3353"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(UseI != Inc.UserInst-&gt;op&#95;end() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;cannot find IV operand&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03354" /><CodeLine lineNumber="3354"><span class="doxyHighlight">    IVIncSet.insert(UseI);</span></CodeLine>
<Link id="l03355" /><CodeLine lineNumber="3355"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03356" /><CodeLine lineNumber="3356"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03357" /><CodeLine lineNumber="3357"></CodeLine>
<Link id="l03358" /><CodeLine lineNumber="3358"><span class="doxyHighlightComment">/// Return true if the IVInc can be folded into an addressing mode.</span></CodeLine>
<Link id="l03359" /><CodeLine lineNumber="3359" lineLink="#ad35b9a85ea52062375c0c870be5cd228"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#ad35b9a85ea52062375c0c870be5cd228">canFoldIVIncExpr</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst,</span></CodeLine>
<Link id="l03360" /><CodeLine lineNumber="3360"><span class="doxyHighlight">                             <a href="/docs/api/classes/llvm/value">Value</a> &#42;Operand, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>) &#123;</span></CodeLine>
<Link id="l03361" /><CodeLine lineNumber="3361"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;IncConst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(IncExpr);</span></CodeLine>
<Link id="l03362" /><CodeLine lineNumber="3362"><span class="doxyHighlight">  Immediate IncOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a393faf261b99c7234b6d7d97dbdbd5e0">Immediate::getZero</a>();</span></CodeLine>
<Link id="l03363" /><CodeLine lineNumber="3363"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IncConst) &#123;</span></CodeLine>
<Link id="l03364" /><CodeLine lineNumber="3364"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IncConst &amp;&amp; IncConst-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a6caf7f3a0a4303e4c0bc06ed8e205126">getAPInt</a>().<a href="/docs/api/classes/llvm/apint/#a9f78d7e839322a6bfc0c665d29052242">getSignificantBits</a>() &gt; 64)</span></CodeLine>
<Link id="l03365" /><CodeLine lineNumber="3365"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03366" /><CodeLine lineNumber="3366"><span class="doxyHighlight">    IncOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(IncConst-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a476a7aca5d55536fcbfb498dfe5d380d">getValue</a>()-&gt;<a href="/docs/api/classes/llvm/constantint/#aa8f4be0661aa64f5b1f20b15e93bb403">getSExtValue</a>());</span></CodeLine>
<Link id="l03367" /><CodeLine lineNumber="3367"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03368" /><CodeLine lineNumber="3368"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Look for mul(vscale, constant), to detect a scalable offset.</span></CodeLine>
<Link id="l03369" /><CodeLine lineNumber="3369"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;IncVScale = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(IncExpr);</span></CodeLine>
<Link id="l03370" /><CodeLine lineNumber="3370"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IncVScale || IncVScale-&gt;getNumOperands() != 2 ||</span></CodeLine>
<Link id="l03371" /><CodeLine lineNumber="3371"><span class="doxyHighlight">        !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVVScale&gt;</a>(IncVScale-&gt;getOperand(1)))</span></CodeLine>
<Link id="l03372" /><CodeLine lineNumber="3372"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03373" /><CodeLine lineNumber="3373"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;Scale = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(IncVScale-&gt;getOperand(0));</span></CodeLine>
<Link id="l03374" /><CodeLine lineNumber="3374"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Scale || Scale-&gt;getType()-&gt;getScalarSizeInBits() &gt; 64)</span></CodeLine>
<Link id="l03375" /><CodeLine lineNumber="3375"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03376" /><CodeLine lineNumber="3376"><span class="doxyHighlight">    IncOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#ac7030e0a5d4b154f205b3d85dde0644b">Immediate::getScalable</a>(Scale-&gt;getValue()-&gt;getSExtValue());</span></CodeLine>
<Link id="l03377" /><CodeLine lineNumber="3377"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03378" /><CodeLine lineNumber="3378"></CodeLine>
<Link id="l03379" /><CodeLine lineNumber="3379"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UserInst, Operand))</span></CodeLine>
<Link id="l03380" /><CodeLine lineNumber="3380"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03381" /><CodeLine lineNumber="3381"></CodeLine>
<Link id="l03382" /><CodeLine lineNumber="3382"><span class="doxyHighlight">  MemAccessTy AccessTy = <a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UserInst, Operand);</span></CodeLine>
<Link id="l03383" /><CodeLine lineNumber="3383"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>, AccessTy, </span><span class="doxyHighlightComment">/&#42;BaseGV=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l03384" /><CodeLine lineNumber="3384"><span class="doxyHighlight">                        IncOffset, </span><span class="doxyHighlightComment">/&#42;HasBaseReg=&#42;/</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">))</span></CodeLine>
<Link id="l03385" /><CodeLine lineNumber="3385"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03386" /><CodeLine lineNumber="3386"></CodeLine>
<Link id="l03387" /><CodeLine lineNumber="3387"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03388" /><CodeLine lineNumber="3388"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03389" /><CodeLine lineNumber="3389"></CodeLine>
<Link id="l03390" /><CodeLine lineNumber="3390"><span class="doxyHighlightComment">/// Generate an add or subtract for each IVInc in a chain to materialize the IV</span></CodeLine>
<Link id="l03391" /><CodeLine lineNumber="3391"><span class="doxyHighlightComment">/// user&#39;s operand from the previous IV user&#39;s operand.</span></CodeLine>
<Link id="l03392" /><CodeLine lineNumber="3392"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateIVChain(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> IVChain &amp;Chain,</span></CodeLine>
<Link id="l03393" /><CodeLine lineNumber="3393"><span class="doxyHighlight">                                  <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts) &#123;</span></CodeLine>
<Link id="l03394" /><CodeLine lineNumber="3394"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Find the new IVOperand for the head of the chain. It may have been replaced</span></CodeLine>
<Link id="l03395" /><CodeLine lineNumber="3395"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// by LSR.</span></CodeLine>
<Link id="l03396" /><CodeLine lineNumber="3396"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> IVInc &amp;Head = <a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.Incs&#91;0&#93;;</span></CodeLine>
<Link id="l03397" /><CodeLine lineNumber="3397"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> IVOpEnd = Head.UserInst-&gt;op&#95;end();</span></CodeLine>
<Link id="l03398" /><CodeLine lineNumber="3398"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// findIVOperand returns IVOpEnd if it can no longer find a valid IV user.</span></CodeLine>
<Link id="l03399" /><CodeLine lineNumber="3399"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> IVOpIter = <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(Head.UserInst-&gt;op&#95;begin(),</span></CodeLine>
<Link id="l03400" /><CodeLine lineNumber="3400"><span class="doxyHighlight">                                             IVOpEnd, L, SE);</span></CodeLine>
<Link id="l03401" /><CodeLine lineNumber="3401"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;IVSrc = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03402" /><CodeLine lineNumber="3402"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (IVOpIter != IVOpEnd) &#123;</span></CodeLine>
<Link id="l03403" /><CodeLine lineNumber="3403"><span class="doxyHighlight">    IVSrc = <a href="#a0ef5c4bf982afaa71a03555b138aba58">getWideOperand</a>(&#42;IVOpIter);</span></CodeLine>
<Link id="l03404" /><CodeLine lineNumber="3404"></CodeLine>
<Link id="l03405" /><CodeLine lineNumber="3405"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this operand computes the expression that the chain needs, we may use</span></CodeLine>
<Link id="l03406" /><CodeLine lineNumber="3406"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// it. (Check this after setting IVSrc which is used below.)</span></CodeLine>
<Link id="l03407" /><CodeLine lineNumber="3407"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l03408" /><CodeLine lineNumber="3408"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Note that if Head.IncExpr is wider than IVSrc, then this phi is too</span></CodeLine>
<Link id="l03409" /><CodeLine lineNumber="3409"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// narrow for the chain, so we can no longer use it. We do allow using a</span></CodeLine>
<Link id="l03410" /><CodeLine lineNumber="3410"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// wider phi, assuming the LSR checked for free truncation. In that case we</span></CodeLine>
<Link id="l03411" /><CodeLine lineNumber="3411"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// should already have a truncate on this operand such that</span></CodeLine>
<Link id="l03412" /><CodeLine lineNumber="3412"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// getSCEV(IVSrc) == IncExpr.</span></CodeLine>
<Link id="l03413" /><CodeLine lineNumber="3413"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getSCEV(&#42;IVOpIter) == Head.IncExpr</span></CodeLine>
<Link id="l03414" /><CodeLine lineNumber="3414"><span class="doxyHighlight">        || SE.getSCEV(IVSrc) == Head.IncExpr) &#123;</span></CodeLine>
<Link id="l03415" /><CodeLine lineNumber="3415"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03416" /><CodeLine lineNumber="3416"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03417" /><CodeLine lineNumber="3417"><span class="doxyHighlight">    IVOpIter = <a href="#a262aeb2eecfb752ae2eecb90bab7ec8a">findIVOperand</a>(std::next(IVOpIter), IVOpEnd, L, SE);</span></CodeLine>
<Link id="l03418" /><CodeLine lineNumber="3418"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03419" /><CodeLine lineNumber="3419"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IVOpIter == IVOpEnd) &#123;</span></CodeLine>
<Link id="l03420" /><CodeLine lineNumber="3420"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Gracefully give up on this chain.</span></CodeLine>
<Link id="l03421" /><CodeLine lineNumber="3421"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Concealed chain head: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;Head.UserInst &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03422" /><CodeLine lineNumber="3422"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03423" /><CodeLine lineNumber="3423"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03424" /><CodeLine lineNumber="3424"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IVSrc &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Failed to find IV chain source&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03425" /><CodeLine lineNumber="3425"></CodeLine>
<Link id="l03426" /><CodeLine lineNumber="3426"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Generate chain at: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;IVSrc &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03427" /><CodeLine lineNumber="3427"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IVTy = IVSrc-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</span></CodeLine>
<Link id="l03428" /><CodeLine lineNumber="3428"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = SE.getEffectiveSCEVType(IVTy);</span></CodeLine>
<Link id="l03429" /><CodeLine lineNumber="3429"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LeftOverExpr = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03430" /><CodeLine lineNumber="3430"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Accum = SE.getZero(IntTy);</span></CodeLine>
<Link id="l03431" /><CodeLine lineNumber="3431"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;const SCEV &#42;, Value &#42;&gt;</a>&gt; Bases;</span></CodeLine>
<Link id="l03432" /><CodeLine lineNumber="3432"><span class="doxyHighlight">  Bases.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Accum, IVSrc);</span></CodeLine>
<Link id="l03433" /><CodeLine lineNumber="3433"></CodeLine>
<Link id="l03434" /><CodeLine lineNumber="3434"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> IVInc &amp;Inc : Chain) &#123;</span></CodeLine>
<Link id="l03435" /><CodeLine lineNumber="3435"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;InsertPt = Inc.UserInst;</span></CodeLine>
<Link id="l03436" /><CodeLine lineNumber="3436"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(InsertPt))</span></CodeLine>
<Link id="l03437" /><CodeLine lineNumber="3437"><span class="doxyHighlight">      InsertPt = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()-&gt;getTerminator();</span></CodeLine>
<Link id="l03438" /><CodeLine lineNumber="3438"></CodeLine>
<Link id="l03439" /><CodeLine lineNumber="3439"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// IVOper will replace the current IV User&#39;s operand. IVSrc is the IV</span></CodeLine>
<Link id="l03440" /><CodeLine lineNumber="3440"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// value currently held in a register.</span></CodeLine>
<Link id="l03441" /><CodeLine lineNumber="3441"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;IVOper = IVSrc;</span></CodeLine>
<Link id="l03442" /><CodeLine lineNumber="3442"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Inc.IncExpr-&gt;isZero()) &#123;</span></CodeLine>
<Link id="l03443" /><CodeLine lineNumber="3443"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// IncExpr was the result of subtraction of two narrow values, so must</span></CodeLine>
<Link id="l03444" /><CodeLine lineNumber="3444"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// be signed.</span></CodeLine>
<Link id="l03445" /><CodeLine lineNumber="3445"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IncExpr = SE.getNoopOrSignExtend(Inc.IncExpr, IntTy);</span></CodeLine>
<Link id="l03446" /><CodeLine lineNumber="3446"><span class="doxyHighlight">      Accum = SE.getAddExpr(Accum, IncExpr);</span></CodeLine>
<Link id="l03447" /><CodeLine lineNumber="3447"><span class="doxyHighlight">      LeftOverExpr = LeftOverExpr ?</span></CodeLine>
<Link id="l03448" /><CodeLine lineNumber="3448"><span class="doxyHighlight">        SE.getAddExpr(LeftOverExpr, IncExpr) : IncExpr;</span></CodeLine>
<Link id="l03449" /><CodeLine lineNumber="3449"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03450" /><CodeLine lineNumber="3450"></CodeLine>
<Link id="l03451" /><CodeLine lineNumber="3451"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Look through each base to see if any can produce a nice addressing mode.</span></CodeLine>
<Link id="l03452" /><CodeLine lineNumber="3452"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> FoundBase = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03453" /><CodeLine lineNumber="3453"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#91;MapScev, MapIVOper&#93; : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(Bases)) &#123;</span></CodeLine>
<Link id="l03454" /><CodeLine lineNumber="3454"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder = SE.getMinusSCEV(Accum, MapScev);</span></CodeLine>
<Link id="l03455" /><CodeLine lineNumber="3455"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#ad35b9a85ea52062375c0c870be5cd228">canFoldIVIncExpr</a>(Remainder, Inc.UserInst, Inc.IVOperand, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>)) &#123;</span></CodeLine>
<Link id="l03456" /><CodeLine lineNumber="3456"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Remainder-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</span></CodeLine>
<Link id="l03457" /><CodeLine lineNumber="3457"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clearPostInc();</span></CodeLine>
<Link id="l03458" /><CodeLine lineNumber="3458"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/value">Value</a> &#42;IncV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(Remainder, IntTy, InsertPt);</span></CodeLine>
<Link id="l03459" /><CodeLine lineNumber="3459"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IVOperExpr =</span></CodeLine>
<Link id="l03460" /><CodeLine lineNumber="3460"><span class="doxyHighlight">              SE.getAddExpr(SE.getUnknown(MapIVOper), SE.getUnknown(IncV));</span></CodeLine>
<Link id="l03461" /><CodeLine lineNumber="3461"><span class="doxyHighlight">          IVOper = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(IVOperExpr, IVTy, InsertPt);</span></CodeLine>
<Link id="l03462" /><CodeLine lineNumber="3462"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03463" /><CodeLine lineNumber="3463"><span class="doxyHighlight">          IVOper = MapIVOper;</span></CodeLine>
<Link id="l03464" /><CodeLine lineNumber="3464"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03465" /><CodeLine lineNumber="3465"></CodeLine>
<Link id="l03466" /><CodeLine lineNumber="3466"><span class="doxyHighlight">        FoundBase = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03467" /><CodeLine lineNumber="3467"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03468" /><CodeLine lineNumber="3468"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03469" /><CodeLine lineNumber="3469"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03470" /><CodeLine lineNumber="3470"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!FoundBase &amp;&amp; LeftOverExpr &amp;&amp; !LeftOverExpr-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</span></CodeLine>
<Link id="l03471" /><CodeLine lineNumber="3471"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Expand the IV increment.</span></CodeLine>
<Link id="l03472" /><CodeLine lineNumber="3472"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clearPostInc();</span></CodeLine>
<Link id="l03473" /><CodeLine lineNumber="3473"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;IncV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(LeftOverExpr, IntTy, InsertPt);</span></CodeLine>
<Link id="l03474" /><CodeLine lineNumber="3474"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;IVOperExpr = SE.getAddExpr(SE.getUnknown(IVSrc),</span></CodeLine>
<Link id="l03475" /><CodeLine lineNumber="3475"><span class="doxyHighlight">                                             SE.getUnknown(IncV));</span></CodeLine>
<Link id="l03476" /><CodeLine lineNumber="3476"><span class="doxyHighlight">      IVOper = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(IVOperExpr, IVTy, InsertPt);</span></CodeLine>
<Link id="l03477" /><CodeLine lineNumber="3477"></CodeLine>
<Link id="l03478" /><CodeLine lineNumber="3478"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If an IV increment can&#39;t be folded, use it as the next IV value.</span></CodeLine>
<Link id="l03479" /><CodeLine lineNumber="3479"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#ad35b9a85ea52062375c0c870be5cd228">canFoldIVIncExpr</a>(LeftOverExpr, Inc.UserInst, Inc.IVOperand, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>)) &#123;</span></CodeLine>
<Link id="l03480" /><CodeLine lineNumber="3480"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(IVTy == IVOper-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;inconsistent IV increment type&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03481" /><CodeLine lineNumber="3481"><span class="doxyHighlight">        Bases.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(Accum, IVOper);</span></CodeLine>
<Link id="l03482" /><CodeLine lineNumber="3482"><span class="doxyHighlight">        IVSrc = IVOper;</span></CodeLine>
<Link id="l03483" /><CodeLine lineNumber="3483"><span class="doxyHighlight">        LeftOverExpr = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03484" /><CodeLine lineNumber="3484"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03485" /><CodeLine lineNumber="3485"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03486" /><CodeLine lineNumber="3486"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;OperTy = Inc.IVOperand-&gt;getType();</span></CodeLine>
<Link id="l03487" /><CodeLine lineNumber="3487"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IVTy != OperTy) &#123;</span></CodeLine>
<Link id="l03488" /><CodeLine lineNumber="3488"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SE.getTypeSizeInBits(IVTy) &gt;= SE.getTypeSizeInBits(OperTy) &amp;&amp;</span></CodeLine>
<Link id="l03489" /><CodeLine lineNumber="3489"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;cannot extend a chained IV&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03490" /><CodeLine lineNumber="3490"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> Builder(InsertPt);</span></CodeLine>
<Link id="l03491" /><CodeLine lineNumber="3491"><span class="doxyHighlight">      IVOper = Builder.CreateTruncOrBitCast(IVOper, OperTy, </span><span class="doxyHighlightStringLiteral">&quot;lsr.chain&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03492" /><CodeLine lineNumber="3492"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03493" /><CodeLine lineNumber="3493"><span class="doxyHighlight">    Inc.UserInst-&gt;replaceUsesOfWith(Inc.IVOperand, IVOper);</span></CodeLine>
<Link id="l03494" /><CodeLine lineNumber="3494"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;OperandIsInstr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(Inc.IVOperand))</span></CodeLine>
<Link id="l03495" /><CodeLine lineNumber="3495"><span class="doxyHighlight">      DeadInsts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(OperandIsInstr);</span></CodeLine>
<Link id="l03496" /><CodeLine lineNumber="3496"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03497" /><CodeLine lineNumber="3497"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If LSR created a new, wider phi, we may also replace its postinc. We only</span></CodeLine>
<Link id="l03498" /><CodeLine lineNumber="3498"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// do this if we also found a wide value for the head of the chain.</span></CodeLine>
<Link id="l03499" /><CodeLine lineNumber="3499"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.tailUserInst())) &#123;</span></CodeLine>
<Link id="l03500" /><CodeLine lineNumber="3500"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;Phi : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;phis()) &#123;</span></CodeLine>
<Link id="l03501" /><CodeLine lineNumber="3501"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/rdf/#a379bee2dadbfd1d7a599f003c4275dd8">Phi</a>.getType() != IVSrc-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())</span></CodeLine>
<Link id="l03502" /><CodeLine lineNumber="3502"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03503" /><CodeLine lineNumber="3503"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;PostIncV = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(</span></CodeLine>
<Link id="l03504" /><CodeLine lineNumber="3504"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/rdf/#a379bee2dadbfd1d7a599f003c4275dd8">Phi</a>.getIncomingValueForBlock(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()));</span></CodeLine>
<Link id="l03505" /><CodeLine lineNumber="3505"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!PostIncV || (SE.getSCEV(PostIncV) != SE.getSCEV(IVSrc)))</span></CodeLine>
<Link id="l03506" /><CodeLine lineNumber="3506"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03507" /><CodeLine lineNumber="3507"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;IVOper = IVSrc;</span></CodeLine>
<Link id="l03508" /><CodeLine lineNumber="3508"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/type">Type</a> &#42;PostIncTy = PostIncV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>();</span></CodeLine>
<Link id="l03509" /><CodeLine lineNumber="3509"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IVTy != PostIncTy) &#123;</span></CodeLine>
<Link id="l03510" /><CodeLine lineNumber="3510"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PostIncTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;mixing int/ptr IV types&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03511" /><CodeLine lineNumber="3511"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/irbuilder">IRBuilder&lt;&gt;</a> Builder(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()-&gt;getTerminator());</span></CodeLine>
<Link id="l03512" /><CodeLine lineNumber="3512"><span class="doxyHighlight">        Builder.SetCurrentDebugLocation(PostIncV-&gt;<a href="/docs/api/classes/llvm/instruction/#a4b8faae4ff9e7434a1d226d03d15dcd2">getDebugLoc</a>());</span></CodeLine>
<Link id="l03513" /><CodeLine lineNumber="3513"><span class="doxyHighlight">        IVOper = Builder.CreatePointerCast(IVSrc, PostIncTy, </span><span class="doxyHighlightStringLiteral">&quot;lsr.chain&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03514" /><CodeLine lineNumber="3514"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03515" /><CodeLine lineNumber="3515"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/rdf/#a379bee2dadbfd1d7a599f003c4275dd8">Phi</a>.replaceUsesOfWith(PostIncV, IVOper);</span></CodeLine>
<Link id="l03516" /><CodeLine lineNumber="3516"><span class="doxyHighlight">      DeadInsts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(PostIncV);</span></CodeLine>
<Link id="l03517" /><CodeLine lineNumber="3517"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03518" /><CodeLine lineNumber="3518"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03519" /><CodeLine lineNumber="3519"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03520" /><CodeLine lineNumber="3520"></CodeLine>
<Link id="l03521" /><CodeLine lineNumber="3521"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::CollectFixupsAndInitialFormulae() &#123;</span></CodeLine>
<Link id="l03522" /><CodeLine lineNumber="3522"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/branchinst">BranchInst</a> &#42;ExitBranch = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03523" /><CodeLine lineNumber="3523"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> SaveCmp = <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.canSaveCmp(L, &amp;ExitBranch, &amp;SE, &amp;LI, &amp;DT, &amp;AC, &amp;TLI);</span></CodeLine>
<Link id="l03524" /><CodeLine lineNumber="3524"></CodeLine>
<Link id="l03525" /><CodeLine lineNumber="3525"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For calculating baseline cost</span></CodeLine>
<Link id="l03526" /><CodeLine lineNumber="3526"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> Regs;</span></CodeLine>
<Link id="l03527" /><CodeLine lineNumber="3527"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> VisitedRegs;</span></CodeLine>
<Link id="l03528" /><CodeLine lineNumber="3528"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;size&#95;t&gt;</a> VisitedLSRUse;</span></CodeLine>
<Link id="l03529" /><CodeLine lineNumber="3529"></CodeLine>
<Link id="l03530" /><CodeLine lineNumber="3530"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;U : IU) &#123;</span></CodeLine>
<Link id="l03531" /><CodeLine lineNumber="3531"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser();</span></CodeLine>
<Link id="l03532" /><CodeLine lineNumber="3532"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Skip IV users that are part of profitable IV Chains.</span></CodeLine>
<Link id="l03533" /><CodeLine lineNumber="3533"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/user/#a0126e6f10273e8db07142833979a0c8f">User::op&#95;iterator</a> UseI =</span></CodeLine>
<Link id="l03534" /><CodeLine lineNumber="3534"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">find</a>(UserInst-&gt;<a href="/docs/api/classes/llvm/user/#a0b931781aa589c6ebe64a76c1447e5b2">operands</a>(), <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace());</span></CodeLine>
<Link id="l03535" /><CodeLine lineNumber="3535"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(UseI != UserInst-&gt;<a href="/docs/api/classes/llvm/user/#af41f58e730804d10b91fcff39b035f74">op&#95;end</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;cannot find IV operand&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03536" /><CodeLine lineNumber="3536"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IVIncSet.count(UseI)) &#123;</span></CodeLine>
<Link id="l03537" /><CodeLine lineNumber="3537"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Use is in profitable chain: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;&#42;UseI &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03538" /><CodeLine lineNumber="3538"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03539" /><CodeLine lineNumber="3539"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03540" /><CodeLine lineNumber="3540"></CodeLine>
<Link id="l03541" /><CodeLine lineNumber="3541"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0">LSRUse::KindType</a> <a href="/docs/api/namespaces/llvm/lltok/#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a>;</span></CodeLine>
<Link id="l03542" /><CodeLine lineNumber="3542"><span class="doxyHighlight">    MemAccessTy AccessTy;</span></CodeLine>
<Link id="l03543" /><CodeLine lineNumber="3543"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a4120d81bd505176f5cadf647f5b8c7ef">isAddressUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UserInst, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace())) &#123;</span></CodeLine>
<Link id="l03544" /><CodeLine lineNumber="3544"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/lltok/#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>;</span></CodeLine>
<Link id="l03545" /><CodeLine lineNumber="3545"><span class="doxyHighlight">      AccessTy = <a href="#a7f4680b383ce7138bc2c12de282b14b4">getAccessType</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, UserInst, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace());</span></CodeLine>
<Link id="l03546" /><CodeLine lineNumber="3546"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03547" /><CodeLine lineNumber="3547"></CodeLine>
<Link id="l03548" /><CodeLine lineNumber="3548"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = IU.getExpr(U);</span></CodeLine>
<Link id="l03549" /><CodeLine lineNumber="3549"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!S)</span></CodeLine>
<Link id="l03550" /><CodeLine lineNumber="3550"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03551" /><CodeLine lineNumber="3551"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> TmpPostIncLoops = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getPostIncLoops();</span></CodeLine>
<Link id="l03552" /><CodeLine lineNumber="3552"></CodeLine>
<Link id="l03553" /><CodeLine lineNumber="3553"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Equality (== and !=) ICmps are special. We can rewrite (i == N) as</span></CodeLine>
<Link id="l03554" /><CodeLine lineNumber="3554"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// (N - i == 0), and this allows (N - i) to be the expression that we work</span></CodeLine>
<Link id="l03555" /><CodeLine lineNumber="3555"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// with rather than just N or i, so we can consider the register</span></CodeLine>
<Link id="l03556" /><CodeLine lineNumber="3556"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// requirements for both N and i at the same time. Limiting this code to</span></CodeLine>
<Link id="l03557" /><CodeLine lineNumber="3557"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// equality icmps is not a problem because all interesting loops use</span></CodeLine>
<Link id="l03558" /><CodeLine lineNumber="3558"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// equality icmps, thanks to IndVarSimplify.</span></CodeLine>
<Link id="l03559" /><CodeLine lineNumber="3559"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;CI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ICmpInst&gt;</a>(UserInst)) &#123;</span></CodeLine>
<Link id="l03560" /><CodeLine lineNumber="3560"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If CI can be saved in some target, like replaced inside hardware loop</span></CodeLine>
<Link id="l03561" /><CodeLine lineNumber="3561"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// in PowerPC, no need to generate initial formulae for it.</span></CodeLine>
<Link id="l03562" /><CodeLine lineNumber="3562"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SaveCmp &amp;&amp; CI == <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ICmpInst&gt;</a>(ExitBranch-&gt;<a href="/docs/api/classes/llvm/branchinst/#aebd4af5642453ce3169094f08dd3d7b8">getCondition</a>()))</span></CodeLine>
<Link id="l03563" /><CodeLine lineNumber="3563"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03564" /><CodeLine lineNumber="3564"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CI-&gt;isEquality()) &#123;</span></CodeLine>
<Link id="l03565" /><CodeLine lineNumber="3565"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Swap the operands if needed to put the OperandValToReplace on the</span></CodeLine>
<Link id="l03566" /><CodeLine lineNumber="3566"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// left, for consistency.</span></CodeLine>
<Link id="l03567" /><CodeLine lineNumber="3567"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/ore/#a5ca06dfbc998afac005414d8e9b7c234">NV</a> = CI-&gt;getOperand(1);</span></CodeLine>
<Link id="l03568" /><CodeLine lineNumber="3568"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NV == <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace()) &#123;</span></CodeLine>
<Link id="l03569" /><CodeLine lineNumber="3569"><span class="doxyHighlight">          CI-&gt;setOperand(1, CI-&gt;getOperand(0));</span></CodeLine>
<Link id="l03570" /><CodeLine lineNumber="3570"><span class="doxyHighlight">          CI-&gt;setOperand(0, NV);</span></CodeLine>
<Link id="l03571" /><CodeLine lineNumber="3571"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/ore/#a5ca06dfbc998afac005414d8e9b7c234">NV</a> = CI-&gt;getOperand(1);</span></CodeLine>
<Link id="l03572" /><CodeLine lineNumber="3572"><span class="doxyHighlight">          <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03573" /><CodeLine lineNumber="3573"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03574" /><CodeLine lineNumber="3574"></CodeLine>
<Link id="l03575" /><CodeLine lineNumber="3575"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// x == y  --&gt;  x - y == 0</span></CodeLine>
<Link id="l03576" /><CodeLine lineNumber="3576"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = SE.getSCEV(NV);</span></CodeLine>
<Link id="l03577" /><CodeLine lineNumber="3577"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.isLoopInvariant(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, L) &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isSafeToExpand(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>) &amp;&amp;</span></CodeLine>
<Link id="l03578" /><CodeLine lineNumber="3578"><span class="doxyHighlight">            (!<a href="/docs/api/namespaces/llvm/ore/#a5ca06dfbc998afac005414d8e9b7c234">NV</a>-&gt;getType()-&gt;isPointerTy() ||</span></CodeLine>
<Link id="l03579" /><CodeLine lineNumber="3579"><span class="doxyHighlight">             SE.getPointerBase(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>) == SE.getPointerBase(S))) &#123;</span></CodeLine>
<Link id="l03580" /><CodeLine lineNumber="3580"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// S is normalized, so normalize N before folding it into S</span></CodeLine>
<Link id="l03581" /><CodeLine lineNumber="3581"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// to keep the result normalized.</span></CodeLine>
<Link id="l03582" /><CodeLine lineNumber="3582"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = <a href="/docs/api/namespaces/llvm/#a99237ea99bf8618b7d29b5ca6185069b">normalizeForPostIncUse</a>(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, TmpPostIncLoops, SE);</span></CodeLine>
<Link id="l03583" /><CodeLine lineNumber="3583"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>)</span></CodeLine>
<Link id="l03584" /><CodeLine lineNumber="3584"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03585" /><CodeLine lineNumber="3585"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/lltok/#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>;</span></CodeLine>
<Link id="l03586" /><CodeLine lineNumber="3586"><span class="doxyHighlight">          S = SE.getMinusSCEV(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, S);</span></CodeLine>
<Link id="l03587" /><CodeLine lineNumber="3587"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;isLoopInvariant(NV) &amp;&amp;</span></CodeLine>
<Link id="l03588" /><CodeLine lineNumber="3588"><span class="doxyHighlight">                   (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;Instruction&gt;</a>(NV) ||</span></CodeLine>
<Link id="l03589" /><CodeLine lineNumber="3589"><span class="doxyHighlight">                    DT.dominates(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;Instruction&gt;</a>(NV), <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader())) &amp;&amp;</span></CodeLine>
<Link id="l03590" /><CodeLine lineNumber="3590"><span class="doxyHighlight">                   !<a href="/docs/api/namespaces/llvm/ore/#a5ca06dfbc998afac005414d8e9b7c234">NV</a>-&gt;getType()-&gt;isPointerTy()) &#123;</span></CodeLine>
<Link id="l03591" /><CodeLine lineNumber="3591"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// If we can&#39;t generally expand the expression (e.g. it contains</span></CodeLine>
<Link id="l03592" /><CodeLine lineNumber="3592"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// a divide), but it is already at a loop invariant point before the</span></CodeLine>
<Link id="l03593" /><CodeLine lineNumber="3593"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// loop, wrap it in an unknown (to prevent the expander from trying</span></CodeLine>
<Link id="l03594" /><CodeLine lineNumber="3594"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// to re-expand in a potentially unsafe way.)  The restriction to</span></CodeLine>
<Link id="l03595" /><CodeLine lineNumber="3595"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// integer types is required because the unknown hides the base, and</span></CodeLine>
<Link id="l03596" /><CodeLine lineNumber="3596"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// SCEV can&#39;t compute the difference of two unknown pointers.</span></CodeLine>
<Link id="l03597" /><CodeLine lineNumber="3597"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = SE.getUnknown(NV);</span></CodeLine>
<Link id="l03598" /><CodeLine lineNumber="3598"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = <a href="/docs/api/namespaces/llvm/#a99237ea99bf8618b7d29b5ca6185069b">normalizeForPostIncUse</a>(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, TmpPostIncLoops, SE);</span></CodeLine>
<Link id="l03599" /><CodeLine lineNumber="3599"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>)</span></CodeLine>
<Link id="l03600" /><CodeLine lineNumber="3600"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03601" /><CodeLine lineNumber="3601"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/lltok/#af353621f14cb4b4b3af5ffaff84076b1">Kind</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>;</span></CodeLine>
<Link id="l03602" /><CodeLine lineNumber="3602"><span class="doxyHighlight">          S = SE.getMinusSCEV(<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>, S);</span></CodeLine>
<Link id="l03603" /><CodeLine lineNumber="3603"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVCouldNotCompute&gt;</a>(S));</span></CodeLine>
<Link id="l03604" /><CodeLine lineNumber="3604"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03605" /><CodeLine lineNumber="3605"></CodeLine>
<Link id="l03606" /><CodeLine lineNumber="3606"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// -1 and the negations of all interesting strides (except the negation</span></CodeLine>
<Link id="l03607" /><CodeLine lineNumber="3607"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// of -1) are now also interesting.</span></CodeLine>
<Link id="l03608" /><CodeLine lineNumber="3608"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = Factors.size(); i != e; ++i)</span></CodeLine>
<Link id="l03609" /><CodeLine lineNumber="3609"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Factors&#91;i&#93; != -1)</span></CodeLine>
<Link id="l03610" /><CodeLine lineNumber="3610"><span class="doxyHighlight">            Factors.insert(-(uint64&#95;t)Factors&#91;i&#93;);</span></CodeLine>
<Link id="l03611" /><CodeLine lineNumber="3611"><span class="doxyHighlight">        Factors.insert(-1);</span></CodeLine>
<Link id="l03612" /><CodeLine lineNumber="3612"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03613" /><CodeLine lineNumber="3613"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03614" /><CodeLine lineNumber="3614"></CodeLine>
<Link id="l03615" /><CodeLine lineNumber="3615"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Get or create an LSRUse.</span></CodeLine>
<Link id="l03616" /><CodeLine lineNumber="3616"><span class="doxyHighlight">    std::pair&lt;size&#95;t, Immediate&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = getUse(S, Kind, AccessTy);</span></CodeLine>
<Link id="l03617" /><CodeLine lineNumber="3617"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first;</span></CodeLine>
<Link id="l03618" /><CodeLine lineNumber="3618"><span class="doxyHighlight">    Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second;</span></CodeLine>
<Link id="l03619" /><CodeLine lineNumber="3619"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l03620" /><CodeLine lineNumber="3620"></CodeLine>
<Link id="l03621" /><CodeLine lineNumber="3621"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Record the fixup.</span></CodeLine>
<Link id="l03622" /><CodeLine lineNumber="3622"><span class="doxyHighlight">    LSRFixup &amp;LF = LU.getNewFixup();</span></CodeLine>
<Link id="l03623" /><CodeLine lineNumber="3623"><span class="doxyHighlight">    LF.UserInst = UserInst;</span></CodeLine>
<Link id="l03624" /><CodeLine lineNumber="3624"><span class="doxyHighlight">    LF.OperandValToReplace = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandValToReplace();</span></CodeLine>
<Link id="l03625" /><CodeLine lineNumber="3625"><span class="doxyHighlight">    LF.PostIncLoops = TmpPostIncLoops;</span></CodeLine>
<Link id="l03626" /><CodeLine lineNumber="3626"><span class="doxyHighlight">    LF.Offset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</span></CodeLine>
<Link id="l03627" /><CodeLine lineNumber="3627"><span class="doxyHighlight">    LU.AllFixupsOutsideLoop &amp;= LF.isUseFullyOutsideLoop(L);</span></CodeLine>
<Link id="l03628" /><CodeLine lineNumber="3628"></CodeLine>
<Link id="l03629" /><CodeLine lineNumber="3629"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Create SCEV as Formula for calculating baseline cost</span></CodeLine>
<Link id="l03630" /><CodeLine lineNumber="3630"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!VisitedLSRUse.<a href="/docs/api/classes/llvm/detail/densesetimpl/#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(LUIdx) &amp;&amp; !LF.isUseFullyOutsideLoop(L)) &#123;</span></CodeLine>
<Link id="l03631" /><CodeLine lineNumber="3631"><span class="doxyHighlight">      Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</span></CodeLine>
<Link id="l03632" /><CodeLine lineNumber="3632"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.initialMatch(S, L, SE);</span></CodeLine>
<Link id="l03633" /><CodeLine lineNumber="3633"><span class="doxyHighlight">      BaselineCost.RateFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Regs, VisitedRegs, LU);</span></CodeLine>
<Link id="l03634" /><CodeLine lineNumber="3634"><span class="doxyHighlight">      VisitedLSRUse.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(LUIdx);</span></CodeLine>
<Link id="l03635" /><CodeLine lineNumber="3635"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03636" /><CodeLine lineNumber="3636"></CodeLine>
<Link id="l03637" /><CodeLine lineNumber="3637"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LU.WidestFixupType ||</span></CodeLine>
<Link id="l03638" /><CodeLine lineNumber="3638"><span class="doxyHighlight">        SE.getTypeSizeInBits(LU.WidestFixupType) &lt;</span></CodeLine>
<Link id="l03639" /><CodeLine lineNumber="3639"><span class="doxyHighlight">        SE.getTypeSizeInBits(LF.OperandValToReplace-&gt;getType()))</span></CodeLine>
<Link id="l03640" /><CodeLine lineNumber="3640"><span class="doxyHighlight">      LU.WidestFixupType = LF.OperandValToReplace-&gt;getType();</span></CodeLine>
<Link id="l03641" /><CodeLine lineNumber="3641"></CodeLine>
<Link id="l03642" /><CodeLine lineNumber="3642"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this is the first use of this LSRUse, give it a formula.</span></CodeLine>
<Link id="l03643" /><CodeLine lineNumber="3643"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Formulae.empty()) &#123;</span></CodeLine>
<Link id="l03644" /><CodeLine lineNumber="3644"><span class="doxyHighlight">      InsertInitialFormula(S, LU, LUIdx);</span></CodeLine>
<Link id="l03645" /><CodeLine lineNumber="3645"><span class="doxyHighlight">      CountRegisters(LU.Formulae.back(), LUIdx);</span></CodeLine>
<Link id="l03646" /><CodeLine lineNumber="3646"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03647" /><CodeLine lineNumber="3647"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03648" /><CodeLine lineNumber="3648"></CodeLine>
<Link id="l03649" /><CodeLine lineNumber="3649"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(print&#95;fixups(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l03650" /><CodeLine lineNumber="3650"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03651" /><CodeLine lineNumber="3651"></CodeLine>
<Link id="l03652" /><CodeLine lineNumber="3652"><span class="doxyHighlightComment">/// Insert a formula for the given expression into the given use, separating out</span></CodeLine>
<Link id="l03653" /><CodeLine lineNumber="3653"><span class="doxyHighlightComment">/// loop-variant portions from loop-invariant and loop-computable portions.</span></CodeLine>
<Link id="l03654" /><CodeLine lineNumber="3654"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::InsertInitialFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, LSRUse &amp;LU,</span></CodeLine>
<Link id="l03655" /><CodeLine lineNumber="3655"><span class="doxyHighlight">                                       </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx) &#123;</span></CodeLine>
<Link id="l03656" /><CodeLine lineNumber="3656"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Mark uses whose expressions cannot be expanded.</span></CodeLine>
<Link id="l03657" /><CodeLine lineNumber="3657"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isSafeToExpand(S))</span></CodeLine>
<Link id="l03658" /><CodeLine lineNumber="3658"><span class="doxyHighlight">    LU.RigidFormula = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03659" /><CodeLine lineNumber="3659"></CodeLine>
<Link id="l03660" /><CodeLine lineNumber="3660"><span class="doxyHighlight">  Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</span></CodeLine>
<Link id="l03661" /><CodeLine lineNumber="3661"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.initialMatch(S, L, SE);</span></CodeLine>
<Link id="l03662" /><CodeLine lineNumber="3662"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a> = InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l03663" /><CodeLine lineNumber="3663"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Inserted &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Initial formula already exists!&quot;</span><span class="doxyHighlight">); (void)Inserted;</span></CodeLine>
<Link id="l03664" /><CodeLine lineNumber="3664"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03665" /><CodeLine lineNumber="3665"></CodeLine>
<Link id="l03666" /><CodeLine lineNumber="3666"><span class="doxyHighlightComment">/// Insert a simple single-register formula for the given expression into the</span></CodeLine>
<Link id="l03667" /><CodeLine lineNumber="3667"><span class="doxyHighlightComment">/// given use.</span></CodeLine>
<Link id="l03668" /><CodeLine lineNumber="3668"><span class="doxyHighlightKeywordType">void</span></CodeLine>
<Link id="l03669" /><CodeLine lineNumber="3669"><span class="doxyHighlight">LSRInstance::InsertSupplementalFormula(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S,</span></CodeLine>
<Link id="l03670" /><CodeLine lineNumber="3670"><span class="doxyHighlight">                                       LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx) &#123;</span></CodeLine>
<Link id="l03671" /><CodeLine lineNumber="3671"><span class="doxyHighlight">  Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</span></CodeLine>
<Link id="l03672" /><CodeLine lineNumber="3672"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.push&#95;back(S);</span></CodeLine>
<Link id="l03673" /><CodeLine lineNumber="3673"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.HasBaseReg = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03674" /><CodeLine lineNumber="3674"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a> = InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l03675" /><CodeLine lineNumber="3675"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Inserted &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Supplemental formula already exists!&quot;</span><span class="doxyHighlight">); (void)Inserted;</span></CodeLine>
<Link id="l03676" /><CodeLine lineNumber="3676"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03677" /><CodeLine lineNumber="3677"></CodeLine>
<Link id="l03678" /><CodeLine lineNumber="3678"><span class="doxyHighlightComment">/// Note which registers are used by the given formula, updating RegUses.</span></CodeLine>
<Link id="l03679" /><CodeLine lineNumber="3679"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::CountRegisters(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx) &#123;</span></CodeLine>
<Link id="l03680" /><CodeLine lineNumber="3680"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg)</span></CodeLine>
<Link id="l03681" /><CodeLine lineNumber="3681"><span class="doxyHighlight">    RegUses.countRegister(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, LUIdx);</span></CodeLine>
<Link id="l03682" /><CodeLine lineNumber="3682"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs)</span></CodeLine>
<Link id="l03683" /><CodeLine lineNumber="3683"><span class="doxyHighlight">    RegUses.countRegister(BaseReg, LUIdx);</span></CodeLine>
<Link id="l03684" /><CodeLine lineNumber="3684"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03685" /><CodeLine lineNumber="3685"></CodeLine>
<Link id="l03686" /><CodeLine lineNumber="3686"><span class="doxyHighlightComment">/// If the given formula has not yet been inserted, add it to the list, and</span></CodeLine>
<Link id="l03687" /><CodeLine lineNumber="3687"><span class="doxyHighlightComment">/// return true. Return false otherwise.</span></CodeLine>
<Link id="l03688" /><CodeLine lineNumber="3688"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> LSRInstance::InsertFormula(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &#123;</span></CodeLine>
<Link id="l03689" /><CodeLine lineNumber="3689"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Do not insert formula that we will not be able to expand.</span></CodeLine>
<Link id="l03690" /><CodeLine lineNumber="3690"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &amp;&amp;</span></CodeLine>
<Link id="l03691" /><CodeLine lineNumber="3691"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Formula is illegal&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03692" /><CodeLine lineNumber="3692"></CodeLine>
<Link id="l03693" /><CodeLine lineNumber="3693"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LU.InsertFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, &#42;L))</span></CodeLine>
<Link id="l03694" /><CodeLine lineNumber="3694"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03695" /><CodeLine lineNumber="3695"></CodeLine>
<Link id="l03696" /><CodeLine lineNumber="3696"><span class="doxyHighlight">  CountRegisters(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, LUIdx);</span></CodeLine>
<Link id="l03697" /><CodeLine lineNumber="3697"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03698" /><CodeLine lineNumber="3698"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03699" /><CodeLine lineNumber="3699"></CodeLine>
<Link id="l03700" /><CodeLine lineNumber="3700"><span class="doxyHighlightComment">/// Check for other uses of loop-invariant values which we&#39;re tracking. These</span></CodeLine>
<Link id="l03701" /><CodeLine lineNumber="3701"><span class="doxyHighlightComment">/// other uses will pin these values in registers, making them less profitable</span></CodeLine>
<Link id="l03702" /><CodeLine lineNumber="3702"><span class="doxyHighlightComment">/// for elimination.</span></CodeLine>
<Link id="l03703" /><CodeLine lineNumber="3703"><span class="doxyHighlightComment">/// TODO: This currently misses non-constant addrec step registers.</span></CodeLine>
<Link id="l03704" /><CodeLine lineNumber="3704"><span class="doxyHighlightComment">/// TODO: Should this give more weight to users inside the loop?</span></CodeLine>
<Link id="l03705" /><CodeLine lineNumber="3705"><span class="doxyHighlightKeywordType">void</span></CodeLine>
<Link id="l03706" /><CodeLine lineNumber="3706"><span class="doxyHighlight">LSRInstance::CollectLoopInvariantFixupsAndFormulae() &#123;</span></CodeLine>
<Link id="l03707" /><CodeLine lineNumber="3707"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> Worklist(RegUses.begin(), RegUses.end());</span></CodeLine>
<Link id="l03708" /><CodeLine lineNumber="3708"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 32&gt;</a> Visited;</span></CodeLine>
<Link id="l03709" /><CodeLine lineNumber="3709"></CodeLine>
<Link id="l03710" /><CodeLine lineNumber="3710"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Don&#39;t collect outside uses if we are favoring postinc - the instructions in</span></CodeLine>
<Link id="l03711" /><CodeLine lineNumber="3711"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the loop are more important than the ones outside of it.</span></CodeLine>
<Link id="l03712" /><CodeLine lineNumber="3712"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>)</span></CodeLine>
<Link id="l03713" /><CodeLine lineNumber="3713"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03714" /><CodeLine lineNumber="3714"></CodeLine>
<Link id="l03715" /><CodeLine lineNumber="3715"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l03716" /><CodeLine lineNumber="3716"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = Worklist.<a href="/docs/api/classes/llvm/smallvectorimpl/#a0c8ffe664a36e30d49c84d0aded2fe08">pop&#95;back&#95;val</a>();</span></CodeLine>
<Link id="l03717" /><CodeLine lineNumber="3717"></CodeLine>
<Link id="l03718" /><CodeLine lineNumber="3718"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Don&#39;t process the same SCEV twice</span></CodeLine>
<Link id="l03719" /><CodeLine lineNumber="3719"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Visited.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(S).second)</span></CodeLine>
<Link id="l03720" /><CodeLine lineNumber="3720"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03721" /><CodeLine lineNumber="3721"></CodeLine>
<Link id="l03722" /><CodeLine lineNumber="3722"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevnaryexpr">SCEVNAryExpr</a> &#42;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVNAryExpr&gt;</a>(S))</span></CodeLine>
<Link id="l03723" /><CodeLine lineNumber="3723"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a39d3d23a084c4544ee5903203db10e8a">append&#95;range</a>(Worklist, <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>-&gt;operands());</span></CodeLine>
<Link id="l03724" /><CodeLine lineNumber="3724"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevintegralcastexpr">SCEVIntegralCastExpr</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVIntegralCastExpr&gt;</a>(S))</span></CodeLine>
<Link id="l03725" /><CodeLine lineNumber="3725"><span class="doxyHighlight">      Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getOperand());</span></CodeLine>
<Link id="l03726" /><CodeLine lineNumber="3726"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevudivexpr">SCEVUDivExpr</a> &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUDivExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l03727" /><CodeLine lineNumber="3727"><span class="doxyHighlight">      Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>-&gt;getLHS());</span></CodeLine>
<Link id="l03728" /><CodeLine lineNumber="3728"><span class="doxyHighlight">      Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a6a9f043784cf87001c84980afa76da82">D</a>-&gt;getRHS());</span></CodeLine>
<Link id="l03729" /><CodeLine lineNumber="3729"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;US = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l03730" /><CodeLine lineNumber="3730"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a> = US-&gt;getValue();</span></CodeLine>
<Link id="l03731" /><CodeLine lineNumber="3731"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(V)) &#123;</span></CodeLine>
<Link id="l03732" /><CodeLine lineNumber="3732"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Look for instructions defined outside the loop.</span></CodeLine>
<Link id="l03733" /><CodeLine lineNumber="3733"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(Inst)) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03734" /><CodeLine lineNumber="3734"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;Constant&gt;</a>(V))</span></CodeLine>
<Link id="l03735" /><CodeLine lineNumber="3735"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Constants can be re-materialized.</span></CodeLine>
<Link id="l03736" /><CodeLine lineNumber="3736"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03737" /><CodeLine lineNumber="3737"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/use">Use</a> &amp;U : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>-&gt;uses()) &#123;</span></CodeLine>
<Link id="l03738" /><CodeLine lineNumber="3738"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;UserInst = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getUser());</span></CodeLine>
<Link id="l03739" /><CodeLine lineNumber="3739"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Ignore non-instructions.</span></CodeLine>
<Link id="l03740" /><CodeLine lineNumber="3740"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!UserInst)</span></CodeLine>
<Link id="l03741" /><CodeLine lineNumber="3741"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03742" /><CodeLine lineNumber="3742"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Don&#39;t bother if the instruction is an EHPad.</span></CodeLine>
<Link id="l03743" /><CodeLine lineNumber="3743"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UserInst-&gt;<a href="/docs/api/classes/llvm/instruction/#a5d3d315f678bc76e43b27d18e5d72829">isEHPad</a>())</span></CodeLine>
<Link id="l03744" /><CodeLine lineNumber="3744"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03745" /><CodeLine lineNumber="3745"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Ignore instructions in other functions (as can happen with</span></CodeLine>
<Link id="l03746" /><CodeLine lineNumber="3746"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Constants).</span></CodeLine>
<Link id="l03747" /><CodeLine lineNumber="3747"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UserInst-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;getParent() != <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getParent())</span></CodeLine>
<Link id="l03748" /><CodeLine lineNumber="3748"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03749" /><CodeLine lineNumber="3749"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Ignore instructions not dominated by the loop.</span></CodeLine>
<Link id="l03750" /><CodeLine lineNumber="3750"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;UseBB = !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(UserInst) ?</span></CodeLine>
<Link id="l03751" /><CodeLine lineNumber="3751"><span class="doxyHighlight">          UserInst-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() :</span></CodeLine>
<Link id="l03752" /><CodeLine lineNumber="3752"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(UserInst)-&gt;getIncomingBlock(</span></CodeLine>
<Link id="l03753" /><CodeLine lineNumber="3753"><span class="doxyHighlight">            <a href="/docs/api/classes/llvm/phinode/#aca414c43a6d42c13998208463637a20d">PHINode::getIncomingValueNumForOperand</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandNo()));</span></CodeLine>
<Link id="l03754" /><CodeLine lineNumber="3754"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DT.dominates(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader(), UseBB))</span></CodeLine>
<Link id="l03755" /><CodeLine lineNumber="3755"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03756" /><CodeLine lineNumber="3756"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Don&#39;t bother if the instruction is in a BB which ends in an EHPad.</span></CodeLine>
<Link id="l03757" /><CodeLine lineNumber="3757"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UseBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a5d3d315f678bc76e43b27d18e5d72829">isEHPad</a>())</span></CodeLine>
<Link id="l03758" /><CodeLine lineNumber="3758"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03759" /><CodeLine lineNumber="3759"></CodeLine>
<Link id="l03760" /><CodeLine lineNumber="3760"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Ignore cases in which the currently-examined value could come from</span></CodeLine>
<Link id="l03761" /><CodeLine lineNumber="3761"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// a basic block terminated with an EHPad. This checks all incoming</span></CodeLine>
<Link id="l03762" /><CodeLine lineNumber="3762"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// blocks of the phi node since it is possible that the same incoming</span></CodeLine>
<Link id="l03763" /><CodeLine lineNumber="3763"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// value comes from multiple basic blocks, only some of which may end</span></CodeLine>
<Link id="l03764" /><CodeLine lineNumber="3764"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// in an EHPad. If any of them do, a subsequent rewrite attempt by this</span></CodeLine>
<Link id="l03765" /><CodeLine lineNumber="3765"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// pass would try to insert instructions into an EHPad, hitting an</span></CodeLine>
<Link id="l03766" /><CodeLine lineNumber="3766"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// assertion.</span></CodeLine>
<Link id="l03767" /><CodeLine lineNumber="3767"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(UserInst)) &#123;</span></CodeLine>
<Link id="l03768" /><CodeLine lineNumber="3768"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;PhiNode = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(UserInst);</span></CodeLine>
<Link id="l03769" /><CodeLine lineNumber="3769"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasIncompatibleEHPTerminatedBlock = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03770" /><CodeLine lineNumber="3770"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;ExpectedValue = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>;</span></CodeLine>
<Link id="l03771" /><CodeLine lineNumber="3771"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; PhiNode-&gt;getNumIncomingValues(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>++) &#123;</span></CodeLine>
<Link id="l03772" /><CodeLine lineNumber="3772"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PhiNode-&gt;getIncomingValue(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) == ExpectedValue) &#123;</span></CodeLine>
<Link id="l03773" /><CodeLine lineNumber="3773"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PhiNode-&gt;getIncomingBlock(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)-&gt;getTerminator()-&gt;isEHPad()) &#123;</span></CodeLine>
<Link id="l03774" /><CodeLine lineNumber="3774"><span class="doxyHighlight">                HasIncompatibleEHPTerminatedBlock = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03775" /><CodeLine lineNumber="3775"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03776" /><CodeLine lineNumber="3776"><span class="doxyHighlight">              &#125;</span></CodeLine>
<Link id="l03777" /><CodeLine lineNumber="3777"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l03778" /><CodeLine lineNumber="3778"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l03779" /><CodeLine lineNumber="3779"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (HasIncompatibleEHPTerminatedBlock) &#123;</span></CodeLine>
<Link id="l03780" /><CodeLine lineNumber="3780"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03781" /><CodeLine lineNumber="3781"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l03782" /><CodeLine lineNumber="3782"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03783" /><CodeLine lineNumber="3783"></CodeLine>
<Link id="l03784" /><CodeLine lineNumber="3784"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Don&#39;t bother rewriting PHIs in catchswitch blocks.</span></CodeLine>
<Link id="l03785" /><CodeLine lineNumber="3785"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(UserInst-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;getTerminator()))</span></CodeLine>
<Link id="l03786" /><CodeLine lineNumber="3786"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03787" /><CodeLine lineNumber="3787"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Ignore uses which are part of other SCEV expressions, to avoid</span></CodeLine>
<Link id="l03788" /><CodeLine lineNumber="3788"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// analyzing them multiple times.</span></CodeLine>
<Link id="l03789" /><CodeLine lineNumber="3789"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.isSCEVable(UserInst-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>())) &#123;</span></CodeLine>
<Link id="l03790" /><CodeLine lineNumber="3790"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;UserS = SE.getSCEV(</span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(UserInst));</span></CodeLine>
<Link id="l03791" /><CodeLine lineNumber="3791"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// If the user is a no-op, look through to its uses.</span></CodeLine>
<Link id="l03792" /><CodeLine lineNumber="3792"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(UserS))</span></CodeLine>
<Link id="l03793" /><CodeLine lineNumber="3793"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03794" /><CodeLine lineNumber="3794"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UserS == US) &#123;</span></CodeLine>
<Link id="l03795" /><CodeLine lineNumber="3795"><span class="doxyHighlight">            Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</span></CodeLine>
<Link id="l03796" /><CodeLine lineNumber="3796"><span class="doxyHighlight">              SE.getUnknown(</span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(UserInst)));</span></CodeLine>
<Link id="l03797" /><CodeLine lineNumber="3797"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03798" /><CodeLine lineNumber="3798"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l03799" /><CodeLine lineNumber="3799"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03800" /><CodeLine lineNumber="3800"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Ignore icmp instructions which are already being analyzed.</span></CodeLine>
<Link id="l03801" /><CodeLine lineNumber="3801"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;ICI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;ICmpInst&gt;</a>(UserInst)) &#123;</span></CodeLine>
<Link id="l03802" /><CodeLine lineNumber="3802"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> OtherIdx = !<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>.getOperandNo();</span></CodeLine>
<Link id="l03803" /><CodeLine lineNumber="3803"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/value">Value</a> &#42;OtherOp = </span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/value">Value</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(ICI-&gt;getOperand(OtherIdx));</span></CodeLine>
<Link id="l03804" /><CodeLine lineNumber="3804"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.hasComputableLoopEvolution(SE.getSCEV(OtherOp), L))</span></CodeLine>
<Link id="l03805" /><CodeLine lineNumber="3805"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03806" /><CodeLine lineNumber="3806"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03807" /><CodeLine lineNumber="3807"></CodeLine>
<Link id="l03808" /><CodeLine lineNumber="3808"><span class="doxyHighlight">        std::pair&lt;size&#95;t, Immediate&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> =</span></CodeLine>
<Link id="l03809" /><CodeLine lineNumber="3809"><span class="doxyHighlight">            getUse(S, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a>, MemAccessTy());</span></CodeLine>
<Link id="l03810" /><CodeLine lineNumber="3810"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first;</span></CodeLine>
<Link id="l03811" /><CodeLine lineNumber="3811"><span class="doxyHighlight">        Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second;</span></CodeLine>
<Link id="l03812" /><CodeLine lineNumber="3812"><span class="doxyHighlight">        LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l03813" /><CodeLine lineNumber="3813"><span class="doxyHighlight">        LSRFixup &amp;LF = LU.getNewFixup();</span></CodeLine>
<Link id="l03814" /><CodeLine lineNumber="3814"><span class="doxyHighlight">        LF.UserInst = </span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(UserInst);</span></CodeLine>
<Link id="l03815" /><CodeLine lineNumber="3815"><span class="doxyHighlight">        LF.OperandValToReplace = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>;</span></CodeLine>
<Link id="l03816" /><CodeLine lineNumber="3816"><span class="doxyHighlight">        LF.Offset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</span></CodeLine>
<Link id="l03817" /><CodeLine lineNumber="3817"><span class="doxyHighlight">        LU.AllFixupsOutsideLoop &amp;= LF.isUseFullyOutsideLoop(L);</span></CodeLine>
<Link id="l03818" /><CodeLine lineNumber="3818"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LU.WidestFixupType ||</span></CodeLine>
<Link id="l03819" /><CodeLine lineNumber="3819"><span class="doxyHighlight">            SE.getTypeSizeInBits(LU.WidestFixupType) &lt;</span></CodeLine>
<Link id="l03820" /><CodeLine lineNumber="3820"><span class="doxyHighlight">            SE.getTypeSizeInBits(LF.OperandValToReplace-&gt;getType()))</span></CodeLine>
<Link id="l03821" /><CodeLine lineNumber="3821"><span class="doxyHighlight">          LU.WidestFixupType = LF.OperandValToReplace-&gt;getType();</span></CodeLine>
<Link id="l03822" /><CodeLine lineNumber="3822"><span class="doxyHighlight">        InsertSupplementalFormula(US, LU, LUIdx);</span></CodeLine>
<Link id="l03823" /><CodeLine lineNumber="3823"><span class="doxyHighlight">        CountRegisters(LU.Formulae.back(), <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size() - 1);</span></CodeLine>
<Link id="l03824" /><CodeLine lineNumber="3824"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03825" /><CodeLine lineNumber="3825"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03826" /><CodeLine lineNumber="3826"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03827" /><CodeLine lineNumber="3827"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03828" /><CodeLine lineNumber="3828"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03829" /><CodeLine lineNumber="3829"></CodeLine>
<Link id="l03830" /><CodeLine lineNumber="3830"><span class="doxyHighlightComment">/// Split S into subexpressions which can be pulled out into separate</span></CodeLine>
<Link id="l03831" /><CodeLine lineNumber="3831"><span class="doxyHighlightComment">/// registers. If C is non-null, multiply each subexpression by C.</span></CodeLine>
<Link id="l03832" /><CodeLine lineNumber="3832"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03833" /><CodeLine lineNumber="3833"><span class="doxyHighlightComment">/// Return remainder expression after factoring the subexpressions captured by</span></CodeLine>
<Link id="l03834" /><CodeLine lineNumber="3834"><span class="doxyHighlightComment">/// Ops. If Ops is complete, return NULL.</span></CodeLine>
<Link id="l03835" /><CodeLine lineNumber="3835" lineLink="#ad0531a07d7868c1577980524cf2add3a"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>,</span></CodeLine>
<Link id="l03836" /><CodeLine lineNumber="3836"><span class="doxyHighlight">                                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const SCEV &#42;&gt;</a> &amp;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>,</span></CodeLine>
<Link id="l03837" /><CodeLine lineNumber="3837"><span class="doxyHighlight">                                   </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L,</span></CodeLine>
<Link id="l03838" /><CodeLine lineNumber="3838"><span class="doxyHighlight">                                   <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</span></CodeLine>
<Link id="l03839" /><CodeLine lineNumber="3839"><span class="doxyHighlight">                                   </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> = 0) &#123;</span></CodeLine>
<Link id="l03840" /><CodeLine lineNumber="3840"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Arbitrarily cap recursion to protect compile time.</span></CodeLine>
<Link id="l03841" /><CodeLine lineNumber="3841"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> &gt;= 3)</span></CodeLine>
<Link id="l03842" /><CodeLine lineNumber="3842"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> S;</span></CodeLine>
<Link id="l03843" /><CodeLine lineNumber="3843"></CodeLine>
<Link id="l03844" /><CodeLine lineNumber="3844"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;<a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l03845" /><CodeLine lineNumber="3845"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Break out add operands.</span></CodeLine>
<Link id="l03846" /><CodeLine lineNumber="3846"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : <a href="/docs/api/namespaces/llvm/#aac36edd0f1ce976f0025c98e88d3830eaec211f7c20af43e742bf2570c3cb84f9">Add</a>-&gt;operands()) &#123;</span></CodeLine>
<Link id="l03847" /><CodeLine lineNumber="3847"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder = <a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(S, <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>, L, SE, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>+1);</span></CodeLine>
<Link id="l03848" /><CodeLine lineNumber="3848"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Remainder)</span></CodeLine>
<Link id="l03849" /><CodeLine lineNumber="3849"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> ? SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, Remainder) : Remainder);</span></CodeLine>
<Link id="l03850" /><CodeLine lineNumber="3850"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03851" /><CodeLine lineNumber="3851"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03852" /><CodeLine lineNumber="3852"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l03853" /><CodeLine lineNumber="3853"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Split a non-zero base out of an addrec.</span></CodeLine>
<Link id="l03854" /><CodeLine lineNumber="3854"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>()-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>() || !AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>())</span></CodeLine>
<Link id="l03855" /><CodeLine lineNumber="3855"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> S;</span></CodeLine>
<Link id="l03856" /><CodeLine lineNumber="3856"></CodeLine>
<Link id="l03857" /><CodeLine lineNumber="3857"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder = <a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>(),</span></CodeLine>
<Link id="l03858" /><CodeLine lineNumber="3858"><span class="doxyHighlight">                                            <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>, L, SE, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>+1);</span></CodeLine>
<Link id="l03859" /><CodeLine lineNumber="3859"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Split the non-zero AddRec unless it is part of a nested recurrence that</span></CodeLine>
<Link id="l03860" /><CodeLine lineNumber="3860"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// does not pertain to this loop.</span></CodeLine>
<Link id="l03861" /><CodeLine lineNumber="3861"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Remainder &amp;&amp; (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L || !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(Remainder))) &#123;</span></CodeLine>
<Link id="l03862" /><CodeLine lineNumber="3862"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> ? SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, Remainder) : Remainder);</span></CodeLine>
<Link id="l03863" /><CodeLine lineNumber="3863"><span class="doxyHighlight">      Remainder = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03864" /><CodeLine lineNumber="3864"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03865" /><CodeLine lineNumber="3865"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Remainder != AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>()) &#123;</span></CodeLine>
<Link id="l03866" /><CodeLine lineNumber="3866"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Remainder)</span></CodeLine>
<Link id="l03867" /><CodeLine lineNumber="3867"><span class="doxyHighlight">        Remainder = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a2eb94d079d8416118f4aaed865ab05d7">getConstant</a>(AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>(), 0);</span></CodeLine>
<Link id="l03868" /><CodeLine lineNumber="3868"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SE.<a href="/docs/api/classes/llvm/scalarevolution/#a659b27f6737fcb7eaf333b0279da1154">getAddRecExpr</a>(Remainder,</span></CodeLine>
<Link id="l03869" /><CodeLine lineNumber="3869"><span class="doxyHighlight">                              AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE),</span></CodeLine>
<Link id="l03870" /><CodeLine lineNumber="3870"><span class="doxyHighlight">                              AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>(),</span></CodeLine>
<Link id="l03871" /><CodeLine lineNumber="3871"><span class="doxyHighlight">                              </span><span class="doxyHighlightComment">//FIXME: AR-&gt;getNoWrapFlags(SCEV::FlagNW)</span></CodeLine>
<Link id="l03872" /><CodeLine lineNumber="3872"><span class="doxyHighlight">                              <a href="/docs/api/classes/llvm/scev/#af43000d4dcb7d6d63cb6e36933ed3f6fa23e74052c4d79cfdaa23460a3c946656">SCEV::FlagAnyWrap</a>);</span></CodeLine>
<Link id="l03873" /><CodeLine lineNumber="3873"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03874" /><CodeLine lineNumber="3874"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l03875" /><CodeLine lineNumber="3875"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Break (C &#42; (a + b + c)) into C&#42;a + C&#42;b + C&#42;c.</span></CodeLine>
<Link id="l03876" /><CodeLine lineNumber="3876"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getNumOperands() != 2)</span></CodeLine>
<Link id="l03877" /><CodeLine lineNumber="3877"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> S;</span></CodeLine>
<Link id="l03878" /><CodeLine lineNumber="3878"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;Op0 =</span></CodeLine>
<Link id="l03879" /><CodeLine lineNumber="3879"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(0))) &#123;</span></CodeLine>
<Link id="l03880" /><CodeLine lineNumber="3880"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> ? <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVConstant&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, Op0)) : Op0;</span></CodeLine>
<Link id="l03881" /><CodeLine lineNumber="3881"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder =</span></CodeLine>
<Link id="l03882" /><CodeLine lineNumber="3882"><span class="doxyHighlight">        <a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#ae0f503db91504a3f3440ab81260e4134">Mul</a>-&gt;getOperand(1), <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>, L, SE, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>+1);</span></CodeLine>
<Link id="l03883" /><CodeLine lineNumber="3883"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Remainder)</span></CodeLine>
<Link id="l03884" /><CodeLine lineNumber="3884"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.<a href="/docs/api/classes/llvm/scalarevolution/#ad299b0f4378f644f67168c72c763716f">getMulExpr</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, Remainder));</span></CodeLine>
<Link id="l03885" /><CodeLine lineNumber="3885"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03886" /><CodeLine lineNumber="3886"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03887" /><CodeLine lineNumber="3887"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03888" /><CodeLine lineNumber="3888"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> S;</span></CodeLine>
<Link id="l03889" /><CodeLine lineNumber="3889"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03890" /><CodeLine lineNumber="3890"></CodeLine>
<Link id="l03891" /><CodeLine lineNumber="3891"><span class="doxyHighlightComment">/// Return true if the SCEV represents a value that may end up as a</span></CodeLine>
<Link id="l03892" /><CodeLine lineNumber="3892"><span class="doxyHighlightComment">/// post-increment operation.</span></CodeLine>
<Link id="l03893" /><CodeLine lineNumber="3893" lineLink="#a187751c86d349fac41ddc1b807b40b22"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a187751c86d349fac41ddc1b807b40b22">mayUsePostIncMode</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l03894" /><CodeLine lineNumber="3894"><span class="doxyHighlight">                              LSRUse &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L,</span></CodeLine>
<Link id="l03895" /><CodeLine lineNumber="3895"><span class="doxyHighlight">                              <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l03896" /><CodeLine lineNumber="3896"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> ||</span></CodeLine>
<Link id="l03897" /><CodeLine lineNumber="3897"><span class="doxyHighlight">      !LU.AccessTy.getType()-&gt;isIntOrIntVectorTy())</span></CodeLine>
<Link id="l03898" /><CodeLine lineNumber="3898"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03899" /><CodeLine lineNumber="3899"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(S);</span></CodeLine>
<Link id="l03900" /><CodeLine lineNumber="3900"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!AR)</span></CodeLine>
<Link id="l03901" /><CodeLine lineNumber="3901"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03902" /><CodeLine lineNumber="3902"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LoopStep = AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE);</span></CodeLine>
<Link id="l03903" /><CodeLine lineNumber="3903"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(LoopStep))</span></CodeLine>
<Link id="l03904" /><CodeLine lineNumber="3904"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03905" /><CodeLine lineNumber="3905"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check if a post-indexed load/store can be used.</span></CodeLine>
<Link id="l03906" /><CodeLine lineNumber="3906"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedLoadLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>()) ||</span></CodeLine>
<Link id="l03907" /><CodeLine lineNumber="3907"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedStoreLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a1596600146d065022af8b9c4a1d0b427">getType</a>())) &#123;</span></CodeLine>
<Link id="l03908" /><CodeLine lineNumber="3908"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;LoopStart = AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>();</span></CodeLine>
<Link id="l03909" /><CodeLine lineNumber="3909"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(LoopStart) &amp;&amp; SE.<a href="/docs/api/classes/llvm/scalarevolution/#a5a19768af81df7e5fe571bc08dcd48b3">isLoopInvariant</a>(LoopStart, L))</span></CodeLine>
<Link id="l03910" /><CodeLine lineNumber="3910"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03911" /><CodeLine lineNumber="3911"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03912" /><CodeLine lineNumber="3912"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03913" /><CodeLine lineNumber="3913"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03914" /><CodeLine lineNumber="3914"></CodeLine>
<Link id="l03915" /><CodeLine lineNumber="3915"><span class="doxyHighlightComment">/// Helper function for LSRInstance::GenerateReassociations.</span></CodeLine>
<Link id="l03916" /><CodeLine lineNumber="3916"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateReassociationsImpl(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l03917" /><CodeLine lineNumber="3917"><span class="doxyHighlight">                                             </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</span></CodeLine>
<Link id="l03918" /><CodeLine lineNumber="3918"><span class="doxyHighlight">                                             </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> Idx,</span></CodeLine>
<Link id="l03919" /><CodeLine lineNumber="3919"><span class="doxyHighlight">                                             </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsScaledReg) &#123;</span></CodeLine>
<Link id="l03920" /><CodeLine lineNumber="3920"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg = IsScaledReg ? <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;Idx&#93;;</span></CodeLine>
<Link id="l03921" /><CodeLine lineNumber="3921"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Don&#39;t generate reassociations for the base register of a value that</span></CodeLine>
<Link id="l03922" /><CodeLine lineNumber="3922"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// may generate a post-increment operator. The reason is that the</span></CodeLine>
<Link id="l03923" /><CodeLine lineNumber="3923"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// reassociations cause extra base+register formula to be created,</span></CodeLine>
<Link id="l03924" /><CodeLine lineNumber="3924"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// and possibly chosen, but the post-increment is more efficient.</span></CodeLine>
<Link id="l03925" /><CodeLine lineNumber="3925"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a> &amp;&amp; <a href="#a187751c86d349fac41ddc1b807b40b22">mayUsePostIncMode</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU, BaseReg, L, SE))</span></CodeLine>
<Link id="l03926" /><CodeLine lineNumber="3926"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03927" /><CodeLine lineNumber="3927"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> AddOps;</span></CodeLine>
<Link id="l03928" /><CodeLine lineNumber="3928"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Remainder = <a href="#ad0531a07d7868c1577980524cf2add3a">CollectSubexprs</a>(BaseReg, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, AddOps, L, SE);</span></CodeLine>
<Link id="l03929" /><CodeLine lineNumber="3929"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Remainder)</span></CodeLine>
<Link id="l03930" /><CodeLine lineNumber="3930"><span class="doxyHighlight">    AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Remainder);</span></CodeLine>
<Link id="l03931" /><CodeLine lineNumber="3931"></CodeLine>
<Link id="l03932" /><CodeLine lineNumber="3932"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == 1)</span></CodeLine>
<Link id="l03933" /><CodeLine lineNumber="3933"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03934" /><CodeLine lineNumber="3934"></CodeLine>
<Link id="l03935" /><CodeLine lineNumber="3935"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/smallvectorimpl/#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;const SCEV &#42;&gt;::const&#95;iterator</a> J = AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(),</span></CodeLine>
<Link id="l03936" /><CodeLine lineNumber="3936"><span class="doxyHighlight">                                                     JE = AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>();</span></CodeLine>
<Link id="l03937" /><CodeLine lineNumber="3937"><span class="doxyHighlight">       J != JE; ++J) &#123;</span></CodeLine>
<Link id="l03938" /><CodeLine lineNumber="3938"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Loop-variant &quot;unknown&quot; values are uninteresting; we won&#39;t be able to</span></CodeLine>
<Link id="l03939" /><CodeLine lineNumber="3939"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// do anything meaningful with them.</span></CodeLine>
<Link id="l03940" /><CodeLine lineNumber="3940"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVUnknown&gt;</a>(&#42;J) &amp;&amp; !SE.isLoopInvariant(&#42;J, L))</span></CodeLine>
<Link id="l03941" /><CodeLine lineNumber="3941"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03942" /><CodeLine lineNumber="3942"></CodeLine>
<Link id="l03943" /><CodeLine lineNumber="3943"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Don&#39;t pull a constant into a register if the constant could be folded</span></CodeLine>
<Link id="l03944" /><CodeLine lineNumber="3944"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// into an immediate field.</span></CodeLine>
<Link id="l03945" /><CodeLine lineNumber="3945"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, SE, LU.MinOffset, LU.MaxOffset, LU.Kind,</span></CodeLine>
<Link id="l03946" /><CodeLine lineNumber="3946"><span class="doxyHighlight">                         LU.AccessTy, &#42;J, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getNumRegs() &gt; 1))</span></CodeLine>
<Link id="l03947" /><CodeLine lineNumber="3947"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03948" /><CodeLine lineNumber="3948"></CodeLine>
<Link id="l03949" /><CodeLine lineNumber="3949"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Collect all operands except &#42;J.</span></CodeLine>
<Link id="l03950" /><CodeLine lineNumber="3950"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> InnerAddOps(</span></CodeLine>
<Link id="l03951" /><CodeLine lineNumber="3951"><span class="doxyHighlight">        ((</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> &amp;)AddOps).<a href="/docs/api/namespaces/llvm/sandboxir/#a2fdb10193ae65fe59b4d8df288044864">begin</a>(), J);</span></CodeLine>
<Link id="l03952" /><CodeLine lineNumber="3952"><span class="doxyHighlight">    InnerAddOps.append(std::next(J),</span></CodeLine>
<Link id="l03953" /><CodeLine lineNumber="3953"><span class="doxyHighlight">                       ((</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> &amp;)AddOps).<a href="/docs/api/namespaces/llvm/sandboxir/#a64ac61287490361f2183faf1d7639ee9">end</a>());</span></CodeLine>
<Link id="l03954" /><CodeLine lineNumber="3954"></CodeLine>
<Link id="l03955" /><CodeLine lineNumber="3955"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Don&#39;t leave just a constant behind in a register if the constant could</span></CodeLine>
<Link id="l03956" /><CodeLine lineNumber="3956"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// be folded into an immediate field.</span></CodeLine>
<Link id="l03957" /><CodeLine lineNumber="3957"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InnerAddOps.size() == 1 &amp;&amp;</span></CodeLine>
<Link id="l03958" /><CodeLine lineNumber="3958"><span class="doxyHighlight">        <a href="#a626659c8868b0e423f831bfc2b98091e">isAlwaysFoldable</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, SE, LU.MinOffset, LU.MaxOffset, LU.Kind,</span></CodeLine>
<Link id="l03959" /><CodeLine lineNumber="3959"><span class="doxyHighlight">                         LU.AccessTy, InnerAddOps&#91;0&#93;, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getNumRegs() &gt; 1))</span></CodeLine>
<Link id="l03960" /><CodeLine lineNumber="3960"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03961" /><CodeLine lineNumber="3961"></CodeLine>
<Link id="l03962" /><CodeLine lineNumber="3962"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;InnerSum = SE.getAddExpr(InnerAddOps);</span></CodeLine>
<Link id="l03963" /><CodeLine lineNumber="3963"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InnerSum-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</span></CodeLine>
<Link id="l03964" /><CodeLine lineNumber="3964"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03965" /><CodeLine lineNumber="3965"><span class="doxyHighlight">    Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l03966" /><CodeLine lineNumber="3966"></CodeLine>
<Link id="l03967" /><CodeLine lineNumber="3967"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isNonZero() &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isScalable())</span></CodeLine>
<Link id="l03968" /><CodeLine lineNumber="3968"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03969" /><CodeLine lineNumber="3969"></CodeLine>
<Link id="l03970" /><CodeLine lineNumber="3970"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Add the remaining pieces of the add back into the new formula.</span></CodeLine>
<Link id="l03971" /><CodeLine lineNumber="3971"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;InnerSumSC = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(InnerSum);</span></CodeLine>
<Link id="l03972" /><CodeLine lineNumber="3972"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InnerSumSC &amp;&amp; SE.getTypeSizeInBits(InnerSumSC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a35e59d0864faf0a0ccb63421a8f60183">getType</a>()) &lt;= 64 &amp;&amp;</span></CodeLine>
<Link id="l03973" /><CodeLine lineNumber="3973"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddImmediate((uint64&#95;t)<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() +</span></CodeLine>
<Link id="l03974" /><CodeLine lineNumber="3974"><span class="doxyHighlight">                                InnerSumSC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a476a7aca5d55536fcbfb498dfe5d380d">getValue</a>()-&gt;<a href="/docs/api/classes/llvm/constantint/#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>())) &#123;</span></CodeLine>
<Link id="l03975" /><CodeLine lineNumber="3975"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset =</span></CodeLine>
<Link id="l03976" /><CodeLine lineNumber="3976"><span class="doxyHighlight">          <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>((uint64&#95;t)<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() +</span></CodeLine>
<Link id="l03977" /><CodeLine lineNumber="3977"><span class="doxyHighlight">                              InnerSumSC-&gt;<a href="/docs/api/classes/llvm/scevconstant/#a476a7aca5d55536fcbfb498dfe5d380d">getValue</a>()-&gt;<a href="/docs/api/classes/llvm/constantint/#ac09a21c371a9c535cbc13e8f82503aec">getZExtValue</a>());</span></CodeLine>
<Link id="l03978" /><CodeLine lineNumber="3978"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsScaledReg) &#123;</span></CodeLine>
<Link id="l03979" /><CodeLine lineNumber="3979"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03980" /><CodeLine lineNumber="3980"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale = 0;</span></CodeLine>
<Link id="l03981" /><CodeLine lineNumber="3981"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l03982" /><CodeLine lineNumber="3982"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.erase(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin() + Idx);</span></CodeLine>
<Link id="l03983" /><CodeLine lineNumber="3983"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsScaledReg)</span></CodeLine>
<Link id="l03984" /><CodeLine lineNumber="3984"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = InnerSum;</span></CodeLine>
<Link id="l03985" /><CodeLine lineNumber="3985"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l03986" /><CodeLine lineNumber="3986"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93; = InnerSum;</span></CodeLine>
<Link id="l03987" /><CodeLine lineNumber="3987"></CodeLine>
<Link id="l03988" /><CodeLine lineNumber="3988"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Add J as its own register, or an unfolded immediate.</span></CodeLine>
<Link id="l03989" /><CodeLine lineNumber="3989"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/ppcisd/#ad1c32e5bb1cb213fb836bc3d221e4f19a2ae057e4de45c51c89b7e5dc5053df62">SC</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(&#42;J);</span></CodeLine>
<Link id="l03990" /><CodeLine lineNumber="3990"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SC &amp;&amp; SE.getTypeSizeInBits(<a href="/docs/api/namespaces/llvm/ppcisd/#ad1c32e5bb1cb213fb836bc3d221e4f19a2ae057e4de45c51c89b7e5dc5053df62">SC</a>-&gt;getType()) &lt;= 64 &amp;&amp;</span></CodeLine>
<Link id="l03991" /><CodeLine lineNumber="3991"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddImmediate((uint64&#95;t)<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() +</span></CodeLine>
<Link id="l03992" /><CodeLine lineNumber="3992"><span class="doxyHighlight">                                <a href="/docs/api/namespaces/llvm/ppcisd/#ad1c32e5bb1cb213fb836bc3d221e4f19a2ae057e4de45c51c89b7e5dc5053df62">SC</a>-&gt;getValue()-&gt;getZExtValue()))</span></CodeLine>
<Link id="l03993" /><CodeLine lineNumber="3993"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset =</span></CodeLine>
<Link id="l03994" /><CodeLine lineNumber="3994"><span class="doxyHighlight">          <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>((uint64&#95;t)<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() +</span></CodeLine>
<Link id="l03995" /><CodeLine lineNumber="3995"><span class="doxyHighlight">                              <a href="/docs/api/namespaces/llvm/ppcisd/#ad1c32e5bb1cb213fb836bc3d221e4f19a2ae057e4de45c51c89b7e5dc5053df62">SC</a>-&gt;getValue()-&gt;getZExtValue());</span></CodeLine>
<Link id="l03996" /><CodeLine lineNumber="3996"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l03997" /><CodeLine lineNumber="3997"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.push&#95;back(&#42;J);</span></CodeLine>
<Link id="l03998" /><CodeLine lineNumber="3998"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We may have changed the number of register in base regs, adjust the</span></CodeLine>
<Link id="l03999" /><CodeLine lineNumber="3999"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// formula accordingly.</span></CodeLine>
<Link id="l04000" /><CodeLine lineNumber="4000"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</span></CodeLine>
<Link id="l04001" /><CodeLine lineNumber="4001"></CodeLine>
<Link id="l04002" /><CodeLine lineNumber="4002"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</span></CodeLine>
<Link id="l04003" /><CodeLine lineNumber="4003"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If that formula hadn&#39;t been seen before, recurse to find more like</span></CodeLine>
<Link id="l04004" /><CodeLine lineNumber="4004"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// it.</span></CodeLine>
<Link id="l04005" /><CodeLine lineNumber="4005"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Add check on Log16(AddOps.size()) - same as Log2&#95;32(AddOps.size()) &gt;&gt; 2)</span></CodeLine>
<Link id="l04006" /><CodeLine lineNumber="4006"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Because just Depth is not enough to bound compile time.</span></CodeLine>
<Link id="l04007" /><CodeLine lineNumber="4007"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// This means that every time AddOps.size() is greater 16^x we will add</span></CodeLine>
<Link id="l04008" /><CodeLine lineNumber="4008"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// x to Depth.</span></CodeLine>
<Link id="l04009" /><CodeLine lineNumber="4009"><span class="doxyHighlight">      GenerateReassociations(LU, LUIdx, LU.Formulae.back(),</span></CodeLine>
<Link id="l04010" /><CodeLine lineNumber="4010"><span class="doxyHighlight">                             <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> + 1 + (<a href="/docs/api/namespaces/llvm/#a646986783f35e0fef8988f0f28d2589f">Log2&#95;32</a>(AddOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>()) &gt;&gt; 2));</span></CodeLine>
<Link id="l04011" /><CodeLine lineNumber="4011"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04012" /><CodeLine lineNumber="4012"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04013" /><CodeLine lineNumber="4013"></CodeLine>
<Link id="l04014" /><CodeLine lineNumber="4014"><span class="doxyHighlightComment">/// Split out subexpressions from adds and the bases of addrecs.</span></CodeLine>
<Link id="l04015" /><CodeLine lineNumber="4015"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateReassociations(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l04016" /><CodeLine lineNumber="4016"><span class="doxyHighlight">                                         Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>) &#123;</span></CodeLine>
<Link id="l04017" /><CodeLine lineNumber="4017"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.isCanonical(&#42;L) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Input must be in the canonical form&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04018" /><CodeLine lineNumber="4018"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Arbitrarily cap recursion to protect compile time.</span></CodeLine>
<Link id="l04019" /><CodeLine lineNumber="4019"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a> &gt;= 3)</span></CodeLine>
<Link id="l04020" /><CodeLine lineNumber="4020"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04021" /><CodeLine lineNumber="4021"></CodeLine>
<Link id="l04022" /><CodeLine lineNumber="4022"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size(); i != e; ++i)</span></CodeLine>
<Link id="l04023" /><CodeLine lineNumber="4023"><span class="doxyHighlight">    GenerateReassociationsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>, i);</span></CodeLine>
<Link id="l04024" /><CodeLine lineNumber="4024"></CodeLine>
<Link id="l04025" /><CodeLine lineNumber="4025"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 1)</span></CodeLine>
<Link id="l04026" /><CodeLine lineNumber="4026"><span class="doxyHighlight">    GenerateReassociationsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, <a href="/docs/api/namespaces/llvm/#a1eb5609345b906d024fbf9e4bc1adc06afe578efb7ca235af77fb0eef7edcf639">Depth</a>,</span></CodeLine>
<Link id="l04027" /><CodeLine lineNumber="4027"><span class="doxyHighlight">                               </span><span class="doxyHighlightComment">/&#42; Idx &#42;/</span><span class="doxyHighlight"> -1, </span><span class="doxyHighlightComment">/&#42; IsScaledReg &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04028" /><CodeLine lineNumber="4028"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04029" /><CodeLine lineNumber="4029"></CodeLine>
<Link id="l04030" /><CodeLine lineNumber="4030"><span class="doxyHighlightComment">///  Generate a formula consisting of all of the loop-dominating registers added</span></CodeLine>
<Link id="l04031" /><CodeLine lineNumber="4031"><span class="doxyHighlightComment">/// into a single register.</span></CodeLine>
<Link id="l04032" /><CodeLine lineNumber="4032"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateCombinations(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l04033" /><CodeLine lineNumber="4033"><span class="doxyHighlight">                                       Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</span></CodeLine>
<Link id="l04034" /><CodeLine lineNumber="4034"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This method is only interesting on a plurality of registers.</span></CodeLine>
<Link id="l04035" /><CodeLine lineNumber="4035"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size() + (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 1) +</span></CodeLine>
<Link id="l04036" /><CodeLine lineNumber="4036"><span class="doxyHighlight">          (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.UnfoldedOffset.isNonZero()) &lt;=</span></CodeLine>
<Link id="l04037" /><CodeLine lineNumber="4037"><span class="doxyHighlight">      1)</span></CodeLine>
<Link id="l04038" /><CodeLine lineNumber="4038"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04039" /><CodeLine lineNumber="4039"></CodeLine>
<Link id="l04040" /><CodeLine lineNumber="4040"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Flatten the representation, i.e., reg1 + 1&#42;reg2 =&gt; reg1 + reg2, before</span></CodeLine>
<Link id="l04041" /><CodeLine lineNumber="4041"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// processing the formula.</span></CodeLine>
<Link id="l04042" /><CodeLine lineNumber="4042"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.unscale();</span></CodeLine>
<Link id="l04043" /><CodeLine lineNumber="4043"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</span></CodeLine>
<Link id="l04044" /><CodeLine lineNumber="4044"><span class="doxyHighlight">  Formula NewBase = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l04045" /><CodeLine lineNumber="4045"><span class="doxyHighlight">  NewBase.BaseRegs.clear();</span></CodeLine>
<Link id="l04046" /><CodeLine lineNumber="4046"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;CombinedIntegerType = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04047" /><CodeLine lineNumber="4047"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs) &#123;</span></CodeLine>
<Link id="l04048" /><CodeLine lineNumber="4048"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.properlyDominates(BaseReg, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()) &amp;&amp;</span></CodeLine>
<Link id="l04049" /><CodeLine lineNumber="4049"><span class="doxyHighlight">        !SE.hasComputableLoopEvolution(BaseReg, L)) &#123;</span></CodeLine>
<Link id="l04050" /><CodeLine lineNumber="4050"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!CombinedIntegerType)</span></CodeLine>
<Link id="l04051" /><CodeLine lineNumber="4051"><span class="doxyHighlight">        CombinedIntegerType = SE.getEffectiveSCEVType(BaseReg-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>());</span></CodeLine>
<Link id="l04052" /><CodeLine lineNumber="4052"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(BaseReg);</span></CodeLine>
<Link id="l04053" /><CodeLine lineNumber="4053"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04054" /><CodeLine lineNumber="4054"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04055" /><CodeLine lineNumber="4055"><span class="doxyHighlight">      NewBase.BaseRegs.push&#95;back(BaseReg);</span></CodeLine>
<Link id="l04056" /><CodeLine lineNumber="4056"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04057" /><CodeLine lineNumber="4057"></CodeLine>
<Link id="l04058" /><CodeLine lineNumber="4058"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If no register is relevant, we&#39;re done.</span></CodeLine>
<Link id="l04059" /><CodeLine lineNumber="4059"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.size() == 0)</span></CodeLine>
<Link id="l04060" /><CodeLine lineNumber="4060"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04061" /><CodeLine lineNumber="4061"></CodeLine>
<Link id="l04062" /><CodeLine lineNumber="4062"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Utility function for generating the required variants of the combined</span></CodeLine>
<Link id="l04063" /><CodeLine lineNumber="4063"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// registers.</span></CodeLine>
<Link id="l04064" /><CodeLine lineNumber="4064"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> GenerateFormula = &#91;&amp;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Sum) &#123;</span></CodeLine>
<Link id="l04065" /><CodeLine lineNumber="4065"><span class="doxyHighlight">    Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = NewBase;</span></CodeLine>
<Link id="l04066" /><CodeLine lineNumber="4066"></CodeLine>
<Link id="l04067" /><CodeLine lineNumber="4067"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// TODO: If Sum is zero, it probably means ScalarEvolution missed an</span></CodeLine>
<Link id="l04068" /><CodeLine lineNumber="4068"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// opportunity to fold something. For now, just ignore such cases</span></CodeLine>
<Link id="l04069" /><CodeLine lineNumber="4069"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// rather than proceed with zero in a register.</span></CodeLine>
<Link id="l04070" /><CodeLine lineNumber="4070"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Sum-&gt;isZero())</span></CodeLine>
<Link id="l04071" /><CodeLine lineNumber="4071"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04072" /><CodeLine lineNumber="4072"></CodeLine>
<Link id="l04073" /><CodeLine lineNumber="4073"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.push&#95;back(Sum);</span></CodeLine>
<Link id="l04074" /><CodeLine lineNumber="4074"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</span></CodeLine>
<Link id="l04075" /><CodeLine lineNumber="4075"><span class="doxyHighlight">    (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04076" /><CodeLine lineNumber="4076"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l04077" /><CodeLine lineNumber="4077"></CodeLine>
<Link id="l04078" /><CodeLine lineNumber="4078"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we collected at least two registers, generate a formula combining them.</span></CodeLine>
<Link id="l04079" /><CodeLine lineNumber="4079"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.size() &gt; 1) &#123;</span></CodeLine>
<Link id="l04080" /><CodeLine lineNumber="4080"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> OpsCopy(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>); </span><span class="doxyHighlightComment">// Don&#39;t let SE modify Ops.</span></CodeLine>
<Link id="l04081" /><CodeLine lineNumber="4081"><span class="doxyHighlight">    GenerateFormula(SE.getAddExpr(OpsCopy));</span></CodeLine>
<Link id="l04082" /><CodeLine lineNumber="4082"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04083" /><CodeLine lineNumber="4083"></CodeLine>
<Link id="l04084" /><CodeLine lineNumber="4084"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we have an unfolded offset, generate a formula combining it with the</span></CodeLine>
<Link id="l04085" /><CodeLine lineNumber="4085"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// registers collected.</span></CodeLine>
<Link id="l04086" /><CodeLine lineNumber="4086"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewBase.UnfoldedOffset.isNonZero() &amp;&amp; NewBase.UnfoldedOffset.isFixed()) &#123;</span></CodeLine>
<Link id="l04087" /><CodeLine lineNumber="4087"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(CombinedIntegerType &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Missing a type for the unfolded offset&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04088" /><CodeLine lineNumber="4088"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getConstant(CombinedIntegerType,</span></CodeLine>
<Link id="l04089" /><CodeLine lineNumber="4089"><span class="doxyHighlight">                                 NewBase.UnfoldedOffset.getFixedValue(), </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l04090" /><CodeLine lineNumber="4090"><span class="doxyHighlight">    NewBase.UnfoldedOffset = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(0);</span></CodeLine>
<Link id="l04091" /><CodeLine lineNumber="4091"><span class="doxyHighlight">    GenerateFormula(SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</span></CodeLine>
<Link id="l04092" /><CodeLine lineNumber="4092"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04093" /><CodeLine lineNumber="4093"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04094" /><CodeLine lineNumber="4094"></CodeLine>
<Link id="l04095" /><CodeLine lineNumber="4095"><span class="doxyHighlightComment">/// Helper function for LSRInstance::GenerateSymbolicOffsets.</span></CodeLine>
<Link id="l04096" /><CodeLine lineNumber="4096"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateSymbolicOffsetsImpl(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l04097" /><CodeLine lineNumber="4097"><span class="doxyHighlight">                                              </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> Idx,</span></CodeLine>
<Link id="l04098" /><CodeLine lineNumber="4098"><span class="doxyHighlight">                                              </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsScaledReg) &#123;</span></CodeLine>
<Link id="l04099" /><CodeLine lineNumber="4099"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a> = IsScaledReg ? <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;Idx&#93;;</span></CodeLine>
<Link id="l04100" /><CodeLine lineNumber="4100"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;GV = <a href="#a45b1664e25bf2a7220367462f2580044">ExtractSymbol</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, SE);</span></CodeLine>
<Link id="l04101" /><CodeLine lineNumber="4101"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;isZero() || !GV)</span></CodeLine>
<Link id="l04102" /><CodeLine lineNumber="4102"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04103" /><CodeLine lineNumber="4103"><span class="doxyHighlight">  Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l04104" /><CodeLine lineNumber="4104"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV = GV;</span></CodeLine>
<Link id="l04105" /><CodeLine lineNumber="4105"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</span></CodeLine>
<Link id="l04106" /><CodeLine lineNumber="4106"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04107" /><CodeLine lineNumber="4107"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsScaledReg)</span></CodeLine>
<Link id="l04108" /><CodeLine lineNumber="4108"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>;</span></CodeLine>
<Link id="l04109" /><CodeLine lineNumber="4109"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04110" /><CodeLine lineNumber="4110"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93; = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>;</span></CodeLine>
<Link id="l04111" /><CodeLine lineNumber="4111"><span class="doxyHighlight">  (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04112" /><CodeLine lineNumber="4112"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04113" /><CodeLine lineNumber="4113"></CodeLine>
<Link id="l04114" /><CodeLine lineNumber="4114"><span class="doxyHighlightComment">/// Generate reuse formulae using symbolic offsets.</span></CodeLine>
<Link id="l04115" /><CodeLine lineNumber="4115"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateSymbolicOffsets(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l04116" /><CodeLine lineNumber="4116"><span class="doxyHighlight">                                          Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</span></CodeLine>
<Link id="l04117" /><CodeLine lineNumber="4117"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We can&#39;t add a symbolic offset if the address already contains one.</span></CodeLine>
<Link id="l04118" /><CodeLine lineNumber="4118"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseGV) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04119" /><CodeLine lineNumber="4119"></CodeLine>
<Link id="l04120" /><CodeLine lineNumber="4120"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size(); i != e; ++i)</span></CodeLine>
<Link id="l04121" /><CodeLine lineNumber="4121"><span class="doxyHighlight">    GenerateSymbolicOffsetsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, i);</span></CodeLine>
<Link id="l04122" /><CodeLine lineNumber="4122"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 1)</span></CodeLine>
<Link id="l04123" /><CodeLine lineNumber="4123"><span class="doxyHighlight">    GenerateSymbolicOffsetsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, </span><span class="doxyHighlightComment">/&#42; Idx &#42;/</span><span class="doxyHighlight"> -1,</span></CodeLine>
<Link id="l04124" /><CodeLine lineNumber="4124"><span class="doxyHighlight">                                </span><span class="doxyHighlightComment">/&#42; IsScaledReg &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04125" /><CodeLine lineNumber="4125"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04126" /><CodeLine lineNumber="4126"></CodeLine>
<Link id="l04127" /><CodeLine lineNumber="4127"><span class="doxyHighlightComment">/// Helper function for LSRInstance::GenerateConstantOffsets.</span></CodeLine>
<Link id="l04128" /><CodeLine lineNumber="4128"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateConstantOffsetsImpl(</span></CodeLine>
<Link id="l04129" /><CodeLine lineNumber="4129"><span class="doxyHighlight">    LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>,</span></CodeLine>
<Link id="l04130" /><CodeLine lineNumber="4130"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Immediate&gt;</a> &amp;Worklist, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> Idx, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsScaledReg) &#123;</span></CodeLine>
<Link id="l04131" /><CodeLine lineNumber="4131"></CodeLine>
<Link id="l04132" /><CodeLine lineNumber="4132"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> GenerateOffset = &#91;&amp;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &#123;</span></CodeLine>
<Link id="l04133" /><CodeLine lineNumber="4133"><span class="doxyHighlight">    Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l04134" /><CodeLine lineNumber="4134"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isCompatibleImmediate(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>))</span></CodeLine>
<Link id="l04135" /><CodeLine lineNumber="4135"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04136" /><CodeLine lineNumber="4136"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.subUnsigned(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</span></CodeLine>
<Link id="l04137" /><CodeLine lineNumber="4137"></CodeLine>
<Link id="l04138" /><CodeLine lineNumber="4138"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) &#123;</span></CodeLine>
<Link id="l04139" /><CodeLine lineNumber="4139"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Add the offset to the base register.</span></CodeLine>
<Link id="l04140" /><CodeLine lineNumber="4140"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewOffset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getSCEV(SE, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;getType());</span></CodeLine>
<Link id="l04141" /><CodeLine lineNumber="4141"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewG = SE.getAddExpr(NewOffset, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>);</span></CodeLine>
<Link id="l04142" /><CodeLine lineNumber="4142"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If it cancelled out, drop the base register, otherwise update it.</span></CodeLine>
<Link id="l04143" /><CodeLine lineNumber="4143"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewG-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</span></CodeLine>
<Link id="l04144" /><CodeLine lineNumber="4144"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsScaledReg) &#123;</span></CodeLine>
<Link id="l04145" /><CodeLine lineNumber="4145"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale = 0;</span></CodeLine>
<Link id="l04146" /><CodeLine lineNumber="4146"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04147" /><CodeLine lineNumber="4147"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04148" /><CodeLine lineNumber="4148"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.deleteBaseReg(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93;);</span></CodeLine>
<Link id="l04149" /><CodeLine lineNumber="4149"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</span></CodeLine>
<Link id="l04150" /><CodeLine lineNumber="4150"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsScaledReg)</span></CodeLine>
<Link id="l04151" /><CodeLine lineNumber="4151"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = NewG;</span></CodeLine>
<Link id="l04152" /><CodeLine lineNumber="4152"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04153" /><CodeLine lineNumber="4153"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93; = NewG;</span></CodeLine>
<Link id="l04154" /><CodeLine lineNumber="4154"></CodeLine>
<Link id="l04155" /><CodeLine lineNumber="4155"><span class="doxyHighlight">      (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04156" /><CodeLine lineNumber="4156"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04157" /><CodeLine lineNumber="4157"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l04158" /><CodeLine lineNumber="4158"></CodeLine>
<Link id="l04159" /><CodeLine lineNumber="4159"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a> = IsScaledReg ? <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;Idx&#93;;</span></CodeLine>
<Link id="l04160" /><CodeLine lineNumber="4160"></CodeLine>
<Link id="l04161" /><CodeLine lineNumber="4161"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// With constant offsets and constant steps, we can generate pre-inc</span></CodeLine>
<Link id="l04162" /><CodeLine lineNumber="4162"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// accesses by having the offset equal the step. So, for access #0 with a</span></CodeLine>
<Link id="l04163" /><CodeLine lineNumber="4163"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// step of 8, we generate a G - 8 base which would require the first access</span></CodeLine>
<Link id="l04164" /><CodeLine lineNumber="4164"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to be ((G - 8) + 8),+,8. The pre-indexed access then updates the pointer</span></CodeLine>
<Link id="l04165" /><CodeLine lineNumber="4165"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// for itself and hopefully becomes the base for other accesses. This means</span></CodeLine>
<Link id="l04166" /><CodeLine lineNumber="4166"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// means that a single pre-indexed access can be generated to become the new</span></CodeLine>
<Link id="l04167" /><CodeLine lineNumber="4167"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// base pointer for each iteration of the loop, resulting in no extra add/sub</span></CodeLine>
<Link id="l04168" /><CodeLine lineNumber="4168"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instructions for pointer updating.</span></CodeLine>
<Link id="l04169" /><CodeLine lineNumber="4169"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a7cb26b7792c751612e634c36dce16f9a">TTI::AMK&#95;PreIndexed</a> &amp;&amp; LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>) &#123;</span></CodeLine>
<Link id="l04170" /><CodeLine lineNumber="4170"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;GAR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>)) &#123;</span></CodeLine>
<Link id="l04171" /><CodeLine lineNumber="4171"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;StepRec =</span></CodeLine>
<Link id="l04172" /><CodeLine lineNumber="4172"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(GAR-&gt;getStepRecurrence(SE))) &#123;</span></CodeLine>
<Link id="l04173" /><CodeLine lineNumber="4173"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/apint">APInt</a> &amp;StepInt = StepRec-&gt;getAPInt();</span></CodeLine>
<Link id="l04174" /><CodeLine lineNumber="4174"><span class="doxyHighlight">        int64&#95;t Step = StepInt.<a href="/docs/api/classes/llvm/apint/#a6804d9caf15411f55e7b9e9f397f0422">isNegative</a>() ?</span></CodeLine>
<Link id="l04175" /><CodeLine lineNumber="4175"><span class="doxyHighlight">          StepInt.<a href="/docs/api/classes/llvm/apint/#af2daa0ee117afefed4c82eee55bf97b7">getSExtValue</a>() : StepInt.<a href="/docs/api/classes/llvm/apint/#a217e0207d9cc8e046c2dccbf0e4bb198">getZExtValue</a>();</span></CodeLine>
<Link id="l04176" /><CodeLine lineNumber="4176"></CodeLine>
<Link id="l04177" /><CodeLine lineNumber="4177"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> : Worklist) &#123;</span></CodeLine>
<Link id="l04178" /><CodeLine lineNumber="4178"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isFixed()) &#123;</span></CodeLine>
<Link id="l04179" /><CodeLine lineNumber="4179"><span class="doxyHighlight">            <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue() - Step);</span></CodeLine>
<Link id="l04180" /><CodeLine lineNumber="4180"><span class="doxyHighlight">            GenerateOffset(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</span></CodeLine>
<Link id="l04181" /><CodeLine lineNumber="4181"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l04182" /><CodeLine lineNumber="4182"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l04183" /><CodeLine lineNumber="4183"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04184" /><CodeLine lineNumber="4184"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04185" /><CodeLine lineNumber="4185"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04186" /><CodeLine lineNumber="4186"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> : Worklist)</span></CodeLine>
<Link id="l04187" /><CodeLine lineNumber="4187"><span class="doxyHighlight">    GenerateOffset(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</span></CodeLine>
<Link id="l04188" /><CodeLine lineNumber="4188"></CodeLine>
<Link id="l04189" /><CodeLine lineNumber="4189"><span class="doxyHighlight">  Immediate <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a> = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>, SE);</span></CodeLine>
<Link id="l04190" /><CodeLine lineNumber="4190"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>-&gt;isZero() || <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a>.isZero() ||</span></CodeLine>
<Link id="l04191" /><CodeLine lineNumber="4191"><span class="doxyHighlight">      !<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isCompatibleImmediate(Imm))</span></CodeLine>
<Link id="l04192" /><CodeLine lineNumber="4192"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04193" /><CodeLine lineNumber="4193"><span class="doxyHighlight">  Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l04194" /><CodeLine lineNumber="4194"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.addUnsigned(Imm);</span></CodeLine>
<Link id="l04195" /><CodeLine lineNumber="4195"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</span></CodeLine>
<Link id="l04196" /><CodeLine lineNumber="4196"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04197" /><CodeLine lineNumber="4197"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsScaledReg) &#123;</span></CodeLine>
<Link id="l04198" /><CodeLine lineNumber="4198"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>;</span></CodeLine>
<Link id="l04199" /><CodeLine lineNumber="4199"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l04200" /><CodeLine lineNumber="4200"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;Idx&#93; = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ad96b7cf3182ce2ba85e5a7a93b12c441">G</a>;</span></CodeLine>
<Link id="l04201" /><CodeLine lineNumber="4201"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We may generate non canonical Formula if G is a recurrent expr reg</span></CodeLine>
<Link id="l04202" /><CodeLine lineNumber="4202"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// related with current loop while F.ScaledReg is not.</span></CodeLine>
<Link id="l04203" /><CodeLine lineNumber="4203"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</span></CodeLine>
<Link id="l04204" /><CodeLine lineNumber="4204"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04205" /><CodeLine lineNumber="4205"><span class="doxyHighlight">  (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04206" /><CodeLine lineNumber="4206"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04207" /><CodeLine lineNumber="4207"></CodeLine>
<Link id="l04208" /><CodeLine lineNumber="4208"><span class="doxyHighlightComment">/// GenerateConstantOffsets - Generate reuse formulae using symbolic offsets.</span></CodeLine>
<Link id="l04209" /><CodeLine lineNumber="4209"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateConstantOffsets(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l04210" /><CodeLine lineNumber="4210"><span class="doxyHighlight">                                          Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</span></CodeLine>
<Link id="l04211" /><CodeLine lineNumber="4211"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: For now, just add the min and max offset, because it usually isn&#39;t</span></CodeLine>
<Link id="l04212" /><CodeLine lineNumber="4212"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// worthwhile looking at everything inbetween.</span></CodeLine>
<Link id="l04213" /><CodeLine lineNumber="4213"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Immediate, 2&gt;</a> Worklist;</span></CodeLine>
<Link id="l04214" /><CodeLine lineNumber="4214"><span class="doxyHighlight">  Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LU.MinOffset);</span></CodeLine>
<Link id="l04215" /><CodeLine lineNumber="4215"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.MaxOffset != LU.MinOffset)</span></CodeLine>
<Link id="l04216" /><CodeLine lineNumber="4216"><span class="doxyHighlight">    Worklist.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LU.MaxOffset);</span></CodeLine>
<Link id="l04217" /><CodeLine lineNumber="4217"></CodeLine>
<Link id="l04218" /><CodeLine lineNumber="4218"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size(); i != e; ++i)</span></CodeLine>
<Link id="l04219" /><CodeLine lineNumber="4219"><span class="doxyHighlight">    GenerateConstantOffsetsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, Worklist, i);</span></CodeLine>
<Link id="l04220" /><CodeLine lineNumber="4220"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 1)</span></CodeLine>
<Link id="l04221" /><CodeLine lineNumber="4221"><span class="doxyHighlight">    GenerateConstantOffsetsImpl(LU, LUIdx, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, Worklist, </span><span class="doxyHighlightComment">/&#42; Idx &#42;/</span><span class="doxyHighlight"> -1,</span></CodeLine>
<Link id="l04222" /><CodeLine lineNumber="4222"><span class="doxyHighlight">                                </span><span class="doxyHighlightComment">/&#42; IsScaledReg &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04223" /><CodeLine lineNumber="4223"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04224" /><CodeLine lineNumber="4224"></CodeLine>
<Link id="l04225" /><CodeLine lineNumber="4225"><span class="doxyHighlightComment">/// For ICmpZero, check to see if we can scale up the comparison. For example, x</span></CodeLine>
<Link id="l04226" /><CodeLine lineNumber="4226"><span class="doxyHighlightComment">/// == y -&gt; x&#42;c == y&#42;c.</span></CodeLine>
<Link id="l04227" /><CodeLine lineNumber="4227"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateICmpZeroScales(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx,</span></CodeLine>
<Link id="l04228" /><CodeLine lineNumber="4228"><span class="doxyHighlight">                                         Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</span></CodeLine>
<Link id="l04229" /><CodeLine lineNumber="4229"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04230" /><CodeLine lineNumber="4230"></CodeLine>
<Link id="l04231" /><CodeLine lineNumber="4231"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Determine the integer type for the base formula.</span></CodeLine>
<Link id="l04232" /><CodeLine lineNumber="4232"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getType();</span></CodeLine>
<Link id="l04233" /><CodeLine lineNumber="4233"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IntTy) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04234" /><CodeLine lineNumber="4234"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getTypeSizeInBits(IntTy) &gt; 64) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04235" /><CodeLine lineNumber="4235"></CodeLine>
<Link id="l04236" /><CodeLine lineNumber="4236"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Don&#39;t do this if there is more than one offset.</span></CodeLine>
<Link id="l04237" /><CodeLine lineNumber="4237"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.MinOffset != LU.MaxOffset) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04238" /><CodeLine lineNumber="4238"></CodeLine>
<Link id="l04239" /><CodeLine lineNumber="4239"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check if transformation is valid. It is illegal to multiply pointer.</span></CodeLine>
<Link id="l04240" /><CodeLine lineNumber="4240"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg &amp;&amp; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg-&gt;getType()-&gt;isPointerTy())</span></CodeLine>
<Link id="l04241" /><CodeLine lineNumber="4241"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04242" /><CodeLine lineNumber="4242"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs)</span></CodeLine>
<Link id="l04243" /><CodeLine lineNumber="4243"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseReg-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>()-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</span></CodeLine>
<Link id="l04244" /><CodeLine lineNumber="4244"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04245" /><CodeLine lineNumber="4245"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseGV &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;ICmpZero use is not legal!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04246" /><CodeLine lineNumber="4246"></CodeLine>
<Link id="l04247" /><CodeLine lineNumber="4247"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check each interesting stride.</span></CodeLine>
<Link id="l04248" /><CodeLine lineNumber="4248"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (int64&#95;t Factor : Factors) &#123;</span></CodeLine>
<Link id="l04249" /><CodeLine lineNumber="4249"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check that Factor can be represented by IntTy</span></CodeLine>
<Link id="l04250" /><CodeLine lineNumber="4250"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/llvm/constantint/#a5b75b94b0d81c2ae458192b4a6544e18">ConstantInt::isValueValidForType</a>(IntTy, Factor))</span></CodeLine>
<Link id="l04251" /><CodeLine lineNumber="4251"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04252" /><CodeLine lineNumber="4252"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check that the multiplication doesn&#39;t overflow.</span></CodeLine>
<Link id="l04253" /><CodeLine lineNumber="4253"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isMin() &amp;&amp; Factor == -1)</span></CodeLine>
<Link id="l04254" /><CodeLine lineNumber="4254"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04255" /><CodeLine lineNumber="4255"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Not supporting scalable immediates.</span></CodeLine>
<Link id="l04256" /><CodeLine lineNumber="4256"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isNonZero() &amp;&amp; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isScalable())</span></CodeLine>
<Link id="l04257" /><CodeLine lineNumber="4257"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04258" /><CodeLine lineNumber="4258"><span class="doxyHighlight">    Immediate NewBaseOffset = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.mulUnsigned(Factor);</span></CodeLine>
<Link id="l04259" /><CodeLine lineNumber="4259"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Factor != 0 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Zero factor not expected!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04260" /><CodeLine lineNumber="4260"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewBaseOffset.getFixedValue() / Factor !=</span></CodeLine>
<Link id="l04261" /><CodeLine lineNumber="4261"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.getFixedValue())</span></CodeLine>
<Link id="l04262" /><CodeLine lineNumber="4262"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04263" /><CodeLine lineNumber="4263"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the offset will be truncated at this use, check that it is in bounds.</span></CodeLine>
<Link id="l04264" /><CodeLine lineNumber="4264"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IntTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp;</span></CodeLine>
<Link id="l04265" /><CodeLine lineNumber="4265"><span class="doxyHighlight">        !<a href="/docs/api/classes/llvm/constantint/#a5b75b94b0d81c2ae458192b4a6544e18">ConstantInt::isValueValidForType</a>(IntTy, NewBaseOffset.getFixedValue()))</span></CodeLine>
<Link id="l04266" /><CodeLine lineNumber="4266"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04267" /><CodeLine lineNumber="4267"></CodeLine>
<Link id="l04268" /><CodeLine lineNumber="4268"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check that multiplying with the use offset doesn&#39;t overflow.</span></CodeLine>
<Link id="l04269" /><CodeLine lineNumber="4269"><span class="doxyHighlight">    Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = LU.MinOffset;</span></CodeLine>
<Link id="l04270" /><CodeLine lineNumber="4270"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isMin() &amp;&amp; Factor == -1)</span></CodeLine>
<Link id="l04271" /><CodeLine lineNumber="4271"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04272" /><CodeLine lineNumber="4272"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.mulUnsigned(Factor);</span></CodeLine>
<Link id="l04273" /><CodeLine lineNumber="4273"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue() / Factor != LU.MinOffset.getFixedValue())</span></CodeLine>
<Link id="l04274" /><CodeLine lineNumber="4274"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04275" /><CodeLine lineNumber="4275"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the offset will be truncated at this use, check that it is in bounds.</span></CodeLine>
<Link id="l04276" /><CodeLine lineNumber="4276"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IntTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp;</span></CodeLine>
<Link id="l04277" /><CodeLine lineNumber="4277"><span class="doxyHighlight">        !<a href="/docs/api/classes/llvm/constantint/#a5b75b94b0d81c2ae458192b4a6544e18">ConstantInt::isValueValidForType</a>(IntTy, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue()))</span></CodeLine>
<Link id="l04278" /><CodeLine lineNumber="4278"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04279" /><CodeLine lineNumber="4279"></CodeLine>
<Link id="l04280" /><CodeLine lineNumber="4280"><span class="doxyHighlight">    Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l04281" /><CodeLine lineNumber="4281"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset = NewBaseOffset;</span></CodeLine>
<Link id="l04282" /><CodeLine lineNumber="4282"></CodeLine>
<Link id="l04283" /><CodeLine lineNumber="4283"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check that this scale is legal.</span></CodeLine>
<Link id="l04284" /><CodeLine lineNumber="4284"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, LU.Kind, LU.AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>))</span></CodeLine>
<Link id="l04285" /><CodeLine lineNumber="4285"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04286" /><CodeLine lineNumber="4286"></CodeLine>
<Link id="l04287" /><CodeLine lineNumber="4287"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Compensate for the use having MinOffset built into it.</span></CodeLine>
<Link id="l04288" /><CodeLine lineNumber="4288"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.addUnsigned(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>).subUnsigned(LU.MinOffset);</span></CodeLine>
<Link id="l04289" /><CodeLine lineNumber="4289"></CodeLine>
<Link id="l04290" /><CodeLine lineNumber="4290"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;FactorS = SE.getConstant(IntTy, Factor);</span></CodeLine>
<Link id="l04291" /><CodeLine lineNumber="4291"></CodeLine>
<Link id="l04292" /><CodeLine lineNumber="4292"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check that multiplying with each base register doesn&#39;t overflow.</span></CodeLine>
<Link id="l04293" /><CodeLine lineNumber="4293"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.size(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l04294" /><CodeLine lineNumber="4294"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;i&#93; = SE.getMulExpr(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;i&#93;, FactorS);</span></CodeLine>
<Link id="l04295" /><CodeLine lineNumber="4295"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;i&#93;, FactorS, SE) != <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;i&#93;)</span></CodeLine>
<Link id="l04296" /><CodeLine lineNumber="4296"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">goto</span><span class="doxyHighlight"> next;</span></CodeLine>
<Link id="l04297" /><CodeLine lineNumber="4297"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04298" /><CodeLine lineNumber="4298"></CodeLine>
<Link id="l04299" /><CodeLine lineNumber="4299"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check that multiplying with the scaled register doesn&#39;t overflow.</span></CodeLine>
<Link id="l04300" /><CodeLine lineNumber="4300"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) &#123;</span></CodeLine>
<Link id="l04301" /><CodeLine lineNumber="4301"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = SE.getMulExpr(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, FactorS);</span></CodeLine>
<Link id="l04302" /><CodeLine lineNumber="4302"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, FactorS, SE) != <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg)</span></CodeLine>
<Link id="l04303" /><CodeLine lineNumber="4303"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04304" /><CodeLine lineNumber="4304"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04305" /><CodeLine lineNumber="4305"></CodeLine>
<Link id="l04306" /><CodeLine lineNumber="4306"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check that multiplying with the unfolded offset doesn&#39;t overflow.</span></CodeLine>
<Link id="l04307" /><CodeLine lineNumber="4307"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isNonZero()) &#123;</span></CodeLine>
<Link id="l04308" /><CodeLine lineNumber="4308"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.isMin() &amp;&amp; Factor == -1)</span></CodeLine>
<Link id="l04309" /><CodeLine lineNumber="4309"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04310" /><CodeLine lineNumber="4310"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.mulUnsigned(Factor);</span></CodeLine>
<Link id="l04311" /><CodeLine lineNumber="4311"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue() / Factor !=</span></CodeLine>
<Link id="l04312" /><CodeLine lineNumber="4312"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.UnfoldedOffset.getFixedValue())</span></CodeLine>
<Link id="l04313" /><CodeLine lineNumber="4313"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04314" /><CodeLine lineNumber="4314"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If the offset will be truncated, check that it is in bounds.</span></CodeLine>
<Link id="l04315" /><CodeLine lineNumber="4315"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IntTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>() &amp;&amp; !<a href="/docs/api/classes/llvm/constantint/#a5b75b94b0d81c2ae458192b4a6544e18">ConstantInt::isValueValidForType</a>(</span></CodeLine>
<Link id="l04316" /><CodeLine lineNumber="4316"><span class="doxyHighlight">                                       IntTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset.getFixedValue()))</span></CodeLine>
<Link id="l04317" /><CodeLine lineNumber="4317"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04318" /><CodeLine lineNumber="4318"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04319" /><CodeLine lineNumber="4319"></CodeLine>
<Link id="l04320" /><CodeLine lineNumber="4320"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we make it here and it&#39;s legal, add it.</span></CodeLine>
<Link id="l04321" /><CodeLine lineNumber="4321"><span class="doxyHighlight">    (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04322" /><CodeLine lineNumber="4322"><span class="doxyHighlight">  next:;</span></CodeLine>
<Link id="l04323" /><CodeLine lineNumber="4323"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04324" /><CodeLine lineNumber="4324"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04325" /><CodeLine lineNumber="4325"></CodeLine>
<Link id="l04326" /><CodeLine lineNumber="4326"><span class="doxyHighlightComment">/// Generate stride factor reuse formulae by making use of scaled-offset address</span></CodeLine>
<Link id="l04327" /><CodeLine lineNumber="4327"><span class="doxyHighlightComment">/// modes, for example.</span></CodeLine>
<Link id="l04328" /><CodeLine lineNumber="4328"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateScales(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</span></CodeLine>
<Link id="l04329" /><CodeLine lineNumber="4329"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Determine the integer type for the base formula.</span></CodeLine>
<Link id="l04330" /><CodeLine lineNumber="4330"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getType();</span></CodeLine>
<Link id="l04331" /><CodeLine lineNumber="4331"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IntTy) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04332" /><CodeLine lineNumber="4332"></CodeLine>
<Link id="l04333" /><CodeLine lineNumber="4333"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If this Formula already has a scaled register, we can&#39;t add another one.</span></CodeLine>
<Link id="l04334" /><CodeLine lineNumber="4334"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Try to unscale the formula to generate a better scale.</span></CodeLine>
<Link id="l04335" /><CodeLine lineNumber="4335"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale != 0 &amp;&amp; !<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.unscale())</span></CodeLine>
<Link id="l04336" /><CodeLine lineNumber="4336"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04337" /><CodeLine lineNumber="4337"></CodeLine>
<Link id="l04338" /><CodeLine lineNumber="4338"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale == 0 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;unscale did not did its job!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04339" /><CodeLine lineNumber="4339"></CodeLine>
<Link id="l04340" /><CodeLine lineNumber="4340"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check each interesting stride.</span></CodeLine>
<Link id="l04341" /><CodeLine lineNumber="4341"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (int64&#95;t Factor : Factors) &#123;</span></CodeLine>
<Link id="l04342" /><CodeLine lineNumber="4342"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Scale = Factor;</span></CodeLine>
<Link id="l04343" /><CodeLine lineNumber="4343"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.HasBaseReg = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size() &gt; 1;</span></CodeLine>
<Link id="l04344" /><CodeLine lineNumber="4344"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check whether this scale is going to be legal.</span></CodeLine>
<Link id="l04345" /><CodeLine lineNumber="4345"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy,</span></CodeLine>
<Link id="l04346" /><CodeLine lineNumber="4346"><span class="doxyHighlight">                    <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>)) &#123;</span></CodeLine>
<Link id="l04347" /><CodeLine lineNumber="4347"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// As a special-case, handle special out-of-loop Basic users specially.</span></CodeLine>
<Link id="l04348" /><CodeLine lineNumber="4348"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// TODO: Reconsider this special case.</span></CodeLine>
<Link id="l04349" /><CodeLine lineNumber="4349"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a55d63bad11e6c7c0a80a181ad353c0a4">LSRUse::Basic</a> &amp;&amp;</span></CodeLine>
<Link id="l04350" /><CodeLine lineNumber="4350"><span class="doxyHighlight">          <a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">LSRUse::Special</a>,</span></CodeLine>
<Link id="l04351" /><CodeLine lineNumber="4351"><span class="doxyHighlight">                     LU.AccessTy, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &amp;&amp;</span></CodeLine>
<Link id="l04352" /><CodeLine lineNumber="4352"><span class="doxyHighlight">          LU.AllFixupsOutsideLoop)</span></CodeLine>
<Link id="l04353" /><CodeLine lineNumber="4353"><span class="doxyHighlight">        LU.Kind = <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0ab2859f05059b7bc12a24c88a418fd214">LSRUse::Special</a>;</span></CodeLine>
<Link id="l04354" /><CodeLine lineNumber="4354"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04355" /><CodeLine lineNumber="4355"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04356" /><CodeLine lineNumber="4356"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04357" /><CodeLine lineNumber="4357"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// For an ICmpZero, negating a solitary base register won&#39;t lead to</span></CodeLine>
<Link id="l04358" /><CodeLine lineNumber="4358"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// new solutions.</span></CodeLine>
<Link id="l04359" /><CodeLine lineNumber="4359"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a> &amp;&amp; !<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.HasBaseReg &amp;&amp;</span></CodeLine>
<Link id="l04360" /><CodeLine lineNumber="4360"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseOffset.isZero() &amp;&amp; !<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseGV)</span></CodeLine>
<Link id="l04361" /><CodeLine lineNumber="4361"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04362" /><CodeLine lineNumber="4362"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// For each addrec base reg, if its loop is current loop, apply the scale.</span></CodeLine>
<Link id="l04363" /><CodeLine lineNumber="4363"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs.size(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l04364" /><CodeLine lineNumber="4364"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;AR = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs&#91;i&#93;);</span></CodeLine>
<Link id="l04365" /><CodeLine lineNumber="4365"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AR &amp;&amp; (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() == L || LU.AllFixupsOutsideLoop)) &#123;</span></CodeLine>
<Link id="l04366" /><CodeLine lineNumber="4366"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;FactorS = SE.getConstant(IntTy, Factor);</span></CodeLine>
<Link id="l04367" /><CodeLine lineNumber="4367"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FactorS-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</span></CodeLine>
<Link id="l04368" /><CodeLine lineNumber="4368"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04369" /><CodeLine lineNumber="4369"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Divide out the factor, ignoring high bits, since we&#39;ll be</span></CodeLine>
<Link id="l04370" /><CodeLine lineNumber="4370"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// scaling the value back up in the end.</span></CodeLine>
<Link id="l04371" /><CodeLine lineNumber="4371"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Quotient = <a href="#ad0ad0c0f486f8ea43158a1227e610a9c">getExactSDiv</a>(AR, FactorS, SE, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">))</span></CodeLine>
<Link id="l04372" /><CodeLine lineNumber="4372"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Quotient-&gt;isZero()) &#123;</span></CodeLine>
<Link id="l04373" /><CodeLine lineNumber="4373"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// TODO: This could be optimized to avoid all the copying.</span></CodeLine>
<Link id="l04374" /><CodeLine lineNumber="4374"><span class="doxyHighlight">            Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l04375" /><CodeLine lineNumber="4375"><span class="doxyHighlight">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = Quotient;</span></CodeLine>
<Link id="l04376" /><CodeLine lineNumber="4376"><span class="doxyHighlight">            <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.deleteBaseReg(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;i&#93;);</span></CodeLine>
<Link id="l04377" /><CodeLine lineNumber="4377"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// The canonical representation of 1&#42;reg is reg, which is already in</span></CodeLine>
<Link id="l04378" /><CodeLine lineNumber="4378"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// Base. In that case, do not try to insert the formula, it will be</span></CodeLine>
<Link id="l04379" /><CodeLine lineNumber="4379"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// rejected anyway.</span></CodeLine>
<Link id="l04380" /><CodeLine lineNumber="4380"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 1 &amp;&amp; (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.empty() ||</span></CodeLine>
<Link id="l04381" /><CodeLine lineNumber="4381"><span class="doxyHighlight">                                 (AR-&gt;<a href="/docs/api/classes/llvm/scevaddrecexpr/#a99ab4a82c6d7373e2e367986b9527bf0">getLoop</a>() != L &amp;&amp; LU.AllFixupsOutsideLoop)))</span></CodeLine>
<Link id="l04382" /><CodeLine lineNumber="4382"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04383" /><CodeLine lineNumber="4383"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// If AllFixupsOutsideLoop is true and F.Scale is 1, we may generate</span></CodeLine>
<Link id="l04384" /><CodeLine lineNumber="4384"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// non canonical Formula with ScaledReg&#39;s loop not being L.</span></CodeLine>
<Link id="l04385" /><CodeLine lineNumber="4385"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 1 &amp;&amp; LU.AllFixupsOutsideLoop)</span></CodeLine>
<Link id="l04386" /><CodeLine lineNumber="4386"><span class="doxyHighlight">              <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</span></CodeLine>
<Link id="l04387" /><CodeLine lineNumber="4387"><span class="doxyHighlight">            (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04388" /><CodeLine lineNumber="4388"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l04389" /><CodeLine lineNumber="4389"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04390" /><CodeLine lineNumber="4390"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04391" /><CodeLine lineNumber="4391"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04392" /><CodeLine lineNumber="4392"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04393" /><CodeLine lineNumber="4393"></CodeLine>
<Link id="l04394" /><CodeLine lineNumber="4394"><span class="doxyHighlightComment">/// Extend/Truncate \\p Expr to \\p ToTy considering post-inc uses in \\p Loops.</span></CodeLine>
<Link id="l04395" /><CodeLine lineNumber="4395"><span class="doxyHighlightComment">/// For all PostIncLoopSets in \\p Loops, first de-normalize \\p Expr, then</span></CodeLine>
<Link id="l04396" /><CodeLine lineNumber="4396"><span class="doxyHighlightComment">/// perform the extension/truncate and normalize again, as the normalized form</span></CodeLine>
<Link id="l04397" /><CodeLine lineNumber="4397"><span class="doxyHighlightComment">/// can result in folds that are not valid in the post-inc use contexts. The</span></CodeLine>
<Link id="l04398" /><CodeLine lineNumber="4398"><span class="doxyHighlightComment">/// expressions for all PostIncLoopSets must match, otherwise return nullptr.</span></CodeLine>
<Link id="l04399" /><CodeLine lineNumber="4399"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;</span></CodeLine>
<Link id="l04400" /><CodeLine lineNumber="4400" lineLink="#ae0228f64a74eb3e9fc5343b024ab9a42"><span class="doxyHighlight"><a href="#ae0228f64a74eb3e9fc5343b024ab9a42">getAnyExtendConsideringPostIncUses</a>(<a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;PostIncLoopSet&gt;</a> <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>,</span></CodeLine>
<Link id="l04401" /><CodeLine lineNumber="4401"><span class="doxyHighlight">                                   </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Expr, <a href="/docs/api/classes/llvm/type">Type</a> &#42;ToTy,</span></CodeLine>
<Link id="l04402" /><CodeLine lineNumber="4402"><span class="doxyHighlight">                                   <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l04403" /><CodeLine lineNumber="4403"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Result = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04404" /><CodeLine lineNumber="4404"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;L : <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>) &#123;</span></CodeLine>
<Link id="l04405" /><CodeLine lineNumber="4405"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;DenormExpr = <a href="/docs/api/namespaces/llvm/#a6fb1355b48afff4e97045b546b5f6415">denormalizeForPostIncUse</a>(Expr, L, SE);</span></CodeLine>
<Link id="l04406" /><CodeLine lineNumber="4406"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewDenormExpr = SE.<a href="/docs/api/classes/llvm/scalarevolution/#aa35959e3f6bea8e35cffcfd8659e3156">getAnyExtendExpr</a>(DenormExpr, ToTy);</span></CodeLine>
<Link id="l04407" /><CodeLine lineNumber="4407"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;New = <a href="/docs/api/namespaces/llvm/#a99237ea99bf8618b7d29b5ca6185069b">normalizeForPostIncUse</a>(NewDenormExpr, L, SE);</span></CodeLine>
<Link id="l04408" /><CodeLine lineNumber="4408"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!New || (Result &amp;&amp; New != Result))</span></CodeLine>
<Link id="l04409" /><CodeLine lineNumber="4409"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04410" /><CodeLine lineNumber="4410"><span class="doxyHighlight">    Result = New;</span></CodeLine>
<Link id="l04411" /><CodeLine lineNumber="4411"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04412" /><CodeLine lineNumber="4412"></CodeLine>
<Link id="l04413" /><CodeLine lineNumber="4413"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Result &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;failed to create expression&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04414" /><CodeLine lineNumber="4414"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Result;</span></CodeLine>
<Link id="l04415" /><CodeLine lineNumber="4415"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04416" /><CodeLine lineNumber="4416"></CodeLine>
<Link id="l04417" /><CodeLine lineNumber="4417"><span class="doxyHighlightComment">/// Generate reuse formulae from different IV types.</span></CodeLine>
<Link id="l04418" /><CodeLine lineNumber="4418"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateTruncates(LSRUse &amp;LU, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx, Formula <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</span></CodeLine>
<Link id="l04419" /><CodeLine lineNumber="4419"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Don&#39;t bother truncating symbolic values.</span></CodeLine>
<Link id="l04420" /><CodeLine lineNumber="4420"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseGV) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04421" /><CodeLine lineNumber="4421"></CodeLine>
<Link id="l04422" /><CodeLine lineNumber="4422"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Determine the integer type for the base formula.</span></CodeLine>
<Link id="l04423" /><CodeLine lineNumber="4423"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;DstTy = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.getType();</span></CodeLine>
<Link id="l04424" /><CodeLine lineNumber="4424"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DstTy) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04425" /><CodeLine lineNumber="4425"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstTy-&gt;<a href="/docs/api/classes/llvm/type/#a3b996fbf8458aafffc86cb98a68d0a47">isPointerTy</a>())</span></CodeLine>
<Link id="l04426" /><CodeLine lineNumber="4426"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04427" /><CodeLine lineNumber="4427"></CodeLine>
<Link id="l04428" /><CodeLine lineNumber="4428"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// It is invalid to extend a pointer type so exit early if ScaledReg or</span></CodeLine>
<Link id="l04429" /><CodeLine lineNumber="4429"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// any of the BaseRegs are pointers.</span></CodeLine>
<Link id="l04430" /><CodeLine lineNumber="4430"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg &amp;&amp; <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.ScaledReg-&gt;getType()-&gt;isPointerTy())</span></CodeLine>
<Link id="l04431" /><CodeLine lineNumber="4431"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04432" /><CodeLine lineNumber="4432"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a61d13d6824ec46c31260a4fd0997eda0">any&#95;of</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.BaseRegs,</span></CodeLine>
<Link id="l04433" /><CodeLine lineNumber="4433"><span class="doxyHighlight">             &#91;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123; return S-&gt;getType()-&gt;isPointerTy(); &#125;))</span></CodeLine>
<Link id="l04434" /><CodeLine lineNumber="4434"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04435" /><CodeLine lineNumber="4435"></CodeLine>
<Link id="l04436" /><CodeLine lineNumber="4436"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;PostIncLoopSet&gt;</a> <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>;</span></CodeLine>
<Link id="l04437" /><CodeLine lineNumber="4437"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;LF : LU.Fixups)</span></CodeLine>
<Link id="l04438" /><CodeLine lineNumber="4438"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LF.PostIncLoops);</span></CodeLine>
<Link id="l04439" /><CodeLine lineNumber="4439"></CodeLine>
<Link id="l04440" /><CodeLine lineNumber="4440"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/type">Type</a> &#42;SrcTy : Types) &#123;</span></CodeLine>
<Link id="l04441" /><CodeLine lineNumber="4441"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcTy != DstTy &amp;&amp; <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isTruncateFree(SrcTy, DstTy)) &#123;</span></CodeLine>
<Link id="l04442" /><CodeLine lineNumber="4442"><span class="doxyHighlight">      Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l04443" /><CodeLine lineNumber="4443"></CodeLine>
<Link id="l04444" /><CodeLine lineNumber="4444"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Sometimes SCEV is able to prove zero during ext transform. It may</span></CodeLine>
<Link id="l04445" /><CodeLine lineNumber="4445"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// happen if SCEV did not do all possible transforms while creating the</span></CodeLine>
<Link id="l04446" /><CodeLine lineNumber="4446"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// initial node (maybe due to depth limitations), but it can do them while</span></CodeLine>
<Link id="l04447" /><CodeLine lineNumber="4447"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// taking ext.</span></CodeLine>
<Link id="l04448" /><CodeLine lineNumber="4448"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) &#123;</span></CodeLine>
<Link id="l04449" /><CodeLine lineNumber="4449"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewScaledReg =</span></CodeLine>
<Link id="l04450" /><CodeLine lineNumber="4450"><span class="doxyHighlight">            <a href="#ae0228f64a74eb3e9fc5343b024ab9a42">getAnyExtendConsideringPostIncUses</a>(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, SrcTy, SE);</span></CodeLine>
<Link id="l04451" /><CodeLine lineNumber="4451"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewScaledReg || NewScaledReg-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>())</span></CodeLine>
<Link id="l04452" /><CodeLine lineNumber="4452"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04453" /><CodeLine lineNumber="4453"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg = NewScaledReg;</span></CodeLine>
<Link id="l04454" /><CodeLine lineNumber="4454"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04455" /><CodeLine lineNumber="4455"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasZeroBaseReg = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04456" /><CodeLine lineNumber="4456"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;&amp;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</span></CodeLine>
<Link id="l04457" /><CodeLine lineNumber="4457"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewBaseReg =</span></CodeLine>
<Link id="l04458" /><CodeLine lineNumber="4458"><span class="doxyHighlight">            <a href="#ae0228f64a74eb3e9fc5343b024ab9a42">getAnyExtendConsideringPostIncUses</a>(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>, BaseReg, SrcTy, SE);</span></CodeLine>
<Link id="l04459" /><CodeLine lineNumber="4459"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewBaseReg || NewBaseReg-&gt;<a href="/docs/api/classes/llvm/scev/#a4541962f9c18aacceb7243520eb15e1f">isZero</a>()) &#123;</span></CodeLine>
<Link id="l04460" /><CodeLine lineNumber="4460"><span class="doxyHighlight">          HasZeroBaseReg = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04461" /><CodeLine lineNumber="4461"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04462" /><CodeLine lineNumber="4462"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l04463" /><CodeLine lineNumber="4463"><span class="doxyHighlight">        BaseReg = NewBaseReg;</span></CodeLine>
<Link id="l04464" /><CodeLine lineNumber="4464"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04465" /><CodeLine lineNumber="4465"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (HasZeroBaseReg)</span></CodeLine>
<Link id="l04466" /><CodeLine lineNumber="4466"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04467" /><CodeLine lineNumber="4467"></CodeLine>
<Link id="l04468" /><CodeLine lineNumber="4468"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// TODO: This assumes we&#39;ve done basic processing on all uses and</span></CodeLine>
<Link id="l04469" /><CodeLine lineNumber="4469"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// have an idea what the register usage is.</span></CodeLine>
<Link id="l04470" /><CodeLine lineNumber="4470"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.hasRegsUsedByUsesOtherThan(LUIdx, RegUses))</span></CodeLine>
<Link id="l04471" /><CodeLine lineNumber="4471"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04472" /><CodeLine lineNumber="4472"></CodeLine>
<Link id="l04473" /><CodeLine lineNumber="4473"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.canonicalize(&#42;L);</span></CodeLine>
<Link id="l04474" /><CodeLine lineNumber="4474"><span class="doxyHighlight">      (void)InsertFormula(LU, LUIdx, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04475" /><CodeLine lineNumber="4475"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04476" /><CodeLine lineNumber="4476"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04477" /><CodeLine lineNumber="4477"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04478" /><CodeLine lineNumber="4478"></CodeLine>
<Link id="l04479" /><CodeLine lineNumber="4479"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l04480" /><CodeLine lineNumber="4480"></CodeLine>
<Link id="l04481" /><CodeLine lineNumber="4481"><span class="doxyHighlightComment">/// Helper class for GenerateCrossUseConstantOffsets. It&#39;s used to defer</span></CodeLine>
<Link id="l04482" /><CodeLine lineNumber="4482"><span class="doxyHighlightComment">/// modifications so that the search phase doesn&#39;t have to worry about the data</span></CodeLine>
<Link id="l04483" /><CodeLine lineNumber="4483"><span class="doxyHighlightComment">/// structures moving underneath it.</span></CodeLine>
<Link id="l04484" /><CodeLine lineNumber="4484" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#ad08f488d8d7c39cdd65fdd02f3433b48">WorkItem</a> &#123;</span></CodeLine>
<Link id="l04485" /><CodeLine lineNumber="4485" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#aaaafc698bf9e95dece11ebbe3464c678"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#aaaafc698bf9e95dece11ebbe3464c678">LUIdx</a>;</span></CodeLine>
<Link id="l04486" /><CodeLine lineNumber="4486" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a6ea4ba88bb5cefffde6534660188720b"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a6ea4ba88bb5cefffde6534660188720b">Imm</a>;</span></CodeLine>
<Link id="l04487" /><CodeLine lineNumber="4487" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a41baa8ff8fffe77ba278bb3f009c8e3a"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a41baa8ff8fffe77ba278bb3f009c8e3a">OrigReg</a>;</span></CodeLine>
<Link id="l04488" /><CodeLine lineNumber="4488"></CodeLine>
<Link id="l04489" /><CodeLine lineNumber="4489" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#ad08f488d8d7c39cdd65fdd02f3433b48"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#ad08f488d8d7c39cdd65fdd02f3433b48">WorkItem</a>(</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LI, <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;R)</span></CodeLine>
<Link id="l04490" /><CodeLine lineNumber="4490"><span class="doxyHighlight">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#aaaafc698bf9e95dece11ebbe3464c678">LUIdx</a>(LI), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a6ea4ba88bb5cefffde6534660188720b">Imm</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a41baa8ff8fffe77ba278bb3f009c8e3a">OrigReg</a>(R) &#123;&#125;</span></CodeLine>
<Link id="l04491" /><CodeLine lineNumber="4491"></CodeLine>
<Link id="l04492" /><CodeLine lineNumber="4492"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04493" /><CodeLine lineNumber="4493"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>() </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04494" /><CodeLine lineNumber="4494"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l04495" /><CodeLine lineNumber="4495"></CodeLine>
<Link id="l04496" /><CodeLine lineNumber="4496"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l04497" /><CodeLine lineNumber="4497"></CodeLine>
<Link id="l04498" /><CodeLine lineNumber="4498"><span class="doxyHighlightPreprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</span></CodeLine>
<Link id="l04499" /><CodeLine lineNumber="4499" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a10aaa870abf7228d3bbbf3f9b66a7d97"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a10aaa870abf7228d3bbbf3f9b66a7d97">WorkItem::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l04500" /><CodeLine lineNumber="4500"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;in formulae referencing &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a41baa8ff8fffe77ba278bb3f009c8e3a">OrigReg</a> &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; in use &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#aaaafc698bf9e95dece11ebbe3464c678">LUIdx</a></span></CodeLine>
<Link id="l04501" /><CodeLine lineNumber="4501"><span class="doxyHighlight">     &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; , add offset &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a6ea4ba88bb5cefffde6534660188720b">Imm</a>;</span></CodeLine>
<Link id="l04502" /><CodeLine lineNumber="4502"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04503" /><CodeLine lineNumber="4503"></CodeLine>
<Link id="l04504" /><CodeLine lineNumber="4504" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a9ee84141fefcb511385561d5d59523ce"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/workitem/#a9ee84141fefcb511385561d5d59523ce">WorkItem::dump</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l04505" /><CodeLine lineNumber="4505"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04506" /><CodeLine lineNumber="4506"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04507" /><CodeLine lineNumber="4507"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l04508" /><CodeLine lineNumber="4508"></CodeLine>
<Link id="l04509" /><CodeLine lineNumber="4509"><span class="doxyHighlightComment">/// Look for registers which are a constant distance apart and try to form reuse</span></CodeLine>
<Link id="l04510" /><CodeLine lineNumber="4510"><span class="doxyHighlightComment">/// opportunities between them.</span></CodeLine>
<Link id="l04511" /><CodeLine lineNumber="4511"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::GenerateCrossUseConstantOffsets() &#123;</span></CodeLine>
<Link id="l04512" /><CodeLine lineNumber="4512"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Group the registers by their value without any added constant offset.</span></CodeLine>
<Link id="l04513" /><CodeLine lineNumber="4513"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight">ImmMapTy = std::map&lt;Immediate, const SCEV &#42;, KeyOrderTargetImmediate&gt;;</span></CodeLine>
<Link id="l04514" /><CodeLine lineNumber="4514"></CodeLine>
<Link id="l04515" /><CodeLine lineNumber="4515"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;const SCEV &#42;, ImmMapTy&gt;</a> Map;</span></CodeLine>
<Link id="l04516" /><CodeLine lineNumber="4516"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;const SCEV &#42;, SmallBitVector&gt;</a> UsedByIndicesMap;</span></CodeLine>
<Link id="l04517" /><CodeLine lineNumber="4517"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> Sequence;</span></CodeLine>
<Link id="l04518" /><CodeLine lineNumber="4518"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/classes/llvm/use">Use</a> : RegUses) &#123;</span></CodeLine>
<Link id="l04519" /><CodeLine lineNumber="4519"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Reg = <a href="/docs/api/classes/llvm/use">Use</a>; </span><span class="doxyHighlightComment">// Make a copy for ExtractImmediate to modify.</span></CodeLine>
<Link id="l04520" /><CodeLine lineNumber="4520"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate">Immediate</a> Imm = <a href="#a1a0afc5106fca20f0a81eac37db70ab9">ExtractImmediate</a>(Reg, SE);</span></CodeLine>
<Link id="l04521" /><CodeLine lineNumber="4521"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Pair = Map.insert(std::make&#95;pair(Reg, ImmMapTy()));</span></CodeLine>
<Link id="l04522" /><CodeLine lineNumber="4522"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Pair.second)</span></CodeLine>
<Link id="l04523" /><CodeLine lineNumber="4523"><span class="doxyHighlight">      Sequence.push&#95;back(Reg);</span></CodeLine>
<Link id="l04524" /><CodeLine lineNumber="4524"><span class="doxyHighlight">    Pair.first-&gt;second.insert(std::make&#95;pair(Imm, <a href="/docs/api/classes/llvm/use">Use</a>));</span></CodeLine>
<Link id="l04525" /><CodeLine lineNumber="4525"><span class="doxyHighlight">    UsedByIndicesMap&#91;Reg&#93; |= RegUses.getUsedByIndices(<a href="/docs/api/classes/llvm/use">Use</a>);</span></CodeLine>
<Link id="l04526" /><CodeLine lineNumber="4526"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04527" /><CodeLine lineNumber="4527"></CodeLine>
<Link id="l04528" /><CodeLine lineNumber="4528"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now examine each set of registers with the same base value. Build up</span></CodeLine>
<Link id="l04529" /><CodeLine lineNumber="4529"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// a list of work to do and do the work in a separate step so that we&#39;re</span></CodeLine>
<Link id="l04530" /><CodeLine lineNumber="4530"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// not adding formulae and register counts while we&#39;re searching.</span></CodeLine>
<Link id="l04531" /><CodeLine lineNumber="4531"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WorkItem, 32&gt;</a> WorkItems;</span></CodeLine>
<Link id="l04532" /><CodeLine lineNumber="4532"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallset">SmallSet&lt;std::pair&lt;size&#95;t, Immediate&gt;</a>, 32, KeyOrderSizeTAndImmediate&gt;</span></CodeLine>
<Link id="l04533" /><CodeLine lineNumber="4533"><span class="doxyHighlight">      UniqueItems;</span></CodeLine>
<Link id="l04534" /><CodeLine lineNumber="4534"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : Sequence) &#123;</span></CodeLine>
<Link id="l04535" /><CodeLine lineNumber="4535"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> ImmMapTy &amp;Imms = Map.find(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)-&gt;second;</span></CodeLine>
<Link id="l04536" /><CodeLine lineNumber="4536"></CodeLine>
<Link id="l04537" /><CodeLine lineNumber="4537"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// It&#39;s not worthwhile looking for reuse if there&#39;s only one offset.</span></CodeLine>
<Link id="l04538" /><CodeLine lineNumber="4538"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Imms.size() == 1)</span></CodeLine>
<Link id="l04539" /><CodeLine lineNumber="4539"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04540" /><CodeLine lineNumber="4540"></CodeLine>
<Link id="l04541" /><CodeLine lineNumber="4541"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Generating cross-use offsets for &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;:&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04542" /><CodeLine lineNumber="4542"><span class="doxyHighlight">               </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Entry</span></CodeLine>
<Link id="l04543" /><CodeLine lineNumber="4543"><span class="doxyHighlight">                    : Imms) <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</span></CodeLine>
<Link id="l04544" /><CodeLine lineNumber="4544"><span class="doxyHighlight">               &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39; &#39;</span><span class="doxyHighlight"> &lt;&lt; Entry.first;</span></CodeLine>
<Link id="l04545" /><CodeLine lineNumber="4545"><span class="doxyHighlight">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04546" /><CodeLine lineNumber="4546"></CodeLine>
<Link id="l04547" /><CodeLine lineNumber="4547"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Examine each offset.</span></CodeLine>
<Link id="l04548" /><CodeLine lineNumber="4548"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (ImmMapTy::const&#95;iterator J = Imms.begin(), JE = Imms.end();</span></CodeLine>
<Link id="l04549" /><CodeLine lineNumber="4549"><span class="doxyHighlight">         J != JE; ++J) &#123;</span></CodeLine>
<Link id="l04550" /><CodeLine lineNumber="4550"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OrigReg = J-&gt;second;</span></CodeLine>
<Link id="l04551" /><CodeLine lineNumber="4551"></CodeLine>
<Link id="l04552" /><CodeLine lineNumber="4552"><span class="doxyHighlight">      Immediate JImm = J-&gt;first;</span></CodeLine>
<Link id="l04553" /><CodeLine lineNumber="4553"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = RegUses.getUsedByIndices(OrigReg);</span></CodeLine>
<Link id="l04554" /><CodeLine lineNumber="4554"></CodeLine>
<Link id="l04555" /><CodeLine lineNumber="4555"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVConstant&gt;</a>(OrigReg) &amp;&amp;</span></CodeLine>
<Link id="l04556" /><CodeLine lineNumber="4556"><span class="doxyHighlight">          UsedByIndicesMap&#91;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>&#93;.<a href="/docs/api/namespaces/llvm/#ab1772fd431decccb7926d484ea223db7">count</a>() == 1) &#123;</span></CodeLine>
<Link id="l04557" /><CodeLine lineNumber="4557"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Skipping cross-use reuse for &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;OrigReg</span></CodeLine>
<Link id="l04558" /><CodeLine lineNumber="4558"><span class="doxyHighlight">                          &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04559" /><CodeLine lineNumber="4559"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04560" /><CodeLine lineNumber="4560"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04561" /><CodeLine lineNumber="4561"></CodeLine>
<Link id="l04562" /><CodeLine lineNumber="4562"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Conservatively examine offsets between this orig reg a few selected</span></CodeLine>
<Link id="l04563" /><CodeLine lineNumber="4563"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// other orig regs.</span></CodeLine>
<Link id="l04564" /><CodeLine lineNumber="4564"><span class="doxyHighlight">      Immediate <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = Imms.begin()-&gt;first;</span></CodeLine>
<Link id="l04565" /><CodeLine lineNumber="4565"><span class="doxyHighlight">      Immediate <a href="/docs/api/namespaces/llvm/#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">Last</a> = std::prev(Imms.end())-&gt;first;</span></CodeLine>
<Link id="l04566" /><CodeLine lineNumber="4566"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>.isCompatibleImmediate(<a href="/docs/api/namespaces/llvm/#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">Last</a>)) &#123;</span></CodeLine>
<Link id="l04567" /><CodeLine lineNumber="4567"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Skipping cross-use reuse for &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;OrigReg</span></CodeLine>
<Link id="l04568" /><CodeLine lineNumber="4568"><span class="doxyHighlight">                          &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04569" /><CodeLine lineNumber="4569"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04570" /><CodeLine lineNumber="4570"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04571" /><CodeLine lineNumber="4571"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Only scalable if both terms are scalable, or if one is scalable and</span></CodeLine>
<Link id="l04572" /><CodeLine lineNumber="4572"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// the other is 0</span></CodeLine>
<Link id="l04573" /><CodeLine lineNumber="4573"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Scalable = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>.isScalable() || <a href="/docs/api/namespaces/llvm/#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">Last</a>.isScalable();</span></CodeLine>
<Link id="l04574" /><CodeLine lineNumber="4574"><span class="doxyHighlight">      int64&#95;t FI = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>.getKnownMinValue();</span></CodeLine>
<Link id="l04575" /><CodeLine lineNumber="4575"><span class="doxyHighlight">      int64&#95;t LI = <a href="/docs/api/namespaces/llvm/#ac10d13c57a7adf4a1f140afd5321309bad55b30607c2a9a2616347d6edb789f6b">Last</a>.getKnownMinValue();</span></CodeLine>
<Link id="l04576" /><CodeLine lineNumber="4576"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Compute (First + Last)  / 2 without overflow using the fact that</span></CodeLine>
<Link id="l04577" /><CodeLine lineNumber="4577"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// First + Last = 2 &#42; (First + Last) + (First ^ Last).</span></CodeLine>
<Link id="l04578" /><CodeLine lineNumber="4578"><span class="doxyHighlight">      int64&#95;t Avg = (FI &amp; LI) + ((FI ^ LI) &gt;&gt; 1);</span></CodeLine>
<Link id="l04579" /><CodeLine lineNumber="4579"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If the result is negative and FI is odd and LI even (or vice versa),</span></CodeLine>
<Link id="l04580" /><CodeLine lineNumber="4580"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// we rounded towards -inf. Add 1 in that case, to round towards 0</span></CodeLine>
<Link id="l04581" /><CodeLine lineNumber="4581"><span class="doxyHighlight">      Avg = Avg + ((FI ^ LI) &amp; ((uint64&#95;t)Avg &gt;&gt; 63));</span></CodeLine>
<Link id="l04582" /><CodeLine lineNumber="4582"><span class="doxyHighlight">      ImmMapTy::const&#95;iterator OtherImms&#91;&#93; = &#123;</span></CodeLine>
<Link id="l04583" /><CodeLine lineNumber="4583"><span class="doxyHighlight">          Imms.begin(), std::prev(Imms.end()),</span></CodeLine>
<Link id="l04584" /><CodeLine lineNumber="4584"><span class="doxyHighlight">          Imms.lower&#95;bound(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#abf8d7bdfa32234118ad9869341fec341">Immediate::get</a>(Avg, Scalable))&#125;;</span></CodeLine>
<Link id="l04585" /><CodeLine lineNumber="4585"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;M : OtherImms) &#123;</span></CodeLine>
<Link id="l04586" /><CodeLine lineNumber="4586"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (M == J || M == JE) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04587" /><CodeLine lineNumber="4587"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!JImm.isCompatibleImmediate(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>-&gt;first))</span></CodeLine>
<Link id="l04588" /><CodeLine lineNumber="4588"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04589" /><CodeLine lineNumber="4589"></CodeLine>
<Link id="l04590" /><CodeLine lineNumber="4590"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Compute the difference between the two.</span></CodeLine>
<Link id="l04591" /><CodeLine lineNumber="4591"><span class="doxyHighlight">        Immediate <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a> = JImm.subUnsigned(<a href="/docs/api/namespaces/llvm/arm/#ac2456158e5acb44477d8ecfa2d04dbdea69691c7bdcc3ce6d5d8a1361f22d04ac">M</a>-&gt;first);</span></CodeLine>
<Link id="l04592" /><CodeLine lineNumber="4592"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LUIdx : UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#a72bc4f47a61dc9d9888561c4dc22e8f6">set&#95;bits</a>())</span></CodeLine>
<Link id="l04593" /><CodeLine lineNumber="4593"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Make a memo of this use, offset, and register tuple.</span></CodeLine>
<Link id="l04594" /><CodeLine lineNumber="4594"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UniqueItems.<a href="/docs/api/classes/llvm/smallset/#afcadfef2cf37c3e6dbdbc9cd7bea50a0">insert</a>(std::make&#95;pair(LUIdx, Imm)).second)</span></CodeLine>
<Link id="l04595" /><CodeLine lineNumber="4595"><span class="doxyHighlight">            WorkItems.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(WorkItem(LUIdx, Imm, OrigReg));</span></CodeLine>
<Link id="l04596" /><CodeLine lineNumber="4596"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04597" /><CodeLine lineNumber="4597"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04598" /><CodeLine lineNumber="4598"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04599" /><CodeLine lineNumber="4599"></CodeLine>
<Link id="l04600" /><CodeLine lineNumber="4600"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/msgpack/#afdae9da66bac09f4b2bfc0fd9f0559e6a46f3ea056caa3126b91f3f70beea068c">Map</a>.clear();</span></CodeLine>
<Link id="l04601" /><CodeLine lineNumber="4601"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/objcarc/#a845b8f76f8bd22e4e2eb851121db306d">Sequence</a>.clear();</span></CodeLine>
<Link id="l04602" /><CodeLine lineNumber="4602"><span class="doxyHighlight">  UsedByIndicesMap.<a href="/docs/api/classes/llvm/densemapbase/#adf4e7878fc0b3b8dcde545178564190d">clear</a>();</span></CodeLine>
<Link id="l04603" /><CodeLine lineNumber="4603"><span class="doxyHighlight">  UniqueItems.<a href="/docs/api/classes/llvm/smallset/#a76b3fc7c102561fb5210d5151531e409">clear</a>();</span></CodeLine>
<Link id="l04604" /><CodeLine lineNumber="4604"></CodeLine>
<Link id="l04605" /><CodeLine lineNumber="4605"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now iterate through the worklist and add new formulae.</span></CodeLine>
<Link id="l04606" /><CodeLine lineNumber="4606"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> WorkItem &amp;WI : WorkItems) &#123;</span></CodeLine>
<Link id="l04607" /><CodeLine lineNumber="4607"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = WI.LUIdx;</span></CodeLine>
<Link id="l04608" /><CodeLine lineNumber="4608"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l04609" /><CodeLine lineNumber="4609"><span class="doxyHighlight">    Immediate <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a> = WI.Imm;</span></CodeLine>
<Link id="l04610" /><CodeLine lineNumber="4610"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;OrigReg = WI.OrigReg;</span></CodeLine>
<Link id="l04611" /><CodeLine lineNumber="4611"></CodeLine>
<Link id="l04612" /><CodeLine lineNumber="4612"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = SE.getEffectiveSCEVType(OrigReg-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>());</span></CodeLine>
<Link id="l04613" /><CodeLine lineNumber="4613"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NegImmS = <a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a>.getNegativeSCEV(SE, IntTy);</span></CodeLine>
<Link id="l04614" /><CodeLine lineNumber="4614"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a> = SE.getTypeSizeInBits(IntTy);</span></CodeLine>
<Link id="l04615" /><CodeLine lineNumber="4615"></CodeLine>
<Link id="l04616" /><CodeLine lineNumber="4616"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// TODO: Use a more targeted data structure.</span></CodeLine>
<Link id="l04617" /><CodeLine lineNumber="4617"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> L = 0, LE = LU.Formulae.size(); L != LE; ++L) &#123;</span></CodeLine>
<Link id="l04618" /><CodeLine lineNumber="4618"><span class="doxyHighlight">      Formula <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>&#93;;</span></CodeLine>
<Link id="l04619" /><CodeLine lineNumber="4619"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// FIXME: The code for the scaled and unscaled registers looks</span></CodeLine>
<Link id="l04620" /><CodeLine lineNumber="4620"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// very similar but slightly different. Investigate if they</span></CodeLine>
<Link id="l04621" /><CodeLine lineNumber="4621"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// could be merged. That way, we would not have to unscale the</span></CodeLine>
<Link id="l04622" /><CodeLine lineNumber="4622"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Formula.</span></CodeLine>
<Link id="l04623" /><CodeLine lineNumber="4623"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.unscale();</span></CodeLine>
<Link id="l04624" /><CodeLine lineNumber="4624"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Use the immediate in the scaled register.</span></CodeLine>
<Link id="l04625" /><CodeLine lineNumber="4625"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg == OrigReg) &#123;</span></CodeLine>
<Link id="l04626" /><CodeLine lineNumber="4626"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isCompatibleImmediate(Imm))</span></CodeLine>
<Link id="l04627" /><CodeLine lineNumber="4627"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04628" /><CodeLine lineNumber="4628"><span class="doxyHighlight">        Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.addUnsigned(<a href="/docs/api/namespaces/llvm/amdgpu/#a4554b8c1e903115f6d7c75b0cc8900dcae71a5bce3c21304da97e1e5d3dab0ed3">Imm</a>.mulUnsigned(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale));</span></CodeLine>
<Link id="l04629" /><CodeLine lineNumber="4629"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Don&#39;t create 50 + reg(-50).</span></CodeLine>
<Link id="l04630" /><CodeLine lineNumber="4630"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getNegativeSCEV(SE, IntTy);</span></CodeLine>
<Link id="l04631" /><CodeLine lineNumber="4631"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.referencesReg(S))</span></CodeLine>
<Link id="l04632" /><CodeLine lineNumber="4632"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04633" /><CodeLine lineNumber="4633"><span class="doxyHighlight">        Formula NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</span></CodeLine>
<Link id="l04634" /><CodeLine lineNumber="4634"><span class="doxyHighlight">        NewF.BaseOffset = <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</span></CodeLine>
<Link id="l04635" /><CodeLine lineNumber="4635"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy,</span></CodeLine>
<Link id="l04636" /><CodeLine lineNumber="4636"><span class="doxyHighlight">                        NewF))</span></CodeLine>
<Link id="l04637" /><CodeLine lineNumber="4637"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04638" /><CodeLine lineNumber="4638"><span class="doxyHighlight">        NewF.ScaledReg = SE.getAddExpr(NegImmS, NewF.ScaledReg);</span></CodeLine>
<Link id="l04639" /><CodeLine lineNumber="4639"></CodeLine>
<Link id="l04640" /><CodeLine lineNumber="4640"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If the new scale is a constant in a register, and adding the constant</span></CodeLine>
<Link id="l04641" /><CodeLine lineNumber="4641"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// value to the immediate would produce a value closer to zero than the</span></CodeLine>
<Link id="l04642" /><CodeLine lineNumber="4642"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// immediate itself, then the formula isn&#39;t worthwhile.</span></CodeLine>
<Link id="l04643" /><CodeLine lineNumber="4643"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(NewF.ScaledReg)) &#123;</span></CodeLine>
<Link id="l04644" /><CodeLine lineNumber="4644"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// FIXME: Do we need to do something for scalable immediates here?</span></CodeLine>
<Link id="l04645" /><CodeLine lineNumber="4645"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">//        A scalable SCEV won&#39;t be constant, but we might still have</span></CodeLine>
<Link id="l04646" /><CodeLine lineNumber="4646"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">//        something in the offset? Bail out for now to be safe.</span></CodeLine>
<Link id="l04647" /><CodeLine lineNumber="4647"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewF.BaseOffset.isNonZero() &amp;&amp; NewF.BaseOffset.isScalable())</span></CodeLine>
<Link id="l04648" /><CodeLine lineNumber="4648"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04649" /><CodeLine lineNumber="4649"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue()-&gt;isNegative() !=</span></CodeLine>
<Link id="l04650" /><CodeLine lineNumber="4650"><span class="doxyHighlight">                  (NewF.BaseOffset.isLessThanZero()) &amp;&amp;</span></CodeLine>
<Link id="l04651" /><CodeLine lineNumber="4651"><span class="doxyHighlight">              (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().abs() &#42; <a href="/docs/api/classes/llvm/apint">APInt</a>(<a href="/docs/api/namespaces/llvm/#abee0df5f7f703bb4462aba260ba0a60f">BitWidth</a>, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale))</span></CodeLine>
<Link id="l04652" /><CodeLine lineNumber="4652"><span class="doxyHighlight">                  .ule(std::abs(NewF.BaseOffset.getFixedValue())))</span></CodeLine>
<Link id="l04653" /><CodeLine lineNumber="4653"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04654" /><CodeLine lineNumber="4654"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l04655" /><CodeLine lineNumber="4655"></CodeLine>
<Link id="l04656" /><CodeLine lineNumber="4656"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// OK, looks good.</span></CodeLine>
<Link id="l04657" /><CodeLine lineNumber="4657"><span class="doxyHighlight">        NewF.canonicalize(&#42;this-&gt;L);</span></CodeLine>
<Link id="l04658" /><CodeLine lineNumber="4658"><span class="doxyHighlight">        (void)InsertFormula(LU, LUIdx, NewF);</span></CodeLine>
<Link id="l04659" /><CodeLine lineNumber="4659"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l04660" /><CodeLine lineNumber="4660"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Use the immediate in a base register.</span></CodeLine>
<Link id="l04661" /><CodeLine lineNumber="4661"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> = 0, NE = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.size(); <a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a> != NE; ++<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>) &#123;</span></CodeLine>
<Link id="l04662" /><CodeLine lineNumber="4662"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>&#93;;</span></CodeLine>
<Link id="l04663" /><CodeLine lineNumber="4663"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaseReg != OrigReg)</span></CodeLine>
<Link id="l04664" /><CodeLine lineNumber="4664"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04665" /><CodeLine lineNumber="4665"><span class="doxyHighlight">          Formula NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</span></CodeLine>
<Link id="l04666" /><CodeLine lineNumber="4666"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewF.BaseOffset.isCompatibleImmediate(Imm) ||</span></CodeLine>
<Link id="l04667" /><CodeLine lineNumber="4667"><span class="doxyHighlight">              !NewF.UnfoldedOffset.isCompatibleImmediate(Imm) ||</span></CodeLine>
<Link id="l04668" /><CodeLine lineNumber="4668"><span class="doxyHighlight">              !NewF.BaseOffset.isCompatibleImmediate(NewF.UnfoldedOffset))</span></CodeLine>
<Link id="l04669" /><CodeLine lineNumber="4669"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04670" /><CodeLine lineNumber="4670"><span class="doxyHighlight">          NewF.BaseOffset = NewF.BaseOffset.addUnsigned(Imm);</span></CodeLine>
<Link id="l04671" /><CodeLine lineNumber="4671"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU.MinOffset, LU.MaxOffset,</span></CodeLine>
<Link id="l04672" /><CodeLine lineNumber="4672"><span class="doxyHighlight">                          LU.Kind, LU.AccessTy, NewF)) &#123;</span></CodeLine>
<Link id="l04673" /><CodeLine lineNumber="4673"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AMK == <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a> &amp;&amp;</span></CodeLine>
<Link id="l04674" /><CodeLine lineNumber="4674"><span class="doxyHighlight">                <a href="#a187751c86d349fac41ddc1b807b40b22">mayUsePostIncMode</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU, OrigReg, this-&gt;L, SE))</span></CodeLine>
<Link id="l04675" /><CodeLine lineNumber="4675"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04676" /><CodeLine lineNumber="4676"><span class="doxyHighlight">            Immediate NewUnfoldedOffset = NewF.UnfoldedOffset.addUnsigned(Imm);</span></CodeLine>
<Link id="l04677" /><CodeLine lineNumber="4677"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a52f2bc4870549427a397721a7de9849f">isLegalAddImmediate</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, NewUnfoldedOffset))</span></CodeLine>
<Link id="l04678" /><CodeLine lineNumber="4678"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04679" /><CodeLine lineNumber="4679"><span class="doxyHighlight">            NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</span></CodeLine>
<Link id="l04680" /><CodeLine lineNumber="4680"><span class="doxyHighlight">            NewF.UnfoldedOffset = NewUnfoldedOffset;</span></CodeLine>
<Link id="l04681" /><CodeLine lineNumber="4681"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l04682" /><CodeLine lineNumber="4682"><span class="doxyHighlight">          NewF.BaseRegs&#91;<a href="/docs/api/files/lib/lib/support/regcomp-c/#a0240ac851181b84ac374872dc5434ee4">N</a>&#93; = SE.getAddExpr(NegImmS, BaseReg);</span></CodeLine>
<Link id="l04683" /><CodeLine lineNumber="4683"></CodeLine>
<Link id="l04684" /><CodeLine lineNumber="4684"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// If the new formula has a constant in a register, and adding the</span></CodeLine>
<Link id="l04685" /><CodeLine lineNumber="4685"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// constant value to the immediate would produce a value closer to</span></CodeLine>
<Link id="l04686" /><CodeLine lineNumber="4686"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// zero than the immediate itself, then the formula isn&#39;t worthwhile.</span></CodeLine>
<Link id="l04687" /><CodeLine lineNumber="4687"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;NewReg : NewF.BaseRegs)</span></CodeLine>
<Link id="l04688" /><CodeLine lineNumber="4688"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(NewReg)) &#123;</span></CodeLine>
<Link id="l04689" /><CodeLine lineNumber="4689"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewF.BaseOffset.isNonZero() &amp;&amp; NewF.BaseOffset.isScalable())</span></CodeLine>
<Link id="l04690" /><CodeLine lineNumber="4690"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">goto</span><span class="doxyHighlight"> skip&#95;formula;</span></CodeLine>
<Link id="l04691" /><CodeLine lineNumber="4691"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt() + NewF.BaseOffset.getFixedValue())</span></CodeLine>
<Link id="l04692" /><CodeLine lineNumber="4692"><span class="doxyHighlight">                      .abs()</span></CodeLine>
<Link id="l04693" /><CodeLine lineNumber="4693"><span class="doxyHighlight">                      .slt(std::abs(NewF.BaseOffset.getFixedValue())) &amp;&amp;</span></CodeLine>
<Link id="l04694" /><CodeLine lineNumber="4694"><span class="doxyHighlight">                  (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt() + NewF.BaseOffset.getFixedValue())</span></CodeLine>
<Link id="l04695" /><CodeLine lineNumber="4695"><span class="doxyHighlight">                          .countr&#95;zero() &gt;=</span></CodeLine>
<Link id="l04696" /><CodeLine lineNumber="4696"><span class="doxyHighlight">                      (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight">)<a href="/docs/api/namespaces/llvm/#a57d2f9ee99e9e68cff564d0d579c8163">llvm::countr&#95;zero&lt;uint64&#95;t&gt;</a>(</span></CodeLine>
<Link id="l04697" /><CodeLine lineNumber="4697"><span class="doxyHighlight">                          NewF.BaseOffset.getFixedValue()))</span></CodeLine>
<Link id="l04698" /><CodeLine lineNumber="4698"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">goto</span><span class="doxyHighlight"> skip&#95;formula;</span></CodeLine>
<Link id="l04699" /><CodeLine lineNumber="4699"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l04700" /><CodeLine lineNumber="4700"></CodeLine>
<Link id="l04701" /><CodeLine lineNumber="4701"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Ok, looks good.</span></CodeLine>
<Link id="l04702" /><CodeLine lineNumber="4702"><span class="doxyHighlight">          NewF.canonicalize(&#42;this-&gt;L);</span></CodeLine>
<Link id="l04703" /><CodeLine lineNumber="4703"><span class="doxyHighlight">          (void)InsertFormula(LU, LUIdx, NewF);</span></CodeLine>
<Link id="l04704" /><CodeLine lineNumber="4704"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04705" /><CodeLine lineNumber="4705"><span class="doxyHighlight">        skip&#95;formula:;</span></CodeLine>
<Link id="l04706" /><CodeLine lineNumber="4706"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l04707" /><CodeLine lineNumber="4707"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04708" /><CodeLine lineNumber="4708"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04709" /><CodeLine lineNumber="4709"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04710" /><CodeLine lineNumber="4710"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04711" /><CodeLine lineNumber="4711"></CodeLine>
<Link id="l04712" /><CodeLine lineNumber="4712"><span class="doxyHighlightComment">/// Generate formulae for each use.</span></CodeLine>
<Link id="l04713" /><CodeLine lineNumber="4713"><span class="doxyHighlightKeywordType">void</span></CodeLine>
<Link id="l04714" /><CodeLine lineNumber="4714"><span class="doxyHighlight">LSRInstance::GenerateAllReuseFormulae() &#123;</span></CodeLine>
<Link id="l04715" /><CodeLine lineNumber="4715"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This is split into multiple loops so that hasRegsUsedByUsesOtherThan</span></CodeLine>
<Link id="l04716" /><CodeLine lineNumber="4716"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// queries are more precise.</span></CodeLine>
<Link id="l04717" /><CodeLine lineNumber="4717"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l04718" /><CodeLine lineNumber="4718"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l04719" /><CodeLine lineNumber="4719"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, f = LU.Formulae.size(); i != f; ++i)</span></CodeLine>
<Link id="l04720" /><CodeLine lineNumber="4720"><span class="doxyHighlight">      GenerateReassociations(LU, LUIdx, LU.Formulae&#91;i&#93;);</span></CodeLine>
<Link id="l04721" /><CodeLine lineNumber="4721"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, f = LU.Formulae.size(); i != f; ++i)</span></CodeLine>
<Link id="l04722" /><CodeLine lineNumber="4722"><span class="doxyHighlight">      GenerateCombinations(LU, LUIdx, LU.Formulae&#91;i&#93;);</span></CodeLine>
<Link id="l04723" /><CodeLine lineNumber="4723"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04724" /><CodeLine lineNumber="4724"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l04725" /><CodeLine lineNumber="4725"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l04726" /><CodeLine lineNumber="4726"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, f = LU.Formulae.size(); i != f; ++i)</span></CodeLine>
<Link id="l04727" /><CodeLine lineNumber="4727"><span class="doxyHighlight">      GenerateSymbolicOffsets(LU, LUIdx, LU.Formulae&#91;i&#93;);</span></CodeLine>
<Link id="l04728" /><CodeLine lineNumber="4728"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, f = LU.Formulae.size(); i != f; ++i)</span></CodeLine>
<Link id="l04729" /><CodeLine lineNumber="4729"><span class="doxyHighlight">      GenerateConstantOffsets(LU, LUIdx, LU.Formulae&#91;i&#93;);</span></CodeLine>
<Link id="l04730" /><CodeLine lineNumber="4730"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, f = LU.Formulae.size(); i != f; ++i)</span></CodeLine>
<Link id="l04731" /><CodeLine lineNumber="4731"><span class="doxyHighlight">      GenerateICmpZeroScales(LU, LUIdx, LU.Formulae&#91;i&#93;);</span></CodeLine>
<Link id="l04732" /><CodeLine lineNumber="4732"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, f = LU.Formulae.size(); i != f; ++i)</span></CodeLine>
<Link id="l04733" /><CodeLine lineNumber="4733"><span class="doxyHighlight">      GenerateScales(LU, LUIdx, LU.Formulae&#91;i&#93;);</span></CodeLine>
<Link id="l04734" /><CodeLine lineNumber="4734"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04735" /><CodeLine lineNumber="4735"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l04736" /><CodeLine lineNumber="4736"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l04737" /><CodeLine lineNumber="4737"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, f = LU.Formulae.size(); i != f; ++i)</span></CodeLine>
<Link id="l04738" /><CodeLine lineNumber="4738"><span class="doxyHighlight">      GenerateTruncates(LU, LUIdx, LU.Formulae&#91;i&#93;);</span></CodeLine>
<Link id="l04739" /><CodeLine lineNumber="4739"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04740" /><CodeLine lineNumber="4740"></CodeLine>
<Link id="l04741" /><CodeLine lineNumber="4741"><span class="doxyHighlight">  GenerateCrossUseConstantOffsets();</span></CodeLine>
<Link id="l04742" /><CodeLine lineNumber="4742"></CodeLine>
<Link id="l04743" /><CodeLine lineNumber="4743"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span></CodeLine>
<Link id="l04744" /><CodeLine lineNumber="4744"><span class="doxyHighlight">                       </span><span class="doxyHighlightStringLiteral">&quot;After generating reuse formulae:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04745" /><CodeLine lineNumber="4745"><span class="doxyHighlight">             print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l04746" /><CodeLine lineNumber="4746"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04747" /><CodeLine lineNumber="4747"></CodeLine>
<Link id="l04748" /><CodeLine lineNumber="4748"><span class="doxyHighlightComment">/// If there are multiple formulae with the same set of registers used</span></CodeLine>
<Link id="l04749" /><CodeLine lineNumber="4749"><span class="doxyHighlightComment">/// by other uses, pick the best one and delete the others.</span></CodeLine>
<Link id="l04750" /><CodeLine lineNumber="4750"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::FilterOutUndesirableDedicatedRegisters() &#123;</span></CodeLine>
<Link id="l04751" /><CodeLine lineNumber="4751"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> VisitedRegs;</span></CodeLine>
<Link id="l04752" /><CodeLine lineNumber="4752"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> Regs;</span></CodeLine>
<Link id="l04753" /><CodeLine lineNumber="4753"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> LoserRegs;</span></CodeLine>
<Link id="l04754" /><CodeLine lineNumber="4754"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l04755" /><CodeLine lineNumber="4755"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ChangedFormulae = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04756" /><CodeLine lineNumber="4756"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l04757" /><CodeLine lineNumber="4757"></CodeLine>
<Link id="l04758" /><CodeLine lineNumber="4758"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Collect the best formula for each unique set of shared registers. This</span></CodeLine>
<Link id="l04759" /><CodeLine lineNumber="4759"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is reset for each use.</span></CodeLine>
<Link id="l04760" /><CodeLine lineNumber="4760"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight">BestFormulaeTy =</span></CodeLine>
<Link id="l04761" /><CodeLine lineNumber="4761"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;SmallVector&lt;const SCEV &#42;, 4&gt;</a>, size&#95;t, UniquifierDenseMapInfo&gt;;</span></CodeLine>
<Link id="l04762" /><CodeLine lineNumber="4762"></CodeLine>
<Link id="l04763" /><CodeLine lineNumber="4763"><span class="doxyHighlight">  BestFormulaeTy BestFormulae;</span></CodeLine>
<Link id="l04764" /><CodeLine lineNumber="4764"></CodeLine>
<Link id="l04765" /><CodeLine lineNumber="4765"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l04766" /><CodeLine lineNumber="4766"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l04767" /><CodeLine lineNumber="4767"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Filtering for use &quot;</span><span class="doxyHighlight">; LU.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l04768" /><CodeLine lineNumber="4768"><span class="doxyHighlight">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04769" /><CodeLine lineNumber="4769"></CodeLine>
<Link id="l04770" /><CodeLine lineNumber="4770"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04771" /><CodeLine lineNumber="4771"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> FIdx = 0, NumForms = LU.Formulae.size();</span></CodeLine>
<Link id="l04772" /><CodeLine lineNumber="4772"><span class="doxyHighlight">         FIdx != NumForms; ++FIdx) &#123;</span></CodeLine>
<Link id="l04773" /><CodeLine lineNumber="4773"><span class="doxyHighlight">      Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;FIdx&#93;;</span></CodeLine>
<Link id="l04774" /><CodeLine lineNumber="4774"></CodeLine>
<Link id="l04775" /><CodeLine lineNumber="4775"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Some formulas are instant losers. For example, they may depend on</span></CodeLine>
<Link id="l04776" /><CodeLine lineNumber="4776"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// nonexistent AddRecs from other loops. These need to be filtered</span></CodeLine>
<Link id="l04777" /><CodeLine lineNumber="4777"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// immediately, otherwise heuristics could choose them over others leading</span></CodeLine>
<Link id="l04778" /><CodeLine lineNumber="4778"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// to an unsatisfactory solution. Passing LoserRegs into RateFormula here</span></CodeLine>
<Link id="l04779" /><CodeLine lineNumber="4779"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// avoids the need to recompute this information across formulae using the</span></CodeLine>
<Link id="l04780" /><CodeLine lineNumber="4780"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// same bad AddRec. Passing LoserRegs is also essential unless we remove</span></CodeLine>
<Link id="l04781" /><CodeLine lineNumber="4781"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// the corresponding bad register from the Regs set.</span></CodeLine>
<Link id="l04782" /><CodeLine lineNumber="4782"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CostF(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</span></CodeLine>
<Link id="l04783" /><CodeLine lineNumber="4783"><span class="doxyHighlight">      Regs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</span></CodeLine>
<Link id="l04784" /><CodeLine lineNumber="4784"><span class="doxyHighlight">      CostF.RateFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Regs, VisitedRegs, LU, &amp;LoserRegs);</span></CodeLine>
<Link id="l04785" /><CodeLine lineNumber="4785"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CostF.isLoser()) &#123;</span></CodeLine>
<Link id="l04786" /><CodeLine lineNumber="4786"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// During initial formula generation, undesirable formulae are generated</span></CodeLine>
<Link id="l04787" /><CodeLine lineNumber="4787"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// by uses within other loops that have some non-trivial address mode or</span></CodeLine>
<Link id="l04788" /><CodeLine lineNumber="4788"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// use the postinc form of the IV. LSR needs to provide these formulae</span></CodeLine>
<Link id="l04789" /><CodeLine lineNumber="4789"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// as the basis of rediscovering the desired formula that uses an AddRec</span></CodeLine>
<Link id="l04790" /><CodeLine lineNumber="4790"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// corresponding to the existing phi. Once all formulae have been</span></CodeLine>
<Link id="l04791" /><CodeLine lineNumber="4791"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// generated, these initial losers may be pruned.</span></CodeLine>
<Link id="l04792" /><CodeLine lineNumber="4792"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Filtering loser &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l04793" /><CodeLine lineNumber="4793"><span class="doxyHighlight">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04794" /><CodeLine lineNumber="4794"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04795" /><CodeLine lineNumber="4795"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l04796" /><CodeLine lineNumber="4796"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 4&gt;</a> <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>;</span></CodeLine>
<Link id="l04797" /><CodeLine lineNumber="4797"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</span></CodeLine>
<Link id="l04798" /><CodeLine lineNumber="4798"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RegUses.isRegUsedByUsesOtherThan(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, LUIdx))</span></CodeLine>
<Link id="l04799" /><CodeLine lineNumber="4799"><span class="doxyHighlight">            <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>.push&#95;back(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l04800" /><CodeLine lineNumber="4800"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l04801" /><CodeLine lineNumber="4801"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg &amp;&amp;</span></CodeLine>
<Link id="l04802" /><CodeLine lineNumber="4802"><span class="doxyHighlight">            RegUses.isRegUsedByUsesOtherThan(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, LUIdx))</span></CodeLine>
<Link id="l04803" /><CodeLine lineNumber="4803"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>.push&#95;back(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</span></CodeLine>
<Link id="l04804" /><CodeLine lineNumber="4804"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Unstable sort by host order ok, because this is only used for</span></CodeLine>
<Link id="l04805" /><CodeLine lineNumber="4805"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// uniquifying.</span></CodeLine>
<Link id="l04806" /><CodeLine lineNumber="4806"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>);</span></CodeLine>
<Link id="l04807" /><CodeLine lineNumber="4807"></CodeLine>
<Link id="l04808" /><CodeLine lineNumber="4808"><span class="doxyHighlight">        std::pair&lt;BestFormulaeTy::const&#95;iterator, bool&gt; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> =</span></CodeLine>
<Link id="l04809" /><CodeLine lineNumber="4809"><span class="doxyHighlight">          BestFormulae.insert(std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a98c6256d0644613c6b5b3e2ef06ef5ce">Key</a>, FIdx));</span></CodeLine>
<Link id="l04810" /><CodeLine lineNumber="4810"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second)</span></CodeLine>
<Link id="l04811" /><CodeLine lineNumber="4811"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04812" /><CodeLine lineNumber="4812"></CodeLine>
<Link id="l04813" /><CodeLine lineNumber="4813"><span class="doxyHighlight">        Formula &amp;Best = LU.Formulae&#91;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;second&#93;;</span></CodeLine>
<Link id="l04814" /><CodeLine lineNumber="4814"></CodeLine>
<Link id="l04815" /><CodeLine lineNumber="4815"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CostBest(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</span></CodeLine>
<Link id="l04816" /><CodeLine lineNumber="4816"><span class="doxyHighlight">        Regs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</span></CodeLine>
<Link id="l04817" /><CodeLine lineNumber="4817"><span class="doxyHighlight">        CostBest.RateFormula(Best, Regs, VisitedRegs, LU);</span></CodeLine>
<Link id="l04818" /><CodeLine lineNumber="4818"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CostF.isLess(CostBest))</span></CodeLine>
<Link id="l04819" /><CodeLine lineNumber="4819"><span class="doxyHighlight">          <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Best);</span></CodeLine>
<Link id="l04820" /><CodeLine lineNumber="4820"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Filtering out formula &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l04821" /><CodeLine lineNumber="4821"><span class="doxyHighlight">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span></CodeLine>
<Link id="l04822" /><CodeLine lineNumber="4822"><span class="doxyHighlight">                             </span><span class="doxyHighlightStringLiteral">&quot;    in favor of formula &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04823" /><CodeLine lineNumber="4823"><span class="doxyHighlight">                   Best.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04824" /><CodeLine lineNumber="4824"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04825" /><CodeLine lineNumber="4825"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l04826" /><CodeLine lineNumber="4826"><span class="doxyHighlight">      ChangedFormulae = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04827" /><CodeLine lineNumber="4827"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l04828" /><CodeLine lineNumber="4828"><span class="doxyHighlight">      LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04829" /><CodeLine lineNumber="4829"><span class="doxyHighlight">      --FIdx;</span></CodeLine>
<Link id="l04830" /><CodeLine lineNumber="4830"><span class="doxyHighlight">      --NumForms;</span></CodeLine>
<Link id="l04831" /><CodeLine lineNumber="4831"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04832" /><CodeLine lineNumber="4832"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04833" /><CodeLine lineNumber="4833"></CodeLine>
<Link id="l04834" /><CodeLine lineNumber="4834"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Now that we&#39;ve filtered out some formulae, recompute the Regs set.</span></CodeLine>
<Link id="l04835" /><CodeLine lineNumber="4835"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/any">Any</a>)</span></CodeLine>
<Link id="l04836" /><CodeLine lineNumber="4836"><span class="doxyHighlight">      LU.RecomputeRegs(LUIdx, RegUses);</span></CodeLine>
<Link id="l04837" /><CodeLine lineNumber="4837"></CodeLine>
<Link id="l04838" /><CodeLine lineNumber="4838"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Reset this to prepare for the next use.</span></CodeLine>
<Link id="l04839" /><CodeLine lineNumber="4839"><span class="doxyHighlight">    BestFormulae.clear();</span></CodeLine>
<Link id="l04840" /><CodeLine lineNumber="4840"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04841" /><CodeLine lineNumber="4841"></CodeLine>
<Link id="l04842" /><CodeLine lineNumber="4842"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ChangedFormulae) &#123;</span></CodeLine>
<Link id="l04843" /><CodeLine lineNumber="4843"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span></CodeLine>
<Link id="l04844" /><CodeLine lineNumber="4844"><span class="doxyHighlight">              </span><span class="doxyHighlightStringLiteral">&quot;After filtering out undesirable candidates:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04845" /><CodeLine lineNumber="4845"><span class="doxyHighlight">    print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l04846" /><CodeLine lineNumber="4846"><span class="doxyHighlight">  &#125;);</span></CodeLine>
<Link id="l04847" /><CodeLine lineNumber="4847"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04848" /><CodeLine lineNumber="4848"></CodeLine>
<Link id="l04849" /><CodeLine lineNumber="4849"><span class="doxyHighlightComment">/// Estimate the worst-case number of solutions the solver might have to</span></CodeLine>
<Link id="l04850" /><CodeLine lineNumber="4850"><span class="doxyHighlightComment">/// consider. It almost never considers this many solutions because it prune the</span></CodeLine>
<Link id="l04851" /><CodeLine lineNumber="4851"><span class="doxyHighlightComment">/// search space, but the pruning isn&#39;t always sufficient.</span></CodeLine>
<Link id="l04852" /><CodeLine lineNumber="4852"><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LSRInstance::EstimateSearchSpaceComplexity()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l04853" /><CodeLine lineNumber="4853"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> Power = 1;</span></CodeLine>
<Link id="l04854" /><CodeLine lineNumber="4854"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>) &#123;</span></CodeLine>
<Link id="l04855" /><CodeLine lineNumber="4855"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> FSize = LU.Formulae.size();</span></CodeLine>
<Link id="l04856" /><CodeLine lineNumber="4856"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FSize &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>) &#123;</span></CodeLine>
<Link id="l04857" /><CodeLine lineNumber="4857"><span class="doxyHighlight">      Power = <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>;</span></CodeLine>
<Link id="l04858" /><CodeLine lineNumber="4858"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04859" /><CodeLine lineNumber="4859"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04860" /><CodeLine lineNumber="4860"><span class="doxyHighlight">    Power &#42;= FSize;</span></CodeLine>
<Link id="l04861" /><CodeLine lineNumber="4861"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Power &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</span></CodeLine>
<Link id="l04862" /><CodeLine lineNumber="4862"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04863" /><CodeLine lineNumber="4863"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04864" /><CodeLine lineNumber="4864"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Power;</span></CodeLine>
<Link id="l04865" /><CodeLine lineNumber="4865"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04866" /><CodeLine lineNumber="4866"></CodeLine>
<Link id="l04867" /><CodeLine lineNumber="4867"><span class="doxyHighlightComment">/// When one formula uses a superset of the registers of another formula, it</span></CodeLine>
<Link id="l04868" /><CodeLine lineNumber="4868"><span class="doxyHighlightComment">/// won&#39;t help reduce register pressure (though it may not necessarily hurt</span></CodeLine>
<Link id="l04869" /><CodeLine lineNumber="4869"><span class="doxyHighlightComment">/// register pressure); remove it to simplify the system.</span></CodeLine>
<Link id="l04870" /><CodeLine lineNumber="4870"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::NarrowSearchSpaceByDetectingSupersets() &#123;</span></CodeLine>
<Link id="l04871" /><CodeLine lineNumber="4871"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EstimateSearchSpaceComplexity() &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>) &#123;</span></CodeLine>
<Link id="l04872" /><CodeLine lineNumber="4872"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;The search space is too complex.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04873" /><CodeLine lineNumber="4873"></CodeLine>
<Link id="l04874" /><CodeLine lineNumber="4874"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Narrowing the search space by eliminating formulae &quot;</span></CodeLine>
<Link id="l04875" /><CodeLine lineNumber="4875"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;which use a superset of registers used by other &quot;</span></CodeLine>
<Link id="l04876" /><CodeLine lineNumber="4876"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;formulae.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04877" /><CodeLine lineNumber="4877"></CodeLine>
<Link id="l04878" /><CodeLine lineNumber="4878"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l04879" /><CodeLine lineNumber="4879"><span class="doxyHighlight">      LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l04880" /><CodeLine lineNumber="4880"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04881" /><CodeLine lineNumber="4881"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = LU.Formulae.size(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l04882" /><CodeLine lineNumber="4882"><span class="doxyHighlight">        Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;i&#93;;</span></CodeLine>
<Link id="l04883" /><CodeLine lineNumber="4883"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isNonZero() &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isScalable())</span></CodeLine>
<Link id="l04884" /><CodeLine lineNumber="4884"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04885" /><CodeLine lineNumber="4885"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Look for a formula with a constant or GV in a register. If the use</span></CodeLine>
<Link id="l04886" /><CodeLine lineNumber="4886"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// also has a formula with that same value in an immediate field,</span></CodeLine>
<Link id="l04887" /><CodeLine lineNumber="4887"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// delete the one that uses a register.</span></CodeLine>
<Link id="l04888" /><CodeLine lineNumber="4888"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/smallvectorimpl/#a641b0782e0cc309372855bfc19fdfd97">SmallVectorImpl&lt;const SCEV &#42;&gt;::const&#95;iterator</a></span></CodeLine>
<Link id="l04889" /><CodeLine lineNumber="4889"><span class="doxyHighlight">             <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin(), <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.end(); <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l04890" /><CodeLine lineNumber="4890"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &#123;</span></CodeLine>
<Link id="l04891" /><CodeLine lineNumber="4891"><span class="doxyHighlight">            Formula NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</span></CodeLine>
<Link id="l04892" /><CodeLine lineNumber="4892"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">//FIXME: Formulas should store bitwidth to do wrapping properly.</span></CodeLine>
<Link id="l04893" /><CodeLine lineNumber="4893"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">//       See PR41034.</span></CodeLine>
<Link id="l04894" /><CodeLine lineNumber="4894"><span class="doxyHighlight">            NewF.BaseOffset =</span></CodeLine>
<Link id="l04895" /><CodeLine lineNumber="4895"><span class="doxyHighlight">                <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/immediate/#a4c40dacbda1659252704b6d78a6c9069">Immediate::getFixed</a>(NewF.BaseOffset.getFixedValue() +</span></CodeLine>
<Link id="l04896" /><CodeLine lineNumber="4896"><span class="doxyHighlight">                                    (uint64&#95;t)<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getValue()-&gt;getSExtValue());</span></CodeLine>
<Link id="l04897" /><CodeLine lineNumber="4897"><span class="doxyHighlight">            NewF.BaseRegs.erase(NewF.BaseRegs.begin() +</span></CodeLine>
<Link id="l04898" /><CodeLine lineNumber="4898"><span class="doxyHighlight">                                (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> - <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin()));</span></CodeLine>
<Link id="l04899" /><CodeLine lineNumber="4899"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.HasFormulaWithSameRegs(NewF)) &#123;</span></CodeLine>
<Link id="l04900" /><CodeLine lineNumber="4900"><span class="doxyHighlight">              <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Deleting &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l04901" /><CodeLine lineNumber="4901"><span class="doxyHighlight">                         <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04902" /><CodeLine lineNumber="4902"><span class="doxyHighlight">              LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04903" /><CodeLine lineNumber="4903"><span class="doxyHighlight">              --i;</span></CodeLine>
<Link id="l04904" /><CodeLine lineNumber="4904"><span class="doxyHighlight">              --<a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a>;</span></CodeLine>
<Link id="l04905" /><CodeLine lineNumber="4905"><span class="doxyHighlight">              <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04906" /><CodeLine lineNumber="4906"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04907" /><CodeLine lineNumber="4907"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l04908" /><CodeLine lineNumber="4908"><span class="doxyHighlight">          &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(&#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>)) &#123;</span></CodeLine>
<Link id="l04909" /><CodeLine lineNumber="4909"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/globalvalue">GlobalValue</a> &#42;GV = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;GlobalValue&gt;</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea4c614360da93c0a041b22e537de151eb">U</a>-&gt;getValue()))</span></CodeLine>
<Link id="l04910" /><CodeLine lineNumber="4910"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV) &#123;</span></CodeLine>
<Link id="l04911" /><CodeLine lineNumber="4911"><span class="doxyHighlight">                Formula NewF = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>;</span></CodeLine>
<Link id="l04912" /><CodeLine lineNumber="4912"><span class="doxyHighlight">                NewF.BaseGV = GV;</span></CodeLine>
<Link id="l04913" /><CodeLine lineNumber="4913"><span class="doxyHighlight">                NewF.BaseRegs.erase(NewF.BaseRegs.begin() +</span></CodeLine>
<Link id="l04914" /><CodeLine lineNumber="4914"><span class="doxyHighlight">                                    (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> - <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin()));</span></CodeLine>
<Link id="l04915" /><CodeLine lineNumber="4915"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.HasFormulaWithSameRegs(NewF)) &#123;</span></CodeLine>
<Link id="l04916" /><CodeLine lineNumber="4916"><span class="doxyHighlight">                  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Deleting &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l04917" /><CodeLine lineNumber="4917"><span class="doxyHighlight">                             <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04918" /><CodeLine lineNumber="4918"><span class="doxyHighlight">                  LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04919" /><CodeLine lineNumber="4919"><span class="doxyHighlight">                  --i;</span></CodeLine>
<Link id="l04920" /><CodeLine lineNumber="4920"><span class="doxyHighlight">                  --<a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a>;</span></CodeLine>
<Link id="l04921" /><CodeLine lineNumber="4921"><span class="doxyHighlight">                  <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04922" /><CodeLine lineNumber="4922"><span class="doxyHighlight">                  </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04923" /><CodeLine lineNumber="4923"><span class="doxyHighlight">                &#125;</span></CodeLine>
<Link id="l04924" /><CodeLine lineNumber="4924"><span class="doxyHighlight">              &#125;</span></CodeLine>
<Link id="l04925" /><CodeLine lineNumber="4925"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l04926" /><CodeLine lineNumber="4926"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l04927" /><CodeLine lineNumber="4927"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04928" /><CodeLine lineNumber="4928"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/any">Any</a>)</span></CodeLine>
<Link id="l04929" /><CodeLine lineNumber="4929"><span class="doxyHighlight">        LU.RecomputeRegs(LUIdx, RegUses);</span></CodeLine>
<Link id="l04930" /><CodeLine lineNumber="4930"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04931" /><CodeLine lineNumber="4931"></CodeLine>
<Link id="l04932" /><CodeLine lineNumber="4932"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;After pre-selection:\\n&quot;</span><span class="doxyHighlight">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l04933" /><CodeLine lineNumber="4933"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04934" /><CodeLine lineNumber="4934"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04935" /><CodeLine lineNumber="4935"></CodeLine>
<Link id="l04936" /><CodeLine lineNumber="4936"><span class="doxyHighlightComment">/// When there are many registers for expressions like A, A+1, A+2, etc.,</span></CodeLine>
<Link id="l04937" /><CodeLine lineNumber="4937"><span class="doxyHighlightComment">/// allocate a single register for them.</span></CodeLine>
<Link id="l04938" /><CodeLine lineNumber="4938"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::NarrowSearchSpaceByCollapsingUnrolledCode() &#123;</span></CodeLine>
<Link id="l04939" /><CodeLine lineNumber="4939"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</span></CodeLine>
<Link id="l04940" /><CodeLine lineNumber="4940"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04941" /><CodeLine lineNumber="4941"></CodeLine>
<Link id="l04942" /><CodeLine lineNumber="4942"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l04943" /><CodeLine lineNumber="4943"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;The search space is too complex.\\n&quot;</span></CodeLine>
<Link id="l04944" /><CodeLine lineNumber="4944"><span class="doxyHighlight">                </span><span class="doxyHighlightStringLiteral">&quot;Narrowing the search space by assuming that uses separated &quot;</span></CodeLine>
<Link id="l04945" /><CodeLine lineNumber="4945"><span class="doxyHighlight">                </span><span class="doxyHighlightStringLiteral">&quot;by a constant offset will use the same registers.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04946" /><CodeLine lineNumber="4946"></CodeLine>
<Link id="l04947" /><CodeLine lineNumber="4947"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This is especially useful for unrolled loops.</span></CodeLine>
<Link id="l04948" /><CodeLine lineNumber="4948"></CodeLine>
<Link id="l04949" /><CodeLine lineNumber="4949"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l04950" /><CodeLine lineNumber="4950"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l04951" /><CodeLine lineNumber="4951"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae) &#123;</span></CodeLine>
<Link id="l04952" /><CodeLine lineNumber="4952"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isZero() || (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 0 &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 1))</span></CodeLine>
<Link id="l04953" /><CodeLine lineNumber="4953"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04954" /><CodeLine lineNumber="4954"></CodeLine>
<Link id="l04955" /><CodeLine lineNumber="4955"><span class="doxyHighlight">      LSRUse &#42;LUThatHas = FindUseWithSimilarFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, LU);</span></CodeLine>
<Link id="l04956" /><CodeLine lineNumber="4956"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LUThatHas)</span></CodeLine>
<Link id="l04957" /><CodeLine lineNumber="4957"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04958" /><CodeLine lineNumber="4958"></CodeLine>
<Link id="l04959" /><CodeLine lineNumber="4959"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!reconcileNewOffset(&#42;LUThatHas, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset, </span><span class="doxyHighlightComment">/&#42;HasBaseReg=&#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l04960" /><CodeLine lineNumber="4960"><span class="doxyHighlight">                              LU.Kind, LU.AccessTy))</span></CodeLine>
<Link id="l04961" /><CodeLine lineNumber="4961"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04962" /><CodeLine lineNumber="4962"></CodeLine>
<Link id="l04963" /><CodeLine lineNumber="4963"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Deleting use &quot;</span><span class="doxyHighlight">; LU.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04964" /><CodeLine lineNumber="4964"></CodeLine>
<Link id="l04965" /><CodeLine lineNumber="4965"><span class="doxyHighlight">      LUThatHas-&gt;AllFixupsOutsideLoop &amp;= LU.AllFixupsOutsideLoop;</span></CodeLine>
<Link id="l04966" /><CodeLine lineNumber="4966"></CodeLine>
<Link id="l04967" /><CodeLine lineNumber="4967"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Transfer the fixups of LU to LUThatHas.</span></CodeLine>
<Link id="l04968" /><CodeLine lineNumber="4968"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : LU.Fixups) &#123;</span></CodeLine>
<Link id="l04969" /><CodeLine lineNumber="4969"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset += <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset;</span></CodeLine>
<Link id="l04970" /><CodeLine lineNumber="4970"><span class="doxyHighlight">        LUThatHas-&gt;pushFixup(<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>);</span></CodeLine>
<Link id="l04971" /><CodeLine lineNumber="4971"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;New fixup has offset &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.Offset &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04972" /><CodeLine lineNumber="4972"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04973" /><CodeLine lineNumber="4973"></CodeLine>
<Link id="l04974" /><CodeLine lineNumber="4974"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Delete formulae from the new use which are no longer legal.</span></CodeLine>
<Link id="l04975" /><CodeLine lineNumber="4975"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04976" /><CodeLine lineNumber="4976"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = LUThatHas-&gt;Formulae.size(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l04977" /><CodeLine lineNumber="4977"><span class="doxyHighlight">        Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LUThatHas-&gt;Formulae&#91;i&#93;;</span></CodeLine>
<Link id="l04978" /><CodeLine lineNumber="4978"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LUThatHas-&gt;MinOffset, LUThatHas-&gt;MaxOffset,</span></CodeLine>
<Link id="l04979" /><CodeLine lineNumber="4979"><span class="doxyHighlight">                        LUThatHas-&gt;Kind, LUThatHas-&gt;AccessTy, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) &#123;</span></CodeLine>
<Link id="l04980" /><CodeLine lineNumber="4980"><span class="doxyHighlight">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Deleting &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04981" /><CodeLine lineNumber="4981"><span class="doxyHighlight">          LUThatHas-&gt;DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l04982" /><CodeLine lineNumber="4982"><span class="doxyHighlight">          --i;</span></CodeLine>
<Link id="l04983" /><CodeLine lineNumber="4983"><span class="doxyHighlight">          --<a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a>;</span></CodeLine>
<Link id="l04984" /><CodeLine lineNumber="4984"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04985" /><CodeLine lineNumber="4985"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l04986" /><CodeLine lineNumber="4986"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04987" /><CodeLine lineNumber="4987"></CodeLine>
<Link id="l04988" /><CodeLine lineNumber="4988"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/any">Any</a>)</span></CodeLine>
<Link id="l04989" /><CodeLine lineNumber="4989"><span class="doxyHighlight">        LUThatHas-&gt;RecomputeRegs(LUThatHas - &amp;<a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.front(), RegUses);</span></CodeLine>
<Link id="l04990" /><CodeLine lineNumber="4990"></CodeLine>
<Link id="l04991" /><CodeLine lineNumber="4991"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Delete the old use.</span></CodeLine>
<Link id="l04992" /><CodeLine lineNumber="4992"><span class="doxyHighlight">      DeleteUse(LU, LUIdx);</span></CodeLine>
<Link id="l04993" /><CodeLine lineNumber="4993"><span class="doxyHighlight">      --LUIdx;</span></CodeLine>
<Link id="l04994" /><CodeLine lineNumber="4994"><span class="doxyHighlight">      --NumUses;</span></CodeLine>
<Link id="l04995" /><CodeLine lineNumber="4995"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04996" /><CodeLine lineNumber="4996"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04997" /><CodeLine lineNumber="4997"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04998" /><CodeLine lineNumber="4998"></CodeLine>
<Link id="l04999" /><CodeLine lineNumber="4999"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;After pre-selection:\\n&quot;</span><span class="doxyHighlight">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l05000" /><CodeLine lineNumber="5000"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05001" /><CodeLine lineNumber="5001"></CodeLine>
<Link id="l05002" /><CodeLine lineNumber="5002"><span class="doxyHighlightComment">/// Call FilterOutUndesirableDedicatedRegisters again, if necessary, now that</span></CodeLine>
<Link id="l05003" /><CodeLine lineNumber="5003"><span class="doxyHighlightComment">/// we&#39;ve done more filtering, as it may be able to find more formulae to</span></CodeLine>
<Link id="l05004" /><CodeLine lineNumber="5004"><span class="doxyHighlightComment">/// eliminate.</span></CodeLine>
<Link id="l05005" /><CodeLine lineNumber="5005"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::NarrowSearchSpaceByRefilteringUndesirableDedicatedRegisters()&#123;</span></CodeLine>
<Link id="l05006" /><CodeLine lineNumber="5006"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EstimateSearchSpaceComplexity() &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>) &#123;</span></CodeLine>
<Link id="l05007" /><CodeLine lineNumber="5007"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;The search space is too complex.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05008" /><CodeLine lineNumber="5008"></CodeLine>
<Link id="l05009" /><CodeLine lineNumber="5009"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Narrowing the search space by re-filtering out &quot;</span></CodeLine>
<Link id="l05010" /><CodeLine lineNumber="5010"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;undesirable dedicated registers.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05011" /><CodeLine lineNumber="5011"></CodeLine>
<Link id="l05012" /><CodeLine lineNumber="5012"><span class="doxyHighlight">    FilterOutUndesirableDedicatedRegisters();</span></CodeLine>
<Link id="l05013" /><CodeLine lineNumber="5013"></CodeLine>
<Link id="l05014" /><CodeLine lineNumber="5014"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;After pre-selection:\\n&quot;</span><span class="doxyHighlight">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l05015" /><CodeLine lineNumber="5015"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05016" /><CodeLine lineNumber="5016"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05017" /><CodeLine lineNumber="5017"></CodeLine>
<Link id="l05018" /><CodeLine lineNumber="5018"><span class="doxyHighlightComment">/// If a LSRUse has multiple formulae with the same ScaledReg and Scale.</span></CodeLine>
<Link id="l05019" /><CodeLine lineNumber="5019"><span class="doxyHighlightComment">/// Pick the best one and delete the others.</span></CodeLine>
<Link id="l05020" /><CodeLine lineNumber="5020"><span class="doxyHighlightComment">/// This narrowing heuristic is to keep as many formulae with different</span></CodeLine>
<Link id="l05021" /><CodeLine lineNumber="5021"><span class="doxyHighlightComment">/// Scale and ScaledReg pair as possible while narrowing the search space.</span></CodeLine>
<Link id="l05022" /><CodeLine lineNumber="5022"><span class="doxyHighlightComment">/// The benefit is that it is more likely to find out a better solution</span></CodeLine>
<Link id="l05023" /><CodeLine lineNumber="5023"><span class="doxyHighlightComment">/// from a formulae set with more Scale and ScaledReg variations than</span></CodeLine>
<Link id="l05024" /><CodeLine lineNumber="5024"><span class="doxyHighlightComment">/// a formulae set with the same Scale and ScaledReg. The picking winner</span></CodeLine>
<Link id="l05025" /><CodeLine lineNumber="5025"><span class="doxyHighlightComment">/// reg heuristic will often keep the formulae with the same Scale and</span></CodeLine>
<Link id="l05026" /><CodeLine lineNumber="5026"><span class="doxyHighlightComment">/// ScaledReg and filter others, and we want to avoid that if possible.</span></CodeLine>
<Link id="l05027" /><CodeLine lineNumber="5027"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::NarrowSearchSpaceByFilterFormulaWithSameScaledReg() &#123;</span></CodeLine>
<Link id="l05028" /><CodeLine lineNumber="5028"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</span></CodeLine>
<Link id="l05029" /><CodeLine lineNumber="5029"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05030" /><CodeLine lineNumber="5030"></CodeLine>
<Link id="l05031" /><CodeLine lineNumber="5031"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l05032" /><CodeLine lineNumber="5032"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;The search space is too complex.\\n&quot;</span></CodeLine>
<Link id="l05033" /><CodeLine lineNumber="5033"><span class="doxyHighlight">                </span><span class="doxyHighlightStringLiteral">&quot;Narrowing the search space by choosing the best Formula &quot;</span></CodeLine>
<Link id="l05034" /><CodeLine lineNumber="5034"><span class="doxyHighlight">                </span><span class="doxyHighlightStringLiteral">&quot;from the Formulae with the same Scale and ScaledReg.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05035" /><CodeLine lineNumber="5035"></CodeLine>
<Link id="l05036" /><CodeLine lineNumber="5036"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Map the &quot;Scale &#42; ScaledReg&quot; pair to the best formula of current LSRUse.</span></CodeLine>
<Link id="l05037" /><CodeLine lineNumber="5037"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight">BestFormulaeTy = <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;std::pair&lt;const SCEV &#42;, int64&#95;t&gt;</a>, </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight">&gt;;</span></CodeLine>
<Link id="l05038" /><CodeLine lineNumber="5038"></CodeLine>
<Link id="l05039" /><CodeLine lineNumber="5039"><span class="doxyHighlight">  BestFormulaeTy BestFormulae;</span></CodeLine>
<Link id="l05040" /><CodeLine lineNumber="5040"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l05041" /><CodeLine lineNumber="5041"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ChangedFormulae = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05042" /><CodeLine lineNumber="5042"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l05043" /><CodeLine lineNumber="5043"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> VisitedRegs;</span></CodeLine>
<Link id="l05044" /><CodeLine lineNumber="5044"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> Regs;</span></CodeLine>
<Link id="l05045" /><CodeLine lineNumber="5045"></CodeLine>
<Link id="l05046" /><CodeLine lineNumber="5046"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l05047" /><CodeLine lineNumber="5047"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l05048" /><CodeLine lineNumber="5048"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Filtering for use &quot;</span><span class="doxyHighlight">; LU.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05049" /><CodeLine lineNumber="5049"><span class="doxyHighlight">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05050" /><CodeLine lineNumber="5050"></CodeLine>
<Link id="l05051" /><CodeLine lineNumber="5051"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Return true if Formula FA is better than Formula FB.</span></CodeLine>
<Link id="l05052" /><CodeLine lineNumber="5052"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> IsBetterThan = &#91;&amp;&#93;(Formula &amp;FA, Formula &amp;FB) &#123;</span></CodeLine>
<Link id="l05053" /><CodeLine lineNumber="5053"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// First we will try to choose the Formula with fewer new registers.</span></CodeLine>
<Link id="l05054" /><CodeLine lineNumber="5054"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// For a register used by current Formula, the more the register is</span></CodeLine>
<Link id="l05055" /><CodeLine lineNumber="5055"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// shared among LSRUses, the less we increase the register number</span></CodeLine>
<Link id="l05056" /><CodeLine lineNumber="5056"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// counter of the formula.</span></CodeLine>
<Link id="l05057" /><CodeLine lineNumber="5057"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> FARegNum = 0;</span></CodeLine>
<Link id="l05058" /><CodeLine lineNumber="5058"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : FA.BaseRegs) &#123;</span></CodeLine>
<Link id="l05059" /><CodeLine lineNumber="5059"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l05060" /><CodeLine lineNumber="5060"><span class="doxyHighlight">        FARegNum += (NumUses - UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#ae0307ad5c950df7f6fb56dc8326184ce">count</a>() + 1);</span></CodeLine>
<Link id="l05061" /><CodeLine lineNumber="5061"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05062" /><CodeLine lineNumber="5062"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> FBRegNum = 0;</span></CodeLine>
<Link id="l05063" /><CodeLine lineNumber="5063"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : FB.BaseRegs) &#123;</span></CodeLine>
<Link id="l05064" /><CodeLine lineNumber="5064"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallbitvector">SmallBitVector</a> &amp;UsedByIndices = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l05065" /><CodeLine lineNumber="5065"><span class="doxyHighlight">        FBRegNum += (NumUses - UsedByIndices.<a href="/docs/api/classes/llvm/smallbitvector/#ae0307ad5c950df7f6fb56dc8326184ce">count</a>() + 1);</span></CodeLine>
<Link id="l05066" /><CodeLine lineNumber="5066"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05067" /><CodeLine lineNumber="5067"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FARegNum != FBRegNum)</span></CodeLine>
<Link id="l05068" /><CodeLine lineNumber="5068"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> FARegNum &lt; FBRegNum;</span></CodeLine>
<Link id="l05069" /><CodeLine lineNumber="5069"></CodeLine>
<Link id="l05070" /><CodeLine lineNumber="5070"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If the new register numbers are the same, choose the Formula with</span></CodeLine>
<Link id="l05071" /><CodeLine lineNumber="5071"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// less Cost.</span></CodeLine>
<Link id="l05072" /><CodeLine lineNumber="5072"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CostFA(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</span></CodeLine>
<Link id="l05073" /><CodeLine lineNumber="5073"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CostFB(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</span></CodeLine>
<Link id="l05074" /><CodeLine lineNumber="5074"><span class="doxyHighlight">      Regs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</span></CodeLine>
<Link id="l05075" /><CodeLine lineNumber="5075"><span class="doxyHighlight">      CostFA.RateFormula(FA, Regs, VisitedRegs, LU);</span></CodeLine>
<Link id="l05076" /><CodeLine lineNumber="5076"><span class="doxyHighlight">      Regs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</span></CodeLine>
<Link id="l05077" /><CodeLine lineNumber="5077"><span class="doxyHighlight">      CostFB.RateFormula(FB, Regs, VisitedRegs, LU);</span></CodeLine>
<Link id="l05078" /><CodeLine lineNumber="5078"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CostFA.isLess(CostFB);</span></CodeLine>
<Link id="l05079" /><CodeLine lineNumber="5079"><span class="doxyHighlight">    &#125;;</span></CodeLine>
<Link id="l05080" /><CodeLine lineNumber="5080"></CodeLine>
<Link id="l05081" /><CodeLine lineNumber="5081"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05082" /><CodeLine lineNumber="5082"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> FIdx = 0, NumForms = LU.Formulae.size(); FIdx != NumForms;</span></CodeLine>
<Link id="l05083" /><CodeLine lineNumber="5083"><span class="doxyHighlight">         ++FIdx) &#123;</span></CodeLine>
<Link id="l05084" /><CodeLine lineNumber="5084"><span class="doxyHighlight">      Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;FIdx&#93;;</span></CodeLine>
<Link id="l05085" /><CodeLine lineNumber="5085"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg)</span></CodeLine>
<Link id="l05086" /><CodeLine lineNumber="5086"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05087" /><CodeLine lineNumber="5087"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = BestFormulae.insert(&#123;&#123;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale&#125;, FIdx&#125;);</span></CodeLine>
<Link id="l05088" /><CodeLine lineNumber="5088"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second)</span></CodeLine>
<Link id="l05089" /><CodeLine lineNumber="5089"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05090" /><CodeLine lineNumber="5090"></CodeLine>
<Link id="l05091" /><CodeLine lineNumber="5091"><span class="doxyHighlight">      Formula &amp;Best = LU.Formulae&#91;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;second&#93;;</span></CodeLine>
<Link id="l05092" /><CodeLine lineNumber="5092"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsBetterThan(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Best))</span></CodeLine>
<Link id="l05093" /><CodeLine lineNumber="5093"><span class="doxyHighlight">        <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, Best);</span></CodeLine>
<Link id="l05094" /><CodeLine lineNumber="5094"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Filtering out formula &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05095" /><CodeLine lineNumber="5095"><span class="doxyHighlight">                 <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span></CodeLine>
<Link id="l05096" /><CodeLine lineNumber="5096"><span class="doxyHighlight">                           </span><span class="doxyHighlightStringLiteral">&quot;    in favor of formula &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05097" /><CodeLine lineNumber="5097"><span class="doxyHighlight">                 Best.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05098" /><CodeLine lineNumber="5098"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l05099" /><CodeLine lineNumber="5099"><span class="doxyHighlight">      ChangedFormulae = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05100" /><CodeLine lineNumber="5100"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l05101" /><CodeLine lineNumber="5101"><span class="doxyHighlight">      LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l05102" /><CodeLine lineNumber="5102"><span class="doxyHighlight">      --FIdx;</span></CodeLine>
<Link id="l05103" /><CodeLine lineNumber="5103"><span class="doxyHighlight">      --NumForms;</span></CodeLine>
<Link id="l05104" /><CodeLine lineNumber="5104"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05105" /><CodeLine lineNumber="5105"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05106" /><CodeLine lineNumber="5106"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/any">Any</a>)</span></CodeLine>
<Link id="l05107" /><CodeLine lineNumber="5107"><span class="doxyHighlight">      LU.RecomputeRegs(LUIdx, RegUses);</span></CodeLine>
<Link id="l05108" /><CodeLine lineNumber="5108"></CodeLine>
<Link id="l05109" /><CodeLine lineNumber="5109"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Reset this to prepare for the next use.</span></CodeLine>
<Link id="l05110" /><CodeLine lineNumber="5110"><span class="doxyHighlight">    BestFormulae.clear();</span></CodeLine>
<Link id="l05111" /><CodeLine lineNumber="5111"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05112" /><CodeLine lineNumber="5112"></CodeLine>
<Link id="l05113" /><CodeLine lineNumber="5113"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ChangedFormulae) &#123;</span></CodeLine>
<Link id="l05114" /><CodeLine lineNumber="5114"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span></CodeLine>
<Link id="l05115" /><CodeLine lineNumber="5115"><span class="doxyHighlight">              </span><span class="doxyHighlightStringLiteral">&quot;After filtering out undesirable candidates:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05116" /><CodeLine lineNumber="5116"><span class="doxyHighlight">    print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05117" /><CodeLine lineNumber="5117"><span class="doxyHighlight">  &#125;);</span></CodeLine>
<Link id="l05118" /><CodeLine lineNumber="5118"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05119" /><CodeLine lineNumber="5119"></CodeLine>
<Link id="l05120" /><CodeLine lineNumber="5120"><span class="doxyHighlightComment">/// If we are over the complexity limit, filter out any post-inc prefering</span></CodeLine>
<Link id="l05121" /><CodeLine lineNumber="5121"><span class="doxyHighlightComment">/// variables to only post-inc values.</span></CodeLine>
<Link id="l05122" /><CodeLine lineNumber="5122"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::NarrowSearchSpaceByFilterPostInc() &#123;</span></CodeLine>
<Link id="l05123" /><CodeLine lineNumber="5123"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AMK != <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a>)</span></CodeLine>
<Link id="l05124" /><CodeLine lineNumber="5124"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05125" /><CodeLine lineNumber="5125"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</span></CodeLine>
<Link id="l05126" /><CodeLine lineNumber="5126"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05127" /><CodeLine lineNumber="5127"></CodeLine>
<Link id="l05128" /><CodeLine lineNumber="5128"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;The search space is too complex.\\n&quot;</span></CodeLine>
<Link id="l05129" /><CodeLine lineNumber="5129"><span class="doxyHighlight">                       </span><span class="doxyHighlightStringLiteral">&quot;Narrowing the search space by choosing the lowest &quot;</span></CodeLine>
<Link id="l05130" /><CodeLine lineNumber="5130"><span class="doxyHighlight">                       </span><span class="doxyHighlightStringLiteral">&quot;register Formula for PostInc Uses.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05131" /><CodeLine lineNumber="5131"></CodeLine>
<Link id="l05132" /><CodeLine lineNumber="5132"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l05133" /><CodeLine lineNumber="5133"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l05134" /><CodeLine lineNumber="5134"></CodeLine>
<Link id="l05135" /><CodeLine lineNumber="5135"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>)</span></CodeLine>
<Link id="l05136" /><CodeLine lineNumber="5136"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05137" /><CodeLine lineNumber="5137"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedLoadLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, LU.AccessTy.getType()) &amp;&amp;</span></CodeLine>
<Link id="l05138" /><CodeLine lineNumber="5138"><span class="doxyHighlight">        !<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedStoreLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, LU.AccessTy.getType()))</span></CodeLine>
<Link id="l05139" /><CodeLine lineNumber="5139"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05140" /><CodeLine lineNumber="5140"></CodeLine>
<Link id="l05141" /><CodeLine lineNumber="5141"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> MinRegs = std::numeric&#95;limits&lt;size&#95;t&gt;::max();</span></CodeLine>
<Link id="l05142" /><CodeLine lineNumber="5142"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae)</span></CodeLine>
<Link id="l05143" /><CodeLine lineNumber="5143"><span class="doxyHighlight">      MinRegs = std::min(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs(), MinRegs);</span></CodeLine>
<Link id="l05144" /><CodeLine lineNumber="5144"></CodeLine>
<Link id="l05145" /><CodeLine lineNumber="5145"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05146" /><CodeLine lineNumber="5146"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> FIdx = 0, NumForms = LU.Formulae.size(); FIdx != NumForms;</span></CodeLine>
<Link id="l05147" /><CodeLine lineNumber="5147"><span class="doxyHighlight">         ++FIdx) &#123;</span></CodeLine>
<Link id="l05148" /><CodeLine lineNumber="5148"><span class="doxyHighlight">      Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;FIdx&#93;;</span></CodeLine>
<Link id="l05149" /><CodeLine lineNumber="5149"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs() &gt; MinRegs) &#123;</span></CodeLine>
<Link id="l05150" /><CodeLine lineNumber="5150"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Filtering out formula &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05151" /><CodeLine lineNumber="5151"><span class="doxyHighlight">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05152" /><CodeLine lineNumber="5152"><span class="doxyHighlight">        LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l05153" /><CodeLine lineNumber="5153"><span class="doxyHighlight">        --FIdx;</span></CodeLine>
<Link id="l05154" /><CodeLine lineNumber="5154"><span class="doxyHighlight">        --NumForms;</span></CodeLine>
<Link id="l05155" /><CodeLine lineNumber="5155"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05156" /><CodeLine lineNumber="5156"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05157" /><CodeLine lineNumber="5157"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05158" /><CodeLine lineNumber="5158"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/any">Any</a>)</span></CodeLine>
<Link id="l05159" /><CodeLine lineNumber="5159"><span class="doxyHighlight">      LU.RecomputeRegs(LUIdx, RegUses);</span></CodeLine>
<Link id="l05160" /><CodeLine lineNumber="5160"></CodeLine>
<Link id="l05161" /><CodeLine lineNumber="5161"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</span></CodeLine>
<Link id="l05162" /><CodeLine lineNumber="5162"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05163" /><CodeLine lineNumber="5163"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05164" /><CodeLine lineNumber="5164"></CodeLine>
<Link id="l05165" /><CodeLine lineNumber="5165"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;After pre-selection:\\n&quot;</span><span class="doxyHighlight">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l05166" /><CodeLine lineNumber="5166"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05167" /><CodeLine lineNumber="5167"></CodeLine>
<Link id="l05168" /><CodeLine lineNumber="5168"><span class="doxyHighlightComment">/// The function delete formulas with high registers number expectation.</span></CodeLine>
<Link id="l05169" /><CodeLine lineNumber="5169"><span class="doxyHighlightComment">/// Assuming we don&#39;t know the value of each formula (already delete</span></CodeLine>
<Link id="l05170" /><CodeLine lineNumber="5170"><span class="doxyHighlightComment">/// all inefficient), generate probability of not selecting for each</span></CodeLine>
<Link id="l05171" /><CodeLine lineNumber="5171"><span class="doxyHighlightComment">/// register.</span></CodeLine>
<Link id="l05172" /><CodeLine lineNumber="5172"><span class="doxyHighlightComment">/// For example,</span></CodeLine>
<Link id="l05173" /><CodeLine lineNumber="5173"><span class="doxyHighlightComment">/// Use1:</span></CodeLine>
<Link id="l05174" /><CodeLine lineNumber="5174"><span class="doxyHighlightComment">///  reg(a) + reg(&#123;0,+,1&#125;)</span></CodeLine>
<Link id="l05175" /><CodeLine lineNumber="5175"><span class="doxyHighlightComment">///  reg(a) + reg(&#123;-1,+,1&#125;) + 1</span></CodeLine>
<Link id="l05176" /><CodeLine lineNumber="5176"><span class="doxyHighlightComment">///  reg(&#123;a,+,1&#125;)</span></CodeLine>
<Link id="l05177" /><CodeLine lineNumber="5177"><span class="doxyHighlightComment">/// Use2:</span></CodeLine>
<Link id="l05178" /><CodeLine lineNumber="5178"><span class="doxyHighlightComment">///  reg(b) + reg(&#123;0,+,1&#125;)</span></CodeLine>
<Link id="l05179" /><CodeLine lineNumber="5179"><span class="doxyHighlightComment">///  reg(b) + reg(&#123;-1,+,1&#125;) + 1</span></CodeLine>
<Link id="l05180" /><CodeLine lineNumber="5180"><span class="doxyHighlightComment">///  reg(&#123;b,+,1&#125;)</span></CodeLine>
<Link id="l05181" /><CodeLine lineNumber="5181"><span class="doxyHighlightComment">/// Use3:</span></CodeLine>
<Link id="l05182" /><CodeLine lineNumber="5182"><span class="doxyHighlightComment">///  reg(c) + reg(b) + reg(&#123;0,+,1&#125;)</span></CodeLine>
<Link id="l05183" /><CodeLine lineNumber="5183"><span class="doxyHighlightComment">///  reg(c) + reg(&#123;b,+,1&#125;)</span></CodeLine>
<Link id="l05184" /><CodeLine lineNumber="5184"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l05185" /><CodeLine lineNumber="5185"><span class="doxyHighlightComment">/// Probability of not selecting</span></CodeLine>
<Link id="l05186" /><CodeLine lineNumber="5186"><span class="doxyHighlightComment">///                 Use1   Use2    Use3</span></CodeLine>
<Link id="l05187" /><CodeLine lineNumber="5187"><span class="doxyHighlightComment">/// reg(a)         (1/3) &#42;   1   &#42;   1</span></CodeLine>
<Link id="l05188" /><CodeLine lineNumber="5188"><span class="doxyHighlightComment">/// reg(b)           1   &#42; (1/3) &#42; (1/2)</span></CodeLine>
<Link id="l05189" /><CodeLine lineNumber="5189"><span class="doxyHighlightComment">/// reg(&#123;0,+,1&#125;)   (2/3) &#42; (2/3) &#42; (1/2)</span></CodeLine>
<Link id="l05190" /><CodeLine lineNumber="5190"><span class="doxyHighlightComment">/// reg(&#123;-1,+,1&#125;)  (2/3) &#42; (2/3) &#42;   1</span></CodeLine>
<Link id="l05191" /><CodeLine lineNumber="5191"><span class="doxyHighlightComment">/// reg(&#123;a,+,1&#125;)   (2/3) &#42;   1   &#42;   1</span></CodeLine>
<Link id="l05192" /><CodeLine lineNumber="5192"><span class="doxyHighlightComment">/// reg(&#123;b,+,1&#125;)     1   &#42; (2/3) &#42; (2/3)</span></CodeLine>
<Link id="l05193" /><CodeLine lineNumber="5193"><span class="doxyHighlightComment">/// reg(c)           1   &#42;   1   &#42;   0</span></CodeLine>
<Link id="l05194" /><CodeLine lineNumber="5194"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l05195" /><CodeLine lineNumber="5195"><span class="doxyHighlightComment">/// Now count registers number mathematical expectation for each formula:</span></CodeLine>
<Link id="l05196" /><CodeLine lineNumber="5196"><span class="doxyHighlightComment">/// Note that for each use we exclude probability if not selecting for the use.</span></CodeLine>
<Link id="l05197" /><CodeLine lineNumber="5197"><span class="doxyHighlightComment">/// For example for Use1 probability for reg(a) would be just 1 &#42; 1 (excluding</span></CodeLine>
<Link id="l05198" /><CodeLine lineNumber="5198"><span class="doxyHighlightComment">/// probabilty 1/3 of not selecting for Use1).</span></CodeLine>
<Link id="l05199" /><CodeLine lineNumber="5199"><span class="doxyHighlightComment">/// Use1:</span></CodeLine>
<Link id="l05200" /><CodeLine lineNumber="5200"><span class="doxyHighlightComment">///  reg(a) + reg(&#123;0,+,1&#125;)          1 + 1/3       -- to be deleted</span></CodeLine>
<Link id="l05201" /><CodeLine lineNumber="5201"><span class="doxyHighlightComment">///  reg(a) + reg(&#123;-1,+,1&#125;) + 1     1 + 4/9       -- to be deleted</span></CodeLine>
<Link id="l05202" /><CodeLine lineNumber="5202"><span class="doxyHighlightComment">///  reg(&#123;a,+,1&#125;)                   1</span></CodeLine>
<Link id="l05203" /><CodeLine lineNumber="5203"><span class="doxyHighlightComment">/// Use2:</span></CodeLine>
<Link id="l05204" /><CodeLine lineNumber="5204"><span class="doxyHighlightComment">///  reg(b) + reg(&#123;0,+,1&#125;)          1/2 + 1/3     -- to be deleted</span></CodeLine>
<Link id="l05205" /><CodeLine lineNumber="5205"><span class="doxyHighlightComment">///  reg(b) + reg(&#123;-1,+,1&#125;) + 1     1/2 + 2/3     -- to be deleted</span></CodeLine>
<Link id="l05206" /><CodeLine lineNumber="5206"><span class="doxyHighlightComment">///  reg(&#123;b,+,1&#125;)                   2/3</span></CodeLine>
<Link id="l05207" /><CodeLine lineNumber="5207"><span class="doxyHighlightComment">/// Use3:</span></CodeLine>
<Link id="l05208" /><CodeLine lineNumber="5208"><span class="doxyHighlightComment">///  reg(c) + reg(b) + reg(&#123;0,+,1&#125;) 1 + 1/3 + 4/9 -- to be deleted</span></CodeLine>
<Link id="l05209" /><CodeLine lineNumber="5209"><span class="doxyHighlightComment">///  reg(c) + reg(&#123;b,+,1&#125;)          1 + 2/3</span></CodeLine>
<Link id="l05210" /><CodeLine lineNumber="5210"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::NarrowSearchSpaceByDeletingCostlyFormulas() &#123;</span></CodeLine>
<Link id="l05211" /><CodeLine lineNumber="5211"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EstimateSearchSpaceComplexity() &lt; <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>)</span></CodeLine>
<Link id="l05212" /><CodeLine lineNumber="5212"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05213" /><CodeLine lineNumber="5213"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Ok, we have too many of formulae on our hands to conveniently handle.</span></CodeLine>
<Link id="l05214" /><CodeLine lineNumber="5214"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Use a rough heuristic to thin out the list.</span></CodeLine>
<Link id="l05215" /><CodeLine lineNumber="5215"></CodeLine>
<Link id="l05216" /><CodeLine lineNumber="5216"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Set of Regs wich will be 100% used in final solution.</span></CodeLine>
<Link id="l05217" /><CodeLine lineNumber="5217"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Used in each formula of a solution (in example above this is reg(c)).</span></CodeLine>
<Link id="l05218" /><CodeLine lineNumber="5218"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We can skip them in calculations.</span></CodeLine>
<Link id="l05219" /><CodeLine lineNumber="5219"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 4&gt;</a> UniqRegs;</span></CodeLine>
<Link id="l05220" /><CodeLine lineNumber="5220"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;The search space is too complex.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05221" /><CodeLine lineNumber="5221"></CodeLine>
<Link id="l05222" /><CodeLine lineNumber="5222"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Map each register to probability of not selecting</span></CodeLine>
<Link id="l05223" /><CodeLine lineNumber="5223"><span class="doxyHighlight">  DenseMap &lt;const SCEV &#42;, float&gt; RegNumMap;</span></CodeLine>
<Link id="l05224" /><CodeLine lineNumber="5224"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : RegUses) &#123;</span></CodeLine>
<Link id="l05225" /><CodeLine lineNumber="5225"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l05226" /><CodeLine lineNumber="5226"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05227" /><CodeLine lineNumber="5227"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight"> PNotSel = 1;</span></CodeLine>
<Link id="l05228" /><CodeLine lineNumber="5228"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>) &#123;</span></CodeLine>
<Link id="l05229" /><CodeLine lineNumber="5229"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LU.Regs.count(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l05230" /><CodeLine lineNumber="5230"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05231" /><CodeLine lineNumber="5231"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = LU.getNotSelectedProbability(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l05232" /><CodeLine lineNumber="5232"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> != 0.0)</span></CodeLine>
<Link id="l05233" /><CodeLine lineNumber="5233"><span class="doxyHighlight">        PNotSel &#42;= <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</span></CodeLine>
<Link id="l05234" /><CodeLine lineNumber="5234"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l05235" /><CodeLine lineNumber="5235"><span class="doxyHighlight">        UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l05236" /><CodeLine lineNumber="5236"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05237" /><CodeLine lineNumber="5237"><span class="doxyHighlight">    RegNumMap.<a href="/docs/api/classes/llvm/densemapbase/#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(std::make&#95;pair(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, PNotSel));</span></CodeLine>
<Link id="l05238" /><CodeLine lineNumber="5238"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05239" /><CodeLine lineNumber="5239"></CodeLine>
<Link id="l05240" /><CodeLine lineNumber="5240"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l05241" /><CodeLine lineNumber="5241"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Narrowing the search space by deleting costly formulas\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05242" /><CodeLine lineNumber="5242"></CodeLine>
<Link id="l05243" /><CodeLine lineNumber="5243"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Delete formulas where registers number expectation is high.</span></CodeLine>
<Link id="l05244" /><CodeLine lineNumber="5244"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l05245" /><CodeLine lineNumber="5245"><span class="doxyHighlight">    LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l05246" /><CodeLine lineNumber="5246"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If nothing to delete - continue.</span></CodeLine>
<Link id="l05247" /><CodeLine lineNumber="5247"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Formulae.size() &lt; 2)</span></CodeLine>
<Link id="l05248" /><CodeLine lineNumber="5248"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05249" /><CodeLine lineNumber="5249"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This is temporary solution to test performance. Float should be</span></CodeLine>
<Link id="l05250" /><CodeLine lineNumber="5250"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// replaced with round independent type (based on integers) to avoid</span></CodeLine>
<Link id="l05251" /><CodeLine lineNumber="5251"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// different results for different target builds.</span></CodeLine>
<Link id="l05252" /><CodeLine lineNumber="5252"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight"> FMinRegNum = LU.Formulae&#91;0&#93;.getNumRegs();</span></CodeLine>
<Link id="l05253" /><CodeLine lineNumber="5253"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight"> FMinARegNum = LU.Formulae&#91;0&#93;.getNumRegs();</span></CodeLine>
<Link id="l05254" /><CodeLine lineNumber="5254"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> MinIdx = 0;</span></CodeLine>
<Link id="l05255" /><CodeLine lineNumber="5255"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = LU.Formulae.size(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l05256" /><CodeLine lineNumber="5256"><span class="doxyHighlight">      Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;i&#93;;</span></CodeLine>
<Link id="l05257" /><CodeLine lineNumber="5257"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight"> FRegNum = 0;</span></CodeLine>
<Link id="l05258" /><CodeLine lineNumber="5258"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">float</span><span class="doxyHighlight"> FARegNum = 0;</span></CodeLine>
<Link id="l05259" /><CodeLine lineNumber="5259"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;BaseReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</span></CodeLine>
<Link id="l05260" /><CodeLine lineNumber="5260"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(BaseReg))</span></CodeLine>
<Link id="l05261" /><CodeLine lineNumber="5261"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05262" /><CodeLine lineNumber="5262"><span class="doxyHighlight">        FRegNum += RegNumMap&#91;BaseReg&#93; / LU.getNotSelectedProbability(BaseReg);</span></CodeLine>
<Link id="l05263" /><CodeLine lineNumber="5263"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(BaseReg))</span></CodeLine>
<Link id="l05264" /><CodeLine lineNumber="5264"><span class="doxyHighlight">          FARegNum +=</span></CodeLine>
<Link id="l05265" /><CodeLine lineNumber="5265"><span class="doxyHighlight">              RegNumMap&#91;BaseReg&#93; / LU.getNotSelectedProbability(BaseReg);</span></CodeLine>
<Link id="l05266" /><CodeLine lineNumber="5266"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05267" /><CodeLine lineNumber="5267"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;ScaledReg = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg) &#123;</span></CodeLine>
<Link id="l05268" /><CodeLine lineNumber="5268"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(ScaledReg)) &#123;</span></CodeLine>
<Link id="l05269" /><CodeLine lineNumber="5269"><span class="doxyHighlight">          FRegNum +=</span></CodeLine>
<Link id="l05270" /><CodeLine lineNumber="5270"><span class="doxyHighlight">              RegNumMap&#91;ScaledReg&#93; / LU.getNotSelectedProbability(ScaledReg);</span></CodeLine>
<Link id="l05271" /><CodeLine lineNumber="5271"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(ScaledReg))</span></CodeLine>
<Link id="l05272" /><CodeLine lineNumber="5272"><span class="doxyHighlight">            FARegNum +=</span></CodeLine>
<Link id="l05273" /><CodeLine lineNumber="5273"><span class="doxyHighlight">                RegNumMap&#91;ScaledReg&#93; / LU.getNotSelectedProbability(ScaledReg);</span></CodeLine>
<Link id="l05274" /><CodeLine lineNumber="5274"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l05275" /><CodeLine lineNumber="5275"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05276" /><CodeLine lineNumber="5276"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FMinRegNum &gt; FRegNum ||</span></CodeLine>
<Link id="l05277" /><CodeLine lineNumber="5277"><span class="doxyHighlight">          (FMinRegNum == FRegNum &amp;&amp; FMinARegNum &gt; FARegNum)) &#123;</span></CodeLine>
<Link id="l05278" /><CodeLine lineNumber="5278"><span class="doxyHighlight">        FMinRegNum = FRegNum;</span></CodeLine>
<Link id="l05279" /><CodeLine lineNumber="5279"><span class="doxyHighlight">        FMinARegNum = FARegNum;</span></CodeLine>
<Link id="l05280" /><CodeLine lineNumber="5280"><span class="doxyHighlight">        MinIdx = i;</span></CodeLine>
<Link id="l05281" /><CodeLine lineNumber="5281"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05282" /><CodeLine lineNumber="5282"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05283" /><CodeLine lineNumber="5283"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  The formula &quot;</span><span class="doxyHighlight">; LU.Formulae&#91;MinIdx&#93;.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05284" /><CodeLine lineNumber="5284"><span class="doxyHighlight">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; with min reg num &quot;</span><span class="doxyHighlight"> &lt;&lt; FMinRegNum &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05285" /><CodeLine lineNumber="5285"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MinIdx != 0)</span></CodeLine>
<Link id="l05286" /><CodeLine lineNumber="5286"><span class="doxyHighlight">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(LU.Formulae&#91;MinIdx&#93;, LU.Formulae&#91;0&#93;);</span></CodeLine>
<Link id="l05287" /><CodeLine lineNumber="5287"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (LU.Formulae.size() != 1) &#123;</span></CodeLine>
<Link id="l05288" /><CodeLine lineNumber="5288"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Deleting &quot;</span><span class="doxyHighlight">; LU.Formulae.back().<a href="/docs/api/namespaces/llvm/#a50bf746ca1858c0e272e3a802fc27942">print</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05289" /><CodeLine lineNumber="5289"><span class="doxyHighlight">                 <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05290" /><CodeLine lineNumber="5290"><span class="doxyHighlight">      LU.Formulae.pop&#95;back();</span></CodeLine>
<Link id="l05291" /><CodeLine lineNumber="5291"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05292" /><CodeLine lineNumber="5292"><span class="doxyHighlight">    LU.RecomputeRegs(LUIdx, RegUses);</span></CodeLine>
<Link id="l05293" /><CodeLine lineNumber="5293"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LU.Formulae.size() == 1 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Should be exactly 1 min regs formula&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05294" /><CodeLine lineNumber="5294"><span class="doxyHighlight">    Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;0&#93;;</span></CodeLine>
<Link id="l05295" /><CodeLine lineNumber="5295"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Leaving only &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05296" /><CodeLine lineNumber="5296"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// When we choose the formula, the regs become unique.</span></CodeLine>
<Link id="l05297" /><CodeLine lineNumber="5297"><span class="doxyHighlight">    UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.begin(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs.end());</span></CodeLine>
<Link id="l05298" /><CodeLine lineNumber="5298"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg)</span></CodeLine>
<Link id="l05299" /><CodeLine lineNumber="5299"><span class="doxyHighlight">      UniqRegs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg);</span></CodeLine>
<Link id="l05300" /><CodeLine lineNumber="5300"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05301" /><CodeLine lineNumber="5301"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;After pre-selection:\\n&quot;</span><span class="doxyHighlight">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l05302" /><CodeLine lineNumber="5302"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05303" /><CodeLine lineNumber="5303"></CodeLine>
<Link id="l05304" /><CodeLine lineNumber="5304"><span class="doxyHighlightComment">// Check if Best and Reg are SCEVs separated by a constant amount C, and if so</span></CodeLine>
<Link id="l05305" /><CodeLine lineNumber="5305"><span class="doxyHighlightComment">// would the addressing offset +C would be legal where the negative offset -C is</span></CodeLine>
<Link id="l05306" /><CodeLine lineNumber="5306"><span class="doxyHighlightComment">// not.</span></CodeLine>
<Link id="l05307" /><CodeLine lineNumber="5307" lineLink="#a6c630dc63715497e5e49ab1ca9dc6ccb"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a6c630dc63715497e5e49ab1ca9dc6ccb">IsSimplerBaseSCEVForTarget</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l05308" /><CodeLine lineNumber="5308"><span class="doxyHighlight">                                       <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Best,</span></CodeLine>
<Link id="l05309" /><CodeLine lineNumber="5309"><span class="doxyHighlight">                                       </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</span></CodeLine>
<Link id="l05310" /><CodeLine lineNumber="5310"><span class="doxyHighlight">                                       MemAccessTy AccessType) &#123;</span></CodeLine>
<Link id="l05311" /><CodeLine lineNumber="5311"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Best-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>() != <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>-&gt;getType() ||</span></CodeLine>
<Link id="l05312" /><CodeLine lineNumber="5312"><span class="doxyHighlight">      (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(Best) &amp;&amp; <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &amp;&amp;</span></CodeLine>
<Link id="l05313" /><CodeLine lineNumber="5313"><span class="doxyHighlight">       <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(Best)-&gt;getLoop() !=</span></CodeLine>
<Link id="l05314" /><CodeLine lineNumber="5314"><span class="doxyHighlight">           <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)-&gt;getLoop()))</span></CodeLine>
<Link id="l05315" /><CodeLine lineNumber="5315"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05316" /><CodeLine lineNumber="5316"><span class="doxyHighlight">  std::optional&lt;APInt&gt; Diff = SE.<a href="/docs/api/classes/llvm/scalarevolution/#ae0ca564918ec63a9b4d2229374fec747">computeConstantDifference</a>(Best, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l05317" /><CodeLine lineNumber="5317"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Diff)</span></CodeLine>
<Link id="l05318" /><CodeLine lineNumber="5318"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05319" /><CodeLine lineNumber="5319"></CodeLine>
<Link id="l05320" /><CodeLine lineNumber="5320"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(</span></CodeLine>
<Link id="l05321" /><CodeLine lineNumber="5321"><span class="doxyHighlight">             AccessType.MemTy, </span><span class="doxyHighlightComment">/&#42;BaseGV=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l05322" /><CodeLine lineNumber="5322"><span class="doxyHighlight">             </span><span class="doxyHighlightComment">/&#42;BaseOffset=&#42;/</span><span class="doxyHighlight">Diff-&gt;getSExtValue(),</span></CodeLine>
<Link id="l05323" /><CodeLine lineNumber="5323"><span class="doxyHighlight">             </span><span class="doxyHighlightComment">/&#42;HasBaseReg=&#42;/</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, </span><span class="doxyHighlightComment">/&#42;Scale=&#42;/</span><span class="doxyHighlight">0, AccessType.AddrSpace) &amp;&amp;</span></CodeLine>
<Link id="l05324" /><CodeLine lineNumber="5324"><span class="doxyHighlight">         !<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isLegalAddressingMode(</span></CodeLine>
<Link id="l05325" /><CodeLine lineNumber="5325"><span class="doxyHighlight">             AccessType.MemTy, </span><span class="doxyHighlightComment">/&#42;BaseGV=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l05326" /><CodeLine lineNumber="5326"><span class="doxyHighlight">             </span><span class="doxyHighlightComment">/&#42;BaseOffset=&#42;/</span><span class="doxyHighlight">-Diff-&gt;getSExtValue(),</span></CodeLine>
<Link id="l05327" /><CodeLine lineNumber="5327"><span class="doxyHighlight">             </span><span class="doxyHighlightComment">/&#42;HasBaseReg=&#42;/</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, </span><span class="doxyHighlightComment">/&#42;Scale=&#42;/</span><span class="doxyHighlight">0, AccessType.AddrSpace);</span></CodeLine>
<Link id="l05328" /><CodeLine lineNumber="5328"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05329" /><CodeLine lineNumber="5329"></CodeLine>
<Link id="l05330" /><CodeLine lineNumber="5330"><span class="doxyHighlightComment">/// Pick a register which seems likely to be profitable, and then in any use</span></CodeLine>
<Link id="l05331" /><CodeLine lineNumber="5331"><span class="doxyHighlightComment">/// which has any reference to that register, delete all formulae which do not</span></CodeLine>
<Link id="l05332" /><CodeLine lineNumber="5332"><span class="doxyHighlightComment">/// reference that register.</span></CodeLine>
<Link id="l05333" /><CodeLine lineNumber="5333"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::NarrowSearchSpaceByPickingWinnerRegs() &#123;</span></CodeLine>
<Link id="l05334" /><CodeLine lineNumber="5334"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// With all other options exhausted, loop until the system is simple</span></CodeLine>
<Link id="l05335" /><CodeLine lineNumber="5335"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// enough to handle.</span></CodeLine>
<Link id="l05336" /><CodeLine lineNumber="5336"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 4&gt;</a> Taken;</span></CodeLine>
<Link id="l05337" /><CodeLine lineNumber="5337"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (EstimateSearchSpaceComplexity() &gt;= <a href="#ab5189d9a0612b4e660ef0320a77b2894">ComplexityLimit</a>) &#123;</span></CodeLine>
<Link id="l05338" /><CodeLine lineNumber="5338"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Ok, we have too many of formulae on our hands to conveniently handle.</span></CodeLine>
<Link id="l05339" /><CodeLine lineNumber="5339"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Use a rough heuristic to thin out the list.</span></CodeLine>
<Link id="l05340" /><CodeLine lineNumber="5340"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;The search space is too complex.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05341" /><CodeLine lineNumber="5341"></CodeLine>
<Link id="l05342" /><CodeLine lineNumber="5342"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Pick the register which is used by the most LSRUses, which is likely</span></CodeLine>
<Link id="l05343" /><CodeLine lineNumber="5343"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// to be a good reuse register candidate.</span></CodeLine>
<Link id="l05344" /><CodeLine lineNumber="5344"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Best = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05345" /><CodeLine lineNumber="5345"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> BestNum = 0;</span></CodeLine>
<Link id="l05346" /><CodeLine lineNumber="5346"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : RegUses) &#123;</span></CodeLine>
<Link id="l05347" /><CodeLine lineNumber="5347"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Taken.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l05348" /><CodeLine lineNumber="5348"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05349" /><CodeLine lineNumber="5349"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Best) &#123;</span></CodeLine>
<Link id="l05350" /><CodeLine lineNumber="5350"><span class="doxyHighlight">        Best = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</span></CodeLine>
<Link id="l05351" /><CodeLine lineNumber="5351"><span class="doxyHighlight">        BestNum = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>).count();</span></CodeLine>
<Link id="l05352" /><CodeLine lineNumber="5352"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05353" /><CodeLine lineNumber="5353"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a> = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>).count();</span></CodeLine>
<Link id="l05354" /><CodeLine lineNumber="5354"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a> &gt; BestNum) &#123;</span></CodeLine>
<Link id="l05355" /><CodeLine lineNumber="5355"><span class="doxyHighlight">          Best = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</span></CodeLine>
<Link id="l05356" /><CodeLine lineNumber="5356"><span class="doxyHighlight">          BestNum = <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a>;</span></CodeLine>
<Link id="l05357" /><CodeLine lineNumber="5357"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l05358" /><CodeLine lineNumber="5358"></CodeLine>
<Link id="l05359" /><CodeLine lineNumber="5359"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If the scores are the same, but the Reg is simpler for the target</span></CodeLine>
<Link id="l05360" /><CodeLine lineNumber="5360"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// (for example &#123;x,+,1&#125; as opposed to &#123;x+C,+,1&#125;, where the target can</span></CodeLine>
<Link id="l05361" /><CodeLine lineNumber="5361"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// handle +C but not -C), opt for the simpler formula.</span></CodeLine>
<Link id="l05362" /><CodeLine lineNumber="5362"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a> == BestNum) &#123;</span></CodeLine>
<Link id="l05363" /><CodeLine lineNumber="5363"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> LUIdx = RegUses.getUsedByIndices(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>).find&#95;first();</span></CodeLine>
<Link id="l05364" /><CodeLine lineNumber="5364"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LUIdx &gt;= 0 &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> &amp;&amp;</span></CodeLine>
<Link id="l05365" /><CodeLine lineNumber="5365"><span class="doxyHighlight">              <a href="#a6c630dc63715497e5e49ab1ca9dc6ccb">IsSimplerBaseSCEVForTarget</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, SE, Best, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</span></CodeLine>
<Link id="l05366" /><CodeLine lineNumber="5366"><span class="doxyHighlight">                                         <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;.AccessTy)) &#123;</span></CodeLine>
<Link id="l05367" /><CodeLine lineNumber="5367"><span class="doxyHighlight">            Best = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</span></CodeLine>
<Link id="l05368" /><CodeLine lineNumber="5368"><span class="doxyHighlight">            BestNum = <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a>;</span></CodeLine>
<Link id="l05369" /><CodeLine lineNumber="5369"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l05370" /><CodeLine lineNumber="5370"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l05371" /><CodeLine lineNumber="5371"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05372" /><CodeLine lineNumber="5372"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05373" /><CodeLine lineNumber="5373"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Best &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Failed to find best LSRUse candidate&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05374" /><CodeLine lineNumber="5374"></CodeLine>
<Link id="l05375" /><CodeLine lineNumber="5375"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Narrowing the search space by assuming &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;Best</span></CodeLine>
<Link id="l05376" /><CodeLine lineNumber="5376"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; will yield profitable reuse.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05377" /><CodeLine lineNumber="5377"><span class="doxyHighlight">    Taken.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(Best);</span></CodeLine>
<Link id="l05378" /><CodeLine lineNumber="5378"></CodeLine>
<Link id="l05379" /><CodeLine lineNumber="5379"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// In any use with formulae which references this register, delete formulae</span></CodeLine>
<Link id="l05380" /><CodeLine lineNumber="5380"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// which don&#39;t reference it.</span></CodeLine>
<Link id="l05381" /><CodeLine lineNumber="5381"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx) &#123;</span></CodeLine>
<Link id="l05382" /><CodeLine lineNumber="5382"><span class="doxyHighlight">      LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;;</span></CodeLine>
<Link id="l05383" /><CodeLine lineNumber="5383"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LU.Regs.count(Best)) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05384" /><CodeLine lineNumber="5384"></CodeLine>
<Link id="l05385" /><CodeLine lineNumber="5385"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05386" /><CodeLine lineNumber="5386"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = LU.Formulae.size(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l05387" /><CodeLine lineNumber="5387"><span class="doxyHighlight">        Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> = LU.Formulae&#91;i&#93;;</span></CodeLine>
<Link id="l05388" /><CodeLine lineNumber="5388"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.referencesReg(Best)) &#123;</span></CodeLine>
<Link id="l05389" /><CodeLine lineNumber="5389"><span class="doxyHighlight">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  Deleting &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05390" /><CodeLine lineNumber="5390"><span class="doxyHighlight">          LU.DeleteFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l05391" /><CodeLine lineNumber="5391"><span class="doxyHighlight">          --<a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a>;</span></CodeLine>
<Link id="l05392" /><CodeLine lineNumber="5392"><span class="doxyHighlight">          --i;</span></CodeLine>
<Link id="l05393" /><CodeLine lineNumber="5393"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/any">Any</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05394" /><CodeLine lineNumber="5394"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(e != 0 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Use has no formulae left! Is Regs inconsistent?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05395" /><CodeLine lineNumber="5395"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05396" /><CodeLine lineNumber="5396"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l05397" /><CodeLine lineNumber="5397"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05398" /><CodeLine lineNumber="5398"></CodeLine>
<Link id="l05399" /><CodeLine lineNumber="5399"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/any">Any</a>)</span></CodeLine>
<Link id="l05400" /><CodeLine lineNumber="5400"><span class="doxyHighlight">        LU.RecomputeRegs(LUIdx, RegUses);</span></CodeLine>
<Link id="l05401" /><CodeLine lineNumber="5401"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05402" /><CodeLine lineNumber="5402"></CodeLine>
<Link id="l05403" /><CodeLine lineNumber="5403"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;After pre-selection:\\n&quot;</span><span class="doxyHighlight">; print&#95;uses(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l05404" /><CodeLine lineNumber="5404"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05405" /><CodeLine lineNumber="5405"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05406" /><CodeLine lineNumber="5406"></CodeLine>
<Link id="l05407" /><CodeLine lineNumber="5407"><span class="doxyHighlightComment">/// If there are an extraordinary number of formulae to choose from, use some</span></CodeLine>
<Link id="l05408" /><CodeLine lineNumber="5408"><span class="doxyHighlightComment">/// rough heuristics to prune down the number of formulae. This keeps the main</span></CodeLine>
<Link id="l05409" /><CodeLine lineNumber="5409"><span class="doxyHighlightComment">/// solver from taking an extraordinary amount of time in some worst-case</span></CodeLine>
<Link id="l05410" /><CodeLine lineNumber="5410"><span class="doxyHighlightComment">/// scenarios.</span></CodeLine>
<Link id="l05411" /><CodeLine lineNumber="5411"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::NarrowSearchSpaceUsingHeuristics() &#123;</span></CodeLine>
<Link id="l05412" /><CodeLine lineNumber="5412"><span class="doxyHighlight">  NarrowSearchSpaceByDetectingSupersets();</span></CodeLine>
<Link id="l05413" /><CodeLine lineNumber="5413"><span class="doxyHighlight">  NarrowSearchSpaceByCollapsingUnrolledCode();</span></CodeLine>
<Link id="l05414" /><CodeLine lineNumber="5414"><span class="doxyHighlight">  NarrowSearchSpaceByRefilteringUndesirableDedicatedRegisters();</span></CodeLine>
<Link id="l05415" /><CodeLine lineNumber="5415"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#aad3193b74a34d43bf4e02188ce67d3b7">FilterSameScaledReg</a>)</span></CodeLine>
<Link id="l05416" /><CodeLine lineNumber="5416"><span class="doxyHighlight">    NarrowSearchSpaceByFilterFormulaWithSameScaledReg();</span></CodeLine>
<Link id="l05417" /><CodeLine lineNumber="5417"><span class="doxyHighlight">  NarrowSearchSpaceByFilterPostInc();</span></CodeLine>
<Link id="l05418" /><CodeLine lineNumber="5418"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#aa957fcc885db5c56e419b4646d135311">LSRExpNarrow</a>)</span></CodeLine>
<Link id="l05419" /><CodeLine lineNumber="5419"><span class="doxyHighlight">    NarrowSearchSpaceByDeletingCostlyFormulas();</span></CodeLine>
<Link id="l05420" /><CodeLine lineNumber="5420"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l05421" /><CodeLine lineNumber="5421"><span class="doxyHighlight">    NarrowSearchSpaceByPickingWinnerRegs();</span></CodeLine>
<Link id="l05422" /><CodeLine lineNumber="5422"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05423" /><CodeLine lineNumber="5423"></CodeLine>
<Link id="l05424" /><CodeLine lineNumber="5424"><span class="doxyHighlightComment">/// This is the recursive solver.</span></CodeLine>
<Link id="l05425" /><CodeLine lineNumber="5425"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::SolveRecurse(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution,</span></CodeLine>
<Link id="l05426" /><CodeLine lineNumber="5426"><span class="doxyHighlight">                               <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> &amp;SolutionCost,</span></CodeLine>
<Link id="l05427" /><CodeLine lineNumber="5427"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Workspace,</span></CodeLine>
<Link id="l05428" /><CodeLine lineNumber="5428"><span class="doxyHighlight">                               </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> &amp;CurCost,</span></CodeLine>
<Link id="l05429" /><CodeLine lineNumber="5429"><span class="doxyHighlight">                               </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> &amp;CurRegs,</span></CodeLine>
<Link id="l05430" /><CodeLine lineNumber="5430"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> &amp;VisitedRegs)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l05431" /><CodeLine lineNumber="5431"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Some ideas:</span></CodeLine>
<Link id="l05432" /><CodeLine lineNumber="5432"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  - prune more:</span></CodeLine>
<Link id="l05433" /><CodeLine lineNumber="5433"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    - use more aggressive filtering</span></CodeLine>
<Link id="l05434" /><CodeLine lineNumber="5434"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    - sort the formula so that the most profitable solutions are found first</span></CodeLine>
<Link id="l05435" /><CodeLine lineNumber="5435"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    - sort the uses too</span></CodeLine>
<Link id="l05436" /><CodeLine lineNumber="5436"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  - search faster:</span></CodeLine>
<Link id="l05437" /><CodeLine lineNumber="5437"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    - don&#39;t compute a cost, and then compare. compare while computing a cost</span></CodeLine>
<Link id="l05438" /><CodeLine lineNumber="5438"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//      and bail early.</span></CodeLine>
<Link id="l05439" /><CodeLine lineNumber="5439"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    - track register sets with SmallBitVector</span></CodeLine>
<Link id="l05440" /><CodeLine lineNumber="5440"></CodeLine>
<Link id="l05441" /><CodeLine lineNumber="5441"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>()&#93;;</span></CodeLine>
<Link id="l05442" /><CodeLine lineNumber="5442"></CodeLine>
<Link id="l05443" /><CodeLine lineNumber="5443"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If this use references any register that&#39;s already a part of the</span></CodeLine>
<Link id="l05444" /><CodeLine lineNumber="5444"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// in-progress solution, consider it a requirement that a formula must</span></CodeLine>
<Link id="l05445" /><CodeLine lineNumber="5445"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// reference that register in order to be considered. This prunes out</span></CodeLine>
<Link id="l05446" /><CodeLine lineNumber="5446"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// unprofitable searching.</span></CodeLine>
<Link id="l05447" /><CodeLine lineNumber="5447"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallsetvector">SmallSetVector&lt;const SCEV &#42;, 4&gt;</a> ReqRegs;</span></CodeLine>
<Link id="l05448" /><CodeLine lineNumber="5448"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : CurRegs)</span></CodeLine>
<Link id="l05449" /><CodeLine lineNumber="5449"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Regs.count(S))</span></CodeLine>
<Link id="l05450" /><CodeLine lineNumber="5450"><span class="doxyHighlight">      ReqRegs.<a href="/docs/api/classes/llvm/setvector/#af34eb71cc483e84d2eca80575cb9ccde">insert</a>(S);</span></CodeLine>
<Link id="l05451" /><CodeLine lineNumber="5451"></CodeLine>
<Link id="l05452" /><CodeLine lineNumber="5452"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> NewRegs;</span></CodeLine>
<Link id="l05453" /><CodeLine lineNumber="5453"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> NewCost(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</span></CodeLine>
<Link id="l05454" /><CodeLine lineNumber="5454"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae) &#123;</span></CodeLine>
<Link id="l05455" /><CodeLine lineNumber="5455"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Ignore formulae which may not be ideal in terms of register reuse of</span></CodeLine>
<Link id="l05456" /><CodeLine lineNumber="5456"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ReqRegs.  The formula should use all required registers before</span></CodeLine>
<Link id="l05457" /><CodeLine lineNumber="5457"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// introducing new ones.</span></CodeLine>
<Link id="l05458" /><CodeLine lineNumber="5458"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This can sometimes (notably when trying to favour postinc) lead to</span></CodeLine>
<Link id="l05459" /><CodeLine lineNumber="5459"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// sub-optimial decisions. There it is best left to the cost modelling to</span></CodeLine>
<Link id="l05460" /><CodeLine lineNumber="5460"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// get correct.</span></CodeLine>
<Link id="l05461" /><CodeLine lineNumber="5461"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AMK != <a href="/docs/api/classes/llvm/targettransforminfo/#ad88649498463e1fe02380ad98886ce43a0e72bd25d3608a66eac09e4cfbb7c658">TTI::AMK&#95;PostIndexed</a> || LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>) &#123;</span></CodeLine>
<Link id="l05462" /><CodeLine lineNumber="5462"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> NumReqRegsToFind = std::min(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs(), ReqRegs.<a href="/docs/api/classes/llvm/setvector/#a1a42c1ba878bd637f374197d05f0a97f">size</a>());</span></CodeLine>
<Link id="l05463" /><CodeLine lineNumber="5463"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : ReqRegs) &#123;</span></CodeLine>
<Link id="l05464" /><CodeLine lineNumber="5464"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg &amp;&amp; <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg == <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) ||</span></CodeLine>
<Link id="l05465" /><CodeLine lineNumber="5465"><span class="doxyHighlight">            <a href="/docs/api/namespaces/llvm/#acd1cd968cb420c82d70926920fcdc7d7">is&#95;contained</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</span></CodeLine>
<Link id="l05466" /><CodeLine lineNumber="5466"><span class="doxyHighlight">          --NumReqRegsToFind;</span></CodeLine>
<Link id="l05467" /><CodeLine lineNumber="5467"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NumReqRegsToFind == 0)</span></CodeLine>
<Link id="l05468" /><CodeLine lineNumber="5468"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05469" /><CodeLine lineNumber="5469"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l05470" /><CodeLine lineNumber="5470"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05471" /><CodeLine lineNumber="5471"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NumReqRegsToFind != 0) &#123;</span></CodeLine>
<Link id="l05472" /><CodeLine lineNumber="5472"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If none of the formulae satisfied the required registers, then we could</span></CodeLine>
<Link id="l05473" /><CodeLine lineNumber="5473"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// clear ReqRegs and try again. Currently, we simply give up in this case.</span></CodeLine>
<Link id="l05474" /><CodeLine lineNumber="5474"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05475" /><CodeLine lineNumber="5475"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05476" /><CodeLine lineNumber="5476"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05477" /><CodeLine lineNumber="5477"></CodeLine>
<Link id="l05478" /><CodeLine lineNumber="5478"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Evaluate the cost of the current formula. If it&#39;s already worse than</span></CodeLine>
<Link id="l05479" /><CodeLine lineNumber="5479"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the current best, prune the search at that point.</span></CodeLine>
<Link id="l05480" /><CodeLine lineNumber="5480"><span class="doxyHighlight">    NewCost = CurCost;</span></CodeLine>
<Link id="l05481" /><CodeLine lineNumber="5481"><span class="doxyHighlight">    NewRegs = CurRegs;</span></CodeLine>
<Link id="l05482" /><CodeLine lineNumber="5482"><span class="doxyHighlight">    NewCost.RateFormula(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, NewRegs, VisitedRegs, LU);</span></CodeLine>
<Link id="l05483" /><CodeLine lineNumber="5483"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewCost.isLess(SolutionCost)) &#123;</span></CodeLine>
<Link id="l05484" /><CodeLine lineNumber="5484"><span class="doxyHighlight">      Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>);</span></CodeLine>
<Link id="l05485" /><CodeLine lineNumber="5485"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() != <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size()) &#123;</span></CodeLine>
<Link id="l05486" /><CodeLine lineNumber="5486"><span class="doxyHighlight">        SolveRecurse(Solution, SolutionCost, Workspace, NewCost,</span></CodeLine>
<Link id="l05487" /><CodeLine lineNumber="5487"><span class="doxyHighlight">                     NewRegs, VisitedRegs);</span></CodeLine>
<Link id="l05488" /><CodeLine lineNumber="5488"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getNumRegs() == 1 &amp;&amp; Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == 1)</span></CodeLine>
<Link id="l05489" /><CodeLine lineNumber="5489"><span class="doxyHighlight">          VisitedRegs.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg ? <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs&#91;0&#93;);</span></CodeLine>
<Link id="l05490" /><CodeLine lineNumber="5490"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05491" /><CodeLine lineNumber="5491"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;New best at &quot;</span><span class="doxyHighlight">; NewCost.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05492" /><CodeLine lineNumber="5492"><span class="doxyHighlight">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;.\\nRegs:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05493" /><CodeLine lineNumber="5493"><span class="doxyHighlight">                   </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S : NewRegs) <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</span></CodeLine>
<Link id="l05494" /><CodeLine lineNumber="5494"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;- &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;S &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05495" /><CodeLine lineNumber="5495"><span class="doxyHighlight">                   <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05496" /><CodeLine lineNumber="5496"></CodeLine>
<Link id="l05497" /><CodeLine lineNumber="5497"><span class="doxyHighlight">        SolutionCost = NewCost;</span></CodeLine>
<Link id="l05498" /><CodeLine lineNumber="5498"><span class="doxyHighlight">        Solution = Workspace;</span></CodeLine>
<Link id="l05499" /><CodeLine lineNumber="5499"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05500" /><CodeLine lineNumber="5500"><span class="doxyHighlight">      Workspace.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#ad97688dfe9cd802e2a0691cbe620218a">pop&#95;back</a>();</span></CodeLine>
<Link id="l05501" /><CodeLine lineNumber="5501"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05502" /><CodeLine lineNumber="5502"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05503" /><CodeLine lineNumber="5503"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05504" /><CodeLine lineNumber="5504"></CodeLine>
<Link id="l05505" /><CodeLine lineNumber="5505"><span class="doxyHighlightComment">/// Choose one formula from each use. Return the results in the given Solution</span></CodeLine>
<Link id="l05506" /><CodeLine lineNumber="5506"><span class="doxyHighlightComment">/// vector.</span></CodeLine>
<Link id="l05507" /><CodeLine lineNumber="5507"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::Solve(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l05508" /><CodeLine lineNumber="5508"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const Formula &#42;, 8&gt;</a> Workspace;</span></CodeLine>
<Link id="l05509" /><CodeLine lineNumber="5509"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> SolutionCost(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</span></CodeLine>
<Link id="l05510" /><CodeLine lineNumber="5510"><span class="doxyHighlight">  SolutionCost.Lose();</span></CodeLine>
<Link id="l05511" /><CodeLine lineNumber="5511"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a19921a3ceb99548f498d3df118eda9ed">Cost</a> CurCost(L, SE, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AMK);</span></CodeLine>
<Link id="l05512" /><CodeLine lineNumber="5512"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const SCEV &#42;, 16&gt;</a> CurRegs;</span></CodeLine>
<Link id="l05513" /><CodeLine lineNumber="5513"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;const SCEV &#42;&gt;</a> VisitedRegs;</span></CodeLine>
<Link id="l05514" /><CodeLine lineNumber="5514"><span class="doxyHighlight">  Workspace.<a href="/docs/api/classes/llvm/smallvectorimpl/#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(<a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size());</span></CodeLine>
<Link id="l05515" /><CodeLine lineNumber="5515"></CodeLine>
<Link id="l05516" /><CodeLine lineNumber="5516"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// SolveRecurse does all the work.</span></CodeLine>
<Link id="l05517" /><CodeLine lineNumber="5517"><span class="doxyHighlight">  SolveRecurse(Solution, SolutionCost, Workspace, CurCost,</span></CodeLine>
<Link id="l05518" /><CodeLine lineNumber="5518"><span class="doxyHighlight">               CurRegs, VisitedRegs);</span></CodeLine>
<Link id="l05519" /><CodeLine lineNumber="5519"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Solution.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l05520" /><CodeLine lineNumber="5520"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\nNo Satisfactory Solution\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05521" /><CodeLine lineNumber="5521"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05522" /><CodeLine lineNumber="5522"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05523" /><CodeLine lineNumber="5523"></CodeLine>
<Link id="l05524" /><CodeLine lineNumber="5524"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Ok, we&#39;ve now made all our decisions.</span></CodeLine>
<Link id="l05525" /><CodeLine lineNumber="5525"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span></CodeLine>
<Link id="l05526" /><CodeLine lineNumber="5526"><span class="doxyHighlight">                       </span><span class="doxyHighlightStringLiteral">&quot;The chosen solution requires &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05527" /><CodeLine lineNumber="5527"><span class="doxyHighlight">             SolutionCost.<a href="/docs/api/classes/llvm/instructioncost/#a7a0b7d0565cbdb80fcc368365bf86c9c">print</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05528" /><CodeLine lineNumber="5528"><span class="doxyHighlight">             </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> i = 0, e = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l05529" /><CodeLine lineNumber="5529"><span class="doxyHighlight">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05530" /><CodeLine lineNumber="5530"><span class="doxyHighlight">               <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;i&#93;.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05531" /><CodeLine lineNumber="5531"><span class="doxyHighlight">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span></CodeLine>
<Link id="l05532" /><CodeLine lineNumber="5532"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;    &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05533" /><CodeLine lineNumber="5533"><span class="doxyHighlight">               Solution&#91;i&#93;-&gt;print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>());</span></CodeLine>
<Link id="l05534" /><CodeLine lineNumber="5534"><span class="doxyHighlight">               <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05535" /><CodeLine lineNumber="5535"><span class="doxyHighlight">             &#125;);</span></CodeLine>
<Link id="l05536" /><CodeLine lineNumber="5536"></CodeLine>
<Link id="l05537" /><CodeLine lineNumber="5537"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Solution.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Malformed solution!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05538" /><CodeLine lineNumber="5538"></CodeLine>
<Link id="l05539" /><CodeLine lineNumber="5539"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> EnableDropUnprofitableSolution = &#91;&amp;&#93; &#123;</span></CodeLine>
<Link id="l05540" /><CodeLine lineNumber="5540"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (<a href="#a57a769eb2fe11448940d81a19e0140e2">AllowDropSolutionIfLessProfitable</a>) &#123;</span></CodeLine>
<Link id="l05541" /><CodeLine lineNumber="5541"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44ad7c4bd83c337c86d34f6c2d8eba1e736">cl::BOU&#95;TRUE</a>:</span></CodeLine>
<Link id="l05542" /><CodeLine lineNumber="5542"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05543" /><CodeLine lineNumber="5543"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44a4e55599a5b5277382b14e6e8eb1f63ef">cl::BOU&#95;FALSE</a>:</span></CodeLine>
<Link id="l05544" /><CodeLine lineNumber="5544"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05545" /><CodeLine lineNumber="5545"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44aa5bd521ebe67ddf0e90f1a9e540a6d43">cl::BOU&#95;UNSET</a>:</span></CodeLine>
<Link id="l05546" /><CodeLine lineNumber="5546"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.shouldDropLSRSolutionIfLessProfitable();</span></CodeLine>
<Link id="l05547" /><CodeLine lineNumber="5547"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05548" /><CodeLine lineNumber="5548"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</span><span class="doxyHighlightStringLiteral">&quot;Unhandled cl::boolOrDefault enum&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05549" /><CodeLine lineNumber="5549"><span class="doxyHighlight">  &#125;();</span></CodeLine>
<Link id="l05550" /><CodeLine lineNumber="5550"></CodeLine>
<Link id="l05551" /><CodeLine lineNumber="5551"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BaselineCost.isLess(SolutionCost)) &#123;</span></CodeLine>
<Link id="l05552" /><CodeLine lineNumber="5552"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!EnableDropUnprofitableSolution)</span></CodeLine>
<Link id="l05553" /><CodeLine lineNumber="5553"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l05554" /><CodeLine lineNumber="5554"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Baseline is more profitable than chosen solution, &quot;</span></CodeLine>
<Link id="l05555" /><CodeLine lineNumber="5555"><span class="doxyHighlight">                    </span><span class="doxyHighlightStringLiteral">&quot;add option &#39;lsr-drop-solution&#39; to drop LSR solution.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05556" /><CodeLine lineNumber="5556"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05557" /><CodeLine lineNumber="5557"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Baseline is more profitable than chosen &quot;</span></CodeLine>
<Link id="l05558" /><CodeLine lineNumber="5558"><span class="doxyHighlight">                           </span><span class="doxyHighlightStringLiteral">&quot;solution, dropping LSR solution.\\n&quot;</span><span class="doxyHighlight">;);</span></CodeLine>
<Link id="l05559" /><CodeLine lineNumber="5559"><span class="doxyHighlight">      Solution.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l05560" /><CodeLine lineNumber="5560"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05561" /><CodeLine lineNumber="5561"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05562" /><CodeLine lineNumber="5562"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05563" /><CodeLine lineNumber="5563"></CodeLine>
<Link id="l05564" /><CodeLine lineNumber="5564"><span class="doxyHighlightComment">/// Helper for AdjustInsertPositionForExpand. Climb up the dominator tree far as</span></CodeLine>
<Link id="l05565" /><CodeLine lineNumber="5565"><span class="doxyHighlightComment">/// we can go while still being dominated by the input positions. This helps</span></CodeLine>
<Link id="l05566" /><CodeLine lineNumber="5566"><span class="doxyHighlightComment">/// canonicalize the insert position, which encourages sharing.</span></CodeLine>
<Link id="l05567" /><CodeLine lineNumber="5567"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a></span></CodeLine>
<Link id="l05568" /><CodeLine lineNumber="5568"><span class="doxyHighlight">LSRInstance::HoistInsertPosition(<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</span></CodeLine>
<Link id="l05569" /><CodeLine lineNumber="5569"><span class="doxyHighlight">                                 </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Instruction &#42;&gt;</a> &amp;Inputs)</span></CodeLine>
<Link id="l05570" /><CodeLine lineNumber="5570"><span class="doxyHighlightKeyword">                                                                         const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l05571" /><CodeLine lineNumber="5571"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Tentative = &amp;&#42;IP;</span></CodeLine>
<Link id="l05572" /><CodeLine lineNumber="5572"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l05573" /><CodeLine lineNumber="5573"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> AllDominate = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05574" /><CodeLine lineNumber="5574"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;BetterPos = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05575" /><CodeLine lineNumber="5575"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Don&#39;t bother attempting to insert before a catchswitch, their basic block</span></CodeLine>
<Link id="l05576" /><CodeLine lineNumber="5576"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// cannot have other non-PHI instructions.</span></CodeLine>
<Link id="l05577" /><CodeLine lineNumber="5577"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(Tentative))</span></CodeLine>
<Link id="l05578" /><CodeLine lineNumber="5578"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> IP;</span></CodeLine>
<Link id="l05579" /><CodeLine lineNumber="5579"></CodeLine>
<Link id="l05580" /><CodeLine lineNumber="5580"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Inst : Inputs) &#123;</span></CodeLine>
<Link id="l05581" /><CodeLine lineNumber="5581"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Inst == Tentative || !DT.dominates(Inst, Tentative)) &#123;</span></CodeLine>
<Link id="l05582" /><CodeLine lineNumber="5582"><span class="doxyHighlight">        AllDominate = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05583" /><CodeLine lineNumber="5583"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05584" /><CodeLine lineNumber="5584"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05585" /><CodeLine lineNumber="5585"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Attempt to find an insert position in the middle of the block,</span></CodeLine>
<Link id="l05586" /><CodeLine lineNumber="5586"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// instead of at the end, so that it can be used for other expansions.</span></CodeLine>
<Link id="l05587" /><CodeLine lineNumber="5587"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Tentative-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() == Inst-&gt;getParent() &amp;&amp;</span></CodeLine>
<Link id="l05588" /><CodeLine lineNumber="5588"><span class="doxyHighlight">          (!BetterPos || !DT.dominates(Inst, BetterPos)))</span></CodeLine>
<Link id="l05589" /><CodeLine lineNumber="5589"><span class="doxyHighlight">        BetterPos = &amp;&#42;std::next(<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a>(Inst));</span></CodeLine>
<Link id="l05590" /><CodeLine lineNumber="5590"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05591" /><CodeLine lineNumber="5591"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!AllDominate)</span></CodeLine>
<Link id="l05592" /><CodeLine lineNumber="5592"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05593" /><CodeLine lineNumber="5593"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BetterPos)</span></CodeLine>
<Link id="l05594" /><CodeLine lineNumber="5594"><span class="doxyHighlight">      IP = BetterPos-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>();</span></CodeLine>
<Link id="l05595" /><CodeLine lineNumber="5595"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l05596" /><CodeLine lineNumber="5596"><span class="doxyHighlight">      IP = Tentative-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>();</span></CodeLine>
<Link id="l05597" /><CodeLine lineNumber="5597"></CodeLine>
<Link id="l05598" /><CodeLine lineNumber="5598"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;IPLoop = LI.getLoopFor(IP-&gt;getParent());</span></CodeLine>
<Link id="l05599" /><CodeLine lineNumber="5599"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> IPLoopDepth = IPLoop ? IPLoop-&gt;<a href="/docs/api/classes/llvm/loopbase/#a57994482c17097d9f936acff3a6598ac">getLoopDepth</a>() : 0;</span></CodeLine>
<Link id="l05600" /><CodeLine lineNumber="5600"></CodeLine>
<Link id="l05601" /><CodeLine lineNumber="5601"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;IDom;</span></CodeLine>
<Link id="l05602" /><CodeLine lineNumber="5602"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a58b9df85470fc4e2a8066ff6a62e5a34">DomTreeNode</a> &#42;Rung = DT.getNode(IP-&gt;getParent()); ; ) &#123;</span></CodeLine>
<Link id="l05603" /><CodeLine lineNumber="5603"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Rung) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> IP;</span></CodeLine>
<Link id="l05604" /><CodeLine lineNumber="5604"><span class="doxyHighlight">      Rung = Rung-&gt;getIDom();</span></CodeLine>
<Link id="l05605" /><CodeLine lineNumber="5605"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Rung) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> IP;</span></CodeLine>
<Link id="l05606" /><CodeLine lineNumber="5606"><span class="doxyHighlight">      IDom = Rung-&gt;getBlock();</span></CodeLine>
<Link id="l05607" /><CodeLine lineNumber="5607"></CodeLine>
<Link id="l05608" /><CodeLine lineNumber="5608"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Don&#39;t climb into a loop though.</span></CodeLine>
<Link id="l05609" /><CodeLine lineNumber="5609"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;IDomLoop = LI.getLoopFor(IDom);</span></CodeLine>
<Link id="l05610" /><CodeLine lineNumber="5610"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> IDomDepth = IDomLoop ? IDomLoop-&gt;<a href="/docs/api/classes/llvm/loopbase/#a57994482c17097d9f936acff3a6598ac">getLoopDepth</a>() : 0;</span></CodeLine>
<Link id="l05611" /><CodeLine lineNumber="5611"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IDomDepth &lt;= IPLoopDepth &amp;&amp;</span></CodeLine>
<Link id="l05612" /><CodeLine lineNumber="5612"><span class="doxyHighlight">          (IDomDepth != IPLoopDepth || IDomLoop == IPLoop))</span></CodeLine>
<Link id="l05613" /><CodeLine lineNumber="5613"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05614" /><CodeLine lineNumber="5614"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05615" /><CodeLine lineNumber="5615"></CodeLine>
<Link id="l05616" /><CodeLine lineNumber="5616"><span class="doxyHighlight">    Tentative = IDom-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>();</span></CodeLine>
<Link id="l05617" /><CodeLine lineNumber="5617"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05618" /><CodeLine lineNumber="5618"></CodeLine>
<Link id="l05619" /><CodeLine lineNumber="5619"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> IP;</span></CodeLine>
<Link id="l05620" /><CodeLine lineNumber="5620"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05621" /><CodeLine lineNumber="5621"></CodeLine>
<Link id="l05622" /><CodeLine lineNumber="5622"><span class="doxyHighlightComment">/// Determine an input position which will be dominated by the operands and</span></CodeLine>
<Link id="l05623" /><CodeLine lineNumber="5623"><span class="doxyHighlightComment">/// which will dominate the result.</span></CodeLine>
<Link id="l05624" /><CodeLine lineNumber="5624"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> LSRInstance::AdjustInsertPositionForExpand(</span></CodeLine>
<Link id="l05625" /><CodeLine lineNumber="5625"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> LowestIP, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRFixup &amp;LF, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l05626" /><CodeLine lineNumber="5626"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Collect some instructions which must be dominated by the</span></CodeLine>
<Link id="l05627" /><CodeLine lineNumber="5627"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// expanding replacement. These must be dominated by any operands that</span></CodeLine>
<Link id="l05628" /><CodeLine lineNumber="5628"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// will be required in the expansion.</span></CodeLine>
<Link id="l05629" /><CodeLine lineNumber="5629"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Instruction &#42;, 4&gt;</a> Inputs;</span></CodeLine>
<Link id="l05630" /><CodeLine lineNumber="5630"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(LF.OperandValToReplace))</span></CodeLine>
<Link id="l05631" /><CodeLine lineNumber="5631"><span class="doxyHighlight">    Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l05632" /><CodeLine lineNumber="5632"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>)</span></CodeLine>
<Link id="l05633" /><CodeLine lineNumber="5633"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> =</span></CodeLine>
<Link id="l05634" /><CodeLine lineNumber="5634"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ICmpInst&gt;</a>(LF.UserInst)-&gt;getOperand(1)))</span></CodeLine>
<Link id="l05635" /><CodeLine lineNumber="5635"><span class="doxyHighlight">      Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l05636" /><CodeLine lineNumber="5636"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LF.PostIncLoops.count(L)) &#123;</span></CodeLine>
<Link id="l05637" /><CodeLine lineNumber="5637"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LF.isUseFullyOutsideLoop(L))</span></CodeLine>
<Link id="l05638" /><CodeLine lineNumber="5638"><span class="doxyHighlight">      Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getLoopLatch()-&gt;getTerminator());</span></CodeLine>
<Link id="l05639" /><CodeLine lineNumber="5639"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l05640" /><CodeLine lineNumber="5640"><span class="doxyHighlight">      Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(IVIncInsertPos);</span></CodeLine>
<Link id="l05641" /><CodeLine lineNumber="5641"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05642" /><CodeLine lineNumber="5642"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The expansion must also be dominated by the increment positions of any</span></CodeLine>
<Link id="l05643" /><CodeLine lineNumber="5643"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// loops it for which it is using post-inc mode.</span></CodeLine>
<Link id="l05644" /><CodeLine lineNumber="5644"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;PIL : LF.PostIncLoops) &#123;</span></CodeLine>
<Link id="l05645" /><CodeLine lineNumber="5645"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PIL == L) </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05646" /><CodeLine lineNumber="5646"></CodeLine>
<Link id="l05647" /><CodeLine lineNumber="5647"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Be dominated by the loop exit.</span></CodeLine>
<Link id="l05648" /><CodeLine lineNumber="5648"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock &#42;, 4&gt;</a> ExitingBlocks;</span></CodeLine>
<Link id="l05649" /><CodeLine lineNumber="5649"><span class="doxyHighlight">    PIL-&gt;<a href="/docs/api/classes/llvm/loopbase/#a46880fab7a9d5bd439725f2acc59b80d">getExitingBlocks</a>(ExitingBlocks);</span></CodeLine>
<Link id="l05650" /><CodeLine lineNumber="5650"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!ExitingBlocks.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l05651" /><CodeLine lineNumber="5651"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB = ExitingBlocks&#91;0&#93;;</span></CodeLine>
<Link id="l05652" /><CodeLine lineNumber="5652"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 1, e = ExitingBlocks.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>(); i != e; ++i)</span></CodeLine>
<Link id="l05653" /><CodeLine lineNumber="5653"><span class="doxyHighlight">        BB = DT.findNearestCommonDominator(BB, ExitingBlocks&#91;i&#93;);</span></CodeLine>
<Link id="l05654" /><CodeLine lineNumber="5654"><span class="doxyHighlight">      Inputs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>());</span></CodeLine>
<Link id="l05655" /><CodeLine lineNumber="5655"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05656" /><CodeLine lineNumber="5656"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05657" /><CodeLine lineNumber="5657"></CodeLine>
<Link id="l05658" /><CodeLine lineNumber="5658"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(LowestIP) &amp;&amp; !LowestIP-&gt;isEHPad()</span></CodeLine>
<Link id="l05659" /><CodeLine lineNumber="5659"><span class="doxyHighlight">         &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgInfoIntrinsic&gt;</a>(LowestIP) &amp;&amp;</span></CodeLine>
<Link id="l05660" /><CodeLine lineNumber="5660"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Insertion point must be a normal instruction&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05661" /><CodeLine lineNumber="5661"></CodeLine>
<Link id="l05662" /><CodeLine lineNumber="5662"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Then, climb up the immediate dominator tree as far as we can go while</span></CodeLine>
<Link id="l05663" /><CodeLine lineNumber="5663"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// still being dominated by the input positions.</span></CodeLine>
<Link id="l05664" /><CodeLine lineNumber="5664"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP = HoistInsertPosition(LowestIP, Inputs);</span></CodeLine>
<Link id="l05665" /><CodeLine lineNumber="5665"></CodeLine>
<Link id="l05666" /><CodeLine lineNumber="5666"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Don&#39;t insert instructions before PHI nodes.</span></CodeLine>
<Link id="l05667" /><CodeLine lineNumber="5667"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(IP)) ++IP;</span></CodeLine>
<Link id="l05668" /><CodeLine lineNumber="5668"></CodeLine>
<Link id="l05669" /><CodeLine lineNumber="5669"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Ignore landingpad instructions.</span></CodeLine>
<Link id="l05670" /><CodeLine lineNumber="5670"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (IP-&gt;isEHPad()) ++IP;</span></CodeLine>
<Link id="l05671" /><CodeLine lineNumber="5671"></CodeLine>
<Link id="l05672" /><CodeLine lineNumber="5672"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Ignore debug intrinsics.</span></CodeLine>
<Link id="l05673" /><CodeLine lineNumber="5673"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgInfoIntrinsic&gt;</a>(IP)) ++IP;</span></CodeLine>
<Link id="l05674" /><CodeLine lineNumber="5674"></CodeLine>
<Link id="l05675" /><CodeLine lineNumber="5675"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Set IP below instructions recently inserted by SCEVExpander. This keeps the</span></CodeLine>
<Link id="l05676" /><CodeLine lineNumber="5676"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// IP consistent across expansions and allows the previously inserted</span></CodeLine>
<Link id="l05677" /><CodeLine lineNumber="5677"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instructions to be reused by subsequent expansion.</span></CodeLine>
<Link id="l05678" /><CodeLine lineNumber="5678"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.isInsertedInstruction(&amp;&#42;IP) &amp;&amp; IP != LowestIP)</span></CodeLine>
<Link id="l05679" /><CodeLine lineNumber="5679"><span class="doxyHighlight">    ++IP;</span></CodeLine>
<Link id="l05680" /><CodeLine lineNumber="5680"></CodeLine>
<Link id="l05681" /><CodeLine lineNumber="5681"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> IP;</span></CodeLine>
<Link id="l05682" /><CodeLine lineNumber="5682"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05683" /><CodeLine lineNumber="5683"></CodeLine>
<Link id="l05684" /><CodeLine lineNumber="5684"><span class="doxyHighlightComment">/// Emit instructions for the leading candidate expression for this LSRUse (this</span></CodeLine>
<Link id="l05685" /><CodeLine lineNumber="5685"><span class="doxyHighlightComment">/// is called &quot;expanding&quot;).</span></CodeLine>
<Link id="l05686" /><CodeLine lineNumber="5686"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/value">Value</a> &#42;LSRInstance::Expand(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRFixup &amp;LF,</span></CodeLine>
<Link id="l05687" /><CodeLine lineNumber="5687"><span class="doxyHighlight">                           </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, <a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> IP,</span></CodeLine>
<Link id="l05688" /><CodeLine lineNumber="5688"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l05689" /><CodeLine lineNumber="5689"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.RigidFormula)</span></CodeLine>
<Link id="l05690" /><CodeLine lineNumber="5690"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> LF.OperandValToReplace;</span></CodeLine>
<Link id="l05691" /><CodeLine lineNumber="5691"></CodeLine>
<Link id="l05692" /><CodeLine lineNumber="5692"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Determine an input position which will be dominated by the operands and</span></CodeLine>
<Link id="l05693" /><CodeLine lineNumber="5693"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// which will dominate the result.</span></CodeLine>
<Link id="l05694" /><CodeLine lineNumber="5694"><span class="doxyHighlight">  IP = AdjustInsertPositionForExpand(IP, LF, LU);</span></CodeLine>
<Link id="l05695" /><CodeLine lineNumber="5695"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setInsertPoint(&amp;&#42;IP);</span></CodeLine>
<Link id="l05696" /><CodeLine lineNumber="5696"></CodeLine>
<Link id="l05697" /><CodeLine lineNumber="5697"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Inform the Rewriter if we have a post-increment use, so that it can</span></CodeLine>
<Link id="l05698" /><CodeLine lineNumber="5698"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// perform an advantageous expansion.</span></CodeLine>
<Link id="l05699" /><CodeLine lineNumber="5699"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setPostInc(LF.PostIncLoops);</span></CodeLine>
<Link id="l05700" /><CodeLine lineNumber="5700"></CodeLine>
<Link id="l05701" /><CodeLine lineNumber="5701"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This is the type that the user actually needs.</span></CodeLine>
<Link id="l05702" /><CodeLine lineNumber="5702"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;OpTy = LF.OperandValToReplace-&gt;getType();</span></CodeLine>
<Link id="l05703" /><CodeLine lineNumber="5703"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This will be the type that we&#39;ll initially expand to.</span></CodeLine>
<Link id="l05704" /><CodeLine lineNumber="5704"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.getType();</span></CodeLine>
<Link id="l05705" /><CodeLine lineNumber="5705"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Ty)</span></CodeLine>
<Link id="l05706" /><CodeLine lineNumber="5706"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// No type known; just expand directly to the ultimate type.</span></CodeLine>
<Link id="l05707" /><CodeLine lineNumber="5707"><span class="doxyHighlight">    Ty = OpTy;</span></CodeLine>
<Link id="l05708" /><CodeLine lineNumber="5708"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.getEffectiveSCEVType(Ty) == SE.getEffectiveSCEVType(OpTy))</span></CodeLine>
<Link id="l05709" /><CodeLine lineNumber="5709"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Expand directly to the ultimate type if it&#39;s the right size.</span></CodeLine>
<Link id="l05710" /><CodeLine lineNumber="5710"><span class="doxyHighlight">    Ty = OpTy;</span></CodeLine>
<Link id="l05711" /><CodeLine lineNumber="5711"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This is the type to do integer arithmetic in.</span></CodeLine>
<Link id="l05712" /><CodeLine lineNumber="5712"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;IntTy = SE.getEffectiveSCEVType(Ty);</span></CodeLine>
<Link id="l05713" /><CodeLine lineNumber="5713"></CodeLine>
<Link id="l05714" /><CodeLine lineNumber="5714"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Build up a list of operands to add together to form the full base.</span></CodeLine>
<Link id="l05715" /><CodeLine lineNumber="5715"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const SCEV &#42;, 8&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</span></CodeLine>
<Link id="l05716" /><CodeLine lineNumber="5716"></CodeLine>
<Link id="l05717" /><CodeLine lineNumber="5717"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Expand the BaseRegs portion.</span></CodeLine>
<Link id="l05718" /><CodeLine lineNumber="5718"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseRegs) &#123;</span></CodeLine>
<Link id="l05719" /><CodeLine lineNumber="5719"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>-&gt;isZero() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Zero allocated in a base register!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05720" /><CodeLine lineNumber="5720"></CodeLine>
<Link id="l05721" /><CodeLine lineNumber="5721"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we&#39;re expanding for a post-inc user, make the post-inc adjustment.</span></CodeLine>
<Link id="l05722" /><CodeLine lineNumber="5722"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> = <a href="/docs/api/namespaces/llvm/#a6fb1355b48afff4e97045b546b5f6415">denormalizeForPostIncUse</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, LF.PostIncLoops, SE);</span></CodeLine>
<Link id="l05723" /><CodeLine lineNumber="5723"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">)));</span></CodeLine>
<Link id="l05724" /><CodeLine lineNumber="5724"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05725" /><CodeLine lineNumber="5725"></CodeLine>
<Link id="l05726" /><CodeLine lineNumber="5726"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Expand the ScaledReg portion.</span></CodeLine>
<Link id="l05727" /><CodeLine lineNumber="5727"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;ICmpScaledV = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05728" /><CodeLine lineNumber="5728"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 0) &#123;</span></CodeLine>
<Link id="l05729" /><CodeLine lineNumber="5729"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;ScaledS = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.ScaledReg;</span></CodeLine>
<Link id="l05730" /><CodeLine lineNumber="5730"></CodeLine>
<Link id="l05731" /><CodeLine lineNumber="5731"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we&#39;re expanding for a post-inc user, make the post-inc adjustment.</span></CodeLine>
<Link id="l05732" /><CodeLine lineNumber="5732"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a> = </span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/namespaces/llvm/#ac765465998d0f34ed6123631bda54fab">PostIncLoopSet</a> &amp;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(LF.PostIncLoops);</span></CodeLine>
<Link id="l05733" /><CodeLine lineNumber="5733"><span class="doxyHighlight">    ScaledS = <a href="/docs/api/namespaces/llvm/#a6fb1355b48afff4e97045b546b5f6415">denormalizeForPostIncUse</a>(ScaledS, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>, SE);</span></CodeLine>
<Link id="l05734" /><CodeLine lineNumber="5734"></CodeLine>
<Link id="l05735" /><CodeLine lineNumber="5735"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>) &#123;</span></CodeLine>
<Link id="l05736" /><CodeLine lineNumber="5736"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Expand ScaleReg as if it was part of the base regs.</span></CodeLine>
<Link id="l05737" /><CodeLine lineNumber="5737"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 1)</span></CodeLine>
<Link id="l05738" /><CodeLine lineNumber="5738"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(</span></CodeLine>
<Link id="l05739" /><CodeLine lineNumber="5739"><span class="doxyHighlight">            SE.getUnknown(<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(ScaledS, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">)));</span></CodeLine>
<Link id="l05740" /><CodeLine lineNumber="5740"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05741" /><CodeLine lineNumber="5741"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// An interesting way of &quot;folding&quot; with an icmp is to use a negated</span></CodeLine>
<Link id="l05742" /><CodeLine lineNumber="5742"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// scale, which we&#39;ll implement by inserting it into the other operand</span></CodeLine>
<Link id="l05743" /><CodeLine lineNumber="5743"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// of the icmp.</span></CodeLine>
<Link id="l05744" /><CodeLine lineNumber="5744"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == -1 &amp;&amp;</span></CodeLine>
<Link id="l05745" /><CodeLine lineNumber="5745"><span class="doxyHighlight">               </span><span class="doxyHighlightStringLiteral">&quot;The only scale supported by ICmpZero uses is -1!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05746" /><CodeLine lineNumber="5746"><span class="doxyHighlight">        ICmpScaledV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(ScaledS, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05747" /><CodeLine lineNumber="5747"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05748" /><CodeLine lineNumber="5748"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05749" /><CodeLine lineNumber="5749"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Otherwise just expand the scaled register and an explicit scale,</span></CodeLine>
<Link id="l05750" /><CodeLine lineNumber="5750"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// which is expected to be matched as part of the address.</span></CodeLine>
<Link id="l05751" /><CodeLine lineNumber="5751"></CodeLine>
<Link id="l05752" /><CodeLine lineNumber="5752"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Flush the operand list to suppress SCEVExpander hoisting address modes.</span></CodeLine>
<Link id="l05753" /><CodeLine lineNumber="5753"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Unless the addressing mode will not be folded.</span></CodeLine>
<Link id="l05754" /><CodeLine lineNumber="5754"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.empty() &amp;&amp; LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a> &amp;&amp;</span></CodeLine>
<Link id="l05755" /><CodeLine lineNumber="5755"><span class="doxyHighlight">          <a href="#aa847a3eff7b875035d9f887587291940">isAMCompletelyFolded</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, LU, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>)) &#123;</span></CodeLine>
<Link id="l05756" /><CodeLine lineNumber="5756"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>), </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05757" /><CodeLine lineNumber="5757"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.clear();</span></CodeLine>
<Link id="l05758" /><CodeLine lineNumber="5758"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(FullV));</span></CodeLine>
<Link id="l05759" /><CodeLine lineNumber="5759"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05760" /><CodeLine lineNumber="5760"><span class="doxyHighlight">      ScaledS = SE.getUnknown(<a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(ScaledS, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l05761" /><CodeLine lineNumber="5761"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale != 1)</span></CodeLine>
<Link id="l05762" /><CodeLine lineNumber="5762"><span class="doxyHighlight">        ScaledS =</span></CodeLine>
<Link id="l05763" /><CodeLine lineNumber="5763"><span class="doxyHighlight">            SE.getMulExpr(ScaledS, SE.getConstant(ScaledS-&gt;<a href="/docs/api/classes/llvm/scev/#aefeda9454a5e8dfcec3deb106964832a">getType</a>(), <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale));</span></CodeLine>
<Link id="l05764" /><CodeLine lineNumber="5764"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(ScaledS);</span></CodeLine>
<Link id="l05765" /><CodeLine lineNumber="5765"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05766" /><CodeLine lineNumber="5766"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05767" /><CodeLine lineNumber="5767"></CodeLine>
<Link id="l05768" /><CodeLine lineNumber="5768"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Expand the GV portion.</span></CodeLine>
<Link id="l05769" /><CodeLine lineNumber="5769"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV) &#123;</span></CodeLine>
<Link id="l05770" /><CodeLine lineNumber="5770"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Flush the operand list to suppress SCEVExpander hoisting.</span></CodeLine>
<Link id="l05771" /><CodeLine lineNumber="5771"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.empty()) &#123;</span></CodeLine>
<Link id="l05772" /><CodeLine lineNumber="5772"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>), IntTy);</span></CodeLine>
<Link id="l05773" /><CodeLine lineNumber="5773"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.clear();</span></CodeLine>
<Link id="l05774" /><CodeLine lineNumber="5774"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(FullV));</span></CodeLine>
<Link id="l05775" /><CodeLine lineNumber="5775"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05776" /><CodeLine lineNumber="5776"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV));</span></CodeLine>
<Link id="l05777" /><CodeLine lineNumber="5777"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05778" /><CodeLine lineNumber="5778"></CodeLine>
<Link id="l05779" /><CodeLine lineNumber="5779"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Flush the operand list to suppress SCEVExpander hoisting of both folded and</span></CodeLine>
<Link id="l05780" /><CodeLine lineNumber="5780"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// unfolded offsets. LSR assumes they both live next to their uses.</span></CodeLine>
<Link id="l05781" /><CodeLine lineNumber="5781"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.empty()) &#123;</span></CodeLine>
<Link id="l05782" /><CodeLine lineNumber="5782"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>), Ty);</span></CodeLine>
<Link id="l05783" /><CodeLine lineNumber="5783"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.clear();</span></CodeLine>
<Link id="l05784" /><CodeLine lineNumber="5784"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(FullV));</span></CodeLine>
<Link id="l05785" /><CodeLine lineNumber="5785"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05786" /><CodeLine lineNumber="5786"></CodeLine>
<Link id="l05787" /><CodeLine lineNumber="5787"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// FIXME: Are we sure we won&#39;t get a mismatch here? Is there a way to bail</span></CodeLine>
<Link id="l05788" /><CodeLine lineNumber="5788"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// out at this point, or should we generate a SCEV adding together mixed</span></CodeLine>
<Link id="l05789" /><CodeLine lineNumber="5789"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// offsets?</span></CodeLine>
<Link id="l05790" /><CodeLine lineNumber="5790"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.isCompatibleImmediate(LF.Offset) &amp;&amp;</span></CodeLine>
<Link id="l05791" /><CodeLine lineNumber="5791"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Expanding mismatched offsets\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05792" /><CodeLine lineNumber="5792"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Expand the immediate portion.</span></CodeLine>
<Link id="l05793" /><CodeLine lineNumber="5793"><span class="doxyHighlight">  Immediate <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseOffset.addUnsigned(LF.Offset);</span></CodeLine>
<Link id="l05794" /><CodeLine lineNumber="5794"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.isNonZero()) &#123;</span></CodeLine>
<Link id="l05795" /><CodeLine lineNumber="5795"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>) &#123;</span></CodeLine>
<Link id="l05796" /><CodeLine lineNumber="5796"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// The other interesting way of &quot;folding&quot; with an ICmpZero is to use a</span></CodeLine>
<Link id="l05797" /><CodeLine lineNumber="5797"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// negated immediate.</span></CodeLine>
<Link id="l05798" /><CodeLine lineNumber="5798"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!ICmpScaledV)</span></CodeLine>
<Link id="l05799" /><CodeLine lineNumber="5799"><span class="doxyHighlight">        ICmpScaledV =</span></CodeLine>
<Link id="l05800" /><CodeLine lineNumber="5800"><span class="doxyHighlight">            ConstantInt::get(IntTy, -(uint64&#95;t)<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue());</span></CodeLine>
<Link id="l05801" /><CodeLine lineNumber="5801"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05802" /><CodeLine lineNumber="5802"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(SE.getUnknown(ICmpScaledV));</span></CodeLine>
<Link id="l05803" /><CodeLine lineNumber="5803"><span class="doxyHighlight">        ICmpScaledV = ConstantInt::get(IntTy, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue());</span></CodeLine>
<Link id="l05804" /><CodeLine lineNumber="5804"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05805" /><CodeLine lineNumber="5805"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05806" /><CodeLine lineNumber="5806"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Just add the immediate values. These again are expected to be matched</span></CodeLine>
<Link id="l05807" /><CodeLine lineNumber="5807"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// as part of the address.</span></CodeLine>
<Link id="l05808" /><CodeLine lineNumber="5808"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getUnknownSCEV(SE, IntTy));</span></CodeLine>
<Link id="l05809" /><CodeLine lineNumber="5809"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05810" /><CodeLine lineNumber="5810"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05811" /><CodeLine lineNumber="5811"></CodeLine>
<Link id="l05812" /><CodeLine lineNumber="5812"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Expand the unfolded offset portion.</span></CodeLine>
<Link id="l05813" /><CodeLine lineNumber="5813"><span class="doxyHighlight">  Immediate UnfoldedOffset = <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.UnfoldedOffset;</span></CodeLine>
<Link id="l05814" /><CodeLine lineNumber="5814"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UnfoldedOffset.isNonZero()) &#123;</span></CodeLine>
<Link id="l05815" /><CodeLine lineNumber="5815"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Just add the immediate values.</span></CodeLine>
<Link id="l05816" /><CodeLine lineNumber="5816"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.push&#95;back(UnfoldedOffset.getUnknownSCEV(SE, IntTy));</span></CodeLine>
<Link id="l05817" /><CodeLine lineNumber="5817"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05818" /><CodeLine lineNumber="5818"></CodeLine>
<Link id="l05819" /><CodeLine lineNumber="5819"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Emit instructions summing all the operands.</span></CodeLine>
<Link id="l05820" /><CodeLine lineNumber="5820"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;FullS = <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>.empty() ?</span></CodeLine>
<Link id="l05821" /><CodeLine lineNumber="5821"><span class="doxyHighlight">                      SE.getConstant(IntTy, 0) :</span></CodeLine>
<Link id="l05822" /><CodeLine lineNumber="5822"><span class="doxyHighlight">                      SE.getAddExpr(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>);</span></CodeLine>
<Link id="l05823" /><CodeLine lineNumber="5823"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.expandCodeFor(FullS, Ty);</span></CodeLine>
<Link id="l05824" /><CodeLine lineNumber="5824"></CodeLine>
<Link id="l05825" /><CodeLine lineNumber="5825"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We&#39;re done expanding now, so reset the rewriter.</span></CodeLine>
<Link id="l05826" /><CodeLine lineNumber="5826"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clearPostInc();</span></CodeLine>
<Link id="l05827" /><CodeLine lineNumber="5827"></CodeLine>
<Link id="l05828" /><CodeLine lineNumber="5828"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// An ICmpZero Formula represents an ICmp which we&#39;re handling as a</span></CodeLine>
<Link id="l05829" /><CodeLine lineNumber="5829"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// comparison against zero. Now that we&#39;ve expanded an expression for that</span></CodeLine>
<Link id="l05830" /><CodeLine lineNumber="5830"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// form, update the ICmp&#39;s other operand.</span></CodeLine>
<Link id="l05831" /><CodeLine lineNumber="5831"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>) &#123;</span></CodeLine>
<Link id="l05832" /><CodeLine lineNumber="5832"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/icmpinst">ICmpInst</a> &#42;CI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;ICmpInst&gt;</a>(LF.UserInst);</span></CodeLine>
<Link id="l05833" /><CodeLine lineNumber="5833"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;OperandIsInstr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(CI-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(1)))</span></CodeLine>
<Link id="l05834" /><CodeLine lineNumber="5834"><span class="doxyHighlight">      DeadInsts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(OperandIsInstr);</span></CodeLine>
<Link id="l05835" /><CodeLine lineNumber="5835"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.BaseGV &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;ICmp does not support folding a global value and &quot;</span></CodeLine>
<Link id="l05836" /><CodeLine lineNumber="5836"><span class="doxyHighlight">                           </span><span class="doxyHighlightStringLiteral">&quot;a scale at the same time!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05837" /><CodeLine lineNumber="5837"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == -1) &#123;</span></CodeLine>
<Link id="l05838" /><CodeLine lineNumber="5838"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ICmpScaledV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != OpTy) &#123;</span></CodeLine>
<Link id="l05839" /><CodeLine lineNumber="5839"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Cast = <a href="/docs/api/classes/llvm/castinst/#ad2e0ab6d7096fe67a2216fe349044387">CastInst::Create</a>(</span></CodeLine>
<Link id="l05840" /><CodeLine lineNumber="5840"><span class="doxyHighlight">            <a href="/docs/api/classes/llvm/castinst/#a06dc25da1f16f389f5244304e8d33127">CastInst::getCastOpcode</a>(ICmpScaledV, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, OpTy, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l05841" /><CodeLine lineNumber="5841"><span class="doxyHighlight">            ICmpScaledV, OpTy, </span><span class="doxyHighlightStringLiteral">&quot;tmp&quot;</span><span class="doxyHighlight">, CI-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</span></CodeLine>
<Link id="l05842" /><CodeLine lineNumber="5842"><span class="doxyHighlight">        ICmpScaledV = Cast;</span></CodeLine>
<Link id="l05843" /><CodeLine lineNumber="5843"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05844" /><CodeLine lineNumber="5844"><span class="doxyHighlight">      CI-&gt;<a href="/docs/api/classes/llvm/user/#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, ICmpScaledV);</span></CodeLine>
<Link id="l05845" /><CodeLine lineNumber="5845"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05846" /><CodeLine lineNumber="5846"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// A scale of 1 means that the scale has been expanded as part of the</span></CodeLine>
<Link id="l05847" /><CodeLine lineNumber="5847"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// base regs.</span></CodeLine>
<Link id="l05848" /><CodeLine lineNumber="5848"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 0 || <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.Scale == 1) &amp;&amp;</span></CodeLine>
<Link id="l05849" /><CodeLine lineNumber="5849"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;ICmp does not support folding a global value and &quot;</span></CodeLine>
<Link id="l05850" /><CodeLine lineNumber="5850"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;a scale at the same time!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05851" /><CodeLine lineNumber="5851"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/constant">Constant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/classes/llvm/constantint/#a9ad53d2a00a6fb861b3a048c6592b742">ConstantInt::getSigned</a>(SE.getEffectiveSCEVType(OpTy),</span></CodeLine>
<Link id="l05852" /><CodeLine lineNumber="5852"><span class="doxyHighlight">                                           -(uint64&#95;t)<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>.getFixedValue());</span></CodeLine>
<Link id="l05853" /><CodeLine lineNumber="5853"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getType() != OpTy) &#123;</span></CodeLine>
<Link id="l05854" /><CodeLine lineNumber="5854"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a8bf77c90e2fb57af4d4d4aab084f7052">ConstantFoldCastOperand</a>(</span></CodeLine>
<Link id="l05855" /><CodeLine lineNumber="5855"><span class="doxyHighlight">            <a href="/docs/api/classes/llvm/castinst/#a06dc25da1f16f389f5244304e8d33127">CastInst::getCastOpcode</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, OpTy, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">), <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, OpTy,</span></CodeLine>
<Link id="l05856" /><CodeLine lineNumber="5856"><span class="doxyHighlight">            CI-&gt;<a href="/docs/api/classes/llvm/instruction/#af65afd02332c4f21c2fab7d217d6600f">getDataLayout</a>());</span></CodeLine>
<Link id="l05857" /><CodeLine lineNumber="5857"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Cast of ConstantInt should have folded&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l05858" /><CodeLine lineNumber="5858"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05859" /><CodeLine lineNumber="5859"></CodeLine>
<Link id="l05860" /><CodeLine lineNumber="5860"><span class="doxyHighlight">      CI-&gt;<a href="/docs/api/classes/llvm/user/#a5fa9b8e1842b354f64c1ba6be0a4a17f">setOperand</a>(1, <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>);</span></CodeLine>
<Link id="l05861" /><CodeLine lineNumber="5861"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05862" /><CodeLine lineNumber="5862"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l05863" /><CodeLine lineNumber="5863"></CodeLine>
<Link id="l05864" /><CodeLine lineNumber="5864"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> FullV;</span></CodeLine>
<Link id="l05865" /><CodeLine lineNumber="5865"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05866" /><CodeLine lineNumber="5866"></CodeLine>
<Link id="l05867" /><CodeLine lineNumber="5867"><span class="doxyHighlightComment">/// Helper for Rewrite. PHI nodes are special because the use of their operands</span></CodeLine>
<Link id="l05868" /><CodeLine lineNumber="5868"><span class="doxyHighlightComment">/// effectively happens in their predecessor blocks, so the expression may need</span></CodeLine>
<Link id="l05869" /><CodeLine lineNumber="5869"><span class="doxyHighlightComment">/// to be expanded in multiple places.</span></CodeLine>
<Link id="l05870" /><CodeLine lineNumber="5870"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::RewriteForPHI(<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU,</span></CodeLine>
<Link id="l05871" /><CodeLine lineNumber="5871"><span class="doxyHighlight">                                </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRFixup &amp;LF, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l05872" /><CodeLine lineNumber="5872"><span class="doxyHighlight">                                <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts) &#123;</span></CodeLine>
<Link id="l05873" /><CodeLine lineNumber="5873"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;BasicBlock &#42;, Value &#42;&gt;</a> <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a>;</span></CodeLine>
<Link id="l05874" /><CodeLine lineNumber="5874"></CodeLine>
<Link id="l05875" /><CodeLine lineNumber="5875"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = PN-&gt;<a href="/docs/api/classes/llvm/phinode/#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>(); i != e; ++i)</span></CodeLine>
<Link id="l05876" /><CodeLine lineNumber="5876"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PN-&gt;<a href="/docs/api/classes/llvm/phinode/#aca1fd00f3ab63ec8f0f1ccc2093a9f6d">getIncomingValue</a>(i) == LF.OperandValToReplace) &#123;</span></CodeLine>
<Link id="l05877" /><CodeLine lineNumber="5877"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> needUpdateFixups = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05878" /><CodeLine lineNumber="5878"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;BB = PN-&gt;<a href="/docs/api/classes/llvm/phinode/#ac53e1aabdf64e91b8b325bcac250d8a9">getIncomingBlock</a>(i);</span></CodeLine>
<Link id="l05879" /><CodeLine lineNumber="5879"></CodeLine>
<Link id="l05880" /><CodeLine lineNumber="5880"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If this is a critical edge, split the edge so that we do not insert</span></CodeLine>
<Link id="l05881" /><CodeLine lineNumber="5881"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// the code on all predecessor/successor paths.  We do this unless this</span></CodeLine>
<Link id="l05882" /><CodeLine lineNumber="5882"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// is the canonical backedge for this loop, which complicates post-inc</span></CodeLine>
<Link id="l05883" /><CodeLine lineNumber="5883"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// users.</span></CodeLine>
<Link id="l05884" /><CodeLine lineNumber="5884"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (e != 1 &amp;&amp; BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/instruction/#a3287172f2d13af086e6d66364e8c6de3">getNumSuccessors</a>() &gt; 1 &amp;&amp;</span></CodeLine>
<Link id="l05885" /><CodeLine lineNumber="5885"><span class="doxyHighlight">          !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;IndirectBrInst&gt;</a>(BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()) &amp;&amp;</span></CodeLine>
<Link id="l05886" /><CodeLine lineNumber="5886"><span class="doxyHighlight">          !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>())) &#123;</span></CodeLine>
<Link id="l05887" /><CodeLine lineNumber="5887"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;Parent = PN-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>();</span></CodeLine>
<Link id="l05888" /><CodeLine lineNumber="5888"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;PNLoop = LI.getLoopFor(Parent);</span></CodeLine>
<Link id="l05889" /><CodeLine lineNumber="5889"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!PNLoop || Parent != PNLoop-&gt;<a href="/docs/api/classes/llvm/loopbase/#a4a75755081e9a3803d2f4ccf6f0cb1f8">getHeader</a>()) &#123;</span></CodeLine>
<Link id="l05890" /><CodeLine lineNumber="5890"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Split the critical edge.</span></CodeLine>
<Link id="l05891" /><CodeLine lineNumber="5891"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;NewBB = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05892" /><CodeLine lineNumber="5892"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Parent-&gt;<a href="/docs/api/classes/llvm/basicblock/#ac3a2a666b5703b8c9bda318ef18c731c">isLandingPad</a>()) &#123;</span></CodeLine>
<Link id="l05893" /><CodeLine lineNumber="5893"><span class="doxyHighlight">            NewBB =</span></CodeLine>
<Link id="l05894" /><CodeLine lineNumber="5894"><span class="doxyHighlight">                <a href="/docs/api/namespaces/llvm/#ab61955a622d233750894890e0704da5c">SplitCriticalEdge</a>(BB, Parent,</span></CodeLine>
<Link id="l05895" /><CodeLine lineNumber="5895"><span class="doxyHighlight">                                  <a href="/docs/api/structs/llvm/criticaledgesplittingoptions">CriticalEdgeSplittingOptions</a>(&amp;DT, &amp;LI, MSSAU)</span></CodeLine>
<Link id="l05896" /><CodeLine lineNumber="5896"><span class="doxyHighlight">                                      .setMergeIdenticalEdges()</span></CodeLine>
<Link id="l05897" /><CodeLine lineNumber="5897"><span class="doxyHighlight">                                      .setKeepOneInputPHIs());</span></CodeLine>
<Link id="l05898" /><CodeLine lineNumber="5898"><span class="doxyHighlight">          &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05899" /><CodeLine lineNumber="5899"><span class="doxyHighlight">            <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;BasicBlock&#42;, 2&gt;</a> NewBBs;</span></CodeLine>
<Link id="l05900" /><CodeLine lineNumber="5900"><span class="doxyHighlight">            <a href="/docs/api/classes/llvm/domtreeupdater">DomTreeUpdater</a> DTU(DT, DomTreeUpdater::UpdateStrategy::Eager);</span></CodeLine>
<Link id="l05901" /><CodeLine lineNumber="5901"><span class="doxyHighlight">            <a href="/docs/api/namespaces/llvm/#a949b0428c89b8ccf62d469bd325244ed">SplitLandingPadPredecessors</a>(Parent, BB, </span><span class="doxyHighlightStringLiteral">&quot;&quot;</span><span class="doxyHighlight">, </span><span class="doxyHighlightStringLiteral">&quot;&quot;</span><span class="doxyHighlight">, NewBBs, &amp;DTU, &amp;LI);</span></CodeLine>
<Link id="l05902" /><CodeLine lineNumber="5902"><span class="doxyHighlight">            NewBB = NewBBs&#91;0&#93;;</span></CodeLine>
<Link id="l05903" /><CodeLine lineNumber="5903"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l05904" /><CodeLine lineNumber="5904"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// If NewBB==NULL, then SplitCriticalEdge refused to split because all</span></CodeLine>
<Link id="l05905" /><CodeLine lineNumber="5905"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// phi predecessors are identical. The simple thing to do is skip</span></CodeLine>
<Link id="l05906" /><CodeLine lineNumber="5906"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// splitting in this case rather than complicate the API.</span></CodeLine>
<Link id="l05907" /><CodeLine lineNumber="5907"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewBB) &#123;</span></CodeLine>
<Link id="l05908" /><CodeLine lineNumber="5908"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// If PN is outside of the loop and BB is in the loop, we want to</span></CodeLine>
<Link id="l05909" /><CodeLine lineNumber="5909"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// move the block to be immediately before the PHI block, not</span></CodeLine>
<Link id="l05910" /><CodeLine lineNumber="5910"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// immediately after BB.</span></CodeLine>
<Link id="l05911" /><CodeLine lineNumber="5911"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(BB) &amp;&amp; !<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(PN))</span></CodeLine>
<Link id="l05912" /><CodeLine lineNumber="5912"><span class="doxyHighlight">              NewBB-&gt;<a href="/docs/api/classes/llvm/basicblock/#ac1fd6437bbfce263b87f01767d950ce5">moveBefore</a>(PN-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>());</span></CodeLine>
<Link id="l05913" /><CodeLine lineNumber="5913"></CodeLine>
<Link id="l05914" /><CodeLine lineNumber="5914"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// Splitting the edge can reduce the number of PHI entries we have.</span></CodeLine>
<Link id="l05915" /><CodeLine lineNumber="5915"><span class="doxyHighlight">            <a href="/docs/api/namespaces/llvm/numbers/#a92f4283d4e0e2ea1776894b3ae93640f">e</a> = PN-&gt;<a href="/docs/api/classes/llvm/phinode/#aef51af4b490af6b3bf2dfbc8737a8f9f">getNumIncomingValues</a>();</span></CodeLine>
<Link id="l05916" /><CodeLine lineNumber="5916"><span class="doxyHighlight">            BB = NewBB;</span></CodeLine>
<Link id="l05917" /><CodeLine lineNumber="5917"><span class="doxyHighlight">            i = PN-&gt;<a href="/docs/api/classes/llvm/phinode/#ae9562b96f6f3fa41bd36538c080035ee">getBasicBlockIndex</a>(BB);</span></CodeLine>
<Link id="l05918" /><CodeLine lineNumber="5918"></CodeLine>
<Link id="l05919" /><CodeLine lineNumber="5919"><span class="doxyHighlight">            needUpdateFixups = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05920" /><CodeLine lineNumber="5920"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l05921" /><CodeLine lineNumber="5921"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l05922" /><CodeLine lineNumber="5922"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05923" /><CodeLine lineNumber="5923"></CodeLine>
<Link id="l05924" /><CodeLine lineNumber="5924"><span class="doxyHighlight">      std::pair&lt;DenseMap&lt;BasicBlock &#42;, Value &#42;&gt;::iterator, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight">&gt; Pair =</span></CodeLine>
<Link id="l05925" /><CodeLine lineNumber="5925"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a>.insert(std::make&#95;pair(BB, </span><span class="doxyHighlightKeyword">static&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/value">Value</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">)));</span></CodeLine>
<Link id="l05926" /><CodeLine lineNumber="5926"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Pair.second)</span></CodeLine>
<Link id="l05927" /><CodeLine lineNumber="5927"><span class="doxyHighlight">        PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(i, Pair.first-&gt;second);</span></CodeLine>
<Link id="l05928" /><CodeLine lineNumber="5928"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l05929" /><CodeLine lineNumber="5929"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV =</span></CodeLine>
<Link id="l05930" /><CodeLine lineNumber="5930"><span class="doxyHighlight">            Expand(LU, LF, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>(), DeadInsts);</span></CodeLine>
<Link id="l05931" /><CodeLine lineNumber="5931"></CodeLine>
<Link id="l05932" /><CodeLine lineNumber="5932"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If this is reuse-by-noop-cast, insert the noop cast.</span></CodeLine>
<Link id="l05933" /><CodeLine lineNumber="5933"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/type">Type</a> &#42;OpTy = LF.OperandValToReplace-&gt;getType();</span></CodeLine>
<Link id="l05934" /><CodeLine lineNumber="5934"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FullV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != OpTy)</span></CodeLine>
<Link id="l05935" /><CodeLine lineNumber="5935"><span class="doxyHighlight">          FullV = <a href="/docs/api/classes/llvm/castinst/#ad2e0ab6d7096fe67a2216fe349044387">CastInst::Create</a>(</span></CodeLine>
<Link id="l05936" /><CodeLine lineNumber="5936"><span class="doxyHighlight">              <a href="/docs/api/classes/llvm/castinst/#a06dc25da1f16f389f5244304e8d33127">CastInst::getCastOpcode</a>(FullV, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, OpTy, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">), FullV,</span></CodeLine>
<Link id="l05937" /><CodeLine lineNumber="5937"><span class="doxyHighlight">              LF.OperandValToReplace-&gt;getType(), </span><span class="doxyHighlightStringLiteral">&quot;tmp&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l05938" /><CodeLine lineNumber="5938"><span class="doxyHighlight">              BB-&gt;<a href="/docs/api/classes/llvm/basicblock/#aef9e9fcf4c5dfce90276ca16d91b8e46">getTerminator</a>()-&gt;<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>());</span></CodeLine>
<Link id="l05939" /><CodeLine lineNumber="5939"></CodeLine>
<Link id="l05940" /><CodeLine lineNumber="5940"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If the incoming block for this value is not in the loop, it means the</span></CodeLine>
<Link id="l05941" /><CodeLine lineNumber="5941"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// current PHI is not in a loop exit, so we must create a LCSSA PHI for</span></CodeLine>
<Link id="l05942" /><CodeLine lineNumber="5942"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// the inserted value.</span></CodeLine>
<Link id="l05943" /><CodeLine lineNumber="5943"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(FullV))</span></CodeLine>
<Link id="l05944" /><CodeLine lineNumber="5944"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; !<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;contains(BB))</span></CodeLine>
<Link id="l05945" /><CodeLine lineNumber="5945"><span class="doxyHighlight">            InsertedNonLCSSAInsts.insert(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l05946" /><CodeLine lineNumber="5946"></CodeLine>
<Link id="l05947" /><CodeLine lineNumber="5947"><span class="doxyHighlight">        PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a88cdefb709309eddc6e5daca0be6a7b4">setIncomingValue</a>(i, FullV);</span></CodeLine>
<Link id="l05948" /><CodeLine lineNumber="5948"><span class="doxyHighlight">        Pair.first-&gt;second = FullV;</span></CodeLine>
<Link id="l05949" /><CodeLine lineNumber="5949"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05950" /><CodeLine lineNumber="5950"></CodeLine>
<Link id="l05951" /><CodeLine lineNumber="5951"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If LSR splits critical edge and phi node has other pending</span></CodeLine>
<Link id="l05952" /><CodeLine lineNumber="5952"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// fixup operands, we need to update those pending fixups. Otherwise</span></CodeLine>
<Link id="l05953" /><CodeLine lineNumber="5953"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// formulae will not be implemented completely and some instructions</span></CodeLine>
<Link id="l05954" /><CodeLine lineNumber="5954"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// will not be eliminated.</span></CodeLine>
<Link id="l05955" /><CodeLine lineNumber="5955"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (needUpdateFixups) &#123;</span></CodeLine>
<Link id="l05956" /><CodeLine lineNumber="5956"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (LSRUse &amp;LU : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>)</span></CodeLine>
<Link id="l05957" /><CodeLine lineNumber="5957"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : LU.Fixups)</span></CodeLine>
<Link id="l05958" /><CodeLine lineNumber="5958"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// If fixup is supposed to rewrite some operand in the phi</span></CodeLine>
<Link id="l05959" /><CodeLine lineNumber="5959"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// that was just updated, it may be already moved to</span></CodeLine>
<Link id="l05960" /><CodeLine lineNumber="5960"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// another phi node. Such fixup requires update.</span></CodeLine>
<Link id="l05961" /><CodeLine lineNumber="5961"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst == PN) &#123;</span></CodeLine>
<Link id="l05962" /><CodeLine lineNumber="5962"><span class="doxyHighlight">              </span><span class="doxyHighlightComment">// Check if the operand we try to replace still exists in the</span></CodeLine>
<Link id="l05963" /><CodeLine lineNumber="5963"><span class="doxyHighlight">              </span><span class="doxyHighlightComment">// original phi.</span></CodeLine>
<Link id="l05964" /><CodeLine lineNumber="5964"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> foundInOriginalPHI = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05965" /><CodeLine lineNumber="5965"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;val : PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a1f0ff79b64a40d383b891f1baba89c6b">incoming&#95;values</a>())</span></CodeLine>
<Link id="l05966" /><CodeLine lineNumber="5966"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (val == <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.OperandValToReplace) &#123;</span></CodeLine>
<Link id="l05967" /><CodeLine lineNumber="5967"><span class="doxyHighlight">                  foundInOriginalPHI = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05968" /><CodeLine lineNumber="5968"><span class="doxyHighlight">                  </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05969" /><CodeLine lineNumber="5969"><span class="doxyHighlight">                &#125;</span></CodeLine>
<Link id="l05970" /><CodeLine lineNumber="5970"></CodeLine>
<Link id="l05971" /><CodeLine lineNumber="5971"><span class="doxyHighlight">              </span><span class="doxyHighlightComment">// If fixup operand found in original PHI - nothing to do.</span></CodeLine>
<Link id="l05972" /><CodeLine lineNumber="5972"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (foundInOriginalPHI)</span></CodeLine>
<Link id="l05973" /><CodeLine lineNumber="5973"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l05974" /><CodeLine lineNumber="5974"></CodeLine>
<Link id="l05975" /><CodeLine lineNumber="5975"><span class="doxyHighlight">              </span><span class="doxyHighlightComment">// Otherwise it might be moved to another PHI and requires update.</span></CodeLine>
<Link id="l05976" /><CodeLine lineNumber="5976"><span class="doxyHighlight">              </span><span class="doxyHighlightComment">// If fixup operand not found in any of the incoming blocks that</span></CodeLine>
<Link id="l05977" /><CodeLine lineNumber="5977"><span class="doxyHighlight">              </span><span class="doxyHighlightComment">// means we have already rewritten it - nothing to do.</span></CodeLine>
<Link id="l05978" /><CodeLine lineNumber="5978"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> : PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a14cf6d7a36d091cb666cb83221b81d72">blocks</a>())</span></CodeLine>
<Link id="l05979" /><CodeLine lineNumber="5979"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/basicblock/#a98c0a84a5dfa8bce341c829709f171e5">BasicBlock::iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>-&gt;begin(); <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;PHINode&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l05980" /><CodeLine lineNumber="5980"><span class="doxyHighlight">                     ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l05981" /><CodeLine lineNumber="5981"><span class="doxyHighlight">                  <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;NewPN = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l05982" /><CodeLine lineNumber="5982"><span class="doxyHighlight">                  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;val : NewPN-&gt;<a href="/docs/api/classes/llvm/phinode/#a1f0ff79b64a40d383b891f1baba89c6b">incoming&#95;values</a>())</span></CodeLine>
<Link id="l05983" /><CodeLine lineNumber="5983"><span class="doxyHighlight">                    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (val == <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.OperandValToReplace)</span></CodeLine>
<Link id="l05984" /><CodeLine lineNumber="5984"><span class="doxyHighlight">                      <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst = NewPN;</span></CodeLine>
<Link id="l05985" /><CodeLine lineNumber="5985"><span class="doxyHighlight">                &#125;</span></CodeLine>
<Link id="l05986" /><CodeLine lineNumber="5986"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l05987" /><CodeLine lineNumber="5987"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l05988" /><CodeLine lineNumber="5988"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l05989" /><CodeLine lineNumber="5989"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l05990" /><CodeLine lineNumber="5990"></CodeLine>
<Link id="l05991" /><CodeLine lineNumber="5991"><span class="doxyHighlightComment">/// Emit instructions for the leading candidate expression for this LSRUse (this</span></CodeLine>
<Link id="l05992" /><CodeLine lineNumber="5992"><span class="doxyHighlightComment">/// is called &quot;expanding&quot;), and update the UserInst to reference the newly</span></CodeLine>
<Link id="l05993" /><CodeLine lineNumber="5993"><span class="doxyHighlightComment">/// expanded value.</span></CodeLine>
<Link id="l05994" /><CodeLine lineNumber="5994"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::Rewrite(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRFixup &amp;LF,</span></CodeLine>
<Link id="l05995" /><CodeLine lineNumber="5995"><span class="doxyHighlight">                          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Formula &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>,</span></CodeLine>
<Link id="l05996" /><CodeLine lineNumber="5996"><span class="doxyHighlight">                          <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;WeakTrackingVH&gt;</a> &amp;DeadInsts) &#123;</span></CodeLine>
<Link id="l05997" /><CodeLine lineNumber="5997"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// First, find an insertion point that dominates UserInst. For PHI nodes,</span></CodeLine>
<Link id="l05998" /><CodeLine lineNumber="5998"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// find the nearest block which dominates all the relevant uses.</span></CodeLine>
<Link id="l05999" /><CodeLine lineNumber="5999"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(LF.UserInst)) &#123;</span></CodeLine>
<Link id="l06000" /><CodeLine lineNumber="6000"><span class="doxyHighlight">    RewriteForPHI(PN, LU, LF, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, DeadInsts);</span></CodeLine>
<Link id="l06001" /><CodeLine lineNumber="6001"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l06002" /><CodeLine lineNumber="6002"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;FullV = Expand(LU, LF, <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>, LF.UserInst-&gt;getIterator(), DeadInsts);</span></CodeLine>
<Link id="l06003" /><CodeLine lineNumber="6003"></CodeLine>
<Link id="l06004" /><CodeLine lineNumber="6004"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this is reuse-by-noop-cast, insert the noop cast.</span></CodeLine>
<Link id="l06005" /><CodeLine lineNumber="6005"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/type">Type</a> &#42;OpTy = LF.OperandValToReplace-&gt;getType();</span></CodeLine>
<Link id="l06006" /><CodeLine lineNumber="6006"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FullV-&gt;<a href="/docs/api/classes/llvm/value/#a0344a49526443edf90cc0aef3abd3337">getType</a>() != OpTy) &#123;</span></CodeLine>
<Link id="l06007" /><CodeLine lineNumber="6007"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;Cast =</span></CodeLine>
<Link id="l06008" /><CodeLine lineNumber="6008"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/castinst/#ad2e0ab6d7096fe67a2216fe349044387">CastInst::Create</a>(<a href="/docs/api/classes/llvm/castinst/#a06dc25da1f16f389f5244304e8d33127">CastInst::getCastOpcode</a>(FullV, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, OpTy, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l06009" /><CodeLine lineNumber="6009"><span class="doxyHighlight">                           FullV, OpTy, </span><span class="doxyHighlightStringLiteral">&quot;tmp&quot;</span><span class="doxyHighlight">, LF.UserInst-&gt;getIterator());</span></CodeLine>
<Link id="l06010" /><CodeLine lineNumber="6010"><span class="doxyHighlight">      FullV = Cast;</span></CodeLine>
<Link id="l06011" /><CodeLine lineNumber="6011"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06012" /><CodeLine lineNumber="6012"></CodeLine>
<Link id="l06013" /><CodeLine lineNumber="6013"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Update the user. ICmpZero is handled specially here (for now) because</span></CodeLine>
<Link id="l06014" /><CodeLine lineNumber="6014"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Expand may have updated one of the operands of the icmp already, and</span></CodeLine>
<Link id="l06015" /><CodeLine lineNumber="6015"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// its new value may happen to be equal to LF.OperandValToReplace, in</span></CodeLine>
<Link id="l06016" /><CodeLine lineNumber="6016"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// which case doing replaceUsesOfWith leads to replacing both operands</span></CodeLine>
<Link id="l06017" /><CodeLine lineNumber="6017"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// with the same value. TODO: Reorganize this.</span></CodeLine>
<Link id="l06018" /><CodeLine lineNumber="6018"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind == <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0aa25a0984500d71f1ab0f82f5372a4d70">LSRUse::ICmpZero</a>)</span></CodeLine>
<Link id="l06019" /><CodeLine lineNumber="6019"><span class="doxyHighlight">      LF.UserInst-&gt;setOperand(0, FullV);</span></CodeLine>
<Link id="l06020" /><CodeLine lineNumber="6020"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l06021" /><CodeLine lineNumber="6021"><span class="doxyHighlight">      LF.UserInst-&gt;replaceUsesOfWith(LF.OperandValToReplace, FullV);</span></CodeLine>
<Link id="l06022" /><CodeLine lineNumber="6022"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06023" /><CodeLine lineNumber="6023"></CodeLine>
<Link id="l06024" /><CodeLine lineNumber="6024"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;OperandIsInstr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(LF.OperandValToReplace))</span></CodeLine>
<Link id="l06025" /><CodeLine lineNumber="6025"><span class="doxyHighlight">    DeadInsts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(OperandIsInstr);</span></CodeLine>
<Link id="l06026" /><CodeLine lineNumber="6026"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06027" /><CodeLine lineNumber="6027"></CodeLine>
<Link id="l06028" /><CodeLine lineNumber="6028"><span class="doxyHighlightComment">// Trying to hoist the IVInc to loop header if all IVInc users are in</span></CodeLine>
<Link id="l06029" /><CodeLine lineNumber="6029"><span class="doxyHighlightComment">// the loop header. It will help backend to generate post index load/store</span></CodeLine>
<Link id="l06030" /><CodeLine lineNumber="6030"><span class="doxyHighlightComment">// when the latch block is different from loop header block.</span></CodeLine>
<Link id="l06031" /><CodeLine lineNumber="6031" lineLink="#aa12378426474ba414b8bc234a26fd19b"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aa12378426474ba414b8bc234a26fd19b">canHoistIVInc</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>,</span></CodeLine>
<Link id="l06032" /><CodeLine lineNumber="6032"><span class="doxyHighlight">                          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRUse &amp;LU, <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;IVIncInsertPos,</span></CodeLine>
<Link id="l06033" /><CodeLine lineNumber="6033"><span class="doxyHighlight">                          <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L) &#123;</span></CodeLine>
<Link id="l06034" /><CodeLine lineNumber="6034"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LU.Kind != <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse/#a1ba9c6c01c92aafaeb2986bdd756dcf0a83bf7174fbbec2c33ed1a665e637fd2a">LSRUse::Address</a>)</span></CodeLine>
<Link id="l06035" /><CodeLine lineNumber="6035"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06036" /><CodeLine lineNumber="6036"></CodeLine>
<Link id="l06037" /><CodeLine lineNumber="6037"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For now this code do the conservative optimization, only work for</span></CodeLine>
<Link id="l06038" /><CodeLine lineNumber="6038"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the header block. Later we can hoist the IVInc to the block post</span></CodeLine>
<Link id="l06039" /><CodeLine lineNumber="6039"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// dominate all users.</span></CodeLine>
<Link id="l06040" /><CodeLine lineNumber="6040"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;LHeader = L-&gt;getHeader();</span></CodeLine>
<Link id="l06041" /><CodeLine lineNumber="6041"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IVIncInsertPos-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() == LHeader)</span></CodeLine>
<Link id="l06042" /><CodeLine lineNumber="6042"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06043" /><CodeLine lineNumber="6043"></CodeLine>
<Link id="l06044" /><CodeLine lineNumber="6044"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.OperandValToReplace ||</span></CodeLine>
<Link id="l06045" /><CodeLine lineNumber="6045"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a61d13d6824ec46c31260a4fd0997eda0">any&#95;of</a>(<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.OperandValToReplace-&gt;users(), &#91;&amp;LHeader&#93;(<a href="/docs/api/classes/llvm/user">User</a> &#42;U) &#123;</span></CodeLine>
<Link id="l06046" /><CodeLine lineNumber="6046"><span class="doxyHighlight">        Instruction &#42;UI = cast&lt;Instruction&gt;(U);</span></CodeLine>
<Link id="l06047" /><CodeLine lineNumber="6047"><span class="doxyHighlight">        return UI-&gt;getParent() != LHeader;</span></CodeLine>
<Link id="l06048" /><CodeLine lineNumber="6048"><span class="doxyHighlight">      &#125;))</span></CodeLine>
<Link id="l06049" /><CodeLine lineNumber="6049"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06050" /><CodeLine lineNumber="6050"></CodeLine>
<Link id="l06051" /><CodeLine lineNumber="6051"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>.UserInst;</span></CodeLine>
<Link id="l06052" /><CodeLine lineNumber="6052"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;getType();</span></CodeLine>
<Link id="l06053" /><CodeLine lineNumber="6053"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Ty-&gt;isIntegerTy() &amp;&amp;</span></CodeLine>
<Link id="l06054" /><CodeLine lineNumber="6054"><span class="doxyHighlight">         ((<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;LoadInst&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedLoadLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, Ty)) ||</span></CodeLine>
<Link id="l06055" /><CodeLine lineNumber="6055"><span class="doxyHighlight">          (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;StoreInst&gt;</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &amp;&amp; <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.isIndexedStoreLegal(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>.MIM&#95;PostInc, Ty)));</span></CodeLine>
<Link id="l06056" /><CodeLine lineNumber="6056"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06057" /><CodeLine lineNumber="6057"></CodeLine>
<Link id="l06058" /><CodeLine lineNumber="6058"><span class="doxyHighlightComment">/// Rewrite all the fixup locations with new values, following the chosen</span></CodeLine>
<Link id="l06059" /><CodeLine lineNumber="6059"><span class="doxyHighlightComment">/// solution.</span></CodeLine>
<Link id="l06060" /><CodeLine lineNumber="6060"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LSRInstance::ImplementSolution(</span></CodeLine>
<Link id="l06061" /><CodeLine lineNumber="6061"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const Formula &#42;&gt;</a> &amp;Solution) &#123;</span></CodeLine>
<Link id="l06062" /><CodeLine lineNumber="6062"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Keep track of instructions we may have made dead, so that</span></CodeLine>
<Link id="l06063" /><CodeLine lineNumber="6063"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// we can remove them after we are done working.</span></CodeLine>
<Link id="l06064" /><CodeLine lineNumber="6064"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WeakTrackingVH, 16&gt;</a> DeadInsts;</span></CodeLine>
<Link id="l06065" /><CodeLine lineNumber="6065"></CodeLine>
<Link id="l06066" /><CodeLine lineNumber="6066"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Mark phi nodes that terminate chains so the expander tries to reuse them.</span></CodeLine>
<Link id="l06067" /><CodeLine lineNumber="6067"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> IVChain &amp;Chain : IVChainVec) &#123;</span></CodeLine>
<Link id="l06068" /><CodeLine lineNumber="6068"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;PN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(<a href="/docs/api/namespaces/anonymous-loadstorevectorizer-cpp-/#afd1adfcbfce320e6265935ce4d6299a3">Chain</a>.tailUserInst()))</span></CodeLine>
<Link id="l06069" /><CodeLine lineNumber="6069"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setChainedPhi(PN);</span></CodeLine>
<Link id="l06070" /><CodeLine lineNumber="6070"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06071" /><CodeLine lineNumber="6071"></CodeLine>
<Link id="l06072" /><CodeLine lineNumber="6072"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Expand the new value definitions and update the users.</span></CodeLine>
<Link id="l06073" /><CodeLine lineNumber="6073"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> LUIdx = 0, NumUses = <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>.size(); LUIdx != NumUses; ++LUIdx)</span></CodeLine>
<Link id="l06074" /><CodeLine lineNumber="6074"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRFixup &amp;<a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a> : <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;.Fixups) &#123;</span></CodeLine>
<Link id="l06075" /><CodeLine lineNumber="6075"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/instruction">Instruction</a> &#42;InsertPos =</span></CodeLine>
<Link id="l06076" /><CodeLine lineNumber="6076"><span class="doxyHighlight">          <a href="#aa12378426474ba414b8bc234a26fd19b">canHoistIVInc</a>(<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>, <a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;, IVIncInsertPos, L)</span></CodeLine>
<Link id="l06077" /><CodeLine lineNumber="6077"><span class="doxyHighlight">              ? <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getTerminator()</span></CodeLine>
<Link id="l06078" /><CodeLine lineNumber="6078"><span class="doxyHighlight">              : IVIncInsertPos;</span></CodeLine>
<Link id="l06079" /><CodeLine lineNumber="6079"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setIVIncInsertPos(L, InsertPos);</span></CodeLine>
<Link id="l06080" /><CodeLine lineNumber="6080"><span class="doxyHighlight">      Rewrite(<a href="/docs/api/files/lib/lib/codegen/removeloadsintofakeuses-cpp/#a0b427ca665b192edbeb8d6ca3c8f19fd">Uses</a>&#91;LUIdx&#93;, <a href="/docs/api/files/lib/lib/target/lib/target/powerpc/ppctlsdynamiccall-cpp/#a4a235aedca5bbfc39934045b6cbf9c70">Fixup</a>, &#42;Solution&#91;LUIdx&#93;, DeadInsts);</span></CodeLine>
<Link id="l06081" /><CodeLine lineNumber="6081"><span class="doxyHighlight">      <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06082" /><CodeLine lineNumber="6082"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06083" /><CodeLine lineNumber="6083"></CodeLine>
<Link id="l06084" /><CodeLine lineNumber="6084"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> InsertedInsts = InsertedNonLCSSAInsts.takeVector();</span></CodeLine>
<Link id="l06085" /><CodeLine lineNumber="6085"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#ac1c43bfed9a4937c8f7918ac6fb09c56">formLCSSAForInstructions</a>(InsertedInsts, DT, LI, &amp;SE);</span></CodeLine>
<Link id="l06086" /><CodeLine lineNumber="6086"></CodeLine>
<Link id="l06087" /><CodeLine lineNumber="6087"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> IVChain &amp;Chain : IVChainVec) &#123;</span></CodeLine>
<Link id="l06088" /><CodeLine lineNumber="6088"><span class="doxyHighlight">    GenerateIVChain(Chain, DeadInsts);</span></CodeLine>
<Link id="l06089" /><CodeLine lineNumber="6089"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06090" /><CodeLine lineNumber="6090"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06091" /><CodeLine lineNumber="6091"></CodeLine>
<Link id="l06092" /><CodeLine lineNumber="6092"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/weakvh">WeakVH</a> &amp;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> : <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.getInsertedIVs())</span></CodeLine>
<Link id="l06093" /><CodeLine lineNumber="6093"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> &amp;&amp; <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;Instruction&gt;</a>(&amp;&#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>)-&gt;<a href="/docs/api/files/lib/lib/analysis/basicaliasanalysis-cpp/#a1b8850f1ed44c12bc3501175a71c251c">getParent</a>())</span></CodeLine>
<Link id="l06094" /><CodeLine lineNumber="6094"><span class="doxyHighlight">      ScalarEvolutionIVs.push&#95;back(<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>);</span></CodeLine>
<Link id="l06095" /><CodeLine lineNumber="6095"></CodeLine>
<Link id="l06096" /><CodeLine lineNumber="6096"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Clean up after ourselves. This must be done before deleting any</span></CodeLine>
<Link id="l06097" /><CodeLine lineNumber="6097"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instructions.</span></CodeLine>
<Link id="l06098" /><CodeLine lineNumber="6098"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clear();</span></CodeLine>
<Link id="l06099" /><CodeLine lineNumber="6099"></CodeLine>
<Link id="l06100" /><CodeLine lineNumber="6100"><span class="doxyHighlight">  <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> |= <a href="/docs/api/namespaces/llvm/#abca8e2c525d8162fbcbb5b444cf04d21">RecursivelyDeleteTriviallyDeadInstructionsPermissive</a>(DeadInsts,</span></CodeLine>
<Link id="l06101" /><CodeLine lineNumber="6101"><span class="doxyHighlight">                                                                  &amp;TLI, MSSAU);</span></CodeLine>
<Link id="l06102" /><CodeLine lineNumber="6102"></CodeLine>
<Link id="l06103" /><CodeLine lineNumber="6103"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// In our cost analysis above, we assume that each addrec consumes exactly</span></CodeLine>
<Link id="l06104" /><CodeLine lineNumber="6104"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// one register, and arrange to have increments inserted just before the</span></CodeLine>
<Link id="l06105" /><CodeLine lineNumber="6105"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// latch to maximimize the chance this is true.  However, if we reused</span></CodeLine>
<Link id="l06106" /><CodeLine lineNumber="6106"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// existing IVs, we now need to move the increments to match our</span></CodeLine>
<Link id="l06107" /><CodeLine lineNumber="6107"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// expectations.  Otherwise, our cost modeling results in us having a</span></CodeLine>
<Link id="l06108" /><CodeLine lineNumber="6108"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// chosen a non-optimal result for the actual schedule.  (And yes, this</span></CodeLine>
<Link id="l06109" /><CodeLine lineNumber="6109"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// scheduling decision does impact later codegen.)</span></CodeLine>
<Link id="l06110" /><CodeLine lineNumber="6110"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;PN : <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;phis()) &#123;</span></CodeLine>
<Link id="l06111" /><CodeLine lineNumber="6111"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/binaryoperator">BinaryOperator</a> &#42;BO = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06112" /><CodeLine lineNumber="6112"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="/docs/api/namespaces/llvm/memprof/#abee3ddc7c6eb611a3b96fb69489c81caaa6122a65eaa676f700ae68d393054a37">Start</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, &#42;Step = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06113" /><CodeLine lineNumber="6113"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a5be4877e6cc76e0fe6f8a005c69aa7c2">matchSimpleRecurrence</a>(&amp;PN, BO, Start, Step))</span></CodeLine>
<Link id="l06114" /><CodeLine lineNumber="6114"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06115" /><CodeLine lineNumber="6115"></CodeLine>
<Link id="l06116" /><CodeLine lineNumber="6116"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (BO-&gt;<a href="/docs/api/classes/llvm/binaryoperator/#a31bf07f3f61525486633bc1d0bbaf029">getOpcode</a>()) &#123;</span></CodeLine>
<Link id="l06117" /><CodeLine lineNumber="6117"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Instruction::Sub:</span></CodeLine>
<Link id="l06118" /><CodeLine lineNumber="6118"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BO-&gt;<a href="/docs/api/classes/llvm/user/#aa0a2cb1582d1cec317bd205085469ca1">getOperand</a>(0) != &amp;PN)</span></CodeLine>
<Link id="l06119" /><CodeLine lineNumber="6119"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// sub is non-commutative - match handling elsewhere in LSR</span></CodeLine>
<Link id="l06120" /><CodeLine lineNumber="6120"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06121" /><CodeLine lineNumber="6121"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06122" /><CodeLine lineNumber="6122"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> Instruction::Add:</span></CodeLine>
<Link id="l06123" /><CodeLine lineNumber="6123"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06124" /><CodeLine lineNumber="6124"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l06125" /><CodeLine lineNumber="6125"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06126" /><CodeLine lineNumber="6126"><span class="doxyHighlight">    &#125;;</span></CodeLine>
<Link id="l06127" /><CodeLine lineNumber="6127"></CodeLine>
<Link id="l06128" /><CodeLine lineNumber="6128"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;Constant&gt;</a>(Step))</span></CodeLine>
<Link id="l06129" /><CodeLine lineNumber="6129"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If not a constant step, might increase register pressure</span></CodeLine>
<Link id="l06130" /><CodeLine lineNumber="6130"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// (We assume constants have been canonicalized to RHS)</span></CodeLine>
<Link id="l06131" /><CodeLine lineNumber="6131"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06132" /><CodeLine lineNumber="6132"></CodeLine>
<Link id="l06133" /><CodeLine lineNumber="6133"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BO-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>() == IVIncInsertPos-&gt;getParent())</span></CodeLine>
<Link id="l06134" /><CodeLine lineNumber="6134"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Only bother moving across blocks.  Isel can handle block local case.</span></CodeLine>
<Link id="l06135" /><CodeLine lineNumber="6135"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06136" /><CodeLine lineNumber="6136"></CodeLine>
<Link id="l06137" /><CodeLine lineNumber="6137"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Can we legally schedule inc at the desired point?</span></CodeLine>
<Link id="l06138" /><CodeLine lineNumber="6138"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a0d10fe510ced2849a8074fe81e5d04ce">llvm::all&#95;of</a>(BO-&gt;<a href="/docs/api/classes/llvm/value/#abf855b7cd63a0cd7f73759e396f280c9">uses</a>(),</span></CodeLine>
<Link id="l06139" /><CodeLine lineNumber="6139"><span class="doxyHighlight">                      &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/use">Use</a> &amp;U) &#123;return DT.dominates(IVIncInsertPos, U);&#125;))</span></CodeLine>
<Link id="l06140" /><CodeLine lineNumber="6140"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06141" /><CodeLine lineNumber="6141"><span class="doxyHighlight">    BO-&gt;<a href="/docs/api/classes/llvm/instruction/#af67d1f3a518964d80a109bb3d9d5cf1e">moveBefore</a>(IVIncInsertPos-&gt;getIterator());</span></CodeLine>
<Link id="l06142" /><CodeLine lineNumber="6142"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06143" /><CodeLine lineNumber="6143"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06144" /><CodeLine lineNumber="6144"></CodeLine>
<Link id="l06145" /><CodeLine lineNumber="6145"></CodeLine>
<Link id="l06146" /><CodeLine lineNumber="6146"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06147" /><CodeLine lineNumber="6147"></CodeLine>
<Link id="l06148" /><CodeLine lineNumber="6148" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a9bcf42be7435217d79cd175d4e6993d7"><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a9bcf42be7435217d79cd175d4e6993d7">LSRInstance::LSRInstance</a>(<a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp;IU, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</span></CodeLine>
<Link id="l06149" /><CodeLine lineNumber="6149"><span class="doxyHighlight">                         <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;DT, <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI,</span></CodeLine>
<Link id="l06150" /><CodeLine lineNumber="6150"><span class="doxyHighlight">                         </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;TTI, <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;AC,</span></CodeLine>
<Link id="l06151" /><CodeLine lineNumber="6151"><span class="doxyHighlight">                         <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp;TLI, <a href="/docs/api/classes/llvm/memoryssaupdater">MemorySSAUpdater</a> &#42;MSSAU)</span></CodeLine>
<Link id="l06152" /><CodeLine lineNumber="6152"><span class="doxyHighlight">    : IU(IU), SE(SE), DT(DT), LI(LI), AC(AC), TLI(TLI), TTI(TTI), L(L),</span></CodeLine>
<Link id="l06153" /><CodeLine lineNumber="6153"><span class="doxyHighlight">      MSSAU(MSSAU), AMK(<a href="#a5ecada6efd95584778cb27661747d9ba">PreferredAddresingMode</a>.getNumOccurrences() &gt; 0</span></CodeLine>
<Link id="l06154" /><CodeLine lineNumber="6154"><span class="doxyHighlight">                            ? <a href="#a5ecada6efd95584778cb27661747d9ba">PreferredAddresingMode</a></span></CodeLine>
<Link id="l06155" /><CodeLine lineNumber="6155"><span class="doxyHighlight">                            : TTI.getPreferredAddressingMode(L, &amp;SE)),</span></CodeLine>
<Link id="l06156" /><CodeLine lineNumber="6156"><span class="doxyHighlight">      Rewriter(SE, L-&gt;getHeader()-&gt;getDataLayout(), </span><span class="doxyHighlightStringLiteral">&quot;lsr&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/false">false</a>),</span></CodeLine>
<Link id="l06157" /><CodeLine lineNumber="6157"><span class="doxyHighlight">      BaselineCost(L, SE, TTI, AMK) &#123;</span></CodeLine>
<Link id="l06158" /><CodeLine lineNumber="6158"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If LoopSimplify form is not available, stay out of trouble.</span></CodeLine>
<Link id="l06159" /><CodeLine lineNumber="6159"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!L-&gt;isLoopSimplifyForm())</span></CodeLine>
<Link id="l06160" /><CodeLine lineNumber="6160"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06161" /><CodeLine lineNumber="6161"></CodeLine>
<Link id="l06162" /><CodeLine lineNumber="6162"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there&#39;s no interesting work to be done, bail early.</span></CodeLine>
<Link id="l06163" /><CodeLine lineNumber="6163"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#acdfbcf188e2d4a80837e89de2ccdffab">if</a> (IU.empty()) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06164" /><CodeLine lineNumber="6164"></CodeLine>
<Link id="l06165" /><CodeLine lineNumber="6165"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there&#39;s too much analysis to be done, bail early. We won&#39;t be able to</span></CodeLine>
<Link id="l06166" /><CodeLine lineNumber="6166"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// model the problem anyway.</span></CodeLine>
<Link id="l06167" /><CodeLine lineNumber="6167"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumUsers = 0;</span></CodeLine>
<Link id="l06168" /><CodeLine lineNumber="6168"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a4cfc8b177e8521a4b496ae2edff6244f">for</a> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ivstrideuse">IVStrideUse</a> &amp;U : IU) &#123;</span></CodeLine>
<Link id="l06169" /><CodeLine lineNumber="6169"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (++NumUsers &gt; <a href="#a73b3c5e7c72bf97886e2ed1f12e28d54">MaxIVUsers</a>) &#123;</span></CodeLine>
<Link id="l06170" /><CodeLine lineNumber="6170"><span class="doxyHighlight">      (void)U;</span></CodeLine>
<Link id="l06171" /><CodeLine lineNumber="6171"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;LSR skipping loop, too many IV Users in &quot;</span><span class="doxyHighlight"> &lt;&lt; U</span></CodeLine>
<Link id="l06172" /><CodeLine lineNumber="6172"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06173" /><CodeLine lineNumber="6173"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06174" /><CodeLine lineNumber="6174"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06175" /><CodeLine lineNumber="6175"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Bail out if we have a PHI on an EHPad that gets a value from a</span></CodeLine>
<Link id="l06176" /><CodeLine lineNumber="6176"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// CatchSwitchInst.  Because the CatchSwitchInst cannot be split, there is</span></CodeLine>
<Link id="l06177" /><CodeLine lineNumber="6177"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// no good place to stick any instructions.</span></CodeLine>
<Link id="l06178" /><CodeLine lineNumber="6178"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;PN = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;PHINode&gt;</a>(U.getUser())) &#123;</span></CodeLine>
<Link id="l06179" /><CodeLine lineNumber="6179"><span class="doxyHighlight">       </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> FirstNonPHI = PN-&gt;<a href="/docs/api/classes/llvm/ilist-detail/node-parent-access/#a7e19e7508415378ad9523e0339b23e22">getParent</a>()-&gt;getFirstNonPHIIt();</span></CodeLine>
<Link id="l06180" /><CodeLine lineNumber="6180"><span class="doxyHighlight">       </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;FuncletPadInst&gt;</a>(FirstNonPHI) ||</span></CodeLine>
<Link id="l06181" /><CodeLine lineNumber="6181"><span class="doxyHighlight">           <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(FirstNonPHI))</span></CodeLine>
<Link id="l06182" /><CodeLine lineNumber="6182"><span class="doxyHighlight">         </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/basicblock">BasicBlock</a> &#42;PredBB : PN-&gt;<a href="/docs/api/classes/llvm/phinode/#a14cf6d7a36d091cb666cb83221b81d72">blocks</a>())</span></CodeLine>
<Link id="l06183" /><CodeLine lineNumber="6183"><span class="doxyHighlight">           </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;CatchSwitchInst&gt;</a>(PredBB-&gt;getFirstNonPHIIt()))</span></CodeLine>
<Link id="l06184" /><CodeLine lineNumber="6184"><span class="doxyHighlight">             </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06185" /><CodeLine lineNumber="6185"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06186" /><CodeLine lineNumber="6186"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06187" /><CodeLine lineNumber="6187"></CodeLine>
<Link id="l06188" /><CodeLine lineNumber="6188"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\nLSR on loop &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06189" /><CodeLine lineNumber="6189"><span class="doxyHighlight">             L-&gt;getHeader()-&gt;printAsOperand(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>(), </span><span class="doxyHighlightComment">/&#42;PrintType=&#42;/</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06190" /><CodeLine lineNumber="6190"><span class="doxyHighlight">             <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;:\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06191" /><CodeLine lineNumber="6191"></CodeLine>
<Link id="l06192" /><CodeLine lineNumber="6192"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Configure SCEVExpander already now, so the correct mode is used for</span></CodeLine>
<Link id="l06193" /><CodeLine lineNumber="6193"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// isSafeToExpand() checks.</span></CodeLine>
<Link id="l06194" /><CodeLine lineNumber="6194"><span class="doxyHighlightPreprocessor">#if LLVM&#95;ENABLE&#95;ABI&#95;BREAKING&#95;CHECKS</span></CodeLine>
<Link id="l06195" /><CodeLine lineNumber="6195"><span class="doxyHighlight">  Rewriter.setDebugType(<a href="/docs/api/files/include/include/llvm/include/llvm/adt/genericcycleimpl-h/#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>);</span></CodeLine>
<Link id="l06196" /><CodeLine lineNumber="6196"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l06197" /><CodeLine lineNumber="6197"><span class="doxyHighlight">  Rewriter.disableCanonicalMode();</span></CodeLine>
<Link id="l06198" /><CodeLine lineNumber="6198"><span class="doxyHighlight">  Rewriter.enableLSRMode();</span></CodeLine>
<Link id="l06199" /><CodeLine lineNumber="6199"></CodeLine>
<Link id="l06200" /><CodeLine lineNumber="6200"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// First, perform some low-level loop optimizations.</span></CodeLine>
<Link id="l06201" /><CodeLine lineNumber="6201"><span class="doxyHighlight">  OptimizeShadowIV();</span></CodeLine>
<Link id="l06202" /><CodeLine lineNumber="6202"><span class="doxyHighlight">  OptimizeLoopTermCond();</span></CodeLine>
<Link id="l06203" /><CodeLine lineNumber="6203"></CodeLine>
<Link id="l06204" /><CodeLine lineNumber="6204"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If loop preparation eliminates all interesting IV users, bail.</span></CodeLine>
<Link id="l06205" /><CodeLine lineNumber="6205"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IU.empty()) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06206" /><CodeLine lineNumber="6206"></CodeLine>
<Link id="l06207" /><CodeLine lineNumber="6207"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Skip nested loops until we can model them better with formulae.</span></CodeLine>
<Link id="l06208" /><CodeLine lineNumber="6208"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!L-&gt;isInnermost()) &#123;</span></CodeLine>
<Link id="l06209" /><CodeLine lineNumber="6209"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;LSR skipping outer loop &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;L &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06210" /><CodeLine lineNumber="6210"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06211" /><CodeLine lineNumber="6211"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06212" /><CodeLine lineNumber="6212"></CodeLine>
<Link id="l06213" /><CodeLine lineNumber="6213"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Start collecting data and preparing for the solver.</span></CodeLine>
<Link id="l06214" /><CodeLine lineNumber="6214"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If number of registers is not the major cost, we cannot benefit from the</span></CodeLine>
<Link id="l06215" /><CodeLine lineNumber="6215"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// current profitable chain optimization which is based on number of</span></CodeLine>
<Link id="l06216" /><CodeLine lineNumber="6216"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// registers.</span></CodeLine>
<Link id="l06217" /><CodeLine lineNumber="6217"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// FIXME: add profitable chain optimization for other kinds major cost, for</span></CodeLine>
<Link id="l06218" /><CodeLine lineNumber="6218"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// example number of instructions.</span></CodeLine>
<Link id="l06219" /><CodeLine lineNumber="6219"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TTI.isNumRegsMajorCostOfLSR() || <a href="#a3dbd582073ac67026ef5be72da94d4a3">StressIVChain</a>)</span></CodeLine>
<Link id="l06220" /><CodeLine lineNumber="6220"><span class="doxyHighlight">    CollectChains();</span></CodeLine>
<Link id="l06221" /><CodeLine lineNumber="6221"><span class="doxyHighlight">  CollectInterestingTypesAndFactors();</span></CodeLine>
<Link id="l06222" /><CodeLine lineNumber="6222"><span class="doxyHighlight">  CollectFixupsAndInitialFormulae();</span></CodeLine>
<Link id="l06223" /><CodeLine lineNumber="6223"><span class="doxyHighlight">  CollectLoopInvariantFixupsAndFormulae();</span></CodeLine>
<Link id="l06224" /><CodeLine lineNumber="6224"></CodeLine>
<Link id="l06225" /><CodeLine lineNumber="6225"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Uses.empty())</span></CodeLine>
<Link id="l06226" /><CodeLine lineNumber="6226"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06227" /><CodeLine lineNumber="6227"></CodeLine>
<Link id="l06228" /><CodeLine lineNumber="6228"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;LSR found &quot;</span><span class="doxyHighlight"> &lt;&lt; Uses.size() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; uses:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06229" /><CodeLine lineNumber="6229"><span class="doxyHighlight">             <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a0d604d6453ff8ad118da3e2cadc04c66">print&#95;uses</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()));</span></CodeLine>
<Link id="l06230" /><CodeLine lineNumber="6230"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;The baseline solution requires &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06231" /><CodeLine lineNumber="6231"><span class="doxyHighlight">             BaselineCost.print(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()); <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06232" /><CodeLine lineNumber="6232"></CodeLine>
<Link id="l06233" /><CodeLine lineNumber="6233"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now use the reuse data to generate a bunch of interesting ways</span></CodeLine>
<Link id="l06234" /><CodeLine lineNumber="6234"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to formulate the values needed for the uses.</span></CodeLine>
<Link id="l06235" /><CodeLine lineNumber="6235"><span class="doxyHighlight">  GenerateAllReuseFormulae();</span></CodeLine>
<Link id="l06236" /><CodeLine lineNumber="6236"></CodeLine>
<Link id="l06237" /><CodeLine lineNumber="6237"><span class="doxyHighlight">  FilterOutUndesirableDedicatedRegisters();</span></CodeLine>
<Link id="l06238" /><CodeLine lineNumber="6238"><span class="doxyHighlight">  NarrowSearchSpaceUsingHeuristics();</span></CodeLine>
<Link id="l06239" /><CodeLine lineNumber="6239"></CodeLine>
<Link id="l06240" /><CodeLine lineNumber="6240"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const Formula &#42;, 8&gt;</a> Solution;</span></CodeLine>
<Link id="l06241" /><CodeLine lineNumber="6241"><span class="doxyHighlight">  Solve(Solution);</span></CodeLine>
<Link id="l06242" /><CodeLine lineNumber="6242"></CodeLine>
<Link id="l06243" /><CodeLine lineNumber="6243"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Release memory that is no longer needed.</span></CodeLine>
<Link id="l06244" /><CodeLine lineNumber="6244"><span class="doxyHighlight">  Factors.clear();</span></CodeLine>
<Link id="l06245" /><CodeLine lineNumber="6245"><span class="doxyHighlight">  Types.clear();</span></CodeLine>
<Link id="l06246" /><CodeLine lineNumber="6246"><span class="doxyHighlight">  RegUses.clear();</span></CodeLine>
<Link id="l06247" /><CodeLine lineNumber="6247"></CodeLine>
<Link id="l06248" /><CodeLine lineNumber="6248"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Solution.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</span></CodeLine>
<Link id="l06249" /><CodeLine lineNumber="6249"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06250" /><CodeLine lineNumber="6250"></CodeLine>
<Link id="l06251" /><CodeLine lineNumber="6251"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l06252" /><CodeLine lineNumber="6252"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Formulae should be legal.</span></CodeLine>
<Link id="l06253" /><CodeLine lineNumber="6253"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU : Uses) &#123;</span></CodeLine>
<Link id="l06254" /><CodeLine lineNumber="6254"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae)</span></CodeLine>
<Link id="l06255" /><CodeLine lineNumber="6255"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a2e520a15f4578a464f9caaac2f4758ae">isLegalUse</a>(TTI, LU.MinOffset, LU.MaxOffset, LU.Kind, LU.AccessTy,</span></CodeLine>
<Link id="l06256" /><CodeLine lineNumber="6256"><span class="doxyHighlight">                        <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Illegal formula generated!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06257" /><CodeLine lineNumber="6257"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l06258" /><CodeLine lineNumber="6258"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l06259" /><CodeLine lineNumber="6259"></CodeLine>
<Link id="l06260" /><CodeLine lineNumber="6260"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now that we&#39;ve decided what we want, make it so.</span></CodeLine>
<Link id="l06261" /><CodeLine lineNumber="6261"><span class="doxyHighlight">  ImplementSolution(Solution);</span></CodeLine>
<Link id="l06262" /><CodeLine lineNumber="6262"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06263" /><CodeLine lineNumber="6263"></CodeLine>
<Link id="l06264" /><CodeLine lineNumber="6264"><span class="doxyHighlightPreprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</span></CodeLine>
<Link id="l06265" /><CodeLine lineNumber="6265" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#af93b911868eadea967fc026ed208698d"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#af93b911868eadea967fc026ed208698d">LSRInstance::print&#95;factors&#95;and&#95;types</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l06266" /><CodeLine lineNumber="6266"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Factors.empty() &amp;&amp; Types.empty()) </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06267" /><CodeLine lineNumber="6267"></CodeLine>
<Link id="l06268" /><CodeLine lineNumber="6268"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;LSR has identified the following interesting factors and types: &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06269" /><CodeLine lineNumber="6269"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06270" /><CodeLine lineNumber="6270"></CodeLine>
<Link id="l06271" /><CodeLine lineNumber="6271"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (int64&#95;t Factor : Factors) &#123;</span></CodeLine>
<Link id="l06272" /><CodeLine lineNumber="6272"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06273" /><CodeLine lineNumber="6273"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06274" /><CodeLine lineNumber="6274"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;&#42;&#39;</span><span class="doxyHighlight"> &lt;&lt; Factor;</span></CodeLine>
<Link id="l06275" /><CodeLine lineNumber="6275"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06276" /><CodeLine lineNumber="6276"></CodeLine>
<Link id="l06277" /><CodeLine lineNumber="6277"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/type">Type</a> &#42;Ty : Types) &#123;</span></CodeLine>
<Link id="l06278" /><CodeLine lineNumber="6278"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a>) OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06279" /><CodeLine lineNumber="6279"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa7fb55ed0b7a30342ba6da306428cae04">First</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06280" /><CodeLine lineNumber="6280"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;(&#39;</span><span class="doxyHighlight"> &lt;&lt; &#42;Ty &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;)&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06281" /><CodeLine lineNumber="6281"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06282" /><CodeLine lineNumber="6282"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06283" /><CodeLine lineNumber="6283"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06284" /><CodeLine lineNumber="6284"></CodeLine>
<Link id="l06285" /><CodeLine lineNumber="6285" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a1ed1067b1498e4790ce06d7b0fb995a3"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a1ed1067b1498e4790ce06d7b0fb995a3">LSRInstance::print&#95;fixups</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l06286" /><CodeLine lineNumber="6286"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;LSR is examining the following fixup sites:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06287" /><CodeLine lineNumber="6287"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU : Uses)</span></CodeLine>
<Link id="l06288" /><CodeLine lineNumber="6288"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup">LSRFixup</a> &amp;LF : LU.Fixups) &#123;</span></CodeLine>
<Link id="l06289" /><CodeLine lineNumber="6289"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06290" /><CodeLine lineNumber="6290"><span class="doxyHighlight">      LF.<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/lsrfixup/#aa7f24a759cb17285abd90cfa12e030c1">print</a>(OS);</span></CodeLine>
<Link id="l06291" /><CodeLine lineNumber="6291"><span class="doxyHighlight">      OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06292" /><CodeLine lineNumber="6292"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06293" /><CodeLine lineNumber="6293"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06294" /><CodeLine lineNumber="6294"></CodeLine>
<Link id="l06295" /><CodeLine lineNumber="6295" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a0d604d6453ff8ad118da3e2cadc04c66"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a0d604d6453ff8ad118da3e2cadc04c66">LSRInstance::print&#95;uses</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l06296" /><CodeLine lineNumber="6296"><span class="doxyHighlight">  OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;LSR is examining the following uses:\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06297" /><CodeLine lineNumber="6297"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsruse">LSRUse</a> &amp;LU : Uses) &#123;</span></CodeLine>
<Link id="l06298" /><CodeLine lineNumber="6298"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;  &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06299" /><CodeLine lineNumber="6299"><span class="doxyHighlight">    LU.print(OS);</span></CodeLine>
<Link id="l06300" /><CodeLine lineNumber="6300"><span class="doxyHighlight">    OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06301" /><CodeLine lineNumber="6301"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/formula">Formula</a> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a> : LU.Formulae) &#123;</span></CodeLine>
<Link id="l06302" /><CodeLine lineNumber="6302"><span class="doxyHighlight">      OS &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;    &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06303" /><CodeLine lineNumber="6303"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/support/md5-cpp/#a96d73bbd7af15cb1fc38c3f4a3bd82e9">F</a>.print(OS);</span></CodeLine>
<Link id="l06304" /><CodeLine lineNumber="6304"><span class="doxyHighlight">      OS &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06305" /><CodeLine lineNumber="6305"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06306" /><CodeLine lineNumber="6306"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06307" /><CodeLine lineNumber="6307"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06308" /><CodeLine lineNumber="6308"></CodeLine>
<Link id="l06309" /><CodeLine lineNumber="6309" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a154b34752235c9434c21cd366250100f"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a154b34752235c9434c21cd366250100f">LSRInstance::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;OS)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l06310" /><CodeLine lineNumber="6310"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#af93b911868eadea967fc026ed208698d">print&#95;factors&#95;and&#95;types</a>(OS);</span></CodeLine>
<Link id="l06311" /><CodeLine lineNumber="6311"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a1ed1067b1498e4790ce06d7b0fb995a3">print&#95;fixups</a>(OS);</span></CodeLine>
<Link id="l06312" /><CodeLine lineNumber="6312"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a0d604d6453ff8ad118da3e2cadc04c66">print&#95;uses</a>(OS);</span></CodeLine>
<Link id="l06313" /><CodeLine lineNumber="6313"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06314" /><CodeLine lineNumber="6314"></CodeLine>
<Link id="l06315" /><CodeLine lineNumber="6315" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a890ca19e74514f1ec5cbb3e5cdd8d50b"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a890ca19e74514f1ec5cbb3e5cdd8d50b">LSRInstance::dump</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l06316" /><CodeLine lineNumber="6316"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/lsrinstance/#a154b34752235c9434c21cd366250100f">print</a>(<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>()); <a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06317" /><CodeLine lineNumber="6317"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06318" /><CodeLine lineNumber="6318"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l06319" /><CodeLine lineNumber="6319"></CodeLine>
<Link id="l06320" /><CodeLine lineNumber="6320"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l06321" /><CodeLine lineNumber="6321"></CodeLine>
<Link id="l06322" /><CodeLine lineNumber="6322" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#af80949a15e2bf1220022362faa9579e0">LoopStrengthReduce</a> : </span><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/looppass/#a4d5799624e630ba03cb9133168951e8a">LoopPass</a> &#123;</span></CodeLine>
<Link id="l06323" /><CodeLine lineNumber="6323"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l06324" /><CodeLine lineNumber="6324" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#a70f981eb6b8f2c9553421cc07b98f8e5"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#a70f981eb6b8f2c9553421cc07b98f8e5">ID</a>; </span><span class="doxyHighlightComment">// Pass ID, replacement for typeid</span></CodeLine>
<Link id="l06325" /><CodeLine lineNumber="6325"></CodeLine>
<Link id="l06326" /><CodeLine lineNumber="6326"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#af80949a15e2bf1220022362faa9579e0">LoopStrengthReduce</a>();</span></CodeLine>
<Link id="l06327" /><CodeLine lineNumber="6327"></CodeLine>
<Link id="l06328" /><CodeLine lineNumber="6328"><span class="doxyHighlightKeyword">private</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l06329" /><CodeLine lineNumber="6329"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> runOnLoop(<a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/lppassmanager">LPPassManager</a> &amp;LPM) </span><span class="doxyHighlightKeyword">override</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06330" /><CodeLine lineNumber="6330"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> getAnalysisUsage(<a href="/docs/api/classes/llvm/analysisusage">AnalysisUsage</a> &amp;AU) </span><span class="doxyHighlightKeyword">const override</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06331" /><CodeLine lineNumber="6331"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l06332" /><CodeLine lineNumber="6332"></CodeLine>
<Link id="l06333" /><CodeLine lineNumber="6333"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l06334" /><CodeLine lineNumber="6334"></CodeLine>
<Link id="l06335" /><CodeLine lineNumber="6335" lineLink="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#af80949a15e2bf1220022362faa9579e0"><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#af80949a15e2bf1220022362faa9579e0">LoopStrengthReduce::LoopStrengthReduce</a>() : <a href="/docs/api/classes/llvm/looppass/#a4d5799624e630ba03cb9133168951e8a">LoopPass</a>(<a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#a70f981eb6b8f2c9553421cc07b98f8e5">ID</a>) &#123;</span></CodeLine>
<Link id="l06336" /><CodeLine lineNumber="6336"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#ac36ebb7d8a9874254ba36df4f0cde8b3">initializeLoopStrengthReducePass</a>(&#42;<a href="/docs/api/classes/llvm/passregistry/#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</span></CodeLine>
<Link id="l06337" /><CodeLine lineNumber="6337"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06338" /><CodeLine lineNumber="6338"></CodeLine>
<Link id="l06339" /><CodeLine lineNumber="6339"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LoopStrengthReduce::getAnalysisUsage(<a href="/docs/api/classes/llvm/analysisusage">AnalysisUsage</a> &amp;AU)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l06340" /><CodeLine lineNumber="6340"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We split critical edges, so we change the CFG.  However, we do update</span></CodeLine>
<Link id="l06341" /><CodeLine lineNumber="6341"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// many analyses if they are around.</span></CodeLine>
<Link id="l06342" /><CodeLine lineNumber="6342"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#a573df5c9c3024ebb646e15cc7450bf91">addPreservedID</a>(<a href="/docs/api/namespaces/llvm/#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</span></CodeLine>
<Link id="l06343" /><CodeLine lineNumber="6343"></CodeLine>
<Link id="l06344" /><CodeLine lineNumber="6344"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/loopinfowrapperpass">LoopInfoWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06345" /><CodeLine lineNumber="6345"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/loopinfowrapperpass">LoopInfoWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06346" /><CodeLine lineNumber="6346"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#a053677ebc731b47a534f841b11b5cf0c">addRequiredID</a>(<a href="/docs/api/namespaces/llvm/#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</span></CodeLine>
<Link id="l06347" /><CodeLine lineNumber="6347"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/dominatortreewrapperpass">DominatorTreeWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06348" /><CodeLine lineNumber="6348"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/dominatortreewrapperpass">DominatorTreeWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06349" /><CodeLine lineNumber="6349"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/scalarevolutionwrapperpass">ScalarEvolutionWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06350" /><CodeLine lineNumber="6350"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/scalarevolutionwrapperpass">ScalarEvolutionWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06351" /><CodeLine lineNumber="6351"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/assumptioncachetracker">AssumptionCacheTracker</a>&gt;();</span></CodeLine>
<Link id="l06352" /><CodeLine lineNumber="6352"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/targetlibraryinfowrapperpass">TargetLibraryInfoWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06353" /><CodeLine lineNumber="6353"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Requiring LoopSimplify a second time here prevents IVUsers from running</span></CodeLine>
<Link id="l06354" /><CodeLine lineNumber="6354"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// twice, since LoopSimplify was invalidated by running ScalarEvolution.</span></CodeLine>
<Link id="l06355" /><CodeLine lineNumber="6355"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#a053677ebc731b47a534f841b11b5cf0c">addRequiredID</a>(<a href="/docs/api/namespaces/llvm/#a472515fc67a5fb572afeb00aa2609cca">LoopSimplifyID</a>);</span></CodeLine>
<Link id="l06356" /><CodeLine lineNumber="6356"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/ivuserswrapperpass">IVUsersWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06357" /><CodeLine lineNumber="6357"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/ivuserswrapperpass">IVUsersWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06358" /><CodeLine lineNumber="6358"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/targettransforminfowrapperpass">TargetTransformInfoWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06359" /><CodeLine lineNumber="6359"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/memoryssawrapperpass">MemorySSAWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l06360" /><CodeLine lineNumber="6360"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06361" /><CodeLine lineNumber="6361"></CodeLine>
<Link id="l06362" /><CodeLine lineNumber="6362"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l06363" /><CodeLine lineNumber="6363"></CodeLine>
<Link id="l06364" /><CodeLine lineNumber="6364"><span class="doxyHighlightComment">/// Enables more convenient iteration over a DWARF expression vector.</span></CodeLine>
<Link id="l06365" /><CodeLine lineNumber="6365"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/iterator-range">iterator&#95;range&lt;llvm::DIExpression::expr&#95;op&#95;iterator&gt;</a></span></CodeLine>
<Link id="l06366" /><CodeLine lineNumber="6366" lineLink="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-/#a391c5efa7f6eb049718971aeeb9b71d5"><span class="doxyHighlight"><a href="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-/#a391c5efa7f6eb049718971aeeb9b71d5">ToDwarfOpIter</a>(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;Expr) &#123;</span></CodeLine>
<Link id="l06367" /><CodeLine lineNumber="6367"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/diexpression/expr-op-iterator">llvm::DIExpression::expr&#95;op&#95;iterator</a> Begin =</span></CodeLine>
<Link id="l06368" /><CodeLine lineNumber="6368"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/diexpression/expr-op-iterator">llvm::DIExpression::expr&#95;op&#95;iterator</a>(Expr.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>());</span></CodeLine>
<Link id="l06369" /><CodeLine lineNumber="6369"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/diexpression/expr-op-iterator">llvm::DIExpression::expr&#95;op&#95;iterator</a> End =</span></CodeLine>
<Link id="l06370" /><CodeLine lineNumber="6370"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/diexpression/expr-op-iterator">llvm::DIExpression::expr&#95;op&#95;iterator</a>(Expr.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>());</span></CodeLine>
<Link id="l06371" /><CodeLine lineNumber="6371"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;Begin, End&#125;;</span></CodeLine>
<Link id="l06372" /><CodeLine lineNumber="6372"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06373" /><CodeLine lineNumber="6373"></CodeLine>
<Link id="l06374" /><CodeLine lineNumber="6374" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a> &#123;</span></CodeLine>
<Link id="l06375" /><CodeLine lineNumber="6375" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a>() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06376" /><CodeLine lineNumber="6376" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a02fa7ab40a4bb47c700385d898d39efa"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a02fa7ab40a4bb47c700385d898d39efa">SCEVDbgValueBuilder</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a62bd6b249b4fa5e6373d70d73fa6237c">clone</a>(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>); &#125;</span></CodeLine>
<Link id="l06377" /><CodeLine lineNumber="6377"></CodeLine>
<Link id="l06378" /><CodeLine lineNumber="6378" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a62bd6b249b4fa5e6373d70d73fa6237c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a62bd6b249b4fa5e6373d70d73fa6237c">clone</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a> &amp;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>) &#123;</span></CodeLine>
<Link id="l06379" /><CodeLine lineNumber="6379"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.LocationOps;</span></CodeLine>
<Link id="l06380" /><CodeLine lineNumber="6380"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a> = <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>.Expr;</span></CodeLine>
<Link id="l06381" /><CodeLine lineNumber="6381"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06382" /><CodeLine lineNumber="6382"></CodeLine>
<Link id="l06383" /><CodeLine lineNumber="6383" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a8f49864522c7db2283185f4067f5e782"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a8f49864522c7db2283185f4067f5e782">clear</a>() &#123;</span></CodeLine>
<Link id="l06384" /><CodeLine lineNumber="6384"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.clear();</span></CodeLine>
<Link id="l06385" /><CodeLine lineNumber="6385"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.clear();</span></CodeLine>
<Link id="l06386" /><CodeLine lineNumber="6386"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06387" /><CodeLine lineNumber="6387"></CodeLine>
<Link id="l06388" /><CodeLine lineNumber="6388"><span class="doxyHighlightComment">  /// The DIExpression as we translate the SCEV.</span></CodeLine>
<Link id="l06389" /><CodeLine lineNumber="6389" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;uint64&#95;t, 6&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>;</span></CodeLine>
<Link id="l06390" /><CodeLine lineNumber="6390"><span class="doxyHighlightComment">  /// The location ops of the DIExpression.</span></CodeLine>
<Link id="l06391" /><CodeLine lineNumber="6391" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 2&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>;</span></CodeLine>
<Link id="l06392" /><CodeLine lineNumber="6392"></CodeLine>
<Link id="l06393" /><CodeLine lineNumber="6393" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(uint64&#95;t <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>); &#125;</span></CodeLine>
<Link id="l06394" /><CodeLine lineNumber="6394" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1eccfeb23bb095c15dcaaa5a75837426"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1eccfeb23bb095c15dcaaa5a75837426">pushUInt</a>(uint64&#95;t Operand) &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(Operand); &#125;</span></CodeLine>
<Link id="l06395" /><CodeLine lineNumber="6395"></CodeLine>
<Link id="l06396" /><CodeLine lineNumber="6396"><span class="doxyHighlightComment">  /// Add a DW&#95;OP&#95;LLVM&#95;arg to the expression, followed by the index of the value</span></CodeLine>
<Link id="l06397" /><CodeLine lineNumber="6397"><span class="doxyHighlightComment">  /// in the set of values referenced by the expression.</span></CodeLine>
<Link id="l06398" /><CodeLine lineNumber="6398" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9">pushLocation</a>(<a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;V) &#123;</span></CodeLine>
<Link id="l06399" /><CodeLine lineNumber="6399"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">llvm::dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>);</span></CodeLine>
<Link id="l06400" /><CodeLine lineNumber="6400"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;It = <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">llvm::find</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>, V);</span></CodeLine>
<Link id="l06401" /><CodeLine lineNumber="6401"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ArgIndex = 0;</span></CodeLine>
<Link id="l06402" /><CodeLine lineNumber="6402"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (It != <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.end()) &#123;</span></CodeLine>
<Link id="l06403" /><CodeLine lineNumber="6403"><span class="doxyHighlight">      ArgIndex = std::distance(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.begin(), It);</span></CodeLine>
<Link id="l06404" /><CodeLine lineNumber="6404"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l06405" /><CodeLine lineNumber="6405"><span class="doxyHighlight">      ArgIndex = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.size();</span></CodeLine>
<Link id="l06406" /><CodeLine lineNumber="6406"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.push&#95;back(V);</span></CodeLine>
<Link id="l06407" /><CodeLine lineNumber="6407"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06408" /><CodeLine lineNumber="6408"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(ArgIndex);</span></CodeLine>
<Link id="l06409" /><CodeLine lineNumber="6409"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06410" /><CodeLine lineNumber="6410"></CodeLine>
<Link id="l06411" /><CodeLine lineNumber="6411" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a673f671a403fc11f472a4c9b4c9505c2"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a673f671a403fc11f472a4c9b4c9505c2">pushValue</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U) &#123;</span></CodeLine>
<Link id="l06412" /><CodeLine lineNumber="6412"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/value">llvm::Value</a> &#42;V = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVUnknown&gt;</a>(U)-&gt;getValue();</span></CodeLine>
<Link id="l06413" /><CodeLine lineNumber="6413"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9">pushLocation</a>(V);</span></CodeLine>
<Link id="l06414" /><CodeLine lineNumber="6414"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06415" /><CodeLine lineNumber="6415"></CodeLine>
<Link id="l06416" /><CodeLine lineNumber="6416" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a7b3482ccb17e2b6a7d1a99c57dce9eeb"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a7b3482ccb17e2b6a7d1a99c57dce9eeb">pushConst</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>) &#123;</span></CodeLine>
<Link id="l06417" /><CodeLine lineNumber="6417"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSignificantBits() &gt; 64)</span></CodeLine>
<Link id="l06418" /><CodeLine lineNumber="6418"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06419" /><CodeLine lineNumber="6419"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(llvm::dwarf::DW&#95;OP&#95;consts);</span></CodeLine>
<Link id="l06420" /><CodeLine lineNumber="6420"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSExtValue());</span></CodeLine>
<Link id="l06421" /><CodeLine lineNumber="6421"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06422" /><CodeLine lineNumber="6422"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06423" /><CodeLine lineNumber="6423"></CodeLine>
<Link id="l06424" /><CodeLine lineNumber="6424"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Iterating the expression as DWARF ops is convenient when updating</span></CodeLine>
<Link id="l06425" /><CodeLine lineNumber="6425"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// DWARF&#95;OP&#95;LLVM&#95;args.</span></CodeLine>
<Link id="l06426" /><CodeLine lineNumber="6426" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1fb2fff65491c783042bbbc6716bd5d2"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/iterator-range">iterator&#95;range&lt;llvm::DIExpression::expr&#95;op&#95;iterator&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1fb2fff65491c783042bbbc6716bd5d2">expr&#95;ops</a>() &#123;</span></CodeLine>
<Link id="l06427" /><CodeLine lineNumber="6427"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-/#a391c5efa7f6eb049718971aeeb9b71d5">ToDwarfOpIter</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>);</span></CodeLine>
<Link id="l06428" /><CodeLine lineNumber="6428"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06429" /><CodeLine lineNumber="6429"></CodeLine>
<Link id="l06430" /><CodeLine lineNumber="6430"><span class="doxyHighlightComment">  /// Several SCEV types are sequences of the same arithmetic operator applied</span></CodeLine>
<Link id="l06431" /><CodeLine lineNumber="6431"><span class="doxyHighlightComment">  /// to constants and values that may be extended or truncated.</span></CodeLine>
<Link id="l06432" /><CodeLine lineNumber="6432" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a0b92dc455822b15a2cbfdff183ad761c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a0b92dc455822b15a2cbfdff183ad761c">pushArithmeticExpr</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevcommutativeexpr">llvm::SCEVCommutativeExpr</a> &#42;CommExpr,</span></CodeLine>
<Link id="l06433" /><CodeLine lineNumber="6433"><span class="doxyHighlight">                          uint64&#95;t DwarfOp) &#123;</span></CodeLine>
<Link id="l06434" /><CodeLine lineNumber="6434"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;llvm::SCEVAddExpr&gt;</a>(CommExpr) || <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVMulExpr&gt;</a>(CommExpr)) &amp;&amp;</span></CodeLine>
<Link id="l06435" /><CodeLine lineNumber="6435"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Expected arithmetic SCEV type&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06436" /><CodeLine lineNumber="6436"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06437" /><CodeLine lineNumber="6437"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> EmitOperator = 0;</span></CodeLine>
<Link id="l06438" /><CodeLine lineNumber="6438"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : CommExpr-&gt;<a href="/docs/api/classes/llvm/scevnaryexpr/#ae77d0f7b81cbde08d5fd75fcf2fcf36b">operands</a>()) &#123;</span></CodeLine>
<Link id="l06439" /><CodeLine lineNumber="6439"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</span></CodeLine>
<Link id="l06440" /><CodeLine lineNumber="6440"></CodeLine>
<Link id="l06441" /><CodeLine lineNumber="6441"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EmitOperator &gt;= 1)</span></CodeLine>
<Link id="l06442" /><CodeLine lineNumber="6442"><span class="doxyHighlight">        <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(DwarfOp);</span></CodeLine>
<Link id="l06443" /><CodeLine lineNumber="6443"><span class="doxyHighlight">      ++EmitOperator;</span></CodeLine>
<Link id="l06444" /><CodeLine lineNumber="6444"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06445" /><CodeLine lineNumber="6445"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a>;</span></CodeLine>
<Link id="l06446" /><CodeLine lineNumber="6446"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06447" /><CodeLine lineNumber="6447"></CodeLine>
<Link id="l06448" /><CodeLine lineNumber="6448"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: Identify and omit noop casts.</span></CodeLine>
<Link id="l06449" /><CodeLine lineNumber="6449" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac685ec5a094330e0ce1e86c573a2e934"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac685ec5a094330e0ce1e86c573a2e934">pushCast</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevcastexpr">llvm::SCEVCastExpr</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsSigned) &#123;</span></CodeLine>
<Link id="l06450" /><CodeLine lineNumber="6450"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">llvm::SCEV</a> &#42;Inner = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getOperand(0);</span></CodeLine>
<Link id="l06451" /><CodeLine lineNumber="6451"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/type">llvm::Type</a> &#42;<a href="/docs/api/classes/llvm/type">Type</a> = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getType();</span></CodeLine>
<Link id="l06452" /><CodeLine lineNumber="6452"><span class="doxyHighlight">    uint64&#95;t ToWidth = <a href="/docs/api/classes/llvm/type">Type</a>-&gt;<a href="/docs/api/classes/llvm/type/#a13e877ef779ba7a0688081079f4f9b03">getIntegerBitWidth</a>();</span></CodeLine>
<Link id="l06453" /><CodeLine lineNumber="6453"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> = <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Inner);</span></CodeLine>
<Link id="l06454" /><CodeLine lineNumber="6454"><span class="doxyHighlight">    uint64&#95;t CastOps&#91;&#93; = &#123;<a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0caee0952c3cd8bf8106bbfa0a323c1ca82">dwarf::DW&#95;OP&#95;LLVM&#95;convert</a>, ToWidth,</span></CodeLine>
<Link id="l06455" /><CodeLine lineNumber="6455"><span class="doxyHighlight">                          IsSigned ? llvm::dwarf::DW&#95;ATE&#95;signed</span></CodeLine>
<Link id="l06456" /><CodeLine lineNumber="6456"><span class="doxyHighlight">                                   : llvm::dwarf::DW&#95;ATE&#95;unsigned&#125;;</span></CodeLine>
<Link id="l06457" /><CodeLine lineNumber="6457"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : CastOps)</span></CodeLine>
<Link id="l06458" /><CodeLine lineNumber="6458"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</span></CodeLine>
<Link id="l06459" /><CodeLine lineNumber="6459"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a>;</span></CodeLine>
<Link id="l06460" /><CodeLine lineNumber="6460"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06461" /><CodeLine lineNumber="6461"></CodeLine>
<Link id="l06462" /><CodeLine lineNumber="6462"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: MinMax - although these haven&#39;t been encountered in the test suite.</span></CodeLine>
<Link id="l06463" /><CodeLine lineNumber="6463" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">llvm::SCEV</a> &#42;S) &#123;</span></CodeLine>
<Link id="l06464" /><CodeLine lineNumber="6464"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06465" /><CodeLine lineNumber="6465"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;StartInt = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l06466" /><CodeLine lineNumber="6466"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a7b3482ccb17e2b6a7d1a99c57dce9eeb">pushConst</a>(StartInt);</span></CodeLine>
<Link id="l06467" /><CodeLine lineNumber="6467"></CodeLine>
<Link id="l06468" /><CodeLine lineNumber="6468"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevunknown">SCEVUnknown</a> &#42;U = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUnknown&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l06469" /><CodeLine lineNumber="6469"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!U-&gt;getValue())</span></CodeLine>
<Link id="l06470" /><CodeLine lineNumber="6470"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06471" /><CodeLine lineNumber="6471"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9">pushLocation</a>(U-&gt;getValue());</span></CodeLine>
<Link id="l06472" /><CodeLine lineNumber="6472"></CodeLine>
<Link id="l06473" /><CodeLine lineNumber="6473"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevmulexpr">SCEVMulExpr</a> &#42;MulRec = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVMulExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l06474" /><CodeLine lineNumber="6474"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a0b92dc455822b15a2cbfdff183ad761c">pushArithmeticExpr</a>(MulRec, llvm::dwarf::DW&#95;OP&#95;mul);</span></CodeLine>
<Link id="l06475" /><CodeLine lineNumber="6475"></CodeLine>
<Link id="l06476" /><CodeLine lineNumber="6476"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevudivexpr">SCEVUDivExpr</a> &#42;UDiv = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVUDivExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l06477" /><CodeLine lineNumber="6477"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(UDiv-&gt;getLHS());</span></CodeLine>
<Link id="l06478" /><CodeLine lineNumber="6478"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(UDiv-&gt;getRHS());</span></CodeLine>
<Link id="l06479" /><CodeLine lineNumber="6479"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;div);</span></CodeLine>
<Link id="l06480" /><CodeLine lineNumber="6480"></CodeLine>
<Link id="l06481" /><CodeLine lineNumber="6481"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevcastexpr">SCEVCastExpr</a> &#42;Cast = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVCastExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l06482" /><CodeLine lineNumber="6482"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Assert if a new and unknown SCEVCastEXpr type is encountered.</span></CodeLine>
<Link id="l06483" /><CodeLine lineNumber="6483"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVZeroExtendExpr&gt;</a>(Cast) || <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVTruncateExpr&gt;</a>(Cast) ||</span></CodeLine>
<Link id="l06484" /><CodeLine lineNumber="6484"><span class="doxyHighlight">              <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVPtrToIntExpr&gt;</a>(Cast) || <a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVSignExtendExpr&gt;</a>(Cast)) &amp;&amp;</span></CodeLine>
<Link id="l06485" /><CodeLine lineNumber="6485"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Unexpected cast type in SCEV.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06486" /><CodeLine lineNumber="6486"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac685ec5a094330e0ce1e86c573a2e934">pushCast</a>(Cast, (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVSignExtendExpr&gt;</a>(Cast)));</span></CodeLine>
<Link id="l06487" /><CodeLine lineNumber="6487"></CodeLine>
<Link id="l06488" /><CodeLine lineNumber="6488"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddexpr">SCEVAddExpr</a> &#42;AddExpr = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l06489" /><CodeLine lineNumber="6489"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> &amp;= <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a0b92dc455822b15a2cbfdff183ad761c">pushArithmeticExpr</a>(AddExpr, llvm::dwarf::DW&#95;OP&#95;plus);</span></CodeLine>
<Link id="l06490" /><CodeLine lineNumber="6490"></CodeLine>
<Link id="l06491" /><CodeLine lineNumber="6491"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l06492" /><CodeLine lineNumber="6492"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Nested SCEVAddRecExpr are generated by nested loops and are currently</span></CodeLine>
<Link id="l06493" /><CodeLine lineNumber="6493"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// unsupported.</span></CodeLine>
<Link id="l06494" /><CodeLine lineNumber="6494"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06495" /><CodeLine lineNumber="6495"></CodeLine>
<Link id="l06496" /><CodeLine lineNumber="6496"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l06497" /><CodeLine lineNumber="6497"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06498" /><CodeLine lineNumber="6498"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06499" /><CodeLine lineNumber="6499"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a>;</span></CodeLine>
<Link id="l06500" /><CodeLine lineNumber="6500"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06501" /><CodeLine lineNumber="6501"></CodeLine>
<Link id="l06502" /><CodeLine lineNumber="6502"><span class="doxyHighlightComment">  /// Return true if the combination of arithmetic operator and underlying</span></CodeLine>
<Link id="l06503" /><CodeLine lineNumber="6503"><span class="doxyHighlightComment">  /// SCEV constant value is an identity function.</span></CodeLine>
<Link id="l06504" /><CodeLine lineNumber="6504" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(uint64&#95;t <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S) &#123;</span></CodeLine>
<Link id="l06505" /><CodeLine lineNumber="6505"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevconstant">SCEVConstant</a> &#42;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a> = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVConstant&gt;</a>(S)) &#123;</span></CodeLine>
<Link id="l06506" /><CodeLine lineNumber="6506"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSignificantBits() &gt; 64)</span></CodeLine>
<Link id="l06507" /><CodeLine lineNumber="6507"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06508" /><CodeLine lineNumber="6508"><span class="doxyHighlight">      int64&#95;t <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>-&gt;getAPInt().getSExtValue();</span></CodeLine>
<Link id="l06509" /><CodeLine lineNumber="6509"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) &#123;</span></CodeLine>
<Link id="l06510" /><CodeLine lineNumber="6510"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> llvm::dwarf::DW&#95;OP&#95;plus:</span></CodeLine>
<Link id="l06511" /><CodeLine lineNumber="6511"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> llvm::dwarf::DW&#95;OP&#95;minus:</span></CodeLine>
<Link id="l06512" /><CodeLine lineNumber="6512"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> == 0;</span></CodeLine>
<Link id="l06513" /><CodeLine lineNumber="6513"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> llvm::dwarf::DW&#95;OP&#95;mul:</span></CodeLine>
<Link id="l06514" /><CodeLine lineNumber="6514"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> llvm::dwarf::DW&#95;OP&#95;div:</span></CodeLine>
<Link id="l06515" /><CodeLine lineNumber="6515"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> == 1;</span></CodeLine>
<Link id="l06516" /><CodeLine lineNumber="6516"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l06517" /><CodeLine lineNumber="6517"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06518" /><CodeLine lineNumber="6518"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06519" /><CodeLine lineNumber="6519"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06520" /><CodeLine lineNumber="6520"></CodeLine>
<Link id="l06521" /><CodeLine lineNumber="6521"><span class="doxyHighlightComment">  /// Convert a SCEV of a value to a DIExpression that is pushed onto the</span></CodeLine>
<Link id="l06522" /><CodeLine lineNumber="6522"><span class="doxyHighlightComment">  /// builder&#39;s expression stack. The stack should already contain an</span></CodeLine>
<Link id="l06523" /><CodeLine lineNumber="6523"><span class="doxyHighlightComment">  /// expression for the iteration count, so that it can be multiplied by</span></CodeLine>
<Link id="l06524" /><CodeLine lineNumber="6524"><span class="doxyHighlightComment">  /// the stride and added to the start.</span></CodeLine>
<Link id="l06525" /><CodeLine lineNumber="6525"><span class="doxyHighlightComment">  /// Components of the expression are omitted if they are an identity function.</span></CodeLine>
<Link id="l06526" /><CodeLine lineNumber="6526"><span class="doxyHighlightComment">  /// Chain (non-affine) SCEVs are not supported.</span></CodeLine>
<Link id="l06527" /><CodeLine lineNumber="6527" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aca9e38901fab9929c7c586f376249e9a"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aca9e38901fab9929c7c586f376249e9a">SCEVToValueExpr</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">llvm::SCEVAddRecExpr</a> &amp;SAR, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l06528" /><CodeLine lineNumber="6528"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Expected affine SCEV&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06529" /><CodeLine lineNumber="6529"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// TODO: Is this check needed?</span></CodeLine>
<Link id="l06530" /><CodeLine lineNumber="6530"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>()))</span></CodeLine>
<Link id="l06531" /><CodeLine lineNumber="6531"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06532" /><CodeLine lineNumber="6532"></CodeLine>
<Link id="l06533" /><CodeLine lineNumber="6533"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Start = SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>();</span></CodeLine>
<Link id="l06534" /><CodeLine lineNumber="6534"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Stride = SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE);</span></CodeLine>
<Link id="l06535" /><CodeLine lineNumber="6535"></CodeLine>
<Link id="l06536" /><CodeLine lineNumber="6536"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Skip pushing arithmetic noops.</span></CodeLine>
<Link id="l06537" /><CodeLine lineNumber="6537"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(llvm::dwarf::DW&#95;OP&#95;mul, Stride)) &#123;</span></CodeLine>
<Link id="l06538" /><CodeLine lineNumber="6538"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Stride))</span></CodeLine>
<Link id="l06539" /><CodeLine lineNumber="6539"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06540" /><CodeLine lineNumber="6540"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;mul);</span></CodeLine>
<Link id="l06541" /><CodeLine lineNumber="6541"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06542" /><CodeLine lineNumber="6542"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(llvm::dwarf::DW&#95;OP&#95;plus, Start)) &#123;</span></CodeLine>
<Link id="l06543" /><CodeLine lineNumber="6543"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Start))</span></CodeLine>
<Link id="l06544" /><CodeLine lineNumber="6544"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06545" /><CodeLine lineNumber="6545"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;plus);</span></CodeLine>
<Link id="l06546" /><CodeLine lineNumber="6546"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06547" /><CodeLine lineNumber="6547"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06548" /><CodeLine lineNumber="6548"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06549" /><CodeLine lineNumber="6549"></CodeLine>
<Link id="l06550" /><CodeLine lineNumber="6550"><span class="doxyHighlightComment">  /// Create an expression that is an offset from a value (usually the IV).</span></CodeLine>
<Link id="l06551" /><CodeLine lineNumber="6551" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a86078042131d19e2f2316d66815279cd"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a86078042131d19e2f2316d66815279cd">createOffsetExpr</a>(int64&#95;t <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>, <a href="/docs/api/classes/llvm/value">Value</a> &#42;OffsetValue) &#123;</span></CodeLine>
<Link id="l06552" /><CodeLine lineNumber="6552"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a41f7aa56b334ebee90f447a138187cf9">pushLocation</a>(OffsetValue);</span></CodeLine>
<Link id="l06553" /><CodeLine lineNumber="6553"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/diexpression/#a272fe723d8c234f2137d34621a5cef78">DIExpression::appendOffset</a>(<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a4f023f5e34fa5bd5178f30af2abcbb80">Expr</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>);</span></CodeLine>
<Link id="l06554" /><CodeLine lineNumber="6554"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l06555" /><CodeLine lineNumber="6555"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: Generated IV offset expression. Offset: &quot;</span></CodeLine>
<Link id="l06556" /><CodeLine lineNumber="6556"><span class="doxyHighlight">               &lt;&lt; std::to&#95;string(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06557" /><CodeLine lineNumber="6557"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06558" /><CodeLine lineNumber="6558"></CodeLine>
<Link id="l06559" /><CodeLine lineNumber="6559"><span class="doxyHighlightComment">  /// Combine a translation of the SCEV and the IV to create an expression that</span></CodeLine>
<Link id="l06560" /><CodeLine lineNumber="6560"><span class="doxyHighlightComment">  /// recovers a location&#39;s value.</span></CodeLine>
<Link id="l06561" /><CodeLine lineNumber="6561"><span class="doxyHighlightComment">  /// returns true if an expression was created.</span></CodeLine>
<Link id="l06562" /><CodeLine lineNumber="6562" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac651c1875f806ba7d3b74b6e32323048"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#ac651c1875f806ba7d3b74b6e32323048">createIterCountExpr</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S,</span></CodeLine>
<Link id="l06563" /><CodeLine lineNumber="6563"><span class="doxyHighlight">                           </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#adfb9915143bd7687fc48c5174f5b6e68">SCEVDbgValueBuilder</a> &amp;IterationCount,</span></CodeLine>
<Link id="l06564" /><CodeLine lineNumber="6564"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l06565" /><CodeLine lineNumber="6565"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// SCEVs for SSA values are most frquently of the form</span></CodeLine>
<Link id="l06566" /><CodeLine lineNumber="6566"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// &#123;start,+,stride&#125;, but sometimes they are (&#123;start,+,stride&#125; + %a + ..).</span></CodeLine>
<Link id="l06567" /><CodeLine lineNumber="6567"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This is because %a is a PHI node that is not the IV. However, these</span></CodeLine>
<Link id="l06568" /><CodeLine lineNumber="6568"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// SCEVs have not been observed to result in debuginfo-lossy optimisations,</span></CodeLine>
<Link id="l06569" /><CodeLine lineNumber="6569"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// so its not expected this point will be reached.</span></CodeLine>
<Link id="l06570" /><CodeLine lineNumber="6570"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(S))</span></CodeLine>
<Link id="l06571" /><CodeLine lineNumber="6571"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06572" /><CodeLine lineNumber="6572"></CodeLine>
<Link id="l06573" /><CodeLine lineNumber="6573"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: Location to salvage SCEV: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;S</span></CodeLine>
<Link id="l06574" /><CodeLine lineNumber="6574"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06575" /><CodeLine lineNumber="6575"></CodeLine>
<Link id="l06576" /><CodeLine lineNumber="6576"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;Rec = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;SCEVAddRecExpr&gt;</a>(S);</span></CodeLine>
<Link id="l06577" /><CodeLine lineNumber="6577"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Rec-&gt;isAffine())</span></CodeLine>
<Link id="l06578" /><CodeLine lineNumber="6578"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06579" /><CodeLine lineNumber="6579"></CodeLine>
<Link id="l06580" /><CodeLine lineNumber="6580"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (S-&gt;<a href="/docs/api/classes/llvm/scev/#a102c99af586cd76e0d9ff32ac0e825e0">getExpressionSize</a>() &gt; <a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">MaxSCEVSalvageExpressionSize</a>)</span></CodeLine>
<Link id="l06581" /><CodeLine lineNumber="6581"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06582" /><CodeLine lineNumber="6582"></CodeLine>
<Link id="l06583" /><CodeLine lineNumber="6583"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Initialise a new builder with the iteration count expression. In</span></CodeLine>
<Link id="l06584" /><CodeLine lineNumber="6584"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// combination with the value&#39;s SCEV this enables recovery.</span></CodeLine>
<Link id="l06585" /><CodeLine lineNumber="6585"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a62bd6b249b4fa5e6373d70d73fa6237c">clone</a>(IterationCount);</span></CodeLine>
<Link id="l06586" /><CodeLine lineNumber="6586"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aca9e38901fab9929c7c586f376249e9a">SCEVToValueExpr</a>(&#42;Rec, SE))</span></CodeLine>
<Link id="l06587" /><CodeLine lineNumber="6587"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06588" /><CodeLine lineNumber="6588"></CodeLine>
<Link id="l06589" /><CodeLine lineNumber="6589"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06590" /><CodeLine lineNumber="6590"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06591" /><CodeLine lineNumber="6591"></CodeLine>
<Link id="l06592" /><CodeLine lineNumber="6592"><span class="doxyHighlightComment">  /// Convert a SCEV of a value to a DIExpression that is pushed onto the</span></CodeLine>
<Link id="l06593" /><CodeLine lineNumber="6593"><span class="doxyHighlightComment">  /// builder&#39;s expression stack. The stack should already contain an</span></CodeLine>
<Link id="l06594" /><CodeLine lineNumber="6594"><span class="doxyHighlightComment">  /// expression for the iteration count, so that it can be multiplied by</span></CodeLine>
<Link id="l06595" /><CodeLine lineNumber="6595"><span class="doxyHighlightComment">  /// the stride and added to the start.</span></CodeLine>
<Link id="l06596" /><CodeLine lineNumber="6596"><span class="doxyHighlightComment">  /// Components of the expression are omitted if they are an identity function.</span></CodeLine>
<Link id="l06597" /><CodeLine lineNumber="6597" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a152f85e50f38db96586836800a9e2da4"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a152f85e50f38db96586836800a9e2da4">SCEVToIterCountExpr</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">llvm::SCEVAddRecExpr</a> &amp;SAR,</span></CodeLine>
<Link id="l06598" /><CodeLine lineNumber="6598"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE) &#123;</span></CodeLine>
<Link id="l06599" /><CodeLine lineNumber="6599"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a54bb7394d874cbbef1d81e6bea89d4f3">isAffine</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Expected affine SCEV&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06600" /><CodeLine lineNumber="6600"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;SCEVAddRecExpr&gt;</a>(SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>())) &#123;</span></CodeLine>
<Link id="l06601" /><CodeLine lineNumber="6601"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: IV SCEV. Unsupported nested AddRec: &quot;</span></CodeLine>
<Link id="l06602" /><CodeLine lineNumber="6602"><span class="doxyHighlight">                        &lt;&lt; SAR &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06603" /><CodeLine lineNumber="6603"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06604" /><CodeLine lineNumber="6604"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06605" /><CodeLine lineNumber="6605"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Start = SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a19c13fe96d59c787e900b7bbf7173263">getStart</a>();</span></CodeLine>
<Link id="l06606" /><CodeLine lineNumber="6606"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;Stride = SAR.<a href="/docs/api/classes/llvm/scevaddrecexpr/#a4049f7040a4628b15f182c3c9aaf802a">getStepRecurrence</a>(SE);</span></CodeLine>
<Link id="l06607" /><CodeLine lineNumber="6607"></CodeLine>
<Link id="l06608" /><CodeLine lineNumber="6608"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Skip pushing arithmetic noops.</span></CodeLine>
<Link id="l06609" /><CodeLine lineNumber="6609"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(llvm::dwarf::DW&#95;OP&#95;minus, Start)) &#123;</span></CodeLine>
<Link id="l06610" /><CodeLine lineNumber="6610"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Start))</span></CodeLine>
<Link id="l06611" /><CodeLine lineNumber="6611"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06612" /><CodeLine lineNumber="6612"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;minus);</span></CodeLine>
<Link id="l06613" /><CodeLine lineNumber="6613"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06614" /><CodeLine lineNumber="6614"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aaf5b3730ed2519bd7febddb943bf702f">isIdentityFunction</a>(llvm::dwarf::DW&#95;OP&#95;div, Stride)) &#123;</span></CodeLine>
<Link id="l06615" /><CodeLine lineNumber="6615"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a94370ac539d267faf0d27c49f66b5a61">pushSCEV</a>(Stride))</span></CodeLine>
<Link id="l06616" /><CodeLine lineNumber="6616"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06617" /><CodeLine lineNumber="6617"><span class="doxyHighlight">      <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#aa89ab43330c82ba73c38632801549882">pushOperator</a>(llvm::dwarf::DW&#95;OP&#95;div);</span></CodeLine>
<Link id="l06618" /><CodeLine lineNumber="6618"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06619" /><CodeLine lineNumber="6619"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06620" /><CodeLine lineNumber="6620"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06621" /><CodeLine lineNumber="6621"></CodeLine>
<Link id="l06622" /><CodeLine lineNumber="6622"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Append the current expression and locations to a location list and an</span></CodeLine>
<Link id="l06623" /><CodeLine lineNumber="6623"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// expression list. Modify the DW&#95;OP&#95;LLVM&#95;arg indexes to account for</span></CodeLine>
<Link id="l06624" /><CodeLine lineNumber="6624"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the locations already present in the destination list.</span></CodeLine>
<Link id="l06625" /><CodeLine lineNumber="6625" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a08fddb3d382c1c806dee38774e6464d7"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a08fddb3d382c1c806dee38774e6464d7">appendToVectors</a>(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;DestExpr,</span></CodeLine>
<Link id="l06626" /><CodeLine lineNumber="6626"><span class="doxyHighlight">                       <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;DestLocations) &#123;</span></CodeLine>
<Link id="l06627" /><CodeLine lineNumber="6627"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>() &amp;&amp;</span></CodeLine>
<Link id="l06628" /><CodeLine lineNumber="6628"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Expected the locations vector to contain the IV&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06629" /><CodeLine lineNumber="6629"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The DWARF&#95;OP&#95;LLVM&#95;arg arguments of the expression being appended must be</span></CodeLine>
<Link id="l06630" /><CodeLine lineNumber="6630"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// modified to account for the locations already in the destination vector.</span></CodeLine>
<Link id="l06631" /><CodeLine lineNumber="6631"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// All builders contain the IV as the first location op.</span></CodeLine>
<Link id="l06632" /><CodeLine lineNumber="6632"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>.empty() &amp;&amp;</span></CodeLine>
<Link id="l06633" /><CodeLine lineNumber="6633"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Expected the location ops to contain the IV.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06634" /><CodeLine lineNumber="6634"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// DestIndexMap&#91;n&#93; contains the index in DestLocations for the nth</span></CodeLine>
<Link id="l06635" /><CodeLine lineNumber="6635"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// location in this SCEVDbgValueBuilder.</span></CodeLine>
<Link id="l06636" /><CodeLine lineNumber="6636"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;uint64&#95;t, 2&gt;</a> DestIndexMap;</span></CodeLine>
<Link id="l06637" /><CodeLine lineNumber="6637"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a06e056e670df6766ad5371e518e27c45">LocationOps</a>) &#123;</span></CodeLine>
<Link id="l06638" /><CodeLine lineNumber="6638"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> It = <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">find</a>(DestLocations, <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</span></CodeLine>
<Link id="l06639" /><CodeLine lineNumber="6639"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (It != DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>()) &#123;</span></CodeLine>
<Link id="l06640" /><CodeLine lineNumber="6640"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Location already exists in DestLocations, reuse existing ArgIndex.</span></CodeLine>
<Link id="l06641" /><CodeLine lineNumber="6641"><span class="doxyHighlight">        DestIndexMap.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(std::distance(DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), It));</span></CodeLine>
<Link id="l06642" /><CodeLine lineNumber="6642"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06643" /><CodeLine lineNumber="6643"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l06644" /><CodeLine lineNumber="6644"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Location is not in DestLocations, add it.</span></CodeLine>
<Link id="l06645" /><CodeLine lineNumber="6645"><span class="doxyHighlight">      DestIndexMap.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>());</span></CodeLine>
<Link id="l06646" /><CodeLine lineNumber="6646"><span class="doxyHighlight">      DestLocations.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</span></CodeLine>
<Link id="l06647" /><CodeLine lineNumber="6647"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06648" /><CodeLine lineNumber="6648"></CodeLine>
<Link id="l06649" /><CodeLine lineNumber="6649"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/scevdbgvaluebuilder/#a1fb2fff65491c783042bbbc6716bd5d2">expr&#95;ops</a>()) &#123;</span></CodeLine>
<Link id="l06650" /><CodeLine lineNumber="6650"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getOp() != <a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>) &#123;</span></CodeLine>
<Link id="l06651" /><CodeLine lineNumber="6651"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.appendToVector(DestExpr);</span></CodeLine>
<Link id="l06652" /><CodeLine lineNumber="6652"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06653" /><CodeLine lineNumber="6653"><span class="doxyHighlight">      &#125; </span></CodeLine>
<Link id="l06654" /><CodeLine lineNumber="6654"></CodeLine>
<Link id="l06655" /><CodeLine lineNumber="6655"><span class="doxyHighlight">      DestExpr.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>);</span></CodeLine>
<Link id="l06656" /><CodeLine lineNumber="6656"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// &#96;DW&#95;OP&#95;LLVM&#95;arg n&#96; represents the nth LocationOp in this SCEV,</span></CodeLine>
<Link id="l06657" /><CodeLine lineNumber="6657"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// DestIndexMap&#91;n&#93; contains its new index in DestLocations.</span></CodeLine>
<Link id="l06658" /><CodeLine lineNumber="6658"><span class="doxyHighlight">      uint64&#95;t NewIndex = DestIndexMap&#91;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getArg(0)&#93;;</span></CodeLine>
<Link id="l06659" /><CodeLine lineNumber="6659"><span class="doxyHighlight">      DestExpr.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NewIndex);</span></CodeLine>
<Link id="l06660" /><CodeLine lineNumber="6660"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06661" /><CodeLine lineNumber="6661"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06662" /><CodeLine lineNumber="6662"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l06663" /><CodeLine lineNumber="6663"></CodeLine>
<Link id="l06664" /><CodeLine lineNumber="6664"><span class="doxyHighlightComment">/// Holds all the required data to salvage a dbg.value using the pre-LSR SCEVs</span></CodeLine>
<Link id="l06665" /><CodeLine lineNumber="6665"><span class="doxyHighlightComment">/// and DIExpression.</span></CodeLine>
<Link id="l06666" /><CodeLine lineNumber="6666" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a257452550319ec63f0ee22b1b51a6f7d">DVIRecoveryRec</a> &#123;</span></CodeLine>
<Link id="l06667" /><CodeLine lineNumber="6667" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a257452550319ec63f0ee22b1b51a6f7d"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a257452550319ec63f0ee22b1b51a6f7d">DVIRecoveryRec</a>(<a href="/docs/api/classes/llvm/dbgvalueinst">DbgValueInst</a> &#42;<a href="/docs/api/classes/livedebugvalues/dbgvalue">DbgValue</a>)</span></CodeLine>
<Link id="l06668" /><CodeLine lineNumber="6668"><span class="doxyHighlight">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a553ab2b381cedfabe8fe036dce1d0ef7">DbgRef</a>(<a href="/docs/api/classes/livedebugvalues/dbgvalue">DbgValue</a>), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a4e708234dce59260f06d8ea797bb02ac">Expr</a>(<a href="/docs/api/classes/livedebugvalues/dbgvalue">DbgValue</a>-&gt;getExpression()),</span></CodeLine>
<Link id="l06669" /><CodeLine lineNumber="6669"><span class="doxyHighlight">        <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af84ec7c45a639a818a0f1e4302282a39">HadLocationArgList</a>(<a href="/docs/api/namespaces/false">false</a>) &#123;&#125;</span></CodeLine>
<Link id="l06670" /><CodeLine lineNumber="6670" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1539ca80a2b86d985988d03787b3c83c"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1539ca80a2b86d985988d03787b3c83c">DVIRecoveryRec</a>(<a href="/docs/api/classes/llvm/dbgvariablerecord">DbgVariableRecord</a> &#42;DVR)</span></CodeLine>
<Link id="l06671" /><CodeLine lineNumber="6671"><span class="doxyHighlight">      : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a553ab2b381cedfabe8fe036dce1d0ef7">DbgRef</a>(DVR), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a4e708234dce59260f06d8ea797bb02ac">Expr</a>(DVR-&gt;getExpression()), <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af84ec7c45a639a818a0f1e4302282a39">HadLocationArgList</a>(<a href="/docs/api/namespaces/false">false</a>) &#123;&#125;</span></CodeLine>
<Link id="l06672" /><CodeLine lineNumber="6672"></CodeLine>
<Link id="l06673" /><CodeLine lineNumber="6673" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a553ab2b381cedfabe8fe036dce1d0ef7"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/pointerunion">PointerUnion&lt;DbgValueInst &#42;, DbgVariableRecord &#42;&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a553ab2b381cedfabe8fe036dce1d0ef7">DbgRef</a>;</span></CodeLine>
<Link id="l06674" /><CodeLine lineNumber="6674" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a4e708234dce59260f06d8ea797bb02ac"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/diexpression">DIExpression</a> &#42;<a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a4e708234dce59260f06d8ea797bb02ac">Expr</a>;</span></CodeLine>
<Link id="l06675" /><CodeLine lineNumber="6675" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af84ec7c45a639a818a0f1e4302282a39"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af84ec7c45a639a818a0f1e4302282a39">HadLocationArgList</a>;</span></CodeLine>
<Link id="l06676" /><CodeLine lineNumber="6676" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af395aaa694d852ba81d636ce8eb9ebd1"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WeakVH, 2&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af395aaa694d852ba81d636ce8eb9ebd1">LocationOps</a>;</span></CodeLine>
<Link id="l06677" /><CodeLine lineNumber="6677" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af54c2e7898cc927115bb676ca15cb6fb"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;const llvm::SCEV &#42;, 2&gt;</a> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#af54c2e7898cc927115bb676ca15cb6fb">SCEVs</a>;</span></CodeLine>
<Link id="l06678" /><CodeLine lineNumber="6678" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a9acdeb65c154488191ef5ba620e64125"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::unique&#95;ptr&lt;SCEVDbgValueBuilder&gt;</a>, 2&gt; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a9acdeb65c154488191ef5ba620e64125">RecoveryExprs</a>;</span></CodeLine>
<Link id="l06679" /><CodeLine lineNumber="6679"></CodeLine>
<Link id="l06680" /><CodeLine lineNumber="6680" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1f1964f2d7132dd4b5a4aa871d765465"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1f1964f2d7132dd4b5a4aa871d765465">clear</a>() &#123;</span></CodeLine>
<Link id="l06681" /><CodeLine lineNumber="6681"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;RE : <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a9acdeb65c154488191ef5ba620e64125">RecoveryExprs</a>)</span></CodeLine>
<Link id="l06682" /><CodeLine lineNumber="6682"><span class="doxyHighlight">      RE.reset();</span></CodeLine>
<Link id="l06683" /><CodeLine lineNumber="6683"><span class="doxyHighlight">    <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a9acdeb65c154488191ef5ba620e64125">RecoveryExprs</a>.clear();</span></CodeLine>
<Link id="l06684" /><CodeLine lineNumber="6684"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06685" /><CodeLine lineNumber="6685"></CodeLine>
<Link id="l06686" /><CodeLine lineNumber="6686" lineLink="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#aa935bd072ea71a4c50979580de6f13ed"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#aa935bd072ea71a4c50979580de6f13ed">~DVIRecoveryRec</a>() &#123; <a href="/docs/api/structs/anonymous-namespace-loopstrengthreduce-cpp-/dvirecoveryrec/#a1f1964f2d7132dd4b5a4aa871d765465">clear</a>(); &#125;</span></CodeLine>
<Link id="l06687" /><CodeLine lineNumber="6687"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l06688" /><CodeLine lineNumber="6688"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// namespace</span></CodeLine>
<Link id="l06689" /><CodeLine lineNumber="6689"></CodeLine>
<Link id="l06690" /><CodeLine lineNumber="6690"><span class="doxyHighlightComment">/// Returns the total number of DW&#95;OP&#95;llvm&#95;arg operands in the expression.</span></CodeLine>
<Link id="l06691" /><CodeLine lineNumber="6691"><span class="doxyHighlightComment">/// This helps in determining if a DIArglist is necessary or can be omitted from</span></CodeLine>
<Link id="l06692" /><CodeLine lineNumber="6692"><span class="doxyHighlightComment">/// the dbg.value.</span></CodeLine>
<Link id="l06693" /><CodeLine lineNumber="6693" lineLink="#a80e922a79a22107b2f70e851825d098e"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a>(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;Expr) &#123;</span></CodeLine>
<Link id="l06694" /><CodeLine lineNumber="6694"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> expr&#95;ops = <a href="/docs/api/namespaces/anonymous-loopstrengthreduce-cpp-/#a391c5efa7f6eb049718971aeeb9b71d5">ToDwarfOpIter</a>(Expr);</span></CodeLine>
<Link id="l06695" /><CodeLine lineNumber="6695"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a> = 0;</span></CodeLine>
<Link id="l06696" /><CodeLine lineNumber="6696"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : expr&#95;ops)</span></CodeLine>
<Link id="l06697" /><CodeLine lineNumber="6697"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getOp() == <a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>)</span></CodeLine>
<Link id="l06698" /><CodeLine lineNumber="6698"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a>++;</span></CodeLine>
<Link id="l06699" /><CodeLine lineNumber="6699"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a845e08be4b0320d66901a66b0c0e9509">Count</a>;</span></CodeLine>
<Link id="l06700" /><CodeLine lineNumber="6700"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06701" /><CodeLine lineNumber="6701"></CodeLine>
<Link id="l06702" /><CodeLine lineNumber="6702"><span class="doxyHighlightComment">/// Overwrites DVI with the location and Ops as the DIExpression. This will</span></CodeLine>
<Link id="l06703" /><CodeLine lineNumber="6703"><span class="doxyHighlightComment">/// create an invalid expression if Ops has any dwarf::DW&#95;OP&#95;llvm&#95;arg operands,</span></CodeLine>
<Link id="l06704" /><CodeLine lineNumber="6704"><span class="doxyHighlightComment">/// because a DIArglist is not created for the first argument of the dbg.value.</span></CodeLine>
<Link id="l06705" /><CodeLine lineNumber="6705"><span class="doxyHighlightKeyword">template</span><span class="doxyHighlight"> &lt;</span><span class="doxyHighlightKeyword">typename</span><span class="doxyHighlight"> T&gt;</span></CodeLine>
<Link id="l06706" /><CodeLine lineNumber="6706" lineLink="#a4d8f7ff97b22c5203b332a778c88b088"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="#a4d8f7ff97b22c5203b332a778c88b088">updateDVIWithLocation</a>(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a> &amp;DbgVal, <a href="/docs/api/classes/llvm/value">Value</a> &#42;Location,</span></CodeLine>
<Link id="l06707" /><CodeLine lineNumber="6707"><span class="doxyHighlight">                                  <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) &#123;</span></CodeLine>
<Link id="l06708" /><CodeLine lineNumber="6708"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) == 0 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Expected expression that does not &quot;</span></CodeLine>
<Link id="l06709" /><CodeLine lineNumber="6709"><span class="doxyHighlight">                                    </span><span class="doxyHighlightStringLiteral">&quot;contain any DW&#95;OP&#95;llvm&#95;arg operands.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06710" /><CodeLine lineNumber="6710"><span class="doxyHighlight">  DbgVal.setRawLocation(<a href="/docs/api/classes/llvm/valueasmetadata/#a53fc78b63202142110d0e86dd1a71fbe">ValueAsMetadata::get</a>(Location));</span></CodeLine>
<Link id="l06711" /><CodeLine lineNumber="6711"><span class="doxyHighlight">  DbgVal.setExpression(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DIExpression::get</a>(DbgVal.getContext(), <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</span></CodeLine>
<Link id="l06712" /><CodeLine lineNumber="6712"><span class="doxyHighlight">  DbgVal.setExpression(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DIExpression::get</a>(DbgVal.getContext(), <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</span></CodeLine>
<Link id="l06713" /><CodeLine lineNumber="6713"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06714" /><CodeLine lineNumber="6714"></CodeLine>
<Link id="l06715" /><CodeLine lineNumber="6715"><span class="doxyHighlightComment">/// Overwrite DVI with locations placed into a DIArglist.</span></CodeLine>
<Link id="l06716" /><CodeLine lineNumber="6716"><span class="doxyHighlightKeyword">template</span><span class="doxyHighlight"> &lt;</span><span class="doxyHighlightKeyword">typename</span><span class="doxyHighlight"> T&gt;</span></CodeLine>
<Link id="l06717" /><CodeLine lineNumber="6717" lineLink="#ab2e6fc08d8f586e4979511620c12ffa8"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="#ab2e6fc08d8f586e4979511620c12ffa8">updateDVIWithLocations</a>(<a href="/docs/api/files/lib/lib/target/lib/target/mips/mips16isellowering-cpp/#a0acb682b8260ab1c60b918599864e2e5">T</a> &amp;DbgVal,</span></CodeLine>
<Link id="l06718" /><CodeLine lineNumber="6718"><span class="doxyHighlight">                                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;Locations,</span></CodeLine>
<Link id="l06719" /><CodeLine lineNumber="6719"><span class="doxyHighlight">                                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) &#123;</span></CodeLine>
<Link id="l06720" /><CodeLine lineNumber="6720"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a>(<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) != 0 &amp;&amp;</span></CodeLine>
<Link id="l06721" /><CodeLine lineNumber="6721"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Expected expression that references DIArglist locations using &quot;</span></CodeLine>
<Link id="l06722" /><CodeLine lineNumber="6722"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;DW&#95;OP&#95;llvm&#95;arg operands.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06723" /><CodeLine lineNumber="6723"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ValueAsMetadata &#42;, 3&gt;</a> MetadataLocs;</span></CodeLine>
<Link id="l06724" /><CodeLine lineNumber="6724"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/value">Value</a> &#42;V : Locations)</span></CodeLine>
<Link id="l06725" /><CodeLine lineNumber="6725"><span class="doxyHighlight">    MetadataLocs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/classes/llvm/valueasmetadata/#a53fc78b63202142110d0e86dd1a71fbe">ValueAsMetadata::get</a>(V));</span></CodeLine>
<Link id="l06726" /><CodeLine lineNumber="6726"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ValArrayRef = <a href="/docs/api/classes/llvm/arrayref">llvm::ArrayRef&lt;llvm::ValueAsMetadata &#42;&gt;</a>(MetadataLocs);</span></CodeLine>
<Link id="l06727" /><CodeLine lineNumber="6727"><span class="doxyHighlight">  DbgVal.setRawLocation(<a href="/docs/api/classes/llvm/diarglist/#a51072a9980c37f5cce2a30e9dc4b3057">llvm::DIArgList::get</a>(DbgVal.getContext(), ValArrayRef));</span></CodeLine>
<Link id="l06728" /><CodeLine lineNumber="6728"><span class="doxyHighlight">  DbgVal.setExpression(<a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DIExpression::get</a>(DbgVal.getContext(), <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>));</span></CodeLine>
<Link id="l06729" /><CodeLine lineNumber="6729"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06730" /><CodeLine lineNumber="6730"></CodeLine>
<Link id="l06731" /><CodeLine lineNumber="6731"><span class="doxyHighlightComment">/// Write the new expression and new location ops for the dbg.value. If possible</span></CodeLine>
<Link id="l06732" /><CodeLine lineNumber="6732"><span class="doxyHighlightComment">/// reduce the szie of the dbg.value intrinsic by omitting DIArglist. This</span></CodeLine>
<Link id="l06733" /><CodeLine lineNumber="6733"><span class="doxyHighlightComment">/// can be omitted if:</span></CodeLine>
<Link id="l06734" /><CodeLine lineNumber="6734"><span class="doxyHighlightComment">/// 1 There is only a single location, refenced by a single DW&#95;OP&#95;llvm&#95;arg.</span></CodeLine>
<Link id="l06735" /><CodeLine lineNumber="6735"><span class="doxyHighlightComment">/// 2 The DW&#95;OP&#95;LLVM&#95;arg is the first operand in the expression.</span></CodeLine>
<Link id="l06736" /><CodeLine lineNumber="6736" lineLink="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0">UpdateDbgValueInst</a>(DVIRecoveryRec &amp;DVIRec,</span></CodeLine>
<Link id="l06737" /><CodeLine lineNumber="6737"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Value &#42;&gt;</a> &amp;NewLocationOps,</span></CodeLine>
<Link id="l06738" /><CodeLine lineNumber="6738"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;uint64&#95;t&gt;</a> &amp;<a href="/docs/api/classes/newexpr">NewExpr</a>) &#123;</span></CodeLine>
<Link id="l06739" /><CodeLine lineNumber="6739"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> UpdateDbgValueInstImpl = &#91;&amp;&#93;(</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;DbgVal) &#123;</span></CodeLine>
<Link id="l06740" /><CodeLine lineNumber="6740"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumLLVMArgs = <a href="#a80e922a79a22107b2f70e851825d098e">numLLVMArgOps</a>(<a href="/docs/api/classes/newexpr">NewExpr</a>);</span></CodeLine>
<Link id="l06741" /><CodeLine lineNumber="6741"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NumLLVMArgs == 0) &#123;</span></CodeLine>
<Link id="l06742" /><CodeLine lineNumber="6742"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Location assumed to be on the stack.</span></CodeLine>
<Link id="l06743" /><CodeLine lineNumber="6743"><span class="doxyHighlight">      <a href="#a4d8f7ff97b22c5203b332a778c88b088">updateDVIWithLocation</a>(&#42;DbgVal, NewLocationOps&#91;0&#93;, <a href="/docs/api/classes/newexpr">NewExpr</a>);</span></CodeLine>
<Link id="l06744" /><CodeLine lineNumber="6744"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NumLLVMArgs == 1 &amp;&amp; <a href="/docs/api/classes/newexpr">NewExpr</a>&#91;0&#93; == <a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>) &#123;</span></CodeLine>
<Link id="l06745" /><CodeLine lineNumber="6745"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// There is only a single DW&#95;OP&#95;llvm&#95;arg at the start of the expression,</span></CodeLine>
<Link id="l06746" /><CodeLine lineNumber="6746"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// so it can be omitted along with DIArglist.</span></CodeLine>
<Link id="l06747" /><CodeLine lineNumber="6747"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/newexpr">NewExpr</a>&#91;1&#93; == 0 &amp;&amp;</span></CodeLine>
<Link id="l06748" /><CodeLine lineNumber="6748"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Lone LLVM&#95;arg in a DIExpression should refer to location-op 0.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06749" /><CodeLine lineNumber="6749"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">llvm::SmallVector&lt;uint64&#95;t, 6&gt;</a> ShortenedOps(<a href="/docs/api/namespaces/llvm/#a02981de53fb6ffd384d39addc4d25f37">llvm::drop&#95;begin</a>(<a href="/docs/api/classes/newexpr">NewExpr</a>, 2));</span></CodeLine>
<Link id="l06750" /><CodeLine lineNumber="6750"><span class="doxyHighlight">      <a href="#a4d8f7ff97b22c5203b332a778c88b088">updateDVIWithLocation</a>(&#42;DbgVal, NewLocationOps&#91;0&#93;, ShortenedOps);</span></CodeLine>
<Link id="l06751" /><CodeLine lineNumber="6751"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l06752" /><CodeLine lineNumber="6752"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Multiple DW&#95;OP&#95;llvm&#95;arg, so DIArgList is strictly necessary.</span></CodeLine>
<Link id="l06753" /><CodeLine lineNumber="6753"><span class="doxyHighlight">      <a href="#ab2e6fc08d8f586e4979511620c12ffa8">updateDVIWithLocations</a>(&#42;DbgVal, NewLocationOps, <a href="/docs/api/classes/newexpr">NewExpr</a>);</span></CodeLine>
<Link id="l06754" /><CodeLine lineNumber="6754"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06755" /><CodeLine lineNumber="6755"></CodeLine>
<Link id="l06756" /><CodeLine lineNumber="6756"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the DIExpression was previously empty then add the stack terminator.</span></CodeLine>
<Link id="l06757" /><CodeLine lineNumber="6757"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Non-empty expressions have only had elements inserted into them and so</span></CodeLine>
<Link id="l06758" /><CodeLine lineNumber="6758"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the terminator should already be present e.g. stack&#95;value or fragment.</span></CodeLine>
<Link id="l06759" /><CodeLine lineNumber="6759"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/diexpression">DIExpression</a> &#42;SalvageExpr = DbgVal-&gt;getExpression();</span></CodeLine>
<Link id="l06760" /><CodeLine lineNumber="6760"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DVIRec.Expr-&gt;isComplex() &amp;&amp; SalvageExpr-&gt;<a href="/docs/api/classes/llvm/diexpression/#a7926734793677673e68d8cff410552ec">isComplex</a>()) &#123;</span></CodeLine>
<Link id="l06761" /><CodeLine lineNumber="6761"><span class="doxyHighlight">      SalvageExpr =</span></CodeLine>
<Link id="l06762" /><CodeLine lineNumber="6762"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/diexpression/#a15f4de7989cc83855e8f65792ae94bc4">DIExpression::append</a>(SalvageExpr, &#123;dwarf::DW&#95;OP&#95;stack&#95;value&#125;);</span></CodeLine>
<Link id="l06763" /><CodeLine lineNumber="6763"><span class="doxyHighlight">      DbgVal-&gt;setExpression(SalvageExpr);</span></CodeLine>
<Link id="l06764" /><CodeLine lineNumber="6764"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06765" /><CodeLine lineNumber="6765"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l06766" /><CodeLine lineNumber="6766"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef))</span></CodeLine>
<Link id="l06767" /><CodeLine lineNumber="6767"><span class="doxyHighlight">    UpdateDbgValueInstImpl(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef));</span></CodeLine>
<Link id="l06768" /><CodeLine lineNumber="6768"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l06769" /><CodeLine lineNumber="6769"><span class="doxyHighlight">    UpdateDbgValueInstImpl(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgVariableRecord &#42;&gt;</a>(DVIRec.DbgRef));</span></CodeLine>
<Link id="l06770" /><CodeLine lineNumber="6770"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06771" /><CodeLine lineNumber="6771"></CodeLine>
<Link id="l06772" /><CodeLine lineNumber="6772"><span class="doxyHighlightComment">/// Cached location ops may be erased during LSR, in which case a poison is</span></CodeLine>
<Link id="l06773" /><CodeLine lineNumber="6773"><span class="doxyHighlightComment">/// required when restoring from the cache. The type of that location is no</span></CodeLine>
<Link id="l06774" /><CodeLine lineNumber="6774"><span class="doxyHighlightComment">/// longer available, so just use int8. The poison will be replaced by one or</span></CodeLine>
<Link id="l06775" /><CodeLine lineNumber="6775"><span class="doxyHighlightComment">/// more locations later when a SCEVDbgValueBuilder selects alternative</span></CodeLine>
<Link id="l06776" /><CodeLine lineNumber="6776"><span class="doxyHighlightComment">/// locations to use for the salvage.</span></CodeLine>
<Link id="l06777" /><CodeLine lineNumber="6777" lineLink="#a7c340cc26f0c6d27219747cac55a2dc2"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/value">Value</a> &#42;<a href="#a7c340cc26f0c6d27219747cac55a2dc2">getValueOrPoison</a>(<a href="/docs/api/classes/llvm/weakvh">WeakVH</a> &amp;VH, <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>) &#123;</span></CodeLine>
<Link id="l06778" /><CodeLine lineNumber="6778"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> (VH) ? VH : <a href="/docs/api/classes/llvm/poisonvalue/#a1bf08613fb664a2e377a9a72c59a6b66">PoisonValue::get</a>(<a href="/docs/api/classes/llvm/type/#a7ba5de75f50bb4a4ba920698edf39b28">llvm::Type::getInt8Ty</a>(<a href="/docs/api/namespaces/llvm/callingconv/#ac6aa1387c4375260e2468eb5a77fdb4cafd841a49aec1539bc88abc8ff9e170fb">C</a>));</span></CodeLine>
<Link id="l06779" /><CodeLine lineNumber="6779"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06780" /><CodeLine lineNumber="6780"></CodeLine>
<Link id="l06781" /><CodeLine lineNumber="6781"><span class="doxyHighlightComment">/// Restore the DVI&#39;s pre-LSR arguments. Substitute undef for any erased values.</span></CodeLine>
<Link id="l06782" /><CodeLine lineNumber="6782" lineLink="#a196b104079c33f7ccd4ad4816376b9a7"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="#a196b104079c33f7ccd4ad4816376b9a7">restorePreTransformState</a>(DVIRecoveryRec &amp;DVIRec) &#123;</span></CodeLine>
<Link id="l06783" /><CodeLine lineNumber="6783"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> RestorePreTransformStateImpl = &#91;&amp;&#93;(</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;DbgVal) &#123;</span></CodeLine>
<Link id="l06784" /><CodeLine lineNumber="6784"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: restore dbg.value to pre-LSR state\\n&quot;</span></CodeLine>
<Link id="l06785" /><CodeLine lineNumber="6785"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: post-LSR: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;DbgVal &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06786" /><CodeLine lineNumber="6786"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVIRec.Expr &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Expected an expression&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06787" /><CodeLine lineNumber="6787"><span class="doxyHighlight">    DbgVal-&gt;setExpression(DVIRec.Expr);</span></CodeLine>
<Link id="l06788" /><CodeLine lineNumber="6788"></CodeLine>
<Link id="l06789" /><CodeLine lineNumber="6789"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Even a single location-op may be inside a DIArgList and referenced with</span></CodeLine>
<Link id="l06790" /><CodeLine lineNumber="6790"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// DW&#95;OP&#95;LLVM&#95;arg, which is valid only with a DIArgList.</span></CodeLine>
<Link id="l06791" /><CodeLine lineNumber="6791"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DVIRec.HadLocationArgList) &#123;</span></CodeLine>
<Link id="l06792" /><CodeLine lineNumber="6792"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVIRec.LocationOps.size() == 1 &amp;&amp;</span></CodeLine>
<Link id="l06793" /><CodeLine lineNumber="6793"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Unexpected number of location ops.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06794" /><CodeLine lineNumber="6794"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// LSR&#39;s unsuccessful salvage attempt may have added DIArgList, which in</span></CodeLine>
<Link id="l06795" /><CodeLine lineNumber="6795"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// this case was not present before, so force the location back to a</span></CodeLine>
<Link id="l06796" /><CodeLine lineNumber="6796"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// single uncontained Value.</span></CodeLine>
<Link id="l06797" /><CodeLine lineNumber="6797"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/value">Value</a> &#42;CachedValue =</span></CodeLine>
<Link id="l06798" /><CodeLine lineNumber="6798"><span class="doxyHighlight">          <a href="#a7c340cc26f0c6d27219747cac55a2dc2">getValueOrPoison</a>(DVIRec.LocationOps&#91;0&#93;, DbgVal-&gt;getContext());</span></CodeLine>
<Link id="l06799" /><CodeLine lineNumber="6799"><span class="doxyHighlight">      DbgVal-&gt;setRawLocation(<a href="/docs/api/classes/llvm/valueasmetadata/#a53fc78b63202142110d0e86dd1a71fbe">ValueAsMetadata::get</a>(CachedValue));</span></CodeLine>
<Link id="l06800" /><CodeLine lineNumber="6800"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l06801" /><CodeLine lineNumber="6801"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ValueAsMetadata &#42;, 3&gt;</a> MetadataLocs;</span></CodeLine>
<Link id="l06802" /><CodeLine lineNumber="6802"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/weakvh">WeakVH</a> VH : DVIRec.LocationOps) &#123;</span></CodeLine>
<Link id="l06803" /><CodeLine lineNumber="6803"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/value">Value</a> &#42;CachedValue = <a href="#a7c340cc26f0c6d27219747cac55a2dc2">getValueOrPoison</a>(VH, DbgVal-&gt;getContext());</span></CodeLine>
<Link id="l06804" /><CodeLine lineNumber="6804"><span class="doxyHighlight">        MetadataLocs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/classes/llvm/valueasmetadata/#a53fc78b63202142110d0e86dd1a71fbe">ValueAsMetadata::get</a>(CachedValue));</span></CodeLine>
<Link id="l06805" /><CodeLine lineNumber="6805"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l06806" /><CodeLine lineNumber="6806"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ValArrayRef = <a href="/docs/api/classes/llvm/arrayref">llvm::ArrayRef&lt;llvm::ValueAsMetadata &#42;&gt;</a>(MetadataLocs);</span></CodeLine>
<Link id="l06807" /><CodeLine lineNumber="6807"><span class="doxyHighlight">      DbgVal-&gt;setRawLocation(</span></CodeLine>
<Link id="l06808" /><CodeLine lineNumber="6808"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/diarglist/#a51072a9980c37f5cce2a30e9dc4b3057">llvm::DIArgList::get</a>(DbgVal-&gt;getContext(), ValArrayRef));</span></CodeLine>
<Link id="l06809" /><CodeLine lineNumber="6809"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06810" /><CodeLine lineNumber="6810"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: pre-LSR: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;DbgVal &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06811" /><CodeLine lineNumber="6811"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l06812" /><CodeLine lineNumber="6812"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef))</span></CodeLine>
<Link id="l06813" /><CodeLine lineNumber="6813"><span class="doxyHighlight">    RestorePreTransformStateImpl(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef));</span></CodeLine>
<Link id="l06814" /><CodeLine lineNumber="6814"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l06815" /><CodeLine lineNumber="6815"><span class="doxyHighlight">    RestorePreTransformStateImpl(<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgVariableRecord &#42;&gt;</a>(DVIRec.DbgRef));</span></CodeLine>
<Link id="l06816" /><CodeLine lineNumber="6816"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06817" /><CodeLine lineNumber="6817"></CodeLine>
<Link id="l06818" /><CodeLine lineNumber="6818" lineLink="#a02cf9d6ac96ae27b406798da5c2eb7ea"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a02cf9d6ac96ae27b406798da5c2eb7ea">SalvageDVI</a>(<a href="/docs/api/classes/llvm/loop">llvm::Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</span></CodeLine>
<Link id="l06819" /><CodeLine lineNumber="6819"><span class="doxyHighlight">                       <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;LSRInductionVar, DVIRecoveryRec &amp;DVIRec,</span></CodeLine>
<Link id="l06820" /><CodeLine lineNumber="6820"><span class="doxyHighlight">                       </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;SCEVInductionVar,</span></CodeLine>
<Link id="l06821" /><CodeLine lineNumber="6821"><span class="doxyHighlight">                       SCEVDbgValueBuilder IterCountExpr) &#123;</span></CodeLine>
<Link id="l06822" /><CodeLine lineNumber="6822"></CodeLine>
<Link id="l06823" /><CodeLine lineNumber="6823"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef)</span></CodeLine>
<Link id="l06824" /><CodeLine lineNumber="6824"><span class="doxyHighlight">          ? !<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef)-&gt;isKillLocation()</span></CodeLine>
<Link id="l06825" /><CodeLine lineNumber="6825"><span class="doxyHighlight">          : !<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgVariableRecord &#42;&gt;</a>(DVIRec.DbgRef)-&gt;isKillLocation())</span></CodeLine>
<Link id="l06826" /><CodeLine lineNumber="6826"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06827" /><CodeLine lineNumber="6827"></CodeLine>
<Link id="l06828" /><CodeLine lineNumber="6828"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// LSR may have caused several changes to the dbg.value in the failed salvage</span></CodeLine>
<Link id="l06829" /><CodeLine lineNumber="6829"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// attempt. So restore the DIExpression, the location ops and also the</span></CodeLine>
<Link id="l06830" /><CodeLine lineNumber="6830"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// location ops format, which is always DIArglist for multiple ops, but only</span></CodeLine>
<Link id="l06831" /><CodeLine lineNumber="6831"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// sometimes for a single op.</span></CodeLine>
<Link id="l06832" /><CodeLine lineNumber="6832"><span class="doxyHighlight">  <a href="#a196b104079c33f7ccd4ad4816376b9a7">restorePreTransformState</a>(DVIRec);</span></CodeLine>
<Link id="l06833" /><CodeLine lineNumber="6833"></CodeLine>
<Link id="l06834" /><CodeLine lineNumber="6834"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// LocationOpIndexMap&#91;i&#93; will store the post-LSR location index of</span></CodeLine>
<Link id="l06835" /><CodeLine lineNumber="6835"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the non-optimised out location at pre-LSR index i.</span></CodeLine>
<Link id="l06836" /><CodeLine lineNumber="6836"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;int64&#95;t, 2&gt;</a> LocationOpIndexMap;</span></CodeLine>
<Link id="l06837" /><CodeLine lineNumber="6837"><span class="doxyHighlight">  LocationOpIndexMap.<a href="/docs/api/classes/llvm/smallvectorimpl/#a38c50aa8e3e9588f4f968c2e03a0cee0">assign</a>(DVIRec.LocationOps.size(), -1);</span></CodeLine>
<Link id="l06838" /><CodeLine lineNumber="6838"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Value &#42;, 2&gt;</a> NewLocationOps;</span></CodeLine>
<Link id="l06839" /><CodeLine lineNumber="6839"><span class="doxyHighlight">  NewLocationOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(LSRInductionVar);</span></CodeLine>
<Link id="l06840" /><CodeLine lineNumber="6840"></CodeLine>
<Link id="l06841" /><CodeLine lineNumber="6841"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0; i &lt; DVIRec.LocationOps.size(); i++) &#123;</span></CodeLine>
<Link id="l06842" /><CodeLine lineNumber="6842"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/weakvh">WeakVH</a> VH = DVIRec.LocationOps&#91;i&#93;;</span></CodeLine>
<Link id="l06843" /><CodeLine lineNumber="6843"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Place the locations not optimised out in the list first, avoiding</span></CodeLine>
<Link id="l06844" /><CodeLine lineNumber="6844"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// inserts later. The map is used to update the DIExpression&#39;s</span></CodeLine>
<Link id="l06845" /><CodeLine lineNumber="6845"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// DW&#95;OP&#95;LLVM&#95;arg arguments as the expression is updated.</span></CodeLine>
<Link id="l06846" /><CodeLine lineNumber="6846"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VH &amp;&amp; !<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;UndefValue&gt;</a>(VH)) &#123;</span></CodeLine>
<Link id="l06847" /><CodeLine lineNumber="6847"><span class="doxyHighlight">      NewLocationOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(VH);</span></CodeLine>
<Link id="l06848" /><CodeLine lineNumber="6848"><span class="doxyHighlight">      LocationOpIndexMap&#91;i&#93; = NewLocationOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() - 1;</span></CodeLine>
<Link id="l06849" /><CodeLine lineNumber="6849"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: Location index &quot;</span><span class="doxyHighlight"> &lt;&lt; i</span></CodeLine>
<Link id="l06850" /><CodeLine lineNumber="6850"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; now at index &quot;</span><span class="doxyHighlight"> &lt;&lt; LocationOpIndexMap&#91;i&#93; &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06851" /><CodeLine lineNumber="6851"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06852" /><CodeLine lineNumber="6852"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06853" /><CodeLine lineNumber="6853"></CodeLine>
<Link id="l06854" /><CodeLine lineNumber="6854"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// It&#39;s possible that a value referred to in the SCEV may have been</span></CodeLine>
<Link id="l06855" /><CodeLine lineNumber="6855"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// optimised out by LSR.</span></CodeLine>
<Link id="l06856" /><CodeLine lineNumber="6856"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.<a href="/docs/api/classes/llvm/scalarevolution/#af327db7ab1b1996680bd467f6ce109bc">containsErasedValue</a>(DVIRec.SCEVs&#91;i&#93;) ||</span></CodeLine>
<Link id="l06857" /><CodeLine lineNumber="6857"><span class="doxyHighlight">        SE.<a href="/docs/api/classes/llvm/scalarevolution/#aa8d280cc2c5792b3144274e675e36385">containsUndefs</a>(DVIRec.SCEVs&#91;i&#93;)) &#123;</span></CodeLine>
<Link id="l06858" /><CodeLine lineNumber="6858"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: SCEV for location at index: &quot;</span><span class="doxyHighlight"> &lt;&lt; i</span></CodeLine>
<Link id="l06859" /><CodeLine lineNumber="6859"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; refers to a location that is now undef or erased. &quot;</span></CodeLine>
<Link id="l06860" /><CodeLine lineNumber="6860"><span class="doxyHighlight">                           </span><span class="doxyHighlightStringLiteral">&quot;Salvage abandoned.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06861" /><CodeLine lineNumber="6861"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06862" /><CodeLine lineNumber="6862"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06863" /><CodeLine lineNumber="6863"></CodeLine>
<Link id="l06864" /><CodeLine lineNumber="6864"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: salvaging location at index &quot;</span><span class="doxyHighlight"> &lt;&lt; i</span></CodeLine>
<Link id="l06865" /><CodeLine lineNumber="6865"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; with SCEV: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;DVIRec.SCEVs&#91;i&#93; &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06866" /><CodeLine lineNumber="6866"></CodeLine>
<Link id="l06867" /><CodeLine lineNumber="6867"><span class="doxyHighlight">    DVIRec.RecoveryExprs&#91;i&#93; = std::make&#95;unique&lt;SCEVDbgValueBuilder&gt;();</span></CodeLine>
<Link id="l06868" /><CodeLine lineNumber="6868"><span class="doxyHighlight">    SCEVDbgValueBuilder &#42;SalvageExpr = DVIRec.RecoveryExprs&#91;i&#93;.get();</span></CodeLine>
<Link id="l06869" /><CodeLine lineNumber="6869"></CodeLine>
<Link id="l06870" /><CodeLine lineNumber="6870"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Create an offset-based salvage expression if possible, as it requires</span></CodeLine>
<Link id="l06871" /><CodeLine lineNumber="6871"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// less DWARF ops than an iteration count-based expression.</span></CodeLine>
<Link id="l06872" /><CodeLine lineNumber="6872"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (std::optional&lt;APInt&gt; <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> =</span></CodeLine>
<Link id="l06873" /><CodeLine lineNumber="6873"><span class="doxyHighlight">            SE.<a href="/docs/api/classes/llvm/scalarevolution/#ae0ca564918ec63a9b4d2229374fec747">computeConstantDifference</a>(DVIRec.SCEVs&#91;i&#93;, SCEVInductionVar)) &#123;</span></CodeLine>
<Link id="l06874" /><CodeLine lineNumber="6874"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>-&gt;getSignificantBits() &lt;= 64)</span></CodeLine>
<Link id="l06875" /><CodeLine lineNumber="6875"><span class="doxyHighlight">        SalvageExpr-&gt;createOffsetExpr(<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>-&gt;getSExtValue(), LSRInductionVar);</span></CodeLine>
<Link id="l06876" /><CodeLine lineNumber="6876"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l06877" /><CodeLine lineNumber="6877"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06878" /><CodeLine lineNumber="6878"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SalvageExpr-&gt;createIterCountExpr(DVIRec.SCEVs&#91;i&#93;, IterCountExpr,</span></CodeLine>
<Link id="l06879" /><CodeLine lineNumber="6879"><span class="doxyHighlight">                                                 SE))</span></CodeLine>
<Link id="l06880" /><CodeLine lineNumber="6880"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06881" /><CodeLine lineNumber="6881"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06882" /><CodeLine lineNumber="6882"></CodeLine>
<Link id="l06883" /><CodeLine lineNumber="6883"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Merge the DbgValueBuilder generated expressions and the original</span></CodeLine>
<Link id="l06884" /><CodeLine lineNumber="6884"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// DIExpression, place the result into an new vector.</span></CodeLine>
<Link id="l06885" /><CodeLine lineNumber="6885"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;uint64&#95;t, 3&gt;</a> <a href="/docs/api/classes/newexpr">NewExpr</a>;</span></CodeLine>
<Link id="l06886" /><CodeLine lineNumber="6886"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DVIRec.Expr-&gt;getNumElements() == 0) &#123;</span></CodeLine>
<Link id="l06887" /><CodeLine lineNumber="6887"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVIRec.RecoveryExprs.size() == 1 &amp;&amp;</span></CodeLine>
<Link id="l06888" /><CodeLine lineNumber="6888"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Expected only a single recovery expression for an empty &quot;</span></CodeLine>
<Link id="l06889" /><CodeLine lineNumber="6889"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;DIExpression.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06890" /><CodeLine lineNumber="6890"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVIRec.RecoveryExprs&#91;0&#93; &amp;&amp;</span></CodeLine>
<Link id="l06891" /><CodeLine lineNumber="6891"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Expected a SCEVDbgSalvageBuilder for location 0&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06892" /><CodeLine lineNumber="6892"><span class="doxyHighlight">    SCEVDbgValueBuilder &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a> = DVIRec.RecoveryExprs&#91;0&#93;.get();</span></CodeLine>
<Link id="l06893" /><CodeLine lineNumber="6893"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;appendToVectors(<a href="/docs/api/classes/newexpr">NewExpr</a>, NewLocationOps);</span></CodeLine>
<Link id="l06894" /><CodeLine lineNumber="6894"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06895" /><CodeLine lineNumber="6895"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : DVIRec.Expr-&gt;expr&#95;ops()) &#123;</span></CodeLine>
<Link id="l06896" /><CodeLine lineNumber="6896"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Most Ops needn&#39;t be updated.</span></CodeLine>
<Link id="l06897" /><CodeLine lineNumber="6897"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getOp() != <a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>) &#123;</span></CodeLine>
<Link id="l06898" /><CodeLine lineNumber="6898"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.appendToVector(<a href="/docs/api/classes/newexpr">NewExpr</a>);</span></CodeLine>
<Link id="l06899" /><CodeLine lineNumber="6899"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06900" /><CodeLine lineNumber="6900"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06901" /><CodeLine lineNumber="6901"></CodeLine>
<Link id="l06902" /><CodeLine lineNumber="6902"><span class="doxyHighlight">    uint64&#95;t LocationArgIndex = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getArg(0);</span></CodeLine>
<Link id="l06903" /><CodeLine lineNumber="6903"><span class="doxyHighlight">    SCEVDbgValueBuilder &#42;DbgBuilder =</span></CodeLine>
<Link id="l06904" /><CodeLine lineNumber="6904"><span class="doxyHighlight">        DVIRec.RecoveryExprs&#91;LocationArgIndex&#93;.get();</span></CodeLine>
<Link id="l06905" /><CodeLine lineNumber="6905"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The location doesn&#39;t have s SCEVDbgValueBuilder, so LSR did not</span></CodeLine>
<Link id="l06906" /><CodeLine lineNumber="6906"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// optimise it away. So just translate the argument to the updated</span></CodeLine>
<Link id="l06907" /><CodeLine lineNumber="6907"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// location index.</span></CodeLine>
<Link id="l06908" /><CodeLine lineNumber="6908"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DbgBuilder) &#123;</span></CodeLine>
<Link id="l06909" /><CodeLine lineNumber="6909"><span class="doxyHighlight">      <a href="/docs/api/classes/newexpr">NewExpr</a>.push&#95;back(<a href="/docs/api/namespaces/llvm/dwarf/#a78e9cb1527edb3cc1d1ee577257b5f0cadb24b626a6ff07a122e0df22e9857a3d">dwarf::DW&#95;OP&#95;LLVM&#95;arg</a>);</span></CodeLine>
<Link id="l06910" /><CodeLine lineNumber="6910"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LocationOpIndexMap&#91;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getArg(0)&#93; != -1 &amp;&amp;</span></CodeLine>
<Link id="l06911" /><CodeLine lineNumber="6911"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Expected a positive index for the location-op position.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06912" /><CodeLine lineNumber="6912"><span class="doxyHighlight">      <a href="/docs/api/classes/newexpr">NewExpr</a>.push&#95;back(LocationOpIndexMap&#91;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getArg(0)&#93;);</span></CodeLine>
<Link id="l06913" /><CodeLine lineNumber="6913"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06914" /><CodeLine lineNumber="6914"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06915" /><CodeLine lineNumber="6915"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The location has a recovery expression.</span></CodeLine>
<Link id="l06916" /><CodeLine lineNumber="6916"><span class="doxyHighlight">    DbgBuilder-&gt;appendToVectors(<a href="/docs/api/classes/newexpr">NewExpr</a>, NewLocationOps);</span></CodeLine>
<Link id="l06917" /><CodeLine lineNumber="6917"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06918" /><CodeLine lineNumber="6918"></CodeLine>
<Link id="l06919" /><CodeLine lineNumber="6919"><span class="doxyHighlight">  <a href="#ab8a7ab37beb2d225c6cb1e9c6c20d0d0">UpdateDbgValueInst</a>(DVIRec, NewLocationOps, <a href="/docs/api/classes/newexpr">NewExpr</a>);</span></CodeLine>
<Link id="l06920" /><CodeLine lineNumber="6920"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a92ca992e52dddc420f4b069cae06dfbe">isa&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef))</span></CodeLine>
<Link id="l06921" /><CodeLine lineNumber="6921"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: Updated DVI: &quot;</span></CodeLine>
<Link id="l06922" /><CodeLine lineNumber="6922"><span class="doxyHighlight">                      &lt;&lt; &#42;<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgValueInst &#42;&gt;</a>(DVIRec.DbgRef) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06923" /><CodeLine lineNumber="6923"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l06924" /><CodeLine lineNumber="6924"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: Updated DVI: &quot;</span></CodeLine>
<Link id="l06925" /><CodeLine lineNumber="6925"><span class="doxyHighlight">                      &lt;&lt; &#42;<a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;DbgVariableRecord &#42;&gt;</a>(DVIRec.DbgRef) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06926" /><CodeLine lineNumber="6926"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06927" /><CodeLine lineNumber="6927"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06928" /><CodeLine lineNumber="6928"></CodeLine>
<Link id="l06929" /><CodeLine lineNumber="6929"><span class="doxyHighlightComment">/// Obtain an expression for the iteration count, then attempt to salvage the</span></CodeLine>
<Link id="l06930" /><CodeLine lineNumber="6930"><span class="doxyHighlightComment">/// dbg.value intrinsics.</span></CodeLine>
<Link id="l06931" /><CodeLine lineNumber="6931" lineLink="#a9188ba3c048bf8057af2b2ac144b9f0f"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="#a9188ba3c048bf8057af2b2ac144b9f0f">DbgRewriteSalvageableDVIs</a>(</span></CodeLine>
<Link id="l06932" /><CodeLine lineNumber="6932"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/loop">llvm::Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE, <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;LSRInductionVar,</span></CodeLine>
<Link id="l06933" /><CodeLine lineNumber="6933"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt;std::unique&#95;ptr&lt;DVIRecoveryRec&gt;, 2&gt; &amp;DVIToUpdate) &#123;</span></CodeLine>
<Link id="l06934" /><CodeLine lineNumber="6934"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DVIToUpdate.empty())</span></CodeLine>
<Link id="l06935" /><CodeLine lineNumber="6935"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06936" /><CodeLine lineNumber="6936"></CodeLine>
<Link id="l06937" /><CodeLine lineNumber="6937"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">llvm::SCEV</a> &#42;SCEVInductionVar = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(LSRInductionVar);</span></CodeLine>
<Link id="l06938" /><CodeLine lineNumber="6938"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SCEVInductionVar &amp;&amp;</span></CodeLine>
<Link id="l06939" /><CodeLine lineNumber="6939"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Anticipated a SCEV for the post-LSR induction variable&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06940" /><CodeLine lineNumber="6940"></CodeLine>
<Link id="l06941" /><CodeLine lineNumber="6941"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;IVAddRec =</span></CodeLine>
<Link id="l06942" /><CodeLine lineNumber="6942"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(SCEVInductionVar)) &#123;</span></CodeLine>
<Link id="l06943" /><CodeLine lineNumber="6943"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IVAddRec-&gt;isAffine())</span></CodeLine>
<Link id="l06944" /><CodeLine lineNumber="6944"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06945" /><CodeLine lineNumber="6945"></CodeLine>
<Link id="l06946" /><CodeLine lineNumber="6946"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Prevent translation using excessive resources.</span></CodeLine>
<Link id="l06947" /><CodeLine lineNumber="6947"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IVAddRec-&gt;getExpressionSize() &gt; <a href="#a35e8d876ca1d9ef72efaa8b320bd4f36">MaxSCEVSalvageExpressionSize</a>)</span></CodeLine>
<Link id="l06948" /><CodeLine lineNumber="6948"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06949" /><CodeLine lineNumber="6949"></CodeLine>
<Link id="l06950" /><CodeLine lineNumber="6950"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The iteration count is required to recover location values.</span></CodeLine>
<Link id="l06951" /><CodeLine lineNumber="6951"><span class="doxyHighlight">    SCEVDbgValueBuilder IterCountExpr;</span></CodeLine>
<Link id="l06952" /><CodeLine lineNumber="6952"><span class="doxyHighlight">    IterCountExpr.pushLocation(LSRInductionVar);</span></CodeLine>
<Link id="l06953" /><CodeLine lineNumber="6953"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IterCountExpr.SCEVToIterCountExpr(&#42;IVAddRec, SE))</span></CodeLine>
<Link id="l06954" /><CodeLine lineNumber="6954"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06955" /><CodeLine lineNumber="6955"></CodeLine>
<Link id="l06956" /><CodeLine lineNumber="6956"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: IV SCEV: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;SCEVInductionVar</span></CodeLine>
<Link id="l06957" /><CodeLine lineNumber="6957"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l06958" /><CodeLine lineNumber="6958"></CodeLine>
<Link id="l06959" /><CodeLine lineNumber="6959"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;DVIRec : DVIToUpdate) &#123;</span></CodeLine>
<Link id="l06960" /><CodeLine lineNumber="6960"><span class="doxyHighlight">      <a href="#a02cf9d6ac96ae27b406798da5c2eb7ea">SalvageDVI</a>(L, SE, LSRInductionVar, &#42;DVIRec, SCEVInductionVar,</span></CodeLine>
<Link id="l06961" /><CodeLine lineNumber="6961"><span class="doxyHighlight">                 IterCountExpr);</span></CodeLine>
<Link id="l06962" /><CodeLine lineNumber="6962"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l06963" /><CodeLine lineNumber="6963"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l06964" /><CodeLine lineNumber="6964"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l06965" /><CodeLine lineNumber="6965"></CodeLine>
<Link id="l06966" /><CodeLine lineNumber="6966"><span class="doxyHighlightComment">/// Identify and cache salvageable DVI locations and expressions along with the</span></CodeLine>
<Link id="l06967" /><CodeLine lineNumber="6967"><span class="doxyHighlightComment">/// corresponding SCEV(s). Also ensure that the DVI is not deleted between</span></CodeLine>
<Link id="l06968" /><CodeLine lineNumber="6968"><span class="doxyHighlightComment">/// cacheing and salvaging.</span></CodeLine>
<Link id="l06969" /><CodeLine lineNumber="6969" lineLink="#a9766c807d5c90cf726463e300d0787d8"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="#a9766c807d5c90cf726463e300d0787d8">DbgGatherSalvagableDVI</a>(</span></CodeLine>
<Link id="l06970" /><CodeLine lineNumber="6970"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</span></CodeLine>
<Link id="l06971" /><CodeLine lineNumber="6971"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector</a>&lt;std::unique&#95;ptr&lt;DVIRecoveryRec&gt;, 2&gt; &amp;SalvageableDVISCEVs,</span></CodeLine>
<Link id="l06972" /><CodeLine lineNumber="6972"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallset">SmallSet</a>&lt;<a href="/docs/api/classes/llvm/assertingvh">AssertingVH&lt;DbgValueInst&gt;</a>, 2&gt; &amp;DVIHandles) &#123;</span></CodeLine>
<Link id="l06973" /><CodeLine lineNumber="6973"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a> : L-&gt;getBlocks()) &#123;</span></CodeLine>
<Link id="l06974" /><CodeLine lineNumber="6974"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>) &#123;</span></CodeLine>
<Link id="l06975" /><CodeLine lineNumber="6975"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ProcessDbgValue = &#91;&amp;&#93;(</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;DbgVal) -&gt; </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l06976" /><CodeLine lineNumber="6976"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Ensure that if any location op is undef that the dbg.vlue is not</span></CodeLine>
<Link id="l06977" /><CodeLine lineNumber="6977"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// cached.</span></CodeLine>
<Link id="l06978" /><CodeLine lineNumber="6978"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DbgVal-&gt;isKillLocation())</span></CodeLine>
<Link id="l06979" /><CodeLine lineNumber="6979"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06980" /><CodeLine lineNumber="6980"></CodeLine>
<Link id="l06981" /><CodeLine lineNumber="6981"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Check that the location op SCEVs are suitable for translation to</span></CodeLine>
<Link id="l06982" /><CodeLine lineNumber="6982"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// DIExpression.</span></CodeLine>
<Link id="l06983" /><CodeLine lineNumber="6983"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;HasTranslatableLocationOps =</span></CodeLine>
<Link id="l06984" /><CodeLine lineNumber="6984"><span class="doxyHighlight">            &#91;&amp;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;DbgValToTranslate) -&gt; </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l06985" /><CodeLine lineNumber="6985"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LocOp : DbgValToTranslate-&gt;location&#95;ops()) &#123;</span></CodeLine>
<Link id="l06986" /><CodeLine lineNumber="6986"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LocOp)</span></CodeLine>
<Link id="l06987" /><CodeLine lineNumber="6987"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06988" /><CodeLine lineNumber="6988"></CodeLine>
<Link id="l06989" /><CodeLine lineNumber="6989"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(LocOp-&gt;getType()))</span></CodeLine>
<Link id="l06990" /><CodeLine lineNumber="6990"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06991" /><CodeLine lineNumber="6991"></CodeLine>
<Link id="l06992" /><CodeLine lineNumber="6992"><span class="doxyHighlight">            </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scev">SCEV</a> &#42;S = SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(LocOp);</span></CodeLine>
<Link id="l06993" /><CodeLine lineNumber="6993"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SE.<a href="/docs/api/classes/llvm/scalarevolution/#aa8d280cc2c5792b3144274e675e36385">containsUndefs</a>(S))</span></CodeLine>
<Link id="l06994" /><CodeLine lineNumber="6994"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06995" /><CodeLine lineNumber="6995"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l06996" /><CodeLine lineNumber="6996"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l06997" /><CodeLine lineNumber="6997"><span class="doxyHighlight">        &#125;;</span></CodeLine>
<Link id="l06998" /><CodeLine lineNumber="6998"></CodeLine>
<Link id="l06999" /><CodeLine lineNumber="6999"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!HasTranslatableLocationOps(DbgVal))</span></CodeLine>
<Link id="l07000" /><CodeLine lineNumber="7000"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07001" /><CodeLine lineNumber="7001"></CodeLine>
<Link id="l07002" /><CodeLine lineNumber="7002"><span class="doxyHighlight">        std::unique&#95;ptr&lt;DVIRecoveryRec&gt; NewRec =</span></CodeLine>
<Link id="l07003" /><CodeLine lineNumber="7003"><span class="doxyHighlight">            std::make&#95;unique&lt;DVIRecoveryRec&gt;(DbgVal);</span></CodeLine>
<Link id="l07004" /><CodeLine lineNumber="7004"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Each location Op may need a SCEVDbgValueBuilder in order to recover</span></CodeLine>
<Link id="l07005" /><CodeLine lineNumber="7005"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// it. Pre-allocating a vector will enable quick lookups of the builder</span></CodeLine>
<Link id="l07006" /><CodeLine lineNumber="7006"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// later during the salvage.</span></CodeLine>
<Link id="l07007" /><CodeLine lineNumber="7007"><span class="doxyHighlight">        NewRec-&gt;RecoveryExprs.resize(DbgVal-&gt;getNumVariableLocationOps());</span></CodeLine>
<Link id="l07008" /><CodeLine lineNumber="7008"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LocOp : DbgVal-&gt;location&#95;ops()) &#123;</span></CodeLine>
<Link id="l07009" /><CodeLine lineNumber="7009"><span class="doxyHighlight">          NewRec-&gt;SCEVs.push&#95;back(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(LocOp));</span></CodeLine>
<Link id="l07010" /><CodeLine lineNumber="7010"><span class="doxyHighlight">          NewRec-&gt;LocationOps.push&#95;back(LocOp);</span></CodeLine>
<Link id="l07011" /><CodeLine lineNumber="7011"><span class="doxyHighlight">          NewRec-&gt;HadLocationArgList = DbgVal-&gt;hasArgList();</span></CodeLine>
<Link id="l07012" /><CodeLine lineNumber="7012"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l07013" /><CodeLine lineNumber="7013"><span class="doxyHighlight">        SalvageableDVISCEVs.push&#95;back(std::move(NewRec));</span></CodeLine>
<Link id="l07014" /><CodeLine lineNumber="7014"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07015" /><CodeLine lineNumber="7015"><span class="doxyHighlight">      &#125;;</span></CodeLine>
<Link id="l07016" /><CodeLine lineNumber="7016"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/dbgvariablerecord">DbgVariableRecord</a> &amp;DVR : <a href="/docs/api/namespaces/llvm/#ae876eb96b89c1afcc3e9cd285cc3f08c">filterDbgVars</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>.getDbgRecordRange())) &#123;</span></CodeLine>
<Link id="l07017" /><CodeLine lineNumber="7017"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DVR.isDbgValue() || DVR.isDbgAssign())</span></CodeLine>
<Link id="l07018" /><CodeLine lineNumber="7018"><span class="doxyHighlight">          ProcessDbgValue(&amp;DVR);</span></CodeLine>
<Link id="l07019" /><CodeLine lineNumber="7019"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l07020" /><CodeLine lineNumber="7020"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DVI = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;DbgValueInst&gt;</a>(&amp;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l07021" /><CodeLine lineNumber="7021"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DVI)</span></CodeLine>
<Link id="l07022" /><CodeLine lineNumber="7022"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07023" /><CodeLine lineNumber="7023"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ProcessDbgValue(DVI))</span></CodeLine>
<Link id="l07024" /><CodeLine lineNumber="7024"><span class="doxyHighlight">        DVIHandles.insert(DVI);</span></CodeLine>
<Link id="l07025" /><CodeLine lineNumber="7025"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l07026" /><CodeLine lineNumber="7026"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l07027" /><CodeLine lineNumber="7027"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l07028" /><CodeLine lineNumber="7028"></CodeLine>
<Link id="l07029" /><CodeLine lineNumber="7029"><span class="doxyHighlightComment">/// Ideally pick the PHI IV inserted by ScalarEvolutionExpander. As a fallback</span></CodeLine>
<Link id="l07030" /><CodeLine lineNumber="7030"><span class="doxyHighlightComment">/// any PHi from the loop header is usable, but may have less chance of</span></CodeLine>
<Link id="l07031" /><CodeLine lineNumber="7031"><span class="doxyHighlightComment">/// surviving subsequent transforms.</span></CodeLine>
<Link id="l07032" /><CodeLine lineNumber="7032" lineLink="#a6612c20f7ca23077265026ea4991e2b6"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;<a href="#a6612c20f7ca23077265026ea4991e2b6">GetInductionVariable</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</span></CodeLine>
<Link id="l07033" /><CodeLine lineNumber="7033"><span class="doxyHighlight">                                           </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRInstance &amp;LSR) &#123;</span></CodeLine>
<Link id="l07034" /><CodeLine lineNumber="7034"></CodeLine>
<Link id="l07035" /><CodeLine lineNumber="7035"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> IsSuitableIV = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>) &#123;</span></CodeLine>
<Link id="l07036" /><CodeLine lineNumber="7036"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SE.<a href="/docs/api/classes/llvm/scalarevolution/#a6d8769a72303e2b06ef63129cb231855">isSCEVable</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>-&gt;getType()))</span></CodeLine>
<Link id="l07037" /><CodeLine lineNumber="7037"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07038" /><CodeLine lineNumber="7038"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/scevaddrecexpr">SCEVAddRecExpr</a> &#42;Rec = <a href="/docs/api/namespaces/llvm/#a22eeee01734061ac1b31ccd994c49eef">dyn&#95;cast&lt;SCEVAddRecExpr&gt;</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>)))</span></CodeLine>
<Link id="l07039" /><CodeLine lineNumber="7039"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Rec-&gt;isAffine() &amp;&amp; !SE.<a href="/docs/api/classes/llvm/scalarevolution/#aa8d280cc2c5792b3144274e675e36385">containsUndefs</a>(SE.<a href="/docs/api/classes/llvm/scalarevolution/#a30bd18ac905eacf3601bc6a553a9ff49">getSCEV</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>));</span></CodeLine>
<Link id="l07040" /><CodeLine lineNumber="7040"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07041" /><CodeLine lineNumber="7041"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l07042" /><CodeLine lineNumber="7042"></CodeLine>
<Link id="l07043" /><CodeLine lineNumber="7043"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For now, just pick the first IV that was generated and inserted by</span></CodeLine>
<Link id="l07044" /><CodeLine lineNumber="7044"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ScalarEvolution. Ideally pick an IV that is unlikely to be optimised away</span></CodeLine>
<Link id="l07045" /><CodeLine lineNumber="7045"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// by subsequent transforms.</span></CodeLine>
<Link id="l07046" /><CodeLine lineNumber="7046"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/weakvh">WeakVH</a> &amp;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> : LSR.getScalarEvolutionIVs()) &#123;</span></CodeLine>
<Link id="l07047" /><CodeLine lineNumber="7047"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>)</span></CodeLine>
<Link id="l07048" /><CodeLine lineNumber="7048"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07049" /><CodeLine lineNumber="7049"></CodeLine>
<Link id="l07050" /><CodeLine lineNumber="7050"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// There should only be PHI node IVs.</span></CodeLine>
<Link id="l07051" /><CodeLine lineNumber="7051"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/phinode">PHINode</a> &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;PHINode&gt;</a>(&amp;&#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>);</span></CodeLine>
<Link id="l07052" /><CodeLine lineNumber="7052"></CodeLine>
<Link id="l07053" /><CodeLine lineNumber="7053"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsSuitableIV(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>))</span></CodeLine>
<Link id="l07054" /><CodeLine lineNumber="7054"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</span></CodeLine>
<Link id="l07055" /><CodeLine lineNumber="7055"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l07056" /><CodeLine lineNumber="7056"></CodeLine>
<Link id="l07057" /><CodeLine lineNumber="7057"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/phinode">PHINode</a> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : L.getHeader()-&gt;phis()) &#123;</span></CodeLine>
<Link id="l07058" /><CodeLine lineNumber="7058"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsSuitableIV(&amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>))</span></CodeLine>
<Link id="l07059" /><CodeLine lineNumber="7059"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</span></CodeLine>
<Link id="l07060" /><CodeLine lineNumber="7060"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l07061" /><CodeLine lineNumber="7061"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07062" /><CodeLine lineNumber="7062"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l07063" /><CodeLine lineNumber="7063"></CodeLine>
<Link id="l07064" /><CodeLine lineNumber="7064" lineLink="#ac33f356faceb9655cb64611d2971d24f"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#ac33f356faceb9655cb64611d2971d24f">ReduceLoopStrength</a>(<a href="/docs/api/classes/llvm/loop">Loop</a> &#42;L, <a href="/docs/api/classes/llvm/ivusers">IVUsers</a> &amp;IU, <a href="/docs/api/classes/llvm/scalarevolution">ScalarEvolution</a> &amp;SE,</span></CodeLine>
<Link id="l07065" /><CodeLine lineNumber="7065"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/dominatortree">DominatorTree</a> &amp;DT, <a href="/docs/api/classes/llvm/loopinfo">LoopInfo</a> &amp;LI,</span></CodeLine>
<Link id="l07066" /><CodeLine lineNumber="7066"><span class="doxyHighlight">                               </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targettransforminfo">TargetTransformInfo</a> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>,</span></CodeLine>
<Link id="l07067" /><CodeLine lineNumber="7067"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/assumptioncache">AssumptionCache</a> &amp;AC, <a href="/docs/api/classes/llvm/targetlibraryinfo">TargetLibraryInfo</a> &amp;TLI,</span></CodeLine>
<Link id="l07068" /><CodeLine lineNumber="7068"><span class="doxyHighlight">                               <a href="/docs/api/classes/llvm/memoryssa">MemorySSA</a> &#42;MSSA) &#123;</span></CodeLine>
<Link id="l07069" /><CodeLine lineNumber="7069"></CodeLine>
<Link id="l07070" /><CodeLine lineNumber="7070"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Debug preservation - before we start removing anything identify which DVI</span></CodeLine>
<Link id="l07071" /><CodeLine lineNumber="7071"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// meet the salvageable criteria and store their DIExpression and SCEVs.</span></CodeLine>
<Link id="l07072" /><CodeLine lineNumber="7072"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::unique&#95;ptr&lt;DVIRecoveryRec&gt;</a>, 2&gt; SalvageableDVIRecords;</span></CodeLine>
<Link id="l07073" /><CodeLine lineNumber="7073"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallset">SmallSet&lt;AssertingVH&lt;DbgValueInst&gt;</a>, 2&gt; DVIHandles;</span></CodeLine>
<Link id="l07074" /><CodeLine lineNumber="7074"><span class="doxyHighlight">  <a href="#a9766c807d5c90cf726463e300d0787d8">DbgGatherSalvagableDVI</a>(L, SE, SalvageableDVIRecords, DVIHandles);</span></CodeLine>
<Link id="l07075" /><CodeLine lineNumber="7075"></CodeLine>
<Link id="l07076" /><CodeLine lineNumber="7076"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07077" /><CodeLine lineNumber="7077"><span class="doxyHighlight">  std::unique&#95;ptr&lt;MemorySSAUpdater&gt; MSSAU;</span></CodeLine>
<Link id="l07078" /><CodeLine lineNumber="7078"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MSSA)</span></CodeLine>
<Link id="l07079" /><CodeLine lineNumber="7079"><span class="doxyHighlight">    MSSAU = std::make&#95;unique&lt;MemorySSAUpdater&gt;(MSSA);</span></CodeLine>
<Link id="l07080" /><CodeLine lineNumber="7080"></CodeLine>
<Link id="l07081" /><CodeLine lineNumber="7081"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Run the main LSR transformation.</span></CodeLine>
<Link id="l07082" /><CodeLine lineNumber="7082"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LSRInstance &amp;Reducer =</span></CodeLine>
<Link id="l07083" /><CodeLine lineNumber="7083"><span class="doxyHighlight">      LSRInstance(L, IU, SE, DT, LI, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AC, TLI, MSSAU.get());</span></CodeLine>
<Link id="l07084" /><CodeLine lineNumber="7084"><span class="doxyHighlight">  <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> |= Reducer.getChanged();</span></CodeLine>
<Link id="l07085" /><CodeLine lineNumber="7085"></CodeLine>
<Link id="l07086" /><CodeLine lineNumber="7086"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Remove any extra phis created by processing inner loops.</span></CodeLine>
<Link id="l07087" /><CodeLine lineNumber="7087"><span class="doxyHighlight">  <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> |= <a href="/docs/api/namespaces/llvm/#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(L-&gt;getHeader(), &amp;TLI, MSSAU.get());</span></CodeLine>
<Link id="l07088" /><CodeLine lineNumber="7088"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a94a7203d75d594f7012f80d9130dcadf">EnablePhiElim</a> &amp;&amp; L-&gt;isLoopSimplifyForm()) &#123;</span></CodeLine>
<Link id="l07089" /><CodeLine lineNumber="7089"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WeakTrackingVH, 16&gt;</a> DeadInsts;</span></CodeLine>
<Link id="l07090" /><CodeLine lineNumber="7090"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/datalayout">DataLayout</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = L-&gt;getHeader()-&gt;getDataLayout();</span></CodeLine>
<Link id="l07091" /><CodeLine lineNumber="7091"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/scevexpander">SCEVExpander</a> <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(SE, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, </span><span class="doxyHighlightStringLiteral">&quot;lsr&quot;</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l07092" /><CodeLine lineNumber="7092"><span class="doxyHighlightPreprocessor">#if LLVM&#95;ENABLE&#95;ABI&#95;BREAKING&#95;CHECKS</span></CodeLine>
<Link id="l07093" /><CodeLine lineNumber="7093"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.setDebugType(<a href="/docs/api/files/include/include/llvm/include/llvm/adt/genericcycleimpl-h/#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>);</span></CodeLine>
<Link id="l07094" /><CodeLine lineNumber="7094"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l07095" /><CodeLine lineNumber="7095"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> numFolded = <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.replaceCongruentIVs(L, &amp;DT, DeadInsts, &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>);</span></CodeLine>
<Link id="l07096" /><CodeLine lineNumber="7096"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clear();</span></CodeLine>
<Link id="l07097" /><CodeLine lineNumber="7097"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (numFolded) &#123;</span></CodeLine>
<Link id="l07098" /><CodeLine lineNumber="7098"><span class="doxyHighlight">      <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07099" /><CodeLine lineNumber="7099"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#abca8e2c525d8162fbcbb5b444cf04d21">RecursivelyDeleteTriviallyDeadInstructionsPermissive</a>(DeadInsts, &amp;TLI,</span></CodeLine>
<Link id="l07100" /><CodeLine lineNumber="7100"><span class="doxyHighlight">                                                           MSSAU.get());</span></CodeLine>
<Link id="l07101" /><CodeLine lineNumber="7101"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(L-&gt;getHeader(), &amp;TLI, MSSAU.get());</span></CodeLine>
<Link id="l07102" /><CodeLine lineNumber="7102"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l07103" /><CodeLine lineNumber="7103"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l07104" /><CodeLine lineNumber="7104"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// LSR may at times remove all uses of an induction variable from a loop.</span></CodeLine>
<Link id="l07105" /><CodeLine lineNumber="7105"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The only remaining use is the PHI in the exit block.</span></CodeLine>
<Link id="l07106" /><CodeLine lineNumber="7106"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// When this is the case, if the exit value of the IV can be calculated using</span></CodeLine>
<Link id="l07107" /><CodeLine lineNumber="7107"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// SCEV, we can replace the exit block PHI with the final value of the IV and</span></CodeLine>
<Link id="l07108" /><CodeLine lineNumber="7108"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// skip the updates in each loop iteration.</span></CodeLine>
<Link id="l07109" /><CodeLine lineNumber="7109"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (L-&gt;isRecursivelyLCSSAForm(DT, LI) &amp;&amp; L-&gt;getExitBlock()) &#123;</span></CodeLine>
<Link id="l07110" /><CodeLine lineNumber="7110"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;WeakTrackingVH, 16&gt;</a> DeadInsts;</span></CodeLine>
<Link id="l07111" /><CodeLine lineNumber="7111"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/datalayout">DataLayout</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = L-&gt;getHeader()-&gt;getDataLayout();</span></CodeLine>
<Link id="l07112" /><CodeLine lineNumber="7112"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/scevexpander">SCEVExpander</a> <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>(SE, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, </span><span class="doxyHighlightStringLiteral">&quot;lsr&quot;</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l07113" /><CodeLine lineNumber="7113"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> Rewrites = <a href="/docs/api/namespaces/llvm/#acb5b48f89efd60ea799bb09abc1971ba">rewriteLoopExitValues</a>(L, &amp;LI, &amp;TLI, &amp;SE, &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>, &amp;DT,</span></CodeLine>
<Link id="l07114" /><CodeLine lineNumber="7114"><span class="doxyHighlight">                                         <a href="/docs/api/namespaces/llvm/#ad711012ae6f56de75424c48f31538986a0cba5d71f8085f5b0bd4c61555d86bb6">UnusedIndVarInLoop</a>, DeadInsts);</span></CodeLine>
<Link id="l07115" /><CodeLine lineNumber="7115"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/codegen/virtregmap-cpp/#a1ad52109a2ff430460c8776286b97b2e">Rewriter</a>.clear();</span></CodeLine>
<Link id="l07116" /><CodeLine lineNumber="7116"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Rewrites) &#123;</span></CodeLine>
<Link id="l07117" /><CodeLine lineNumber="7117"><span class="doxyHighlight">      <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07118" /><CodeLine lineNumber="7118"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#abca8e2c525d8162fbcbb5b444cf04d21">RecursivelyDeleteTriviallyDeadInstructionsPermissive</a>(DeadInsts, &amp;TLI,</span></CodeLine>
<Link id="l07119" /><CodeLine lineNumber="7119"><span class="doxyHighlight">                                                           MSSAU.get());</span></CodeLine>
<Link id="l07120" /><CodeLine lineNumber="7120"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a64ecdacbd49f696216e772782a109945">DeleteDeadPHIs</a>(L-&gt;getHeader(), &amp;TLI, MSSAU.get());</span></CodeLine>
<Link id="l07121" /><CodeLine lineNumber="7121"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l07122" /><CodeLine lineNumber="7122"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l07123" /><CodeLine lineNumber="7123"></CodeLine>
<Link id="l07124" /><CodeLine lineNumber="7124"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SalvageableDVIRecords.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</span></CodeLine>
<Link id="l07125" /><CodeLine lineNumber="7125"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</span></CodeLine>
<Link id="l07126" /><CodeLine lineNumber="7126"></CodeLine>
<Link id="l07127" /><CodeLine lineNumber="7127"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Obtain relevant IVs and attempt to rewrite the salvageable DVIs with</span></CodeLine>
<Link id="l07128" /><CodeLine lineNumber="7128"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// expressions composed using the derived iteration count.</span></CodeLine>
<Link id="l07129" /><CodeLine lineNumber="7129"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: Allow for multiple IV references for nested AddRecSCEVs</span></CodeLine>
<Link id="l07130" /><CodeLine lineNumber="7130"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;L : LI) &#123;</span></CodeLine>
<Link id="l07131" /><CodeLine lineNumber="7131"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/phinode">llvm::PHINode</a> &#42;<a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a> = <a href="#a6612c20f7ca23077265026ea4991e2b6">GetInductionVariable</a>(&#42;L, SE, Reducer))</span></CodeLine>
<Link id="l07132" /><CodeLine lineNumber="7132"><span class="doxyHighlight">      <a href="#a9188ba3c048bf8057af2b2ac144b9f0f">DbgRewriteSalvageableDVIs</a>(L, SE, <a href="/docs/api/files/lib/lib/support/lib/support/blake3/blake3-impl-h/#a78823051d1dad34b9b3d8120112e674d">IV</a>, SalvageableDVIRecords);</span></CodeLine>
<Link id="l07133" /><CodeLine lineNumber="7133"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l07134" /><CodeLine lineNumber="7134"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;scev-salvage: SCEV salvaging not possible. An IV &quot;</span></CodeLine>
<Link id="l07135" /><CodeLine lineNumber="7135"><span class="doxyHighlight">                           </span><span class="doxyHighlightStringLiteral">&quot;could not be identified.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l07136" /><CodeLine lineNumber="7136"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l07137" /><CodeLine lineNumber="7137"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l07138" /><CodeLine lineNumber="7138"></CodeLine>
<Link id="l07139" /><CodeLine lineNumber="7139"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Rec : SalvageableDVIRecords)</span></CodeLine>
<Link id="l07140" /><CodeLine lineNumber="7140"><span class="doxyHighlight">    Rec-&gt;clear();</span></CodeLine>
<Link id="l07141" /><CodeLine lineNumber="7141"><span class="doxyHighlight">  SalvageableDVIRecords.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l07142" /><CodeLine lineNumber="7142"><span class="doxyHighlight">  DVIHandles.<a href="/docs/api/classes/llvm/smallset/#a76b3fc7c102561fb5210d5151531e409">clear</a>();</span></CodeLine>
<Link id="l07143" /><CodeLine lineNumber="7143"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</span></CodeLine>
<Link id="l07144" /><CodeLine lineNumber="7144"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l07145" /><CodeLine lineNumber="7145"></CodeLine>
<Link id="l07146" /><CodeLine lineNumber="7146"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> LoopStrengthReduce::runOnLoop(Loop &#42;L, LPPassManager &amp; </span><span class="doxyHighlightComment">/&#42;LPM&#42;/</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l07147" /><CodeLine lineNumber="7147"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/looppass/#ac97db8f0e4f4a0946dddf617f45f6c8b">skipLoop</a>(L))</span></CodeLine>
<Link id="l07148" /><CodeLine lineNumber="7148"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07149" /><CodeLine lineNumber="7149"></CodeLine>
<Link id="l07150" /><CodeLine lineNumber="7150"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;IU = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;IVUsersWrapperPass&gt;</a>().getIU();</span></CodeLine>
<Link id="l07151" /><CodeLine lineNumber="7151"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;SE = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;ScalarEvolutionWrapperPass&gt;</a>().getSE();</span></CodeLine>
<Link id="l07152" /><CodeLine lineNumber="7152"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;DT = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;DominatorTreeWrapperPass&gt;</a>().getDomTree();</span></CodeLine>
<Link id="l07153" /><CodeLine lineNumber="7153"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;LI = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;LoopInfoWrapperPass&gt;</a>().getLoopInfo();</span></CodeLine>
<Link id="l07154" /><CodeLine lineNumber="7154"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a> = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;TargetTransformInfoWrapperPass&gt;</a>().getTTI(</span></CodeLine>
<Link id="l07155" /><CodeLine lineNumber="7155"><span class="doxyHighlight">      &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getParent());</span></CodeLine>
<Link id="l07156" /><CodeLine lineNumber="7156"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;AC = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;AssumptionCacheTracker&gt;</a>().getAssumptionCache(</span></CodeLine>
<Link id="l07157" /><CodeLine lineNumber="7157"><span class="doxyHighlight">      &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getParent());</span></CodeLine>
<Link id="l07158" /><CodeLine lineNumber="7158"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;TLI = <a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;TargetLibraryInfoWrapperPass&gt;</a>().getTLI(</span></CodeLine>
<Link id="l07159" /><CodeLine lineNumber="7159"><span class="doxyHighlight">      &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>-&gt;getHeader()-&gt;getParent());</span></CodeLine>
<Link id="l07160" /><CodeLine lineNumber="7160"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;MSSAAnalysis = <a href="/docs/api/classes/llvm/pass/#af94c014e968489e96c7d4353a84ad7f5">getAnalysisIfAvailable&lt;MemorySSAWrapperPass&gt;</a>();</span></CodeLine>
<Link id="l07161" /><CodeLine lineNumber="7161"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/transforms/lib/transforms/scalar/earlycse-cpp/#a8dbb9a70b80f850edc8194bde1b5b305">MemorySSA</a> &#42;MSSA = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l07162" /><CodeLine lineNumber="7162"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MSSAAnalysis)</span></CodeLine>
<Link id="l07163" /><CodeLine lineNumber="7163"><span class="doxyHighlight">    MSSA = &amp;MSSAAnalysis-&gt;getMSSA();</span></CodeLine>
<Link id="l07164" /><CodeLine lineNumber="7164"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="#ac33f356faceb9655cb64611d2971d24f">ReduceLoopStrength</a>(L, IU, SE, DT, LI, <a href="/docs/api/namespaces/llvm/#aa0d69e81725c10fa5407f0bf34462068">TTI</a>, AC, TLI, MSSA);</span></CodeLine>
<Link id="l07165" /><CodeLine lineNumber="7165"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l07166" /><CodeLine lineNumber="7166"></CodeLine>
<Link id="l07167" /><CodeLine lineNumber="7167" lineLink="/docs/api/classes/llvm/loopstrengthreducepass/#a4e475c0fcd6ade09109db20acb073a77"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/preservedanalyses">PreservedAnalyses</a> <a href="/docs/api/classes/llvm/loopstrengthreducepass/#a4e475c0fcd6ade09109db20acb073a77">LoopStrengthReducePass::run</a>(<a href="/docs/api/classes/llvm/loop">Loop</a> &amp;L, <a href="/docs/api/namespaces/llvm/#a58dde534a0ea2a23cb6c779c5c283f75">LoopAnalysisManager</a> &amp;AM,</span></CodeLine>
<Link id="l07168" /><CodeLine lineNumber="7168"><span class="doxyHighlight">                                              <a href="/docs/api/structs/llvm/loopstandardanalysisresults">LoopStandardAnalysisResults</a> &amp;AR,</span></CodeLine>
<Link id="l07169" /><CodeLine lineNumber="7169"><span class="doxyHighlight">                                              <a href="/docs/api/classes/llvm/lpmupdater">LPMUpdater</a> &amp;) &#123;</span></CodeLine>
<Link id="l07170" /><CodeLine lineNumber="7170"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#ac33f356faceb9655cb64611d2971d24f">ReduceLoopStrength</a>(&amp;L, AM.<a href="/docs/api/classes/llvm/analysismanager/#aaab1fad63e4f3b8679469720a873fedd">getResult</a>&lt;<a href="/docs/api/classes/llvm/ivusersanalysis">IVUsersAnalysis</a>&gt;(L, AR), AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a124376878e24aef4252795ba9fea420f">SE</a>,</span></CodeLine>
<Link id="l07171" /><CodeLine lineNumber="7171"><span class="doxyHighlight">                          AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#aaa96df870a1b3d7ffc56bec3eb0b0cff">DT</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#aa09379aa4435be95eb717dd9b5d8b4c5">LI</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a3444a9359f5f17f1694f82c41d5fd574">TTI</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a902b4712394a3b3450893634b3302893">AC</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a9e363c1eaf112166372e2d52704981fb">TLI</a>, AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a1cfb392c267da10531478c2f42baa603">MSSA</a>))</span></CodeLine>
<Link id="l07172" /><CodeLine lineNumber="7172"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/preservedanalyses/#a1258a1ff55557c27684010ebd7283712">PreservedAnalyses::all</a>();</span></CodeLine>
<Link id="l07173" /><CodeLine lineNumber="7173"></CodeLine>
<Link id="l07174" /><CodeLine lineNumber="7174"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> PA = <a href="/docs/api/namespaces/llvm/#ac7294ba4e105807674fe3a394437fcc1">getLoopPassPreservedAnalyses</a>();</span></CodeLine>
<Link id="l07175" /><CodeLine lineNumber="7175"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AR.<a href="/docs/api/structs/llvm/loopstandardanalysisresults/#a1cfb392c267da10531478c2f42baa603">MSSA</a>)</span></CodeLine>
<Link id="l07176" /><CodeLine lineNumber="7176"><span class="doxyHighlight">    PA.preserve&lt;<a href="/docs/api/classes/llvm/memoryssaanalysis">MemorySSAAnalysis</a>&gt;();</span></CodeLine>
<Link id="l07177" /><CodeLine lineNumber="7177"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> PA;</span></CodeLine>
<Link id="l07178" /><CodeLine lineNumber="7178"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l07179" /><CodeLine lineNumber="7179"></CodeLine>
<Link id="l07180" /><CodeLine lineNumber="7180"><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-loopstrengthreduce-cpp-/loopstrengthreduce/#a70f981eb6b8f2c9553421cc07b98f8e5">LoopStrengthReduce::ID</a> = 0;</span></CodeLine>
<Link id="l07181" /><CodeLine lineNumber="7181"></CodeLine>
<Link id="l07182" /><CodeLine lineNumber="7182" lineLink="#a0cf26a507ec1ff72dd6624ac9b69d05c"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE&#95;PASS&#95;BEGIN</a>(LoopStrengthReduce, </span><span class="doxyHighlightStringLiteral">&quot;loop-reduce&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l07183" /><CodeLine lineNumber="7183"><span class="doxyHighlight">                      </span><span class="doxyHighlightStringLiteral">&quot;Loop Strength Reduction&quot;</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l07184" /><CodeLine lineNumber="7184"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/targettransforminfowrapperpass">TargetTransformInfoWrapperPass</a>)</span></CodeLine>
<Link id="l07185" /><CodeLine lineNumber="7185"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/dominatortreewrapperpass">DominatorTreeWrapperPass</a>)</span></CodeLine>
<Link id="l07186" /><CodeLine lineNumber="7186"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/scalarevolutionwrapperpass">ScalarEvolutionWrapperPass</a>)</span></CodeLine>
<Link id="l07187" /><CodeLine lineNumber="7187"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/ivuserswrapperpass">IVUsersWrapperPass</a>)</span></CodeLine>
<Link id="l07188" /><CodeLine lineNumber="7188"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/loopinfowrapperpass">LoopInfoWrapperPass</a>)</span></CodeLine>
<Link id="l07189" /><CodeLine lineNumber="7189"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(LoopSimplify)</span></CodeLine>
<Link id="l07190" /><CodeLine lineNumber="7190" lineLink="#a6d827fc34f1b4371a0b7183d3ca5bcac"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a74ce8276b89067e806f67c45a6d92575">INITIALIZE&#95;PASS&#95;END</a>(LoopStrengthReduce, </span><span class="doxyHighlightStringLiteral">&quot;loop-reduce&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l07191" /><CodeLine lineNumber="7191" lineLink="#a81103f81d98fb1888c83e3f13d71d043"><span class="doxyHighlight">                    </span><span class="doxyHighlightStringLiteral">&quot;Loop Strength Reduction&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/false">false</a>, <a href="/docs/api/namespaces/false">false</a>)</span></CodeLine>
<Link id="l07192" /><CodeLine lineNumber="7192"></CodeLine>
<Link id="l07193" /><CodeLine lineNumber="7193" lineLink="/docs/api/namespaces/llvm/#ab5e38bfb20e37867b8f1c51c75a38a0a"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/pass">Pass</a> &#42;<a href="/docs/api/namespaces/llvm">llvm</a>::<a href="/docs/api/namespaces/llvm/#ab5e38bfb20e37867b8f1c51c75a38a0a">createLoopStrengthReducePass</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> LoopStrengthReduce(); &#125;</span></CodeLine>

</ProgramListing>


</DoxygenPage>
