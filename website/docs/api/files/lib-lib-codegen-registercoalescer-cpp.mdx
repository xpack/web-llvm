---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/files/lib/lib/codegen/registercoalescer-cpp
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - file

---

import Link from '@docusaurus/Link'

import CodeLine from '@xpack/docusaurus-plugin-doxygen/components/CodeLine'
import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import IncludesList from '@xpack/docusaurus-plugin-doxygen/components/IncludesList'
import IncludesListItem from '@xpack/docusaurus-plugin-doxygen/components/IncludesListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import ProgramListing from '@xpack/docusaurus-plugin-doxygen/components/ProgramListing'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'
import SectionUser from '@xpack/docusaurus-plugin-doxygen/components/SectionUser'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `RegisterCoalescer.cpp` File Reference

<DoxygenPage pluginConfig={pluginConfig}>



## Included Headers

<IncludesList>
<IncludesListItem
  filePath="RegisterCoalescer.h"
  permalink="/docs/api/files/lib/lib/codegen/registercoalescer-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/ArrayRef.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/arrayref-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/BitVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/bitvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/DenseSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/denseset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/STLExtras.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/stlextras-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallPtrSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallptrset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/Statistic.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Analysis/AliasAnalysis.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/analysis/aliasanalysis-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/LiveInterval.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/liveinterval-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/LiveIntervals.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/liveintervals-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/LiveRangeEdit.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/liverangeedit-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineBasicBlock.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machinebasicblock-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineFunction.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machinefunction-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineFunctionPass.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machinefunctionpass-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineInstr.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstr-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineInstrBuilder.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstrbuilder-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineLoopInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineloopinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineOperand.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineoperand-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineRegisterInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineregisterinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/Passes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/passes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/RegisterClassInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/registerclassinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/SlotIndexes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/slotindexes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetInstrInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetinstrinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetOpcodes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetopcodes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetRegisterInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetregisterinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetSubtargetInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetsubtargetinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DebugLoc.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/debugloc-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/InitializePasses.h"
  permalink="/docs/api/files/include/include/llvm/initializepasses-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/MC/LaneBitmask.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/mc/lanebitmask-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/MC/MCInstrDesc.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/mc/mcinstrdesc-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/MC/MCRegisterInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/mc/mcregisterinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Pass.h"
  permalink="/docs/api/files/include/include/llvm/pass-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/CommandLine.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Compiler.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Debug.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/debug-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/ErrorHandling.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/raw_ostream.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/raw-ostream-h"
  isLocal="true" />
<IncludesListItem
  filePath="algorithm"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cassert"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="iterator"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="limits"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="tuple"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="utility"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="vector"
  permalink=""
  isLocal="false" />
</IncludesList>

## Namespaces Index

<MembersIndex>

<MembersIndexItem
  type="namespace"
  name={<><a href="/docs/api/namespaces/anonymous-registercoalescer-cpp-">anonymous&#123;RegisterCoalescer.cpp&#125;</a></>}>
</MembersIndexItem>

</MembersIndex>

## Classes Index

<MembersIndex>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer">RegisterCoalescer</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/registercoalescer/phivalpos">PHIValPos</a></>}>
Position and VReg of a PHI instruction during coalescing. <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/registercoalescer/phivalpos/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a></>}>
Track information about values in a single virtual register about to be joined. <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/joinvals/val">Val</a></>}>
Per-value info for LI. <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/joinvals/val/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo">MBBPriorityInfo</a></>}>
Information concerning MBB coalescing priority. <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#details">More...</a>
</MembersIndexItem>

</MembersIndex>

## Functions Index

<MembersIndex>

<MembersIndexItem
  type={<>std::pair&lt; bool, bool &gt;</>}
  name={<><a href="#a61eeba1f176225faf4761e4d9b25cc43">addSegmentsWithValNo</a> (LiveRange &amp;Dst, VNInfo &#42;DstValNo, const LiveRange &amp;Src, const VNInfo &#42;SrcValNo)</>}>
Copy segments with value number <code>SrcValNo</code> from liverange <code>Src</code> to live range @Dst and use value number <code>DstValNo</code> there. <a href="#a61eeba1f176225faf4761e4d9b25cc43">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="int"
  name={<><a href="#a33f10720d78f213773cb15eacbf5c65a">compareMBBPriority</a> (const MBBPriorityInfo &#42;LHS, const MBBPriorityInfo &#42;RHS)</>}>
C-style comparator that sorts first based on the loop depth of the basic block (the unsigned), and then on the MBB number. <a href="#a33f10720d78f213773cb15eacbf5c65a">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#ac11097e2672b5d37ed48a38c9328142f">definesFullReg</a> (const MachineInstr &amp;MI, Register Reg)</>}>
Returns true if <code>MI</code> defines the full vreg <code>Reg</code>, as opposed to just defining a subregister. <a href="#ac11097e2672b5d37ed48a38c9328142f">More...</a>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#af060f5a17701ea45bc64cd57b59799e4">INITIALIZE&#95;PASS&#95;BEGIN</a> (RegisterCoalescer, &quot;register-coalescer&quot;, &quot;Register Coalescer&quot;, false, false) INITIALIZE&#95;PASS&#95;END(RegisterCoalescer</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a557a8b6ef8191908ae0c534f76b9f782">isDefInSubRange</a> (LiveInterval &amp;LI, SlotIndex Def)</>}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if any of the subranges of <code>LI</code> contain a definition at <code>Def</code>. <a href="#a557a8b6ef8191908ae0c534f76b9f782">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a643bfbd7372690fe71cc63171a3219bf">isLiveThrough</a> (const LiveQueryResult Q)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a272a95f31ec948e680a3c7dffd3c7f80">isLocalCopy</a> (MachineInstr &#42;Copy, const LiveIntervals &#42;LIS)</>}>
</MembersIndexItem>

<MembersIndexItem
  type={<>register <a href="/docs/api/classes/llvm/register">Register</a> static false bool</>}
  name={<><a href="#aaeffdea43602557f6c520f6b9501a491">isMoveInstr</a> (const TargetRegisterInfo &amp;tri, const MachineInstr &#42;MI, Register &amp;Src, Register &amp;Dst, unsigned &amp;SrcSub, unsigned &amp;DstSub)</>}>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a30f590c564c38a3893fcd46927b5e482">isSplitEdge</a> (const MachineBasicBlock &#42;MBB)</>}>
Return true if this block should be vacated by the coalescer to eliminate branches. <a href="#a30f590c564c38a3893fcd46927b5e482">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="bool"
  name={<><a href="#a68605e0cce17bf8b11fc0a3e9be11854">isTerminalReg</a> (Register DstReg, const MachineInstr &amp;Copy, const MachineRegisterInfo &#42;MRI)</>}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if DstReg is a terminal node. <a href="#a68605e0cce17bf8b11fc0a3e9be11854">More...</a>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a2a531965bccc744dd3526794c1f26390">STATISTIC</a> (numJoins, &quot;Number of interval joins performed&quot;)</>}>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a45c5d188bd58617bf1d24ce1b9f9e560">STATISTIC</a> (numCrossRCs, &quot;Number of cross class joins performed&quot;)</>}>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a19eb25ba15e3deaf79d97f9603655e58">STATISTIC</a> (numCommutes, &quot;Number of instruction commuting performed&quot;)</>}>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#afc8e30b34dafa6d72d5f655db9e013d0">STATISTIC</a> (numExtends, &quot;Number of copies extended&quot;)</>}>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a21ff086c8ce9357e9ec17ac889947bc3">STATISTIC</a> (NumReMats, &quot;Number of instructions re-materialized&quot;)</>}>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a6248e304069285dd1fe95bd913542a04">STATISTIC</a> (NumInflated, &quot;Number of register classes inflated&quot;)</>}>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a9fb5791828086e96e9e27b9ab592eb4a">STATISTIC</a> (NumLaneConflicts, &quot;Number of dead lane conflicts tested&quot;)</>}>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#a6ad1c14cb9ee12f218b5bfabf3f1855c">STATISTIC</a> (NumLaneResolves, &quot;Number of dead lane conflicts resolved&quot;)</>}>
</MembersIndexItem>

<MembersIndexItem
  name={<><a href="#aa031a11edde61e5e12654462e35b9f5b">STATISTIC</a> (NumShrinkToUses, &quot;Number of shrinkToUses called&quot;)</>}>
</MembersIndexItem>

</MembersIndex>

## Variables Index

<MembersIndex>

<MembersIndexItem
  type="register"
  name={<><a href="#a431319a3132451944eb1d97c9514e476">coalescer</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<>register <a href="/docs/api/classes/llvm/register">Register</a></>}
  name={<><a href="#a389c1946f85ea45762fef471b4c995f6">Coalescer</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44">cl::boolOrDefault</a> &gt;</>}
  name={<><a href="#a233a6770a940d2da877cafd1263f9dc8">EnableGlobalCopies</a></>}>
Temporary flag to test global copy optimization. <a href="#a233a6770a940d2da877cafd1263f9dc8">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#ab8ef19815a62704144427de2c79d058e">EnableJoining</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#ab3861763540aea165ffd7a63a0bc2f06">EnableJoinSplits</a></>}>
Temporary flag to test critical edge unsplitting. <a href="#ab3861763540aea165ffd7a63a0bc2f06">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type={<>register <a href="/docs/api/classes/llvm/register">Register</a></>}
  name={<><a href="#ac9760b36645d76b37de18e857c5c1e6e">false</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; unsigned &gt;</>}
  name={<><a href="#abb9db777c3bf00bfbc614a1f0539fb04">LargeIntervalFreqThreshold</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; unsigned &gt;</>}
  name={<><a href="#a4b2129a58164949cdd06be96232abbd3">LargeIntervalSizeThreshold</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; unsigned &gt;</>}
  name={<><a href="#ae4fcc7d618c726ebb208a5853442ce7e">LateRematUpdateThreshold</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#aec45e8545effa6685109d97842d8572a">UseTerminalRule</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#aa8b58294e993b77e8215298b1ef440a6">VerifyCoalescing</a></>}>
</MembersIndexItem>

</MembersIndex>

## Defines Index

<MembersIndex>

<MembersIndexItem
  type="#define"
  name={<><a href="#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>&nbsp;&nbsp;&nbsp;&quot;regalloc&quot;</>}>
</MembersIndexItem>

</MembersIndex>


<SectionDefinition>

## Functions

### addSegmentsWithValNo() {#a61eeba1f176225faf4761e4d9b25cc43}

<MemberDefinition
  prototype={<>static std::pair&lt; bool, bool &gt; addSegmentsWithValNo (<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp; Dst, <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42; DstValNo, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp; Src, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42; SrcValNo)</>}
  labels = {["static"]}>
Copy segments with value number <code>SrcValNo</code> from liverange <code>Src</code> to live range @Dst and use value number <code>DstValNo</code> there.

Definition at line <a href="#l00786">786</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### compareMBBPriority() {#a33f10720d78f213773cb15eacbf5c65a}

<MemberDefinition
  prototype={<>static int compareMBBPriority (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> MBBPriorityInfo &#42; LHS, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> MBBPriorityInfo &#42; RHS)</>}
  labels = {["static"]}>
C-style comparator that sorts first based on the loop depth of the basic block (the unsigned), and then on the MBB number.

EnableGlobalCopies assumes that the primary sort key is loop depth.

Definition at line <a href="#l03996">3996</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### definesFullReg() {#ac11097e2672b5d37ed48a38c9328142f}

<MemberDefinition
  prototype={<>static bool definesFullReg (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp; MI, <a href="/docs/api/classes/llvm/register">Register</a> Reg)</>}
  labels = {["static"]}>
Returns true if <code>MI</code> defines the full vreg <code>Reg</code>, as opposed to just defining a subregister.

Definition at line <a href="#l01279">1279</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### INITIALIZE&#95;PASS&#95;BEGIN() {#af060f5a17701ea45bc64cd57b59799e4}

<MemberDefinition
  prototype={<>INITIALIZE&#95;PASS&#95;BEGIN (RegisterCoalescer, &quot;register-coalescer&quot;, &quot;Register Coalescer&quot;, false, false)</>}>

Definition at line <a href="#l00406">406</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### isDefInSubRange() {#a557a8b6ef8191908ae0c534f76b9f782}

<MemberDefinition
  prototype={<>static bool isDefInSubRange (<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp; LI, <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> Def)</>}
  labels = {["static"]}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if any of the subranges of <code>LI</code> contain a definition at <code>Def</code>.

Definition at line <a href="#l03439">3439</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### isLiveThrough() {#a643bfbd7372690fe71cc63171a3219bf}

<MemberDefinition
  prototype={<>static bool isLiveThrough (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> Q)</>}
  labels = {["static"]}>

Definition at line <a href="#l03326">3326</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### isLocalCopy() {#a272a95f31ec948e680a3c7dffd3c7f80}

<MemberDefinition
  prototype={<>static bool isLocalCopy (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42; Copy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/liveintervals">LiveIntervals</a> &#42; LIS)</>}
  labels = {["static"]}>

<SectionUser title="Returns">
true if the given copy uses or defines a local live range.
</SectionUser>

Definition at line <a href="#l04018">4018</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### isMoveInstr() {#aaeffdea43602557f6c520f6b9501a491}

<MemberDefinition
  prototype={<>register Register static false bool isMoveInstr (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &amp; tri, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42; MI, <a href="/docs/api/classes/llvm/register">Register</a> &amp; Src, <a href="/docs/api/classes/llvm/register">Register</a> &amp; Dst, unsigned &amp; SrcSub, unsigned &amp; DstSub)</>}
  labels = {["nodiscard", "static"]}>

Definition at line <a href="#l00415">415</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### isSplitEdge() {#a30f590c564c38a3893fcd46927b5e482}

<MemberDefinition
  prototype={<>static bool isSplitEdge (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42; MBB)</>}
  labels = {["static"]}>
Return true if this block should be vacated by the coalescer to eliminate branches.

The important cases to handle in the coalescer are critical edges split during phi elimination which contain only copies. Simple blocks that contain non-branches should also be vacated, but this can be handled by an earlier pass similar to early if-conversion.

Definition at line <a href="#l00440">440</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### isTerminalReg() {#a68605e0cce17bf8b11fc0a3e9be11854}

<MemberDefinition
  prototype={<>static bool isTerminalReg (<a href="/docs/api/classes/llvm/register">Register</a> DstReg, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp; Copy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/machineregisterinfo">MachineRegisterInfo</a> &#42; MRI)</>}
  labels = {["static"]}>
<a href="/docs/api/namespaces/llvm/check">Check</a> if DstReg is a terminal node.

I.e., it does not have any affinity other than <code>Copy</code>.

Definition at line <a href="#l04081">4081</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#a2a531965bccc744dd3526794c1f26390}

<MemberDefinition
  prototype={<>STATISTIC (numJoins, &quot;Number of interval joins performed&quot;)</>}>

Definition at line <a href="#l00065">65</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#a45c5d188bd58617bf1d24ce1b9f9e560}

<MemberDefinition
  prototype={<>STATISTIC (numCrossRCs, &quot;Number of cross class joins performed&quot;)</>}>

Definition at line <a href="#l00066">66</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#a19eb25ba15e3deaf79d97f9603655e58}

<MemberDefinition
  prototype={<>STATISTIC (numCommutes, &quot;Number of instruction commuting performed&quot;)</>}>

Definition at line <a href="#l00067">67</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#afc8e30b34dafa6d72d5f655db9e013d0}

<MemberDefinition
  prototype={<>STATISTIC (numExtends, &quot;Number of <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/sifixsgprcopies-cpp/#a1d5e606e23fdf432583aa8dc1f17ff55">copies</a> extended&quot;)</>}>

Definition at line <a href="#l00068">68</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#a21ff086c8ce9357e9ec17ac889947bc3}

<MemberDefinition
  prototype={<>STATISTIC (NumReMats, &quot;Number of <a href="/docs/api/files/lib/lib/codegen/atomicexpandpass-cpp/#a1bcc06b1cb86bd0ea08f33323190bdaa">instructions</a> re-materialized&quot;)</>}>

Definition at line <a href="#l00069">69</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#a6248e304069285dd1fe95bd913542a04}

<MemberDefinition
  prototype={<>STATISTIC (NumInflated, &quot;Number of register classes inflated&quot;)</>}>

Definition at line <a href="#l00070">70</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#a9fb5791828086e96e9e27b9ab592eb4a}

<MemberDefinition
  prototype={<>STATISTIC (NumLaneConflicts, &quot;Number of dead lane conflicts tested&quot;)</>}>

Definition at line <a href="#l00071">71</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#a6ad1c14cb9ee12f218b5bfabf3f1855c}

<MemberDefinition
  prototype={<>STATISTIC (NumLaneResolves, &quot;Number of dead lane conflicts resolved&quot;)</>}>

Definition at line <a href="#l00072">72</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### STATISTIC() {#aa031a11edde61e5e12654462e35b9f5b}

<MemberDefinition
  prototype={<>STATISTIC (NumShrinkToUses, &quot;Number of <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a> called&quot;)</>}>

Definition at line <a href="#l00073">73</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Variables

### coalescer {#a431319a3132451944eb1d97c9514e476}

<MemberDefinition
  prototype="register coalescer">

Definition at line <a href="#l00412">412</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### Coalescer {#a389c1946f85ea45762fef471b4c995f6}

<MemberDefinition
  prototype="register Register Coalescer">

Definition at line <a href="#l00413">413</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### EnableGlobalCopies {#a233a6770a940d2da877cafd1263f9dc8}

<MemberDefinition
  prototype={<>cl::opt&lt; cl::boolOrDefault &gt; EnableGlobalCopies(&quot;join-globalcopies&quot;, cl::desc(&quot;Coalesce copies that span blocks (default=subtarget)&quot;), cl::init(cl::BOU&#95;UNSET), cl::Hidden)</>}
  labels = {["static"]}>
Temporary flag to test global copy optimization.

Definition at line <a href="#l00089">89</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### EnableJoining {#ab8ef19815a62704144427de2c79d058e}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; EnableJoining(&quot;join-liveintervals&quot;, cl::desc(&quot;Coalesce copies (default=true)&quot;), cl::init(true), cl::Hidden)</>}
  labels = {["static"]}>

Definition at line <a href="#l00075">75</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### EnableJoinSplits {#ab3861763540aea165ffd7a63a0bc2f06}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; EnableJoinSplits(&quot;join-splitedges&quot;, cl::desc(&quot;Coalesce copies on split edges (default=subtarget)&quot;), cl::Hidden)</>}
  labels = {["static"]}>
Temporary flag to test critical edge unsplitting.

Definition at line <a href="#l00084">84</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### false {#ac9760b36645d76b37de18e857c5c1e6e}

<MemberDefinition
  prototype="register Register false">

Definition at line <a href="#l00413">413</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### LargeIntervalFreqThreshold {#abb9db777c3bf00bfbc614a1f0539fb04}

<MemberDefinition
  prototype={<>cl::opt&lt; unsigned &gt; LargeIntervalFreqThreshold(&quot;large-interval-freq-threshold&quot;, cl::Hidden, cl::desc(&quot;For a large interval, if it is coalesced with other live &quot; &quot;intervals many times more than the threshold, stop its &quot; &quot;coalescing to control the compile time. &quot;), cl::init(256))</>}
  labels = {["static"]}>

Definition at line <a href="#l00114">114</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### LargeIntervalSizeThreshold {#a4b2129a58164949cdd06be96232abbd3}

<MemberDefinition
  prototype={<>cl::opt&lt; unsigned &gt; LargeIntervalSizeThreshold(&quot;large-interval-size-threshold&quot;, cl::Hidden, cl::desc(&quot;If the valnos size of an interval is larger than the threshold, &quot; &quot;it is regarded as a large interval. &quot;), cl::init(100))</>}
  labels = {["static"]}>

Definition at line <a href="#l00108">108</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### LateRematUpdateThreshold {#ae4fcc7d618c726ebb208a5853442ce7e}

<MemberDefinition
  prototype={<>cl::opt&lt; unsigned &gt; LateRematUpdateThreshold(&quot;late-remat-update-threshold&quot;, cl::Hidden, cl::desc(&quot;During rematerialization for a copy, if the def instruction has &quot; &quot;many other copy uses to be rematerialized, delay the multiple &quot; &quot;separate live interval update work and do them all at once after &quot; &quot;all those rematerialization are done. It will save a lot of &quot; &quot;repeated work. &quot;), cl::init(100))</>}
  labels = {["static"]}>

Definition at line <a href="#l00099">99</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### UseTerminalRule {#aec45e8545effa6685109d97842d8572a}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; UseTerminalRule(&quot;terminal-rule&quot;, cl::desc(&quot;Apply the terminal rule&quot;), cl::init(false), cl::Hidden)</>}
  labels = {["static"]}>

Definition at line <a href="#l00079">79</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

### VerifyCoalescing {#aa8b58294e993b77e8215298b1ef440a6}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; VerifyCoalescing(&quot;verify-coalescing&quot;, cl::desc(&quot;Verify machine instrs before and after register coalescing&quot;), cl::Hidden)</>}
  labels = {["static"]}>

Definition at line <a href="#l00094">94</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Defines

### DEBUG&#95;TYPE {#ad78e062f62e0d6e453941fb4ca843e4d}

<MemberDefinition
  prototype={<>#define DEBUG&#95;TYPE&nbsp;&nbsp;&nbsp;&quot;regalloc&quot;</>}>

Definition at line <a href="#l00063">63</a> of file <a href="/docs/api/files/lib/lib/codegen/registercoalescer-cpp">RegisterCoalescer.cpp</a>.
</MemberDefinition>

</SectionDefinition>

## File Listing

The file content with the documentation metadata removed is:

<ProgramListing>

<Link id="l00001" /><CodeLine lineNumber="1"><span class="doxyHighlightComment">//===- RegisterCoalescer.cpp - Generic Register Coalescing Interface ------===//</span></CodeLine>
<Link id="l00002" /><CodeLine lineNumber="2"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00003" /><CodeLine lineNumber="3"><span class="doxyHighlightComment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></CodeLine>
<Link id="l00004" /><CodeLine lineNumber="4"><span class="doxyHighlightComment">// See https://llvm.org/LICENSE.txt for license information.</span></CodeLine>
<Link id="l00005" /><CodeLine lineNumber="5"><span class="doxyHighlightComment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></CodeLine>
<Link id="l00006" /><CodeLine lineNumber="6"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00007" /><CodeLine lineNumber="7"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00008" /><CodeLine lineNumber="8"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00009" /><CodeLine lineNumber="9"><span class="doxyHighlightComment">// This file implements the generic RegisterCoalescer interface which</span></CodeLine>
<Link id="l00010" /><CodeLine lineNumber="10"><span class="doxyHighlightComment">// is used as the common interface used by all clients and</span></CodeLine>
<Link id="l00011" /><CodeLine lineNumber="11"><span class="doxyHighlightComment">// implementations of register coalescing.</span></CodeLine>
<Link id="l00012" /><CodeLine lineNumber="12"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00013" /><CodeLine lineNumber="13"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00014" /><CodeLine lineNumber="14"></CodeLine>
<Link id="l00015" /><CodeLine lineNumber="15"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/lib/lib/codegen/registercoalescer-h">RegisterCoalescer.h</a>&quot;</span></CodeLine>
<Link id="l00016" /><CodeLine lineNumber="16"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/arrayref-h">llvm/ADT/ArrayRef.h</a>&quot;</span></CodeLine>
<Link id="l00017" /><CodeLine lineNumber="17"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/bitvector-h">llvm/ADT/BitVector.h</a>&quot;</span></CodeLine>
<Link id="l00018" /><CodeLine lineNumber="18"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/denseset-h">llvm/ADT/DenseSet.h</a>&quot;</span></CodeLine>
<Link id="l00019" /><CodeLine lineNumber="19"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/stlextras-h">llvm/ADT/STLExtras.h</a>&quot;</span></CodeLine>
<Link id="l00020" /><CodeLine lineNumber="20"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallptrset-h">llvm/ADT/SmallPtrSet.h</a>&quot;</span></CodeLine>
<Link id="l00021" /><CodeLine lineNumber="21"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallvector-h">llvm/ADT/SmallVector.h</a>&quot;</span></CodeLine>
<Link id="l00022" /><CodeLine lineNumber="22"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h">llvm/ADT/Statistic.h</a>&quot;</span></CodeLine>
<Link id="l00023" /><CodeLine lineNumber="23"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/analysis/aliasanalysis-h">llvm/Analysis/AliasAnalysis.h</a>&quot;</span></CodeLine>
<Link id="l00024" /><CodeLine lineNumber="24"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/liveinterval-h">llvm/CodeGen/LiveInterval.h</a>&quot;</span></CodeLine>
<Link id="l00025" /><CodeLine lineNumber="25"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/liveintervals-h">llvm/CodeGen/LiveIntervals.h</a>&quot;</span></CodeLine>
<Link id="l00026" /><CodeLine lineNumber="26"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/liverangeedit-h">llvm/CodeGen/LiveRangeEdit.h</a>&quot;</span></CodeLine>
<Link id="l00027" /><CodeLine lineNumber="27"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machinebasicblock-h">llvm/CodeGen/MachineBasicBlock.h</a>&quot;</span></CodeLine>
<Link id="l00028" /><CodeLine lineNumber="28"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machinefunction-h">llvm/CodeGen/MachineFunction.h</a>&quot;</span></CodeLine>
<Link id="l00029" /><CodeLine lineNumber="29"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machinefunctionpass-h">llvm/CodeGen/MachineFunctionPass.h</a>&quot;</span></CodeLine>
<Link id="l00030" /><CodeLine lineNumber="30"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstr-h">llvm/CodeGen/MachineInstr.h</a>&quot;</span></CodeLine>
<Link id="l00031" /><CodeLine lineNumber="31"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstrbuilder-h">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</span></CodeLine>
<Link id="l00032" /><CodeLine lineNumber="32"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineloopinfo-h">llvm/CodeGen/MachineLoopInfo.h</a>&quot;</span></CodeLine>
<Link id="l00033" /><CodeLine lineNumber="33"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineoperand-h">llvm/CodeGen/MachineOperand.h</a>&quot;</span></CodeLine>
<Link id="l00034" /><CodeLine lineNumber="34"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineregisterinfo-h">llvm/CodeGen/MachineRegisterInfo.h</a>&quot;</span></CodeLine>
<Link id="l00035" /><CodeLine lineNumber="35"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/passes-h">llvm/CodeGen/Passes.h</a>&quot;</span></CodeLine>
<Link id="l00036" /><CodeLine lineNumber="36"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/registerclassinfo-h">llvm/CodeGen/RegisterClassInfo.h</a>&quot;</span></CodeLine>
<Link id="l00037" /><CodeLine lineNumber="37"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/slotindexes-h">llvm/CodeGen/SlotIndexes.h</a>&quot;</span></CodeLine>
<Link id="l00038" /><CodeLine lineNumber="38"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetinstrinfo-h">llvm/CodeGen/TargetInstrInfo.h</a>&quot;</span></CodeLine>
<Link id="l00039" /><CodeLine lineNumber="39"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetopcodes-h">llvm/CodeGen/TargetOpcodes.h</a>&quot;</span></CodeLine>
<Link id="l00040" /><CodeLine lineNumber="40"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetregisterinfo-h">llvm/CodeGen/TargetRegisterInfo.h</a>&quot;</span></CodeLine>
<Link id="l00041" /><CodeLine lineNumber="41"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetsubtargetinfo-h">llvm/CodeGen/TargetSubtargetInfo.h</a>&quot;</span></CodeLine>
<Link id="l00042" /><CodeLine lineNumber="42"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/debugloc-h">llvm/IR/DebugLoc.h</a>&quot;</span></CodeLine>
<Link id="l00043" /><CodeLine lineNumber="43"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/initializepasses-h">llvm/InitializePasses.h</a>&quot;</span></CodeLine>
<Link id="l00044" /><CodeLine lineNumber="44"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/mc/lanebitmask-h">llvm/MC/LaneBitmask.h</a>&quot;</span></CodeLine>
<Link id="l00045" /><CodeLine lineNumber="45"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/mc/mcinstrdesc-h">llvm/MC/MCInstrDesc.h</a>&quot;</span></CodeLine>
<Link id="l00046" /><CodeLine lineNumber="46"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/mc/mcregisterinfo-h">llvm/MC/MCRegisterInfo.h</a>&quot;</span></CodeLine>
<Link id="l00047" /><CodeLine lineNumber="47"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/pass-h">llvm/Pass.h</a>&quot;</span></CodeLine>
<Link id="l00048" /><CodeLine lineNumber="48"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/commandline-h">llvm/Support/CommandLine.h</a>&quot;</span></CodeLine>
<Link id="l00049" /><CodeLine lineNumber="49"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h">llvm/Support/Compiler.h</a>&quot;</span></CodeLine>
<Link id="l00050" /><CodeLine lineNumber="50"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h">llvm/Support/Debug.h</a>&quot;</span></CodeLine>
<Link id="l00051" /><CodeLine lineNumber="51"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h">llvm/Support/ErrorHandling.h</a>&quot;</span></CodeLine>
<Link id="l00052" /><CodeLine lineNumber="52"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/raw-ostream-h">llvm/Support/raw&#95;ostream.h</a>&quot;</span></CodeLine>
<Link id="l00053" /><CodeLine lineNumber="53"><span class="doxyHighlightPreprocessor">#include &lt;algorithm&gt;</span></CodeLine>
<Link id="l00054" /><CodeLine lineNumber="54"><span class="doxyHighlightPreprocessor">#include &lt;cassert&gt;</span></CodeLine>
<Link id="l00055" /><CodeLine lineNumber="55"><span class="doxyHighlightPreprocessor">#include &lt;iterator&gt;</span></CodeLine>
<Link id="l00056" /><CodeLine lineNumber="56"><span class="doxyHighlightPreprocessor">#include &lt;limits&gt;</span></CodeLine>
<Link id="l00057" /><CodeLine lineNumber="57"><span class="doxyHighlightPreprocessor">#include &lt;tuple&gt;</span></CodeLine>
<Link id="l00058" /><CodeLine lineNumber="58"><span class="doxyHighlightPreprocessor">#include &lt;utility&gt;</span></CodeLine>
<Link id="l00059" /><CodeLine lineNumber="59"><span class="doxyHighlightPreprocessor">#include &lt;vector&gt;</span></CodeLine>
<Link id="l00060" /><CodeLine lineNumber="60"></CodeLine>
<Link id="l00061" /><CodeLine lineNumber="61"><span class="doxyHighlightKeyword">using namespace </span><span class="doxyHighlight"><a href="/docs/api/namespaces/llvm">llvm</a>;</span></CodeLine>
<Link id="l00062" /><CodeLine lineNumber="62"></CodeLine>
<Link id="l00063" /><CodeLine lineNumber="63" lineLink="#ad78e062f62e0d6e453941fb4ca843e4d"><span class="doxyHighlightPreprocessor">#define DEBUG&#95;TYPE &quot;regalloc&quot;</span></CodeLine>
<Link id="l00064" /><CodeLine lineNumber="64"></CodeLine>
<Link id="l00065" /><CodeLine lineNumber="65" lineLink="#a2a531965bccc744dd3526794c1f26390"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(numJoins, </span><span class="doxyHighlightStringLiteral">&quot;Number of interval joins performed&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00066" /><CodeLine lineNumber="66" lineLink="#a45c5d188bd58617bf1d24ce1b9f9e560"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(numCrossRCs, </span><span class="doxyHighlightStringLiteral">&quot;Number of cross class joins performed&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00067" /><CodeLine lineNumber="67" lineLink="#a19eb25ba15e3deaf79d97f9603655e58"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(numCommutes, </span><span class="doxyHighlightStringLiteral">&quot;Number of instruction commuting performed&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00068" /><CodeLine lineNumber="68" lineLink="#afc8e30b34dafa6d72d5f655db9e013d0"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(numExtends, </span><span class="doxyHighlightStringLiteral">&quot;Number of copies extended&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00069" /><CodeLine lineNumber="69" lineLink="#a21ff086c8ce9357e9ec17ac889947bc3"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(NumReMats, </span><span class="doxyHighlightStringLiteral">&quot;Number of instructions re-materialized&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00070" /><CodeLine lineNumber="70" lineLink="#a6248e304069285dd1fe95bd913542a04"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(NumInflated, </span><span class="doxyHighlightStringLiteral">&quot;Number of register classes inflated&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00071" /><CodeLine lineNumber="71" lineLink="#a9fb5791828086e96e9e27b9ab592eb4a"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(NumLaneConflicts, </span><span class="doxyHighlightStringLiteral">&quot;Number of dead lane conflicts tested&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00072" /><CodeLine lineNumber="72" lineLink="#a6ad1c14cb9ee12f218b5bfabf3f1855c"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(NumLaneResolves, </span><span class="doxyHighlightStringLiteral">&quot;Number of dead lane conflicts resolved&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00073" /><CodeLine lineNumber="73" lineLink="#aa031a11edde61e5e12654462e35b9f5b"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/adt/statistic-h/#ad6117415b93e5675d5a6c8e1855b3b2f">STATISTIC</a>(NumShrinkToUses, </span><span class="doxyHighlightStringLiteral">&quot;Number of shrinkToUses called&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00074" /><CodeLine lineNumber="74"></CodeLine>
<Link id="l00075" /><CodeLine lineNumber="75" lineLink="#ab8ef19815a62704144427de2c79d058e"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#ab8ef19815a62704144427de2c79d058e">EnableJoining</a>(</span><span class="doxyHighlightStringLiteral">&quot;join-liveintervals&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00076" /><CodeLine lineNumber="76"><span class="doxyHighlight">                                   <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Coalesce copies (default=true)&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00077" /><CodeLine lineNumber="77"><span class="doxyHighlight">                                   <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">), <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</span></CodeLine>
<Link id="l00078" /><CodeLine lineNumber="78"></CodeLine>
<Link id="l00079" /><CodeLine lineNumber="79" lineLink="#aec45e8545effa6685109d97842d8572a"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#aec45e8545effa6685109d97842d8572a">UseTerminalRule</a>(</span><span class="doxyHighlightStringLiteral">&quot;terminal-rule&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00080" /><CodeLine lineNumber="80"><span class="doxyHighlight">                                     <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Apply the terminal rule&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00081" /><CodeLine lineNumber="81"><span class="doxyHighlight">                                     <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">), <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</span></CodeLine>
<Link id="l00082" /><CodeLine lineNumber="82"></CodeLine>
<Link id="l00083" /><CodeLine lineNumber="83"><span class="doxyHighlightComment">/// Temporary flag to test critical edge unsplitting.</span></CodeLine>
<Link id="l00084" /><CodeLine lineNumber="84" lineLink="#ab3861763540aea165ffd7a63a0bc2f06"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#ab3861763540aea165ffd7a63a0bc2f06">EnableJoinSplits</a>(</span></CodeLine>
<Link id="l00085" /><CodeLine lineNumber="85"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;join-splitedges&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00086" /><CodeLine lineNumber="86"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Coalesce copies on split edges (default=subtarget)&quot;</span><span class="doxyHighlight">), <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</span></CodeLine>
<Link id="l00087" /><CodeLine lineNumber="87"></CodeLine>
<Link id="l00088" /><CodeLine lineNumber="88"><span class="doxyHighlightComment">/// Temporary flag to test global copy optimization.</span></CodeLine>
<Link id="l00089" /><CodeLine lineNumber="89" lineLink="#a233a6770a940d2da877cafd1263f9dc8"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;cl::boolOrDefault&gt;</a> <a href="#a233a6770a940d2da877cafd1263f9dc8">EnableGlobalCopies</a>(</span></CodeLine>
<Link id="l00090" /><CodeLine lineNumber="90"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;join-globalcopies&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00091" /><CodeLine lineNumber="91"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Coalesce copies that span blocks (default=subtarget)&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00092" /><CodeLine lineNumber="92"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(<a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44aa5bd521ebe67ddf0e90f1a9e540a6d43">cl::BOU&#95;UNSET</a>), <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</span></CodeLine>
<Link id="l00093" /><CodeLine lineNumber="93"></CodeLine>
<Link id="l00094" /><CodeLine lineNumber="94" lineLink="#aa8b58294e993b77e8215298b1ef440a6"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#aa8b58294e993b77e8215298b1ef440a6">VerifyCoalescing</a>(</span></CodeLine>
<Link id="l00095" /><CodeLine lineNumber="95"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;verify-coalescing&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00096" /><CodeLine lineNumber="96"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Verify machine instrs before and after register coalescing&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00097" /><CodeLine lineNumber="97"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>);</span></CodeLine>
<Link id="l00098" /><CodeLine lineNumber="98"></CodeLine>
<Link id="l00099" /><CodeLine lineNumber="99" lineLink="#ae4fcc7d618c726ebb208a5853442ce7e"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;unsigned&gt;</a> <a href="#ae4fcc7d618c726ebb208a5853442ce7e">LateRematUpdateThreshold</a>(</span></CodeLine>
<Link id="l00100" /><CodeLine lineNumber="100"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;late-remat-update-threshold&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</span></CodeLine>
<Link id="l00101" /><CodeLine lineNumber="101"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;During rematerialization for a copy, if the def instruction has &quot;</span></CodeLine>
<Link id="l00102" /><CodeLine lineNumber="102"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;many other copy uses to be rematerialized, delay the multiple &quot;</span></CodeLine>
<Link id="l00103" /><CodeLine lineNumber="103"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;separate live interval update work and do them all at once after &quot;</span></CodeLine>
<Link id="l00104" /><CodeLine lineNumber="104"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;all those rematerialization are done. It will save a lot of &quot;</span></CodeLine>
<Link id="l00105" /><CodeLine lineNumber="105"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;repeated work. &quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00106" /><CodeLine lineNumber="106"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(100));</span></CodeLine>
<Link id="l00107" /><CodeLine lineNumber="107"></CodeLine>
<Link id="l00108" /><CodeLine lineNumber="108" lineLink="#a4b2129a58164949cdd06be96232abbd3"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;unsigned&gt;</a> <a href="#a4b2129a58164949cdd06be96232abbd3">LargeIntervalSizeThreshold</a>(</span></CodeLine>
<Link id="l00109" /><CodeLine lineNumber="109"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;large-interval-size-threshold&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</span></CodeLine>
<Link id="l00110" /><CodeLine lineNumber="110"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;If the valnos size of an interval is larger than the threshold, &quot;</span></CodeLine>
<Link id="l00111" /><CodeLine lineNumber="111"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;it is regarded as a large interval. &quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00112" /><CodeLine lineNumber="112"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(100));</span></CodeLine>
<Link id="l00113" /><CodeLine lineNumber="113"></CodeLine>
<Link id="l00114" /><CodeLine lineNumber="114" lineLink="#abb9db777c3bf00bfbc614a1f0539fb04"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;unsigned&gt;</a> <a href="#abb9db777c3bf00bfbc614a1f0539fb04">LargeIntervalFreqThreshold</a>(</span></CodeLine>
<Link id="l00115" /><CodeLine lineNumber="115"><span class="doxyHighlight">    </span><span class="doxyHighlightStringLiteral">&quot;large-interval-freq-threshold&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</span></CodeLine>
<Link id="l00116" /><CodeLine lineNumber="116"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;For a large interval, if it is coalesced with other live &quot;</span></CodeLine>
<Link id="l00117" /><CodeLine lineNumber="117"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;intervals many times more than the threshold, stop its &quot;</span></CodeLine>
<Link id="l00118" /><CodeLine lineNumber="118"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;coalescing to control the compile time. &quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00119" /><CodeLine lineNumber="119"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(256));</span></CodeLine>
<Link id="l00120" /><CodeLine lineNumber="120"></CodeLine>
<Link id="l00121" /><CodeLine lineNumber="121" lineLink="/docs/api/namespaces/anonymous-registercoalescer-cpp-"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00122" /><CodeLine lineNumber="122"></CodeLine>
<Link id="l00123" /><CodeLine lineNumber="123"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a>;</span></CodeLine>
<Link id="l00124" /><CodeLine lineNumber="124"></CodeLine>
<Link id="l00125" /><CodeLine lineNumber="125" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a0969ad06eb530c7fc3a7d2b8b9911fa6">RegisterCoalescer</a> : </span><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinefunctionpass/#a29c81d2386f4a727c6d33413807530c8">MachineFunctionPass</a>,</span></CodeLine>
<Link id="l00126" /><CodeLine lineNumber="126"><span class="doxyHighlight">                          </span><span class="doxyHighlightKeyword">private</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liverangeedit/delegate">LiveRangeEdit::Delegate</a> &#123;</span></CodeLine>
<Link id="l00127" /><CodeLine lineNumber="127"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &#42;MF = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00128" /><CodeLine lineNumber="128"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineregisterinfo">MachineRegisterInfo</a> &#42;MRI = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00129" /><CodeLine lineNumber="129"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &#42;TRI = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00130" /><CodeLine lineNumber="130"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetinstrinfo">TargetInstrInfo</a> &#42;TII = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00131" /><CodeLine lineNumber="131"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveintervals">LiveIntervals</a> &#42;LIS = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00132" /><CodeLine lineNumber="132"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineloopinfo">MachineLoopInfo</a> &#42;Loops = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00133" /><CodeLine lineNumber="133"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#ae457f1cf451ed893666c4a384e58f8e5">AliasAnalysis</a> &#42;AA = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00134" /><CodeLine lineNumber="134"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/registerclassinfo">RegisterClassInfo</a> RegClassInfo;</span></CodeLine>
<Link id="l00135" /><CodeLine lineNumber="135"></CodeLine>
<Link id="l00136" /><CodeLine lineNumber="136"><span class="doxyHighlightComment">  /// Position and VReg of a PHI instruction during coalescing.</span></CodeLine>
<Link id="l00137" /><CodeLine lineNumber="137"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight">PHIValPos &#123;</span></CodeLine>
<Link id="l00138" /><CodeLine lineNumber="138"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> <a href="/docs/api/namespaces/llvm/si">SI</a>;    </span><span class="doxyHighlightComment">///&lt; Slot where this PHI occurs.</span></CodeLine>
<Link id="l00139" /><CodeLine lineNumber="139"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/register">Register</a> Reg;    </span><span class="doxyHighlightComment">///&lt; VReg the PHI occurs in.</span></CodeLine>
<Link id="l00140" /><CodeLine lineNumber="140"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>; </span><span class="doxyHighlightComment">///&lt; Qualifying subregister for Reg.</span></CodeLine>
<Link id="l00141" /><CodeLine lineNumber="141"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00142" /><CodeLine lineNumber="142"></CodeLine>
<Link id="l00143" /><CodeLine lineNumber="143"><span class="doxyHighlightComment">  /// Map from debug instruction number to PHI position during coalescing.</span></CodeLine>
<Link id="l00144" /><CodeLine lineNumber="144"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;unsigned, PHIValPos&gt;</a> PHIValToPos;</span></CodeLine>
<Link id="l00145" /><CodeLine lineNumber="145"><span class="doxyHighlightComment">  /// Index of, for each VReg, which debug instruction numbers and</span></CodeLine>
<Link id="l00146" /><CodeLine lineNumber="146"><span class="doxyHighlightComment">  /// corresponding PHIs are sensitive to coalescing. Each VReg may have</span></CodeLine>
<Link id="l00147" /><CodeLine lineNumber="147"><span class="doxyHighlightComment">  /// multiple PHI defs, at different positions.</span></CodeLine>
<Link id="l00148" /><CodeLine lineNumber="148"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;Register, SmallVector&lt;unsigned, 2&gt;</a>&gt; RegToPHIIdx;</span></CodeLine>
<Link id="l00149" /><CodeLine lineNumber="149"></CodeLine>
<Link id="l00150" /><CodeLine lineNumber="150"><span class="doxyHighlightComment">  /// Debug variable location tracking -- for each VReg, maintain an</span></CodeLine>
<Link id="l00151" /><CodeLine lineNumber="151"><span class="doxyHighlightComment">  /// ordered-by-slot-index set of DBG&#95;VALUEs, to help quick</span></CodeLine>
<Link id="l00152" /><CodeLine lineNumber="152"><span class="doxyHighlightComment">  /// identification of whether coalescing may change location validity.</span></CodeLine>
<Link id="l00153" /><CodeLine lineNumber="153"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight">DbgValueLoc = std::pair&lt;SlotIndex, MachineInstr &#42;&gt;;</span></CodeLine>
<Link id="l00154" /><CodeLine lineNumber="154"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;Register, std::vector&lt;DbgValueLoc&gt;</a>&gt; DbgVRegToValues;</span></CodeLine>
<Link id="l00155" /><CodeLine lineNumber="155"></CodeLine>
<Link id="l00156" /><CodeLine lineNumber="156"><span class="doxyHighlightComment">  /// A LaneMask to remember on which subregister live ranges we need to call</span></CodeLine>
<Link id="l00157" /><CodeLine lineNumber="157"><span class="doxyHighlightComment">  /// shrinkToUses() later.</span></CodeLine>
<Link id="l00158" /><CodeLine lineNumber="158"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> ShrinkMask;</span></CodeLine>
<Link id="l00159" /><CodeLine lineNumber="159"></CodeLine>
<Link id="l00160" /><CodeLine lineNumber="160"><span class="doxyHighlightComment">  /// True if the main range of the currently coalesced intervals should be</span></CodeLine>
<Link id="l00161" /><CodeLine lineNumber="161"><span class="doxyHighlightComment">  /// checked for smaller live intervals.</span></CodeLine>
<Link id="l00162" /><CodeLine lineNumber="162"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ShrinkMainRange = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00163" /><CodeLine lineNumber="163"></CodeLine>
<Link id="l00164" /><CodeLine lineNumber="164"><span class="doxyHighlightComment">  /// True if the coalescer should aggressively coalesce global copies</span></CodeLine>
<Link id="l00165" /><CodeLine lineNumber="165"><span class="doxyHighlightComment">  /// in favor of keeping local copies.</span></CodeLine>
<Link id="l00166" /><CodeLine lineNumber="166"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> JoinGlobalCopies = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00167" /><CodeLine lineNumber="167"></CodeLine>
<Link id="l00168" /><CodeLine lineNumber="168"><span class="doxyHighlightComment">  /// True if the coalescer should aggressively coalesce fall-thru</span></CodeLine>
<Link id="l00169" /><CodeLine lineNumber="169"><span class="doxyHighlightComment">  /// blocks exclusively containing copies.</span></CodeLine>
<Link id="l00170" /><CodeLine lineNumber="170"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> JoinSplitEdges = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00171" /><CodeLine lineNumber="171"></CodeLine>
<Link id="l00172" /><CodeLine lineNumber="172"><span class="doxyHighlightComment">  /// Copy instructions yet to be coalesced.</span></CodeLine>
<Link id="l00173" /><CodeLine lineNumber="173"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineInstr &#42;, 8&gt;</a> WorkList;</span></CodeLine>
<Link id="l00174" /><CodeLine lineNumber="174"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineInstr &#42;, 8&gt;</a> LocalWorkList;</span></CodeLine>
<Link id="l00175" /><CodeLine lineNumber="175"></CodeLine>
<Link id="l00176" /><CodeLine lineNumber="176"><span class="doxyHighlightComment">  /// Set of instruction pointers that have been erased, and</span></CodeLine>
<Link id="l00177" /><CodeLine lineNumber="177"><span class="doxyHighlightComment">  /// that may be present in WorkList.</span></CodeLine>
<Link id="l00178" /><CodeLine lineNumber="178"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;MachineInstr &#42;, 8&gt;</a> ErasedInstrs;</span></CodeLine>
<Link id="l00179" /><CodeLine lineNumber="179"></CodeLine>
<Link id="l00180" /><CodeLine lineNumber="180"><span class="doxyHighlightComment">  /// Dead instructions that are about to be deleted.</span></CodeLine>
<Link id="l00181" /><CodeLine lineNumber="181"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineInstr &#42;, 8&gt;</a> DeadDefs;</span></CodeLine>
<Link id="l00182" /><CodeLine lineNumber="182"></CodeLine>
<Link id="l00183" /><CodeLine lineNumber="183"><span class="doxyHighlightComment">  /// Virtual registers to be considered for register class inflation.</span></CodeLine>
<Link id="l00184" /><CodeLine lineNumber="184"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Register, 8&gt;</a> InflateRegs;</span></CodeLine>
<Link id="l00185" /><CodeLine lineNumber="185"></CodeLine>
<Link id="l00186" /><CodeLine lineNumber="186"><span class="doxyHighlightComment">  /// The collection of live intervals which should have been updated</span></CodeLine>
<Link id="l00187" /><CodeLine lineNumber="187"><span class="doxyHighlightComment">  /// immediately after rematerialiation but delayed until</span></CodeLine>
<Link id="l00188" /><CodeLine lineNumber="188"><span class="doxyHighlightComment">  /// lateLiveIntervalUpdate is called.</span></CodeLine>
<Link id="l00189" /><CodeLine lineNumber="189"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;Register&gt;</a> ToBeUpdated;</span></CodeLine>
<Link id="l00190" /><CodeLine lineNumber="190"></CodeLine>
<Link id="l00191" /><CodeLine lineNumber="191"><span class="doxyHighlightComment">  /// Record how many times the large live interval with many valnos</span></CodeLine>
<Link id="l00192" /><CodeLine lineNumber="192"><span class="doxyHighlightComment">  /// has been tried to join with other live interval.</span></CodeLine>
<Link id="l00193" /><CodeLine lineNumber="193"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;Register, unsigned long&gt;</a> LargeLIVisitCounter;</span></CodeLine>
<Link id="l00194" /><CodeLine lineNumber="194"></CodeLine>
<Link id="l00195" /><CodeLine lineNumber="195"><span class="doxyHighlightComment">  /// Recursively eliminate dead defs in DeadDefs.</span></CodeLine>
<Link id="l00196" /><CodeLine lineNumber="196"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> eliminateDeadDefs(<a href="/docs/api/classes/llvm/liverangeedit">LiveRangeEdit</a> &#42;Edit = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00197" /><CodeLine lineNumber="197"></CodeLine>
<Link id="l00198" /><CodeLine lineNumber="198"><span class="doxyHighlightComment">  /// LiveRangeEdit callback for eliminateDeadDefs().</span></CodeLine>
<Link id="l00199" /><CodeLine lineNumber="199"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> LRE&#95;WillEraseInstruction(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) </span><span class="doxyHighlightKeyword">override</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00200" /><CodeLine lineNumber="200"></CodeLine>
<Link id="l00201" /><CodeLine lineNumber="201"><span class="doxyHighlightComment">  /// Coalesce the LocalWorkList.</span></CodeLine>
<Link id="l00202" /><CodeLine lineNumber="202"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> coalesceLocals();</span></CodeLine>
<Link id="l00203" /><CodeLine lineNumber="203"></CodeLine>
<Link id="l00204" /><CodeLine lineNumber="204"><span class="doxyHighlightComment">  /// Join compatible live intervals</span></CodeLine>
<Link id="l00205" /><CodeLine lineNumber="205"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> joinAllIntervals();</span></CodeLine>
<Link id="l00206" /><CodeLine lineNumber="206"></CodeLine>
<Link id="l00207" /><CodeLine lineNumber="207"><span class="doxyHighlightComment">  /// Coalesce copies in the specified MBB, putting</span></CodeLine>
<Link id="l00208" /><CodeLine lineNumber="208"><span class="doxyHighlightComment">  /// copies that cannot yet be coalesced into WorkList.</span></CodeLine>
<Link id="l00209" /><CodeLine lineNumber="209"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> copyCoalesceInMBB(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l00210" /><CodeLine lineNumber="210"></CodeLine>
<Link id="l00211" /><CodeLine lineNumber="211"><span class="doxyHighlightComment">  /// Tries to coalesce all copies in CurrList. Returns true if any progress</span></CodeLine>
<Link id="l00212" /><CodeLine lineNumber="212"><span class="doxyHighlightComment">  /// was made.</span></CodeLine>
<Link id="l00213" /><CodeLine lineNumber="213"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> copyCoalesceWorkList(<a href="/docs/api/classes/llvm/mutablearrayref">MutableArrayRef&lt;MachineInstr &#42;&gt;</a> CurrList);</span></CodeLine>
<Link id="l00214" /><CodeLine lineNumber="214"></CodeLine>
<Link id="l00215" /><CodeLine lineNumber="215"><span class="doxyHighlightComment">  /// If one def has many copy like uses, and those copy uses are all</span></CodeLine>
<Link id="l00216" /><CodeLine lineNumber="216"><span class="doxyHighlightComment">  /// rematerialized, the live interval update needed for those</span></CodeLine>
<Link id="l00217" /><CodeLine lineNumber="217"><span class="doxyHighlightComment">  /// rematerializations will be delayed and done all at once instead</span></CodeLine>
<Link id="l00218" /><CodeLine lineNumber="218"><span class="doxyHighlightComment">  /// of being done multiple times. This is to save compile cost because</span></CodeLine>
<Link id="l00219" /><CodeLine lineNumber="219"><span class="doxyHighlightComment">  /// live interval update is costly.</span></CodeLine>
<Link id="l00220" /><CodeLine lineNumber="220"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> lateLiveIntervalUpdate();</span></CodeLine>
<Link id="l00221" /><CodeLine lineNumber="221"></CodeLine>
<Link id="l00222" /><CodeLine lineNumber="222"><span class="doxyHighlightComment">  /// Check if the incoming value defined by a COPY at \\p SLRQ in the subrange</span></CodeLine>
<Link id="l00223" /><CodeLine lineNumber="223"><span class="doxyHighlightComment">  /// has no value defined in the predecessors. If the incoming value is the</span></CodeLine>
<Link id="l00224" /><CodeLine lineNumber="224"><span class="doxyHighlightComment">  /// same as defined by the copy itself, the value is considered undefined.</span></CodeLine>
<Link id="l00225" /><CodeLine lineNumber="225"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> copyValueUndefInPredecessors(<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;S, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>,</span></CodeLine>
<Link id="l00226" /><CodeLine lineNumber="226"><span class="doxyHighlight">                                    <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> SLRQ);</span></CodeLine>
<Link id="l00227" /><CodeLine lineNumber="227"></CodeLine>
<Link id="l00228" /><CodeLine lineNumber="228"><span class="doxyHighlightComment">  /// Set necessary undef flags on subregister uses after pruning out undef</span></CodeLine>
<Link id="l00229" /><CodeLine lineNumber="229"><span class="doxyHighlightComment">  /// lane segments from the subrange.</span></CodeLine>
<Link id="l00230" /><CodeLine lineNumber="230"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> setUndefOnPrunedSubRegUses(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI, <a href="/docs/api/classes/llvm/register">Register</a> Reg,</span></CodeLine>
<Link id="l00231" /><CodeLine lineNumber="231"><span class="doxyHighlight">                                  <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> PrunedLanes);</span></CodeLine>
<Link id="l00232" /><CodeLine lineNumber="232"></CodeLine>
<Link id="l00233" /><CodeLine lineNumber="233"><span class="doxyHighlightComment">  /// Attempt to join intervals corresponding to SrcReg/DstReg, which are the</span></CodeLine>
<Link id="l00234" /><CodeLine lineNumber="234"><span class="doxyHighlightComment">  /// src/dst of the copy instruction CopyMI.  This returns true if the copy</span></CodeLine>
<Link id="l00235" /><CodeLine lineNumber="235"><span class="doxyHighlightComment">  /// was successfully coalesced away. If it is not currently possible to</span></CodeLine>
<Link id="l00236" /><CodeLine lineNumber="236"><span class="doxyHighlightComment">  /// coalesce this interval, but it may be possible if other things get</span></CodeLine>
<Link id="l00237" /><CodeLine lineNumber="237"><span class="doxyHighlightComment">  /// coalesced, then it returns true by reference in &#39;Again&#39;.</span></CodeLine>
<Link id="l00238" /><CodeLine lineNumber="238"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> joinCopy(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &amp;Again,</span></CodeLine>
<Link id="l00239" /><CodeLine lineNumber="239"><span class="doxyHighlight">                <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineInstr &#42;&gt;</a> &amp;CurrentErasedInstrs);</span></CodeLine>
<Link id="l00240" /><CodeLine lineNumber="240"></CodeLine>
<Link id="l00241" /><CodeLine lineNumber="241"><span class="doxyHighlightComment">  /// Attempt to join these two intervals.  On failure, this</span></CodeLine>
<Link id="l00242" /><CodeLine lineNumber="242"><span class="doxyHighlightComment">  /// returns false.  The output &quot;SrcInt&quot; will not have been modified, so we</span></CodeLine>
<Link id="l00243" /><CodeLine lineNumber="243"><span class="doxyHighlightComment">  /// can use this information below to update aliases.</span></CodeLine>
<Link id="l00244" /><CodeLine lineNumber="244"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> joinIntervals(<a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP);</span></CodeLine>
<Link id="l00245" /><CodeLine lineNumber="245"></CodeLine>
<Link id="l00246" /><CodeLine lineNumber="246"><span class="doxyHighlightComment">  /// Attempt joining two virtual registers. Return true on success.</span></CodeLine>
<Link id="l00247" /><CodeLine lineNumber="247"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> joinVirtRegs(<a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP);</span></CodeLine>
<Link id="l00248" /><CodeLine lineNumber="248"></CodeLine>
<Link id="l00249" /><CodeLine lineNumber="249"><span class="doxyHighlightComment">  /// If a live interval has many valnos and is coalesced with other</span></CodeLine>
<Link id="l00250" /><CodeLine lineNumber="250"><span class="doxyHighlightComment">  /// live intervals many times, we regard such live interval as having</span></CodeLine>
<Link id="l00251" /><CodeLine lineNumber="251"><span class="doxyHighlightComment">  /// high compile time cost.</span></CodeLine>
<Link id="l00252" /><CodeLine lineNumber="252"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> isHighCostLiveInterval(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI);</span></CodeLine>
<Link id="l00253" /><CodeLine lineNumber="253"></CodeLine>
<Link id="l00254" /><CodeLine lineNumber="254"><span class="doxyHighlightComment">  /// Attempt joining with a reserved physreg.</span></CodeLine>
<Link id="l00255" /><CodeLine lineNumber="255"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> joinReservedPhysReg(<a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP);</span></CodeLine>
<Link id="l00256" /><CodeLine lineNumber="256"></CodeLine>
<Link id="l00257" /><CodeLine lineNumber="257"><span class="doxyHighlightComment">  /// Add the LiveRange @p ToMerge as a subregister liverange of @p LI.</span></CodeLine>
<Link id="l00258" /><CodeLine lineNumber="258"><span class="doxyHighlightComment">  /// Subranges in @p LI which only partially interfere with the desired</span></CodeLine>
<Link id="l00259" /><CodeLine lineNumber="259"><span class="doxyHighlightComment">  /// LaneMask are split as necessary. @p LaneMask are the lanes that</span></CodeLine>
<Link id="l00260" /><CodeLine lineNumber="260"><span class="doxyHighlightComment">  /// @p ToMerge will occupy in the coalescer register. @p LI has its subrange</span></CodeLine>
<Link id="l00261" /><CodeLine lineNumber="261"><span class="doxyHighlightComment">  /// lanemasks already adjusted to the coalesced register.</span></CodeLine>
<Link id="l00262" /><CodeLine lineNumber="262"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> mergeSubRangeInto(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;ToMerge,</span></CodeLine>
<Link id="l00263" /><CodeLine lineNumber="263"><span class="doxyHighlight">                         <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> LaneMask, <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP,</span></CodeLine>
<Link id="l00264" /><CodeLine lineNumber="264"><span class="doxyHighlight">                         </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> DstIdx);</span></CodeLine>
<Link id="l00265" /><CodeLine lineNumber="265"></CodeLine>
<Link id="l00266" /><CodeLine lineNumber="266"><span class="doxyHighlightComment">  /// Join the liveranges of two subregisters. Joins @p RRange into</span></CodeLine>
<Link id="l00267" /><CodeLine lineNumber="267"><span class="doxyHighlightComment">  /// @p LRange, @p RRange may be invalid afterwards.</span></CodeLine>
<Link id="l00268" /><CodeLine lineNumber="268"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> joinSubRegRanges(<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;LRange, <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;RRange,</span></CodeLine>
<Link id="l00269" /><CodeLine lineNumber="269"><span class="doxyHighlight">                        <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> LaneMask, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP);</span></CodeLine>
<Link id="l00270" /><CodeLine lineNumber="270"></CodeLine>
<Link id="l00271" /><CodeLine lineNumber="271"><span class="doxyHighlightComment">  /// We found a non-trivially-coalescable copy. If the source value number is</span></CodeLine>
<Link id="l00272" /><CodeLine lineNumber="272"><span class="doxyHighlightComment">  /// defined by a copy from the destination reg see if we can merge these two</span></CodeLine>
<Link id="l00273" /><CodeLine lineNumber="273"><span class="doxyHighlightComment">  /// destination reg valno# into a single value number, eliminating a copy.</span></CodeLine>
<Link id="l00274" /><CodeLine lineNumber="274"><span class="doxyHighlightComment">  /// This returns true if an interval was modified.</span></CodeLine>
<Link id="l00275" /><CodeLine lineNumber="275"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> adjustCopiesBackFrom(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP, <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI);</span></CodeLine>
<Link id="l00276" /><CodeLine lineNumber="276"></CodeLine>
<Link id="l00277" /><CodeLine lineNumber="277"><span class="doxyHighlightComment">  /// Return true if there are definitions of IntB</span></CodeLine>
<Link id="l00278" /><CodeLine lineNumber="278"><span class="doxyHighlightComment">  /// other than BValNo val# that can reach uses of AValno val# of IntA.</span></CodeLine>
<Link id="l00279" /><CodeLine lineNumber="279"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> hasOtherReachingDefs(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntA, <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntB,</span></CodeLine>
<Link id="l00280" /><CodeLine lineNumber="280"><span class="doxyHighlight">                            <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;AValNo, <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;BValNo);</span></CodeLine>
<Link id="l00281" /><CodeLine lineNumber="281"></CodeLine>
<Link id="l00282" /><CodeLine lineNumber="282"><span class="doxyHighlightComment">  /// We found a non-trivially-coalescable copy.</span></CodeLine>
<Link id="l00283" /><CodeLine lineNumber="283"><span class="doxyHighlightComment">  /// If the source value number is defined by a commutable instruction and</span></CodeLine>
<Link id="l00284" /><CodeLine lineNumber="284"><span class="doxyHighlightComment">  /// its other operand is coalesced to the copy dest register, see if we</span></CodeLine>
<Link id="l00285" /><CodeLine lineNumber="285"><span class="doxyHighlightComment">  /// can transform the copy into a noop by commuting the definition.</span></CodeLine>
<Link id="l00286" /><CodeLine lineNumber="286"><span class="doxyHighlightComment">  /// This returns a pair of two flags:</span></CodeLine>
<Link id="l00287" /><CodeLine lineNumber="287"><span class="doxyHighlightComment">  /// - the first element is true if an interval was modified,</span></CodeLine>
<Link id="l00288" /><CodeLine lineNumber="288"><span class="doxyHighlightComment">  /// - the second element is true if the destination interval needs</span></CodeLine>
<Link id="l00289" /><CodeLine lineNumber="289"><span class="doxyHighlightComment">  ///   to be shrunk after deleting the copy.</span></CodeLine>
<Link id="l00290" /><CodeLine lineNumber="290"><span class="doxyHighlight">  std::pair&lt;bool, bool&gt; removeCopyByCommutingDef(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP,</span></CodeLine>
<Link id="l00291" /><CodeLine lineNumber="291"><span class="doxyHighlight">                                                 <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI);</span></CodeLine>
<Link id="l00292" /><CodeLine lineNumber="292"></CodeLine>
<Link id="l00293" /><CodeLine lineNumber="293"><span class="doxyHighlightComment">  /// We found a copy which can be moved to its less frequent predecessor.</span></CodeLine>
<Link id="l00294" /><CodeLine lineNumber="294"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> removePartialRedundancy(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP, <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;CopyMI);</span></CodeLine>
<Link id="l00295" /><CodeLine lineNumber="295"></CodeLine>
<Link id="l00296" /><CodeLine lineNumber="296"><span class="doxyHighlightComment">  /// If the source of a copy is defined by a</span></CodeLine>
<Link id="l00297" /><CodeLine lineNumber="297"><span class="doxyHighlightComment">  /// trivial computation, replace the copy by rematerialize the definition.</span></CodeLine>
<Link id="l00298" /><CodeLine lineNumber="298"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> reMaterializeTrivialDef(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP, <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI,</span></CodeLine>
<Link id="l00299" /><CodeLine lineNumber="299"><span class="doxyHighlight">                               </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &amp;IsDefCopy);</span></CodeLine>
<Link id="l00300" /><CodeLine lineNumber="300"></CodeLine>
<Link id="l00301" /><CodeLine lineNumber="301"><span class="doxyHighlightComment">  /// Return true if a copy involving a physreg should be joined.</span></CodeLine>
<Link id="l00302" /><CodeLine lineNumber="302"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> canJoinPhys(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP);</span></CodeLine>
<Link id="l00303" /><CodeLine lineNumber="303"></CodeLine>
<Link id="l00304" /><CodeLine lineNumber="304"><span class="doxyHighlightComment">  /// Replace all defs and uses of SrcReg to DstReg and update the subregister</span></CodeLine>
<Link id="l00305" /><CodeLine lineNumber="305"><span class="doxyHighlightComment">  /// number if it is not zero. If DstReg is a physical register and the</span></CodeLine>
<Link id="l00306" /><CodeLine lineNumber="306"><span class="doxyHighlightComment">  /// existing subregister number of the def / use being updated is not zero,</span></CodeLine>
<Link id="l00307" /><CodeLine lineNumber="307"><span class="doxyHighlightComment">  /// make sure to set it to the correct physical subregister.</span></CodeLine>
<Link id="l00308" /><CodeLine lineNumber="308"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> updateRegDefsUses(<a href="/docs/api/classes/llvm/register">Register</a> SrcReg, <a href="/docs/api/classes/llvm/register">Register</a> DstReg, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubIdx);</span></CodeLine>
<Link id="l00309" /><CodeLine lineNumber="309"></CodeLine>
<Link id="l00310" /><CodeLine lineNumber="310"><span class="doxyHighlightComment">  /// If the given machine operand reads only undefined lanes add an undef</span></CodeLine>
<Link id="l00311" /><CodeLine lineNumber="311"><span class="doxyHighlightComment">  /// flag.</span></CodeLine>
<Link id="l00312" /><CodeLine lineNumber="312"><span class="doxyHighlightComment">  /// This can happen when undef uses were previously concealed by a copy</span></CodeLine>
<Link id="l00313" /><CodeLine lineNumber="313"><span class="doxyHighlightComment">  /// which we coalesced. Example:</span></CodeLine>
<Link id="l00314" /><CodeLine lineNumber="314"><span class="doxyHighlightComment">  ///    %0:sub0&lt;def,read-undef&gt; = ...</span></CodeLine>
<Link id="l00315" /><CodeLine lineNumber="315"><span class="doxyHighlightComment">  ///    %1 = COPY %0           &lt;-- Coalescing COPY reveals undef</span></CodeLine>
<Link id="l00316" /><CodeLine lineNumber="316"><span class="doxyHighlightComment">  ///       = use %1:sub1       &lt;-- hidden undef use</span></CodeLine>
<Link id="l00317" /><CodeLine lineNumber="317"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> addUndefFlag(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a637b69dea56f804278aa50e975337e01">Int</a>, <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> UseIdx,</span></CodeLine>
<Link id="l00318" /><CodeLine lineNumber="318"><span class="doxyHighlight">                    <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubRegIdx);</span></CodeLine>
<Link id="l00319" /><CodeLine lineNumber="319"></CodeLine>
<Link id="l00320" /><CodeLine lineNumber="320"><span class="doxyHighlightComment">  /// Handle copies of undef values. If the undef value is an incoming</span></CodeLine>
<Link id="l00321" /><CodeLine lineNumber="321"><span class="doxyHighlightComment">  /// PHI value, it will convert @p CopyMI to an IMPLICIT&#95;DEF.</span></CodeLine>
<Link id="l00322" /><CodeLine lineNumber="322"><span class="doxyHighlightComment">  /// Returns nullptr if @p CopyMI was not in any way eliminable. Otherwise,</span></CodeLine>
<Link id="l00323" /><CodeLine lineNumber="323"><span class="doxyHighlightComment">  /// it returns @p CopyMI (which could be an IMPLICIT&#95;DEF at this point).</span></CodeLine>
<Link id="l00324" /><CodeLine lineNumber="324"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;eliminateUndefCopy(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI);</span></CodeLine>
<Link id="l00325" /><CodeLine lineNumber="325"></CodeLine>
<Link id="l00326" /><CodeLine lineNumber="326"><span class="doxyHighlightComment">  /// Check whether or not we should apply the terminal rule on the</span></CodeLine>
<Link id="l00327" /><CodeLine lineNumber="327"><span class="doxyHighlightComment">  /// destination (Dst) of \\p Copy.</span></CodeLine>
<Link id="l00328" /><CodeLine lineNumber="328"><span class="doxyHighlightComment">  /// When the terminal rule applies, Copy is not profitable to</span></CodeLine>
<Link id="l00329" /><CodeLine lineNumber="329"><span class="doxyHighlightComment">  /// coalesce.</span></CodeLine>
<Link id="l00330" /><CodeLine lineNumber="330"><span class="doxyHighlightComment">  /// Dst is terminal if it has exactly one affinity (Dst, Src) and</span></CodeLine>
<Link id="l00331" /><CodeLine lineNumber="331"><span class="doxyHighlightComment">  /// at least one interference (Dst, Dst2). If Dst is terminal, the</span></CodeLine>
<Link id="l00332" /><CodeLine lineNumber="332"><span class="doxyHighlightComment">  /// terminal rule consists in checking that at least one of</span></CodeLine>
<Link id="l00333" /><CodeLine lineNumber="333"><span class="doxyHighlightComment">  /// interfering node, say Dst2, has an affinity of equal or greater</span></CodeLine>
<Link id="l00334" /><CodeLine lineNumber="334"><span class="doxyHighlightComment">  /// weight with Src.</span></CodeLine>
<Link id="l00335" /><CodeLine lineNumber="335"><span class="doxyHighlightComment">  /// In that case, Dst2 and Dst will not be able to be both coalesced</span></CodeLine>
<Link id="l00336" /><CodeLine lineNumber="336"><span class="doxyHighlightComment">  /// with Src. Since Dst2 exposes more coalescing opportunities than</span></CodeLine>
<Link id="l00337" /><CodeLine lineNumber="337"><span class="doxyHighlightComment">  /// Dst, we can drop \\p Copy.</span></CodeLine>
<Link id="l00338" /><CodeLine lineNumber="338"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> applyTerminalRule(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;Copy) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00339" /><CodeLine lineNumber="339"></CodeLine>
<Link id="l00340" /><CodeLine lineNumber="340"><span class="doxyHighlightComment">  /// Wrapper method for \\see LiveIntervals::shrinkToUses.</span></CodeLine>
<Link id="l00341" /><CodeLine lineNumber="341"><span class="doxyHighlightComment">  /// This method does the proper fixing of the live-ranges when the afore</span></CodeLine>
<Link id="l00342" /><CodeLine lineNumber="342"><span class="doxyHighlightComment">  /// mentioned method returns true.</span></CodeLine>
<Link id="l00343" /><CodeLine lineNumber="343"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &#42;LI,</span></CodeLine>
<Link id="l00344" /><CodeLine lineNumber="344"><span class="doxyHighlight">                    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;MachineInstr &#42;&gt;</a> &#42;Dead = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l00345" /><CodeLine lineNumber="345"><span class="doxyHighlight">    NumShrinkToUses++;</span></CodeLine>
<Link id="l00346" /><CodeLine lineNumber="346"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LIS-&gt;shrinkToUses(LI, Dead)) &#123;</span></CodeLine>
<Link id="l00347" /><CodeLine lineNumber="347"><span class="doxyHighlightComment">      /// Check whether or not \\p LI is composed by multiple connected</span></CodeLine>
<Link id="l00348" /><CodeLine lineNumber="348"><span class="doxyHighlightComment">      /// components and if that is the case, fix that.</span></CodeLine>
<Link id="l00349" /><CodeLine lineNumber="349"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;LiveInterval &#42;, 8&gt;</a> SplitLIs;</span></CodeLine>
<Link id="l00350" /><CodeLine lineNumber="350"><span class="doxyHighlight">      LIS-&gt;splitSeparateComponents(&#42;LI, SplitLIs);</span></CodeLine>
<Link id="l00351" /><CodeLine lineNumber="351"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00352" /><CodeLine lineNumber="352"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00353" /><CodeLine lineNumber="353"></CodeLine>
<Link id="l00354" /><CodeLine lineNumber="354"><span class="doxyHighlightComment">  /// Wrapper Method to do all the necessary work when an Instruction is</span></CodeLine>
<Link id="l00355" /><CodeLine lineNumber="355"><span class="doxyHighlightComment">  /// deleted.</span></CodeLine>
<Link id="l00356" /><CodeLine lineNumber="356"><span class="doxyHighlightComment">  /// Optimizations should use this to make sure that deleted instructions</span></CodeLine>
<Link id="l00357" /><CodeLine lineNumber="357"><span class="doxyHighlightComment">  /// are always accounted for.</span></CodeLine>
<Link id="l00358" /><CodeLine lineNumber="358"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> deleteInstr(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l00359" /><CodeLine lineNumber="359"><span class="doxyHighlight">    ErasedInstrs.insert(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l00360" /><CodeLine lineNumber="360"><span class="doxyHighlight">    LIS-&gt;RemoveMachineInstrFromMaps(&#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l00361" /><CodeLine lineNumber="361"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;eraseFromParent();</span></CodeLine>
<Link id="l00362" /><CodeLine lineNumber="362"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00363" /><CodeLine lineNumber="363"></CodeLine>
<Link id="l00364" /><CodeLine lineNumber="364"><span class="doxyHighlightComment">  /// Walk over function and initialize the DbgVRegToValues map.</span></CodeLine>
<Link id="l00365" /><CodeLine lineNumber="365"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregcoloring-cpp/#a363e3f71faf094bba68a16bb32f43cff">buildVRegToDbgValueMap</a>(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF);</span></CodeLine>
<Link id="l00366" /><CodeLine lineNumber="366"></CodeLine>
<Link id="l00367" /><CodeLine lineNumber="367"><span class="doxyHighlightComment">  /// Test whether, after merging, any DBG&#95;VALUEs would refer to a</span></CodeLine>
<Link id="l00368" /><CodeLine lineNumber="368"><span class="doxyHighlightComment">  /// different value number than before merging, and whether this can</span></CodeLine>
<Link id="l00369" /><CodeLine lineNumber="369"><span class="doxyHighlightComment">  /// be resolved. If not, mark the DBG&#95;VALUE as being undef.</span></CodeLine>
<Link id="l00370" /><CodeLine lineNumber="370"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> checkMergingChangesDbgValues(<a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP, <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;LHS,</span></CodeLine>
<Link id="l00371" /><CodeLine lineNumber="371"><span class="doxyHighlight">                                    <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp;LHSVals, <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;RHS,</span></CodeLine>
<Link id="l00372" /><CodeLine lineNumber="372"><span class="doxyHighlight">                                    <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp;RHSVals);</span></CodeLine>
<Link id="l00373" /><CodeLine lineNumber="373"></CodeLine>
<Link id="l00374" /><CodeLine lineNumber="374"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> checkMergingChangesDbgValuesImpl(<a href="/docs/api/classes/llvm/register">Register</a> Reg, <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;OtherRange,</span></CodeLine>
<Link id="l00375" /><CodeLine lineNumber="375"><span class="doxyHighlight">                                        <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;RegRange, <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp;Vals2);</span></CodeLine>
<Link id="l00376" /><CodeLine lineNumber="376"></CodeLine>
<Link id="l00377" /><CodeLine lineNumber="377"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00378" /><CodeLine lineNumber="378" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a4199b9116f012d49b3ea0ef0dee730fa"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a4199b9116f012d49b3ea0ef0dee730fa">ID</a>; </span><span class="doxyHighlightComment">///&lt; Class identification, replacement for typeinfo</span></CodeLine>
<Link id="l00379" /><CodeLine lineNumber="379"></CodeLine>
<Link id="l00380" /><CodeLine lineNumber="380" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a0969ad06eb530c7fc3a7d2b8b9911fa6"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a0969ad06eb530c7fc3a7d2b8b9911fa6">RegisterCoalescer</a>() : <a href="/docs/api/classes/llvm/machinefunctionpass/#a29c81d2386f4a727c6d33413807530c8">MachineFunctionPass</a>(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a4199b9116f012d49b3ea0ef0dee730fa">ID</a>) &#123;</span></CodeLine>
<Link id="l00381" /><CodeLine lineNumber="381"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a238eae485eb747cb1ca649ea599b5c82">initializeRegisterCoalescerPass</a>(&#42;<a href="/docs/api/classes/llvm/passregistry/#a05a729900b76c89e808c6c3094921b2f">PassRegistry::getPassRegistry</a>());</span></CodeLine>
<Link id="l00382" /><CodeLine lineNumber="382"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00383" /><CodeLine lineNumber="383"></CodeLine>
<Link id="l00384" /><CodeLine lineNumber="384"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> getAnalysisUsage(<a href="/docs/api/classes/llvm/analysisusage">AnalysisUsage</a> &amp;AU) </span><span class="doxyHighlightKeyword">const override</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00385" /><CodeLine lineNumber="385"></CodeLine>
<Link id="l00386" /><CodeLine lineNumber="386" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a7d6fd0a43420aacdcb844afc48c3b9cb"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinefunctionproperties">MachineFunctionProperties</a> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a7d6fd0a43420aacdcb844afc48c3b9cb">getClearedProperties</a>()</span><span class="doxyHighlightKeyword"> const override </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00387" /><CodeLine lineNumber="387"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinefunctionproperties">MachineFunctionProperties</a>().<a href="/docs/api/classes/llvm/machinefunctionproperties/#aa7780563d7ca260d0ae67d957b56427f">set</a>(</span></CodeLine>
<Link id="l00388" /><CodeLine lineNumber="388"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/machinefunctionproperties/#ad85237c6c667e4713efe8921e9c32ac1a4fc3b812627e58da17a703f73013db96">MachineFunctionProperties::Property::IsSSA</a>);</span></CodeLine>
<Link id="l00389" /><CodeLine lineNumber="389"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00390" /><CodeLine lineNumber="390"></CodeLine>
<Link id="l00391" /><CodeLine lineNumber="391"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> releaseMemory() </span><span class="doxyHighlightKeyword">override</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00392" /><CodeLine lineNumber="392"></CodeLine>
<Link id="l00393" /><CodeLine lineNumber="393"><span class="doxyHighlightComment">  /// This is the pass entry point.</span></CodeLine>
<Link id="l00394" /><CodeLine lineNumber="394"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> runOnMachineFunction(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;) </span><span class="doxyHighlightKeyword">override</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00395" /><CodeLine lineNumber="395"></CodeLine>
<Link id="l00396" /><CodeLine lineNumber="396"><span class="doxyHighlightComment">  /// Implement the dump method.</span></CodeLine>
<Link id="l00397" /><CodeLine lineNumber="397"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/object/archivewriter-cpp/#aa9f638c7ae7fdd206a6c60e26bef9751">print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;O, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/module">Module</a> &#42; = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">) </span><span class="doxyHighlightKeyword">const override</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00398" /><CodeLine lineNumber="398"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00399" /><CodeLine lineNumber="399"></CodeLine>
<Link id="l00400" /><CodeLine lineNumber="400"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l00401" /><CodeLine lineNumber="401"></CodeLine>
<Link id="l00402" /><CodeLine lineNumber="402"><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a4199b9116f012d49b3ea0ef0dee730fa">RegisterCoalescer::ID</a> = 0;</span></CodeLine>
<Link id="l00403" /><CodeLine lineNumber="403"></CodeLine>
<Link id="l00404" /><CodeLine lineNumber="404" lineLink="/docs/api/namespaces/llvm/#a1a97dc750eaae6c6c05a7f2ab03cdffc"><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#a1a97dc750eaae6c6c05a7f2ab03cdffc">llvm::RegisterCoalescerID</a> = <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a4199b9116f012d49b3ea0ef0dee730fa">RegisterCoalescer::ID</a>;</span></CodeLine>
<Link id="l00405" /><CodeLine lineNumber="405"></CodeLine>
<Link id="l00406" /><CodeLine lineNumber="406" lineLink="#af060f5a17701ea45bc64cd57b59799e4"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#aaa970fc931c1c63037a8182e028d04b1">INITIALIZE&#95;PASS&#95;BEGIN</a>(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a0969ad06eb530c7fc3a7d2b8b9911fa6">RegisterCoalescer</a>, </span><span class="doxyHighlightStringLiteral">&quot;register-coalescer&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00407" /><CodeLine lineNumber="407"><span class="doxyHighlight">                      </span><span class="doxyHighlightStringLiteral">&quot;Register Coalescer&quot;</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l00408" /><CodeLine lineNumber="408"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/liveintervalswrapperpass">LiveIntervalsWrapperPass</a>)</span></CodeLine>
<Link id="l00409" /><CodeLine lineNumber="409"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/slotindexeswrapperpass">SlotIndexesWrapperPass</a>)</span></CodeLine>
<Link id="l00410" /><CodeLine lineNumber="410"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/machineloopinfowrapperpass">MachineLoopInfoWrapperPass</a>)</span></CodeLine>
<Link id="l00411" /><CodeLine lineNumber="411"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a14724f1ccf528e73bb29bc9230737967">INITIALIZE&#95;PASS&#95;DEPENDENCY</a>(<a href="/docs/api/classes/llvm/aaresultswrapperpass">AAResultsWrapperPass</a>)</span></CodeLine>
<Link id="l00412" /><CodeLine lineNumber="412" lineLink="#a431319a3132451944eb1d97c9514e476"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/passsupport-h/#a74ce8276b89067e806f67c45a6d92575">INITIALIZE&#95;PASS&#95;END</a>(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a0969ad06eb530c7fc3a7d2b8b9911fa6">RegisterCoalescer</a>, </span><span class="doxyHighlightStringLiteral">&quot;register-coalescer&quot;</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l00413" /><CodeLine lineNumber="413" lineLink="#a389c1946f85ea45762fef471b4c995f6"><span class="doxyHighlight">                    </span><span class="doxyHighlightStringLiteral">&quot;Register Coalescer&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/false">false</a>, <a href="/docs/api/namespaces/false">false</a>)</span></CodeLine>
<Link id="l00414" /><CodeLine lineNumber="414"></CodeLine>
<Link id="l00415" /><CodeLine lineNumber="415" lineLink="#aaeffdea43602557f6c520f6b9501a491"><span class="doxyHighlight">&#91;&#91;nodiscard&#93;&#93; static </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#aaeffdea43602557f6c520f6b9501a491">isMoveInstr</a>(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &amp;tri,</span></CodeLine>
<Link id="l00416" /><CodeLine lineNumber="416"><span class="doxyHighlight">                                      <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64promoteconstant-cpp/#a90f8350fecae261c25be85d38b451bff">const</a> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a href="/docs/api/classes/llvm/register">Register</a> &amp;Src,</span></CodeLine>
<Link id="l00417" /><CodeLine lineNumber="417"><span class="doxyHighlight">                                      <a href="/docs/api/classes/llvm/register">Register</a> &amp;Dst, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> &amp;SrcSub,</span></CodeLine>
<Link id="l00418" /><CodeLine lineNumber="418"><span class="doxyHighlight">                                      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> &amp;DstSub) &#123;</span></CodeLine>
<Link id="l00419" /><CodeLine lineNumber="419"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isCopy()) &#123;</span></CodeLine>
<Link id="l00420" /><CodeLine lineNumber="420"><span class="doxyHighlight">    Dst = MI-&gt;getOperand(0).getReg();</span></CodeLine>
<Link id="l00421" /><CodeLine lineNumber="421"><span class="doxyHighlight">    DstSub = MI-&gt;getOperand(0).getSubReg();</span></CodeLine>
<Link id="l00422" /><CodeLine lineNumber="422"><span class="doxyHighlight">    Src = MI-&gt;getOperand(1).getReg();</span></CodeLine>
<Link id="l00423" /><CodeLine lineNumber="423"><span class="doxyHighlight">    SrcSub = MI-&gt;getOperand(1).getSubReg();</span></CodeLine>
<Link id="l00424" /><CodeLine lineNumber="424"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/passes/passbuilderbindings-cpp/#acdfbcf188e2d4a80837e89de2ccdffab">if</a> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isSubregToReg()) &#123;</span></CodeLine>
<Link id="l00425" /><CodeLine lineNumber="425"><span class="doxyHighlight">    Dst = MI-&gt;getOperand(0).getReg();</span></CodeLine>
<Link id="l00426" /><CodeLine lineNumber="426"><span class="doxyHighlight">    DstSub = tri.composeSubRegIndices(MI-&gt;getOperand(0).getSubReg(),</span></CodeLine>
<Link id="l00427" /><CodeLine lineNumber="427"><span class="doxyHighlight">                                      MI-&gt;getOperand(3).getImm());</span></CodeLine>
<Link id="l00428" /><CodeLine lineNumber="428"><span class="doxyHighlight">    Src = MI-&gt;getOperand(2).getReg();</span></CodeLine>
<Link id="l00429" /><CodeLine lineNumber="429"><span class="doxyHighlight">    SrcSub = MI-&gt;getOperand(2).getSubReg();</span></CodeLine>
<Link id="l00430" /><CodeLine lineNumber="430"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00431" /><CodeLine lineNumber="431"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00432" /><CodeLine lineNumber="432"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00433" /><CodeLine lineNumber="433"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00434" /><CodeLine lineNumber="434"></CodeLine>
<Link id="l00435" /><CodeLine lineNumber="435"><span class="doxyHighlightComment">/// Return true if this block should be vacated by the coalescer to eliminate</span></CodeLine>
<Link id="l00436" /><CodeLine lineNumber="436"><span class="doxyHighlightComment">/// branches. The important cases to handle in the coalescer are critical edges</span></CodeLine>
<Link id="l00437" /><CodeLine lineNumber="437"><span class="doxyHighlightComment">/// split during phi elimination which contain only copies. Simple blocks that</span></CodeLine>
<Link id="l00438" /><CodeLine lineNumber="438"><span class="doxyHighlightComment">/// contain non-branches should also be vacated, but this can be handled by an</span></CodeLine>
<Link id="l00439" /><CodeLine lineNumber="439"><span class="doxyHighlightComment">/// earlier pass similar to early if-conversion.</span></CodeLine>
<Link id="l00440" /><CodeLine lineNumber="440" lineLink="#a30f590c564c38a3893fcd46927b5e482"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a30f590c564c38a3893fcd46927b5e482">isSplitEdge</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l00441" /><CodeLine lineNumber="441"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;pred&#95;size() != 1 || <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;succ&#95;size() != 1)</span></CodeLine>
<Link id="l00442" /><CodeLine lineNumber="442"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00443" /><CodeLine lineNumber="443"></CodeLine>
<Link id="l00444" /><CodeLine lineNumber="444"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l00445" /><CodeLine lineNumber="445"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCopyLike() &amp;&amp; !<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isUnconditionalBranch())</span></CodeLine>
<Link id="l00446" /><CodeLine lineNumber="446"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00447" /><CodeLine lineNumber="447"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00448" /><CodeLine lineNumber="448"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00449" /><CodeLine lineNumber="449"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00450" /><CodeLine lineNumber="450"></CodeLine>
<Link id="l00451" /><CodeLine lineNumber="451" lineLink="/docs/api/classes/llvm/coalescerpair/#acf12cb8b07d5443c8777257d1b9a1dc7"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair/#acf12cb8b07d5443c8777257d1b9a1dc7">CoalescerPair::setRegisters</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l00452" /><CodeLine lineNumber="452"><span class="doxyHighlight">  SrcReg = DstReg = <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>();</span></CodeLine>
<Link id="l00453" /><CodeLine lineNumber="453"><span class="doxyHighlight">  SrcIdx = DstIdx = 0;</span></CodeLine>
<Link id="l00454" /><CodeLine lineNumber="454"><span class="doxyHighlight">  NewRC = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00455" /><CodeLine lineNumber="455"><span class="doxyHighlight">  Flipped = CrossClass = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00456" /><CodeLine lineNumber="456"></CodeLine>
<Link id="l00457" /><CodeLine lineNumber="457"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> Src, Dst;</span></CodeLine>
<Link id="l00458" /><CodeLine lineNumber="458"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SrcSub = 0, DstSub = 0;</span></CodeLine>
<Link id="l00459" /><CodeLine lineNumber="459"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aaeffdea43602557f6c520f6b9501a491">isMoveInstr</a>(TRI, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, Src, Dst, SrcSub, DstSub))</span></CodeLine>
<Link id="l00460" /><CodeLine lineNumber="460"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00461" /><CodeLine lineNumber="461"><span class="doxyHighlight">  Partial = SrcSub || DstSub;</span></CodeLine>
<Link id="l00462" /><CodeLine lineNumber="462"></CodeLine>
<Link id="l00463" /><CodeLine lineNumber="463"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If one register is a physreg, it must be Dst.</span></CodeLine>
<Link id="l00464" /><CodeLine lineNumber="464"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Src.isPhysical()) &#123;</span></CodeLine>
<Link id="l00465" /><CodeLine lineNumber="465"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Dst.isPhysical())</span></CodeLine>
<Link id="l00466" /><CodeLine lineNumber="466"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00467" /><CodeLine lineNumber="467"><span class="doxyHighlight">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Src, Dst);</span></CodeLine>
<Link id="l00468" /><CodeLine lineNumber="468"><span class="doxyHighlight">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcSub, DstSub);</span></CodeLine>
<Link id="l00469" /><CodeLine lineNumber="469"><span class="doxyHighlight">    Flipped = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00470" /><CodeLine lineNumber="470"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00471" /><CodeLine lineNumber="471"></CodeLine>
<Link id="l00472" /><CodeLine lineNumber="472"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineregisterinfo">MachineRegisterInfo</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a> = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getMF()-&gt;getRegInfo();</span></CodeLine>
<Link id="l00473" /><CodeLine lineNumber="473"></CodeLine>
<Link id="l00474" /><CodeLine lineNumber="474"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Dst.isPhysical()) &#123;</span></CodeLine>
<Link id="l00475" /><CodeLine lineNumber="475"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Eliminate DstSub on a physreg.</span></CodeLine>
<Link id="l00476" /><CodeLine lineNumber="476"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstSub) &#123;</span></CodeLine>
<Link id="l00477" /><CodeLine lineNumber="477"><span class="doxyHighlight">      Dst = TRI.getSubReg(Dst, DstSub);</span></CodeLine>
<Link id="l00478" /><CodeLine lineNumber="478"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Dst)</span></CodeLine>
<Link id="l00479" /><CodeLine lineNumber="479"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00480" /><CodeLine lineNumber="480"><span class="doxyHighlight">      DstSub = 0;</span></CodeLine>
<Link id="l00481" /><CodeLine lineNumber="481"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00482" /><CodeLine lineNumber="482"></CodeLine>
<Link id="l00483" /><CodeLine lineNumber="483"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Eliminate SrcSub by picking a corresponding Dst superregister.</span></CodeLine>
<Link id="l00484" /><CodeLine lineNumber="484"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcSub) &#123;</span></CodeLine>
<Link id="l00485" /><CodeLine lineNumber="485"><span class="doxyHighlight">      Dst = TRI.getMatchingSuperReg(Dst, SrcSub, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.getRegClass(Src));</span></CodeLine>
<Link id="l00486" /><CodeLine lineNumber="486"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Dst)</span></CodeLine>
<Link id="l00487" /><CodeLine lineNumber="487"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00488" /><CodeLine lineNumber="488"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.getRegClass(Src)-&gt;contains(Dst)) &#123;</span></CodeLine>
<Link id="l00489" /><CodeLine lineNumber="489"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00490" /><CodeLine lineNumber="490"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00491" /><CodeLine lineNumber="491"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00492" /><CodeLine lineNumber="492"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Both registers are virtual.</span></CodeLine>
<Link id="l00493" /><CodeLine lineNumber="493"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterclass">TargetRegisterClass</a> &#42;SrcRC = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.getRegClass(Src);</span></CodeLine>
<Link id="l00494" /><CodeLine lineNumber="494"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterclass">TargetRegisterClass</a> &#42;DstRC = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>.getRegClass(Dst);</span></CodeLine>
<Link id="l00495" /><CodeLine lineNumber="495"></CodeLine>
<Link id="l00496" /><CodeLine lineNumber="496"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Both registers have subreg indices.</span></CodeLine>
<Link id="l00497" /><CodeLine lineNumber="497"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcSub &amp;&amp; DstSub) &#123;</span></CodeLine>
<Link id="l00498" /><CodeLine lineNumber="498"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Copies between different sub-registers are never coalescable.</span></CodeLine>
<Link id="l00499" /><CodeLine lineNumber="499"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Src == Dst &amp;&amp; SrcSub != DstSub)</span></CodeLine>
<Link id="l00500" /><CodeLine lineNumber="500"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00501" /><CodeLine lineNumber="501"></CodeLine>
<Link id="l00502" /><CodeLine lineNumber="502"><span class="doxyHighlight">      NewRC = TRI.getCommonSuperRegClass(SrcRC, SrcSub, DstRC, DstSub, SrcIdx,</span></CodeLine>
<Link id="l00503" /><CodeLine lineNumber="503"><span class="doxyHighlight">                                         DstIdx);</span></CodeLine>
<Link id="l00504" /><CodeLine lineNumber="504"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewRC)</span></CodeLine>
<Link id="l00505" /><CodeLine lineNumber="505"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00506" /><CodeLine lineNumber="506"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstSub) &#123;</span></CodeLine>
<Link id="l00507" /><CodeLine lineNumber="507"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// SrcReg will be merged with a sub-register of DstReg.</span></CodeLine>
<Link id="l00508" /><CodeLine lineNumber="508"><span class="doxyHighlight">      SrcIdx = DstSub;</span></CodeLine>
<Link id="l00509" /><CodeLine lineNumber="509"><span class="doxyHighlight">      NewRC = TRI.getMatchingSuperRegClass(DstRC, SrcRC, DstSub);</span></CodeLine>
<Link id="l00510" /><CodeLine lineNumber="510"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcSub) &#123;</span></CodeLine>
<Link id="l00511" /><CodeLine lineNumber="511"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// DstReg will be merged with a sub-register of SrcReg.</span></CodeLine>
<Link id="l00512" /><CodeLine lineNumber="512"><span class="doxyHighlight">      DstIdx = SrcSub;</span></CodeLine>
<Link id="l00513" /><CodeLine lineNumber="513"><span class="doxyHighlight">      NewRC = TRI.getMatchingSuperRegClass(SrcRC, DstRC, SrcSub);</span></CodeLine>
<Link id="l00514" /><CodeLine lineNumber="514"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00515" /><CodeLine lineNumber="515"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// This is a straight copy without sub-registers.</span></CodeLine>
<Link id="l00516" /><CodeLine lineNumber="516"><span class="doxyHighlight">      NewRC = TRI.getCommonSubClass(DstRC, SrcRC);</span></CodeLine>
<Link id="l00517" /><CodeLine lineNumber="517"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00518" /><CodeLine lineNumber="518"></CodeLine>
<Link id="l00519" /><CodeLine lineNumber="519"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The combined constraint may be impossible to satisfy.</span></CodeLine>
<Link id="l00520" /><CodeLine lineNumber="520"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewRC)</span></CodeLine>
<Link id="l00521" /><CodeLine lineNumber="521"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00522" /><CodeLine lineNumber="522"></CodeLine>
<Link id="l00523" /><CodeLine lineNumber="523"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Prefer SrcReg to be a sub-register of DstReg.</span></CodeLine>
<Link id="l00524" /><CodeLine lineNumber="524"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// FIXME: Coalescer should support subregs symmetrically.</span></CodeLine>
<Link id="l00525" /><CodeLine lineNumber="525"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstIdx &amp;&amp; !SrcIdx) &#123;</span></CodeLine>
<Link id="l00526" /><CodeLine lineNumber="526"><span class="doxyHighlight">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Src, Dst);</span></CodeLine>
<Link id="l00527" /><CodeLine lineNumber="527"><span class="doxyHighlight">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcIdx, DstIdx);</span></CodeLine>
<Link id="l00528" /><CodeLine lineNumber="528"><span class="doxyHighlight">      Flipped = !Flipped;</span></CodeLine>
<Link id="l00529" /><CodeLine lineNumber="529"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00530" /><CodeLine lineNumber="530"></CodeLine>
<Link id="l00531" /><CodeLine lineNumber="531"><span class="doxyHighlight">    CrossClass = NewRC != DstRC || NewRC != SrcRC;</span></CodeLine>
<Link id="l00532" /><CodeLine lineNumber="532"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00533" /><CodeLine lineNumber="533"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check our invariants</span></CodeLine>
<Link id="l00534" /><CodeLine lineNumber="534"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Src.isVirtual() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Src must be virtual&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00535" /><CodeLine lineNumber="535"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!(Dst.isPhysical() &amp;&amp; DstSub) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Cannot have a physical SubIdx&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00536" /><CodeLine lineNumber="536"><span class="doxyHighlight">  SrcReg = Src;</span></CodeLine>
<Link id="l00537" /><CodeLine lineNumber="537"><span class="doxyHighlight">  DstReg = Dst;</span></CodeLine>
<Link id="l00538" /><CodeLine lineNumber="538"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00539" /><CodeLine lineNumber="539"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00540" /><CodeLine lineNumber="540"></CodeLine>
<Link id="l00541" /><CodeLine lineNumber="541" lineLink="/docs/api/classes/llvm/coalescerpair/#a46ebf2b548d5b38599073fe56b75bec0"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair/#a46ebf2b548d5b38599073fe56b75bec0">CoalescerPair::flip</a>() &#123;</span></CodeLine>
<Link id="l00542" /><CodeLine lineNumber="542"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstReg.isPhysical())</span></CodeLine>
<Link id="l00543" /><CodeLine lineNumber="543"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00544" /><CodeLine lineNumber="544"><span class="doxyHighlight">  <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcReg, DstReg);</span></CodeLine>
<Link id="l00545" /><CodeLine lineNumber="545"><span class="doxyHighlight">  <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcIdx, DstIdx);</span></CodeLine>
<Link id="l00546" /><CodeLine lineNumber="546"><span class="doxyHighlight">  Flipped = !Flipped;</span></CodeLine>
<Link id="l00547" /><CodeLine lineNumber="547"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00548" /><CodeLine lineNumber="548"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00549" /><CodeLine lineNumber="549"></CodeLine>
<Link id="l00550" /><CodeLine lineNumber="550" lineLink="/docs/api/classes/llvm/coalescerpair/#aa94992e6e4022b1175f8015cde4e60b9"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair/#aa94992e6e4022b1175f8015cde4e60b9">CoalescerPair::isCoalescable</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00551" /><CodeLine lineNumber="551"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)</span></CodeLine>
<Link id="l00552" /><CodeLine lineNumber="552"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00553" /><CodeLine lineNumber="553"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> Src, Dst;</span></CodeLine>
<Link id="l00554" /><CodeLine lineNumber="554"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SrcSub = 0, DstSub = 0;</span></CodeLine>
<Link id="l00555" /><CodeLine lineNumber="555"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aaeffdea43602557f6c520f6b9501a491">isMoveInstr</a>(TRI, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, Src, Dst, SrcSub, DstSub))</span></CodeLine>
<Link id="l00556" /><CodeLine lineNumber="556"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00557" /><CodeLine lineNumber="557"></CodeLine>
<Link id="l00558" /><CodeLine lineNumber="558"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Find the virtual register that is SrcReg.</span></CodeLine>
<Link id="l00559" /><CodeLine lineNumber="559"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Dst == SrcReg) &#123;</span></CodeLine>
<Link id="l00560" /><CodeLine lineNumber="560"><span class="doxyHighlight">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(Src, Dst);</span></CodeLine>
<Link id="l00561" /><CodeLine lineNumber="561"><span class="doxyHighlight">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcSub, DstSub);</span></CodeLine>
<Link id="l00562" /><CodeLine lineNumber="562"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Src != SrcReg) &#123;</span></CodeLine>
<Link id="l00563" /><CodeLine lineNumber="563"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00564" /><CodeLine lineNumber="564"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00565" /><CodeLine lineNumber="565"></CodeLine>
<Link id="l00566" /><CodeLine lineNumber="566"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now check that Dst matches DstReg.</span></CodeLine>
<Link id="l00567" /><CodeLine lineNumber="567"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstReg.isPhysical()) &#123;</span></CodeLine>
<Link id="l00568" /><CodeLine lineNumber="568"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Dst.isPhysical())</span></CodeLine>
<Link id="l00569" /><CodeLine lineNumber="569"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00570" /><CodeLine lineNumber="570"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!DstIdx &amp;&amp; !SrcIdx &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Inconsistent CoalescerPair state.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00571" /><CodeLine lineNumber="571"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// DstSub could be set for a physreg from INSERT&#95;SUBREG.</span></CodeLine>
<Link id="l00572" /><CodeLine lineNumber="572"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstSub)</span></CodeLine>
<Link id="l00573" /><CodeLine lineNumber="573"><span class="doxyHighlight">      Dst = TRI.getSubReg(Dst, DstSub);</span></CodeLine>
<Link id="l00574" /><CodeLine lineNumber="574"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Full copy of Src.</span></CodeLine>
<Link id="l00575" /><CodeLine lineNumber="575"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SrcSub)</span></CodeLine>
<Link id="l00576" /><CodeLine lineNumber="576"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> DstReg == Dst;</span></CodeLine>
<Link id="l00577" /><CodeLine lineNumber="577"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This is a partial register copy. Check that the parts match.</span></CodeLine>
<Link id="l00578" /><CodeLine lineNumber="578"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>(TRI.getSubReg(DstReg, SrcSub)) == Dst;</span></CodeLine>
<Link id="l00579" /><CodeLine lineNumber="579"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00580" /><CodeLine lineNumber="580"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// DstReg is virtual.</span></CodeLine>
<Link id="l00581" /><CodeLine lineNumber="581"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstReg != Dst)</span></CodeLine>
<Link id="l00582" /><CodeLine lineNumber="582"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00583" /><CodeLine lineNumber="583"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Registers match, do the subregisters line up?</span></CodeLine>
<Link id="l00584" /><CodeLine lineNumber="584"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> TRI.composeSubRegIndices(SrcIdx, SrcSub) ==</span></CodeLine>
<Link id="l00585" /><CodeLine lineNumber="585"><span class="doxyHighlight">           TRI.composeSubRegIndices(DstIdx, DstSub);</span></CodeLine>
<Link id="l00586" /><CodeLine lineNumber="586"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00587" /><CodeLine lineNumber="587"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00588" /><CodeLine lineNumber="588"></CodeLine>
<Link id="l00589" /><CodeLine lineNumber="589" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a3ae96d8cb445f62aa68d962e73704705"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a3ae96d8cb445f62aa68d962e73704705">RegisterCoalescer::getAnalysisUsage</a>(<a href="/docs/api/classes/llvm/analysisusage">AnalysisUsage</a> &amp;AU)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00590" /><CodeLine lineNumber="590"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#af11a6ebf7ab3c388234cb6d5378439a3">setPreservesCFG</a>();</span></CodeLine>
<Link id="l00591" /><CodeLine lineNumber="591"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/aaresultswrapperpass">AAResultsWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l00592" /><CodeLine lineNumber="592"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/liveintervalswrapperpass">LiveIntervalsWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l00593" /><CodeLine lineNumber="593"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/liveintervalswrapperpass">LiveIntervalsWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l00594" /><CodeLine lineNumber="594"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/slotindexeswrapperpass">SlotIndexesWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l00595" /><CodeLine lineNumber="595"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae0adcccca08fb686c9ce00f9397b660c">addRequired</a>&lt;<a href="/docs/api/classes/llvm/machineloopinfowrapperpass">MachineLoopInfoWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l00596" /><CodeLine lineNumber="596"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#ae9356b720f6fbab112d809738dcc4f2a">addPreserved</a>&lt;<a href="/docs/api/classes/llvm/machineloopinfowrapperpass">MachineLoopInfoWrapperPass</a>&gt;();</span></CodeLine>
<Link id="l00597" /><CodeLine lineNumber="597"><span class="doxyHighlight">  AU.<a href="/docs/api/classes/llvm/analysisusage/#a573df5c9c3024ebb646e15cc7450bf91">addPreservedID</a>(<a href="/docs/api/namespaces/llvm/#a311f0d695e161f1c86664c796d6cfea0">MachineDominatorsID</a>);</span></CodeLine>
<Link id="l00598" /><CodeLine lineNumber="598"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinefunctionpass/#a864fd57b4304ef933b3281d0ef85a88e">MachineFunctionPass::getAnalysisUsage</a>(AU);</span></CodeLine>
<Link id="l00599" /><CodeLine lineNumber="599"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00600" /><CodeLine lineNumber="600"></CodeLine>
<Link id="l00601" /><CodeLine lineNumber="601"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::eliminateDeadDefs(<a href="/docs/api/classes/llvm/liverangeedit">LiveRangeEdit</a> &#42;Edit) &#123;</span></CodeLine>
<Link id="l00602" /><CodeLine lineNumber="602"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Edit) &#123;</span></CodeLine>
<Link id="l00603" /><CodeLine lineNumber="603"><span class="doxyHighlight">    Edit-&gt;<a href="/docs/api/classes/llvm/liverangeedit/#add47e6d974ce584ea3fa3fc80ee34259">eliminateDeadDefs</a>(DeadDefs);</span></CodeLine>
<Link id="l00604" /><CodeLine lineNumber="604"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00605" /><CodeLine lineNumber="605"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00606" /><CodeLine lineNumber="606"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Register, 8&gt;</a> NewRegs;</span></CodeLine>
<Link id="l00607" /><CodeLine lineNumber="607"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liverangeedit">LiveRangeEdit</a>(</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, NewRegs, &#42;MF, &#42;LIS, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l00608" /><CodeLine lineNumber="608"><span class="doxyHighlight">      .<a href="/docs/api/classes/llvm/liverangeedit/#add47e6d974ce584ea3fa3fc80ee34259">eliminateDeadDefs</a>(DeadDefs);</span></CodeLine>
<Link id="l00609" /><CodeLine lineNumber="609"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00610" /><CodeLine lineNumber="610"></CodeLine>
<Link id="l00611" /><CodeLine lineNumber="611"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::LRE&#95;WillEraseInstruction(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l00612" /><CodeLine lineNumber="612"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// MI may be in WorkList. Make sure we don&#39;t visit it.</span></CodeLine>
<Link id="l00613" /><CodeLine lineNumber="613"><span class="doxyHighlight">  ErasedInstrs.insert(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l00614" /><CodeLine lineNumber="614"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00615" /><CodeLine lineNumber="615"></CodeLine>
<Link id="l00616" /><CodeLine lineNumber="616"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::adjustCopiesBackFrom(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP,</span></CodeLine>
<Link id="l00617" /><CodeLine lineNumber="617"><span class="doxyHighlight">                                             <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI) &#123;</span></CodeLine>
<Link id="l00618" /><CodeLine lineNumber="618"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPartial() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;This doesn&#39;t work for partial copies.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00619" /><CodeLine lineNumber="619"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;This doesn&#39;t work for physreg copies.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00620" /><CodeLine lineNumber="620"></CodeLine>
<Link id="l00621" /><CodeLine lineNumber="621"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntA =</span></CodeLine>
<Link id="l00622" /><CodeLine lineNumber="622"><span class="doxyHighlight">      LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l00623" /><CodeLine lineNumber="623"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntB =</span></CodeLine>
<Link id="l00624" /><CodeLine lineNumber="624"><span class="doxyHighlight">      LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l00625" /><CodeLine lineNumber="625"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CopyIdx = LIS-&gt;getInstructionIndex(&#42;CopyMI).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</span></CodeLine>
<Link id="l00626" /><CodeLine lineNumber="626"></CodeLine>
<Link id="l00627" /><CodeLine lineNumber="627"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We have a non-trivially-coalescable copy with IntA being the source and</span></CodeLine>
<Link id="l00628" /><CodeLine lineNumber="628"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// IntB being the dest, thus this defines a value number in IntB.  If the</span></CodeLine>
<Link id="l00629" /><CodeLine lineNumber="629"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// source value number (in IntA) is defined by a copy from B, see if we can</span></CodeLine>
<Link id="l00630" /><CodeLine lineNumber="630"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// merge these two pieces of B into a single value number, eliminating a copy.</span></CodeLine>
<Link id="l00631" /><CodeLine lineNumber="631"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For example:</span></CodeLine>
<Link id="l00632" /><CodeLine lineNumber="632"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00633" /><CodeLine lineNumber="633"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  A3 = B0</span></CodeLine>
<Link id="l00634" /><CodeLine lineNumber="634"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    ...</span></CodeLine>
<Link id="l00635" /><CodeLine lineNumber="635"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  B1 = A3      &lt;- this copy</span></CodeLine>
<Link id="l00636" /><CodeLine lineNumber="636"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00637" /><CodeLine lineNumber="637"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// In this case, B0 can be extended to where the B1 copy lives, allowing the</span></CodeLine>
<Link id="l00638" /><CodeLine lineNumber="638"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// B1 value number to be replaced with B0 (which simplifies the B</span></CodeLine>
<Link id="l00639" /><CodeLine lineNumber="639"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// liveinterval).</span></CodeLine>
<Link id="l00640" /><CodeLine lineNumber="640"></CodeLine>
<Link id="l00641" /><CodeLine lineNumber="641"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// BValNo is a value number in B that is defined by a copy from A.  &#39;B1&#39; in</span></CodeLine>
<Link id="l00642" /><CodeLine lineNumber="642"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the example above.</span></CodeLine>
<Link id="l00643" /><CodeLine lineNumber="643"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> BS = IntB.<a href="/docs/api/classes/llvm/liverange/#ae6eab1035db7ba328354fa739be090f0">FindSegmentContaining</a>(CopyIdx);</span></CodeLine>
<Link id="l00644" /><CodeLine lineNumber="644"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BS == IntB.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>())</span></CodeLine>
<Link id="l00645" /><CodeLine lineNumber="645"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00646" /><CodeLine lineNumber="646"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;BValNo = BS-&gt;valno;</span></CodeLine>
<Link id="l00647" /><CodeLine lineNumber="647"></CodeLine>
<Link id="l00648" /><CodeLine lineNumber="648"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Get the location that B is defined at.  Two options: either this value has</span></CodeLine>
<Link id="l00649" /><CodeLine lineNumber="649"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// an unknown definition point or it is defined at CopyIdx.  If unknown, we</span></CodeLine>
<Link id="l00650" /><CodeLine lineNumber="650"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// can&#39;t process it.</span></CodeLine>
<Link id="l00651" /><CodeLine lineNumber="651"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> != CopyIdx)</span></CodeLine>
<Link id="l00652" /><CodeLine lineNumber="652"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00653" /><CodeLine lineNumber="653"></CodeLine>
<Link id="l00654" /><CodeLine lineNumber="654"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// AValNo is the value number in A that defines the copy, A3 in the example.</span></CodeLine>
<Link id="l00655" /><CodeLine lineNumber="655"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CopyUseIdx = CopyIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00656" /><CodeLine lineNumber="656"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> AS = IntA.<a href="/docs/api/classes/llvm/liverange/#ae6eab1035db7ba328354fa739be090f0">FindSegmentContaining</a>(CopyUseIdx);</span></CodeLine>
<Link id="l00657" /><CodeLine lineNumber="657"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The live segment might not exist after fun with physreg coalescing.</span></CodeLine>
<Link id="l00658" /><CodeLine lineNumber="658"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AS == IntA.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>())</span></CodeLine>
<Link id="l00659" /><CodeLine lineNumber="659"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00660" /><CodeLine lineNumber="660"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;AValNo = AS-&gt;valno;</span></CodeLine>
<Link id="l00661" /><CodeLine lineNumber="661"></CodeLine>
<Link id="l00662" /><CodeLine lineNumber="662"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If AValNo is defined as a copy from IntB, we can potentially process this.</span></CodeLine>
<Link id="l00663" /><CodeLine lineNumber="663"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Get the instruction that defines this value number.</span></CodeLine>
<Link id="l00664" /><CodeLine lineNumber="664"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;ACopyMI = LIS-&gt;getInstructionFromIndex(AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l00665" /><CodeLine lineNumber="665"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Don&#39;t allow any partial copies, even if isCoalescable() allows them.</span></CodeLine>
<Link id="l00666" /><CodeLine lineNumber="666"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isCoalescable(ACopyMI) || !ACopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a6ee45760c97bf2dda6bee91508e6946e">isFullCopy</a>())</span></CodeLine>
<Link id="l00667" /><CodeLine lineNumber="667"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00668" /><CodeLine lineNumber="668"></CodeLine>
<Link id="l00669" /><CodeLine lineNumber="669"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Get the Segment in IntB that this value number starts with.</span></CodeLine>
<Link id="l00670" /><CodeLine lineNumber="670"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> ValS =</span></CodeLine>
<Link id="l00671" /><CodeLine lineNumber="671"><span class="doxyHighlight">      IntB.<a href="/docs/api/classes/llvm/liverange/#ae6eab1035db7ba328354fa739be090f0">FindSegmentContaining</a>(AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>.<a href="/docs/api/classes/llvm/slotindex/#ac832da130f4d71a4533a69d98315fb19">getPrevSlot</a>());</span></CodeLine>
<Link id="l00672" /><CodeLine lineNumber="672"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValS == IntB.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>())</span></CodeLine>
<Link id="l00673" /><CodeLine lineNumber="673"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00674" /><CodeLine lineNumber="674"></CodeLine>
<Link id="l00675" /><CodeLine lineNumber="675"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Make sure that the end of the live segment is inside the same block as</span></CodeLine>
<Link id="l00676" /><CodeLine lineNumber="676"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CopyMI.</span></CodeLine>
<Link id="l00677" /><CodeLine lineNumber="677"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;ValSEndInst =</span></CodeLine>
<Link id="l00678" /><CodeLine lineNumber="678"><span class="doxyHighlight">      LIS-&gt;getInstructionFromIndex(ValS-&gt;end.getPrevSlot());</span></CodeLine>
<Link id="l00679" /><CodeLine lineNumber="679"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!ValSEndInst || ValSEndInst-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>() != CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>())</span></CodeLine>
<Link id="l00680" /><CodeLine lineNumber="680"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00681" /><CodeLine lineNumber="681"></CodeLine>
<Link id="l00682" /><CodeLine lineNumber="682"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Okay, we now know that ValS ends in the same block that the CopyMI</span></CodeLine>
<Link id="l00683" /><CodeLine lineNumber="683"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// live-range starts.  If there are no intervening live segments between them</span></CodeLine>
<Link id="l00684" /><CodeLine lineNumber="684"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// in IntB, we can merge them.</span></CodeLine>
<Link id="l00685" /><CodeLine lineNumber="685"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValS + 1 != BS)</span></CodeLine>
<Link id="l00686" /><CodeLine lineNumber="686"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00687" /><CodeLine lineNumber="687"></CodeLine>
<Link id="l00688" /><CodeLine lineNumber="688"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Extending: &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>));</span></CodeLine>
<Link id="l00689" /><CodeLine lineNumber="689"></CodeLine>
<Link id="l00690" /><CodeLine lineNumber="690"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> FillerStart = ValS-&gt;end, FillerEnd = BS-&gt;start;</span></CodeLine>
<Link id="l00691" /><CodeLine lineNumber="691"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We are about to delete CopyMI, so need to remove it as the &#39;instruction</span></CodeLine>
<Link id="l00692" /><CodeLine lineNumber="692"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that defines this value #&#39;. Update the valnum with the new defining</span></CodeLine>
<Link id="l00693" /><CodeLine lineNumber="693"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instruction #.</span></CodeLine>
<Link id="l00694" /><CodeLine lineNumber="694"><span class="doxyHighlight">  BValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> = FillerStart;</span></CodeLine>
<Link id="l00695" /><CodeLine lineNumber="695"></CodeLine>
<Link id="l00696" /><CodeLine lineNumber="696"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Okay, we can merge them.  We need to insert a new liverange:</span></CodeLine>
<Link id="l00697" /><CodeLine lineNumber="697"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// &#91;ValS.end, BS.begin) of either value number, then we merge the</span></CodeLine>
<Link id="l00698" /><CodeLine lineNumber="698"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// two value numbers.</span></CodeLine>
<Link id="l00699" /><CodeLine lineNumber="699"><span class="doxyHighlight">  IntB.<a href="/docs/api/classes/llvm/liverange/#a0b73c8d5ae32ca13dd02ddde86ffd0a2">addSegment</a>(<a href="/docs/api/structs/llvm/liverange/segment">LiveInterval::Segment</a>(FillerStart, FillerEnd, BValNo));</span></CodeLine>
<Link id="l00700" /><CodeLine lineNumber="700"></CodeLine>
<Link id="l00701" /><CodeLine lineNumber="701"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Okay, merge &quot;B1&quot; into the same value number as &quot;B0&quot;.</span></CodeLine>
<Link id="l00702" /><CodeLine lineNumber="702"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BValNo != ValS-&gt;valno)</span></CodeLine>
<Link id="l00703" /><CodeLine lineNumber="703"><span class="doxyHighlight">    IntB.<a href="/docs/api/classes/llvm/liverange/#a92e17326c2170e889ae4390c56878b77">MergeValueNumberInto</a>(BValNo, ValS-&gt;valno);</span></CodeLine>
<Link id="l00704" /><CodeLine lineNumber="704"></CodeLine>
<Link id="l00705" /><CodeLine lineNumber="705"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Do the same for the subregister segments.</span></CodeLine>
<Link id="l00706" /><CodeLine lineNumber="706"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : IntB.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l00707" /><CodeLine lineNumber="707"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check for SubRange Segments of the form &#91;1234r,1234d:0) which can be</span></CodeLine>
<Link id="l00708" /><CodeLine lineNumber="708"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// removed to prevent creating bogus SubRange Segments.</span></CodeLine>
<Link id="l00709" /><CodeLine lineNumber="709"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> <a href="/docs/api/namespaces/llvm/x86as/#a58acad10b11edf7fe9b4465d6e02e9bda1337cc82304bed6c1a811f1a7f308aca">SS</a> = S.FindSegmentContaining(CopyIdx);</span></CodeLine>
<Link id="l00710" /><CodeLine lineNumber="710"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SS != S.end() &amp;&amp; <a href="/docs/api/classes/llvm/slotindex/#a0b73244049319d841fd11a238f35b5d1">SlotIndex::isSameInstr</a>(<a href="/docs/api/namespaces/llvm/x86as/#a58acad10b11edf7fe9b4465d6e02e9bda1337cc82304bed6c1a811f1a7f308aca">SS</a>-&gt;start, <a href="/docs/api/namespaces/llvm/x86as/#a58acad10b11edf7fe9b4465d6e02e9bda1337cc82304bed6c1a811f1a7f308aca">SS</a>-&gt;end)) &#123;</span></CodeLine>
<Link id="l00711" /><CodeLine lineNumber="711"><span class="doxyHighlight">      S.removeSegment(&#42;SS, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00712" /><CodeLine lineNumber="712"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00713" /><CodeLine lineNumber="713"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00714" /><CodeLine lineNumber="714"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The subrange may have ended before FillerStart. If so, extend it.</span></CodeLine>
<Link id="l00715" /><CodeLine lineNumber="715"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!S.getVNInfoAt(FillerStart)) &#123;</span></CodeLine>
<Link id="l00716" /><CodeLine lineNumber="716"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> BBStart =</span></CodeLine>
<Link id="l00717" /><CodeLine lineNumber="717"><span class="doxyHighlight">          LIS-&gt;getMBBStartIdx(LIS-&gt;getMBBFromIndex(FillerStart));</span></CodeLine>
<Link id="l00718" /><CodeLine lineNumber="718"><span class="doxyHighlight">      S.extendInBlock(BBStart, FillerStart);</span></CodeLine>
<Link id="l00719" /><CodeLine lineNumber="719"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00720" /><CodeLine lineNumber="720"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;SubBValNo = S.getVNInfoAt(CopyIdx);</span></CodeLine>
<Link id="l00721" /><CodeLine lineNumber="721"><span class="doxyHighlight">    S.addSegment(<a href="/docs/api/structs/llvm/liverange/segment">LiveInterval::Segment</a>(FillerStart, FillerEnd, SubBValNo));</span></CodeLine>
<Link id="l00722" /><CodeLine lineNumber="722"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;SubValSNo = S.getVNInfoAt(AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>.<a href="/docs/api/classes/llvm/slotindex/#ac832da130f4d71a4533a69d98315fb19">getPrevSlot</a>());</span></CodeLine>
<Link id="l00723" /><CodeLine lineNumber="723"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubBValNo != SubValSNo)</span></CodeLine>
<Link id="l00724" /><CodeLine lineNumber="724"><span class="doxyHighlight">      S.MergeValueNumberInto(SubBValNo, SubValSNo);</span></CodeLine>
<Link id="l00725" /><CodeLine lineNumber="725"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00726" /><CodeLine lineNumber="726"></CodeLine>
<Link id="l00727" /><CodeLine lineNumber="727"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;   result = &quot;</span><span class="doxyHighlight"> &lt;&lt; IntB &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00728" /><CodeLine lineNumber="728"></CodeLine>
<Link id="l00729" /><CodeLine lineNumber="729"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the source instruction was killing the source register before the</span></CodeLine>
<Link id="l00730" /><CodeLine lineNumber="730"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// merge, unset the isKill marker given the live range has been extended.</span></CodeLine>
<Link id="l00731" /><CodeLine lineNumber="731"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> UIdx =</span></CodeLine>
<Link id="l00732" /><CodeLine lineNumber="732"><span class="doxyHighlight">      ValSEndInst-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a6f42d93281a5cbf5360f836c09166c06">findRegisterUseOperandIdx</a>(IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), </span><span class="doxyHighlightComment">/&#42;TRI=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00733" /><CodeLine lineNumber="733"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UIdx != -1) &#123;</span></CodeLine>
<Link id="l00734" /><CodeLine lineNumber="734"><span class="doxyHighlight">    ValSEndInst-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(UIdx).<a href="/docs/api/classes/llvm/machineoperand/#a8a82683fccdef8a5ef772ef03277aee7">setIsKill</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00735" /><CodeLine lineNumber="735"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00736" /><CodeLine lineNumber="736"></CodeLine>
<Link id="l00737" /><CodeLine lineNumber="737"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Rewrite the copy.</span></CodeLine>
<Link id="l00738" /><CodeLine lineNumber="738"><span class="doxyHighlight">  CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a9f59e1f6dd6677348ba082a10fc09061">substituteRegister</a>(IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), 0, &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</span></CodeLine>
<Link id="l00739" /><CodeLine lineNumber="739"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the copy instruction was killing the destination register or any</span></CodeLine>
<Link id="l00740" /><CodeLine lineNumber="740"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// subrange before the merge trim the live range.</span></CodeLine>
<Link id="l00741" /><CodeLine lineNumber="741"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RecomputeLiveRange = AS-&gt;end == CopyIdx;</span></CodeLine>
<Link id="l00742" /><CodeLine lineNumber="742"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!RecomputeLiveRange) &#123;</span></CodeLine>
<Link id="l00743" /><CodeLine lineNumber="743"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : IntA.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l00744" /><CodeLine lineNumber="744"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> <a href="/docs/api/namespaces/llvm/x86as/#a58acad10b11edf7fe9b4465d6e02e9bda1337cc82304bed6c1a811f1a7f308aca">SS</a> = S.FindSegmentContaining(CopyUseIdx);</span></CodeLine>
<Link id="l00745" /><CodeLine lineNumber="745"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SS != S.end() &amp;&amp; <a href="/docs/api/namespaces/llvm/x86as/#a58acad10b11edf7fe9b4465d6e02e9bda1337cc82304bed6c1a811f1a7f308aca">SS</a>-&gt;end == CopyIdx) &#123;</span></CodeLine>
<Link id="l00746" /><CodeLine lineNumber="746"><span class="doxyHighlight">        RecomputeLiveRange = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00747" /><CodeLine lineNumber="747"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00748" /><CodeLine lineNumber="748"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00749" /><CodeLine lineNumber="749"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00750" /><CodeLine lineNumber="750"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00751" /><CodeLine lineNumber="751"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RecomputeLiveRange)</span></CodeLine>
<Link id="l00752" /><CodeLine lineNumber="752"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(&amp;IntA);</span></CodeLine>
<Link id="l00753" /><CodeLine lineNumber="753"></CodeLine>
<Link id="l00754" /><CodeLine lineNumber="754"><span class="doxyHighlight">  ++numExtends;</span></CodeLine>
<Link id="l00755" /><CodeLine lineNumber="755"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00756" /><CodeLine lineNumber="756"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00757" /><CodeLine lineNumber="757"></CodeLine>
<Link id="l00758" /><CodeLine lineNumber="758"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::hasOtherReachingDefs(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntA,</span></CodeLine>
<Link id="l00759" /><CodeLine lineNumber="759"><span class="doxyHighlight">                                             <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntB, <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;AValNo,</span></CodeLine>
<Link id="l00760" /><CodeLine lineNumber="760"><span class="doxyHighlight">                                             <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;BValNo) &#123;</span></CodeLine>
<Link id="l00761" /><CodeLine lineNumber="761"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If AValNo has PHI kills, conservatively assume that IntB defs can reach</span></CodeLine>
<Link id="l00762" /><CodeLine lineNumber="762"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the PHI values.</span></CodeLine>
<Link id="l00763" /><CodeLine lineNumber="763"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LIS-&gt;hasPHIKill(IntA, AValNo))</span></CodeLine>
<Link id="l00764" /><CodeLine lineNumber="764"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00765" /><CodeLine lineNumber="765"></CodeLine>
<Link id="l00766" /><CodeLine lineNumber="766"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/structs/llvm/liverange/segment">LiveRange::Segment</a> &amp;ASeg : IntA.<a href="/docs/api/classes/llvm/liverange/#a9c628b400be67b6adb4fa07e84a96a82">segments</a>) &#123;</span></CodeLine>
<Link id="l00767" /><CodeLine lineNumber="767"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ASeg.<a href="/docs/api/structs/llvm/liverange/segment/#ac3d1b43d371bc68742232ec51d4a6321">valno</a> != AValNo)</span></CodeLine>
<Link id="l00768" /><CodeLine lineNumber="768"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00769" /><CodeLine lineNumber="769"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> BI = <a href="/docs/api/namespaces/llvm/#a4b7d2ab11554bd10d15b6cb21b2c2787">llvm::upper&#95;bound</a>(IntB, ASeg.<a href="/docs/api/structs/llvm/liverange/segment/#a85f7bf79596d84273b5b3b9b490bc2ec">start</a>);</span></CodeLine>
<Link id="l00770" /><CodeLine lineNumber="770"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BI != IntB.<a href="/docs/api/classes/llvm/liverange/#a9a5e7c523f12f9f164b786769de1ca47">begin</a>())</span></CodeLine>
<Link id="l00771" /><CodeLine lineNumber="771"><span class="doxyHighlight">      --BI;</span></CodeLine>
<Link id="l00772" /><CodeLine lineNumber="772"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (; BI != IntB.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>() &amp;&amp; ASeg.<a href="/docs/api/structs/llvm/liverange/segment/#afe8e59ffc86cb1736116e4dc8b86e26f">end</a> &gt;= BI-&gt;start; ++BI) &#123;</span></CodeLine>
<Link id="l00773" /><CodeLine lineNumber="773"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BI-&gt;valno == BValNo)</span></CodeLine>
<Link id="l00774" /><CodeLine lineNumber="774"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00775" /><CodeLine lineNumber="775"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BI-&gt;start &lt;= ASeg.<a href="/docs/api/structs/llvm/liverange/segment/#a85f7bf79596d84273b5b3b9b490bc2ec">start</a> &amp;&amp; BI-&gt;end &gt; ASeg.<a href="/docs/api/structs/llvm/liverange/segment/#a85f7bf79596d84273b5b3b9b490bc2ec">start</a>)</span></CodeLine>
<Link id="l00776" /><CodeLine lineNumber="776"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00777" /><CodeLine lineNumber="777"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BI-&gt;start &gt; ASeg.<a href="/docs/api/structs/llvm/liverange/segment/#a85f7bf79596d84273b5b3b9b490bc2ec">start</a> &amp;&amp; BI-&gt;start &lt; ASeg.<a href="/docs/api/structs/llvm/liverange/segment/#afe8e59ffc86cb1736116e4dc8b86e26f">end</a>)</span></CodeLine>
<Link id="l00778" /><CodeLine lineNumber="778"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00779" /><CodeLine lineNumber="779"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00780" /><CodeLine lineNumber="780"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00781" /><CodeLine lineNumber="781"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00782" /><CodeLine lineNumber="782"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00783" /><CodeLine lineNumber="783"></CodeLine>
<Link id="l00784" /><CodeLine lineNumber="784"><span class="doxyHighlightComment">/// Copy segments with value number @p SrcValNo from liverange @p Src to live</span></CodeLine>
<Link id="l00785" /><CodeLine lineNumber="785"><span class="doxyHighlightComment">/// range @Dst and use value number @p DstValNo there.</span></CodeLine>
<Link id="l00786" /><CodeLine lineNumber="786" lineLink="#a61eeba1f176225faf4761e4d9b25cc43"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> std::pair&lt;bool, bool&gt; <a href="#a61eeba1f176225faf4761e4d9b25cc43">addSegmentsWithValNo</a>(<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;Dst,</span></CodeLine>
<Link id="l00787" /><CodeLine lineNumber="787"><span class="doxyHighlight">                                                  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;DstValNo,</span></CodeLine>
<Link id="l00788" /><CodeLine lineNumber="788"><span class="doxyHighlight">                                                  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;Src,</span></CodeLine>
<Link id="l00789" /><CodeLine lineNumber="789"><span class="doxyHighlight">                                                  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;SrcValNo) &#123;</span></CodeLine>
<Link id="l00790" /><CodeLine lineNumber="790"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00791" /><CodeLine lineNumber="791"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> MergedWithDead = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00792" /><CodeLine lineNumber="792"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/llvm/liverange/segment">LiveRange::Segment</a> &amp;S : Src.segments) &#123;</span></CodeLine>
<Link id="l00793" /><CodeLine lineNumber="793"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (S.<a href="/docs/api/structs/llvm/liverange/segment/#ac3d1b43d371bc68742232ec51d4a6321">valno</a> != SrcValNo)</span></CodeLine>
<Link id="l00794" /><CodeLine lineNumber="794"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00795" /><CodeLine lineNumber="795"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This is adding a segment from Src that ends in a copy that is about</span></CodeLine>
<Link id="l00796" /><CodeLine lineNumber="796"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// to be removed. This segment is going to be merged with a pre-existing</span></CodeLine>
<Link id="l00797" /><CodeLine lineNumber="797"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// segment in Dst. This works, except in cases when the corresponding</span></CodeLine>
<Link id="l00798" /><CodeLine lineNumber="798"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// segment in Dst is dead. For example: adding &#91;192r,208r:1) from Src</span></CodeLine>
<Link id="l00799" /><CodeLine lineNumber="799"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// to &#91;208r,208d:1) in Dst would create &#91;192r,208d:1) in Dst.</span></CodeLine>
<Link id="l00800" /><CodeLine lineNumber="800"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Recognized such cases, so that the segments can be shrunk.</span></CodeLine>
<Link id="l00801" /><CodeLine lineNumber="801"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/liverange/segment">LiveRange::Segment</a> Added = <a href="/docs/api/structs/llvm/liverange/segment">LiveRange::Segment</a>(S.<a href="/docs/api/structs/llvm/liverange/segment/#a85f7bf79596d84273b5b3b9b490bc2ec">start</a>, S.<a href="/docs/api/structs/llvm/liverange/segment/#afe8e59ffc86cb1736116e4dc8b86e26f">end</a>, DstValNo);</span></CodeLine>
<Link id="l00802" /><CodeLine lineNumber="802"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/liverange/segment">LiveRange::Segment</a> &amp;Merged = &#42;Dst.addSegment(Added);</span></CodeLine>
<Link id="l00803" /><CodeLine lineNumber="803"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Merged.<a href="/docs/api/structs/llvm/liverange/segment/#afe8e59ffc86cb1736116e4dc8b86e26f">end</a>.<a href="/docs/api/classes/llvm/slotindex/#af7b521cd03cfcb1115186e877d0e820d">isDead</a>())</span></CodeLine>
<Link id="l00804" /><CodeLine lineNumber="804"><span class="doxyHighlight">      MergedWithDead = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00805" /><CodeLine lineNumber="805"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00806" /><CodeLine lineNumber="806"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00807" /><CodeLine lineNumber="807"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::make&#95;pair(<a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>, MergedWithDead);</span></CodeLine>
<Link id="l00808" /><CodeLine lineNumber="808"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00809" /><CodeLine lineNumber="809"></CodeLine>
<Link id="l00810" /><CodeLine lineNumber="810"><span class="doxyHighlight">std::pair&lt;bool, bool&gt;</span></CodeLine>
<Link id="l00811" /><CodeLine lineNumber="811"><span class="doxyHighlight">RegisterCoalescer::removeCopyByCommutingDef(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP,</span></CodeLine>
<Link id="l00812" /><CodeLine lineNumber="812"><span class="doxyHighlight">                                            <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI) &#123;</span></CodeLine>
<Link id="l00813" /><CodeLine lineNumber="813"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys());</span></CodeLine>
<Link id="l00814" /><CodeLine lineNumber="814"></CodeLine>
<Link id="l00815" /><CodeLine lineNumber="815"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntA =</span></CodeLine>
<Link id="l00816" /><CodeLine lineNumber="816"><span class="doxyHighlight">      LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l00817" /><CodeLine lineNumber="817"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntB =</span></CodeLine>
<Link id="l00818" /><CodeLine lineNumber="818"><span class="doxyHighlight">      LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l00819" /><CodeLine lineNumber="819"></CodeLine>
<Link id="l00820" /><CodeLine lineNumber="820"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We found a non-trivially-coalescable copy with IntA being the source and</span></CodeLine>
<Link id="l00821" /><CodeLine lineNumber="821"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// IntB being the dest, thus this defines a value number in IntB.  If the</span></CodeLine>
<Link id="l00822" /><CodeLine lineNumber="822"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// source value number (in IntA) is defined by a commutable instruction and</span></CodeLine>
<Link id="l00823" /><CodeLine lineNumber="823"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// its other operand is coalesced to the copy dest register, see if we can</span></CodeLine>
<Link id="l00824" /><CodeLine lineNumber="824"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// transform the copy into a noop by commuting the definition. For example,</span></CodeLine>
<Link id="l00825" /><CodeLine lineNumber="825"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00826" /><CodeLine lineNumber="826"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  A3 = op A2 killed B0</span></CodeLine>
<Link id="l00827" /><CodeLine lineNumber="827"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    ...</span></CodeLine>
<Link id="l00828" /><CodeLine lineNumber="828"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  B1 = A3      &lt;- this copy</span></CodeLine>
<Link id="l00829" /><CodeLine lineNumber="829"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    ...</span></CodeLine>
<Link id="l00830" /><CodeLine lineNumber="830"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//     = op A3   &lt;- more uses</span></CodeLine>
<Link id="l00831" /><CodeLine lineNumber="831"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00832" /><CodeLine lineNumber="832"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ==&gt;</span></CodeLine>
<Link id="l00833" /><CodeLine lineNumber="833"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00834" /><CodeLine lineNumber="834"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  B2 = op B0 killed A2</span></CodeLine>
<Link id="l00835" /><CodeLine lineNumber="835"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    ...</span></CodeLine>
<Link id="l00836" /><CodeLine lineNumber="836"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  B1 = B2      &lt;- now an identity copy</span></CodeLine>
<Link id="l00837" /><CodeLine lineNumber="837"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    ...</span></CodeLine>
<Link id="l00838" /><CodeLine lineNumber="838"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//     = op B2   &lt;- more uses</span></CodeLine>
<Link id="l00839" /><CodeLine lineNumber="839"></CodeLine>
<Link id="l00840" /><CodeLine lineNumber="840"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// BValNo is a value number in B that is defined by a copy from A. &#39;B1&#39; in</span></CodeLine>
<Link id="l00841" /><CodeLine lineNumber="841"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the example above.</span></CodeLine>
<Link id="l00842" /><CodeLine lineNumber="842"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CopyIdx = LIS-&gt;getInstructionIndex(&#42;CopyMI).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</span></CodeLine>
<Link id="l00843" /><CodeLine lineNumber="843"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;BValNo = IntB.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(CopyIdx);</span></CodeLine>
<Link id="l00844" /><CodeLine lineNumber="844"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BValNo != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> &amp;&amp; BValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> == CopyIdx);</span></CodeLine>
<Link id="l00845" /><CodeLine lineNumber="845"></CodeLine>
<Link id="l00846" /><CodeLine lineNumber="846"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// AValNo is the value number in A that defines the copy, A3 in the example.</span></CodeLine>
<Link id="l00847" /><CodeLine lineNumber="847"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;AValNo = IntA.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(CopyIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00848" /><CodeLine lineNumber="848"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AValNo &amp;&amp; !AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ab72366fd538f240cbb53dac39368cdfc">isUnused</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;COPY source not live&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00849" /><CodeLine lineNumber="849"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>())</span></CodeLine>
<Link id="l00850" /><CodeLine lineNumber="850"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00851" /><CodeLine lineNumber="851"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a> = LIS-&gt;getInstructionFromIndex(AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l00852" /><CodeLine lineNumber="852"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>)</span></CodeLine>
<Link id="l00853" /><CodeLine lineNumber="853"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00854" /><CodeLine lineNumber="854"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a7961501e56424e3a7e21d34d6e109461">isCommutable</a>())</span></CodeLine>
<Link id="l00855" /><CodeLine lineNumber="855"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00856" /><CodeLine lineNumber="856"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If DefMI is a two-address instruction then commuting it will change the</span></CodeLine>
<Link id="l00857" /><CodeLine lineNumber="857"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// destination register.</span></CodeLine>
<Link id="l00858" /><CodeLine lineNumber="858"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> DefIdx = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#aeeed341d0f3c7220d070d766e3a0f584">findRegisterDefOperandIdx</a>(IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), </span><span class="doxyHighlightComment">/&#42;TRI=&#42;/</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00859" /><CodeLine lineNumber="859"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DefIdx != -1);</span></CodeLine>
<Link id="l00860" /><CodeLine lineNumber="860"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> UseOpIdx;</span></CodeLine>
<Link id="l00861" /><CodeLine lineNumber="861"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a6df9a6b70a33aee123056cec0ed052c4">isRegTiedToUseOperand</a>(DefIdx, &amp;UseOpIdx))</span></CodeLine>
<Link id="l00862" /><CodeLine lineNumber="862"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00863" /><CodeLine lineNumber="863"></CodeLine>
<Link id="l00864" /><CodeLine lineNumber="864"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// FIXME: The code below tries to commute &#39;UseOpIdx&#39; operand with some other</span></CodeLine>
<Link id="l00865" /><CodeLine lineNumber="865"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// commutable operand which is expressed by &#39;CommuteAnyOperandIndex&#39;value</span></CodeLine>
<Link id="l00866" /><CodeLine lineNumber="866"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// passed to the method. That &#95;other&#95; operand is chosen by</span></CodeLine>
<Link id="l00867" /><CodeLine lineNumber="867"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the findCommutedOpIndices() method.</span></CodeLine>
<Link id="l00868" /><CodeLine lineNumber="868"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00869" /><CodeLine lineNumber="869"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// That is obviously an area for improvement in case of instructions having</span></CodeLine>
<Link id="l00870" /><CodeLine lineNumber="870"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// more than 2 operands. For example, if some instruction has 3 commutable</span></CodeLine>
<Link id="l00871" /><CodeLine lineNumber="871"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// operands then all possible variants (i.e. op#1&lt;-&gt;op#2, op#1&lt;-&gt;op#3,</span></CodeLine>
<Link id="l00872" /><CodeLine lineNumber="872"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// op#2&lt;-&gt;op#3) of commute transformation should be considered/tried here.</span></CodeLine>
<Link id="l00873" /><CodeLine lineNumber="873"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NewDstIdx = <a href="/docs/api/classes/llvm/targetinstrinfo/#ae73e2be2b66dc9e4f2f90d56076d7ea9">TargetInstrInfo::CommuteAnyOperandIndex</a>;</span></CodeLine>
<Link id="l00874" /><CodeLine lineNumber="874"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;findCommutedOpIndices(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>, UseOpIdx, NewDstIdx))</span></CodeLine>
<Link id="l00875" /><CodeLine lineNumber="875"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00876" /><CodeLine lineNumber="876"></CodeLine>
<Link id="l00877" /><CodeLine lineNumber="877"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;NewDstMO = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(NewDstIdx);</span></CodeLine>
<Link id="l00878" /><CodeLine lineNumber="878"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> NewReg = NewDstMO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</span></CodeLine>
<Link id="l00879" /><CodeLine lineNumber="879"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewReg != IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>() || !IntB.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>).<a href="/docs/api/classes/llvm/livequeryresult/#af155aeaffc7607f4f27ab4cfcbb39a64">isKill</a>())</span></CodeLine>
<Link id="l00880" /><CodeLine lineNumber="880"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00881" /><CodeLine lineNumber="881"></CodeLine>
<Link id="l00882" /><CodeLine lineNumber="882"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Make sure there are no other definitions of IntB that would reach the</span></CodeLine>
<Link id="l00883" /><CodeLine lineNumber="883"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// uses which the new definition can reach.</span></CodeLine>
<Link id="l00884" /><CodeLine lineNumber="884"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (hasOtherReachingDefs(IntA, IntB, AValNo, BValNo))</span></CodeLine>
<Link id="l00885" /><CodeLine lineNumber="885"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00886" /><CodeLine lineNumber="886"></CodeLine>
<Link id="l00887" /><CodeLine lineNumber="887"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If some of the uses of IntA.reg is already coalesced away, return false.</span></CodeLine>
<Link id="l00888" /><CodeLine lineNumber="888"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// It&#39;s not possible to determine whether it&#39;s safe to perform the coalescing.</span></CodeLine>
<Link id="l00889" /><CodeLine lineNumber="889"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;use&#95;nodbg&#95;operands(IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>())) &#123;</span></CodeLine>
<Link id="l00890" /><CodeLine lineNumber="890"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a> = MO.getParent();</span></CodeLine>
<Link id="l00891" /><CodeLine lineNumber="891"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> OpNo = &amp;MO - &amp;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0);</span></CodeLine>
<Link id="l00892" /><CodeLine lineNumber="892"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> UseIdx = LIS-&gt;getInstructionIndex(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>);</span></CodeLine>
<Link id="l00893" /><CodeLine lineNumber="893"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> US = IntA.<a href="/docs/api/classes/llvm/liverange/#ae6eab1035db7ba328354fa739be090f0">FindSegmentContaining</a>(UseIdx);</span></CodeLine>
<Link id="l00894" /><CodeLine lineNumber="894"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (US == IntA.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>() || US-&gt;valno != AValNo)</span></CodeLine>
<Link id="l00895" /><CodeLine lineNumber="895"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00896" /><CodeLine lineNumber="896"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this use is tied to a def, we can&#39;t rewrite the register.</span></CodeLine>
<Link id="l00897" /><CodeLine lineNumber="897"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a391694f8040173dc0670bd273b170502">isRegTiedToDefOperand</a>(OpNo))</span></CodeLine>
<Link id="l00898" /><CodeLine lineNumber="898"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00899" /><CodeLine lineNumber="899"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00900" /><CodeLine lineNumber="900"></CodeLine>
<Link id="l00901" /><CodeLine lineNumber="901"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tremoveCopyByCommutingDef: &quot;</span><span class="doxyHighlight"> &lt;&lt; AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\t&#39;</span></CodeLine>
<Link id="l00902" /><CodeLine lineNumber="902"><span class="doxyHighlight">                    &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>);</span></CodeLine>
<Link id="l00903" /><CodeLine lineNumber="903"></CodeLine>
<Link id="l00904" /><CodeLine lineNumber="904"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// At this point we have decided that it is legal to do this</span></CodeLine>
<Link id="l00905" /><CodeLine lineNumber="905"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// transformation.  Start by commuting the instruction.</span></CodeLine>
<Link id="l00906" /><CodeLine lineNumber="906"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>();</span></CodeLine>
<Link id="l00907" /><CodeLine lineNumber="907"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;NewMI =</span></CodeLine>
<Link id="l00908" /><CodeLine lineNumber="908"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;commuteInstruction(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, UseOpIdx, NewDstIdx);</span></CodeLine>
<Link id="l00909" /><CodeLine lineNumber="909"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewMI)</span></CodeLine>
<Link id="l00910" /><CodeLine lineNumber="910"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00911" /><CodeLine lineNumber="911"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>().<a href="/docs/api/classes/llvm/register/#ab203bbcbc320180b1da9e9a92ee0c784">isVirtual</a>() &amp;&amp; IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>().<a href="/docs/api/classes/llvm/register/#ab203bbcbc320180b1da9e9a92ee0c784">isVirtual</a>() &amp;&amp;</span></CodeLine>
<Link id="l00912" /><CodeLine lineNumber="912"><span class="doxyHighlight">      !<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;constrainRegClass(IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getRegClass(IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>())))</span></CodeLine>
<Link id="l00913" /><CodeLine lineNumber="913"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00914" /><CodeLine lineNumber="914"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewMI != <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>) &#123;</span></CodeLine>
<Link id="l00915" /><CodeLine lineNumber="915"><span class="doxyHighlight">    LIS-&gt;ReplaceMachineInstrInMaps(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>, &#42;NewMI);</span></CodeLine>
<Link id="l00916" /><CodeLine lineNumber="916"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a> Pos = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>;</span></CodeLine>
<Link id="l00917" /><CodeLine lineNumber="917"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3435a2381e60e842e915f85c931b7dde">insert</a>(Pos, NewMI);</span></CodeLine>
<Link id="l00918" /><CodeLine lineNumber="918"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#ad26bff839257f220557ce812b2159c72">erase</a>(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>);</span></CodeLine>
<Link id="l00919" /><CodeLine lineNumber="919"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00920" /><CodeLine lineNumber="920"></CodeLine>
<Link id="l00921" /><CodeLine lineNumber="921"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If ALR and BLR overlaps and end of BLR extends beyond end of ALR, e.g.</span></CodeLine>
<Link id="l00922" /><CodeLine lineNumber="922"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// A = or A, B</span></CodeLine>
<Link id="l00923" /><CodeLine lineNumber="923"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ...</span></CodeLine>
<Link id="l00924" /><CodeLine lineNumber="924"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// B = A</span></CodeLine>
<Link id="l00925" /><CodeLine lineNumber="925"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ...</span></CodeLine>
<Link id="l00926" /><CodeLine lineNumber="926"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// C = killed A</span></CodeLine>
<Link id="l00927" /><CodeLine lineNumber="927"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ...</span></CodeLine>
<Link id="l00928" /><CodeLine lineNumber="928"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   = B</span></CodeLine>
<Link id="l00929" /><CodeLine lineNumber="929"></CodeLine>
<Link id="l00930" /><CodeLine lineNumber="930"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Update uses of IntA of the specific Val# with IntB.</span></CodeLine>
<Link id="l00931" /><CodeLine lineNumber="931"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;UseMO :</span></CodeLine>
<Link id="l00932" /><CodeLine lineNumber="932"><span class="doxyHighlight">       <a href="/docs/api/namespaces/llvm/#a3d2cdc4a0db233678e7141c9d6ea3419">llvm::make&#95;early&#95;inc&#95;range</a>(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;use&#95;operands(IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>()))) &#123;</span></CodeLine>
<Link id="l00933" /><CodeLine lineNumber="933"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UseMO.isUndef())</span></CodeLine>
<Link id="l00934" /><CodeLine lineNumber="934"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00935" /><CodeLine lineNumber="935"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a> = UseMO.getParent();</span></CodeLine>
<Link id="l00936" /><CodeLine lineNumber="936"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a42020afbcac5113c831c00294a0ac37f">isDebugInstr</a>()) &#123;</span></CodeLine>
<Link id="l00937" /><CodeLine lineNumber="937"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// FIXME These don&#39;t have an instruction index.  Not clear we have enough</span></CodeLine>
<Link id="l00938" /><CodeLine lineNumber="938"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// info to decide whether to do this replacement or not.  For now do it.</span></CodeLine>
<Link id="l00939" /><CodeLine lineNumber="939"><span class="doxyHighlight">      UseMO.setReg(NewReg);</span></CodeLine>
<Link id="l00940" /><CodeLine lineNumber="940"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00941" /><CodeLine lineNumber="941"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00942" /><CodeLine lineNumber="942"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> UseIdx = LIS-&gt;getInstructionIndex(&#42;UseMI).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00943" /><CodeLine lineNumber="943"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> US = IntA.<a href="/docs/api/classes/llvm/liverange/#ae6eab1035db7ba328354fa739be090f0">FindSegmentContaining</a>(UseIdx);</span></CodeLine>
<Link id="l00944" /><CodeLine lineNumber="944"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(US != IntA.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Use must be live&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00945" /><CodeLine lineNumber="945"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (US-&gt;valno != AValNo)</span></CodeLine>
<Link id="l00946" /><CodeLine lineNumber="946"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00947" /><CodeLine lineNumber="947"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Kill flags are no longer accurate. They are recomputed after RA.</span></CodeLine>
<Link id="l00948" /><CodeLine lineNumber="948"><span class="doxyHighlight">    UseMO.setIsKill(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00949" /><CodeLine lineNumber="949"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>())</span></CodeLine>
<Link id="l00950" /><CodeLine lineNumber="950"><span class="doxyHighlight">      UseMO.substPhysReg(NewReg, &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</span></CodeLine>
<Link id="l00951" /><CodeLine lineNumber="951"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00952" /><CodeLine lineNumber="952"><span class="doxyHighlight">      UseMO.setReg(NewReg);</span></CodeLine>
<Link id="l00953" /><CodeLine lineNumber="953"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a> == CopyMI)</span></CodeLine>
<Link id="l00954" /><CodeLine lineNumber="954"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00955" /><CodeLine lineNumber="955"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1912d4fbc40c61a12b1f770ad54dfd74">isCopy</a>())</span></CodeLine>
<Link id="l00956" /><CodeLine lineNumber="956"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00957" /><CodeLine lineNumber="957"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() != IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>() ||</span></CodeLine>
<Link id="l00958" /><CodeLine lineNumber="958"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>())</span></CodeLine>
<Link id="l00959" /><CodeLine lineNumber="959"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00960" /><CodeLine lineNumber="960"></CodeLine>
<Link id="l00961" /><CodeLine lineNumber="961"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This copy will become a noop. If it&#39;s defining a new val#, merge it into</span></CodeLine>
<Link id="l00962" /><CodeLine lineNumber="962"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// BValNo.</span></CodeLine>
<Link id="l00963" /><CodeLine lineNumber="963"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> DefIdx = UseIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</span></CodeLine>
<Link id="l00964" /><CodeLine lineNumber="964"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;DVNI = IntB.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(DefIdx);</span></CodeLine>
<Link id="l00965" /><CodeLine lineNumber="965"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DVNI)</span></CodeLine>
<Link id="l00966" /><CodeLine lineNumber="966"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00967" /><CodeLine lineNumber="967"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tnoop: &quot;</span><span class="doxyHighlight"> &lt;&lt; DefIdx &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\t&#39;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>);</span></CodeLine>
<Link id="l00968" /><CodeLine lineNumber="968"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DVNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> == DefIdx);</span></CodeLine>
<Link id="l00969" /><CodeLine lineNumber="969"><span class="doxyHighlight">    BValNo = IntB.<a href="/docs/api/classes/llvm/liverange/#a92e17326c2170e889ae4390c56878b77">MergeValueNumberInto</a>(DVNI, BValNo);</span></CodeLine>
<Link id="l00970" /><CodeLine lineNumber="970"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : IntB.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l00971" /><CodeLine lineNumber="971"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;SubDVNI = S.getVNInfoAt(DefIdx);</span></CodeLine>
<Link id="l00972" /><CodeLine lineNumber="972"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SubDVNI)</span></CodeLine>
<Link id="l00973" /><CodeLine lineNumber="973"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00974" /><CodeLine lineNumber="974"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;SubBValNo = S.getVNInfoAt(CopyIdx);</span></CodeLine>
<Link id="l00975" /><CodeLine lineNumber="975"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SubBValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> == CopyIdx);</span></CodeLine>
<Link id="l00976" /><CodeLine lineNumber="976"><span class="doxyHighlight">      S.MergeValueNumberInto(SubDVNI, SubBValNo);</span></CodeLine>
<Link id="l00977" /><CodeLine lineNumber="977"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00978" /><CodeLine lineNumber="978"></CodeLine>
<Link id="l00979" /><CodeLine lineNumber="979"><span class="doxyHighlight">    deleteInstr(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>);</span></CodeLine>
<Link id="l00980" /><CodeLine lineNumber="980"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00981" /><CodeLine lineNumber="981"></CodeLine>
<Link id="l00982" /><CodeLine lineNumber="982"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Extend BValNo by merging in IntA live segments of AValNo. Val# definition</span></CodeLine>
<Link id="l00983" /><CodeLine lineNumber="983"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is updated.</span></CodeLine>
<Link id="l00984" /><CodeLine lineNumber="984"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ShrinkB = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00985" /><CodeLine lineNumber="985"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8e612822d4ba7bb36c9c79582a567108">BumpPtrAllocator</a> &amp;<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a> = LIS-&gt;getVNInfoAllocator();</span></CodeLine>
<Link id="l00986" /><CodeLine lineNumber="986"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IntA.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>() || IntB.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l00987" /><CodeLine lineNumber="987"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IntA.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l00988" /><CodeLine lineNumber="988"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a> = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getMaxLaneMaskForVReg(IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>());</span></CodeLine>
<Link id="l00989" /><CodeLine lineNumber="989"><span class="doxyHighlight">      IntA.<a href="/docs/api/classes/llvm/liveinterval/#a8104005914e3dfed73608d0d8961b822">createSubRangeFrom</a>(<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, Mask, IntA);</span></CodeLine>
<Link id="l00990" /><CodeLine lineNumber="990"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IntB.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l00991" /><CodeLine lineNumber="991"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a> = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getMaxLaneMaskForVReg(IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>());</span></CodeLine>
<Link id="l00992" /><CodeLine lineNumber="992"><span class="doxyHighlight">      IntB.<a href="/docs/api/classes/llvm/liveinterval/#a8104005914e3dfed73608d0d8961b822">createSubRangeFrom</a>(<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, Mask, IntB);</span></CodeLine>
<Link id="l00993" /><CodeLine lineNumber="993"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00994" /><CodeLine lineNumber="994"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> AIdx = CopyIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00995" /><CodeLine lineNumber="995"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> MaskA;</span></CodeLine>
<Link id="l00996" /><CodeLine lineNumber="996"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/slotindexes">SlotIndexes</a> &amp;Indexes = &#42;LIS-&gt;getSlotIndexes();</span></CodeLine>
<Link id="l00997" /><CodeLine lineNumber="997"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SA : IntA.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l00998" /><CodeLine lineNumber="998"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;ASubValNo = SA.getVNInfoAt(AIdx);</span></CodeLine>
<Link id="l00999" /><CodeLine lineNumber="999"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Even if we are dealing with a full copy, some lanes can</span></CodeLine>
<Link id="l01000" /><CodeLine lineNumber="1000"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// still be undefined.</span></CodeLine>
<Link id="l01001" /><CodeLine lineNumber="1001"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// E.g.,</span></CodeLine>
<Link id="l01002" /><CodeLine lineNumber="1002"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// undef A.subLow = ...</span></CodeLine>
<Link id="l01003" /><CodeLine lineNumber="1003"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// B = COPY A &lt;== A.subHigh is undefined here and does</span></CodeLine>
<Link id="l01004" /><CodeLine lineNumber="1004"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//                not have a value number.</span></CodeLine>
<Link id="l01005" /><CodeLine lineNumber="1005"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!ASubValNo)</span></CodeLine>
<Link id="l01006" /><CodeLine lineNumber="1006"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01007" /><CodeLine lineNumber="1007"><span class="doxyHighlight">      MaskA |= SA.LaneMask;</span></CodeLine>
<Link id="l01008" /><CodeLine lineNumber="1008"></CodeLine>
<Link id="l01009" /><CodeLine lineNumber="1009"><span class="doxyHighlight">      IntB.<a href="/docs/api/classes/llvm/liveinterval/#a967540f5e5799b56c6fbcee378d110eb">refineSubRanges</a>(</span></CodeLine>
<Link id="l01010" /><CodeLine lineNumber="1010"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, SA.LaneMask,</span></CodeLine>
<Link id="l01011" /><CodeLine lineNumber="1011"><span class="doxyHighlight">          &#91;&amp;<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, &amp;SA, CopyIdx, ASubValNo,</span></CodeLine>
<Link id="l01012" /><CodeLine lineNumber="1012"><span class="doxyHighlight">           &amp;ShrinkB&#93;(<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR) &#123;</span></CodeLine>
<Link id="l01013" /><CodeLine lineNumber="1013"><span class="doxyHighlight">            VNInfo &#42;BSubValNo = SR.empty() ? SR.getNextValue(CopyIdx, Allocator)</span></CodeLine>
<Link id="l01014" /><CodeLine lineNumber="1014"><span class="doxyHighlight">                                           : SR.getVNInfoAt(CopyIdx);</span></CodeLine>
<Link id="l01015" /><CodeLine lineNumber="1015"><span class="doxyHighlight">            assert(BSubValNo != nullptr);</span></CodeLine>
<Link id="l01016" /><CodeLine lineNumber="1016"><span class="doxyHighlight">            auto P = addSegmentsWithValNo(SR, BSubValNo, SA, ASubValNo);</span></CodeLine>
<Link id="l01017" /><CodeLine lineNumber="1017"><span class="doxyHighlight">            ShrinkB |= P.second;</span></CodeLine>
<Link id="l01018" /><CodeLine lineNumber="1018"><span class="doxyHighlight">            if (P.first)</span></CodeLine>
<Link id="l01019" /><CodeLine lineNumber="1019"><span class="doxyHighlight">              BSubValNo-&gt;def = ASubValNo-&gt;def;</span></CodeLine>
<Link id="l01020" /><CodeLine lineNumber="1020"><span class="doxyHighlight">          &#125;,</span></CodeLine>
<Link id="l01021" /><CodeLine lineNumber="1021"><span class="doxyHighlight">          Indexes, &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</span></CodeLine>
<Link id="l01022" /><CodeLine lineNumber="1022"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01023" /><CodeLine lineNumber="1023"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Go over all subranges of IntB that have not been covered by IntA,</span></CodeLine>
<Link id="l01024" /><CodeLine lineNumber="1024"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// and delete the segments starting at CopyIdx. This can happen if</span></CodeLine>
<Link id="l01025" /><CodeLine lineNumber="1025"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// IntA has undef lanes that are defined in IntB.</span></CodeLine>
<Link id="l01026" /><CodeLine lineNumber="1026"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SB : IntB.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l01027" /><CodeLine lineNumber="1027"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((SB.LaneMask &amp; MaskA).any())</span></CodeLine>
<Link id="l01028" /><CodeLine lineNumber="1028"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01029" /><CodeLine lineNumber="1029"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/llvm/liverange/segment">LiveRange::Segment</a> &#42;S = SB.getSegmentContaining(CopyIdx))</span></CodeLine>
<Link id="l01030" /><CodeLine lineNumber="1030"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (S-&gt;start.getBaseIndex() == CopyIdx.<a href="/docs/api/classes/llvm/slotindex/#aa94e57689dd16c1c4de909511f1b2ea8">getBaseIndex</a>())</span></CodeLine>
<Link id="l01031" /><CodeLine lineNumber="1031"><span class="doxyHighlight">          SB.removeSegment(&#42;S, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01032" /><CodeLine lineNumber="1032"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01033" /><CodeLine lineNumber="1033"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01034" /><CodeLine lineNumber="1034"></CodeLine>
<Link id="l01035" /><CodeLine lineNumber="1035"><span class="doxyHighlight">  BValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> = AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>;</span></CodeLine>
<Link id="l01036" /><CodeLine lineNumber="1036"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = <a href="#a61eeba1f176225faf4761e4d9b25cc43">addSegmentsWithValNo</a>(IntB, BValNo, IntA, AValNo);</span></CodeLine>
<Link id="l01037" /><CodeLine lineNumber="1037"><span class="doxyHighlight">  ShrinkB |= <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second;</span></CodeLine>
<Link id="l01038" /><CodeLine lineNumber="1038"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\textended: &quot;</span><span class="doxyHighlight"> &lt;&lt; IntB &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01039" /><CodeLine lineNumber="1039"></CodeLine>
<Link id="l01040" /><CodeLine lineNumber="1040"><span class="doxyHighlight">  LIS-&gt;removeVRegDefAt(IntA, AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l01041" /><CodeLine lineNumber="1041"></CodeLine>
<Link id="l01042" /><CodeLine lineNumber="1042"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\ttrimmed:  &quot;</span><span class="doxyHighlight"> &lt;&lt; IntA &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01043" /><CodeLine lineNumber="1043"><span class="doxyHighlight">  ++numCommutes;</span></CodeLine>
<Link id="l01044" /><CodeLine lineNumber="1044"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#123;</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, ShrinkB&#125;;</span></CodeLine>
<Link id="l01045" /><CodeLine lineNumber="1045"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01046" /><CodeLine lineNumber="1046"></CodeLine>
<Link id="l01047" /><CodeLine lineNumber="1047"><span class="doxyHighlightComment">/// For copy B = A in BB2, if A is defined by A = B in BB0 which is a</span></CodeLine>
<Link id="l01048" /><CodeLine lineNumber="1048"><span class="doxyHighlightComment">/// predecessor of BB2, and if B is not redefined on the way from A = B</span></CodeLine>
<Link id="l01049" /><CodeLine lineNumber="1049"><span class="doxyHighlightComment">/// in BB0 to B = A in BB2, B = A in BB2 is partially redundant if the</span></CodeLine>
<Link id="l01050" /><CodeLine lineNumber="1050"><span class="doxyHighlightComment">/// execution goes through the path from BB0 to BB2. We may move B = A</span></CodeLine>
<Link id="l01051" /><CodeLine lineNumber="1051"><span class="doxyHighlightComment">/// to the predecessor without such reversed copy.</span></CodeLine>
<Link id="l01052" /><CodeLine lineNumber="1052"><span class="doxyHighlightComment">/// So we will transform the program from:</span></CodeLine>
<Link id="l01053" /><CodeLine lineNumber="1053"><span class="doxyHighlightComment">///   BB0:</span></CodeLine>
<Link id="l01054" /><CodeLine lineNumber="1054"><span class="doxyHighlightComment">///      A = B;    BB1:</span></CodeLine>
<Link id="l01055" /><CodeLine lineNumber="1055"><span class="doxyHighlightComment">///       ...         ...</span></CodeLine>
<Link id="l01056" /><CodeLine lineNumber="1056"><span class="doxyHighlightComment">///     /     \\      /</span></CodeLine>
<Link id="l01057" /><CodeLine lineNumber="1057"><span class="doxyHighlightComment">///             BB2:</span></CodeLine>
<Link id="l01058" /><CodeLine lineNumber="1058"><span class="doxyHighlightComment">///               ...</span></CodeLine>
<Link id="l01059" /><CodeLine lineNumber="1059"><span class="doxyHighlightComment">///               B = A;</span></CodeLine>
<Link id="l01060" /><CodeLine lineNumber="1060"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l01061" /><CodeLine lineNumber="1061"><span class="doxyHighlightComment">/// to:</span></CodeLine>
<Link id="l01062" /><CodeLine lineNumber="1062"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l01063" /><CodeLine lineNumber="1063"><span class="doxyHighlightComment">///   BB0:         BB1:</span></CodeLine>
<Link id="l01064" /><CodeLine lineNumber="1064"><span class="doxyHighlightComment">///      A = B;        ...</span></CodeLine>
<Link id="l01065" /><CodeLine lineNumber="1065"><span class="doxyHighlightComment">///       ...          B = A;</span></CodeLine>
<Link id="l01066" /><CodeLine lineNumber="1066"><span class="doxyHighlightComment">///     /     \\       /</span></CodeLine>
<Link id="l01067" /><CodeLine lineNumber="1067"><span class="doxyHighlightComment">///             BB2:</span></CodeLine>
<Link id="l01068" /><CodeLine lineNumber="1068"><span class="doxyHighlightComment">///               ...</span></CodeLine>
<Link id="l01069" /><CodeLine lineNumber="1069"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l01070" /><CodeLine lineNumber="1070"><span class="doxyHighlightComment">/// A special case is when BB0 and BB2 are the same BB which is the only</span></CodeLine>
<Link id="l01071" /><CodeLine lineNumber="1071"><span class="doxyHighlightComment">/// BB in a loop:</span></CodeLine>
<Link id="l01072" /><CodeLine lineNumber="1072"><span class="doxyHighlightComment">///   BB1:</span></CodeLine>
<Link id="l01073" /><CodeLine lineNumber="1073"><span class="doxyHighlightComment">///        ...</span></CodeLine>
<Link id="l01074" /><CodeLine lineNumber="1074"><span class="doxyHighlightComment">///   BB0/BB2:  ----</span></CodeLine>
<Link id="l01075" /><CodeLine lineNumber="1075"><span class="doxyHighlightComment">///        B = A;   |</span></CodeLine>
<Link id="l01076" /><CodeLine lineNumber="1076"><span class="doxyHighlightComment">///        ...      |</span></CodeLine>
<Link id="l01077" /><CodeLine lineNumber="1077"><span class="doxyHighlightComment">///        A = B;   |</span></CodeLine>
<Link id="l01078" /><CodeLine lineNumber="1078"><span class="doxyHighlightComment">///          |-------</span></CodeLine>
<Link id="l01079" /><CodeLine lineNumber="1079"><span class="doxyHighlightComment">///          |</span></CodeLine>
<Link id="l01080" /><CodeLine lineNumber="1080"><span class="doxyHighlightComment">/// We may hoist B = A from BB0/BB2 to BB1.</span></CodeLine>
<Link id="l01081" /><CodeLine lineNumber="1081"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l01082" /><CodeLine lineNumber="1082"><span class="doxyHighlightComment">/// The major preconditions for correctness to remove such partial</span></CodeLine>
<Link id="l01083" /><CodeLine lineNumber="1083"><span class="doxyHighlightComment">/// redundancy include:</span></CodeLine>
<Link id="l01084" /><CodeLine lineNumber="1084"><span class="doxyHighlightComment">/// 1 A in B = A in BB2 is defined by a PHI in BB2, and one operand of</span></CodeLine>
<Link id="l01085" /><CodeLine lineNumber="1085"><span class="doxyHighlightComment">///    the PHI is defined by the reversed copy A = B in BB0.</span></CodeLine>
<Link id="l01086" /><CodeLine lineNumber="1086"><span class="doxyHighlightComment">/// 2 No B is referenced from the start of BB2 to B = A.</span></CodeLine>
<Link id="l01087" /><CodeLine lineNumber="1087"><span class="doxyHighlightComment">/// 3 No B is defined from A = B to the end of BB0.</span></CodeLine>
<Link id="l01088" /><CodeLine lineNumber="1088"><span class="doxyHighlightComment">/// 4 BB1 has only one successor.</span></CodeLine>
<Link id="l01089" /><CodeLine lineNumber="1089"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l01090" /><CodeLine lineNumber="1090"><span class="doxyHighlightComment">/// 2 and 4 implicitly ensure B is not live at the end of BB1.</span></CodeLine>
<Link id="l01091" /><CodeLine lineNumber="1091"><span class="doxyHighlightComment">/// 4 guarantees BB2 is hotter than BB1, so we can only move a copy to a</span></CodeLine>
<Link id="l01092" /><CodeLine lineNumber="1092"><span class="doxyHighlightComment">/// colder place, which not only prevent endless loop, but also make sure</span></CodeLine>
<Link id="l01093" /><CodeLine lineNumber="1093"><span class="doxyHighlightComment">/// the movement of copy is beneficial.</span></CodeLine>
<Link id="l01094" /><CodeLine lineNumber="1094"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::removePartialRedundancy(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP,</span></CodeLine>
<Link id="l01095" /><CodeLine lineNumber="1095"><span class="doxyHighlight">                                                <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;CopyMI) &#123;</span></CodeLine>
<Link id="l01096" /><CodeLine lineNumber="1096"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys());</span></CodeLine>
<Link id="l01097" /><CodeLine lineNumber="1097"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!CopyMI.<a href="/docs/api/classes/llvm/machineinstr/#a6ee45760c97bf2dda6bee91508e6946e">isFullCopy</a>())</span></CodeLine>
<Link id="l01098" /><CodeLine lineNumber="1098"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01099" /><CodeLine lineNumber="1099"></CodeLine>
<Link id="l01100" /><CodeLine lineNumber="1100"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = &#42;CopyMI.<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>();</span></CodeLine>
<Link id="l01101" /><CodeLine lineNumber="1101"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If this block is the target of an invoke/inlineasm&#95;br, moving the copy into</span></CodeLine>
<Link id="l01102" /><CodeLine lineNumber="1102"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the predecessor is tricker, and we don&#39;t handle it.</span></CodeLine>
<Link id="l01103" /><CodeLine lineNumber="1103"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a1100bfbadd996d464150c6a68fa8dc1d">isEHPad</a>() || <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a00e55a6b6b44b739e9da1d62f1d8a5b3">isInlineAsmBrIndirectTarget</a>())</span></CodeLine>
<Link id="l01104" /><CodeLine lineNumber="1104"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01105" /><CodeLine lineNumber="1105"></CodeLine>
<Link id="l01106" /><CodeLine lineNumber="1106"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a03936a9b37da541420049422204ab206">pred&#95;size</a>() != 2)</span></CodeLine>
<Link id="l01107" /><CodeLine lineNumber="1107"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01108" /><CodeLine lineNumber="1108"></CodeLine>
<Link id="l01109" /><CodeLine lineNumber="1109"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntA =</span></CodeLine>
<Link id="l01110" /><CodeLine lineNumber="1110"><span class="doxyHighlight">      LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l01111" /><CodeLine lineNumber="1111"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;IntB =</span></CodeLine>
<Link id="l01112" /><CodeLine lineNumber="1112"><span class="doxyHighlight">      LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l01113" /><CodeLine lineNumber="1113"></CodeLine>
<Link id="l01114" /><CodeLine lineNumber="1114"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// A is defined by PHI at the entry of MBB.</span></CodeLine>
<Link id="l01115" /><CodeLine lineNumber="1115"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CopyIdx = LIS-&gt;getInstructionIndex(CopyMI).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01116" /><CodeLine lineNumber="1116"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;AValNo = IntA.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(CopyIdx);</span></CodeLine>
<Link id="l01117" /><CodeLine lineNumber="1117"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(AValNo &amp;&amp; !AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ab72366fd538f240cbb53dac39368cdfc">isUnused</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;COPY source not live&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01118" /><CodeLine lineNumber="1118"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!AValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>())</span></CodeLine>
<Link id="l01119" /><CodeLine lineNumber="1119"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01120" /><CodeLine lineNumber="1120"></CodeLine>
<Link id="l01121" /><CodeLine lineNumber="1121"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// No B is referenced before CopyMI in MBB.</span></CodeLine>
<Link id="l01122" /><CodeLine lineNumber="1122"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IntB.<a href="/docs/api/classes/llvm/liverange/#a69ef19ea9e324373a8f6d2cadfd1dad3">overlaps</a>(LIS-&gt;getMBBStartIdx(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>), CopyIdx))</span></CodeLine>
<Link id="l01123" /><CodeLine lineNumber="1123"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01124" /><CodeLine lineNumber="1124"></CodeLine>
<Link id="l01125" /><CodeLine lineNumber="1125"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// MBB has two predecessors: one contains A = B so no copy will be inserted</span></CodeLine>
<Link id="l01126" /><CodeLine lineNumber="1126"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// for it. The other one will have a copy moved from MBB.</span></CodeLine>
<Link id="l01127" /><CodeLine lineNumber="1127"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> FoundReverseCopy = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01128" /><CodeLine lineNumber="1128"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;CopyLeftBB = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01129" /><CodeLine lineNumber="1129"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;Pred : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#addd80df79ba902914c7d8a52e3896b79">predecessors</a>()) &#123;</span></CodeLine>
<Link id="l01130" /><CodeLine lineNumber="1130"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;PVal = IntA.<a href="/docs/api/classes/llvm/liverange/#a7e1ec6260b229b2f5913405b758bc146">getVNInfoBefore</a>(LIS-&gt;getMBBEndIdx(Pred));</span></CodeLine>
<Link id="l01131" /><CodeLine lineNumber="1131"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a> = LIS-&gt;getInstructionFromIndex(PVal-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l01132" /><CodeLine lineNumber="1132"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a> || !<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a6ee45760c97bf2dda6bee91508e6946e">isFullCopy</a>()) &#123;</span></CodeLine>
<Link id="l01133" /><CodeLine lineNumber="1133"><span class="doxyHighlight">      CopyLeftBB = Pred;</span></CodeLine>
<Link id="l01134" /><CodeLine lineNumber="1134"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01135" /><CodeLine lineNumber="1135"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01136" /><CodeLine lineNumber="1136"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check DefMI is a reverse copy and it is in BB Pred.</span></CodeLine>
<Link id="l01137" /><CodeLine lineNumber="1137"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() != IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>() ||</span></CodeLine>
<Link id="l01138" /><CodeLine lineNumber="1138"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(1).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() != IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>() ||</span></CodeLine>
<Link id="l01139" /><CodeLine lineNumber="1139"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>() != Pred) &#123;</span></CodeLine>
<Link id="l01140" /><CodeLine lineNumber="1140"><span class="doxyHighlight">      CopyLeftBB = Pred;</span></CodeLine>
<Link id="l01141" /><CodeLine lineNumber="1141"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01142" /><CodeLine lineNumber="1142"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01143" /><CodeLine lineNumber="1143"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If there is any other def of B after DefMI and before the end of Pred,</span></CodeLine>
<Link id="l01144" /><CodeLine lineNumber="1144"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// we need to keep the copy of B = A at the end of Pred if we remove</span></CodeLine>
<Link id="l01145" /><CodeLine lineNumber="1145"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// B = A from MBB.</span></CodeLine>
<Link id="l01146" /><CodeLine lineNumber="1146"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ValB&#95;Changed = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01147" /><CodeLine lineNumber="1147"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;VNI : IntB.<a href="/docs/api/classes/llvm/liverange/#a9eb4aa155c41e60dff42f4e741a0dcf0">valnos</a>) &#123;</span></CodeLine>
<Link id="l01148" /><CodeLine lineNumber="1148"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNI-&gt;isUnused())</span></CodeLine>
<Link id="l01149" /><CodeLine lineNumber="1149"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01150" /><CodeLine lineNumber="1150"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PVal-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &lt; VNI-&gt;def &amp;&amp; VNI-&gt;def &lt; LIS-&gt;getMBBEndIdx(Pred)) &#123;</span></CodeLine>
<Link id="l01151" /><CodeLine lineNumber="1151"><span class="doxyHighlight">        ValB&#95;Changed = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01152" /><CodeLine lineNumber="1152"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01153" /><CodeLine lineNumber="1153"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01154" /><CodeLine lineNumber="1154"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01155" /><CodeLine lineNumber="1155"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValB&#95;Changed) &#123;</span></CodeLine>
<Link id="l01156" /><CodeLine lineNumber="1156"><span class="doxyHighlight">      CopyLeftBB = Pred;</span></CodeLine>
<Link id="l01157" /><CodeLine lineNumber="1157"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01158" /><CodeLine lineNumber="1158"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01159" /><CodeLine lineNumber="1159"><span class="doxyHighlight">    FoundReverseCopy = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01160" /><CodeLine lineNumber="1160"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01161" /><CodeLine lineNumber="1161"></CodeLine>
<Link id="l01162" /><CodeLine lineNumber="1162"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If no reverse copy is found in predecessors, nothing to do.</span></CodeLine>
<Link id="l01163" /><CodeLine lineNumber="1163"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!FoundReverseCopy)</span></CodeLine>
<Link id="l01164" /><CodeLine lineNumber="1164"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01165" /><CodeLine lineNumber="1165"></CodeLine>
<Link id="l01166" /><CodeLine lineNumber="1166"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If CopyLeftBB is nullptr, it means every predecessor of MBB contains</span></CodeLine>
<Link id="l01167" /><CodeLine lineNumber="1167"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// reverse copy, CopyMI can be removed trivially if only IntA/IntB is updated.</span></CodeLine>
<Link id="l01168" /><CodeLine lineNumber="1168"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If CopyLeftBB is not nullptr, move CopyMI from MBB to CopyLeftBB and</span></CodeLine>
<Link id="l01169" /><CodeLine lineNumber="1169"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// update IntA/IntB.</span></CodeLine>
<Link id="l01170" /><CodeLine lineNumber="1170"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01171" /><CodeLine lineNumber="1171"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If CopyLeftBB is not nullptr, ensure CopyLeftBB has a single succ so</span></CodeLine>
<Link id="l01172" /><CodeLine lineNumber="1172"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// MBB is hotter than CopyLeftBB.</span></CodeLine>
<Link id="l01173" /><CodeLine lineNumber="1173"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CopyLeftBB &amp;&amp; CopyLeftBB-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a81626de817a0cb021ff8e915cf1942ed">succ&#95;size</a>() &gt; 1)</span></CodeLine>
<Link id="l01174" /><CodeLine lineNumber="1174"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01175" /><CodeLine lineNumber="1175"></CodeLine>
<Link id="l01176" /><CodeLine lineNumber="1176"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now (almost sure it&#39;s) ok to move copy.</span></CodeLine>
<Link id="l01177" /><CodeLine lineNumber="1177"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CopyLeftBB) &#123;</span></CodeLine>
<Link id="l01178" /><CodeLine lineNumber="1178"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Position in CopyLeftBB where we should insert new copy.</span></CodeLine>
<Link id="l01179" /><CodeLine lineNumber="1179"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> InsPos = CopyLeftBB-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a7f0521fa2de44271fd4b909ea7351ef3">getFirstTerminator</a>();</span></CodeLine>
<Link id="l01180" /><CodeLine lineNumber="1180"></CodeLine>
<Link id="l01181" /><CodeLine lineNumber="1181"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Make sure that B isn&#39;t referenced in the terminators (if any) at the end</span></CodeLine>
<Link id="l01182" /><CodeLine lineNumber="1182"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// of the predecessor since we&#39;re about to insert a new definition of B</span></CodeLine>
<Link id="l01183" /><CodeLine lineNumber="1183"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// before them.</span></CodeLine>
<Link id="l01184" /><CodeLine lineNumber="1184"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InsPos != CopyLeftBB-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#acbc921830578e2741be6549db716c0ce">end</a>()) &#123;</span></CodeLine>
<Link id="l01185" /><CodeLine lineNumber="1185"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> InsPosIdx = LIS-&gt;getInstructionIndex(&#42;InsPos).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01186" /><CodeLine lineNumber="1186"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IntB.<a href="/docs/api/classes/llvm/liverange/#a69ef19ea9e324373a8f6d2cadfd1dad3">overlaps</a>(InsPosIdx, LIS-&gt;getMBBEndIdx(CopyLeftBB)))</span></CodeLine>
<Link id="l01187" /><CodeLine lineNumber="1187"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01188" /><CodeLine lineNumber="1188"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01189" /><CodeLine lineNumber="1189"></CodeLine>
<Link id="l01190" /><CodeLine lineNumber="1190"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tremovePartialRedundancy: Move the copy to &quot;</span></CodeLine>
<Link id="l01191" /><CodeLine lineNumber="1191"><span class="doxyHighlight">                      &lt;&lt; <a href="/docs/api/namespaces/llvm/#af7881286e3ea4d7f1c4a63c87c132dac">printMBBReference</a>(&#42;CopyLeftBB) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\t&#39;</span><span class="doxyHighlight"> &lt;&lt; CopyMI);</span></CodeLine>
<Link id="l01192" /><CodeLine lineNumber="1192"></CodeLine>
<Link id="l01193" /><CodeLine lineNumber="1193"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Insert new copy to CopyLeftBB.</span></CodeLine>
<Link id="l01194" /><CodeLine lineNumber="1194"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;NewCopyMI = <a href="/docs/api/namespaces/llvm/#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(&#42;CopyLeftBB, InsPos, CopyMI.<a href="/docs/api/classes/llvm/machineinstr/#abb10ef030fba4ea901518a0c8dbef3e2">getDebugLoc</a>(),</span></CodeLine>
<Link id="l01195" /><CodeLine lineNumber="1195"><span class="doxyHighlight">                                      <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(TargetOpcode::COPY), IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>())</span></CodeLine>
<Link id="l01196" /><CodeLine lineNumber="1196"><span class="doxyHighlight">                                  .<a href="/docs/api/classes/llvm/machineinstrbuilder/#a927857fc69e4b4f0cde307f86f180df5">addReg</a>(IntA.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>());</span></CodeLine>
<Link id="l01197" /><CodeLine lineNumber="1197"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> NewCopyIdx =</span></CodeLine>
<Link id="l01198" /><CodeLine lineNumber="1198"><span class="doxyHighlight">        LIS-&gt;InsertMachineInstrInMaps(&#42;NewCopyMI).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</span></CodeLine>
<Link id="l01199" /><CodeLine lineNumber="1199"><span class="doxyHighlight">    IntB.<a href="/docs/api/classes/llvm/liverange/#a4258d794235c7a408b3f52e5e4ef7159">createDeadDef</a>(NewCopyIdx, LIS-&gt;getVNInfoAllocator());</span></CodeLine>
<Link id="l01200" /><CodeLine lineNumber="1200"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : IntB.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>())</span></CodeLine>
<Link id="l01201" /><CodeLine lineNumber="1201"><span class="doxyHighlight">      SR.createDeadDef(NewCopyIdx, LIS-&gt;getVNInfoAllocator());</span></CodeLine>
<Link id="l01202" /><CodeLine lineNumber="1202"></CodeLine>
<Link id="l01203" /><CodeLine lineNumber="1203"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the newly created Instruction has an address of an instruction that</span></CodeLine>
<Link id="l01204" /><CodeLine lineNumber="1204"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// was deleted before (object recycled by the allocator) it needs to be</span></CodeLine>
<Link id="l01205" /><CodeLine lineNumber="1205"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// removed from the deleted list.</span></CodeLine>
<Link id="l01206" /><CodeLine lineNumber="1206"><span class="doxyHighlight">    ErasedInstrs.erase(NewCopyMI);</span></CodeLine>
<Link id="l01207" /><CodeLine lineNumber="1207"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01208" /><CodeLine lineNumber="1208"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tremovePartialRedundancy: Remove the copy from &quot;</span></CodeLine>
<Link id="l01209" /><CodeLine lineNumber="1209"><span class="doxyHighlight">                      &lt;&lt; <a href="/docs/api/namespaces/llvm/#af7881286e3ea4d7f1c4a63c87c132dac">printMBBReference</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\t&#39;</span><span class="doxyHighlight"> &lt;&lt; CopyMI);</span></CodeLine>
<Link id="l01210" /><CodeLine lineNumber="1210"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01211" /><CodeLine lineNumber="1211"></CodeLine>
<Link id="l01212" /><CodeLine lineNumber="1212"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsUndefCopy = CopyMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(1).<a href="/docs/api/classes/llvm/machineoperand/#a1255befbcd6e034394681b1bcd3529ff">isUndef</a>();</span></CodeLine>
<Link id="l01213" /><CodeLine lineNumber="1213"></CodeLine>
<Link id="l01214" /><CodeLine lineNumber="1214"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Remove CopyMI.</span></CodeLine>
<Link id="l01215" /><CodeLine lineNumber="1215"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Note: This is fine to remove the copy before updating the live-ranges.</span></CodeLine>
<Link id="l01216" /><CodeLine lineNumber="1216"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// While updating the live-ranges, we only look at slot indices and</span></CodeLine>
<Link id="l01217" /><CodeLine lineNumber="1217"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// never go back to the instruction.</span></CodeLine>
<Link id="l01218" /><CodeLine lineNumber="1218"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Mark instructions as deleted.</span></CodeLine>
<Link id="l01219" /><CodeLine lineNumber="1219"><span class="doxyHighlight">  deleteInstr(&amp;CopyMI);</span></CodeLine>
<Link id="l01220" /><CodeLine lineNumber="1220"></CodeLine>
<Link id="l01221" /><CodeLine lineNumber="1221"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Update the liveness.</span></CodeLine>
<Link id="l01222" /><CodeLine lineNumber="1222"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;SlotIndex, 8&gt;</a> EndPoints;</span></CodeLine>
<Link id="l01223" /><CodeLine lineNumber="1223"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;BValNo = IntB.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(CopyIdx).<a href="/docs/api/classes/llvm/livequeryresult/#a001d69b0b75e2841cc109cbe8729ba87">valueOutOrDead</a>();</span></CodeLine>
<Link id="l01224" /><CodeLine lineNumber="1224"><span class="doxyHighlight">  LIS-&gt;pruneValue(&#42;</span><span class="doxyHighlightKeyword">static&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/liverange">LiveRange</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(&amp;IntB), CopyIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(),</span></CodeLine>
<Link id="l01225" /><CodeLine lineNumber="1225"><span class="doxyHighlight">                  &amp;EndPoints);</span></CodeLine>
<Link id="l01226" /><CodeLine lineNumber="1226"><span class="doxyHighlight">  BValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#a81775e4a3dbcbc42d828c3e4becd9190">markUnused</a>();</span></CodeLine>
<Link id="l01227" /><CodeLine lineNumber="1227"></CodeLine>
<Link id="l01228" /><CodeLine lineNumber="1228"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsUndefCopy) &#123;</span></CodeLine>
<Link id="l01229" /><CodeLine lineNumber="1229"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We&#39;re introducing an undef phi def, and need to set undef on any users of</span></CodeLine>
<Link id="l01230" /><CodeLine lineNumber="1230"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the previously local def to avoid artifically extending the lifetime</span></CodeLine>
<Link id="l01231" /><CodeLine lineNumber="1231"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// through the block.</span></CodeLine>
<Link id="l01232" /><CodeLine lineNumber="1232"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;use&#95;nodbg&#95;operands(IntB.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>())) &#123;</span></CodeLine>
<Link id="l01233" /><CodeLine lineNumber="1233"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = &#42;MO.getParent();</span></CodeLine>
<Link id="l01234" /><CodeLine lineNumber="1234"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> UseIdx = LIS-&gt;getInstructionIndex(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l01235" /><CodeLine lineNumber="1235"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IntB.<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(UseIdx))</span></CodeLine>
<Link id="l01236" /><CodeLine lineNumber="1236"><span class="doxyHighlight">        MO.setIsUndef(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01237" /><CodeLine lineNumber="1237"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01238" /><CodeLine lineNumber="1238"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01239" /><CodeLine lineNumber="1239"></CodeLine>
<Link id="l01240" /><CodeLine lineNumber="1240"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Extend IntB to the EndPoints of its original live interval.</span></CodeLine>
<Link id="l01241" /><CodeLine lineNumber="1241"><span class="doxyHighlight">  LIS-&gt;extendToIndices(IntB, EndPoints);</span></CodeLine>
<Link id="l01242" /><CodeLine lineNumber="1242"></CodeLine>
<Link id="l01243" /><CodeLine lineNumber="1243"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Now, do the same for its subranges.</span></CodeLine>
<Link id="l01244" /><CodeLine lineNumber="1244"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : IntB.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l01245" /><CodeLine lineNumber="1245"><span class="doxyHighlight">    EndPoints.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l01246" /><CodeLine lineNumber="1246"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;BValNo = SR.Query(CopyIdx).valueOutOrDead();</span></CodeLine>
<Link id="l01247" /><CodeLine lineNumber="1247"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BValNo &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;All sublanes should be live&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01248" /><CodeLine lineNumber="1248"><span class="doxyHighlight">    LIS-&gt;pruneValue(SR, CopyIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(), &amp;EndPoints);</span></CodeLine>
<Link id="l01249" /><CodeLine lineNumber="1249"><span class="doxyHighlight">    BValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#a81775e4a3dbcbc42d828c3e4becd9190">markUnused</a>();</span></CodeLine>
<Link id="l01250" /><CodeLine lineNumber="1250"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We can have a situation where the result of the original copy is live,</span></CodeLine>
<Link id="l01251" /><CodeLine lineNumber="1251"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// but is immediately dead in this subrange, e.g. &#91;336r,336d:0). That makes</span></CodeLine>
<Link id="l01252" /><CodeLine lineNumber="1252"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the copy appear as an endpoint from pruneValue(), but we don&#39;t want it</span></CodeLine>
<Link id="l01253" /><CodeLine lineNumber="1253"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// to because the copy has been removed.  We can go ahead and remove that</span></CodeLine>
<Link id="l01254" /><CodeLine lineNumber="1254"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// endpoint; there is no other situation here that there could be a use at</span></CodeLine>
<Link id="l01255" /><CodeLine lineNumber="1255"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the same place as we know that the copy is a full copy.</span></CodeLine>
<Link id="l01256" /><CodeLine lineNumber="1256"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>();) &#123;</span></CodeLine>
<Link id="l01257" /><CodeLine lineNumber="1257"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/slotindex/#a0b73244049319d841fd11a238f35b5d1">SlotIndex::isSameInstr</a>(EndPoints&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;, CopyIdx)) &#123;</span></CodeLine>
<Link id="l01258" /><CodeLine lineNumber="1258"><span class="doxyHighlight">        EndPoints&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; = EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>();</span></CodeLine>
<Link id="l01259" /><CodeLine lineNumber="1259"><span class="doxyHighlight">        EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#ad97688dfe9cd802e2a0691cbe620218a">pop&#95;back</a>();</span></CodeLine>
<Link id="l01260" /><CodeLine lineNumber="1260"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01261" /><CodeLine lineNumber="1261"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01262" /><CodeLine lineNumber="1262"><span class="doxyHighlight">      ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>;</span></CodeLine>
<Link id="l01263" /><CodeLine lineNumber="1263"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01264" /><CodeLine lineNumber="1264"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;SlotIndex, 8&gt;</a> Undefs;</span></CodeLine>
<Link id="l01265" /><CodeLine lineNumber="1265"><span class="doxyHighlight">    IntB.<a href="/docs/api/classes/llvm/liveinterval/#af4a07ae5c460ac08439a1a71d15e0166">computeSubRangeUndefs</a>(Undefs, SR.LaneMask, &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>,</span></CodeLine>
<Link id="l01266" /><CodeLine lineNumber="1266"><span class="doxyHighlight">                               &#42;LIS-&gt;getSlotIndexes());</span></CodeLine>
<Link id="l01267" /><CodeLine lineNumber="1267"><span class="doxyHighlight">    LIS-&gt;extendToIndices(SR, EndPoints, Undefs);</span></CodeLine>
<Link id="l01268" /><CodeLine lineNumber="1268"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01269" /><CodeLine lineNumber="1269"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If any dead defs were extended, truncate them.</span></CodeLine>
<Link id="l01270" /><CodeLine lineNumber="1270"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(&amp;IntB);</span></CodeLine>
<Link id="l01271" /><CodeLine lineNumber="1271"></CodeLine>
<Link id="l01272" /><CodeLine lineNumber="1272"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Finally, update the live-range of IntA.</span></CodeLine>
<Link id="l01273" /><CodeLine lineNumber="1273"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(&amp;IntA);</span></CodeLine>
<Link id="l01274" /><CodeLine lineNumber="1274"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01275" /><CodeLine lineNumber="1275"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01276" /><CodeLine lineNumber="1276"></CodeLine>
<Link id="l01277" /><CodeLine lineNumber="1277"><span class="doxyHighlightComment">/// Returns true if @p MI defines the full vreg @p Reg, as opposed to just</span></CodeLine>
<Link id="l01278" /><CodeLine lineNumber="1278"><span class="doxyHighlightComment">/// defining a subregister.</span></CodeLine>
<Link id="l01279" /><CodeLine lineNumber="1279" lineLink="#ac11097e2672b5d37ed48a38c9328142f"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#ac11097e2672b5d37ed48a38c9328142f">definesFullReg</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &#123;</span></CodeLine>
<Link id="l01280" /><CodeLine lineNumber="1280"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>.isPhysical() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;This code cannot handle physreg aliasing&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01281" /><CodeLine lineNumber="1281"></CodeLine>
<Link id="l01282" /><CodeLine lineNumber="1282"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.all&#95;defs()) &#123;</span></CodeLine>
<Link id="l01283" /><CodeLine lineNumber="1283"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getReg() != <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)</span></CodeLine>
<Link id="l01284" /><CodeLine lineNumber="1284"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01285" /><CodeLine lineNumber="1285"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Return true if we define the full register or don&#39;t care about the value</span></CodeLine>
<Link id="l01286" /><CodeLine lineNumber="1286"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// inside other subregisters.</span></CodeLine>
<Link id="l01287" /><CodeLine lineNumber="1287"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getSubReg() == 0 || <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.isUndef())</span></CodeLine>
<Link id="l01288" /><CodeLine lineNumber="1288"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01289" /><CodeLine lineNumber="1289"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01290" /><CodeLine lineNumber="1290"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01291" /><CodeLine lineNumber="1291"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01292" /><CodeLine lineNumber="1292"></CodeLine>
<Link id="l01293" /><CodeLine lineNumber="1293"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::reMaterializeTrivialDef(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP,</span></CodeLine>
<Link id="l01294" /><CodeLine lineNumber="1294"><span class="doxyHighlight">                                                <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI,</span></CodeLine>
<Link id="l01295" /><CodeLine lineNumber="1295"><span class="doxyHighlight">                                                </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &amp;IsDefCopy) &#123;</span></CodeLine>
<Link id="l01296" /><CodeLine lineNumber="1296"><span class="doxyHighlight">  IsDefCopy = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01297" /><CodeLine lineNumber="1297"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> SrcReg = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg();</span></CodeLine>
<Link id="l01298" /><CodeLine lineNumber="1298"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SrcIdx = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx();</span></CodeLine>
<Link id="l01299" /><CodeLine lineNumber="1299"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> DstReg = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg();</span></CodeLine>
<Link id="l01300" /><CodeLine lineNumber="1300"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> DstIdx = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx();</span></CodeLine>
<Link id="l01301" /><CodeLine lineNumber="1301"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>())</span></CodeLine>
<Link id="l01302" /><CodeLine lineNumber="1302"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01303" /><CodeLine lineNumber="1303"></CodeLine>
<Link id="l01304" /><CodeLine lineNumber="1304"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;SrcInt = LIS-&gt;getInterval(SrcReg);</span></CodeLine>
<Link id="l01305" /><CodeLine lineNumber="1305"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CopyIdx = LIS-&gt;getInstructionIndex(&#42;CopyMI);</span></CodeLine>
<Link id="l01306" /><CodeLine lineNumber="1306"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;ValNo = SrcInt.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(CopyIdx).<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>();</span></CodeLine>
<Link id="l01307" /><CodeLine lineNumber="1307"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!ValNo)</span></CodeLine>
<Link id="l01308" /><CodeLine lineNumber="1308"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01309" /><CodeLine lineNumber="1309"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>() || ValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ab72366fd538f240cbb53dac39368cdfc">isUnused</a>())</span></CodeLine>
<Link id="l01310" /><CodeLine lineNumber="1310"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01311" /><CodeLine lineNumber="1311"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a> = LIS-&gt;getInstructionFromIndex(ValNo-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l01312" /><CodeLine lineNumber="1312"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>)</span></CodeLine>
<Link id="l01313" /><CodeLine lineNumber="1313"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01314" /><CodeLine lineNumber="1314"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1f3c8255141a4f5b7ed15fcf60118eb1">isCopyLike</a>()) &#123;</span></CodeLine>
<Link id="l01315" /><CodeLine lineNumber="1315"><span class="doxyHighlight">    IsDefCopy = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01316" /><CodeLine lineNumber="1316"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01317" /><CodeLine lineNumber="1317"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01318" /><CodeLine lineNumber="1318"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;<a href="/docs/api/classes/llvm/hexagoninstrinfo/#a87cf243e21383cb4e5397728877b6a1d">isAsCheapAsAMove</a>(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>))</span></CodeLine>
<Link id="l01319" /><CodeLine lineNumber="1319"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01320" /><CodeLine lineNumber="1320"></CodeLine>
<Link id="l01321" /><CodeLine lineNumber="1321"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Register, 8&gt;</a> NewRegs;</span></CodeLine>
<Link id="l01322" /><CodeLine lineNumber="1322"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liverangeedit">LiveRangeEdit</a> Edit(&amp;SrcInt, NewRegs, &#42;MF, &#42;LIS, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01323" /><CodeLine lineNumber="1323"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Edit.<a href="/docs/api/classes/llvm/liverangeedit/#aeaf1429d245f871e41187accdce34e06">checkRematerializable</a>(ValNo, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>))</span></CodeLine>
<Link id="l01324" /><CodeLine lineNumber="1324"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01325" /><CodeLine lineNumber="1325"></CodeLine>
<Link id="l01326" /><CodeLine lineNumber="1326"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#ac11097e2672b5d37ed48a38c9328142f">definesFullReg</a>(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>, SrcReg))</span></CodeLine>
<Link id="l01327" /><CodeLine lineNumber="1327"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01328" /><CodeLine lineNumber="1328"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> SawStore = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01329" /><CodeLine lineNumber="1329"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a3c3bece1d6d099a7b6bc4c22ea768e8e">isSafeToMove</a>(SawStore))</span></CodeLine>
<Link id="l01330" /><CodeLine lineNumber="1330"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01331" /><CodeLine lineNumber="1331"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/mcinstrdesc">MCInstrDesc</a> &amp;<a href="/docs/api/namespaces/llvm/mcid">MCID</a> = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a75a5f7e3b3d4ec79610b4e556d2f35ce">getDesc</a>();</span></CodeLine>
<Link id="l01332" /><CodeLine lineNumber="1332"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/mcid">MCID</a>.getNumDefs() != 1)</span></CodeLine>
<Link id="l01333" /><CodeLine lineNumber="1333"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01334" /><CodeLine lineNumber="1334"></CodeLine>
<Link id="l01335" /><CodeLine lineNumber="1335"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If both SrcIdx and DstIdx are set, correct rematerialization would widen</span></CodeLine>
<Link id="l01336" /><CodeLine lineNumber="1336"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the register substantially (beyond both source and dest size). This is bad</span></CodeLine>
<Link id="l01337" /><CodeLine lineNumber="1337"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// for performance since it can cascade through a function, introducing many</span></CodeLine>
<Link id="l01338" /><CodeLine lineNumber="1338"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// extra spills and fills (e.g. ARM can easily end up copying QQQQPR registers</span></CodeLine>
<Link id="l01339" /><CodeLine lineNumber="1339"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// around after a few subreg copies).</span></CodeLine>
<Link id="l01340" /><CodeLine lineNumber="1340"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcIdx &amp;&amp; DstIdx)</span></CodeLine>
<Link id="l01341" /><CodeLine lineNumber="1341"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01342" /><CodeLine lineNumber="1342"></CodeLine>
<Link id="l01343" /><CodeLine lineNumber="1343"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Only support subregister destinations when the def is read-undef.</span></CodeLine>
<Link id="l01344" /><CodeLine lineNumber="1344"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;DstOperand = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0);</span></CodeLine>
<Link id="l01345" /><CodeLine lineNumber="1345"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> CopyDstReg = DstOperand.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</span></CodeLine>
<Link id="l01346" /><CodeLine lineNumber="1346"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstOperand.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>() &amp;&amp; !DstOperand.<a href="/docs/api/classes/llvm/machineoperand/#a1255befbcd6e034394681b1bcd3529ff">isUndef</a>())</span></CodeLine>
<Link id="l01347" /><CodeLine lineNumber="1347"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01348" /><CodeLine lineNumber="1348"></CodeLine>
<Link id="l01349" /><CodeLine lineNumber="1349"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// In the physical register case, checking that the def is read-undef is not</span></CodeLine>
<Link id="l01350" /><CodeLine lineNumber="1350"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// enough. We&#39;re widening the def and need to avoid clobbering other live</span></CodeLine>
<Link id="l01351" /><CodeLine lineNumber="1351"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// values in the unused register pieces.</span></CodeLine>
<Link id="l01352" /><CodeLine lineNumber="1352"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01353" /><CodeLine lineNumber="1353"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: Targets may support rewriting the rematerialized instruction to only</span></CodeLine>
<Link id="l01354" /><CodeLine lineNumber="1354"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// touch relevant lanes, in which case we don&#39;t need any liveness check.</span></CodeLine>
<Link id="l01355" /><CodeLine lineNumber="1355"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CopyDstReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() &amp;&amp; <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPartial()) &#123;</span></CodeLine>
<Link id="l01356" /><CodeLine lineNumber="1356"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a8adc81fee7f9e66260dd2b626660c9c9">MCRegUnit</a> Unit : <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;regunits(DstReg)) &#123;</span></CodeLine>
<Link id="l01357" /><CodeLine lineNumber="1357"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Ignore the register units we are writing anyway.</span></CodeLine>
<Link id="l01358" /><CodeLine lineNumber="1358"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#acd1cd968cb420c82d70926920fcdc7d7">is&#95;contained</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;regunits(CopyDstReg), Unit))</span></CodeLine>
<Link id="l01359" /><CodeLine lineNumber="1359"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01360" /><CodeLine lineNumber="1360"></CodeLine>
<Link id="l01361" /><CodeLine lineNumber="1361"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Check if the other lanes we are defining are live at the</span></CodeLine>
<Link id="l01362" /><CodeLine lineNumber="1362"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// rematerialization point.</span></CodeLine>
<Link id="l01363" /><CodeLine lineNumber="1363"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;LR = LIS-&gt;getRegUnit(Unit);</span></CodeLine>
<Link id="l01364" /><CodeLine lineNumber="1364"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LR.<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(CopyIdx))</span></CodeLine>
<Link id="l01365" /><CodeLine lineNumber="1365"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01366" /><CodeLine lineNumber="1366"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01367" /><CodeLine lineNumber="1367"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01368" /><CodeLine lineNumber="1368"></CodeLine>
<Link id="l01369" /><CodeLine lineNumber="1369"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> DefSubIdx = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>();</span></CodeLine>
<Link id="l01370" /><CodeLine lineNumber="1370"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterclass">TargetRegisterClass</a> &#42;DefRC = <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;getRegClass(<a href="/docs/api/namespaces/llvm/mcid">MCID</a>, 0, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, &#42;MF);</span></CodeLine>
<Link id="l01371" /><CodeLine lineNumber="1371"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a120ccebe70e1b0ddf72fc776229d0025">isImplicitDef</a>()) &#123;</span></CodeLine>
<Link id="l01372" /><CodeLine lineNumber="1372"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>()) &#123;</span></CodeLine>
<Link id="l01373" /><CodeLine lineNumber="1373"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/register">Register</a> NewDstReg = DstReg;</span></CodeLine>
<Link id="l01374" /><CodeLine lineNumber="1374"></CodeLine>
<Link id="l01375" /><CodeLine lineNumber="1375"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NewDstIdx = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndices(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx(), DefSubIdx);</span></CodeLine>
<Link id="l01376" /><CodeLine lineNumber="1376"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewDstIdx)</span></CodeLine>
<Link id="l01377" /><CodeLine lineNumber="1377"><span class="doxyHighlight">        NewDstReg = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubReg(DstReg, NewDstIdx);</span></CodeLine>
<Link id="l01378" /><CodeLine lineNumber="1378"></CodeLine>
<Link id="l01379" /><CodeLine lineNumber="1379"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Finally, make sure that the physical subregister that will be</span></CodeLine>
<Link id="l01380" /><CodeLine lineNumber="1380"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// constructed later is permitted for the instruction.</span></CodeLine>
<Link id="l01381" /><CodeLine lineNumber="1381"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DefRC-&gt;<a href="/docs/api/classes/llvm/targetregisterclass/#a60b6974966381f08079722f2258a0039">contains</a>(NewDstReg))</span></CodeLine>
<Link id="l01382" /><CodeLine lineNumber="1382"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01383" /><CodeLine lineNumber="1383"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01384" /><CodeLine lineNumber="1384"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Theoretically, some stack frame reference could exist. Just make sure</span></CodeLine>
<Link id="l01385" /><CodeLine lineNumber="1385"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// it hasn&#39;t actually happened.</span></CodeLine>
<Link id="l01386" /><CodeLine lineNumber="1386"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstReg.<a href="/docs/api/classes/llvm/register/#ab203bbcbc320180b1da9e9a92ee0c784">isVirtual</a>() &amp;&amp;</span></CodeLine>
<Link id="l01387" /><CodeLine lineNumber="1387"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Only expect to deal with virtual or physical registers&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01388" /><CodeLine lineNumber="1388"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01389" /><CodeLine lineNumber="1389"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01390" /><CodeLine lineNumber="1390"></CodeLine>
<Link id="l01391" /><CodeLine lineNumber="1391"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/liverangeedit/remat">LiveRangeEdit::Remat</a> <a href="/docs/api/namespaces/llvm/aarch64/#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>(ValNo);</span></CodeLine>
<Link id="l01392" /><CodeLine lineNumber="1392"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/aarch64/#a2a1421dcee7067c8a9c69752bd8ec566ae435ab4c104cb9e9e78f43e41b8c02cb">RM</a>.OrigMI = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>;</span></CodeLine>
<Link id="l01393" /><CodeLine lineNumber="1393"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Edit.<a href="/docs/api/classes/llvm/liverangeedit/#af8377265a59783069f11e01edc8e3edc">canRematerializeAt</a>(RM, ValNo, CopyIdx, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">))</span></CodeLine>
<Link id="l01394" /><CodeLine lineNumber="1394"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01395" /><CodeLine lineNumber="1395"></CodeLine>
<Link id="l01396" /><CodeLine lineNumber="1396"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#abb10ef030fba4ea901518a0c8dbef3e2">getDebugLoc</a>();</span></CodeLine>
<Link id="l01397" /><CodeLine lineNumber="1397"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>();</span></CodeLine>
<Link id="l01398" /><CodeLine lineNumber="1398"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a> MII =</span></CodeLine>
<Link id="l01399" /><CodeLine lineNumber="1399"><span class="doxyHighlight">      std::next(<a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a>(CopyMI));</span></CodeLine>
<Link id="l01400" /><CodeLine lineNumber="1400"><span class="doxyHighlight">  Edit.<a href="/docs/api/classes/llvm/liverangeedit/#ad2480b715c870bd7fc306f70c3fa1dc8">rematerializeAt</a>(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, MII, DstReg, RM, &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, SrcIdx, CopyMI);</span></CodeLine>
<Link id="l01401" /><CodeLine lineNumber="1401"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;NewMI = &#42;std::prev(MII);</span></CodeLine>
<Link id="l01402" /><CodeLine lineNumber="1402"><span class="doxyHighlight">  NewMI.<a href="/docs/api/classes/llvm/machineinstr/#af2641f071128da26317fab5b9594ec71">setDebugLoc</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>);</span></CodeLine>
<Link id="l01403" /><CodeLine lineNumber="1403"></CodeLine>
<Link id="l01404" /><CodeLine lineNumber="1404"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// In a situation like the following:</span></CodeLine>
<Link id="l01405" /><CodeLine lineNumber="1405"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//     %0:subreg = instr              ; DefMI, subreg = DstIdx</span></CodeLine>
<Link id="l01406" /><CodeLine lineNumber="1406"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//     %1        = copy %0:subreg ; CopyMI, SrcIdx = 0</span></CodeLine>
<Link id="l01407" /><CodeLine lineNumber="1407"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instead of widening %1 to the register class of %0 simply do:</span></CodeLine>
<Link id="l01408" /><CodeLine lineNumber="1408"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//     %1 = instr</span></CodeLine>
<Link id="l01409" /><CodeLine lineNumber="1409"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterclass">TargetRegisterClass</a> &#42;NewRC = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC();</span></CodeLine>
<Link id="l01410" /><CodeLine lineNumber="1410"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstIdx != 0) &#123;</span></CodeLine>
<Link id="l01411" /><CodeLine lineNumber="1411"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;DefMO = NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0);</span></CodeLine>
<Link id="l01412" /><CodeLine lineNumber="1412"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DefMO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>() == DstIdx) &#123;</span></CodeLine>
<Link id="l01413" /><CodeLine lineNumber="1413"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SrcIdx == 0 &amp;&amp; <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() &amp;&amp;</span></CodeLine>
<Link id="l01414" /><CodeLine lineNumber="1414"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Shouldn&#39;t have SrcIdx+DstIdx at this point&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01415" /><CodeLine lineNumber="1415"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterclass">TargetRegisterClass</a> &#42;DstRC = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getRegClass(DstReg);</span></CodeLine>
<Link id="l01416" /><CodeLine lineNumber="1416"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterclass">TargetRegisterClass</a> &#42;CommonRC =</span></CodeLine>
<Link id="l01417" /><CodeLine lineNumber="1417"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getCommonSubClass(DefRC, DstRC);</span></CodeLine>
<Link id="l01418" /><CodeLine lineNumber="1418"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CommonRC != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l01419" /><CodeLine lineNumber="1419"><span class="doxyHighlight">        NewRC = CommonRC;</span></CodeLine>
<Link id="l01420" /><CodeLine lineNumber="1420"></CodeLine>
<Link id="l01421" /><CodeLine lineNumber="1421"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Instruction might contain &quot;undef %0:subreg&quot; as use operand:</span></CodeLine>
<Link id="l01422" /><CodeLine lineNumber="1422"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//   %0:subreg = instr op&#95;1, ..., op&#95;N, undef %0:subreg, op&#95;N+2, ...</span></CodeLine>
<Link id="l01423" /><CodeLine lineNumber="1423"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01424" /><CodeLine lineNumber="1424"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Need to check all operands.</span></CodeLine>
<Link id="l01425" /><CodeLine lineNumber="1425"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : NewMI.<a href="/docs/api/classes/llvm/machineinstr/#a999b8f3e58e7ca479f26445bae791a7c">operands</a>()) &#123;</span></CodeLine>
<Link id="l01426" /><CodeLine lineNumber="1426"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.isReg() &amp;&amp; MO.getReg() == DstReg &amp;&amp; MO.getSubReg() == DstIdx) &#123;</span></CodeLine>
<Link id="l01427" /><CodeLine lineNumber="1427"><span class="doxyHighlight">            MO.setSubReg(0);</span></CodeLine>
<Link id="l01428" /><CodeLine lineNumber="1428"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l01429" /><CodeLine lineNumber="1429"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01430" /><CodeLine lineNumber="1430"></CodeLine>
<Link id="l01431" /><CodeLine lineNumber="1431"><span class="doxyHighlight">        DstIdx = 0;</span></CodeLine>
<Link id="l01432" /><CodeLine lineNumber="1432"><span class="doxyHighlight">        DefMO.<a href="/docs/api/classes/llvm/machineoperand/#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">); </span><span class="doxyHighlightComment">// Only subregs can have def+undef.</span></CodeLine>
<Link id="l01433" /><CodeLine lineNumber="1433"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01434" /><CodeLine lineNumber="1434"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01435" /><CodeLine lineNumber="1435"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01436" /><CodeLine lineNumber="1436"></CodeLine>
<Link id="l01437" /><CodeLine lineNumber="1437"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CopyMI may have implicit operands, save them so that we can transfer them</span></CodeLine>
<Link id="l01438" /><CodeLine lineNumber="1438"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// over to the newly materialized instruction after CopyMI is removed.</span></CodeLine>
<Link id="l01439" /><CodeLine lineNumber="1439"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineOperand, 4&gt;</a> ImplicitOps;</span></CodeLine>
<Link id="l01440" /><CodeLine lineNumber="1440"><span class="doxyHighlight">  ImplicitOps.<a href="/docs/api/classes/llvm/smallvectorimpl/#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a432824f0975bb863478bf4ef3a5df258">getNumOperands</a>() -</span></CodeLine>
<Link id="l01441" /><CodeLine lineNumber="1441"><span class="doxyHighlight">                      CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a75a5f7e3b3d4ec79610b4e556d2f35ce">getDesc</a>().<a href="/docs/api/classes/llvm/mcinstrdesc/#a0ca904e64ee29c8812ed34e632d3c947">getNumOperands</a>());</span></CodeLine>
<Link id="l01442" /><CodeLine lineNumber="1442"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a75a5f7e3b3d4ec79610b4e556d2f35ce">getDesc</a>().<a href="/docs/api/classes/llvm/mcinstrdesc/#a0ca904e64ee29c8812ed34e632d3c947">getNumOperands</a>(),</span></CodeLine>
<Link id="l01443" /><CodeLine lineNumber="1443"><span class="doxyHighlight">                <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a432824f0975bb863478bf4ef3a5df258">getNumOperands</a>();</span></CodeLine>
<Link id="l01444" /><CodeLine lineNumber="1444"><span class="doxyHighlight">       <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l01445" /><CodeLine lineNumber="1445"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l01446" /><CodeLine lineNumber="1446"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a4c9594c955fec80c73ddd964b5efd554">isReg</a>()) &#123;</span></CodeLine>
<Link id="l01447" /><CodeLine lineNumber="1447"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MO.<a href="/docs/api/classes/llvm/machineoperand/#a3bf161859e1ad7fd3da485d3cb688d34">isImplicit</a>() &amp;&amp;</span></CodeLine>
<Link id="l01448" /><CodeLine lineNumber="1448"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;No explicit operands after implicit operands.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01449" /><CodeLine lineNumber="1449"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>().<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() ||</span></CodeLine>
<Link id="l01450" /><CodeLine lineNumber="1450"><span class="doxyHighlight">              (MO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>() == 0 &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == DstOperand.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>())) &amp;&amp;</span></CodeLine>
<Link id="l01451" /><CodeLine lineNumber="1451"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;unexpected implicit virtual register def&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01452" /><CodeLine lineNumber="1452"><span class="doxyHighlight">      ImplicitOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(MO);</span></CodeLine>
<Link id="l01453" /><CodeLine lineNumber="1453"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01454" /><CodeLine lineNumber="1454"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01455" /><CodeLine lineNumber="1455"></CodeLine>
<Link id="l01456" /><CodeLine lineNumber="1456"><span class="doxyHighlight">  CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ac2421adbb9996e1b15f03a8abb6c70a8">eraseFromParent</a>();</span></CodeLine>
<Link id="l01457" /><CodeLine lineNumber="1457"><span class="doxyHighlight">  ErasedInstrs.insert(CopyMI);</span></CodeLine>
<Link id="l01458" /><CodeLine lineNumber="1458"></CodeLine>
<Link id="l01459" /><CodeLine lineNumber="1459"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// NewMI may have dead implicit defs (E.g. EFLAGS for MOV&lt;bits&gt;r0 on X86).</span></CodeLine>
<Link id="l01460" /><CodeLine lineNumber="1460"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We need to remember these so we can add intervals once we insert</span></CodeLine>
<Link id="l01461" /><CodeLine lineNumber="1461"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// NewMI into SlotIndexes.</span></CodeLine>
<Link id="l01462" /><CodeLine lineNumber="1462"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01463" /><CodeLine lineNumber="1463"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We also expect to have tied implicit-defs of super registers originating</span></CodeLine>
<Link id="l01464" /><CodeLine lineNumber="1464"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// from SUBREG&#95;TO&#95;REG, such as:</span></CodeLine>
<Link id="l01465" /><CodeLine lineNumber="1465"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// $edi = MOV32r0 implicit-def dead $eflags, implicit-def $rdi</span></CodeLine>
<Link id="l01466" /><CodeLine lineNumber="1466"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// undef %0.sub&#95;32bit = MOV32r0 implicit-def dead $eflags, implicit-def %0</span></CodeLine>
<Link id="l01467" /><CodeLine lineNumber="1467"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01468" /><CodeLine lineNumber="1468"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The implicit-def of the super register may have been reduced to</span></CodeLine>
<Link id="l01469" /><CodeLine lineNumber="1469"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// subregisters depending on the uses.</span></CodeLine>
<Link id="l01470" /><CodeLine lineNumber="1470"></CodeLine>
<Link id="l01471" /><CodeLine lineNumber="1471"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> NewMIDefinesFullReg = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01472" /><CodeLine lineNumber="1472"></CodeLine>
<Link id="l01473" /><CodeLine lineNumber="1473"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MCRegister, 4&gt;</a> NewMIImplDefs;</span></CodeLine>
<Link id="l01474" /><CodeLine lineNumber="1474"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = NewMI.<a href="/docs/api/classes/llvm/machineinstr/#a75a5f7e3b3d4ec79610b4e556d2f35ce">getDesc</a>().<a href="/docs/api/classes/llvm/mcinstrdesc/#a0ca904e64ee29c8812ed34e632d3c947">getNumOperands</a>(),</span></CodeLine>
<Link id="l01475" /><CodeLine lineNumber="1475"><span class="doxyHighlight">                e = NewMI.<a href="/docs/api/classes/llvm/machineinstr/#a432824f0975bb863478bf4ef3a5df258">getNumOperands</a>();</span></CodeLine>
<Link id="l01476" /><CodeLine lineNumber="1476"><span class="doxyHighlight">       i != e; ++i) &#123;</span></CodeLine>
<Link id="l01477" /><CodeLine lineNumber="1477"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO = NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(i);</span></CodeLine>
<Link id="l01478" /><CodeLine lineNumber="1478"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#a75eb135014670ce946e78739cdc9b51b">isDef</a>()) &#123;</span></CodeLine>
<Link id="l01479" /><CodeLine lineNumber="1479"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MO.<a href="/docs/api/classes/llvm/machineoperand/#a3bf161859e1ad7fd3da485d3cb688d34">isImplicit</a>());</span></CodeLine>
<Link id="l01480" /><CodeLine lineNumber="1480"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>().<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>()) &#123;</span></CodeLine>
<Link id="l01481" /><CodeLine lineNumber="1481"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == DstReg)</span></CodeLine>
<Link id="l01482" /><CodeLine lineNumber="1482"><span class="doxyHighlight">          NewMIDefinesFullReg = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01483" /><CodeLine lineNumber="1483"></CodeLine>
<Link id="l01484" /><CodeLine lineNumber="1484"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MO.<a href="/docs/api/classes/llvm/machineoperand/#a3bf161859e1ad7fd3da485d3cb688d34">isImplicit</a>() &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>().<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() &amp;&amp;</span></CodeLine>
<Link id="l01485" /><CodeLine lineNumber="1485"><span class="doxyHighlight">               (MO.<a href="/docs/api/classes/llvm/machineoperand/#aaee820701392c55ad54235d3d7201206">isDead</a>() ||</span></CodeLine>
<Link id="l01486" /><CodeLine lineNumber="1486"><span class="doxyHighlight">                (DefSubIdx &amp;&amp;</span></CodeLine>
<Link id="l01487" /><CodeLine lineNumber="1487"><span class="doxyHighlight">                 ((<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubReg(MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), DefSubIdx) ==</span></CodeLine>
<Link id="l01488" /><CodeLine lineNumber="1488"><span class="doxyHighlight">                   <a href="/docs/api/classes/llvm/mcregister">MCRegister</a>((</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight">)NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>())) ||</span></CodeLine>
<Link id="l01489" /><CodeLine lineNumber="1489"><span class="doxyHighlight">                  <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;isSubRegisterEq(NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(),</span></CodeLine>
<Link id="l01490" /><CodeLine lineNumber="1490"><span class="doxyHighlight">                                       MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>())))));</span></CodeLine>
<Link id="l01491" /><CodeLine lineNumber="1491"><span class="doxyHighlight">        NewMIImplDefs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>().<a href="/docs/api/classes/llvm/register/#a49effcc0d9e7a321043ade70145d11f6">asMCReg</a>());</span></CodeLine>
<Link id="l01492" /><CodeLine lineNumber="1492"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01493" /><CodeLine lineNumber="1493"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</span></CodeLine>
<Link id="l01494" /><CodeLine lineNumber="1494"></CodeLine>
<Link id="l01495" /><CodeLine lineNumber="1495"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We&#39;re only expecting another def of the main output, so the range</span></CodeLine>
<Link id="l01496" /><CodeLine lineNumber="1496"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// should get updated with the regular output range.</span></CodeLine>
<Link id="l01497" /><CodeLine lineNumber="1497"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01498" /><CodeLine lineNumber="1498"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// FIXME: The range updating below probably needs updating to look at</span></CodeLine>
<Link id="l01499" /><CodeLine lineNumber="1499"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// the super register if subranges are tracked.</span></CodeLine>
<Link id="l01500" /><CodeLine lineNumber="1500"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;shouldTrackSubRegLiveness(DstReg) &amp;&amp;</span></CodeLine>
<Link id="l01501" /><CodeLine lineNumber="1501"><span class="doxyHighlight">               </span><span class="doxyHighlightStringLiteral">&quot;subrange update for implicit-def of super register may not be &quot;</span></CodeLine>
<Link id="l01502" /><CodeLine lineNumber="1502"><span class="doxyHighlight">               </span><span class="doxyHighlightStringLiteral">&quot;properly handled&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01503" /><CodeLine lineNumber="1503"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01504" /><CodeLine lineNumber="1504"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01505" /><CodeLine lineNumber="1505"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01506" /><CodeLine lineNumber="1506"></CodeLine>
<Link id="l01507" /><CodeLine lineNumber="1507"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstReg.<a href="/docs/api/classes/llvm/register/#ab203bbcbc320180b1da9e9a92ee0c784">isVirtual</a>()) &#123;</span></CodeLine>
<Link id="l01508" /><CodeLine lineNumber="1508"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NewIdx = NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>();</span></CodeLine>
<Link id="l01509" /><CodeLine lineNumber="1509"></CodeLine>
<Link id="l01510" /><CodeLine lineNumber="1510"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DefRC != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l01511" /><CodeLine lineNumber="1511"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewIdx)</span></CodeLine>
<Link id="l01512" /><CodeLine lineNumber="1512"><span class="doxyHighlight">        NewRC = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getMatchingSuperRegClass(NewRC, DefRC, NewIdx);</span></CodeLine>
<Link id="l01513" /><CodeLine lineNumber="1513"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l01514" /><CodeLine lineNumber="1514"><span class="doxyHighlight">        NewRC = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getCommonSubClass(NewRC, DefRC);</span></CodeLine>
<Link id="l01515" /><CodeLine lineNumber="1515"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(NewRC &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;subreg chosen for remat incompatible with instruction&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01516" /><CodeLine lineNumber="1516"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01517" /><CodeLine lineNumber="1517"></CodeLine>
<Link id="l01518" /><CodeLine lineNumber="1518"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Remap subranges to new lanemask and change register class.</span></CodeLine>
<Link id="l01519" /><CodeLine lineNumber="1519"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;DstInt = LIS-&gt;getInterval(DstReg);</span></CodeLine>
<Link id="l01520" /><CodeLine lineNumber="1520"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l01521" /><CodeLine lineNumber="1521"><span class="doxyHighlight">      SR.LaneMask = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndexLaneMask(DstIdx, SR.LaneMask);</span></CodeLine>
<Link id="l01522" /><CodeLine lineNumber="1522"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01523" /><CodeLine lineNumber="1523"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;setRegClass(DstReg, NewRC);</span></CodeLine>
<Link id="l01524" /><CodeLine lineNumber="1524"></CodeLine>
<Link id="l01525" /><CodeLine lineNumber="1525"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Update machine operands and add flags.</span></CodeLine>
<Link id="l01526" /><CodeLine lineNumber="1526"><span class="doxyHighlight">    updateRegDefsUses(DstReg, DstReg, DstIdx);</span></CodeLine>
<Link id="l01527" /><CodeLine lineNumber="1527"><span class="doxyHighlight">    NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#a001d31fcea92be51d2999826b806606f">setSubReg</a>(NewIdx);</span></CodeLine>
<Link id="l01528" /><CodeLine lineNumber="1528"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// updateRegDefUses can add an &quot;undef&quot; flag to the definition, since</span></CodeLine>
<Link id="l01529" /><CodeLine lineNumber="1529"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// it will replace DstReg with DstReg.DstIdx. If NewIdx is 0, make</span></CodeLine>
<Link id="l01530" /><CodeLine lineNumber="1530"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// sure that &quot;undef&quot; is not set.</span></CodeLine>
<Link id="l01531" /><CodeLine lineNumber="1531"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewIdx == 0)</span></CodeLine>
<Link id="l01532" /><CodeLine lineNumber="1532"><span class="doxyHighlight">      NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01533" /><CodeLine lineNumber="1533"></CodeLine>
<Link id="l01534" /><CodeLine lineNumber="1534"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// In a situation like the following:</span></CodeLine>
<Link id="l01535" /><CodeLine lineNumber="1535"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01536" /><CodeLine lineNumber="1536"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//    undef %2.subreg:reg = INST %1:reg    ; DefMI (rematerializable),</span></CodeLine>
<Link id="l01537" /><CodeLine lineNumber="1537"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//                                         ; Defines only some of lanes,</span></CodeLine>
<Link id="l01538" /><CodeLine lineNumber="1538"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//                                         ; so DefSubIdx = NewIdx = subreg</span></CodeLine>
<Link id="l01539" /><CodeLine lineNumber="1539"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//    %3:reg = COPY %2                     ; Copy full reg</span></CodeLine>
<Link id="l01540" /><CodeLine lineNumber="1540"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//    .... = SOMEINSTR %3:reg              ; Use full reg</span></CodeLine>
<Link id="l01541" /><CodeLine lineNumber="1541"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01542" /><CodeLine lineNumber="1542"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// there are no subranges for %3 so after rematerialization we need</span></CodeLine>
<Link id="l01543" /><CodeLine lineNumber="1543"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// to explicitly create them. Undefined subranges are removed later on.</span></CodeLine>
<Link id="l01544" /><CodeLine lineNumber="1544"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewIdx &amp;&amp; !DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>() &amp;&amp;</span></CodeLine>
<Link id="l01545" /><CodeLine lineNumber="1545"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;shouldTrackSubRegLiveness(DstReg)) &#123;</span></CodeLine>
<Link id="l01546" /><CodeLine lineNumber="1546"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> FullMask = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getMaxLaneMaskForVReg(DstReg);</span></CodeLine>
<Link id="l01547" /><CodeLine lineNumber="1547"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> UsedLanes = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(NewIdx);</span></CodeLine>
<Link id="l01548" /><CodeLine lineNumber="1548"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> UnusedLanes = FullMask &amp; ~UsedLanes;</span></CodeLine>
<Link id="l01549" /><CodeLine lineNumber="1549"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo/#aa750a7f159760b9c378d930deb6a9837">VNInfo::Allocator</a> &amp;<a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a> = LIS-&gt;getVNInfoAllocator();</span></CodeLine>
<Link id="l01550" /><CodeLine lineNumber="1550"><span class="doxyHighlight">      DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a8104005914e3dfed73608d0d8961b822">createSubRangeFrom</a>(<a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a>, UsedLanes, DstInt);</span></CodeLine>
<Link id="l01551" /><CodeLine lineNumber="1551"><span class="doxyHighlight">      DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a8104005914e3dfed73608d0d8961b822">createSubRangeFrom</a>(<a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a>, UnusedLanes, DstInt);</span></CodeLine>
<Link id="l01552" /><CodeLine lineNumber="1552"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01553" /><CodeLine lineNumber="1553"></CodeLine>
<Link id="l01554" /><CodeLine lineNumber="1554"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Add dead subregister definitions if we are defining the whole register</span></CodeLine>
<Link id="l01555" /><CodeLine lineNumber="1555"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// but only part of it is live.</span></CodeLine>
<Link id="l01556" /><CodeLine lineNumber="1556"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This could happen if the rematerialization instruction is rematerializing</span></CodeLine>
<Link id="l01557" /><CodeLine lineNumber="1557"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// more than actually is used in the register.</span></CodeLine>
<Link id="l01558" /><CodeLine lineNumber="1558"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// An example would be:</span></CodeLine>
<Link id="l01559" /><CodeLine lineNumber="1559"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// %1 = LOAD CONSTANTS 5, 8 ; Loading both 5 and 8 in different subregs</span></CodeLine>
<Link id="l01560" /><CodeLine lineNumber="1560"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ; Copying only part of the register here, but the rest is undef.</span></CodeLine>
<Link id="l01561" /><CodeLine lineNumber="1561"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// %2:sub&#95;16bit&lt;def, read-undef&gt; = COPY %1:sub&#95;16bit</span></CodeLine>
<Link id="l01562" /><CodeLine lineNumber="1562"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ==&gt;</span></CodeLine>
<Link id="l01563" /><CodeLine lineNumber="1563"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ; Materialize all the constants but only using one</span></CodeLine>
<Link id="l01564" /><CodeLine lineNumber="1564"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// %2 = LOAD&#95;CONSTANTS 5, 8</span></CodeLine>
<Link id="l01565" /><CodeLine lineNumber="1565"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01566" /><CodeLine lineNumber="1566"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// at this point for the part that wasn&#39;t defined before we could have</span></CodeLine>
<Link id="l01567" /><CodeLine lineNumber="1567"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// subranges missing the definition.</span></CodeLine>
<Link id="l01568" /><CodeLine lineNumber="1568"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewIdx == 0 &amp;&amp; DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l01569" /><CodeLine lineNumber="1569"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CurrIdx = LIS-&gt;getInstructionIndex(NewMI);</span></CodeLine>
<Link id="l01570" /><CodeLine lineNumber="1570"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> DefIndex =</span></CodeLine>
<Link id="l01571" /><CodeLine lineNumber="1571"><span class="doxyHighlight">          CurrIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#abd6aa9da048ef7a4faeaac6484d5c9a6">isEarlyClobber</a>());</span></CodeLine>
<Link id="l01572" /><CodeLine lineNumber="1572"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> MaxMask = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getMaxLaneMaskForVReg(DstReg);</span></CodeLine>
<Link id="l01573" /><CodeLine lineNumber="1573"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo/#aa750a7f159760b9c378d930deb6a9837">VNInfo::Allocator</a> &amp;<a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a> = LIS-&gt;getVNInfoAllocator();</span></CodeLine>
<Link id="l01574" /><CodeLine lineNumber="1574"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l01575" /><CodeLine lineNumber="1575"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SR.liveAt(DefIndex))</span></CodeLine>
<Link id="l01576" /><CodeLine lineNumber="1576"><span class="doxyHighlight">          SR.createDeadDef(DefIndex, <a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a>);</span></CodeLine>
<Link id="l01577" /><CodeLine lineNumber="1577"><span class="doxyHighlight">        MaxMask &amp;= ~SR.LaneMask;</span></CodeLine>
<Link id="l01578" /><CodeLine lineNumber="1578"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01579" /><CodeLine lineNumber="1579"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MaxMask.<a href="/docs/api/structs/llvm/lanebitmask/#a72988cca7ab2262ef68fdd0c5ae54940">any</a>()) &#123;</span></CodeLine>
<Link id="l01580" /><CodeLine lineNumber="1580"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &#42;SR = DstInt.<a href="/docs/api/classes/llvm/liveinterval/#af6fb03322f7b38d6e815343732497798">createSubRange</a>(<a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a>, MaxMask);</span></CodeLine>
<Link id="l01581" /><CodeLine lineNumber="1581"><span class="doxyHighlight">        SR-&gt;<a href="/docs/api/classes/llvm/liverange/#a4258d794235c7a408b3f52e5e4ef7159">createDeadDef</a>(DefIndex, <a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a>);</span></CodeLine>
<Link id="l01582" /><CodeLine lineNumber="1582"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01583" /><CodeLine lineNumber="1583"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01584" /><CodeLine lineNumber="1584"></CodeLine>
<Link id="l01585" /><CodeLine lineNumber="1585"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Make sure that the subrange for resultant undef is removed</span></CodeLine>
<Link id="l01586" /><CodeLine lineNumber="1586"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// For example:</span></CodeLine>
<Link id="l01587" /><CodeLine lineNumber="1587"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   %1:sub1&lt;def,read-undef&gt; = LOAD CONSTANT 1</span></CodeLine>
<Link id="l01588" /><CodeLine lineNumber="1588"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   %2 = COPY %1</span></CodeLine>
<Link id="l01589" /><CodeLine lineNumber="1589"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ==&gt;</span></CodeLine>
<Link id="l01590" /><CodeLine lineNumber="1590"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   %2:sub1&lt;def, read-undef&gt; = LOAD CONSTANT 1</span></CodeLine>
<Link id="l01591" /><CodeLine lineNumber="1591"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//     ; Correct but need to remove the subrange for %2:sub0</span></CodeLine>
<Link id="l01592" /><CodeLine lineNumber="1592"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//     ; as it is now undef</span></CodeLine>
<Link id="l01593" /><CodeLine lineNumber="1593"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewIdx != 0 &amp;&amp; DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l01594" /><CodeLine lineNumber="1594"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// The affected subregister segments can be removed.</span></CodeLine>
<Link id="l01595" /><CodeLine lineNumber="1595"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CurrIdx = LIS-&gt;getInstructionIndex(NewMI);</span></CodeLine>
<Link id="l01596" /><CodeLine lineNumber="1596"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> DstMask = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(NewIdx);</span></CodeLine>
<Link id="l01597" /><CodeLine lineNumber="1597"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> UpdatedSubRanges = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01598" /><CodeLine lineNumber="1598"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> DefIndex =</span></CodeLine>
<Link id="l01599" /><CodeLine lineNumber="1599"><span class="doxyHighlight">          CurrIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#abd6aa9da048ef7a4faeaac6484d5c9a6">isEarlyClobber</a>());</span></CodeLine>
<Link id="l01600" /><CodeLine lineNumber="1600"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo/#aa750a7f159760b9c378d930deb6a9837">VNInfo::Allocator</a> &amp;<a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a> = LIS-&gt;getVNInfoAllocator();</span></CodeLine>
<Link id="l01601" /><CodeLine lineNumber="1601"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l01602" /><CodeLine lineNumber="1602"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((SR.<a href="/docs/api/classes/llvm/liveinterval/subrange/#a8dab9096ed829f13c573a282e5723f62">LaneMask</a> &amp; DstMask).none()) &#123;</span></CodeLine>
<Link id="l01603" /><CodeLine lineNumber="1603"><span class="doxyHighlight">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</span></CodeLine>
<Link id="l01604" /><CodeLine lineNumber="1604"><span class="doxyHighlight">                     &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Removing undefined SubRange &quot;</span></CodeLine>
<Link id="l01605" /><CodeLine lineNumber="1605"><span class="doxyHighlight">                     &lt;&lt; <a href="/docs/api/namespaces/llvm/#a3e30e18d6f7ebd943eaf8ebc3a2b2930">PrintLaneMask</a>(SR.<a href="/docs/api/classes/llvm/liveinterval/subrange/#a8dab9096ed829f13c573a282e5723f62">LaneMask</a>) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; : &quot;</span><span class="doxyHighlight"> &lt;&lt; SR &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01606" /><CodeLine lineNumber="1606"></CodeLine>
<Link id="l01607" /><CodeLine lineNumber="1607"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;RmValNo = SR.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(CurrIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>())) &#123;</span></CodeLine>
<Link id="l01608" /><CodeLine lineNumber="1608"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// VNI is in ValNo - remove any segments in this SubRange that have</span></CodeLine>
<Link id="l01609" /><CodeLine lineNumber="1609"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// this ValNo</span></CodeLine>
<Link id="l01610" /><CodeLine lineNumber="1610"><span class="doxyHighlight">            SR.<a href="/docs/api/classes/llvm/liverange/#a63176e601338dbe403676b86e78c7203">removeValNo</a>(RmValNo);</span></CodeLine>
<Link id="l01611" /><CodeLine lineNumber="1611"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l01612" /><CodeLine lineNumber="1612"></CodeLine>
<Link id="l01613" /><CodeLine lineNumber="1613"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// We may not have a defined value at this point, but still need to</span></CodeLine>
<Link id="l01614" /><CodeLine lineNumber="1614"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// clear out any empty subranges tentatively created by</span></CodeLine>
<Link id="l01615" /><CodeLine lineNumber="1615"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// updateRegDefUses. The original subrange def may have only undefed</span></CodeLine>
<Link id="l01616" /><CodeLine lineNumber="1616"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// some lanes.</span></CodeLine>
<Link id="l01617" /><CodeLine lineNumber="1617"><span class="doxyHighlight">          UpdatedSubRanges = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01618" /><CodeLine lineNumber="1618"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01619" /><CodeLine lineNumber="1619"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// We know that this lane is defined by this instruction,</span></CodeLine>
<Link id="l01620" /><CodeLine lineNumber="1620"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// but at this point it may be empty because it is not used by</span></CodeLine>
<Link id="l01621" /><CodeLine lineNumber="1621"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// anything. This happens when updateRegDefUses adds the missing</span></CodeLine>
<Link id="l01622" /><CodeLine lineNumber="1622"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// lanes. Assign that lane a dead def so that the interferences</span></CodeLine>
<Link id="l01623" /><CodeLine lineNumber="1623"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// are properly modeled.</span></CodeLine>
<Link id="l01624" /><CodeLine lineNumber="1624"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SR.<a href="/docs/api/classes/llvm/liverange/#a66ff664a97cd3c30de7e873335a0c075">empty</a>())</span></CodeLine>
<Link id="l01625" /><CodeLine lineNumber="1625"><span class="doxyHighlight">            SR.<a href="/docs/api/classes/llvm/liverange/#a4258d794235c7a408b3f52e5e4ef7159">createDeadDef</a>(DefIndex, <a href="/docs/api/namespaces/llvm/#a264176188c0aadccd3ca5b6929b5a2e1aea571dc00aef155a16d4e7e1861e1682">Alloc</a>);</span></CodeLine>
<Link id="l01626" /><CodeLine lineNumber="1626"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01627" /><CodeLine lineNumber="1627"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01628" /><CodeLine lineNumber="1628"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UpdatedSubRanges)</span></CodeLine>
<Link id="l01629" /><CodeLine lineNumber="1629"><span class="doxyHighlight">        DstInt.<a href="/docs/api/classes/llvm/liveinterval/#a0aac3ef1eadaa206a70b767730ef3c5b">removeEmptySubRanges</a>();</span></CodeLine>
<Link id="l01630" /><CodeLine lineNumber="1630"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01631" /><CodeLine lineNumber="1631"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() != CopyDstReg) &#123;</span></CodeLine>
<Link id="l01632" /><CodeLine lineNumber="1632"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The New instruction may be defining a sub-register of what&#39;s actually</span></CodeLine>
<Link id="l01633" /><CodeLine lineNumber="1633"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// been asked for. If so it must implicitly define the whole thing.</span></CodeLine>
<Link id="l01634" /><CodeLine lineNumber="1634"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DstReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() &amp;&amp;</span></CodeLine>
<Link id="l01635" /><CodeLine lineNumber="1635"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Only expect virtual or physical registers in remat&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01636" /><CodeLine lineNumber="1636"><span class="doxyHighlight">    NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#a61a42c85bd86c6ca4554e27d33c3f798">setIsDead</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01637" /><CodeLine lineNumber="1637"></CodeLine>
<Link id="l01638" /><CodeLine lineNumber="1638"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewMIDefinesFullReg) &#123;</span></CodeLine>
<Link id="l01639" /><CodeLine lineNumber="1639"><span class="doxyHighlight">      NewMI.<a href="/docs/api/classes/llvm/machineinstr/#a469e271fba3a9b52dad4fa54eaf44e2b">addOperand</a>(<a href="/docs/api/classes/llvm/machineoperand/#af2c351dad09a71aa08e1d85c67ae6e53">MachineOperand::CreateReg</a>(</span></CodeLine>
<Link id="l01640" /><CodeLine lineNumber="1640"><span class="doxyHighlight">          CopyDstReg, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight"> </span><span class="doxyHighlightComment">/&#42;IsDef&#42;/</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight"> </span><span class="doxyHighlightComment">/&#42;IsImp&#42;/</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight"> </span><span class="doxyHighlightComment">/&#42;IsKill&#42;/</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l01641" /><CodeLine lineNumber="1641"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01642" /><CodeLine lineNumber="1642"></CodeLine>
<Link id="l01643" /><CodeLine lineNumber="1643"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Record small dead def live-ranges for all the subregisters</span></CodeLine>
<Link id="l01644" /><CodeLine lineNumber="1644"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// of the destination register.</span></CodeLine>
<Link id="l01645" /><CodeLine lineNumber="1645"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Otherwise, variables that live through may miss some</span></CodeLine>
<Link id="l01646" /><CodeLine lineNumber="1646"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// interferences, thus creating invalid allocation.</span></CodeLine>
<Link id="l01647" /><CodeLine lineNumber="1647"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// E.g., i386 code:</span></CodeLine>
<Link id="l01648" /><CodeLine lineNumber="1648"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// %1 = somedef ; %1 GR8</span></CodeLine>
<Link id="l01649" /><CodeLine lineNumber="1649"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// %2 = remat ; %2 GR32</span></CodeLine>
<Link id="l01650" /><CodeLine lineNumber="1650"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// CL = COPY %2.sub&#95;8bit</span></CodeLine>
<Link id="l01651" /><CodeLine lineNumber="1651"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// = somedef %1 ; %1 GR8</span></CodeLine>
<Link id="l01652" /><CodeLine lineNumber="1652"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// =&gt;</span></CodeLine>
<Link id="l01653" /><CodeLine lineNumber="1653"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// %1 = somedef ; %1 GR8</span></CodeLine>
<Link id="l01654" /><CodeLine lineNumber="1654"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// dead ECX = remat ; implicit-def CL</span></CodeLine>
<Link id="l01655" /><CodeLine lineNumber="1655"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// = somedef %1 ; %1 GR8</span></CodeLine>
<Link id="l01656" /><CodeLine lineNumber="1656"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// %1 will see the interferences with CL but not with CH since</span></CodeLine>
<Link id="l01657" /><CodeLine lineNumber="1657"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// no live-ranges would have been created for ECX.</span></CodeLine>
<Link id="l01658" /><CodeLine lineNumber="1658"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Fix that!</span></CodeLine>
<Link id="l01659" /><CodeLine lineNumber="1659"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> NewMIIdx = LIS-&gt;getInstructionIndex(NewMI);</span></CodeLine>
<Link id="l01660" /><CodeLine lineNumber="1660"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a8adc81fee7f9e66260dd2b626660c9c9">MCRegUnit</a> Unit : <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;regunits(NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()))</span></CodeLine>
<Link id="l01661" /><CodeLine lineNumber="1661"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &#42;LR = LIS-&gt;getCachedRegUnit(Unit))</span></CodeLine>
<Link id="l01662" /><CodeLine lineNumber="1662"><span class="doxyHighlight">        LR-&gt;<a href="/docs/api/classes/llvm/liverange/#a4258d794235c7a408b3f52e5e4ef7159">createDeadDef</a>(NewMIIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(), LIS-&gt;getVNInfoAllocator());</span></CodeLine>
<Link id="l01663" /><CodeLine lineNumber="1663"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01664" /><CodeLine lineNumber="1664"></CodeLine>
<Link id="l01665" /><CodeLine lineNumber="1665"><span class="doxyHighlight">  NewMI.<a href="/docs/api/classes/llvm/machineinstr/#a05427132a2cb380432ed752b5f2dea6b">setRegisterDefReadUndef</a>(NewMI.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</span></CodeLine>
<Link id="l01666" /><CodeLine lineNumber="1666"></CodeLine>
<Link id="l01667" /><CodeLine lineNumber="1667"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Transfer over implicit operands to the rematerialized instruction.</span></CodeLine>
<Link id="l01668" /><CodeLine lineNumber="1668"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : ImplicitOps)</span></CodeLine>
<Link id="l01669" /><CodeLine lineNumber="1669"><span class="doxyHighlight">    NewMI.<a href="/docs/api/classes/llvm/machineinstr/#a469e271fba3a9b52dad4fa54eaf44e2b">addOperand</a>(MO);</span></CodeLine>
<Link id="l01670" /><CodeLine lineNumber="1670"></CodeLine>
<Link id="l01671" /><CodeLine lineNumber="1671"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> NewMIIdx = LIS-&gt;getInstructionIndex(NewMI);</span></CodeLine>
<Link id="l01672" /><CodeLine lineNumber="1672"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/mcregister">MCRegister</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> : NewMIImplDefs) &#123;</span></CodeLine>
<Link id="l01673" /><CodeLine lineNumber="1673"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a8adc81fee7f9e66260dd2b626660c9c9">MCRegUnit</a> Unit : <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;regunits(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01674" /><CodeLine lineNumber="1674"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &#42;LR = LIS-&gt;getCachedRegUnit(Unit))</span></CodeLine>
<Link id="l01675" /><CodeLine lineNumber="1675"><span class="doxyHighlight">        LR-&gt;<a href="/docs/api/classes/llvm/liverange/#a4258d794235c7a408b3f52e5e4ef7159">createDeadDef</a>(NewMIIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(), LIS-&gt;getVNInfoAllocator());</span></CodeLine>
<Link id="l01676" /><CodeLine lineNumber="1676"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01677" /><CodeLine lineNumber="1677"></CodeLine>
<Link id="l01678" /><CodeLine lineNumber="1678"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Remat: &quot;</span><span class="doxyHighlight"> &lt;&lt; NewMI);</span></CodeLine>
<Link id="l01679" /><CodeLine lineNumber="1679"><span class="doxyHighlight">  ++NumReMats;</span></CodeLine>
<Link id="l01680" /><CodeLine lineNumber="1680"></CodeLine>
<Link id="l01681" /><CodeLine lineNumber="1681"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the virtual SrcReg is completely eliminated, update all DBG&#95;VALUEs</span></CodeLine>
<Link id="l01682" /><CodeLine lineNumber="1682"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to describe DstReg instead.</span></CodeLine>
<Link id="l01683" /><CodeLine lineNumber="1683"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;use&#95;nodbg&#95;empty(SrcReg)) &#123;</span></CodeLine>
<Link id="l01684" /><CodeLine lineNumber="1684"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;UseMO :</span></CodeLine>
<Link id="l01685" /><CodeLine lineNumber="1685"><span class="doxyHighlight">         <a href="/docs/api/namespaces/llvm/#a3d2cdc4a0db233678e7141c9d6ea3419">llvm::make&#95;early&#95;inc&#95;range</a>(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;use&#95;operands(SrcReg))) &#123;</span></CodeLine>
<Link id="l01686" /><CodeLine lineNumber="1686"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a> = UseMO.getParent();</span></CodeLine>
<Link id="l01687" /><CodeLine lineNumber="1687"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a42020afbcac5113c831c00294a0ac37f">isDebugInstr</a>()) &#123;</span></CodeLine>
<Link id="l01688" /><CodeLine lineNumber="1688"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>())</span></CodeLine>
<Link id="l01689" /><CodeLine lineNumber="1689"><span class="doxyHighlight">          UseMO.substPhysReg(DstReg, &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</span></CodeLine>
<Link id="l01690" /><CodeLine lineNumber="1690"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l01691" /><CodeLine lineNumber="1691"><span class="doxyHighlight">          UseMO.setReg(DstReg);</span></CodeLine>
<Link id="l01692" /><CodeLine lineNumber="1692"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Move the debug value directly after the def of the rematerialized</span></CodeLine>
<Link id="l01693" /><CodeLine lineNumber="1693"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// value in DstReg.</span></CodeLine>
<Link id="l01694" /><CodeLine lineNumber="1694"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#adf0023bdc4f05a7849c35b1c859580d8">splice</a>(std::next(NewMI.<a href="/docs/api/classes/llvm/ilist-node-impl/#af719fc783be6589465137d997701a432">getIterator</a>()), <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>(), <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>);</span></CodeLine>
<Link id="l01695" /><CodeLine lineNumber="1695"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tupdated: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>);</span></CodeLine>
<Link id="l01696" /><CodeLine lineNumber="1696"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01697" /><CodeLine lineNumber="1697"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01698" /><CodeLine lineNumber="1698"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01699" /><CodeLine lineNumber="1699"></CodeLine>
<Link id="l01700" /><CodeLine lineNumber="1700"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ToBeUpdated.count(SrcReg))</span></CodeLine>
<Link id="l01701" /><CodeLine lineNumber="1701"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01702" /><CodeLine lineNumber="1702"></CodeLine>
<Link id="l01703" /><CodeLine lineNumber="1703"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumCopyUses = 0;</span></CodeLine>
<Link id="l01704" /><CodeLine lineNumber="1704"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;UseMO : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;use&#95;nodbg&#95;operands(SrcReg)) &#123;</span></CodeLine>
<Link id="l01705" /><CodeLine lineNumber="1705"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UseMO.getParent()-&gt;isCopyLike())</span></CodeLine>
<Link id="l01706" /><CodeLine lineNumber="1706"><span class="doxyHighlight">      NumCopyUses++;</span></CodeLine>
<Link id="l01707" /><CodeLine lineNumber="1707"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01708" /><CodeLine lineNumber="1708"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NumCopyUses &lt; <a href="#ae4fcc7d618c726ebb208a5853442ce7e">LateRematUpdateThreshold</a>) &#123;</span></CodeLine>
<Link id="l01709" /><CodeLine lineNumber="1709"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The source interval can become smaller because we removed a use.</span></CodeLine>
<Link id="l01710" /><CodeLine lineNumber="1710"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(&amp;SrcInt, &amp;DeadDefs);</span></CodeLine>
<Link id="l01711" /><CodeLine lineNumber="1711"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DeadDefs.empty())</span></CodeLine>
<Link id="l01712" /><CodeLine lineNumber="1712"><span class="doxyHighlight">      eliminateDeadDefs(&amp;Edit);</span></CodeLine>
<Link id="l01713" /><CodeLine lineNumber="1713"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01714" /><CodeLine lineNumber="1714"><span class="doxyHighlight">    ToBeUpdated.insert(SrcReg);</span></CodeLine>
<Link id="l01715" /><CodeLine lineNumber="1715"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01716" /><CodeLine lineNumber="1716"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01717" /><CodeLine lineNumber="1717"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01718" /><CodeLine lineNumber="1718"></CodeLine>
<Link id="l01719" /><CodeLine lineNumber="1719"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;RegisterCoalescer::eliminateUndefCopy(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI) &#123;</span></CodeLine>
<Link id="l01720" /><CodeLine lineNumber="1720"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ProcessImplicitDefs may leave some copies of &lt;undef&gt; values, it only</span></CodeLine>
<Link id="l01721" /><CodeLine lineNumber="1721"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// removes local variables. When we have a copy like:</span></CodeLine>
<Link id="l01722" /><CodeLine lineNumber="1722"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01723" /><CodeLine lineNumber="1723"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   %1 = COPY undef %2</span></CodeLine>
<Link id="l01724" /><CodeLine lineNumber="1724"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01725" /><CodeLine lineNumber="1725"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We delete the copy and remove the corresponding value number from %1.</span></CodeLine>
<Link id="l01726" /><CodeLine lineNumber="1726"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Any uses of that value number are marked as &lt;undef&gt;.</span></CodeLine>
<Link id="l01727" /><CodeLine lineNumber="1727"></CodeLine>
<Link id="l01728" /><CodeLine lineNumber="1728"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Note that we do not query CoalescerPair here but redo isMoveInstr as the</span></CodeLine>
<Link id="l01729" /><CodeLine lineNumber="1729"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CoalescerPair may have a new register class with adjusted subreg indices</span></CodeLine>
<Link id="l01730" /><CodeLine lineNumber="1730"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// at this point.</span></CodeLine>
<Link id="l01731" /><CodeLine lineNumber="1731"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> SrcReg, DstReg;</span></CodeLine>
<Link id="l01732" /><CodeLine lineNumber="1732"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SrcSubIdx = 0, DstSubIdx = 0;</span></CodeLine>
<Link id="l01733" /><CodeLine lineNumber="1733"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aaeffdea43602557f6c520f6b9501a491">isMoveInstr</a>(&#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, CopyMI, SrcReg, DstReg, SrcSubIdx, DstSubIdx))</span></CodeLine>
<Link id="l01734" /><CodeLine lineNumber="1734"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01735" /><CodeLine lineNumber="1735"></CodeLine>
<Link id="l01736" /><CodeLine lineNumber="1736"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> Idx = LIS-&gt;getInstructionIndex(&#42;CopyMI);</span></CodeLine>
<Link id="l01737" /><CodeLine lineNumber="1737"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;SrcLI = LIS-&gt;getInterval(SrcReg);</span></CodeLine>
<Link id="l01738" /><CodeLine lineNumber="1738"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CopyMI is undef iff SrcReg is not live before the instruction.</span></CodeLine>
<Link id="l01739" /><CodeLine lineNumber="1739"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcSubIdx != 0 &amp;&amp; SrcLI.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l01740" /><CodeLine lineNumber="1740"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> SrcMask = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(SrcSubIdx);</span></CodeLine>
<Link id="l01741" /><CodeLine lineNumber="1741"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : SrcLI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l01742" /><CodeLine lineNumber="1742"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((SR.<a href="/docs/api/classes/llvm/liveinterval/subrange/#a8dab9096ed829f13c573a282e5723f62">LaneMask</a> &amp; SrcMask).none())</span></CodeLine>
<Link id="l01743" /><CodeLine lineNumber="1743"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01744" /><CodeLine lineNumber="1744"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SR.<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(Idx))</span></CodeLine>
<Link id="l01745" /><CodeLine lineNumber="1745"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01746" /><CodeLine lineNumber="1746"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01747" /><CodeLine lineNumber="1747"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcLI.<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(Idx))</span></CodeLine>
<Link id="l01748" /><CodeLine lineNumber="1748"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01749" /><CodeLine lineNumber="1749"></CodeLine>
<Link id="l01750" /><CodeLine lineNumber="1750"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the undef copy defines a live-out value (i.e. an input to a PHI def),</span></CodeLine>
<Link id="l01751" /><CodeLine lineNumber="1751"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// then replace it with an IMPLICIT&#95;DEF.</span></CodeLine>
<Link id="l01752" /><CodeLine lineNumber="1752"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;DstLI = LIS-&gt;getInterval(DstReg);</span></CodeLine>
<Link id="l01753" /><CodeLine lineNumber="1753"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> RegIndex = Idx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</span></CodeLine>
<Link id="l01754" /><CodeLine lineNumber="1754"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/liverange/segment">LiveRange::Segment</a> &#42;Seg = DstLI.<a href="/docs/api/classes/llvm/liverange/#a1cde3a312b39ac23baecfce5fee662f7">getSegmentContaining</a>(RegIndex);</span></CodeLine>
<Link id="l01755" /><CodeLine lineNumber="1755"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Seg != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;No segment for defining instruction&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01756" /><CodeLine lineNumber="1756"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a> = DstLI.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(Seg-&gt;<a href="/docs/api/structs/llvm/liverange/segment/#afe8e59ffc86cb1736116e4dc8b86e26f">end</a>);</span></CodeLine>
<Link id="l01757" /><CodeLine lineNumber="1757"></CodeLine>
<Link id="l01758" /><CodeLine lineNumber="1758"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The source interval may also have been on an undef use, in which case the</span></CodeLine>
<Link id="l01759" /><CodeLine lineNumber="1759"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// copy introduced a live value.</span></CodeLine>
<Link id="l01760" /><CodeLine lineNumber="1760"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (((V &amp;&amp; <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>-&gt;isPHIDef()) || (!V &amp;&amp; !DstLI.<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(Idx)))) &#123;</span></CodeLine>
<Link id="l01761" /><CodeLine lineNumber="1761"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a432824f0975bb863478bf4ef3a5df258">getNumOperands</a>(); i != 0; --i) &#123;</span></CodeLine>
<Link id="l01762" /><CodeLine lineNumber="1762"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(i - 1);</span></CodeLine>
<Link id="l01763" /><CodeLine lineNumber="1763"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a4c9594c955fec80c73ddd964b5efd554">isReg</a>()) &#123;</span></CodeLine>
<Link id="l01764" /><CodeLine lineNumber="1764"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a69544ec8658eadeed98245dc37c3a541">isUse</a>())</span></CodeLine>
<Link id="l01765" /><CodeLine lineNumber="1765"><span class="doxyHighlight">          CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ac3b161ec90385105cb46a08b52139e60">removeOperand</a>(i - 1);</span></CodeLine>
<Link id="l01766" /><CodeLine lineNumber="1766"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01767" /><CodeLine lineNumber="1767"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MO.<a href="/docs/api/classes/llvm/machineoperand/#a76f61c6784df6dc8402a8b9011041926">isImm</a>() &amp;&amp;</span></CodeLine>
<Link id="l01768" /><CodeLine lineNumber="1768"><span class="doxyHighlight">               CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a0363204b5fbab08a46f5a7cd7f376f78">getOpcode</a>() == TargetOpcode::SUBREG&#95;TO&#95;REG);</span></CodeLine>
<Link id="l01769" /><CodeLine lineNumber="1769"><span class="doxyHighlight">        CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ac3b161ec90385105cb46a08b52139e60">removeOperand</a>(i - 1);</span></CodeLine>
<Link id="l01770" /><CodeLine lineNumber="1770"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01771" /><CodeLine lineNumber="1771"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01772" /><CodeLine lineNumber="1772"></CodeLine>
<Link id="l01773" /><CodeLine lineNumber="1773"><span class="doxyHighlight">    CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a9117508fb00fda14207e7f968389544c">setDesc</a>(<a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagoncopytocombine-cpp/#a1d40004718218dbdf06b496766299101">TII</a>-&gt;get(TargetOpcode::IMPLICIT&#95;DEF));</span></CodeLine>
<Link id="l01774" /><CodeLine lineNumber="1774"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tReplaced copy of &lt;undef&gt; value with an &quot;</span></CodeLine>
<Link id="l01775" /><CodeLine lineNumber="1775"><span class="doxyHighlight">                         </span><span class="doxyHighlightStringLiteral">&quot;implicit def\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01776" /><CodeLine lineNumber="1776"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CopyMI;</span></CodeLine>
<Link id="l01777" /><CodeLine lineNumber="1777"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01778" /><CodeLine lineNumber="1778"></CodeLine>
<Link id="l01779" /><CodeLine lineNumber="1779"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Remove any DstReg segments starting at the instruction.</span></CodeLine>
<Link id="l01780" /><CodeLine lineNumber="1780"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tEliminating copy of &lt;undef&gt; value\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01781" /><CodeLine lineNumber="1781"></CodeLine>
<Link id="l01782" /><CodeLine lineNumber="1782"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Remove value or merge with previous one in case of a subregister def.</span></CodeLine>
<Link id="l01783" /><CodeLine lineNumber="1783"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;PrevVNI = DstLI.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(Idx)) &#123;</span></CodeLine>
<Link id="l01784" /><CodeLine lineNumber="1784"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI = DstLI.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(RegIndex);</span></CodeLine>
<Link id="l01785" /><CodeLine lineNumber="1785"><span class="doxyHighlight">    DstLI.<a href="/docs/api/classes/llvm/liverange/#a92e17326c2170e889ae4390c56878b77">MergeValueNumberInto</a>(VNI, PrevVNI);</span></CodeLine>
<Link id="l01786" /><CodeLine lineNumber="1786"></CodeLine>
<Link id="l01787" /><CodeLine lineNumber="1787"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The affected subregister segments can be removed.</span></CodeLine>
<Link id="l01788" /><CodeLine lineNumber="1788"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> DstMask = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(DstSubIdx);</span></CodeLine>
<Link id="l01789" /><CodeLine lineNumber="1789"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : DstLI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l01790" /><CodeLine lineNumber="1790"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((SR.<a href="/docs/api/classes/llvm/liveinterval/subrange/#a8dab9096ed829f13c573a282e5723f62">LaneMask</a> &amp; DstMask).none())</span></CodeLine>
<Link id="l01791" /><CodeLine lineNumber="1791"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01792" /><CodeLine lineNumber="1792"></CodeLine>
<Link id="l01793" /><CodeLine lineNumber="1793"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;SVNI = SR.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(RegIndex);</span></CodeLine>
<Link id="l01794" /><CodeLine lineNumber="1794"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SVNI != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> &amp;&amp; <a href="/docs/api/classes/llvm/slotindex/#a0b73244049319d841fd11a238f35b5d1">SlotIndex::isSameInstr</a>(SVNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>, RegIndex));</span></CodeLine>
<Link id="l01795" /><CodeLine lineNumber="1795"><span class="doxyHighlight">      SR.<a href="/docs/api/classes/llvm/liverange/#a63176e601338dbe403676b86e78c7203">removeValNo</a>(SVNI);</span></CodeLine>
<Link id="l01796" /><CodeLine lineNumber="1796"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01797" /><CodeLine lineNumber="1797"><span class="doxyHighlight">    DstLI.<a href="/docs/api/classes/llvm/liveinterval/#a0aac3ef1eadaa206a70b767730ef3c5b">removeEmptySubRanges</a>();</span></CodeLine>
<Link id="l01798" /><CodeLine lineNumber="1798"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l01799" /><CodeLine lineNumber="1799"><span class="doxyHighlight">    LIS-&gt;removeVRegDefAt(DstLI, RegIndex);</span></CodeLine>
<Link id="l01800" /><CodeLine lineNumber="1800"></CodeLine>
<Link id="l01801" /><CodeLine lineNumber="1801"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Mark uses as undef.</span></CodeLine>
<Link id="l01802" /><CodeLine lineNumber="1802"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;reg&#95;nodbg&#95;operands(DstReg)) &#123;</span></CodeLine>
<Link id="l01803" /><CodeLine lineNumber="1803"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a75eb135014670ce946e78739cdc9b51b">isDef</a>() </span><span class="doxyHighlightComment">/&#42;|| MO.isUndef()&#42;/</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l01804" /><CodeLine lineNumber="1804"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01805" /><CodeLine lineNumber="1805"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = &#42;MO.<a href="/docs/api/classes/llvm/machineoperand/#a9719077fcba2cd439e84897257a47bb0">getParent</a>();</span></CodeLine>
<Link id="l01806" /><CodeLine lineNumber="1806"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> UseIdx = LIS-&gt;getInstructionIndex(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l01807" /><CodeLine lineNumber="1807"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/anonymous-slpvectorizer-cpp-/#a600545eb53de812fc4daae8ecb72199d">UseMask</a> = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(MO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>());</span></CodeLine>
<Link id="l01808" /><CodeLine lineNumber="1808"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> isLive;</span></CodeLine>
<Link id="l01809" /><CodeLine lineNumber="1809"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/anonymous-slpvectorizer-cpp-/#a600545eb53de812fc4daae8ecb72199d">UseMask</a>.all() &amp;&amp; DstLI.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l01810" /><CodeLine lineNumber="1810"><span class="doxyHighlight">      isLive = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01811" /><CodeLine lineNumber="1811"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : DstLI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l01812" /><CodeLine lineNumber="1812"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((SR.<a href="/docs/api/classes/llvm/liveinterval/subrange/#a8dab9096ed829f13c573a282e5723f62">LaneMask</a> &amp; UseMask).none())</span></CodeLine>
<Link id="l01813" /><CodeLine lineNumber="1813"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01814" /><CodeLine lineNumber="1814"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SR.<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(UseIdx)) &#123;</span></CodeLine>
<Link id="l01815" /><CodeLine lineNumber="1815"><span class="doxyHighlight">          isLive = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01816" /><CodeLine lineNumber="1816"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01817" /><CodeLine lineNumber="1817"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01818" /><CodeLine lineNumber="1818"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01819" /><CodeLine lineNumber="1819"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l01820" /><CodeLine lineNumber="1820"><span class="doxyHighlight">      isLive = DstLI.<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(UseIdx);</span></CodeLine>
<Link id="l01821" /><CodeLine lineNumber="1821"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (isLive)</span></CodeLine>
<Link id="l01822" /><CodeLine lineNumber="1822"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01823" /><CodeLine lineNumber="1823"><span class="doxyHighlight">    MO.<a href="/docs/api/classes/llvm/machineoperand/#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01824" /><CodeLine lineNumber="1824"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tnew undef: &quot;</span><span class="doxyHighlight"> &lt;&lt; UseIdx &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\t&#39;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l01825" /><CodeLine lineNumber="1825"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01826" /><CodeLine lineNumber="1826"></CodeLine>
<Link id="l01827" /><CodeLine lineNumber="1827"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// A def of a subregister may be a use of the other subregisters, so</span></CodeLine>
<Link id="l01828" /><CodeLine lineNumber="1828"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// deleting a def of a subregister may also remove uses. Since CopyMI</span></CodeLine>
<Link id="l01829" /><CodeLine lineNumber="1829"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is still part of the function (but about to be erased), mark all</span></CodeLine>
<Link id="l01830" /><CodeLine lineNumber="1830"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// defs of DstReg in it as &lt;undef&gt;, so that shrinkToUses would</span></CodeLine>
<Link id="l01831" /><CodeLine lineNumber="1831"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ignore them.</span></CodeLine>
<Link id="l01832" /><CodeLine lineNumber="1832"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ade4229c653b0cbcaca057e8af5002783">all&#95;defs</a>())</span></CodeLine>
<Link id="l01833" /><CodeLine lineNumber="1833"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == DstReg)</span></CodeLine>
<Link id="l01834" /><CodeLine lineNumber="1834"><span class="doxyHighlight">      MO.<a href="/docs/api/classes/llvm/machineoperand/#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01835" /><CodeLine lineNumber="1835"><span class="doxyHighlight">  LIS-&gt;shrinkToUses(&amp;DstLI);</span></CodeLine>
<Link id="l01836" /><CodeLine lineNumber="1836"></CodeLine>
<Link id="l01837" /><CodeLine lineNumber="1837"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CopyMI;</span></CodeLine>
<Link id="l01838" /><CodeLine lineNumber="1838"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01839" /><CodeLine lineNumber="1839"></CodeLine>
<Link id="l01840" /><CodeLine lineNumber="1840"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::addUndefFlag(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;<a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a637b69dea56f804278aa50e975337e01">Int</a>, <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> UseIdx,</span></CodeLine>
<Link id="l01841" /><CodeLine lineNumber="1841"><span class="doxyHighlight">                                     <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubRegIdx) &#123;</span></CodeLine>
<Link id="l01842" /><CodeLine lineNumber="1842"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a> = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(SubRegIdx);</span></CodeLine>
<Link id="l01843" /><CodeLine lineNumber="1843"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a75eb135014670ce946e78739cdc9b51b">isDef</a>())</span></CodeLine>
<Link id="l01844" /><CodeLine lineNumber="1844"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a> = ~Mask;</span></CodeLine>
<Link id="l01845" /><CodeLine lineNumber="1845"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsUndef = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01846" /><CodeLine lineNumber="1846"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a637b69dea56f804278aa50e975337e01">Int</a>.subranges()) &#123;</span></CodeLine>
<Link id="l01847" /><CodeLine lineNumber="1847"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((S.LaneMask &amp; Mask).none())</span></CodeLine>
<Link id="l01848" /><CodeLine lineNumber="1848"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01849" /><CodeLine lineNumber="1849"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (S.liveAt(UseIdx)) &#123;</span></CodeLine>
<Link id="l01850" /><CodeLine lineNumber="1850"><span class="doxyHighlight">      IsUndef = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01851" /><CodeLine lineNumber="1851"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01852" /><CodeLine lineNumber="1852"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01853" /><CodeLine lineNumber="1853"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01854" /><CodeLine lineNumber="1854"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsUndef) &#123;</span></CodeLine>
<Link id="l01855" /><CodeLine lineNumber="1855"><span class="doxyHighlight">    MO.<a href="/docs/api/classes/llvm/machineoperand/#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01856" /><CodeLine lineNumber="1856"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We found out some subregister use is actually reading an undefined</span></CodeLine>
<Link id="l01857" /><CodeLine lineNumber="1857"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// value. In some cases the whole vreg has become undefined at this</span></CodeLine>
<Link id="l01858" /><CodeLine lineNumber="1858"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// point so we have to potentially shrink the main range if the</span></CodeLine>
<Link id="l01859" /><CodeLine lineNumber="1859"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// use was ending a live segment there.</span></CodeLine>
<Link id="l01860" /><CodeLine lineNumber="1860"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> Q = <a href="/docs/api/files/lib/lib/analysis/targetlibraryinfo-cpp/#aca185e6d0e9f423dbb24440206454872a637b69dea56f804278aa50e975337e01">Int</a>.Query(UseIdx);</span></CodeLine>
<Link id="l01861" /><CodeLine lineNumber="1861"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Q.<a href="/docs/api/classes/llvm/livequeryresult/#a8c9627b7e8bbfa4fbd02f6644907147f">valueOut</a>() == </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l01862" /><CodeLine lineNumber="1862"><span class="doxyHighlight">      ShrinkMainRange = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01863" /><CodeLine lineNumber="1863"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01864" /><CodeLine lineNumber="1864"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01865" /><CodeLine lineNumber="1865"></CodeLine>
<Link id="l01866" /><CodeLine lineNumber="1866"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::updateRegDefsUses(<a href="/docs/api/classes/llvm/register">Register</a> SrcReg, <a href="/docs/api/classes/llvm/register">Register</a> DstReg,</span></CodeLine>
<Link id="l01867" /><CodeLine lineNumber="1867"><span class="doxyHighlight">                                          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubIdx) &#123;</span></CodeLine>
<Link id="l01868" /><CodeLine lineNumber="1868"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> DstIsPhys = DstReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>();</span></CodeLine>
<Link id="l01869" /><CodeLine lineNumber="1869"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &#42;DstInt = DstIsPhys ? nullptr : &amp;LIS-&gt;getInterval(DstReg);</span></CodeLine>
<Link id="l01870" /><CodeLine lineNumber="1870"></CodeLine>
<Link id="l01871" /><CodeLine lineNumber="1871"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstInt &amp;&amp; DstInt-&gt;<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>() &amp;&amp; DstReg != SrcReg) &#123;</span></CodeLine>
<Link id="l01872" /><CodeLine lineNumber="1872"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;reg&#95;operands(DstReg)) &#123;</span></CodeLine>
<Link id="l01873" /><CodeLine lineNumber="1873"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a1255befbcd6e034394681b1bcd3529ff">isUndef</a>())</span></CodeLine>
<Link id="l01874" /><CodeLine lineNumber="1874"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01875" /><CodeLine lineNumber="1875"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = MO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>();</span></CodeLine>
<Link id="l01876" /><CodeLine lineNumber="1876"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> == 0 &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#a75eb135014670ce946e78739cdc9b51b">isDef</a>())</span></CodeLine>
<Link id="l01877" /><CodeLine lineNumber="1877"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01878" /><CodeLine lineNumber="1878"></CodeLine>
<Link id="l01879" /><CodeLine lineNumber="1879"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = &#42;MO.<a href="/docs/api/classes/llvm/machineoperand/#a9719077fcba2cd439e84897257a47bb0">getParent</a>();</span></CodeLine>
<Link id="l01880" /><CodeLine lineNumber="1880"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugInstr())</span></CodeLine>
<Link id="l01881" /><CodeLine lineNumber="1881"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01882" /><CodeLine lineNumber="1882"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> UseIdx = LIS-&gt;getInstructionIndex(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01883" /><CodeLine lineNumber="1883"><span class="doxyHighlight">      addUndefFlag(&#42;DstInt, UseIdx, MO, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>);</span></CodeLine>
<Link id="l01884" /><CodeLine lineNumber="1884"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01885" /><CodeLine lineNumber="1885"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01886" /><CodeLine lineNumber="1886"></CodeLine>
<Link id="l01887" /><CodeLine lineNumber="1887"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;MachineInstr &#42;, 8&gt;</a> Visited;</span></CodeLine>
<Link id="l01888" /><CodeLine lineNumber="1888"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineregisterinfo/#ac29b0f94f5dfe6f242b99eed1b65fb7d">MachineRegisterInfo::reg&#95;instr&#95;iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;reg&#95;instr&#95;begin(SrcReg),</span></CodeLine>
<Link id="l01889" /><CodeLine lineNumber="1889"><span class="doxyHighlight">                                               <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a> = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;reg&#95;instr&#95;end();</span></CodeLine>
<Link id="l01890" /><CodeLine lineNumber="1890"><span class="doxyHighlight">       <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#abb2b3a60ccc38a28239e19a1646e0c8a">E</a>;) &#123;</span></CodeLine>
<Link id="l01891" /><CodeLine lineNumber="1891"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a> = &amp;&#42;(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>++);</span></CodeLine>
<Link id="l01892" /><CodeLine lineNumber="1892"></CodeLine>
<Link id="l01893" /><CodeLine lineNumber="1893"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Each instruction can only be rewritten once because sub-register</span></CodeLine>
<Link id="l01894" /><CodeLine lineNumber="1894"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// composition is not always idempotent. When SrcReg != DstReg, rewriting</span></CodeLine>
<Link id="l01895" /><CodeLine lineNumber="1895"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the UseMI operands removes them from the SrcReg use-def chain, but when</span></CodeLine>
<Link id="l01896" /><CodeLine lineNumber="1896"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// SrcReg is DstReg we could encounter UseMI twice if it has multiple</span></CodeLine>
<Link id="l01897" /><CodeLine lineNumber="1897"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// operands mentioning the virtual register.</span></CodeLine>
<Link id="l01898" /><CodeLine lineNumber="1898"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcReg == DstReg &amp;&amp; !Visited.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>).second)</span></CodeLine>
<Link id="l01899" /><CodeLine lineNumber="1899"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01900" /><CodeLine lineNumber="1900"></CodeLine>
<Link id="l01901" /><CodeLine lineNumber="1901"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;unsigned, 8&gt;</a> <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>;</span></CodeLine>
<Link id="l01902" /><CodeLine lineNumber="1902"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Reads, Writes;</span></CodeLine>
<Link id="l01903" /><CodeLine lineNumber="1903"><span class="doxyHighlight">    std::tie(Reads, Writes) = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a374fc9d9064a93ef8a408f269d02389d">readsWritesVirtualRegister</a>(SrcReg, &amp;<a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>);</span></CodeLine>
<Link id="l01904" /><CodeLine lineNumber="1904"></CodeLine>
<Link id="l01905" /><CodeLine lineNumber="1905"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If SrcReg wasn&#39;t read, it may still be the case that DstReg is live-in</span></CodeLine>
<Link id="l01906" /><CodeLine lineNumber="1906"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// because SrcReg is a sub-register.</span></CodeLine>
<Link id="l01907" /><CodeLine lineNumber="1907"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstInt &amp;&amp; !Reads &amp;&amp; SubIdx &amp;&amp; !<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a42020afbcac5113c831c00294a0ac37f">isDebugInstr</a>())</span></CodeLine>
<Link id="l01908" /><CodeLine lineNumber="1908"><span class="doxyHighlight">      Reads = DstInt-&gt;<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(LIS-&gt;getInstructionIndex(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>));</span></CodeLine>
<Link id="l01909" /><CodeLine lineNumber="1909"></CodeLine>
<Link id="l01910" /><CodeLine lineNumber="1910"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Replace SrcReg with DstReg in all UseMI operands.</span></CodeLine>
<Link id="l01911" /><CodeLine lineNumber="1911"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/files/include/include/llvm/include/llvm/demangle/itaniumdemangle-h/#a926d7ce2143863b7a2afda0fca4d2b65">Ops</a>) &#123;</span></CodeLine>
<Link id="l01912" /><CodeLine lineNumber="1912"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</span></CodeLine>
<Link id="l01913" /><CodeLine lineNumber="1913"></CodeLine>
<Link id="l01914" /><CodeLine lineNumber="1914"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Adjust &lt;undef&gt; flags in case of sub-register joins. We don&#39;t want to</span></CodeLine>
<Link id="l01915" /><CodeLine lineNumber="1915"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// turn a full def into a read-modify-write sub-register def and vice</span></CodeLine>
<Link id="l01916" /><CodeLine lineNumber="1916"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// versa.</span></CodeLine>
<Link id="l01917" /><CodeLine lineNumber="1917"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubIdx &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#a75eb135014670ce946e78739cdc9b51b">isDef</a>())</span></CodeLine>
<Link id="l01918" /><CodeLine lineNumber="1918"><span class="doxyHighlight">        MO.<a href="/docs/api/classes/llvm/machineoperand/#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>(!Reads);</span></CodeLine>
<Link id="l01919" /><CodeLine lineNumber="1919"></CodeLine>
<Link id="l01920" /><CodeLine lineNumber="1920"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// A subreg use of a partially undef (super) register may be a complete</span></CodeLine>
<Link id="l01921" /><CodeLine lineNumber="1921"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// undef use now and then has to be marked that way.</span></CodeLine>
<Link id="l01922" /><CodeLine lineNumber="1922"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a69544ec8658eadeed98245dc37c3a541">isUse</a>() &amp;&amp; !MO.<a href="/docs/api/classes/llvm/machineoperand/#a1255befbcd6e034394681b1bcd3529ff">isUndef</a>() &amp;&amp; !DstIsPhys) &#123;</span></CodeLine>
<Link id="l01923" /><CodeLine lineNumber="1923"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubUseIdx = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndices(SubIdx, MO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>());</span></CodeLine>
<Link id="l01924" /><CodeLine lineNumber="1924"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubUseIdx != 0 &amp;&amp; <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;shouldTrackSubRegLiveness(DstReg)) &#123;</span></CodeLine>
<Link id="l01925" /><CodeLine lineNumber="1925"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DstInt-&gt;<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l01926" /><CodeLine lineNumber="1926"><span class="doxyHighlight">            <a href="/docs/api/namespaces/llvm/#a8e612822d4ba7bb36c9c79582a567108">BumpPtrAllocator</a> &amp;<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a> = LIS-&gt;getVNInfoAllocator();</span></CodeLine>
<Link id="l01927" /><CodeLine lineNumber="1927"><span class="doxyHighlight">            <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> FullMask = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getMaxLaneMaskForVReg(DstInt-&gt;<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>());</span></CodeLine>
<Link id="l01928" /><CodeLine lineNumber="1928"><span class="doxyHighlight">            <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> UsedLanes = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(SubIdx);</span></CodeLine>
<Link id="l01929" /><CodeLine lineNumber="1929"><span class="doxyHighlight">            <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> UnusedLanes = FullMask &amp; ~UsedLanes;</span></CodeLine>
<Link id="l01930" /><CodeLine lineNumber="1930"><span class="doxyHighlight">            DstInt-&gt;<a href="/docs/api/classes/llvm/liveinterval/#a8104005914e3dfed73608d0d8961b822">createSubRangeFrom</a>(<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, UsedLanes, &#42;DstInt);</span></CodeLine>
<Link id="l01931" /><CodeLine lineNumber="1931"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// The unused lanes are just empty live-ranges at this point.</span></CodeLine>
<Link id="l01932" /><CodeLine lineNumber="1932"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// It is the caller responsibility to set the proper</span></CodeLine>
<Link id="l01933" /><CodeLine lineNumber="1933"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// dead segments if there is an actual dead def of the</span></CodeLine>
<Link id="l01934" /><CodeLine lineNumber="1934"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// unused lanes. This may happen with rematerialization.</span></CodeLine>
<Link id="l01935" /><CodeLine lineNumber="1935"><span class="doxyHighlight">            DstInt-&gt;<a href="/docs/api/classes/llvm/liveinterval/#af6fb03322f7b38d6e815343732497798">createSubRange</a>(<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, UnusedLanes);</span></CodeLine>
<Link id="l01936" /><CodeLine lineNumber="1936"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l01937" /><CodeLine lineNumber="1937"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> MIIdx = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a42020afbcac5113c831c00294a0ac37f">isDebugInstr</a>()</span></CodeLine>
<Link id="l01938" /><CodeLine lineNumber="1938"><span class="doxyHighlight">                                ? LIS-&gt;getSlotIndexes()-&gt;getIndexBefore(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>)</span></CodeLine>
<Link id="l01939" /><CodeLine lineNumber="1939"><span class="doxyHighlight">                                : LIS-&gt;getInstructionIndex(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>);</span></CodeLine>
<Link id="l01940" /><CodeLine lineNumber="1940"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> UseIdx = MIIdx.<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>(</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01941" /><CodeLine lineNumber="1941"><span class="doxyHighlight">          addUndefFlag(&#42;DstInt, UseIdx, MO, SubUseIdx);</span></CodeLine>
<Link id="l01942" /><CodeLine lineNumber="1942"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01943" /><CodeLine lineNumber="1943"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01944" /><CodeLine lineNumber="1944"></CodeLine>
<Link id="l01945" /><CodeLine lineNumber="1945"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstIsPhys)</span></CodeLine>
<Link id="l01946" /><CodeLine lineNumber="1946"><span class="doxyHighlight">        MO.<a href="/docs/api/classes/llvm/machineoperand/#a9842e6805ce84262b6bbe7da2b26772c">substPhysReg</a>(DstReg, &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</span></CodeLine>
<Link id="l01947" /><CodeLine lineNumber="1947"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l01948" /><CodeLine lineNumber="1948"><span class="doxyHighlight">        MO.<a href="/docs/api/classes/llvm/machineoperand/#a13a5b2fd837189405f1b07a6c9249d4f">substVirtReg</a>(DstReg, SubIdx, &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</span></CodeLine>
<Link id="l01949" /><CodeLine lineNumber="1949"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01950" /><CodeLine lineNumber="1950"></CodeLine>
<Link id="l01951" /><CodeLine lineNumber="1951"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</span></CodeLine>
<Link id="l01952" /><CodeLine lineNumber="1952"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tupdated: &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01953" /><CodeLine lineNumber="1953"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a42020afbcac5113c831c00294a0ac37f">isDebugInstr</a>())</span></CodeLine>
<Link id="l01954" /><CodeLine lineNumber="1954"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; LIS-&gt;getInstructionIndex(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01955" /><CodeLine lineNumber="1955"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#a6cf2f8996b1e9aaf2d7a435aaa62382f">UseMI</a>;</span></CodeLine>
<Link id="l01956" /><CodeLine lineNumber="1956"><span class="doxyHighlight">    &#125;);</span></CodeLine>
<Link id="l01957" /><CodeLine lineNumber="1957"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01958" /><CodeLine lineNumber="1958"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01959" /><CodeLine lineNumber="1959"></CodeLine>
<Link id="l01960" /><CodeLine lineNumber="1960"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::canJoinPhys(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP) &#123;</span></CodeLine>
<Link id="l01961" /><CodeLine lineNumber="1961"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Always join simple intervals that are defined by a single copy from a</span></CodeLine>
<Link id="l01962" /><CodeLine lineNumber="1962"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// reserved register. This doesn&#39;t increase register pressure, so it is</span></CodeLine>
<Link id="l01963" /><CodeLine lineNumber="1963"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// always beneficial.</span></CodeLine>
<Link id="l01964" /><CodeLine lineNumber="1964"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;isReserved(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg())) &#123;</span></CodeLine>
<Link id="l01965" /><CodeLine lineNumber="1965"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tCan only merge into reserved registers.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01966" /><CodeLine lineNumber="1966"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01967" /><CodeLine lineNumber="1967"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01968" /><CodeLine lineNumber="1968"></CodeLine>
<Link id="l01969" /><CodeLine lineNumber="1969"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;JoinVInt = LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l01970" /><CodeLine lineNumber="1970"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (JoinVInt.<a href="/docs/api/classes/llvm/liverange/#ac5db2ca7684625ebf424170b9e98f404">containsOneValue</a>())</span></CodeLine>
<Link id="l01971" /><CodeLine lineNumber="1971"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01972" /><CodeLine lineNumber="1972"></CodeLine>
<Link id="l01973" /><CodeLine lineNumber="1973"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l01974" /><CodeLine lineNumber="1974"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tCannot join complex intervals into reserved register.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01975" /><CodeLine lineNumber="1975"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01976" /><CodeLine lineNumber="1976"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01977" /><CodeLine lineNumber="1977"></CodeLine>
<Link id="l01978" /><CodeLine lineNumber="1978"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::copyValueUndefInPredecessors(</span></CodeLine>
<Link id="l01979" /><CodeLine lineNumber="1979"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;S, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> SLRQ) &#123;</span></CodeLine>
<Link id="l01980" /><CodeLine lineNumber="1980"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;Pred : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#addd80df79ba902914c7d8a52e3896b79">predecessors</a>()) &#123;</span></CodeLine>
<Link id="l01981" /><CodeLine lineNumber="1981"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> PredEnd = LIS-&gt;getMBBEndIdx(Pred);</span></CodeLine>
<Link id="l01982" /><CodeLine lineNumber="1982"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;V = S.<a href="/docs/api/classes/llvm/liverange/#afe7daa73e4cee4edb9f137a8008dfb73">getVNInfoAt</a>(PredEnd.<a href="/docs/api/classes/llvm/slotindex/#ac832da130f4d71a4533a69d98315fb19">getPrevSlot</a>())) &#123;</span></CodeLine>
<Link id="l01983" /><CodeLine lineNumber="1983"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If this is a self loop, we may be reading the same value.</span></CodeLine>
<Link id="l01984" /><CodeLine lineNumber="1984"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>-&gt;id != SLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a001d69b0b75e2841cc109cbe8729ba87">valueOutOrDead</a>()-&gt;<a href="/docs/api/classes/llvm/vninfo/#ad989a0c1b26066308798f4d11a0e69df">id</a>)</span></CodeLine>
<Link id="l01985" /><CodeLine lineNumber="1985"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01986" /><CodeLine lineNumber="1986"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01987" /><CodeLine lineNumber="1987"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01988" /><CodeLine lineNumber="1988"></CodeLine>
<Link id="l01989" /><CodeLine lineNumber="1989"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01990" /><CodeLine lineNumber="1990"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01991" /><CodeLine lineNumber="1991"></CodeLine>
<Link id="l01992" /><CodeLine lineNumber="1992"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::setUndefOnPrunedSubRegUses(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI,</span></CodeLine>
<Link id="l01993" /><CodeLine lineNumber="1993"><span class="doxyHighlight">                                                   <a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</span></CodeLine>
<Link id="l01994" /><CodeLine lineNumber="1994"><span class="doxyHighlight">                                                   <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> PrunedLanes) &#123;</span></CodeLine>
<Link id="l01995" /><CodeLine lineNumber="1995"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we had other instructions in the segment reading the undef sublane</span></CodeLine>
<Link id="l01996" /><CodeLine lineNumber="1996"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value, we need to mark them with undef.</span></CodeLine>
<Link id="l01997" /><CodeLine lineNumber="1997"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;use&#95;nodbg&#95;operands(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</span></CodeLine>
<Link id="l01998" /><CodeLine lineNumber="1998"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubRegIdx = MO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>();</span></CodeLine>
<Link id="l01999" /><CodeLine lineNumber="1999"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubRegIdx == 0 || MO.<a href="/docs/api/classes/llvm/machineoperand/#a1255befbcd6e034394681b1bcd3529ff">isUndef</a>())</span></CodeLine>
<Link id="l02000" /><CodeLine lineNumber="2000"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02001" /><CodeLine lineNumber="2001"></CodeLine>
<Link id="l02002" /><CodeLine lineNumber="2002"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> SubRegMask = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(SubRegIdx);</span></CodeLine>
<Link id="l02003" /><CodeLine lineNumber="2003"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> Pos = LIS-&gt;getInstructionIndex(&#42;MO.<a href="/docs/api/classes/llvm/machineoperand/#a9719077fcba2cd439e84897257a47bb0">getParent</a>());</span></CodeLine>
<Link id="l02004" /><CodeLine lineNumber="2004"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : LI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l02005" /><CodeLine lineNumber="2005"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!S.<a href="/docs/api/classes/llvm/liverange/#a400c0b88110521ad1de258a7885d9038">liveAt</a>(Pos) &amp;&amp; (PrunedLanes &amp; SubRegMask).any()) &#123;</span></CodeLine>
<Link id="l02006" /><CodeLine lineNumber="2006"><span class="doxyHighlight">        MO.<a href="/docs/api/classes/llvm/machineoperand/#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>();</span></CodeLine>
<Link id="l02007" /><CodeLine lineNumber="2007"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02008" /><CodeLine lineNumber="2008"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02009" /><CodeLine lineNumber="2009"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02010" /><CodeLine lineNumber="2010"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02011" /><CodeLine lineNumber="2011"></CodeLine>
<Link id="l02012" /><CodeLine lineNumber="2012"><span class="doxyHighlight">  LI.<a href="/docs/api/classes/llvm/liveinterval/#a0aac3ef1eadaa206a70b767730ef3c5b">removeEmptySubRanges</a>();</span></CodeLine>
<Link id="l02013" /><CodeLine lineNumber="2013"></CodeLine>
<Link id="l02014" /><CodeLine lineNumber="2014"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// A def of a subregister may be a use of other register lanes. Replacing</span></CodeLine>
<Link id="l02015" /><CodeLine lineNumber="2015"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// such a def with a def of a different register will eliminate the use,</span></CodeLine>
<Link id="l02016" /><CodeLine lineNumber="2016"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// and may cause the recorded live range to be larger than the actual</span></CodeLine>
<Link id="l02017" /><CodeLine lineNumber="2017"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// liveness in the program IR.</span></CodeLine>
<Link id="l02018" /><CodeLine lineNumber="2018"><span class="doxyHighlight">  LIS-&gt;shrinkToUses(&amp;LI);</span></CodeLine>
<Link id="l02019" /><CodeLine lineNumber="2019"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02020" /><CodeLine lineNumber="2020"></CodeLine>
<Link id="l02021" /><CodeLine lineNumber="2021"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::joinCopy(</span></CodeLine>
<Link id="l02022" /><CodeLine lineNumber="2022"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &amp;Again,</span></CodeLine>
<Link id="l02023" /><CodeLine lineNumber="2023"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineInstr &#42;&gt;</a> &amp;CurrentErasedInstrs) &#123;</span></CodeLine>
<Link id="l02024" /><CodeLine lineNumber="2024"><span class="doxyHighlight">  Again = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02025" /><CodeLine lineNumber="2025"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; LIS-&gt;getInstructionIndex(&#42;CopyMI) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\t&#39;</span><span class="doxyHighlight"> &lt;&lt; &#42;CopyMI);</span></CodeLine>
<Link id="l02026" /><CodeLine lineNumber="2026"></CodeLine>
<Link id="l02027" /><CodeLine lineNumber="2027"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>(&#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</span></CodeLine>
<Link id="l02028" /><CodeLine lineNumber="2028"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.setRegisters(CopyMI)) &#123;</span></CodeLine>
<Link id="l02029" /><CodeLine lineNumber="2029"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tNot coalescable.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02030" /><CodeLine lineNumber="2030"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02031" /><CodeLine lineNumber="2031"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02032" /><CodeLine lineNumber="2032"></CodeLine>
<Link id="l02033" /><CodeLine lineNumber="2033"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC()) &#123;</span></CodeLine>
<Link id="l02034" /><CodeLine lineNumber="2034"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> SrcRC = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getRegClass(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l02035" /><CodeLine lineNumber="2035"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DstRC = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getRegClass(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l02036" /><CodeLine lineNumber="2036"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SrcIdx = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx();</span></CodeLine>
<Link id="l02037" /><CodeLine lineNumber="2037"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> DstIdx = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx();</span></CodeLine>
<Link id="l02038" /><CodeLine lineNumber="2038"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped()) &#123;</span></CodeLine>
<Link id="l02039" /><CodeLine lineNumber="2039"><span class="doxyHighlight">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcIdx, DstIdx);</span></CodeLine>
<Link id="l02040" /><CodeLine lineNumber="2040"><span class="doxyHighlight">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(SrcRC, DstRC);</span></CodeLine>
<Link id="l02041" /><CodeLine lineNumber="2041"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02042" /><CodeLine lineNumber="2042"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;shouldCoalesce(CopyMI, SrcRC, SrcIdx, DstRC, DstIdx,</span></CodeLine>
<Link id="l02043" /><CodeLine lineNumber="2043"><span class="doxyHighlight">                             <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC(), &#42;LIS)) &#123;</span></CodeLine>
<Link id="l02044" /><CodeLine lineNumber="2044"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tSubtarget bailed on coalescing.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02045" /><CodeLine lineNumber="2045"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02046" /><CodeLine lineNumber="2046"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02047" /><CodeLine lineNumber="2047"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02048" /><CodeLine lineNumber="2048"></CodeLine>
<Link id="l02049" /><CodeLine lineNumber="2049"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Dead code elimination. This really should be handled by MachineDCE, but</span></CodeLine>
<Link id="l02050" /><CodeLine lineNumber="2050"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// sometimes dead copies slip through, and we can&#39;t generate invalid live</span></CodeLine>
<Link id="l02051" /><CodeLine lineNumber="2051"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ranges.</span></CodeLine>
<Link id="l02052" /><CodeLine lineNumber="2052"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys() &amp;&amp; CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#af408efad64e3aa0eef6c3a37c7794a83">allDefsAreDead</a>()) &#123;</span></CodeLine>
<Link id="l02053" /><CodeLine lineNumber="2053"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tCopy is dead.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02054" /><CodeLine lineNumber="2054"><span class="doxyHighlight">    DeadDefs.push&#95;back(CopyMI);</span></CodeLine>
<Link id="l02055" /><CodeLine lineNumber="2055"><span class="doxyHighlight">    eliminateDeadDefs();</span></CodeLine>
<Link id="l02056" /><CodeLine lineNumber="2056"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02057" /><CodeLine lineNumber="2057"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02058" /><CodeLine lineNumber="2058"></CodeLine>
<Link id="l02059" /><CodeLine lineNumber="2059"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Eliminate undefs.</span></CodeLine>
<Link id="l02060" /><CodeLine lineNumber="2060"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys()) &#123;</span></CodeLine>
<Link id="l02061" /><CodeLine lineNumber="2061"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this is an IMPLICIT&#95;DEF, leave it alone, but don&#39;t try to coalesce.</span></CodeLine>
<Link id="l02062" /><CodeLine lineNumber="2062"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;UndefMI = eliminateUndefCopy(CopyMI)) &#123;</span></CodeLine>
<Link id="l02063" /><CodeLine lineNumber="2063"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UndefMI-&gt;isImplicitDef())</span></CodeLine>
<Link id="l02064" /><CodeLine lineNumber="2064"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02065" /><CodeLine lineNumber="2065"><span class="doxyHighlight">      deleteInstr(CopyMI);</span></CodeLine>
<Link id="l02066" /><CodeLine lineNumber="2066"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">; </span><span class="doxyHighlightComment">// Not coalescable.</span></CodeLine>
<Link id="l02067" /><CodeLine lineNumber="2067"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02068" /><CodeLine lineNumber="2068"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02069" /><CodeLine lineNumber="2069"></CodeLine>
<Link id="l02070" /><CodeLine lineNumber="2070"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Coalesced copies are normally removed immediately, but transformations</span></CodeLine>
<Link id="l02071" /><CodeLine lineNumber="2071"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// like removeCopyByCommutingDef() can inadvertently create identity copies.</span></CodeLine>
<Link id="l02072" /><CodeLine lineNumber="2072"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// When that happens, just join the values and remove the copy.</span></CodeLine>
<Link id="l02073" /><CodeLine lineNumber="2073"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg() == <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg()) &#123;</span></CodeLine>
<Link id="l02074" /><CodeLine lineNumber="2074"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI = LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l02075" /><CodeLine lineNumber="2075"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tCopy already coalesced: &quot;</span><span class="doxyHighlight"> &lt;&lt; LI &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02076" /><CodeLine lineNumber="2076"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CopyIdx = LIS-&gt;getInstructionIndex(&#42;CopyMI);</span></CodeLine>
<Link id="l02077" /><CodeLine lineNumber="2077"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> LRQ = LI.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(CopyIdx);</span></CodeLine>
<Link id="l02078" /><CodeLine lineNumber="2078"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;DefVNI = LRQ.<a href="/docs/api/classes/llvm/livequeryresult/#aaae33cfd0a31e453deec40b2d5274e70">valueDefined</a>()) &#123;</span></CodeLine>
<Link id="l02079" /><CodeLine lineNumber="2079"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;ReadVNI = LRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>();</span></CodeLine>
<Link id="l02080" /><CodeLine lineNumber="2080"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ReadVNI &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;No value before copy and no &lt;undef&gt; flag.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02081" /><CodeLine lineNumber="2081"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ReadVNI != DefVNI &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Cannot read and define the same value.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02082" /><CodeLine lineNumber="2082"></CodeLine>
<Link id="l02083" /><CodeLine lineNumber="2083"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Track incoming undef lanes we need to eliminate from the subrange.</span></CodeLine>
<Link id="l02084" /><CodeLine lineNumber="2084"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> PrunedLanes;</span></CodeLine>
<Link id="l02085" /><CodeLine lineNumber="2085"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = CopyMI-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>();</span></CodeLine>
<Link id="l02086" /><CodeLine lineNumber="2086"></CodeLine>
<Link id="l02087" /><CodeLine lineNumber="2087"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Process subregister liveranges.</span></CodeLine>
<Link id="l02088" /><CodeLine lineNumber="2088"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : LI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l02089" /><CodeLine lineNumber="2089"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> SLRQ = S.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(CopyIdx);</span></CodeLine>
<Link id="l02090" /><CodeLine lineNumber="2090"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;SDefVNI = SLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#aaae33cfd0a31e453deec40b2d5274e70">valueDefined</a>()) &#123;</span></CodeLine>
<Link id="l02091" /><CodeLine lineNumber="2091"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;SReadVNI = SLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>())</span></CodeLine>
<Link id="l02092" /><CodeLine lineNumber="2092"><span class="doxyHighlight">            SDefVNI = S.<a href="/docs/api/classes/llvm/liverange/#a92e17326c2170e889ae4390c56878b77">MergeValueNumberInto</a>(SDefVNI, SReadVNI);</span></CodeLine>
<Link id="l02093" /><CodeLine lineNumber="2093"></CodeLine>
<Link id="l02094" /><CodeLine lineNumber="2094"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// If this copy introduced an undef subrange from an incoming value,</span></CodeLine>
<Link id="l02095" /><CodeLine lineNumber="2095"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// we need to eliminate the undef live in values from the subrange.</span></CodeLine>
<Link id="l02096" /><CodeLine lineNumber="2096"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (copyValueUndefInPredecessors(S, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, SLRQ)) &#123;</span></CodeLine>
<Link id="l02097" /><CodeLine lineNumber="2097"><span class="doxyHighlight">            <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Incoming sublane value is undef at copy\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02098" /><CodeLine lineNumber="2098"><span class="doxyHighlight">            PrunedLanes |= S.LaneMask;</span></CodeLine>
<Link id="l02099" /><CodeLine lineNumber="2099"><span class="doxyHighlight">            S.<a href="/docs/api/classes/llvm/liverange/#a63176e601338dbe403676b86e78c7203">removeValNo</a>(SDefVNI);</span></CodeLine>
<Link id="l02100" /><CodeLine lineNumber="2100"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l02101" /><CodeLine lineNumber="2101"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02102" /><CodeLine lineNumber="2102"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02103" /><CodeLine lineNumber="2103"></CodeLine>
<Link id="l02104" /><CodeLine lineNumber="2104"><span class="doxyHighlight">      LI.<a href="/docs/api/classes/llvm/liverange/#a92e17326c2170e889ae4390c56878b77">MergeValueNumberInto</a>(DefVNI, ReadVNI);</span></CodeLine>
<Link id="l02105" /><CodeLine lineNumber="2105"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PrunedLanes.<a href="/docs/api/structs/llvm/lanebitmask/#a72988cca7ab2262ef68fdd0c5ae54940">any</a>()) &#123;</span></CodeLine>
<Link id="l02106" /><CodeLine lineNumber="2106"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Pruning undef incoming lanes: &quot;</span><span class="doxyHighlight"> &lt;&lt; PrunedLanes</span></CodeLine>
<Link id="l02107" /><CodeLine lineNumber="2107"><span class="doxyHighlight">                          &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02108" /><CodeLine lineNumber="2108"><span class="doxyHighlight">        setUndefOnPrunedSubRegUses(LI, <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg(), PrunedLanes);</span></CodeLine>
<Link id="l02109" /><CodeLine lineNumber="2109"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02110" /><CodeLine lineNumber="2110"></CodeLine>
<Link id="l02111" /><CodeLine lineNumber="2111"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tMerged values:          &quot;</span><span class="doxyHighlight"> &lt;&lt; LI &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02112" /><CodeLine lineNumber="2112"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02113" /><CodeLine lineNumber="2113"><span class="doxyHighlight">    deleteInstr(CopyMI);</span></CodeLine>
<Link id="l02114" /><CodeLine lineNumber="2114"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02115" /><CodeLine lineNumber="2115"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02116" /><CodeLine lineNumber="2116"></CodeLine>
<Link id="l02117" /><CodeLine lineNumber="2117"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Enforce policies.</span></CodeLine>
<Link id="l02118" /><CodeLine lineNumber="2118"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys()) &#123;</span></CodeLine>
<Link id="l02119" /><CodeLine lineNumber="2119"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tConsidering merging &quot;</span></CodeLine>
<Link id="l02120" /><CodeLine lineNumber="2120"><span class="doxyHighlight">                      &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg(), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; with &quot;</span></CodeLine>
<Link id="l02121" /><CodeLine lineNumber="2121"><span class="doxyHighlight">                      &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx()) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02122" /><CodeLine lineNumber="2122"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!canJoinPhys(CP)) &#123;</span></CodeLine>
<Link id="l02123" /><CodeLine lineNumber="2123"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Before giving up coalescing, if definition of source is defined by</span></CodeLine>
<Link id="l02124" /><CodeLine lineNumber="2124"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// trivial computation, try rematerializing it.</span></CodeLine>
<Link id="l02125" /><CodeLine lineNumber="2125"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsDefCopy = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02126" /><CodeLine lineNumber="2126"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (reMaterializeTrivialDef(CP, CopyMI, IsDefCopy))</span></CodeLine>
<Link id="l02127" /><CodeLine lineNumber="2127"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02128" /><CodeLine lineNumber="2128"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsDefCopy)</span></CodeLine>
<Link id="l02129" /><CodeLine lineNumber="2129"><span class="doxyHighlight">        Again = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">; </span><span class="doxyHighlightComment">// May be possible to coalesce later.</span></CodeLine>
<Link id="l02130" /><CodeLine lineNumber="2130"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02131" /><CodeLine lineNumber="2131"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02132" /><CodeLine lineNumber="2132"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02133" /><CodeLine lineNumber="2133"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// When possible, let DstReg be the larger interval.</span></CodeLine>
<Link id="l02134" /><CodeLine lineNumber="2134"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPartial() &amp;&amp; LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg()).size() &gt;</span></CodeLine>
<Link id="l02135" /><CodeLine lineNumber="2135"><span class="doxyHighlight">                               LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg()).size())</span></CodeLine>
<Link id="l02136" /><CodeLine lineNumber="2136"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.flip();</span></CodeLine>
<Link id="l02137" /><CodeLine lineNumber="2137"></CodeLine>
<Link id="l02138" /><CodeLine lineNumber="2138"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</span></CodeLine>
<Link id="l02139" /><CodeLine lineNumber="2139"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tConsidering merging to &quot;</span></CodeLine>
<Link id="l02140" /><CodeLine lineNumber="2140"><span class="doxyHighlight">             &lt;&lt; <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getRegClassName(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC()) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; with &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02141" /><CodeLine lineNumber="2141"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx() &amp;&amp; <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx())</span></CodeLine>
<Link id="l02142" /><CodeLine lineNumber="2142"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg()) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; in &quot;</span></CodeLine>
<Link id="l02143" /><CodeLine lineNumber="2143"><span class="doxyHighlight">               &lt;&lt; <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexName(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx()) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; and &quot;</span></CodeLine>
<Link id="l02144" /><CodeLine lineNumber="2144"><span class="doxyHighlight">               &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg()) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; in &quot;</span></CodeLine>
<Link id="l02145" /><CodeLine lineNumber="2145"><span class="doxyHighlight">               &lt;&lt; <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexName(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx()) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02146" /><CodeLine lineNumber="2146"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l02147" /><CodeLine lineNumber="2147"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg(), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; in &quot;</span></CodeLine>
<Link id="l02148" /><CodeLine lineNumber="2148"><span class="doxyHighlight">               &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx()) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02149" /><CodeLine lineNumber="2149"><span class="doxyHighlight">    &#125;);</span></CodeLine>
<Link id="l02150" /><CodeLine lineNumber="2150"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02151" /><CodeLine lineNumber="2151"></CodeLine>
<Link id="l02152" /><CodeLine lineNumber="2152"><span class="doxyHighlight">  ShrinkMask = <a href="/docs/api/structs/llvm/lanebitmask/#a9082b6aa4021114645045d9c5628eb26">LaneBitmask::getNone</a>();</span></CodeLine>
<Link id="l02153" /><CodeLine lineNumber="2153"><span class="doxyHighlight">  ShrinkMainRange = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02154" /><CodeLine lineNumber="2154"></CodeLine>
<Link id="l02155" /><CodeLine lineNumber="2155"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Okay, attempt to join these two intervals.  On failure, this returns false.</span></CodeLine>
<Link id="l02156" /><CodeLine lineNumber="2156"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Otherwise, if one of the intervals being joined is a physreg, this method</span></CodeLine>
<Link id="l02157" /><CodeLine lineNumber="2157"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// always canonicalizes DstInt to be it.  The output &quot;SrcInt&quot; will not have</span></CodeLine>
<Link id="l02158" /><CodeLine lineNumber="2158"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// been modified, so we can use this information below to update aliases.</span></CodeLine>
<Link id="l02159" /><CodeLine lineNumber="2159"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!joinIntervals(CP)) &#123;</span></CodeLine>
<Link id="l02160" /><CodeLine lineNumber="2160"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Coalescing failed.</span></CodeLine>
<Link id="l02161" /><CodeLine lineNumber="2161"></CodeLine>
<Link id="l02162" /><CodeLine lineNumber="2162"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If definition of source is defined by trivial computation, try</span></CodeLine>
<Link id="l02163" /><CodeLine lineNumber="2163"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// rematerializing it.</span></CodeLine>
<Link id="l02164" /><CodeLine lineNumber="2164"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsDefCopy = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02165" /><CodeLine lineNumber="2165"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (reMaterializeTrivialDef(CP, CopyMI, IsDefCopy))</span></CodeLine>
<Link id="l02166" /><CodeLine lineNumber="2166"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02167" /><CodeLine lineNumber="2167"></CodeLine>
<Link id="l02168" /><CodeLine lineNumber="2168"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we can eliminate the copy without merging the live segments, do so</span></CodeLine>
<Link id="l02169" /><CodeLine lineNumber="2169"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// now.</span></CodeLine>
<Link id="l02170" /><CodeLine lineNumber="2170"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPartial() &amp;&amp; !<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys()) &#123;</span></CodeLine>
<Link id="l02171" /><CodeLine lineNumber="2171"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = adjustCopiesBackFrom(CP, CopyMI);</span></CodeLine>
<Link id="l02172" /><CodeLine lineNumber="2172"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Shrink = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02173" /><CodeLine lineNumber="2173"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>)</span></CodeLine>
<Link id="l02174" /><CodeLine lineNumber="2174"><span class="doxyHighlight">        std::tie(<a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>, Shrink) = removeCopyByCommutingDef(CP, CopyMI);</span></CodeLine>
<Link id="l02175" /><CodeLine lineNumber="2175"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>) &#123;</span></CodeLine>
<Link id="l02176" /><CodeLine lineNumber="2176"><span class="doxyHighlight">        deleteInstr(CopyMI);</span></CodeLine>
<Link id="l02177" /><CodeLine lineNumber="2177"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Shrink) &#123;</span></CodeLine>
<Link id="l02178" /><CodeLine lineNumber="2178"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/register">Register</a> DstReg = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped() ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg() : <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg();</span></CodeLine>
<Link id="l02179" /><CodeLine lineNumber="2179"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;DstLI = LIS-&gt;getInterval(DstReg);</span></CodeLine>
<Link id="l02180" /><CodeLine lineNumber="2180"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(&amp;DstLI);</span></CodeLine>
<Link id="l02181" /><CodeLine lineNumber="2181"><span class="doxyHighlight">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tshrunk:   &quot;</span><span class="doxyHighlight"> &lt;&lt; DstLI &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02182" /><CodeLine lineNumber="2182"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02183" /><CodeLine lineNumber="2183"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tTrivial!\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02184" /><CodeLine lineNumber="2184"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02185" /><CodeLine lineNumber="2185"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02186" /><CodeLine lineNumber="2186"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02187" /><CodeLine lineNumber="2187"></CodeLine>
<Link id="l02188" /><CodeLine lineNumber="2188"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Try and see if we can partially eliminate the copy by moving the copy to</span></CodeLine>
<Link id="l02189" /><CodeLine lineNumber="2189"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// its predecessor.</span></CodeLine>
<Link id="l02190" /><CodeLine lineNumber="2190"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPartial() &amp;&amp; !<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys())</span></CodeLine>
<Link id="l02191" /><CodeLine lineNumber="2191"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (removePartialRedundancy(CP, &#42;CopyMI))</span></CodeLine>
<Link id="l02192" /><CodeLine lineNumber="2192"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02193" /><CodeLine lineNumber="2193"></CodeLine>
<Link id="l02194" /><CodeLine lineNumber="2194"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Otherwise, we are unable to join the intervals.</span></CodeLine>
<Link id="l02195" /><CodeLine lineNumber="2195"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tInterference!\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02196" /><CodeLine lineNumber="2196"><span class="doxyHighlight">    Again = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">; </span><span class="doxyHighlightComment">// May be possible to coalesce later.</span></CodeLine>
<Link id="l02197" /><CodeLine lineNumber="2197"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02198" /><CodeLine lineNumber="2198"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02199" /><CodeLine lineNumber="2199"></CodeLine>
<Link id="l02200" /><CodeLine lineNumber="2200"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Coalescing to a virtual register that is of a sub-register class of the</span></CodeLine>
<Link id="l02201" /><CodeLine lineNumber="2201"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// other. Make sure the resulting register is set to the right register class.</span></CodeLine>
<Link id="l02202" /><CodeLine lineNumber="2202"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isCrossClass()) &#123;</span></CodeLine>
<Link id="l02203" /><CodeLine lineNumber="2203"><span class="doxyHighlight">    ++numCrossRCs;</span></CodeLine>
<Link id="l02204" /><CodeLine lineNumber="2204"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;setRegClass(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC());</span></CodeLine>
<Link id="l02205" /><CodeLine lineNumber="2205"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02206" /><CodeLine lineNumber="2206"></CodeLine>
<Link id="l02207" /><CodeLine lineNumber="2207"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Removing sub-register copies can ease the register class constraints.</span></CodeLine>
<Link id="l02208" /><CodeLine lineNumber="2208"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Make sure we attempt to inflate the register class of DstReg.</span></CodeLine>
<Link id="l02209" /><CodeLine lineNumber="2209"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys() &amp;&amp; RegClassInfo.isProperSubClass(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC()))</span></CodeLine>
<Link id="l02210" /><CodeLine lineNumber="2210"><span class="doxyHighlight">    InflateRegs.push&#95;back(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l02211" /><CodeLine lineNumber="2211"></CodeLine>
<Link id="l02212" /><CodeLine lineNumber="2212"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CopyMI has been erased by joinIntervals at this point. Remove it from</span></CodeLine>
<Link id="l02213" /><CodeLine lineNumber="2213"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ErasedInstrs since copyCoalesceWorkList() won&#39;t add a successful join back</span></CodeLine>
<Link id="l02214" /><CodeLine lineNumber="2214"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to the work list. This keeps ErasedInstrs from growing needlessly.</span></CodeLine>
<Link id="l02215" /><CodeLine lineNumber="2215"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ErasedInstrs.erase(CopyMI))</span></CodeLine>
<Link id="l02216" /><CodeLine lineNumber="2216"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// But we may encounter the instruction again in this iteration.</span></CodeLine>
<Link id="l02217" /><CodeLine lineNumber="2217"><span class="doxyHighlight">    CurrentErasedInstrs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(CopyMI);</span></CodeLine>
<Link id="l02218" /><CodeLine lineNumber="2218"></CodeLine>
<Link id="l02219" /><CodeLine lineNumber="2219"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Rewrite all SrcReg operands to DstReg.</span></CodeLine>
<Link id="l02220" /><CodeLine lineNumber="2220"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Also update DstReg operands to include DstIdx if it is set.</span></CodeLine>
<Link id="l02221" /><CodeLine lineNumber="2221"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx())</span></CodeLine>
<Link id="l02222" /><CodeLine lineNumber="2222"><span class="doxyHighlight">    updateRegDefsUses(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx());</span></CodeLine>
<Link id="l02223" /><CodeLine lineNumber="2223"><span class="doxyHighlight">  updateRegDefsUses(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg(), <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx());</span></CodeLine>
<Link id="l02224" /><CodeLine lineNumber="2224"></CodeLine>
<Link id="l02225" /><CodeLine lineNumber="2225"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Shrink subregister ranges if necessary.</span></CodeLine>
<Link id="l02226" /><CodeLine lineNumber="2226"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ShrinkMask.any()) &#123;</span></CodeLine>
<Link id="l02227" /><CodeLine lineNumber="2227"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI = LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l02228" /><CodeLine lineNumber="2228"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : LI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l02229" /><CodeLine lineNumber="2229"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((S.LaneMask &amp; ShrinkMask).none())</span></CodeLine>
<Link id="l02230" /><CodeLine lineNumber="2230"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02231" /><CodeLine lineNumber="2231"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Shrink LaneUses (Lane &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#a3e30e18d6f7ebd943eaf8ebc3a2b2930">PrintLaneMask</a>(S.LaneMask)</span></CodeLine>
<Link id="l02232" /><CodeLine lineNumber="2232"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;)\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02233" /><CodeLine lineNumber="2233"><span class="doxyHighlight">      LIS-&gt;shrinkToUses(S, LI.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>());</span></CodeLine>
<Link id="l02234" /><CodeLine lineNumber="2234"><span class="doxyHighlight">      ShrinkMainRange = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02235" /><CodeLine lineNumber="2235"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02236" /><CodeLine lineNumber="2236"><span class="doxyHighlight">    LI.<a href="/docs/api/classes/llvm/liveinterval/#a0aac3ef1eadaa206a70b767730ef3c5b">removeEmptySubRanges</a>();</span></CodeLine>
<Link id="l02237" /><CodeLine lineNumber="2237"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02238" /><CodeLine lineNumber="2238"></CodeLine>
<Link id="l02239" /><CodeLine lineNumber="2239"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CP.getSrcReg()&#39;s live interval has been merged into CP.getDstReg&#39;s live</span></CodeLine>
<Link id="l02240" /><CodeLine lineNumber="2240"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// interval. Since CP.getSrcReg() is in ToBeUpdated set and its live interval</span></CodeLine>
<Link id="l02241" /><CodeLine lineNumber="2241"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is not up-to-date, need to update the merged live interval here.</span></CodeLine>
<Link id="l02242" /><CodeLine lineNumber="2242"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ToBeUpdated.count(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg()))</span></CodeLine>
<Link id="l02243" /><CodeLine lineNumber="2243"><span class="doxyHighlight">    ShrinkMainRange = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02244" /><CodeLine lineNumber="2244"></CodeLine>
<Link id="l02245" /><CodeLine lineNumber="2245"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ShrinkMainRange) &#123;</span></CodeLine>
<Link id="l02246" /><CodeLine lineNumber="2246"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI = LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l02247" /><CodeLine lineNumber="2247"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(&amp;LI);</span></CodeLine>
<Link id="l02248" /><CodeLine lineNumber="2248"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02249" /><CodeLine lineNumber="2249"></CodeLine>
<Link id="l02250" /><CodeLine lineNumber="2250"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// SrcReg is guaranteed to be the register whose live interval that is</span></CodeLine>
<Link id="l02251" /><CodeLine lineNumber="2251"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// being merged.</span></CodeLine>
<Link id="l02252" /><CodeLine lineNumber="2252"><span class="doxyHighlight">  LIS-&gt;removeInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l02253" /><CodeLine lineNumber="2253"></CodeLine>
<Link id="l02254" /><CodeLine lineNumber="2254"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Update regalloc hint.</span></CodeLine>
<Link id="l02255" /><CodeLine lineNumber="2255"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;updateRegAllocHint(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg(), <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), &#42;MF);</span></CodeLine>
<Link id="l02256" /><CodeLine lineNumber="2256"></CodeLine>
<Link id="l02257" /><CodeLine lineNumber="2257"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</span></CodeLine>
<Link id="l02258" /><CodeLine lineNumber="2258"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tSuccess: &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg(), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx())</span></CodeLine>
<Link id="l02259" /><CodeLine lineNumber="2259"><span class="doxyHighlight">           &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; -&gt; &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx()) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02260" /><CodeLine lineNumber="2260"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tResult = &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02261" /><CodeLine lineNumber="2261"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys())</span></CodeLine>
<Link id="l02262" /><CodeLine lineNumber="2262"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>);</span></CodeLine>
<Link id="l02263" /><CodeLine lineNumber="2263"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l02264" /><CodeLine lineNumber="2264"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l02265" /><CodeLine lineNumber="2265"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02266" /><CodeLine lineNumber="2266"><span class="doxyHighlight">  &#125;);</span></CodeLine>
<Link id="l02267" /><CodeLine lineNumber="2267"></CodeLine>
<Link id="l02268" /><CodeLine lineNumber="2268"><span class="doxyHighlight">  ++numJoins;</span></CodeLine>
<Link id="l02269" /><CodeLine lineNumber="2269"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02270" /><CodeLine lineNumber="2270"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02271" /><CodeLine lineNumber="2271"></CodeLine>
<Link id="l02272" /><CodeLine lineNumber="2272"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::joinReservedPhysReg(<a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP) &#123;</span></CodeLine>
<Link id="l02273" /><CodeLine lineNumber="2273"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> DstReg = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg();</span></CodeLine>
<Link id="l02274" /><CodeLine lineNumber="2274"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> SrcReg = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg();</span></CodeLine>
<Link id="l02275" /><CodeLine lineNumber="2275"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Must be a physreg copy&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02276" /><CodeLine lineNumber="2276"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;isReserved(DstReg) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Not a reserved register&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02277" /><CodeLine lineNumber="2277"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = LIS-&gt;getInterval(SrcReg);</span></CodeLine>
<Link id="l02278" /><CodeLine lineNumber="2278"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tRHS = &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02279" /><CodeLine lineNumber="2279"></CodeLine>
<Link id="l02280" /><CodeLine lineNumber="2280"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.containsOneValue() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Invalid join with reserved register&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02281" /><CodeLine lineNumber="2281"></CodeLine>
<Link id="l02282" /><CodeLine lineNumber="2282"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Optimization for reserved registers like ESP. We can only merge with a</span></CodeLine>
<Link id="l02283" /><CodeLine lineNumber="2283"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// reserved physreg if RHS has a single value that is a copy of DstReg.</span></CodeLine>
<Link id="l02284" /><CodeLine lineNumber="2284"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The live range of the reserved register will look like a set of dead defs</span></CodeLine>
<Link id="l02285" /><CodeLine lineNumber="2285"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// - we don&#39;t properly track the live range of reserved registers.</span></CodeLine>
<Link id="l02286" /><CodeLine lineNumber="2286"></CodeLine>
<Link id="l02287" /><CodeLine lineNumber="2287"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Deny any overlapping intervals.  This depends on all the reserved</span></CodeLine>
<Link id="l02288" /><CodeLine lineNumber="2288"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// register live ranges to look like dead defs.</span></CodeLine>
<Link id="l02289" /><CodeLine lineNumber="2289"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;isConstantPhysReg(DstReg)) &#123;</span></CodeLine>
<Link id="l02290" /><CodeLine lineNumber="2290"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a8adc81fee7f9e66260dd2b626660c9c9">MCRegUnit</a> Unit : <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;regunits(DstReg)) &#123;</span></CodeLine>
<Link id="l02291" /><CodeLine lineNumber="2291"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Abort if not all the regunits are reserved.</span></CodeLine>
<Link id="l02292" /><CodeLine lineNumber="2292"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/mcregunitrootiterator">MCRegUnitRootIterator</a> RI(Unit, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>); RI.<a href="/docs/api/classes/llvm/mcregunitrootiterator/#abd29ecab24058fdf823addcad29c6939">isValid</a>(); ++RI) &#123;</span></CodeLine>
<Link id="l02293" /><CodeLine lineNumber="2293"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;isReserved(&#42;RI))</span></CodeLine>
<Link id="l02294" /><CodeLine lineNumber="2294"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02295" /><CodeLine lineNumber="2295"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02296" /><CodeLine lineNumber="2296"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.overlaps(LIS-&gt;getRegUnit(Unit))) &#123;</span></CodeLine>
<Link id="l02297" /><CodeLine lineNumber="2297"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tInterference: &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#a34302b557354b8a09796c30b9f7408ab">printRegUnit</a>(Unit, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)</span></CodeLine>
<Link id="l02298" /><CodeLine lineNumber="2298"><span class="doxyHighlight">                          &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02299" /><CodeLine lineNumber="2299"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02300" /><CodeLine lineNumber="2300"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02301" /><CodeLine lineNumber="2301"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02302" /><CodeLine lineNumber="2302"></CodeLine>
<Link id="l02303" /><CodeLine lineNumber="2303"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We must also check for overlaps with regmask clobbers.</span></CodeLine>
<Link id="l02304" /><CodeLine lineNumber="2304"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/bitvector">BitVector</a> RegMaskUsable;</span></CodeLine>
<Link id="l02305" /><CodeLine lineNumber="2305"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LIS-&gt;checkRegMaskInterference(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, RegMaskUsable) &amp;&amp;</span></CodeLine>
<Link id="l02306" /><CodeLine lineNumber="2306"><span class="doxyHighlight">        !RegMaskUsable.<a href="/docs/api/classes/llvm/bitvector/#a15d63c566878e964c19139b2c76c0dab">test</a>(DstReg)) &#123;</span></CodeLine>
<Link id="l02307" /><CodeLine lineNumber="2307"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tRegMask interference\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02308" /><CodeLine lineNumber="2308"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02309" /><CodeLine lineNumber="2309"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02310" /><CodeLine lineNumber="2310"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02311" /><CodeLine lineNumber="2311"></CodeLine>
<Link id="l02312" /><CodeLine lineNumber="2312"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Skip any value computations, we are not adding new values to the</span></CodeLine>
<Link id="l02313" /><CodeLine lineNumber="2313"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// reserved register.  Also skip merging the live ranges, the reserved</span></CodeLine>
<Link id="l02314" /><CodeLine lineNumber="2314"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// register live range doesn&#39;t need to be accurate as long as all the</span></CodeLine>
<Link id="l02315" /><CodeLine lineNumber="2315"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// defs are there.</span></CodeLine>
<Link id="l02316" /><CodeLine lineNumber="2316"></CodeLine>
<Link id="l02317" /><CodeLine lineNumber="2317"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Delete the identity copy.</span></CodeLine>
<Link id="l02318" /><CodeLine lineNumber="2318"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;CopyMI;</span></CodeLine>
<Link id="l02319" /><CodeLine lineNumber="2319"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isFlipped()) &#123;</span></CodeLine>
<Link id="l02320" /><CodeLine lineNumber="2320"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Physreg is copied into vreg</span></CodeLine>
<Link id="l02321" /><CodeLine lineNumber="2321"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   %y = COPY %physreg&#95;x</span></CodeLine>
<Link id="l02322" /><CodeLine lineNumber="2322"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   ...  //&lt; no other def of %physreg&#95;x here</span></CodeLine>
<Link id="l02323" /><CodeLine lineNumber="2323"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   use %y</span></CodeLine>
<Link id="l02324" /><CodeLine lineNumber="2324"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// =&gt;</span></CodeLine>
<Link id="l02325" /><CodeLine lineNumber="2325"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   ...</span></CodeLine>
<Link id="l02326" /><CodeLine lineNumber="2326"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   use %physreg&#95;x</span></CodeLine>
<Link id="l02327" /><CodeLine lineNumber="2327"><span class="doxyHighlight">    CopyMI = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getVRegDef(SrcReg);</span></CodeLine>
<Link id="l02328" /><CodeLine lineNumber="2328"><span class="doxyHighlight">    deleteInstr(CopyMI);</span></CodeLine>
<Link id="l02329" /><CodeLine lineNumber="2329"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02330" /><CodeLine lineNumber="2330"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// VReg is copied into physreg:</span></CodeLine>
<Link id="l02331" /><CodeLine lineNumber="2331"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   %y = def</span></CodeLine>
<Link id="l02332" /><CodeLine lineNumber="2332"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   ... //&lt; no other def or use of %physreg&#95;x here</span></CodeLine>
<Link id="l02333" /><CodeLine lineNumber="2333"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   %physreg&#95;x = COPY %y</span></CodeLine>
<Link id="l02334" /><CodeLine lineNumber="2334"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// =&gt;</span></CodeLine>
<Link id="l02335" /><CodeLine lineNumber="2335"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   %physreg&#95;x = def</span></CodeLine>
<Link id="l02336" /><CodeLine lineNumber="2336"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//   ...</span></CodeLine>
<Link id="l02337" /><CodeLine lineNumber="2337"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;hasOneNonDBGUse(SrcReg)) &#123;</span></CodeLine>
<Link id="l02338" /><CodeLine lineNumber="2338"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tMultiple vreg uses!\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02339" /><CodeLine lineNumber="2339"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02340" /><CodeLine lineNumber="2340"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02341" /><CodeLine lineNumber="2341"></CodeLine>
<Link id="l02342" /><CodeLine lineNumber="2342"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LIS-&gt;intervalIsInOneMBB(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>)) &#123;</span></CodeLine>
<Link id="l02343" /><CodeLine lineNumber="2343"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tComplex control flow!\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02344" /><CodeLine lineNumber="2344"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02345" /><CodeLine lineNumber="2345"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02346" /><CodeLine lineNumber="2346"></CodeLine>
<Link id="l02347" /><CodeLine lineNumber="2347"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;DestMI = &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;getVRegDef(SrcReg);</span></CodeLine>
<Link id="l02348" /><CodeLine lineNumber="2348"><span class="doxyHighlight">    CopyMI = &amp;&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;use&#95;instr&#95;nodbg&#95;begin(SrcReg);</span></CodeLine>
<Link id="l02349" /><CodeLine lineNumber="2349"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CopyRegIdx = LIS-&gt;getInstructionIndex(&#42;CopyMI).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</span></CodeLine>
<Link id="l02350" /><CodeLine lineNumber="2350"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> DestRegIdx = LIS-&gt;getInstructionIndex(DestMI).<a href="/docs/api/classes/llvm/slotindex/#ae3b98982e2036f3d26806de5ed5e02d0">getRegSlot</a>();</span></CodeLine>
<Link id="l02351" /><CodeLine lineNumber="2351"></CodeLine>
<Link id="l02352" /><CodeLine lineNumber="2352"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;isConstantPhysReg(DstReg)) &#123;</span></CodeLine>
<Link id="l02353" /><CodeLine lineNumber="2353"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We checked above that there are no interfering defs of the physical</span></CodeLine>
<Link id="l02354" /><CodeLine lineNumber="2354"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// register. However, for this case, where we intend to move up the def of</span></CodeLine>
<Link id="l02355" /><CodeLine lineNumber="2355"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// the physical register, we also need to check for interfering uses.</span></CodeLine>
<Link id="l02356" /><CodeLine lineNumber="2356"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindexes">SlotIndexes</a> &#42;Indexes = LIS-&gt;getSlotIndexes();</span></CodeLine>
<Link id="l02357" /><CodeLine lineNumber="2357"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> <a href="/docs/api/namespaces/llvm/si">SI</a> = Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#a7ac607fdc1b84333c84cc74903c352a4">getNextNonNullIndex</a>(DestRegIdx);</span></CodeLine>
<Link id="l02358" /><CodeLine lineNumber="2358"><span class="doxyHighlight">           <a href="/docs/api/namespaces/llvm/si">SI</a> != CopyRegIdx; <a href="/docs/api/namespaces/llvm/si">SI</a> = Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#a7ac607fdc1b84333c84cc74903c352a4">getNextNonNullIndex</a>(<a href="/docs/api/namespaces/llvm/si">SI</a>)) &#123;</span></CodeLine>
<Link id="l02359" /><CodeLine lineNumber="2359"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = LIS-&gt;getInstructionFromIndex(<a href="/docs/api/namespaces/llvm/si">SI</a>);</span></CodeLine>
<Link id="l02360" /><CodeLine lineNumber="2360"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;readsRegister(DstReg, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>)) &#123;</span></CodeLine>
<Link id="l02361" /><CodeLine lineNumber="2361"><span class="doxyHighlight">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tInterference (read): &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l02362" /><CodeLine lineNumber="2362"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02363" /><CodeLine lineNumber="2363"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02364" /><CodeLine lineNumber="2364"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02365" /><CodeLine lineNumber="2365"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02366" /><CodeLine lineNumber="2366"></CodeLine>
<Link id="l02367" /><CodeLine lineNumber="2367"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We&#39;re going to remove the copy which defines a physical reserved</span></CodeLine>
<Link id="l02368" /><CodeLine lineNumber="2368"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// register, so remove its valno, etc.</span></CodeLine>
<Link id="l02369" /><CodeLine lineNumber="2369"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tRemoving phys reg def of &quot;</span></CodeLine>
<Link id="l02370" /><CodeLine lineNumber="2370"><span class="doxyHighlight">                      &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(DstReg, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; at &quot;</span><span class="doxyHighlight"> &lt;&lt; CopyRegIdx &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02371" /><CodeLine lineNumber="2371"></CodeLine>
<Link id="l02372" /><CodeLine lineNumber="2372"><span class="doxyHighlight">    LIS-&gt;removePhysRegDefAt(DstReg.<a href="/docs/api/classes/llvm/register/#a49effcc0d9e7a321043ade70145d11f6">asMCReg</a>(), CopyRegIdx);</span></CodeLine>
<Link id="l02373" /><CodeLine lineNumber="2373"><span class="doxyHighlight">    deleteInstr(CopyMI);</span></CodeLine>
<Link id="l02374" /><CodeLine lineNumber="2374"></CodeLine>
<Link id="l02375" /><CodeLine lineNumber="2375"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Create a new dead def at the new def location.</span></CodeLine>
<Link id="l02376" /><CodeLine lineNumber="2376"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a8adc81fee7f9e66260dd2b626660c9c9">MCRegUnit</a> Unit : <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;regunits(DstReg)) &#123;</span></CodeLine>
<Link id="l02377" /><CodeLine lineNumber="2377"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;LR = LIS-&gt;getRegUnit(Unit);</span></CodeLine>
<Link id="l02378" /><CodeLine lineNumber="2378"><span class="doxyHighlight">      LR.<a href="/docs/api/classes/llvm/liverange/#a4258d794235c7a408b3f52e5e4ef7159">createDeadDef</a>(DestRegIdx, LIS-&gt;getVNInfoAllocator());</span></CodeLine>
<Link id="l02379" /><CodeLine lineNumber="2379"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02380" /><CodeLine lineNumber="2380"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02381" /><CodeLine lineNumber="2381"></CodeLine>
<Link id="l02382" /><CodeLine lineNumber="2382"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We don&#39;t track kills for reserved registers.</span></CodeLine>
<Link id="l02383" /><CodeLine lineNumber="2383"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;clearKillFlags(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l02384" /><CodeLine lineNumber="2384"></CodeLine>
<Link id="l02385" /><CodeLine lineNumber="2385"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02386" /><CodeLine lineNumber="2386"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02387" /><CodeLine lineNumber="2387"></CodeLine>
<Link id="l02388" /><CodeLine lineNumber="2388"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l02389" /><CodeLine lineNumber="2389"><span class="doxyHighlightComment">//                 Interference checking and interval joining</span></CodeLine>
<Link id="l02390" /><CodeLine lineNumber="2390"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l02391" /><CodeLine lineNumber="2391"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02392" /><CodeLine lineNumber="2392"><span class="doxyHighlightComment">// In the easiest case, the two live ranges being joined are disjoint, and</span></CodeLine>
<Link id="l02393" /><CodeLine lineNumber="2393"><span class="doxyHighlightComment">// there is no interference to consider. It is quite common, though, to have</span></CodeLine>
<Link id="l02394" /><CodeLine lineNumber="2394"><span class="doxyHighlightComment">// overlapping live ranges, and we need to check if the interference can be</span></CodeLine>
<Link id="l02395" /><CodeLine lineNumber="2395"><span class="doxyHighlightComment">// resolved.</span></CodeLine>
<Link id="l02396" /><CodeLine lineNumber="2396"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02397" /><CodeLine lineNumber="2397"><span class="doxyHighlightComment">// The live range of a single SSA value forms a sub-tree of the dominator tree.</span></CodeLine>
<Link id="l02398" /><CodeLine lineNumber="2398"><span class="doxyHighlightComment">// This means that two SSA values overlap if and only if the def of one value</span></CodeLine>
<Link id="l02399" /><CodeLine lineNumber="2399"><span class="doxyHighlightComment">// is contained in the live range of the other value. As a special case, the</span></CodeLine>
<Link id="l02400" /><CodeLine lineNumber="2400"><span class="doxyHighlightComment">// overlapping values can be defined at the same index.</span></CodeLine>
<Link id="l02401" /><CodeLine lineNumber="2401"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02402" /><CodeLine lineNumber="2402"><span class="doxyHighlightComment">// The interference from an overlapping def can be resolved in these cases:</span></CodeLine>
<Link id="l02403" /><CodeLine lineNumber="2403"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02404" /><CodeLine lineNumber="2404"><span class="doxyHighlightComment">// 1 Coalescable copies. The value is defined by a copy that would become an</span></CodeLine>
<Link id="l02405" /><CodeLine lineNumber="2405"><span class="doxyHighlightComment">//    identity copy after joining SrcReg and DstReg. The copy instruction will</span></CodeLine>
<Link id="l02406" /><CodeLine lineNumber="2406"><span class="doxyHighlightComment">//    be removed, and the value will be merged with the source value.</span></CodeLine>
<Link id="l02407" /><CodeLine lineNumber="2407"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02408" /><CodeLine lineNumber="2408"><span class="doxyHighlightComment">//    There can be several copies back and forth, causing many values to be</span></CodeLine>
<Link id="l02409" /><CodeLine lineNumber="2409"><span class="doxyHighlightComment">//    merged into one. We compute a list of ultimate values in the joined live</span></CodeLine>
<Link id="l02410" /><CodeLine lineNumber="2410"><span class="doxyHighlightComment">//    range as well as a mappings from the old value numbers.</span></CodeLine>
<Link id="l02411" /><CodeLine lineNumber="2411"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02412" /><CodeLine lineNumber="2412"><span class="doxyHighlightComment">// 2 IMPLICIT&#95;DEF. This instruction is only inserted to ensure all PHI</span></CodeLine>
<Link id="l02413" /><CodeLine lineNumber="2413"><span class="doxyHighlightComment">//    predecessors have a live out value. It doesn&#39;t cause real interference,</span></CodeLine>
<Link id="l02414" /><CodeLine lineNumber="2414"><span class="doxyHighlightComment">//    and can be merged into the value it overlaps. Like a coalescable copy, it</span></CodeLine>
<Link id="l02415" /><CodeLine lineNumber="2415"><span class="doxyHighlightComment">//    can be erased after joining.</span></CodeLine>
<Link id="l02416" /><CodeLine lineNumber="2416"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02417" /><CodeLine lineNumber="2417"><span class="doxyHighlightComment">// 3 Copy of external value. The overlapping def may be a copy of a value that</span></CodeLine>
<Link id="l02418" /><CodeLine lineNumber="2418"><span class="doxyHighlightComment">//    is already in the other register. This is like a coalescable copy, but</span></CodeLine>
<Link id="l02419" /><CodeLine lineNumber="2419"><span class="doxyHighlightComment">//    the live range of the source register must be trimmed after erasing the</span></CodeLine>
<Link id="l02420" /><CodeLine lineNumber="2420"><span class="doxyHighlightComment">//    copy instruction:</span></CodeLine>
<Link id="l02421" /><CodeLine lineNumber="2421"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02422" /><CodeLine lineNumber="2422"><span class="doxyHighlightComment">//      %src = COPY %ext</span></CodeLine>
<Link id="l02423" /><CodeLine lineNumber="2423"><span class="doxyHighlightComment">//      %dst = COPY %ext  &lt;-- Remove this COPY, trim the live range of %ext.</span></CodeLine>
<Link id="l02424" /><CodeLine lineNumber="2424"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02425" /><CodeLine lineNumber="2425"><span class="doxyHighlightComment">// 4 Clobbering undefined lanes. Vector registers are sometimes built by</span></CodeLine>
<Link id="l02426" /><CodeLine lineNumber="2426"><span class="doxyHighlightComment">//    defining one lane at a time:</span></CodeLine>
<Link id="l02427" /><CodeLine lineNumber="2427"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02428" /><CodeLine lineNumber="2428"><span class="doxyHighlightComment">//      %dst:ssub0&lt;def,read-undef&gt; = FOO</span></CodeLine>
<Link id="l02429" /><CodeLine lineNumber="2429"><span class="doxyHighlightComment">//      %src = BAR</span></CodeLine>
<Link id="l02430" /><CodeLine lineNumber="2430"><span class="doxyHighlightComment">//      %dst:ssub1 = COPY %src</span></CodeLine>
<Link id="l02431" /><CodeLine lineNumber="2431"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02432" /><CodeLine lineNumber="2432"><span class="doxyHighlightComment">//    The live range of %src overlaps the %dst value defined by FOO, but</span></CodeLine>
<Link id="l02433" /><CodeLine lineNumber="2433"><span class="doxyHighlightComment">//    merging %src into %dst:ssub1 is only going to clobber the ssub1 lane</span></CodeLine>
<Link id="l02434" /><CodeLine lineNumber="2434"><span class="doxyHighlightComment">//    which was undef anyway.</span></CodeLine>
<Link id="l02435" /><CodeLine lineNumber="2435"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02436" /><CodeLine lineNumber="2436"><span class="doxyHighlightComment">//    The value mapping is more complicated in this case. The final live range</span></CodeLine>
<Link id="l02437" /><CodeLine lineNumber="2437"><span class="doxyHighlightComment">//    will have different value numbers for both FOO and BAR, but there is no</span></CodeLine>
<Link id="l02438" /><CodeLine lineNumber="2438"><span class="doxyHighlightComment">//    simple mapping from old to new values. It may even be necessary to add</span></CodeLine>
<Link id="l02439" /><CodeLine lineNumber="2439"><span class="doxyHighlightComment">//    new PHI values.</span></CodeLine>
<Link id="l02440" /><CodeLine lineNumber="2440"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02441" /><CodeLine lineNumber="2441"><span class="doxyHighlightComment">// 5 Clobbering dead lanes. A def may clobber a lane of a vector register that</span></CodeLine>
<Link id="l02442" /><CodeLine lineNumber="2442"><span class="doxyHighlightComment">//    is live, but never read. This can happen because we don&#39;t compute</span></CodeLine>
<Link id="l02443" /><CodeLine lineNumber="2443"><span class="doxyHighlightComment">//    individual live ranges per lane.</span></CodeLine>
<Link id="l02444" /><CodeLine lineNumber="2444"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02445" /><CodeLine lineNumber="2445"><span class="doxyHighlightComment">//      %dst = FOO</span></CodeLine>
<Link id="l02446" /><CodeLine lineNumber="2446"><span class="doxyHighlightComment">//      %src = BAR</span></CodeLine>
<Link id="l02447" /><CodeLine lineNumber="2447"><span class="doxyHighlightComment">//      %dst:ssub1 = COPY %src</span></CodeLine>
<Link id="l02448" /><CodeLine lineNumber="2448"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02449" /><CodeLine lineNumber="2449"><span class="doxyHighlightComment">//    This kind of interference is only resolved locally. If the clobbered</span></CodeLine>
<Link id="l02450" /><CodeLine lineNumber="2450"><span class="doxyHighlightComment">//    lane value escapes the block, the join is aborted.</span></CodeLine>
<Link id="l02451" /><CodeLine lineNumber="2451"></CodeLine>
<Link id="l02452" /><CodeLine lineNumber="2452"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02453" /><CodeLine lineNumber="2453"></CodeLine>
<Link id="l02454" /><CodeLine lineNumber="2454"><span class="doxyHighlightComment">/// Track information about values in a single virtual register about to be</span></CodeLine>
<Link id="l02455" /><CodeLine lineNumber="2455"><span class="doxyHighlightComment">/// joined. Objects of this class are always created in pairs - one for each</span></CodeLine>
<Link id="l02456" /><CodeLine lineNumber="2456"><span class="doxyHighlightComment">/// side of the CoalescerPair (or one for each lane of a side of the coalescer</span></CodeLine>
<Link id="l02457" /><CodeLine lineNumber="2457"><span class="doxyHighlightComment">/// pair)</span></CodeLine>
<Link id="l02458" /><CodeLine lineNumber="2458" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a5bdb429abc9cabb96a3c3df03e53e2ea">JoinVals</a> &#123;</span></CodeLine>
<Link id="l02459" /><CodeLine lineNumber="2459"><span class="doxyHighlightComment">  /// Live range we work on.</span></CodeLine>
<Link id="l02460" /><CodeLine lineNumber="2460"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;LR;</span></CodeLine>
<Link id="l02461" /><CodeLine lineNumber="2461"></CodeLine>
<Link id="l02462" /><CodeLine lineNumber="2462"><span class="doxyHighlightComment">  /// (Main) register we work on.</span></CodeLine>
<Link id="l02463" /><CodeLine lineNumber="2463"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</span></CodeLine>
<Link id="l02464" /><CodeLine lineNumber="2464"></CodeLine>
<Link id="l02465" /><CodeLine lineNumber="2465"><span class="doxyHighlightComment">  /// Reg (and therefore the values in this liverange) will end up as</span></CodeLine>
<Link id="l02466" /><CodeLine lineNumber="2466"><span class="doxyHighlightComment">  /// subregister SubIdx in the coalesced register. Either CP.DstIdx or</span></CodeLine>
<Link id="l02467" /><CodeLine lineNumber="2467"><span class="doxyHighlightComment">  /// CP.SrcIdx.</span></CodeLine>
<Link id="l02468" /><CodeLine lineNumber="2468"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubIdx;</span></CodeLine>
<Link id="l02469" /><CodeLine lineNumber="2469"></CodeLine>
<Link id="l02470" /><CodeLine lineNumber="2470"><span class="doxyHighlightComment">  /// The LaneMask that this liverange will occupy the coalesced register. May</span></CodeLine>
<Link id="l02471" /><CodeLine lineNumber="2471"><span class="doxyHighlightComment">  /// be smaller than the lanemask produced by SubIdx when merging subranges.</span></CodeLine>
<Link id="l02472" /><CodeLine lineNumber="2472"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> LaneMask;</span></CodeLine>
<Link id="l02473" /><CodeLine lineNumber="2473"></CodeLine>
<Link id="l02474" /><CodeLine lineNumber="2474"><span class="doxyHighlightComment">  /// This is true when joining sub register ranges, false when joining main</span></CodeLine>
<Link id="l02475" /><CodeLine lineNumber="2475"><span class="doxyHighlightComment">  /// ranges.</span></CodeLine>
<Link id="l02476" /><CodeLine lineNumber="2476"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> SubRangeJoin;</span></CodeLine>
<Link id="l02477" /><CodeLine lineNumber="2477"></CodeLine>
<Link id="l02478" /><CodeLine lineNumber="2478"><span class="doxyHighlightComment">  /// Whether the current LiveInterval tracks subregister liveness.</span></CodeLine>
<Link id="l02479" /><CodeLine lineNumber="2479"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> TrackSubRegLiveness;</span></CodeLine>
<Link id="l02480" /><CodeLine lineNumber="2480"></CodeLine>
<Link id="l02481" /><CodeLine lineNumber="2481"><span class="doxyHighlightComment">  /// Values that will be present in the final live range.</span></CodeLine>
<Link id="l02482" /><CodeLine lineNumber="2482"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;VNInfo &#42;&gt;</a> &amp;NewVNInfo;</span></CodeLine>
<Link id="l02483" /><CodeLine lineNumber="2483"></CodeLine>
<Link id="l02484" /><CodeLine lineNumber="2484"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP;</span></CodeLine>
<Link id="l02485" /><CodeLine lineNumber="2485"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveintervals">LiveIntervals</a> &#42;LIS;</span></CodeLine>
<Link id="l02486" /><CodeLine lineNumber="2486"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindexes">SlotIndexes</a> &#42;Indexes;</span></CodeLine>
<Link id="l02487" /><CodeLine lineNumber="2487"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &#42;TRI;</span></CodeLine>
<Link id="l02488" /><CodeLine lineNumber="2488"></CodeLine>
<Link id="l02489" /><CodeLine lineNumber="2489"><span class="doxyHighlightComment">  /// Value number assignments. Maps value numbers in LI to entries in</span></CodeLine>
<Link id="l02490" /><CodeLine lineNumber="2490"><span class="doxyHighlightComment">  /// NewVNInfo. This is suitable for passing to LiveInterval::join().</span></CodeLine>
<Link id="l02491" /><CodeLine lineNumber="2491"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;int, 8&gt;</a> Assignments;</span></CodeLine>
<Link id="l02492" /><CodeLine lineNumber="2492"></CodeLine>
<Link id="l02493" /><CodeLine lineNumber="2493"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l02494" /><CodeLine lineNumber="2494"><span class="doxyHighlightComment">  /// Conflict resolution for overlapping values.</span></CodeLine>
<Link id="l02495" /><CodeLine lineNumber="2495" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">enum</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909c">ConflictResolution</a> &#123;</span></CodeLine>
<Link id="l02496" /><CodeLine lineNumber="2496"><span class="doxyHighlightComment">    /// No overlap, simply keep this value.</span></CodeLine>
<Link id="l02497" /><CodeLine lineNumber="2497" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73">CR&#95;Keep</a>,</span></CodeLine>
<Link id="l02498" /><CodeLine lineNumber="2498"></CodeLine>
<Link id="l02499" /><CodeLine lineNumber="2499"><span class="doxyHighlightComment">    /// Merge this value into OtherVNI and erase the defining instruction.</span></CodeLine>
<Link id="l02500" /><CodeLine lineNumber="2500"><span class="doxyHighlightComment">    /// Used for IMPLICIT&#95;DEF, coalescable copies, and copies from external</span></CodeLine>
<Link id="l02501" /><CodeLine lineNumber="2501"><span class="doxyHighlightComment">    /// values.</span></CodeLine>
<Link id="l02502" /><CodeLine lineNumber="2502" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d">CR&#95;Erase</a>,</span></CodeLine>
<Link id="l02503" /><CodeLine lineNumber="2503"></CodeLine>
<Link id="l02504" /><CodeLine lineNumber="2504"><span class="doxyHighlightComment">    /// Merge this value into OtherVNI but keep the defining instruction.</span></CodeLine>
<Link id="l02505" /><CodeLine lineNumber="2505"><span class="doxyHighlightComment">    /// This is for the special case where OtherVNI is defined by the same</span></CodeLine>
<Link id="l02506" /><CodeLine lineNumber="2506"><span class="doxyHighlightComment">    /// instruction.</span></CodeLine>
<Link id="l02507" /><CodeLine lineNumber="2507" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca58561957307c3721aad71b897e448647"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca58561957307c3721aad71b897e448647">CR&#95;Merge</a>,</span></CodeLine>
<Link id="l02508" /><CodeLine lineNumber="2508"></CodeLine>
<Link id="l02509" /><CodeLine lineNumber="2509"><span class="doxyHighlightComment">    /// Keep this value, and have it replace OtherVNI where possible. This</span></CodeLine>
<Link id="l02510" /><CodeLine lineNumber="2510"><span class="doxyHighlightComment">    /// complicates value mapping since OtherVNI maps to two different values</span></CodeLine>
<Link id="l02511" /><CodeLine lineNumber="2511"><span class="doxyHighlightComment">    /// before and after this def.</span></CodeLine>
<Link id="l02512" /><CodeLine lineNumber="2512"><span class="doxyHighlightComment">    /// Used when clobbering undefined or dead lanes.</span></CodeLine>
<Link id="l02513" /><CodeLine lineNumber="2513" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca191f458a9d415a178a901a75baa4bd0e"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca191f458a9d415a178a901a75baa4bd0e">CR&#95;Replace</a>,</span></CodeLine>
<Link id="l02514" /><CodeLine lineNumber="2514"></CodeLine>
<Link id="l02515" /><CodeLine lineNumber="2515"><span class="doxyHighlightComment">    /// Unresolved conflict. Visit later when all values have been mapped.</span></CodeLine>
<Link id="l02516" /><CodeLine lineNumber="2516" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cabd7e0ab4ddda4ab7abfdc4077f6d8a50"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cabd7e0ab4ddda4ab7abfdc4077f6d8a50">CR&#95;Unresolved</a>,</span></CodeLine>
<Link id="l02517" /><CodeLine lineNumber="2517"></CodeLine>
<Link id="l02518" /><CodeLine lineNumber="2518"><span class="doxyHighlightComment">    /// Unresolvable conflict. Abort the join.</span></CodeLine>
<Link id="l02519" /><CodeLine lineNumber="2519" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cadf133404fe2559cd68f16253fac30869"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cadf133404fe2559cd68f16253fac30869">CR&#95;Impossible</a></span></CodeLine>
<Link id="l02520" /><CodeLine lineNumber="2520"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l02521" /><CodeLine lineNumber="2521"></CodeLine>
<Link id="l02522" /><CodeLine lineNumber="2522"><span class="doxyHighlightKeyword">private</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l02523" /><CodeLine lineNumber="2523"><span class="doxyHighlightComment">  /// Per-value info for LI. The lane bit masks are all relative to the final</span></CodeLine>
<Link id="l02524" /><CodeLine lineNumber="2524"><span class="doxyHighlightComment">  /// joined register, so they can be compared directly between SrcReg and</span></CodeLine>
<Link id="l02525" /><CodeLine lineNumber="2525"><span class="doxyHighlightComment">  /// DstReg.</span></CodeLine>
<Link id="l02526" /><CodeLine lineNumber="2526"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight">Val &#123;</span></CodeLine>
<Link id="l02527" /><CodeLine lineNumber="2527"><span class="doxyHighlight">    ConflictResolution Resolution = CR&#95;Keep;</span></CodeLine>
<Link id="l02528" /><CodeLine lineNumber="2528"></CodeLine>
<Link id="l02529" /><CodeLine lineNumber="2529"><span class="doxyHighlightComment">    /// Lanes written by this def, 0 for unanalyzed values.</span></CodeLine>
<Link id="l02530" /><CodeLine lineNumber="2530"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> WriteLanes;</span></CodeLine>
<Link id="l02531" /><CodeLine lineNumber="2531"></CodeLine>
<Link id="l02532" /><CodeLine lineNumber="2532"><span class="doxyHighlightComment">    /// Lanes with defined values in this register. Other lanes are undef and</span></CodeLine>
<Link id="l02533" /><CodeLine lineNumber="2533"><span class="doxyHighlightComment">    /// safe to clobber.</span></CodeLine>
<Link id="l02534" /><CodeLine lineNumber="2534"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> ValidLanes;</span></CodeLine>
<Link id="l02535" /><CodeLine lineNumber="2535"></CodeLine>
<Link id="l02536" /><CodeLine lineNumber="2536"><span class="doxyHighlightComment">    /// Value in LI being redefined by this def.</span></CodeLine>
<Link id="l02537" /><CodeLine lineNumber="2537"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;RedefVNI = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02538" /><CodeLine lineNumber="2538"></CodeLine>
<Link id="l02539" /><CodeLine lineNumber="2539"><span class="doxyHighlightComment">    /// Value in the other live range that overlaps this def, if any.</span></CodeLine>
<Link id="l02540" /><CodeLine lineNumber="2540"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;OtherVNI = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02541" /><CodeLine lineNumber="2541"></CodeLine>
<Link id="l02542" /><CodeLine lineNumber="2542"><span class="doxyHighlightComment">    /// Is this value an IMPLICIT&#95;DEF that can be erased?</span></CodeLine>
<Link id="l02543" /><CodeLine lineNumber="2543"><span class="doxyHighlightComment">    ///</span></CodeLine>
<Link id="l02544" /><CodeLine lineNumber="2544"><span class="doxyHighlightComment">    /// IMPLICIT&#95;DEF values should only exist at the end of a basic block that</span></CodeLine>
<Link id="l02545" /><CodeLine lineNumber="2545"><span class="doxyHighlightComment">    /// is a predecessor to a phi-value. These IMPLICIT&#95;DEF instructions can be</span></CodeLine>
<Link id="l02546" /><CodeLine lineNumber="2546"><span class="doxyHighlightComment">    /// safely erased if they are overlapping a live value in the other live</span></CodeLine>
<Link id="l02547" /><CodeLine lineNumber="2547"><span class="doxyHighlightComment">    /// interval.</span></CodeLine>
<Link id="l02548" /><CodeLine lineNumber="2548"><span class="doxyHighlightComment">    ///</span></CodeLine>
<Link id="l02549" /><CodeLine lineNumber="2549"><span class="doxyHighlightComment">    /// Weird control flow graphs and incomplete PHI handling in</span></CodeLine>
<Link id="l02550" /><CodeLine lineNumber="2550"><span class="doxyHighlightComment">    /// ProcessImplicitDefs can very rarely create IMPLICIT&#95;DEF values with</span></CodeLine>
<Link id="l02551" /><CodeLine lineNumber="2551"><span class="doxyHighlightComment">    /// longer live ranges. Such IMPLICIT&#95;DEF values should be treated like</span></CodeLine>
<Link id="l02552" /><CodeLine lineNumber="2552"><span class="doxyHighlightComment">    /// normal values.</span></CodeLine>
<Link id="l02553" /><CodeLine lineNumber="2553"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ErasableImplicitDef = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02554" /><CodeLine lineNumber="2554"></CodeLine>
<Link id="l02555" /><CodeLine lineNumber="2555"><span class="doxyHighlightComment">    /// True when the live range of this value will be pruned because of an</span></CodeLine>
<Link id="l02556" /><CodeLine lineNumber="2556"><span class="doxyHighlightComment">    /// overlapping CR&#95;Replace value in the other live range.</span></CodeLine>
<Link id="l02557" /><CodeLine lineNumber="2557"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Pruned = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02558" /><CodeLine lineNumber="2558"></CodeLine>
<Link id="l02559" /><CodeLine lineNumber="2559"><span class="doxyHighlightComment">    /// True once Pruned above has been computed.</span></CodeLine>
<Link id="l02560" /><CodeLine lineNumber="2560"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> PrunedComputed = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02561" /><CodeLine lineNumber="2561"></CodeLine>
<Link id="l02562" /><CodeLine lineNumber="2562"><span class="doxyHighlightComment">    /// True if this value is determined to be identical to OtherVNI</span></CodeLine>
<Link id="l02563" /><CodeLine lineNumber="2563"><span class="doxyHighlightComment">    /// (in valuesIdentical). This is used with CR&#95;Erase where the erased</span></CodeLine>
<Link id="l02564" /><CodeLine lineNumber="2564"><span class="doxyHighlightComment">    /// copy is redundant, i.e. the source value is already the same as</span></CodeLine>
<Link id="l02565" /><CodeLine lineNumber="2565"><span class="doxyHighlightComment">    /// the destination. In such cases the subranges need to be updated</span></CodeLine>
<Link id="l02566" /><CodeLine lineNumber="2566"><span class="doxyHighlightComment">    /// properly. See comment at pruneSubRegValues for more info.</span></CodeLine>
<Link id="l02567" /><CodeLine lineNumber="2567"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Identical = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02568" /><CodeLine lineNumber="2568"></CodeLine>
<Link id="l02569" /><CodeLine lineNumber="2569"><span class="doxyHighlight">    Val() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02570" /><CodeLine lineNumber="2570"></CodeLine>
<Link id="l02571" /><CodeLine lineNumber="2571"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> isAnalyzed()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> WriteLanes.<a href="/docs/api/structs/llvm/lanebitmask/#a72988cca7ab2262ef68fdd0c5ae54940">any</a>(); &#125;</span></CodeLine>
<Link id="l02572" /><CodeLine lineNumber="2572"></CodeLine>
<Link id="l02573" /><CodeLine lineNumber="2573"><span class="doxyHighlightComment">    /// Mark this value as an IMPLICIT&#95;DEF which must be kept as if it were an</span></CodeLine>
<Link id="l02574" /><CodeLine lineNumber="2574"><span class="doxyHighlightComment">    /// ordinary value.</span></CodeLine>
<Link id="l02575" /><CodeLine lineNumber="2575"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> mustKeepImplicitDef(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &amp;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>,</span></CodeLine>
<Link id="l02576" /><CodeLine lineNumber="2576"><span class="doxyHighlight">                             </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;ImpDef) &#123;</span></CodeLine>
<Link id="l02577" /><CodeLine lineNumber="2577"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ImpDef.<a href="/docs/api/classes/llvm/machineinstr/#a120ccebe70e1b0ddf72fc776229d0025">isImplicitDef</a>());</span></CodeLine>
<Link id="l02578" /><CodeLine lineNumber="2578"><span class="doxyHighlight">      ErasableImplicitDef = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02579" /><CodeLine lineNumber="2579"><span class="doxyHighlight">      ValidLanes = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>.getSubRegIndexLaneMask(ImpDef.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(0).<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>());</span></CodeLine>
<Link id="l02580" /><CodeLine lineNumber="2580"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02581" /><CodeLine lineNumber="2581"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l02582" /><CodeLine lineNumber="2582"></CodeLine>
<Link id="l02583" /><CodeLine lineNumber="2583"><span class="doxyHighlightComment">  /// One entry per value number in LI.</span></CodeLine>
<Link id="l02584" /><CodeLine lineNumber="2584"><span class="doxyHighlight">  SmallVector&lt;Val, 8&gt; Vals;</span></CodeLine>
<Link id="l02585" /><CodeLine lineNumber="2585"></CodeLine>
<Link id="l02586" /><CodeLine lineNumber="2586"><span class="doxyHighlightComment">  /// Compute the bitmask of lanes actually written by DefMI.</span></CodeLine>
<Link id="l02587" /><CodeLine lineNumber="2587"><span class="doxyHighlightComment">  /// Set Redef if there are any partial register definitions that depend on the</span></CodeLine>
<Link id="l02588" /><CodeLine lineNumber="2588"><span class="doxyHighlightComment">  /// previous value of the register.</span></CodeLine>
<Link id="l02589" /><CodeLine lineNumber="2589"><span class="doxyHighlight">  LaneBitmask computeWriteLanes(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineInstr &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &amp;Redef) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02590" /><CodeLine lineNumber="2590"></CodeLine>
<Link id="l02591" /><CodeLine lineNumber="2591"><span class="doxyHighlightComment">  /// Find the ultimate value that VNI was copied from.</span></CodeLine>
<Link id="l02592" /><CodeLine lineNumber="2592"><span class="doxyHighlight">  std::pair&lt;const VNInfo &#42;, Register&gt; followCopyChain(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> VNInfo &#42;VNI) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02593" /><CodeLine lineNumber="2593"></CodeLine>
<Link id="l02594" /><CodeLine lineNumber="2594"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> valuesIdentical(VNInfo &#42;Value0, VNInfo &#42;Value1,</span></CodeLine>
<Link id="l02595" /><CodeLine lineNumber="2595"><span class="doxyHighlight">                       </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> JoinVals &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02596" /><CodeLine lineNumber="2596"></CodeLine>
<Link id="l02597" /><CodeLine lineNumber="2597"><span class="doxyHighlightComment">  /// Analyze ValNo in this live range, and set all fields of Vals&#91;ValNo&#93;.</span></CodeLine>
<Link id="l02598" /><CodeLine lineNumber="2598"><span class="doxyHighlightComment">  /// Return a conflict resolution when possible, but leave the hard cases as</span></CodeLine>
<Link id="l02599" /><CodeLine lineNumber="2599"><span class="doxyHighlightComment">  /// CR&#95;Unresolved.</span></CodeLine>
<Link id="l02600" /><CodeLine lineNumber="2600"><span class="doxyHighlightComment">  /// Recursively calls computeAssignment() on this and Other, guaranteeing that</span></CodeLine>
<Link id="l02601" /><CodeLine lineNumber="2601"><span class="doxyHighlightComment">  /// both OtherVNI and RedefVNI have been analyzed and mapped before returning.</span></CodeLine>
<Link id="l02602" /><CodeLine lineNumber="2602"><span class="doxyHighlightComment">  /// The recursion always goes upwards in the dominator tree, making loops</span></CodeLine>
<Link id="l02603" /><CodeLine lineNumber="2603"><span class="doxyHighlightComment">  /// impossible.</span></CodeLine>
<Link id="l02604" /><CodeLine lineNumber="2604"><span class="doxyHighlight">  ConflictResolution analyzeValue(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValNo, JoinVals &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>);</span></CodeLine>
<Link id="l02605" /><CodeLine lineNumber="2605"></CodeLine>
<Link id="l02606" /><CodeLine lineNumber="2606"><span class="doxyHighlightComment">  /// Compute the value assignment for ValNo in RI.</span></CodeLine>
<Link id="l02607" /><CodeLine lineNumber="2607"><span class="doxyHighlightComment">  /// This may be called recursively by analyzeValue(), but never for a ValNo on</span></CodeLine>
<Link id="l02608" /><CodeLine lineNumber="2608"><span class="doxyHighlightComment">  /// the stack.</span></CodeLine>
<Link id="l02609" /><CodeLine lineNumber="2609"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> computeAssignment(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValNo, JoinVals &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>);</span></CodeLine>
<Link id="l02610" /><CodeLine lineNumber="2610"></CodeLine>
<Link id="l02611" /><CodeLine lineNumber="2611"><span class="doxyHighlightComment">  /// Assuming ValNo is going to clobber some valid lanes in Other.LR, compute</span></CodeLine>
<Link id="l02612" /><CodeLine lineNumber="2612"><span class="doxyHighlightComment">  /// the extent of the tainted lanes in the block.</span></CodeLine>
<Link id="l02613" /><CodeLine lineNumber="2613"><span class="doxyHighlightComment">  ///</span></CodeLine>
<Link id="l02614" /><CodeLine lineNumber="2614"><span class="doxyHighlightComment">  /// Multiple values in Other.LR can be affected since partial redefinitions</span></CodeLine>
<Link id="l02615" /><CodeLine lineNumber="2615"><span class="doxyHighlightComment">  /// can preserve previously tainted lanes.</span></CodeLine>
<Link id="l02616" /><CodeLine lineNumber="2616"><span class="doxyHighlightComment">  ///</span></CodeLine>
<Link id="l02617" /><CodeLine lineNumber="2617"><span class="doxyHighlightComment">  ///   1 %dst = VLOAD           &lt;-- Define all lanes in %dst</span></CodeLine>
<Link id="l02618" /><CodeLine lineNumber="2618"><span class="doxyHighlightComment">  ///   2 %src = FOO             &lt;-- ValNo to be joined with %dst:ssub0</span></CodeLine>
<Link id="l02619" /><CodeLine lineNumber="2619"><span class="doxyHighlightComment">  ///   3 %dst:ssub1 = BAR       &lt;-- Partial redef doesn&#39;t clear taint in ssub0</span></CodeLine>
<Link id="l02620" /><CodeLine lineNumber="2620"><span class="doxyHighlightComment">  ///   4 %dst:ssub0 = COPY %src &lt;-- Conflict resolved, ssub0 wasn&#39;t read</span></CodeLine>
<Link id="l02621" /><CodeLine lineNumber="2621"><span class="doxyHighlightComment">  ///</span></CodeLine>
<Link id="l02622" /><CodeLine lineNumber="2622"><span class="doxyHighlightComment">  /// For each ValNo in Other that is affected, add an (EndIndex, TaintedLanes)</span></CodeLine>
<Link id="l02623" /><CodeLine lineNumber="2623"><span class="doxyHighlightComment">  /// entry to TaintedVals.</span></CodeLine>
<Link id="l02624" /><CodeLine lineNumber="2624"><span class="doxyHighlightComment">  ///</span></CodeLine>
<Link id="l02625" /><CodeLine lineNumber="2625"><span class="doxyHighlightComment">  /// Returns false if the tainted lanes extend beyond the basic block.</span></CodeLine>
<Link id="l02626" /><CodeLine lineNumber="2626"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span></CodeLine>
<Link id="l02627" /><CodeLine lineNumber="2627"><span class="doxyHighlight">  taintExtent(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValNo, LaneBitmask TaintedLanes, JoinVals &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>,</span></CodeLine>
<Link id="l02628" /><CodeLine lineNumber="2628"><span class="doxyHighlight">              SmallVectorImpl&lt;std::pair&lt;SlotIndex, LaneBitmask&gt;&gt; &amp;TaintExtent);</span></CodeLine>
<Link id="l02629" /><CodeLine lineNumber="2629"></CodeLine>
<Link id="l02630" /><CodeLine lineNumber="2630"><span class="doxyHighlightComment">  /// Return true if MI uses any of the given Lanes from Reg.</span></CodeLine>
<Link id="l02631" /><CodeLine lineNumber="2631"><span class="doxyHighlightComment">  /// This does not include partial redefinitions of Reg.</span></CodeLine>
<Link id="l02632" /><CodeLine lineNumber="2632"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> usesLanes(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineInstr &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a>, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight">, LaneBitmask) </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02633" /><CodeLine lineNumber="2633"></CodeLine>
<Link id="l02634" /><CodeLine lineNumber="2634"><span class="doxyHighlightComment">  /// Determine if ValNo is a copy of a value number in LR or Other.LR that will</span></CodeLine>
<Link id="l02635" /><CodeLine lineNumber="2635"><span class="doxyHighlightComment">  /// be pruned:</span></CodeLine>
<Link id="l02636" /><CodeLine lineNumber="2636"><span class="doxyHighlightComment">  ///</span></CodeLine>
<Link id="l02637" /><CodeLine lineNumber="2637"><span class="doxyHighlightComment">  ///   %dst = COPY %src</span></CodeLine>
<Link id="l02638" /><CodeLine lineNumber="2638"><span class="doxyHighlightComment">  ///   %src = COPY %dst  &lt;-- This value to be pruned.</span></CodeLine>
<Link id="l02639" /><CodeLine lineNumber="2639"><span class="doxyHighlightComment">  ///   %dst = COPY %src  &lt;-- This value is a copy of a pruned value.</span></CodeLine>
<Link id="l02640" /><CodeLine lineNumber="2640"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> isPrunedValue(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValNo, JoinVals &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>);</span></CodeLine>
<Link id="l02641" /><CodeLine lineNumber="2641"></CodeLine>
<Link id="l02642" /><CodeLine lineNumber="2642"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l02643" /><CodeLine lineNumber="2643" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a5bdb429abc9cabb96a3c3df03e53e2ea"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a5bdb429abc9cabb96a3c3df03e53e2ea">JoinVals</a>(<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;LR, <a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubIdx, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> LaneMask,</span></CodeLine>
<Link id="l02644" /><CodeLine lineNumber="2644"><span class="doxyHighlight">           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;VNInfo &#42;&gt;</a> &amp;newVNInfo, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;cp,</span></CodeLine>
<Link id="l02645" /><CodeLine lineNumber="2645"><span class="doxyHighlight">           <a href="/docs/api/classes/llvm/liveintervals">LiveIntervals</a> &#42;lis, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &#42;TRI, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> SubRangeJoin,</span></CodeLine>
<Link id="l02646" /><CodeLine lineNumber="2646"><span class="doxyHighlight">           </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> TrackSubRegLiveness)</span></CodeLine>
<Link id="l02647" /><CodeLine lineNumber="2647"><span class="doxyHighlight">      : LR(LR), <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>), SubIdx(SubIdx), LaneMask(LaneMask),</span></CodeLine>
<Link id="l02648" /><CodeLine lineNumber="2648"><span class="doxyHighlight">        SubRangeJoin(SubRangeJoin), TrackSubRegLiveness(TrackSubRegLiveness),</span></CodeLine>
<Link id="l02649" /><CodeLine lineNumber="2649"><span class="doxyHighlight">        NewVNInfo(newVNInfo), CP(cp), LIS(lis), Indexes(LIS-&gt;getSlotIndexes()),</span></CodeLine>
<Link id="l02650" /><CodeLine lineNumber="2650"><span class="doxyHighlight">        TRI(TRI), Assignments(LR.getNumValNums(), -1),</span></CodeLine>
<Link id="l02651" /><CodeLine lineNumber="2651"><span class="doxyHighlight">        Vals(LR.getNumValNums()) &#123;&#125;</span></CodeLine>
<Link id="l02652" /><CodeLine lineNumber="2652"></CodeLine>
<Link id="l02653" /><CodeLine lineNumber="2653"><span class="doxyHighlightComment">  /// Analyze defs in LR and compute a value mapping in NewVNInfo.</span></CodeLine>
<Link id="l02654" /><CodeLine lineNumber="2654"><span class="doxyHighlightComment">  /// Returns false if any conflicts were impossible to resolve.</span></CodeLine>
<Link id="l02655" /><CodeLine lineNumber="2655"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> mapValues(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>);</span></CodeLine>
<Link id="l02656" /><CodeLine lineNumber="2656"></CodeLine>
<Link id="l02657" /><CodeLine lineNumber="2657"><span class="doxyHighlightComment">  /// Try to resolve conflicts that require all values to be mapped.</span></CodeLine>
<Link id="l02658" /><CodeLine lineNumber="2658"><span class="doxyHighlightComment">  /// Returns false if any conflicts were impossible to resolve.</span></CodeLine>
<Link id="l02659" /><CodeLine lineNumber="2659"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> resolveConflicts(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>);</span></CodeLine>
<Link id="l02660" /><CodeLine lineNumber="2660"></CodeLine>
<Link id="l02661" /><CodeLine lineNumber="2661"><span class="doxyHighlightComment">  /// Prune the live range of values in Other.LR where they would conflict with</span></CodeLine>
<Link id="l02662" /><CodeLine lineNumber="2662"><span class="doxyHighlightComment">  /// CR&#95;Replace values in LR. Collect end points for restoring the live range</span></CodeLine>
<Link id="l02663" /><CodeLine lineNumber="2663"><span class="doxyHighlightComment">  /// after joining.</span></CodeLine>
<Link id="l02664" /><CodeLine lineNumber="2664"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> pruneValues(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;SlotIndex&gt;</a> &amp;EndPoints,</span></CodeLine>
<Link id="l02665" /><CodeLine lineNumber="2665"><span class="doxyHighlight">                   </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> changeInstrs);</span></CodeLine>
<Link id="l02666" /><CodeLine lineNumber="2666"></CodeLine>
<Link id="l02667" /><CodeLine lineNumber="2667"><span class="doxyHighlightComment">  /// Removes subranges starting at copies that get removed. This sometimes</span></CodeLine>
<Link id="l02668" /><CodeLine lineNumber="2668"><span class="doxyHighlightComment">  /// happens when undefined subranges are copied around. These ranges contain</span></CodeLine>
<Link id="l02669" /><CodeLine lineNumber="2669"><span class="doxyHighlightComment">  /// no useful information and can be removed.</span></CodeLine>
<Link id="l02670" /><CodeLine lineNumber="2670"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> pruneSubRegValues(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> &amp;ShrinkMask);</span></CodeLine>
<Link id="l02671" /><CodeLine lineNumber="2671"></CodeLine>
<Link id="l02672" /><CodeLine lineNumber="2672"><span class="doxyHighlightComment">  /// Pruning values in subranges can lead to removing segments in these</span></CodeLine>
<Link id="l02673" /><CodeLine lineNumber="2673"><span class="doxyHighlightComment">  /// subranges started by IMPLICIT&#95;DEFs. The corresponding segments in</span></CodeLine>
<Link id="l02674" /><CodeLine lineNumber="2674"><span class="doxyHighlightComment">  /// the main range also need to be removed. This function will mark</span></CodeLine>
<Link id="l02675" /><CodeLine lineNumber="2675"><span class="doxyHighlightComment">  /// the corresponding values in the main range as pruned, so that</span></CodeLine>
<Link id="l02676" /><CodeLine lineNumber="2676"><span class="doxyHighlightComment">  /// eraseInstrs can do the final cleanup.</span></CodeLine>
<Link id="l02677" /><CodeLine lineNumber="2677"><span class="doxyHighlightComment">  /// The parameter @p LI must be the interval whose main range is the</span></CodeLine>
<Link id="l02678" /><CodeLine lineNumber="2678"><span class="doxyHighlightComment">  /// live range LR.</span></CodeLine>
<Link id="l02679" /><CodeLine lineNumber="2679"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> pruneMainSegments(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &amp;ShrinkMainRange);</span></CodeLine>
<Link id="l02680" /><CodeLine lineNumber="2680"></CodeLine>
<Link id="l02681" /><CodeLine lineNumber="2681"><span class="doxyHighlightComment">  /// Erase any machine instructions that have been coalesced away.</span></CodeLine>
<Link id="l02682" /><CodeLine lineNumber="2682"><span class="doxyHighlightComment">  /// Add erased instructions to ErasedInstrs.</span></CodeLine>
<Link id="l02683" /><CodeLine lineNumber="2683"><span class="doxyHighlightComment">  /// Add foreign virtual registers to ShrinkRegs if their live range ended at</span></CodeLine>
<Link id="l02684" /><CodeLine lineNumber="2684"><span class="doxyHighlightComment">  /// the erased instrs.</span></CodeLine>
<Link id="l02685" /><CodeLine lineNumber="2685"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ad7baaaed8300fdfe9404b907ab20e3f8">eraseInstrs</a>(<a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineInstr &#42;&gt;</a> &amp;ErasedInstrs,</span></CodeLine>
<Link id="l02686" /><CodeLine lineNumber="2686"><span class="doxyHighlight">                   <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Register&gt;</a> &amp;ShrinkRegs,</span></CodeLine>
<Link id="l02687" /><CodeLine lineNumber="2687"><span class="doxyHighlight">                   <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &#42;LI = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02688" /><CodeLine lineNumber="2688"></CodeLine>
<Link id="l02689" /><CodeLine lineNumber="2689"><span class="doxyHighlightComment">  /// Remove liverange defs at places where implicit defs will be removed.</span></CodeLine>
<Link id="l02690" /><CodeLine lineNumber="2690"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> removeImplicitDefs();</span></CodeLine>
<Link id="l02691" /><CodeLine lineNumber="2691"></CodeLine>
<Link id="l02692" /><CodeLine lineNumber="2692"><span class="doxyHighlightComment">  /// Get the value assignments suitable for passing to LiveInterval::join.</span></CodeLine>
<Link id="l02693" /><CodeLine lineNumber="2693" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a6e401cb75317feb575c5ab9f844c1da2"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> &#42;<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a6e401cb75317feb575c5ab9f844c1da2">getAssignments</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Assignments.data(); &#125;</span></CodeLine>
<Link id="l02694" /><CodeLine lineNumber="2694"></CodeLine>
<Link id="l02695" /><CodeLine lineNumber="2695"><span class="doxyHighlightComment">  /// Get the conflict resolution for a value number.</span></CodeLine>
<Link id="l02696" /><CodeLine lineNumber="2696" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a2073d38573fd65fc21a3b6a205a025d4"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909c">ConflictResolution</a> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a2073d38573fd65fc21a3b6a205a025d4">getResolution</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Num)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02697" /><CodeLine lineNumber="2697"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Vals&#91;Num&#93;.Resolution;</span></CodeLine>
<Link id="l02698" /><CodeLine lineNumber="2698"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02699" /><CodeLine lineNumber="2699"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l02700" /><CodeLine lineNumber="2700"></CodeLine>
<Link id="l02701" /><CodeLine lineNumber="2701"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l02702" /><CodeLine lineNumber="2702"></CodeLine>
<Link id="l02703" /><CodeLine lineNumber="2703"><span class="doxyHighlight"><a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> JoinVals::computeWriteLanes(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>,</span></CodeLine>
<Link id="l02704" /><CodeLine lineNumber="2704"><span class="doxyHighlight">                                        </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &amp;Redef)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02705" /><CodeLine lineNumber="2705"><span class="doxyHighlight">  <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>;</span></CodeLine>
<Link id="l02706" /><CodeLine lineNumber="2706"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#ade4229c653b0cbcaca057e8af5002783">all&#95;defs</a>()) &#123;</span></CodeLine>
<Link id="l02707" /><CodeLine lineNumber="2707"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() != <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)</span></CodeLine>
<Link id="l02708" /><CodeLine lineNumber="2708"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02709" /><CodeLine lineNumber="2709"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> |= <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(</span></CodeLine>
<Link id="l02710" /><CodeLine lineNumber="2710"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndices(SubIdx, MO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>()));</span></CodeLine>
<Link id="l02711" /><CodeLine lineNumber="2711"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a3be9857a09c82046b77a71918b5e214f">readsReg</a>())</span></CodeLine>
<Link id="l02712" /><CodeLine lineNumber="2712"><span class="doxyHighlight">      Redef = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02713" /><CodeLine lineNumber="2713"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02714" /><CodeLine lineNumber="2714"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>;</span></CodeLine>
<Link id="l02715" /><CodeLine lineNumber="2715"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02716" /><CodeLine lineNumber="2716"></CodeLine>
<Link id="l02717" /><CodeLine lineNumber="2717"><span class="doxyHighlight">std::pair&lt;const VNInfo &#42;, Register&gt;</span></CodeLine>
<Link id="l02718" /><CodeLine lineNumber="2718"><span class="doxyHighlight">JoinVals::followCopyChain(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02719" /><CodeLine lineNumber="2719"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> TrackReg = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</span></CodeLine>
<Link id="l02720" /><CodeLine lineNumber="2720"></CodeLine>
<Link id="l02721" /><CodeLine lineNumber="2721"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>()) &#123;</span></CodeLine>
<Link id="l02722" /><CodeLine lineNumber="2722"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> <a href="/docs/api/namespaces/llvm/rdf/#a10793004faece2bb74d3363b5f6ce96f">Def</a> = VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>;</span></CodeLine>
<Link id="l02723" /><CodeLine lineNumber="2723"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#af454bfc85311cf45162476f6b4e5dee8">getInstructionFromIndex</a>(Def);</span></CodeLine>
<Link id="l02724" /><CodeLine lineNumber="2724"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;No defining instruction&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02725" /><CodeLine lineNumber="2725"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isFullCopy())</span></CodeLine>
<Link id="l02726" /><CodeLine lineNumber="2726"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::make&#95;pair(VNI, TrackReg);</span></CodeLine>
<Link id="l02727" /><CodeLine lineNumber="2727"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/register">Register</a> SrcReg = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(1).getReg();</span></CodeLine>
<Link id="l02728" /><CodeLine lineNumber="2728"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SrcReg.<a href="/docs/api/classes/llvm/register/#ab203bbcbc320180b1da9e9a92ee0c784">isVirtual</a>())</span></CodeLine>
<Link id="l02729" /><CodeLine lineNumber="2729"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::make&#95;pair(VNI, TrackReg);</span></CodeLine>
<Link id="l02730" /><CodeLine lineNumber="2730"></CodeLine>
<Link id="l02731" /><CodeLine lineNumber="2731"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI = LIS-&gt;getInterval(SrcReg);</span></CodeLine>
<Link id="l02732" /><CodeLine lineNumber="2732"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;ValueIn;</span></CodeLine>
<Link id="l02733" /><CodeLine lineNumber="2733"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// No subrange involved.</span></CodeLine>
<Link id="l02734" /><CodeLine lineNumber="2734"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SubRangeJoin || !LI.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l02735" /><CodeLine lineNumber="2735"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> LRQ = LI.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(Def);</span></CodeLine>
<Link id="l02736" /><CodeLine lineNumber="2736"><span class="doxyHighlight">      ValueIn = LRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>();</span></CodeLine>
<Link id="l02737" /><CodeLine lineNumber="2737"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02738" /><CodeLine lineNumber="2738"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Query subranges. Ensure that all matching ones take us to the same def</span></CodeLine>
<Link id="l02739" /><CodeLine lineNumber="2739"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// (allowing some of them to be undef).</span></CodeLine>
<Link id="l02740" /><CodeLine lineNumber="2740"><span class="doxyHighlight">      ValueIn = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02741" /><CodeLine lineNumber="2741"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : LI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l02742" /><CodeLine lineNumber="2742"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Transform lanemask to a mask in the joined live interval.</span></CodeLine>
<Link id="l02743" /><CodeLine lineNumber="2743"><span class="doxyHighlight">        <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> SMask = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndexLaneMask(SubIdx, S.LaneMask);</span></CodeLine>
<Link id="l02744" /><CodeLine lineNumber="2744"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((SMask &amp; LaneMask).<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64stacktagging-cpp/#a8e818224d2d1de9b995783ff897b0083ab7e4e0120a041dbe6528b050c04269e0">none</a>())</span></CodeLine>
<Link id="l02745" /><CodeLine lineNumber="2745"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02746" /><CodeLine lineNumber="2746"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> LRQ = S.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(Def);</span></CodeLine>
<Link id="l02747" /><CodeLine lineNumber="2747"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!ValueIn) &#123;</span></CodeLine>
<Link id="l02748" /><CodeLine lineNumber="2748"><span class="doxyHighlight">          ValueIn = LRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>();</span></CodeLine>
<Link id="l02749" /><CodeLine lineNumber="2749"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02750" /><CodeLine lineNumber="2750"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02751" /><CodeLine lineNumber="2751"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>() &amp;&amp; ValueIn != LRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>())</span></CodeLine>
<Link id="l02752" /><CodeLine lineNumber="2752"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::make&#95;pair(VNI, TrackReg);</span></CodeLine>
<Link id="l02753" /><CodeLine lineNumber="2753"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02754" /><CodeLine lineNumber="2754"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02755" /><CodeLine lineNumber="2755"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValueIn == </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l02756" /><CodeLine lineNumber="2756"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Reaching an undefined value is legitimate, for example:</span></CodeLine>
<Link id="l02757" /><CodeLine lineNumber="2757"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02758" /><CodeLine lineNumber="2758"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// 1   undef %0.sub1 = ...  ;; %0.sub0 == undef</span></CodeLine>
<Link id="l02759" /><CodeLine lineNumber="2759"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// 2   %1 = COPY %0         ;; %1 is defined here.</span></CodeLine>
<Link id="l02760" /><CodeLine lineNumber="2760"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// 3   %0 = COPY %1         ;; Now %0.sub0 has a definition,</span></CodeLine>
<Link id="l02761" /><CodeLine lineNumber="2761"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//                          ;; but it&#39;s equivalent to &quot;undef&quot;.</span></CodeLine>
<Link id="l02762" /><CodeLine lineNumber="2762"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::make&#95;pair(</span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, SrcReg);</span></CodeLine>
<Link id="l02763" /><CodeLine lineNumber="2763"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02764" /><CodeLine lineNumber="2764"><span class="doxyHighlight">    VNI = ValueIn;</span></CodeLine>
<Link id="l02765" /><CodeLine lineNumber="2765"><span class="doxyHighlight">    TrackReg = SrcReg;</span></CodeLine>
<Link id="l02766" /><CodeLine lineNumber="2766"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02767" /><CodeLine lineNumber="2767"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::make&#95;pair(VNI, TrackReg);</span></CodeLine>
<Link id="l02768" /><CodeLine lineNumber="2768"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02769" /><CodeLine lineNumber="2769"></CodeLine>
<Link id="l02770" /><CodeLine lineNumber="2770"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> JoinVals::valuesIdentical(<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;Value0, <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;Value1,</span></CodeLine>
<Link id="l02771" /><CodeLine lineNumber="2771"><span class="doxyHighlight">                               </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> JoinVals &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l02772" /><CodeLine lineNumber="2772"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;Orig0;</span></CodeLine>
<Link id="l02773" /><CodeLine lineNumber="2773"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> Reg0;</span></CodeLine>
<Link id="l02774" /><CodeLine lineNumber="2774"><span class="doxyHighlight">  std::tie(Orig0, Reg0) = followCopyChain(Value0);</span></CodeLine>
<Link id="l02775" /><CodeLine lineNumber="2775"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Orig0 == Value1 &amp;&amp; Reg0 == <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Reg)</span></CodeLine>
<Link id="l02776" /><CodeLine lineNumber="2776"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02777" /><CodeLine lineNumber="2777"></CodeLine>
<Link id="l02778" /><CodeLine lineNumber="2778"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;Orig1;</span></CodeLine>
<Link id="l02779" /><CodeLine lineNumber="2779"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> Reg1;</span></CodeLine>
<Link id="l02780" /><CodeLine lineNumber="2780"><span class="doxyHighlight">  std::tie(Orig1, Reg1) = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.followCopyChain(Value1);</span></CodeLine>
<Link id="l02781" /><CodeLine lineNumber="2781"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If both values are undefined, and the source registers are the same</span></CodeLine>
<Link id="l02782" /><CodeLine lineNumber="2782"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// register, the values are identical. Filter out cases where only one</span></CodeLine>
<Link id="l02783" /><CodeLine lineNumber="2783"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value is defined.</span></CodeLine>
<Link id="l02784" /><CodeLine lineNumber="2784"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Orig0 == </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> || Orig1 == </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l02785" /><CodeLine lineNumber="2785"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Orig0 == Orig1 &amp;&amp; Reg0 == Reg1;</span></CodeLine>
<Link id="l02786" /><CodeLine lineNumber="2786"></CodeLine>
<Link id="l02787" /><CodeLine lineNumber="2787"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The values are equal if they are defined at the same place and use the</span></CodeLine>
<Link id="l02788" /><CodeLine lineNumber="2788"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// same register. Note that we cannot compare VNInfos directly as some of</span></CodeLine>
<Link id="l02789" /><CodeLine lineNumber="2789"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// them might be from a copy created in mergeSubRangeInto()  while the other</span></CodeLine>
<Link id="l02790" /><CodeLine lineNumber="2790"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is from the original LiveInterval.</span></CodeLine>
<Link id="l02791" /><CodeLine lineNumber="2791"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Orig0-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> == Orig1-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &amp;&amp; Reg0 == Reg1;</span></CodeLine>
<Link id="l02792" /><CodeLine lineNumber="2792"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02793" /><CodeLine lineNumber="2793"></CodeLine>
<Link id="l02794" /><CodeLine lineNumber="2794"><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909c">JoinVals::ConflictResolution</a> JoinVals::analyzeValue(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValNo,</span></CodeLine>
<Link id="l02795" /><CodeLine lineNumber="2795"><span class="doxyHighlight">                                                    JoinVals &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>) &#123;</span></CodeLine>
<Link id="l02796" /><CodeLine lineNumber="2796"><span class="doxyHighlight">  Val &amp;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a> = Vals&#91;ValNo&#93;;</span></CodeLine>
<Link id="l02797" /><CodeLine lineNumber="2797"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.isAnalyzed() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Value has already been analyzed!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02798" /><CodeLine lineNumber="2798"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI = LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(ValNo);</span></CodeLine>
<Link id="l02799" /><CodeLine lineNumber="2799"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ab72366fd538f240cbb53dac39368cdfc">isUnused</a>()) &#123;</span></CodeLine>
<Link id="l02800" /><CodeLine lineNumber="2800"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.WriteLanes = <a href="/docs/api/structs/llvm/lanebitmask/#a3714a639930eab71d7202da05ad82990">LaneBitmask::getAll</a>();</span></CodeLine>
<Link id="l02801" /><CodeLine lineNumber="2801"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Keep;</span></CodeLine>
<Link id="l02802" /><CodeLine lineNumber="2802"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02803" /><CodeLine lineNumber="2803"></CodeLine>
<Link id="l02804" /><CodeLine lineNumber="2804"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Get the instruction defining this value, compute the lanes written.</span></CodeLine>
<Link id="l02805" /><CodeLine lineNumber="2805"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02806" /><CodeLine lineNumber="2806"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>()) &#123;</span></CodeLine>
<Link id="l02807" /><CodeLine lineNumber="2807"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Conservatively assume that all lanes in a PHI are valid.</span></CodeLine>
<Link id="l02808" /><CodeLine lineNumber="2808"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> Lanes = SubRangeJoin ? <a href="/docs/api/structs/llvm/lanebitmask/#a270fa98e050bd43b4354d12d094f8f97">LaneBitmask::getLane</a>(0)</span></CodeLine>
<Link id="l02809" /><CodeLine lineNumber="2809"><span class="doxyHighlight">                                     : <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(SubIdx);</span></CodeLine>
<Link id="l02810" /><CodeLine lineNumber="2810"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ValidLanes = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.WriteLanes = Lanes;</span></CodeLine>
<Link id="l02811" /><CodeLine lineNumber="2811"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02812" /><CodeLine lineNumber="2812"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a> = Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#af454bfc85311cf45162476f6b4e5dee8">getInstructionFromIndex</a>(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l02813" /><CodeLine lineNumber="2813"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a> != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02814" /><CodeLine lineNumber="2814"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubRangeJoin) &#123;</span></CodeLine>
<Link id="l02815" /><CodeLine lineNumber="2815"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We don&#39;t care about the lanes when joining subregister ranges.</span></CodeLine>
<Link id="l02816" /><CodeLine lineNumber="2816"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.WriteLanes = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ValidLanes = <a href="/docs/api/structs/llvm/lanebitmask/#a270fa98e050bd43b4354d12d094f8f97">LaneBitmask::getLane</a>(0);</span></CodeLine>
<Link id="l02817" /><CodeLine lineNumber="2817"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a120ccebe70e1b0ddf72fc776229d0025">isImplicitDef</a>()) &#123;</span></CodeLine>
<Link id="l02818" /><CodeLine lineNumber="2818"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ValidLanes = <a href="/docs/api/structs/llvm/lanebitmask/#a9082b6aa4021114645045d9c5628eb26">LaneBitmask::getNone</a>();</span></CodeLine>
<Link id="l02819" /><CodeLine lineNumber="2819"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ErasableImplicitDef = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02820" /><CodeLine lineNumber="2820"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02821" /><CodeLine lineNumber="2821"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02822" /><CodeLine lineNumber="2822"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Redef = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02823" /><CodeLine lineNumber="2823"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ValidLanes = <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.WriteLanes = computeWriteLanes(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>, Redef);</span></CodeLine>
<Link id="l02824" /><CodeLine lineNumber="2824"></CodeLine>
<Link id="l02825" /><CodeLine lineNumber="2825"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If this is a read-modify-write instruction, there may be more valid</span></CodeLine>
<Link id="l02826" /><CodeLine lineNumber="2826"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// lanes than the ones written by this instruction.</span></CodeLine>
<Link id="l02827" /><CodeLine lineNumber="2827"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// This only covers partial redef operands. DefMI may have normal use</span></CodeLine>
<Link id="l02828" /><CodeLine lineNumber="2828"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// operands reading the register. They don&#39;t contribute valid lanes.</span></CodeLine>
<Link id="l02829" /><CodeLine lineNumber="2829"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02830" /><CodeLine lineNumber="2830"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// This adds ssub1 to the set of valid lanes in %src:</span></CodeLine>
<Link id="l02831" /><CodeLine lineNumber="2831"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02832" /><CodeLine lineNumber="2832"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//   %src:ssub1 = FOO</span></CodeLine>
<Link id="l02833" /><CodeLine lineNumber="2833"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02834" /><CodeLine lineNumber="2834"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// This leaves only ssub1 valid, making any other lanes undef:</span></CodeLine>
<Link id="l02835" /><CodeLine lineNumber="2835"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02836" /><CodeLine lineNumber="2836"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//   %src:ssub1&lt;def,read-undef&gt; = FOO %src:ssub2</span></CodeLine>
<Link id="l02837" /><CodeLine lineNumber="2837"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02838" /><CodeLine lineNumber="2838"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// The &lt;read-undef&gt; flag on the def operand means that old lane values are</span></CodeLine>
<Link id="l02839" /><CodeLine lineNumber="2839"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// not important.</span></CodeLine>
<Link id="l02840" /><CodeLine lineNumber="2840"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Redef) &#123;</span></CodeLine>
<Link id="l02841" /><CodeLine lineNumber="2841"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.RedefVNI = LR.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>).<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>();</span></CodeLine>
<Link id="l02842" /><CodeLine lineNumber="2842"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((TrackSubRegLiveness || <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.RedefVNI) &amp;&amp;</span></CodeLine>
<Link id="l02843" /><CodeLine lineNumber="2843"><span class="doxyHighlight">               </span><span class="doxyHighlightStringLiteral">&quot;Instruction is reading nonexistent value&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02844" /><CodeLine lineNumber="2844"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.RedefVNI != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l02845" /><CodeLine lineNumber="2845"><span class="doxyHighlight">          computeAssignment(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.RedefVNI-&gt;id, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>);</span></CodeLine>
<Link id="l02846" /><CodeLine lineNumber="2846"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ValidLanes |= Vals&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.RedefVNI-&gt;id&#93;.ValidLanes;</span></CodeLine>
<Link id="l02847" /><CodeLine lineNumber="2847"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02848" /><CodeLine lineNumber="2848"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02849" /><CodeLine lineNumber="2849"></CodeLine>
<Link id="l02850" /><CodeLine lineNumber="2850"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// An IMPLICIT&#95;DEF writes undef values.</span></CodeLine>
<Link id="l02851" /><CodeLine lineNumber="2851"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a120ccebe70e1b0ddf72fc776229d0025">isImplicitDef</a>()) &#123;</span></CodeLine>
<Link id="l02852" /><CodeLine lineNumber="2852"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We normally expect IMPLICIT&#95;DEF values to be live only until the end</span></CodeLine>
<Link id="l02853" /><CodeLine lineNumber="2853"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// of their block. If the value is really live longer and gets pruned in</span></CodeLine>
<Link id="l02854" /><CodeLine lineNumber="2854"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// another block, this flag is cleared again.</span></CodeLine>
<Link id="l02855" /><CodeLine lineNumber="2855"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02856" /><CodeLine lineNumber="2856"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Clearing the valid lanes is deferred until it is sure this can be</span></CodeLine>
<Link id="l02857" /><CodeLine lineNumber="2857"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// erased.</span></CodeLine>
<Link id="l02858" /><CodeLine lineNumber="2858"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ErasableImplicitDef = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02859" /><CodeLine lineNumber="2859"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02860" /><CodeLine lineNumber="2860"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02861" /><CodeLine lineNumber="2861"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02862" /><CodeLine lineNumber="2862"></CodeLine>
<Link id="l02863" /><CodeLine lineNumber="2863"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Find the value in Other that overlaps VNI-&gt;def, if any.</span></CodeLine>
<Link id="l02864" /><CodeLine lineNumber="2864"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> OtherLRQ = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.LR.Query(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l02865" /><CodeLine lineNumber="2865"></CodeLine>
<Link id="l02866" /><CodeLine lineNumber="2866"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// It is possible that both values are defined by the same instruction, or</span></CodeLine>
<Link id="l02867" /><CodeLine lineNumber="2867"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the values are PHIs defined in the same block. When that happens, the two</span></CodeLine>
<Link id="l02868" /><CodeLine lineNumber="2868"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// values should be merged into one, but not into any preceding value.</span></CodeLine>
<Link id="l02869" /><CodeLine lineNumber="2869"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The first value defined or visited gets CR&#95;Keep, the other gets CR&#95;Merge.</span></CodeLine>
<Link id="l02870" /><CodeLine lineNumber="2870"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;OtherVNI = OtherLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#aaae33cfd0a31e453deec40b2d5274e70">valueDefined</a>()) &#123;</span></CodeLine>
<Link id="l02871" /><CodeLine lineNumber="2871"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/llvm/slotindex/#a0b73244049319d841fd11a238f35b5d1">SlotIndex::isSameInstr</a>(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>, OtherVNI-&gt;def) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Broken LRQ&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02872" /><CodeLine lineNumber="2872"></CodeLine>
<Link id="l02873" /><CodeLine lineNumber="2873"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// One value stays, the other is merged. Keep the earlier one, or the first</span></CodeLine>
<Link id="l02874" /><CodeLine lineNumber="2874"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// one we see.</span></CodeLine>
<Link id="l02875" /><CodeLine lineNumber="2875"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherVNI-&gt;def &lt; VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>)</span></CodeLine>
<Link id="l02876" /><CodeLine lineNumber="2876"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.computeAssignment(OtherVNI-&gt;id, &#42;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02877" /><CodeLine lineNumber="2877"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &lt; OtherVNI-&gt;def &amp;&amp; OtherLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>()) &#123;</span></CodeLine>
<Link id="l02878" /><CodeLine lineNumber="2878"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// This is an early-clobber def overlapping a live-in value in the other</span></CodeLine>
<Link id="l02879" /><CodeLine lineNumber="2879"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// register. Not mergeable.</span></CodeLine>
<Link id="l02880" /><CodeLine lineNumber="2880"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI = OtherLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>();</span></CodeLine>
<Link id="l02881" /><CodeLine lineNumber="2881"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Impossible;</span></CodeLine>
<Link id="l02882" /><CodeLine lineNumber="2882"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02883" /><CodeLine lineNumber="2883"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI = OtherVNI;</span></CodeLine>
<Link id="l02884" /><CodeLine lineNumber="2884"><span class="doxyHighlight">    Val &amp;OtherV = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Vals&#91;OtherVNI-&gt;id&#93;;</span></CodeLine>
<Link id="l02885" /><CodeLine lineNumber="2885"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Keep this value, check for conflicts when analyzing OtherVNI. Avoid</span></CodeLine>
<Link id="l02886" /><CodeLine lineNumber="2886"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// revisiting OtherVNI-&gt;id in JoinVals::computeAssignment() below before it</span></CodeLine>
<Link id="l02887" /><CodeLine lineNumber="2887"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// is assigned.</span></CodeLine>
<Link id="l02888" /><CodeLine lineNumber="2888"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!OtherV.isAnalyzed() || <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Assignments&#91;OtherVNI-&gt;id&#93; == -1)</span></CodeLine>
<Link id="l02889" /><CodeLine lineNumber="2889"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Keep;</span></CodeLine>
<Link id="l02890" /><CodeLine lineNumber="2890"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Both sides have been analyzed now.</span></CodeLine>
<Link id="l02891" /><CodeLine lineNumber="2891"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Allow overlapping PHI values. Any real interference would show up in a</span></CodeLine>
<Link id="l02892" /><CodeLine lineNumber="2892"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// predecessor, the PHI itself can&#39;t introduce any conflicts.</span></CodeLine>
<Link id="l02893" /><CodeLine lineNumber="2893"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>())</span></CodeLine>
<Link id="l02894" /><CodeLine lineNumber="2894"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Merge;</span></CodeLine>
<Link id="l02895" /><CodeLine lineNumber="2895"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ValidLanes &amp; OtherV.ValidLanes).any())</span></CodeLine>
<Link id="l02896" /><CodeLine lineNumber="2896"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Overlapping lanes can&#39;t be resolved.</span></CodeLine>
<Link id="l02897" /><CodeLine lineNumber="2897"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Impossible;</span></CodeLine>
<Link id="l02898" /><CodeLine lineNumber="2898"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l02899" /><CodeLine lineNumber="2899"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Merge;</span></CodeLine>
<Link id="l02900" /><CodeLine lineNumber="2900"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02901" /><CodeLine lineNumber="2901"></CodeLine>
<Link id="l02902" /><CodeLine lineNumber="2902"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// No simultaneous def. Is Other live at the def?</span></CodeLine>
<Link id="l02903" /><CodeLine lineNumber="2903"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI = OtherLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>();</span></CodeLine>
<Link id="l02904" /><CodeLine lineNumber="2904"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI)</span></CodeLine>
<Link id="l02905" /><CodeLine lineNumber="2905"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// No overlap, no conflict.</span></CodeLine>
<Link id="l02906" /><CodeLine lineNumber="2906"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Keep;</span></CodeLine>
<Link id="l02907" /><CodeLine lineNumber="2907"></CodeLine>
<Link id="l02908" /><CodeLine lineNumber="2908"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/classes/llvm/slotindex/#a0b73244049319d841fd11a238f35b5d1">SlotIndex::isSameInstr</a>(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;def) &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Broken LRQ&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02909" /><CodeLine lineNumber="2909"></CodeLine>
<Link id="l02910" /><CodeLine lineNumber="2910"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We have overlapping values, or possibly a kill of Other.</span></CodeLine>
<Link id="l02911" /><CodeLine lineNumber="2911"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Recursively compute assignments up the dominator tree.</span></CodeLine>
<Link id="l02912" /><CodeLine lineNumber="2912"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.computeAssignment(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;id, &#42;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02913" /><CodeLine lineNumber="2913"><span class="doxyHighlight">  Val &amp;OtherV = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Vals&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;id&#93;;</span></CodeLine>
<Link id="l02914" /><CodeLine lineNumber="2914"></CodeLine>
<Link id="l02915" /><CodeLine lineNumber="2915"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherV.ErasableImplicitDef) &#123;</span></CodeLine>
<Link id="l02916" /><CodeLine lineNumber="2916"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check if OtherV is an IMPLICIT&#95;DEF that extends beyond its basic block.</span></CodeLine>
<Link id="l02917" /><CodeLine lineNumber="2917"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This shouldn&#39;t normally happen, but ProcessImplicitDefs can leave such</span></CodeLine>
<Link id="l02918" /><CodeLine lineNumber="2918"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// IMPLICIT&#95;DEF instructions behind, and there is nothing wrong with it</span></CodeLine>
<Link id="l02919" /><CodeLine lineNumber="2919"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// technically.</span></CodeLine>
<Link id="l02920" /><CodeLine lineNumber="2920"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02921" /><CodeLine lineNumber="2921"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// When it happens, treat that IMPLICIT&#95;DEF as a normal value, and don&#39;t try</span></CodeLine>
<Link id="l02922" /><CodeLine lineNumber="2922"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// to erase the IMPLICIT&#95;DEF instruction.</span></CodeLine>
<Link id="l02923" /><CodeLine lineNumber="2923"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02924" /><CodeLine lineNumber="2924"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Additionally we must keep an IMPLICIT&#95;DEF if we&#39;re redefining an incoming</span></CodeLine>
<Link id="l02925" /><CodeLine lineNumber="2925"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// value.</span></CodeLine>
<Link id="l02926" /><CodeLine lineNumber="2926"></CodeLine>
<Link id="l02927" /><CodeLine lineNumber="2927"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;OtherImpDef =</span></CodeLine>
<Link id="l02928" /><CodeLine lineNumber="2928"><span class="doxyHighlight">        Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#af454bfc85311cf45162476f6b4e5dee8">getInstructionFromIndex</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;def);</span></CodeLine>
<Link id="l02929" /><CodeLine lineNumber="2929"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;OtherMBB = OtherImpDef-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>();</span></CodeLine>
<Link id="l02930" /><CodeLine lineNumber="2930"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a> &amp;&amp;</span></CodeLine>
<Link id="l02931" /><CodeLine lineNumber="2931"><span class="doxyHighlight">        (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>() != OtherMBB || LIS-&gt;isLiveInToMBB(LR, OtherMBB))) &#123;</span></CodeLine>
<Link id="l02932" /><CodeLine lineNumber="2932"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;IMPLICIT&#95;DEF defined at &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;def</span></CodeLine>
<Link id="l02933" /><CodeLine lineNumber="2933"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; extends into &quot;</span></CodeLine>
<Link id="l02934" /><CodeLine lineNumber="2934"><span class="doxyHighlight">                        &lt;&lt; <a href="/docs/api/namespaces/llvm/#af7881286e3ea4d7f1c4a63c87c132dac">printMBBReference</a>(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>())</span></CodeLine>
<Link id="l02935" /><CodeLine lineNumber="2935"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;, keeping it.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02936" /><CodeLine lineNumber="2936"><span class="doxyHighlight">      OtherV.mustKeepImplicitDef(&#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, &#42;OtherImpDef);</span></CodeLine>
<Link id="l02937" /><CodeLine lineNumber="2937"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherMBB-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a07ccfc69389d4e9657d22698f4a7ef46">hasEHPadSuccessor</a>()) &#123;</span></CodeLine>
<Link id="l02938" /><CodeLine lineNumber="2938"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If OtherV is defined in a basic block that has EH pad successors then</span></CodeLine>
<Link id="l02939" /><CodeLine lineNumber="2939"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// we get the same problem not just if OtherV is live beyond its basic</span></CodeLine>
<Link id="l02940" /><CodeLine lineNumber="2940"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// block, but beyond the last call instruction in its basic block. Handle</span></CodeLine>
<Link id="l02941" /><CodeLine lineNumber="2941"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// this case conservatively.</span></CodeLine>
<Link id="l02942" /><CodeLine lineNumber="2942"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l02943" /><CodeLine lineNumber="2943"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;IMPLICIT&#95;DEF defined at &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;def</span></CodeLine>
<Link id="l02944" /><CodeLine lineNumber="2944"><span class="doxyHighlight">                 &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; may be live into EH pad successors, keeping it.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02945" /><CodeLine lineNumber="2945"><span class="doxyHighlight">      OtherV.mustKeepImplicitDef(&#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, &#42;OtherImpDef);</span></CodeLine>
<Link id="l02946" /><CodeLine lineNumber="2946"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02947" /><CodeLine lineNumber="2947"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We deferred clearing these lanes in case we needed to save them</span></CodeLine>
<Link id="l02948" /><CodeLine lineNumber="2948"><span class="doxyHighlight">      OtherV.ValidLanes &amp;= ~OtherV.WriteLanes;</span></CodeLine>
<Link id="l02949" /><CodeLine lineNumber="2949"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02950" /><CodeLine lineNumber="2950"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02951" /><CodeLine lineNumber="2951"></CodeLine>
<Link id="l02952" /><CodeLine lineNumber="2952"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Allow overlapping PHI values. Any real interference would show up in a</span></CodeLine>
<Link id="l02953" /><CodeLine lineNumber="2953"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// predecessor, the PHI itself can&#39;t introduce any conflicts.</span></CodeLine>
<Link id="l02954" /><CodeLine lineNumber="2954"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>())</span></CodeLine>
<Link id="l02955" /><CodeLine lineNumber="2955"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Replace;</span></CodeLine>
<Link id="l02956" /><CodeLine lineNumber="2956"></CodeLine>
<Link id="l02957" /><CodeLine lineNumber="2957"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check for simple erasable conflicts.</span></CodeLine>
<Link id="l02958" /><CodeLine lineNumber="2958"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a120ccebe70e1b0ddf72fc776229d0025">isImplicitDef</a>())</span></CodeLine>
<Link id="l02959" /><CodeLine lineNumber="2959"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Erase;</span></CodeLine>
<Link id="l02960" /><CodeLine lineNumber="2960"></CodeLine>
<Link id="l02961" /><CodeLine lineNumber="2961"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Include the non-conflict where DefMI is a coalescable copy that kills</span></CodeLine>
<Link id="l02962" /><CodeLine lineNumber="2962"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// OtherVNI. We still want the copy erased and value numbers merged.</span></CodeLine>
<Link id="l02963" /><CodeLine lineNumber="2963"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isCoalescable(<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>)) &#123;</span></CodeLine>
<Link id="l02964" /><CodeLine lineNumber="2964"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Some of the lanes copied from OtherVNI may be undef, making them undef</span></CodeLine>
<Link id="l02965" /><CodeLine lineNumber="2965"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// here too.</span></CodeLine>
<Link id="l02966" /><CodeLine lineNumber="2966"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.ValidLanes &amp;= ~V.WriteLanes | OtherV.ValidLanes;</span></CodeLine>
<Link id="l02967" /><CodeLine lineNumber="2967"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Erase;</span></CodeLine>
<Link id="l02968" /><CodeLine lineNumber="2968"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02969" /><CodeLine lineNumber="2969"></CodeLine>
<Link id="l02970" /><CodeLine lineNumber="2970"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This may not be a real conflict if DefMI simply kills Other and defines</span></CodeLine>
<Link id="l02971" /><CodeLine lineNumber="2971"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// VNI.</span></CodeLine>
<Link id="l02972" /><CodeLine lineNumber="2972"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#af155aeaffc7607f4f27ab4cfcbb39a64">isKill</a>() &amp;&amp; OtherLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#accf3c068536d27391a38eaec0db05eec">endPoint</a>() &lt;= VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>)</span></CodeLine>
<Link id="l02973" /><CodeLine lineNumber="2973"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Keep;</span></CodeLine>
<Link id="l02974" /><CodeLine lineNumber="2974"></CodeLine>
<Link id="l02975" /><CodeLine lineNumber="2975"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Handle the case where VNI and OtherVNI can be proven to be identical:</span></CodeLine>
<Link id="l02976" /><CodeLine lineNumber="2976"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02977" /><CodeLine lineNumber="2977"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   %other = COPY %ext</span></CodeLine>
<Link id="l02978" /><CodeLine lineNumber="2978"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   %this  = COPY %ext &lt;-- Erase this copy</span></CodeLine>
<Link id="l02979" /><CodeLine lineNumber="2979"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02980" /><CodeLine lineNumber="2980"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64expandpseudoinsts-cpp/#ad3ece0ac2421637044624c9b01c42466">DefMI</a>-&gt;<a href="/docs/api/classes/llvm/machineinstr/#a6ee45760c97bf2dda6bee91508e6946e">isFullCopy</a>() &amp;&amp; !<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPartial() &amp;&amp;</span></CodeLine>
<Link id="l02981" /><CodeLine lineNumber="2981"><span class="doxyHighlight">      valuesIdentical(VNI, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)) &#123;</span></CodeLine>
<Link id="l02982" /><CodeLine lineNumber="2982"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.Identical = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02983" /><CodeLine lineNumber="2983"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Erase;</span></CodeLine>
<Link id="l02984" /><CodeLine lineNumber="2984"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02985" /><CodeLine lineNumber="2985"></CodeLine>
<Link id="l02986" /><CodeLine lineNumber="2986"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The remaining checks apply to the lanes, which aren&#39;t tracked here.  This</span></CodeLine>
<Link id="l02987" /><CodeLine lineNumber="2987"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// was already decided to be OK via the following CR&#95;Replace condition.</span></CodeLine>
<Link id="l02988" /><CodeLine lineNumber="2988"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CR&#95;Replace.</span></CodeLine>
<Link id="l02989" /><CodeLine lineNumber="2989"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubRangeJoin)</span></CodeLine>
<Link id="l02990" /><CodeLine lineNumber="2990"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Replace;</span></CodeLine>
<Link id="l02991" /><CodeLine lineNumber="2991"></CodeLine>
<Link id="l02992" /><CodeLine lineNumber="2992"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the lanes written by this instruction were all undef in OtherVNI, it is</span></CodeLine>
<Link id="l02993" /><CodeLine lineNumber="2993"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// still safe to join the live ranges. This can&#39;t be done with a simple value</span></CodeLine>
<Link id="l02994" /><CodeLine lineNumber="2994"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// mapping, though - OtherVNI will map to multiple values:</span></CodeLine>
<Link id="l02995" /><CodeLine lineNumber="2995"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02996" /><CodeLine lineNumber="2996"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   1 %dst:ssub0 = FOO                &lt;-- OtherVNI</span></CodeLine>
<Link id="l02997" /><CodeLine lineNumber="2997"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   2 %src = BAR                      &lt;-- VNI</span></CodeLine>
<Link id="l02998" /><CodeLine lineNumber="2998"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   3 %dst:ssub1 = COPY killed %src    &lt;-- Eliminate this copy.</span></CodeLine>
<Link id="l02999" /><CodeLine lineNumber="2999"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   4 BAZ killed %dst</span></CodeLine>
<Link id="l03000" /><CodeLine lineNumber="3000"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   5 QUUX killed %src</span></CodeLine>
<Link id="l03001" /><CodeLine lineNumber="3001"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l03002" /><CodeLine lineNumber="3002"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Here OtherVNI will map to itself in &#91;1;2), but to VNI in &#91;2;5). CR&#95;Replace</span></CodeLine>
<Link id="l03003" /><CodeLine lineNumber="3003"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// handles this complex value mapping.</span></CodeLine>
<Link id="l03004" /><CodeLine lineNumber="3004"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.WriteLanes &amp; OtherV.ValidLanes).none())</span></CodeLine>
<Link id="l03005" /><CodeLine lineNumber="3005"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Replace;</span></CodeLine>
<Link id="l03006" /><CodeLine lineNumber="3006"></CodeLine>
<Link id="l03007" /><CodeLine lineNumber="3007"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the other live range is killed by DefMI and the live ranges are still</span></CodeLine>
<Link id="l03008" /><CodeLine lineNumber="3008"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// overlapping, it must be because we&#39;re looking at an early clobber def:</span></CodeLine>
<Link id="l03009" /><CodeLine lineNumber="3009"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l03010" /><CodeLine lineNumber="3010"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//   %dst&lt;def,early-clobber&gt; = ASM killed %src</span></CodeLine>
<Link id="l03011" /><CodeLine lineNumber="3011"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l03012" /><CodeLine lineNumber="3012"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// In this case, it is illegal to merge the two live ranges since the early</span></CodeLine>
<Link id="l03013" /><CodeLine lineNumber="3013"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// clobber def would clobber %src before it was read.</span></CodeLine>
<Link id="l03014" /><CodeLine lineNumber="3014"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#af155aeaffc7607f4f27ab4cfcbb39a64">isKill</a>()) &#123;</span></CodeLine>
<Link id="l03015" /><CodeLine lineNumber="3015"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This case where the def doesn&#39;t overlap the kill is handled above.</span></CodeLine>
<Link id="l03016" /><CodeLine lineNumber="3016"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>.<a href="/docs/api/classes/llvm/slotindex/#a305ac7d0553ef0ce21d461f5eabfe71c">isEarlyClobber</a>() &amp;&amp;</span></CodeLine>
<Link id="l03017" /><CodeLine lineNumber="3017"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Only early clobber defs can overlap a kill&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03018" /><CodeLine lineNumber="3018"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Impossible;</span></CodeLine>
<Link id="l03019" /><CodeLine lineNumber="3019"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03020" /><CodeLine lineNumber="3020"></CodeLine>
<Link id="l03021" /><CodeLine lineNumber="3021"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// VNI is clobbering live lanes in OtherVNI, but there is still the</span></CodeLine>
<Link id="l03022" /><CodeLine lineNumber="3022"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// possibility that no instructions actually read the clobbered lanes.</span></CodeLine>
<Link id="l03023" /><CodeLine lineNumber="3023"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we&#39;re clobbering all the lanes in OtherVNI, at least one must be read.</span></CodeLine>
<Link id="l03024" /><CodeLine lineNumber="3024"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Otherwise Other.RI wouldn&#39;t be live here.</span></CodeLine>
<Link id="l03025" /><CodeLine lineNumber="3025"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.SubIdx) &amp; ~<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.WriteLanes).none())</span></CodeLine>
<Link id="l03026" /><CodeLine lineNumber="3026"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Impossible;</span></CodeLine>
<Link id="l03027" /><CodeLine lineNumber="3027"></CodeLine>
<Link id="l03028" /><CodeLine lineNumber="3028"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TrackSubRegLiveness) &#123;</span></CodeLine>
<Link id="l03029" /><CodeLine lineNumber="3029"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;OtherLI = LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Reg);</span></CodeLine>
<Link id="l03030" /><CodeLine lineNumber="3030"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If OtherVNI does not have subranges, it means all the lanes of OtherVNI</span></CodeLine>
<Link id="l03031" /><CodeLine lineNumber="3031"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// share the same live range, so we just need to check whether they have</span></CodeLine>
<Link id="l03032" /><CodeLine lineNumber="3032"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// any conflict bit in their LaneMask.</span></CodeLine>
<Link id="l03033" /><CodeLine lineNumber="3033"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!OtherLI.hasSubRanges()) &#123;</span></CodeLine>
<Link id="l03034" /><CodeLine lineNumber="3034"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> OtherMask = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.SubIdx);</span></CodeLine>
<Link id="l03035" /><CodeLine lineNumber="3035"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> (OtherMask &amp; <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.WriteLanes).none() ? CR&#95;Replace : CR&#95;Impossible;</span></CodeLine>
<Link id="l03036" /><CodeLine lineNumber="3036"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03037" /><CodeLine lineNumber="3037"></CodeLine>
<Link id="l03038" /><CodeLine lineNumber="3038"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we are clobbering some active lanes of OtherVNI at VNI-&gt;def, it is</span></CodeLine>
<Link id="l03039" /><CodeLine lineNumber="3039"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// impossible to resolve the conflict. Otherwise, we can just replace</span></CodeLine>
<Link id="l03040" /><CodeLine lineNumber="3040"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// OtherVNI because of no real conflict.</span></CodeLine>
<Link id="l03041" /><CodeLine lineNumber="3041"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;OtherSR : OtherLI.subranges()) &#123;</span></CodeLine>
<Link id="l03042" /><CodeLine lineNumber="3042"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> OtherMask =</span></CodeLine>
<Link id="l03043" /><CodeLine lineNumber="3043"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndexLaneMask(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.SubIdx, OtherSR.LaneMask);</span></CodeLine>
<Link id="l03044" /><CodeLine lineNumber="3044"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((OtherMask &amp; <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.WriteLanes).none())</span></CodeLine>
<Link id="l03045" /><CodeLine lineNumber="3045"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03046" /><CodeLine lineNumber="3046"></CodeLine>
<Link id="l03047" /><CodeLine lineNumber="3047"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> OtherSRQ = OtherSR.Query(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l03048" /><CodeLine lineNumber="3048"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherSRQ.valueIn() &amp;&amp; OtherSRQ.endPoint() &gt; VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>) &#123;</span></CodeLine>
<Link id="l03049" /><CodeLine lineNumber="3049"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// VNI is clobbering some lanes of OtherVNI, they have real conflict.</span></CodeLine>
<Link id="l03050" /><CodeLine lineNumber="3050"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Impossible;</span></CodeLine>
<Link id="l03051" /><CodeLine lineNumber="3051"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03052" /><CodeLine lineNumber="3052"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03053" /><CodeLine lineNumber="3053"></CodeLine>
<Link id="l03054" /><CodeLine lineNumber="3054"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// VNI is NOT clobbering any lane of OtherVNI, just replace OtherVNI.</span></CodeLine>
<Link id="l03055" /><CodeLine lineNumber="3055"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Replace;</span></CodeLine>
<Link id="l03056" /><CodeLine lineNumber="3056"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03057" /><CodeLine lineNumber="3057"></CodeLine>
<Link id="l03058" /><CodeLine lineNumber="3058"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We need to verify that no instructions are reading the clobbered lanes.</span></CodeLine>
<Link id="l03059" /><CodeLine lineNumber="3059"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// To save compile time, we&#39;ll only check that locally. Don&#39;t allow the</span></CodeLine>
<Link id="l03060" /><CodeLine lineNumber="3060"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// tainted value to escape the basic block.</span></CodeLine>
<Link id="l03061" /><CodeLine lineNumber="3061"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#a3266945305cfb9bbf018e2fbe5fca335">getMBBFromIndex</a>(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l03062" /><CodeLine lineNumber="3062"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherLRQ.<a href="/docs/api/classes/llvm/livequeryresult/#accf3c068536d27391a38eaec0db05eec">endPoint</a>() &gt;= Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#a662867d9274595cdac0092afa45888be">getMBBEndIdx</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>))</span></CodeLine>
<Link id="l03063" /><CodeLine lineNumber="3063"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Impossible;</span></CodeLine>
<Link id="l03064" /><CodeLine lineNumber="3064"></CodeLine>
<Link id="l03065" /><CodeLine lineNumber="3065"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// There are still some things that could go wrong besides clobbered lanes</span></CodeLine>
<Link id="l03066" /><CodeLine lineNumber="3066"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// being read, for example OtherVNI may be only partially redefined in MBB,</span></CodeLine>
<Link id="l03067" /><CodeLine lineNumber="3067"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// and some clobbered lanes could escape the block. Save this analysis for</span></CodeLine>
<Link id="l03068" /><CodeLine lineNumber="3068"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// resolveConflicts() when all values have been mapped. We need to know</span></CodeLine>
<Link id="l03069" /><CodeLine lineNumber="3069"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// RedefVNI and WriteLanes for any later defs in MBB, and we can&#39;t compute</span></CodeLine>
<Link id="l03070" /><CodeLine lineNumber="3070"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that now - the recursive analyzeValue() calls must go upwards in the</span></CodeLine>
<Link id="l03071" /><CodeLine lineNumber="3071"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// dominator tree.</span></CodeLine>
<Link id="l03072" /><CodeLine lineNumber="3072"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> CR&#95;Unresolved;</span></CodeLine>
<Link id="l03073" /><CodeLine lineNumber="3073"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03074" /><CodeLine lineNumber="3074"></CodeLine>
<Link id="l03075" /><CodeLine lineNumber="3075"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> JoinVals::computeAssignment(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValNo, JoinVals &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>) &#123;</span></CodeLine>
<Link id="l03076" /><CodeLine lineNumber="3076"><span class="doxyHighlight">  Val &amp;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a> = Vals&#91;ValNo&#93;;</span></CodeLine>
<Link id="l03077" /><CodeLine lineNumber="3077"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.isAnalyzed()) &#123;</span></CodeLine>
<Link id="l03078" /><CodeLine lineNumber="3078"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Recursion should always move up the dominator tree, so ValNo is not</span></CodeLine>
<Link id="l03079" /><CodeLine lineNumber="3079"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// supposed to reappear before it has been assigned.</span></CodeLine>
<Link id="l03080" /><CodeLine lineNumber="3080"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Assignments&#91;ValNo&#93; != -1 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Bad recursion?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03081" /><CodeLine lineNumber="3081"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03082" /><CodeLine lineNumber="3082"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03083" /><CodeLine lineNumber="3083"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> ((<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.Resolution = analyzeValue(ValNo, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>))) &#123;</span></CodeLine>
<Link id="l03084" /><CodeLine lineNumber="3084"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> CR&#95;Erase:</span></CodeLine>
<Link id="l03085" /><CodeLine lineNumber="3085"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> CR&#95;Merge:</span></CodeLine>
<Link id="l03086" /><CodeLine lineNumber="3086"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Merge this ValNo into OtherVNI.</span></CodeLine>
<Link id="l03087" /><CodeLine lineNumber="3087"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;OtherVNI not assigned, can&#39;t merge.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03088" /><CodeLine lineNumber="3088"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Vals&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;id&#93;.isAnalyzed() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Missing recursion&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03089" /><CodeLine lineNumber="3089"><span class="doxyHighlight">    Assignments&#91;ValNo&#93; = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Assignments&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;id&#93;;</span></CodeLine>
<Link id="l03090" /><CodeLine lineNumber="3090"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tmerge &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;:&#39;</span><span class="doxyHighlight"> &lt;&lt; ValNo &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;@&#39;</span></CodeLine>
<Link id="l03091" /><CodeLine lineNumber="3091"><span class="doxyHighlight">                      &lt;&lt; LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(ValNo)-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; into &quot;</span></CodeLine>
<Link id="l03092" /><CodeLine lineNumber="3092"><span class="doxyHighlight">                      &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Reg) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;:&#39;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;id &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;@&#39;</span></CodeLine>
<Link id="l03093" /><CodeLine lineNumber="3093"><span class="doxyHighlight">                      &lt;&lt; <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;def &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; --&gt; @&quot;</span></CodeLine>
<Link id="l03094" /><CodeLine lineNumber="3094"><span class="doxyHighlight">                      &lt;&lt; NewVNInfo&#91;Assignments&#91;ValNo&#93;&#93;-&gt;def &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03095" /><CodeLine lineNumber="3095"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03096" /><CodeLine lineNumber="3096"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> CR&#95;Replace:</span></CodeLine>
<Link id="l03097" /><CodeLine lineNumber="3097"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> CR&#95;Unresolved: &#123;</span></CodeLine>
<Link id="l03098" /><CodeLine lineNumber="3098"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The other value is going to be pruned if this join is successful.</span></CodeLine>
<Link id="l03099" /><CodeLine lineNumber="3099"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;OtherVNI not assigned, can&#39;t prune&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03100" /><CodeLine lineNumber="3100"><span class="doxyHighlight">    Val &amp;OtherV = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Vals&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.OtherVNI-&gt;id&#93;;</span></CodeLine>
<Link id="l03101" /><CodeLine lineNumber="3101"><span class="doxyHighlight">    OtherV.Pruned = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03102" /><CodeLine lineNumber="3102"><span class="doxyHighlight">    &#91;&#91;fallthrough&#93;&#93;;</span></CodeLine>
<Link id="l03103" /><CodeLine lineNumber="3103"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03104" /><CodeLine lineNumber="3104"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l03105" /><CodeLine lineNumber="3105"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This value number needs to go in the final joined live range.</span></CodeLine>
<Link id="l03106" /><CodeLine lineNumber="3106"><span class="doxyHighlight">    Assignments&#91;ValNo&#93; = NewVNInfo.size();</span></CodeLine>
<Link id="l03107" /><CodeLine lineNumber="3107"><span class="doxyHighlight">    NewVNInfo.push&#95;back(LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(ValNo));</span></CodeLine>
<Link id="l03108" /><CodeLine lineNumber="3108"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03109" /><CodeLine lineNumber="3109"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03110" /><CodeLine lineNumber="3110"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03111" /><CodeLine lineNumber="3111"></CodeLine>
<Link id="l03112" /><CodeLine lineNumber="3112" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a5a8768b37f48763192c2530de53f97b0"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a5a8768b37f48763192c2530de53f97b0">JoinVals::mapValues</a>(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a5bdb429abc9cabb96a3c3df03e53e2ea">JoinVals</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>) &#123;</span></CodeLine>
<Link id="l03113" /><CodeLine lineNumber="3113"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = LR.<a href="/docs/api/classes/llvm/liverange/#a93450063916ca1ab1f11bf3304a6ad03">getNumValNums</a>(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l03114" /><CodeLine lineNumber="3114"><span class="doxyHighlight">    computeAssignment(i, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>);</span></CodeLine>
<Link id="l03115" /><CodeLine lineNumber="3115"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Vals&#91;i&#93;.Resolution == <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cadf133404fe2559cd68f16253fac30869">CR&#95;Impossible</a>) &#123;</span></CodeLine>
<Link id="l03116" /><CodeLine lineNumber="3116"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tinterference at &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;:&#39;</span><span class="doxyHighlight"> &lt;&lt; i</span></CodeLine>
<Link id="l03117" /><CodeLine lineNumber="3117"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;@&#39;</span><span class="doxyHighlight"> &lt;&lt; LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(i)-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03118" /><CodeLine lineNumber="3118"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03119" /><CodeLine lineNumber="3119"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03120" /><CodeLine lineNumber="3120"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03121" /><CodeLine lineNumber="3121"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03122" /><CodeLine lineNumber="3122"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03123" /><CodeLine lineNumber="3123"></CodeLine>
<Link id="l03124" /><CodeLine lineNumber="3124"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> JoinVals::taintExtent(</span></CodeLine>
<Link id="l03125" /><CodeLine lineNumber="3125"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValNo, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> TaintedLanes, <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>,</span></CodeLine>
<Link id="l03126" /><CodeLine lineNumber="3126"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt;std::pair&lt;SlotIndex, LaneBitmask&gt;&gt; &amp;TaintExtent) &#123;</span></CodeLine>
<Link id="l03127" /><CodeLine lineNumber="3127"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI = LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(ValNo);</span></CodeLine>
<Link id="l03128" /><CodeLine lineNumber="3128"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#a3266945305cfb9bbf018e2fbe5fca335">getMBBFromIndex</a>(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l03129" /><CodeLine lineNumber="3129"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> MBBEnd = Indexes-&gt;<a href="/docs/api/classes/llvm/slotindexes/#a662867d9274595cdac0092afa45888be">getMBBEndIdx</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03130" /><CodeLine lineNumber="3130"></CodeLine>
<Link id="l03131" /><CodeLine lineNumber="3131"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Scan Other.LR from VNI.def to MBBEnd.</span></CodeLine>
<Link id="l03132" /><CodeLine lineNumber="3132"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveInterval::iterator</a> OtherI = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.LR.find(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l03133" /><CodeLine lineNumber="3133"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OtherI != <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.LR.end() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;No conflict?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03134" /><CodeLine lineNumber="3134"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">do</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03135" /><CodeLine lineNumber="3135"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// OtherI is pointing to a tainted value. Abort the join if the tainted</span></CodeLine>
<Link id="l03136" /><CodeLine lineNumber="3136"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// lanes escape the block.</span></CodeLine>
<Link id="l03137" /><CodeLine lineNumber="3137"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> End = OtherI-&gt;end;</span></CodeLine>
<Link id="l03138" /><CodeLine lineNumber="3138"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (End &gt;= MBBEnd) &#123;</span></CodeLine>
<Link id="l03139" /><CodeLine lineNumber="3139"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\ttaints global &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Reg) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;:&#39;</span></CodeLine>
<Link id="l03140" /><CodeLine lineNumber="3140"><span class="doxyHighlight">                        &lt;&lt; OtherI-&gt;valno-&gt;id &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;@&#39;</span><span class="doxyHighlight"> &lt;&lt; OtherI-&gt;start &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03141" /><CodeLine lineNumber="3141"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03142" /><CodeLine lineNumber="3142"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03143" /><CodeLine lineNumber="3143"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\ttaints local &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Reg) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;:&#39;</span></CodeLine>
<Link id="l03144" /><CodeLine lineNumber="3144"><span class="doxyHighlight">                      &lt;&lt; OtherI-&gt;valno-&gt;id &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;@&#39;</span><span class="doxyHighlight"> &lt;&lt; OtherI-&gt;start &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; to &quot;</span></CodeLine>
<Link id="l03145" /><CodeLine lineNumber="3145"><span class="doxyHighlight">                      &lt;&lt; End &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03146" /><CodeLine lineNumber="3146"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// A dead def is not a problem.</span></CodeLine>
<Link id="l03147" /><CodeLine lineNumber="3147"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (End.<a href="/docs/api/classes/llvm/slotindex/#af7b521cd03cfcb1115186e877d0e820d">isDead</a>())</span></CodeLine>
<Link id="l03148" /><CodeLine lineNumber="3148"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03149" /><CodeLine lineNumber="3149"><span class="doxyHighlight">    TaintExtent.push&#95;back(std::make&#95;pair(End, TaintedLanes));</span></CodeLine>
<Link id="l03150" /><CodeLine lineNumber="3150"></CodeLine>
<Link id="l03151" /><CodeLine lineNumber="3151"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check for another def in the MBB.</span></CodeLine>
<Link id="l03152" /><CodeLine lineNumber="3152"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (++OtherI == <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.LR.end() || OtherI-&gt;start &gt;= MBBEnd)</span></CodeLine>
<Link id="l03153" /><CodeLine lineNumber="3153"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03154" /><CodeLine lineNumber="3154"></CodeLine>
<Link id="l03155" /><CodeLine lineNumber="3155"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Lanes written by the new def are no longer tainted.</span></CodeLine>
<Link id="l03156" /><CodeLine lineNumber="3156"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Val &amp;OV = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Vals&#91;OtherI-&gt;valno-&gt;id&#93;;</span></CodeLine>
<Link id="l03157" /><CodeLine lineNumber="3157"><span class="doxyHighlight">    TaintedLanes &amp;= ~OV.WriteLanes;</span></CodeLine>
<Link id="l03158" /><CodeLine lineNumber="3158"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!OV.RedefVNI)</span></CodeLine>
<Link id="l03159" /><CodeLine lineNumber="3159"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03160" /><CodeLine lineNumber="3160"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (TaintedLanes.<a href="/docs/api/structs/llvm/lanebitmask/#a72988cca7ab2262ef68fdd0c5ae54940">any</a>());</span></CodeLine>
<Link id="l03161" /><CodeLine lineNumber="3161"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03162" /><CodeLine lineNumber="3162"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03163" /><CodeLine lineNumber="3163"></CodeLine>
<Link id="l03164" /><CodeLine lineNumber="3164"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> JoinVals::usesLanes(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubIdx,</span></CodeLine>
<Link id="l03165" /><CodeLine lineNumber="3165"><span class="doxyHighlight">                         <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> Lanes)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l03166" /><CodeLine lineNumber="3166"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugOrPseudoInstr())</span></CodeLine>
<Link id="l03167" /><CodeLine lineNumber="3167"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03168" /><CodeLine lineNumber="3168"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.all&#95;uses()) &#123;</span></CodeLine>
<Link id="l03169" /><CodeLine lineNumber="3169"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() != <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)</span></CodeLine>
<Link id="l03170" /><CodeLine lineNumber="3170"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03171" /><CodeLine lineNumber="3171"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!MO.<a href="/docs/api/classes/llvm/machineoperand/#a3be9857a09c82046b77a71918b5e214f">readsReg</a>())</span></CodeLine>
<Link id="l03172" /><CodeLine lineNumber="3172"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03173" /><CodeLine lineNumber="3173"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> S = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndices(SubIdx, MO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>());</span></CodeLine>
<Link id="l03174" /><CodeLine lineNumber="3174"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((Lanes &amp; <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(S)).any())</span></CodeLine>
<Link id="l03175" /><CodeLine lineNumber="3175"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03176" /><CodeLine lineNumber="3176"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03177" /><CodeLine lineNumber="3177"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03178" /><CodeLine lineNumber="3178"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03179" /><CodeLine lineNumber="3179"></CodeLine>
<Link id="l03180" /><CodeLine lineNumber="3180" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#add7c3bdd8428904f63f53569807b8df6"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#add7c3bdd8428904f63f53569807b8df6">JoinVals::resolveConflicts</a>(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a5bdb429abc9cabb96a3c3df03e53e2ea">JoinVals</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>) &#123;</span></CodeLine>
<Link id="l03181" /><CodeLine lineNumber="3181"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = LR.<a href="/docs/api/classes/llvm/liverange/#a93450063916ca1ab1f11bf3304a6ad03">getNumValNums</a>(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l03182" /><CodeLine lineNumber="3182"><span class="doxyHighlight">    Val &amp;V = Vals&#91;i&#93;;</span></CodeLine>
<Link id="l03183" /><CodeLine lineNumber="3183"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V.Resolution != <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cadf133404fe2559cd68f16253fac30869">CR&#95;Impossible</a> &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Unresolvable conflict&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03184" /><CodeLine lineNumber="3184"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (V.Resolution != <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cabd7e0ab4ddda4ab7abfdc4077f6d8a50">CR&#95;Unresolved</a>)</span></CodeLine>
<Link id="l03185" /><CodeLine lineNumber="3185"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03186" /><CodeLine lineNumber="3186"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tconflict at &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;:&#39;</span><span class="doxyHighlight"> &lt;&lt; i &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;@&#39;</span></CodeLine>
<Link id="l03187" /><CodeLine lineNumber="3187"><span class="doxyHighlight">                      &lt;&lt; LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(i)-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39; &#39;</span></CodeLine>
<Link id="l03188" /><CodeLine lineNumber="3188"><span class="doxyHighlight">                      &lt;&lt; <a href="/docs/api/namespaces/llvm/#a3e30e18d6f7ebd943eaf8ebc3a2b2930">PrintLaneMask</a>(LaneMask) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03189" /><CodeLine lineNumber="3189"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubRangeJoin)</span></CodeLine>
<Link id="l03190" /><CodeLine lineNumber="3190"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03191" /><CodeLine lineNumber="3191"></CodeLine>
<Link id="l03192" /><CodeLine lineNumber="3192"><span class="doxyHighlight">    ++NumLaneConflicts;</span></CodeLine>
<Link id="l03193" /><CodeLine lineNumber="3193"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(V.OtherVNI &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Inconsistent conflict resolution.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03194" /><CodeLine lineNumber="3194"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI = LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(i);</span></CodeLine>
<Link id="l03195" /><CodeLine lineNumber="3195"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> Val &amp;OtherV = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Vals&#91;V.OtherVNI-&gt;id&#93;;</span></CodeLine>
<Link id="l03196" /><CodeLine lineNumber="3196"></CodeLine>
<Link id="l03197" /><CodeLine lineNumber="3197"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// VNI is known to clobber some lanes in OtherVNI. If we go ahead with the</span></CodeLine>
<Link id="l03198" /><CodeLine lineNumber="3198"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// join, those lanes will be tainted with a wrong value. Get the extent of</span></CodeLine>
<Link id="l03199" /><CodeLine lineNumber="3199"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the tainted lanes.</span></CodeLine>
<Link id="l03200" /><CodeLine lineNumber="3200"><span class="doxyHighlight">    <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> TaintedLanes = V.WriteLanes &amp; OtherV.ValidLanes;</span></CodeLine>
<Link id="l03201" /><CodeLine lineNumber="3201"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;SlotIndex, LaneBitmask&gt;</a>, 8&gt; TaintExtent;</span></CodeLine>
<Link id="l03202" /><CodeLine lineNumber="3202"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!taintExtent(i, TaintedLanes, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>, TaintExtent))</span></CodeLine>
<Link id="l03203" /><CodeLine lineNumber="3203"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Tainted lanes would extend beyond the basic block.</span></CodeLine>
<Link id="l03204" /><CodeLine lineNumber="3204"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03205" /><CodeLine lineNumber="3205"></CodeLine>
<Link id="l03206" /><CodeLine lineNumber="3206"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!TaintExtent.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;There should be at least one conflict.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03207" /><CodeLine lineNumber="3207"></CodeLine>
<Link id="l03208" /><CodeLine lineNumber="3208"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Now look at the instructions from VNI-&gt;def to TaintExtent (inclusive).</span></CodeLine>
<Link id="l03209" /><CodeLine lineNumber="3209"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = Indexes-&gt;getMBBFromIndex(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l03210" /><CodeLine lineNumber="3210"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a> <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;begin();</span></CodeLine>
<Link id="l03211" /><CodeLine lineNumber="3211"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>()) &#123;</span></CodeLine>
<Link id="l03212" /><CodeLine lineNumber="3212"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = Indexes-&gt;getInstructionFromIndex(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>);</span></CodeLine>
<Link id="l03213" /><CodeLine lineNumber="3213"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>.<a href="/docs/api/classes/llvm/slotindex/#a305ac7d0553ef0ce21d461f5eabfe71c">isEarlyClobber</a>()) &#123;</span></CodeLine>
<Link id="l03214" /><CodeLine lineNumber="3214"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// No need to check the instruction defining VNI for reads.</span></CodeLine>
<Link id="l03215" /><CodeLine lineNumber="3215"><span class="doxyHighlight">        ++<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>;</span></CodeLine>
<Link id="l03216" /><CodeLine lineNumber="3216"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03217" /><CodeLine lineNumber="3217"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03218" /><CodeLine lineNumber="3218"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/classes/llvm/slotindex/#a0b73244049319d841fd11a238f35b5d1">SlotIndex::isSameInstr</a>(VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>, TaintExtent.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>().first) &amp;&amp;</span></CodeLine>
<Link id="l03219" /><CodeLine lineNumber="3219"><span class="doxyHighlight">           </span><span class="doxyHighlightStringLiteral">&quot;Interference ends on VNI-&gt;def. Should have been handled earlier&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03220" /><CodeLine lineNumber="3220"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;LastMI =</span></CodeLine>
<Link id="l03221" /><CodeLine lineNumber="3221"><span class="doxyHighlight">        Indexes-&gt;getInstructionFromIndex(TaintExtent.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a58dc840fc84420b7f0b773794b8101c1">front</a>().first);</span></CodeLine>
<Link id="l03222" /><CodeLine lineNumber="3222"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LastMI &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Range must end at a proper instruction&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03223" /><CodeLine lineNumber="3223"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> TaintNum = 0;</span></CodeLine>
<Link id="l03224" /><CodeLine lineNumber="3224"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l03225" /><CodeLine lineNumber="3225"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> != <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;end() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Bad LastMI&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03226" /><CodeLine lineNumber="3226"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (usesLanes(&#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Reg, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.SubIdx, TaintedLanes)) &#123;</span></CodeLine>
<Link id="l03227" /><CodeLine lineNumber="3227"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\ttainted lanes used by: &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l03228" /><CodeLine lineNumber="3228"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03229" /><CodeLine lineNumber="3229"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03230" /><CodeLine lineNumber="3230"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// LastMI is the last instruction to use the current value.</span></CodeLine>
<Link id="l03231" /><CodeLine lineNumber="3231"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&amp;&#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> == LastMI) &#123;</span></CodeLine>
<Link id="l03232" /><CodeLine lineNumber="3232"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (++TaintNum == TaintExtent.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>())</span></CodeLine>
<Link id="l03233" /><CodeLine lineNumber="3233"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03234" /><CodeLine lineNumber="3234"><span class="doxyHighlight">        LastMI = Indexes-&gt;getInstructionFromIndex(TaintExtent&#91;TaintNum&#93;.first);</span></CodeLine>
<Link id="l03235" /><CodeLine lineNumber="3235"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LastMI &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Range must end at a proper instruction&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03236" /><CodeLine lineNumber="3236"><span class="doxyHighlight">        TaintedLanes = TaintExtent&#91;TaintNum&#93;.second;</span></CodeLine>
<Link id="l03237" /><CodeLine lineNumber="3237"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03238" /><CodeLine lineNumber="3238"><span class="doxyHighlight">      ++<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>;</span></CodeLine>
<Link id="l03239" /><CodeLine lineNumber="3239"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03240" /><CodeLine lineNumber="3240"></CodeLine>
<Link id="l03241" /><CodeLine lineNumber="3241"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The tainted lanes are unused.</span></CodeLine>
<Link id="l03242" /><CodeLine lineNumber="3242"><span class="doxyHighlight">    V.Resolution = <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca191f458a9d415a178a901a75baa4bd0e">CR&#95;Replace</a>;</span></CodeLine>
<Link id="l03243" /><CodeLine lineNumber="3243"><span class="doxyHighlight">    ++NumLaneResolves;</span></CodeLine>
<Link id="l03244" /><CodeLine lineNumber="3244"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03245" /><CodeLine lineNumber="3245"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03246" /><CodeLine lineNumber="3246"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03247" /><CodeLine lineNumber="3247"></CodeLine>
<Link id="l03248" /><CodeLine lineNumber="3248"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> JoinVals::isPrunedValue(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValNo, <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>) &#123;</span></CodeLine>
<Link id="l03249" /><CodeLine lineNumber="3249"><span class="doxyHighlight">  Val &amp;V = Vals&#91;ValNo&#93;;</span></CodeLine>
<Link id="l03250" /><CodeLine lineNumber="3250"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (V.Pruned || V.PrunedComputed)</span></CodeLine>
<Link id="l03251" /><CodeLine lineNumber="3251"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> V.Pruned;</span></CodeLine>
<Link id="l03252" /><CodeLine lineNumber="3252"></CodeLine>
<Link id="l03253" /><CodeLine lineNumber="3253"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (V.Resolution != CR&#95;Erase &amp;&amp; V.Resolution != CR&#95;Merge)</span></CodeLine>
<Link id="l03254" /><CodeLine lineNumber="3254"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> V.Pruned;</span></CodeLine>
<Link id="l03255" /><CodeLine lineNumber="3255"></CodeLine>
<Link id="l03256" /><CodeLine lineNumber="3256"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Follow copies up the dominator tree and check if any intermediate value</span></CodeLine>
<Link id="l03257" /><CodeLine lineNumber="3257"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// has been pruned.</span></CodeLine>
<Link id="l03258" /><CodeLine lineNumber="3258"><span class="doxyHighlight">  V.PrunedComputed = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03259" /><CodeLine lineNumber="3259"><span class="doxyHighlight">  V.Pruned = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.isPrunedValue(V.OtherVNI-&gt;id, &#42;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03260" /><CodeLine lineNumber="3260"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> V.Pruned;</span></CodeLine>
<Link id="l03261" /><CodeLine lineNumber="3261"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03262" /><CodeLine lineNumber="3262"></CodeLine>
<Link id="l03263" /><CodeLine lineNumber="3263" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#aa3fe888e13e687c808085c0cfba933c3"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#aa3fe888e13e687c808085c0cfba933c3">JoinVals::pruneValues</a>(<a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a5bdb429abc9cabb96a3c3df03e53e2ea">JoinVals</a> &amp;<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>,</span></CodeLine>
<Link id="l03264" /><CodeLine lineNumber="3264"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;SlotIndex&gt;</a> &amp;EndPoints,</span></CodeLine>
<Link id="l03265" /><CodeLine lineNumber="3265"><span class="doxyHighlight">                           </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> changeInstrs) &#123;</span></CodeLine>
<Link id="l03266" /><CodeLine lineNumber="3266"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = LR.<a href="/docs/api/classes/llvm/liverange/#a93450063916ca1ab1f11bf3304a6ad03">getNumValNums</a>(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l03267" /><CodeLine lineNumber="3267"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> Def = LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(i)-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>;</span></CodeLine>
<Link id="l03268" /><CodeLine lineNumber="3268"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (Vals&#91;i&#93;.Resolution) &#123;</span></CodeLine>
<Link id="l03269" /><CodeLine lineNumber="3269"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73">CR&#95;Keep</a>:</span></CodeLine>
<Link id="l03270" /><CodeLine lineNumber="3270"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03271" /><CodeLine lineNumber="3271"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca191f458a9d415a178a901a75baa4bd0e">CR&#95;Replace</a>: &#123;</span></CodeLine>
<Link id="l03272" /><CodeLine lineNumber="3272"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// This value takes precedence over the value in Other.LR.</span></CodeLine>
<Link id="l03273" /><CodeLine lineNumber="3273"><span class="doxyHighlight">      LIS-&gt;pruneValue(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.LR, Def, &amp;EndPoints);</span></CodeLine>
<Link id="l03274" /><CodeLine lineNumber="3274"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Check if we&#39;re replacing an IMPLICIT&#95;DEF value. The IMPLICIT&#95;DEF</span></CodeLine>
<Link id="l03275" /><CodeLine lineNumber="3275"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// instructions are only inserted to provide a live-out value for PHI</span></CodeLine>
<Link id="l03276" /><CodeLine lineNumber="3276"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// predecessors, so the instruction should simply go away once its value</span></CodeLine>
<Link id="l03277" /><CodeLine lineNumber="3277"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// has been replaced.</span></CodeLine>
<Link id="l03278" /><CodeLine lineNumber="3278"><span class="doxyHighlight">      Val &amp;OtherV = <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Vals&#91;Vals&#91;i&#93;.OtherVNI-&gt;id&#93;;</span></CodeLine>
<Link id="l03279" /><CodeLine lineNumber="3279"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> EraseImpDef =</span></CodeLine>
<Link id="l03280" /><CodeLine lineNumber="3280"><span class="doxyHighlight">          OtherV.ErasableImplicitDef &amp;&amp; OtherV.Resolution == <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73">CR&#95;Keep</a>;</span></CodeLine>
<Link id="l03281" /><CodeLine lineNumber="3281"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Def.isBlock()) &#123;</span></CodeLine>
<Link id="l03282" /><CodeLine lineNumber="3282"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (changeInstrs) &#123;</span></CodeLine>
<Link id="l03283" /><CodeLine lineNumber="3283"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Remove &lt;def,read-undef&gt; flags. This def is now a partial redef.</span></CodeLine>
<Link id="l03284" /><CodeLine lineNumber="3284"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Also remove dead flags since the joined live range will</span></CodeLine>
<Link id="l03285" /><CodeLine lineNumber="3285"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// continue past this instruction.</span></CodeLine>
<Link id="l03286" /><CodeLine lineNumber="3286"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO :</span></CodeLine>
<Link id="l03287" /><CodeLine lineNumber="3287"><span class="doxyHighlight">               Indexes-&gt;getInstructionFromIndex(Def)-&gt;all&#95;defs()) &#123;</span></CodeLine>
<Link id="l03288" /><CodeLine lineNumber="3288"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() == <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &#123;</span></CodeLine>
<Link id="l03289" /><CodeLine lineNumber="3289"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a028a8c5113d40d8c3f4427053bf36738">getSubReg</a>() != 0 &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#a1255befbcd6e034394681b1bcd3529ff">isUndef</a>() &amp;&amp; !EraseImpDef)</span></CodeLine>
<Link id="l03290" /><CodeLine lineNumber="3290"><span class="doxyHighlight">                MO.<a href="/docs/api/classes/llvm/machineoperand/#ab979122f21b7fa46d3d2d9b21983068b">setIsUndef</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03291" /><CodeLine lineNumber="3291"><span class="doxyHighlight">              MO.<a href="/docs/api/classes/llvm/machineoperand/#a61a42c85bd86c6ca4554e27d33c3f798">setIsDead</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03292" /><CodeLine lineNumber="3292"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l03293" /><CodeLine lineNumber="3293"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l03294" /><CodeLine lineNumber="3294"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03295" /><CodeLine lineNumber="3295"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// This value will reach instructions below, but we need to make sure</span></CodeLine>
<Link id="l03296" /><CodeLine lineNumber="3296"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// the live range also reaches the instruction at Def.</span></CodeLine>
<Link id="l03297" /><CodeLine lineNumber="3297"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!EraseImpDef)</span></CodeLine>
<Link id="l03298" /><CodeLine lineNumber="3298"><span class="doxyHighlight">          EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Def);</span></CodeLine>
<Link id="l03299" /><CodeLine lineNumber="3299"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03300" /><CodeLine lineNumber="3300"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tpruned &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.Reg) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; at &quot;</span><span class="doxyHighlight"> &lt;&lt; Def</span></CodeLine>
<Link id="l03301" /><CodeLine lineNumber="3301"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;: &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>.LR &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03302" /><CodeLine lineNumber="3302"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03303" /><CodeLine lineNumber="3303"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03304" /><CodeLine lineNumber="3304"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d">CR&#95;Erase</a>:</span></CodeLine>
<Link id="l03305" /><CodeLine lineNumber="3305"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca58561957307c3721aad71b897e448647">CR&#95;Merge</a>:</span></CodeLine>
<Link id="l03306" /><CodeLine lineNumber="3306"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (isPrunedValue(i, <a href="/docs/api/namespaces/llvm/#a9eb4f5b98b70ee4fab9614ed58282c1fa6311ae17c1ee52b36e68aaf4ad066387">Other</a>)) &#123;</span></CodeLine>
<Link id="l03307" /><CodeLine lineNumber="3307"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// This value is ultimately a copy of a pruned value in LR or Other.LR.</span></CodeLine>
<Link id="l03308" /><CodeLine lineNumber="3308"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We can no longer trust the value mapping computed by</span></CodeLine>
<Link id="l03309" /><CodeLine lineNumber="3309"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// computeAssignment(), the value that was originally copied could have</span></CodeLine>
<Link id="l03310" /><CodeLine lineNumber="3310"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// been replaced.</span></CodeLine>
<Link id="l03311" /><CodeLine lineNumber="3311"><span class="doxyHighlight">        LIS-&gt;pruneValue(LR, Def, &amp;EndPoints);</span></CodeLine>
<Link id="l03312" /><CodeLine lineNumber="3312"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tpruned all of &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; at &quot;</span></CodeLine>
<Link id="l03313" /><CodeLine lineNumber="3313"><span class="doxyHighlight">                          &lt;&lt; Def &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;: &quot;</span><span class="doxyHighlight"> &lt;&lt; LR &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03314" /><CodeLine lineNumber="3314"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03315" /><CodeLine lineNumber="3315"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03316" /><CodeLine lineNumber="3316"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cabd7e0ab4ddda4ab7abfdc4077f6d8a50">CR&#95;Unresolved</a>:</span></CodeLine>
<Link id="l03317" /><CodeLine lineNumber="3317"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cadf133404fe2559cd68f16253fac30869">CR&#95;Impossible</a>:</span></CodeLine>
<Link id="l03318" /><CodeLine lineNumber="3318"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</span><span class="doxyHighlightStringLiteral">&quot;Unresolved conflicts&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03319" /><CodeLine lineNumber="3319"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03320" /><CodeLine lineNumber="3320"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03321" /><CodeLine lineNumber="3321"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03322" /><CodeLine lineNumber="3322"></CodeLine>
<Link id="l03323" /><CodeLine lineNumber="3323"><span class="doxyHighlightComment">// Check if the segment consists of a copied live-through value (i.e. the copy</span></CodeLine>
<Link id="l03324" /><CodeLine lineNumber="3324"><span class="doxyHighlightComment">// in the block only extended the liveness, of an undef value which we may need</span></CodeLine>
<Link id="l03325" /><CodeLine lineNumber="3325"><span class="doxyHighlightComment">// to handle).</span></CodeLine>
<Link id="l03326" /><CodeLine lineNumber="3326" lineLink="#a643bfbd7372690fe71cc63171a3219bf"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a643bfbd7372690fe71cc63171a3219bf">isLiveThrough</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> Q) &#123;</span></CodeLine>
<Link id="l03327" /><CodeLine lineNumber="3327"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Q.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>() &amp;&amp; Q.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>()-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>() &amp;&amp; Q.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>() == Q.<a href="/docs/api/classes/llvm/livequeryresult/#a8c9627b7e8bbfa4fbd02f6644907147f">valueOut</a>();</span></CodeLine>
<Link id="l03328" /><CodeLine lineNumber="3328"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03329" /><CodeLine lineNumber="3329"></CodeLine>
<Link id="l03330" /><CodeLine lineNumber="3330"><span class="doxyHighlightComment">/// Consider the following situation when coalescing the copy between</span></CodeLine>
<Link id="l03331" /><CodeLine lineNumber="3331"><span class="doxyHighlightComment">/// %31 and %45 at 800 (The vertical lines represent live range segments.)</span></CodeLine>
<Link id="l03332" /><CodeLine lineNumber="3332"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03333" /><CodeLine lineNumber="3333"><span class="doxyHighlightComment">///                              Main range         Subrange 4 (sub2)</span></CodeLine>
<Link id="l03334" /><CodeLine lineNumber="3334"><span class="doxyHighlightComment">///                              %31    %45           %31    %45</span></CodeLine>
<Link id="l03335" /><CodeLine lineNumber="3335"><span class="doxyHighlightComment">///  544    %45 = COPY %28               +                    +</span></CodeLine>
<Link id="l03336" /><CodeLine lineNumber="3336"><span class="doxyHighlightComment">///                                      | v1                 | v1</span></CodeLine>
<Link id="l03337" /><CodeLine lineNumber="3337"><span class="doxyHighlightComment">///  560B bb.1:                          +                    +</span></CodeLine>
<Link id="l03338" /><CodeLine lineNumber="3338"><span class="doxyHighlightComment">///  624        = %45.sub2               | v2                 | v2</span></CodeLine>
<Link id="l03339" /><CodeLine lineNumber="3339"><span class="doxyHighlightComment">///  800    %31 = COPY %45        +      +             +      +</span></CodeLine>
<Link id="l03340" /><CodeLine lineNumber="3340"><span class="doxyHighlightComment">///                               | v0                 | v0</span></CodeLine>
<Link id="l03341" /><CodeLine lineNumber="3341"><span class="doxyHighlightComment">///  816    %31.sub1 = ...        +                    |</span></CodeLine>
<Link id="l03342" /><CodeLine lineNumber="3342"><span class="doxyHighlightComment">///  880    %30 = COPY %31        | v1                 +</span></CodeLine>
<Link id="l03343" /><CodeLine lineNumber="3343"><span class="doxyHighlightComment">///  928    %45 = COPY %30        |      +                    +</span></CodeLine>
<Link id="l03344" /><CodeLine lineNumber="3344"><span class="doxyHighlightComment">///                               |      | v0                 | v0  &lt;--+</span></CodeLine>
<Link id="l03345" /><CodeLine lineNumber="3345"><span class="doxyHighlightComment">///  992B   ; backedge -&gt; bb.1    |      +                    +        |</span></CodeLine>
<Link id="l03346" /><CodeLine lineNumber="3346"><span class="doxyHighlightComment">/// 1040        = %31.sub0        +                                    |</span></CodeLine>
<Link id="l03347" /><CodeLine lineNumber="3347"><span class="doxyHighlightComment">///                                                 This value must remain</span></CodeLine>
<Link id="l03348" /><CodeLine lineNumber="3348"><span class="doxyHighlightComment">///                                                 live-out!</span></CodeLine>
<Link id="l03349" /><CodeLine lineNumber="3349"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03350" /><CodeLine lineNumber="3350"><span class="doxyHighlightComment">/// Assuming that %31 is coalesced into %45, the copy at 928 becomes</span></CodeLine>
<Link id="l03351" /><CodeLine lineNumber="3351"><span class="doxyHighlightComment">/// redundant, since it copies the value from %45 back into it. The</span></CodeLine>
<Link id="l03352" /><CodeLine lineNumber="3352"><span class="doxyHighlightComment">/// conflict resolution for the main range determines that %45.v0 is</span></CodeLine>
<Link id="l03353" /><CodeLine lineNumber="3353"><span class="doxyHighlightComment">/// to be erased, which is ok since %31.v1 is identical to it.</span></CodeLine>
<Link id="l03354" /><CodeLine lineNumber="3354"><span class="doxyHighlightComment">/// The problem happens with the subrange for sub2: it has to be live</span></CodeLine>
<Link id="l03355" /><CodeLine lineNumber="3355"><span class="doxyHighlightComment">/// on exit from the block, but since 928 was actually a point of</span></CodeLine>
<Link id="l03356" /><CodeLine lineNumber="3356"><span class="doxyHighlightComment">/// definition of %45.sub2, %45.sub2 was not live immediately prior</span></CodeLine>
<Link id="l03357" /><CodeLine lineNumber="3357"><span class="doxyHighlightComment">/// to that definition. As a result, when 928 was erased, the value v0</span></CodeLine>
<Link id="l03358" /><CodeLine lineNumber="3358"><span class="doxyHighlightComment">/// for %45.sub2 was pruned in pruneSubRegValues. Consequently, an</span></CodeLine>
<Link id="l03359" /><CodeLine lineNumber="3359"><span class="doxyHighlightComment">/// IMPLICIT&#95;DEF was inserted as a &quot;backedge&quot; definition for %45.sub2,</span></CodeLine>
<Link id="l03360" /><CodeLine lineNumber="3360"><span class="doxyHighlightComment">/// providing an incorrect value to the use at 624</span></CodeLine>
<Link id="l03361" /><CodeLine lineNumber="3361"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03362" /><CodeLine lineNumber="3362"><span class="doxyHighlightComment">/// Since the main-range values %31.v1 and %45.v0 were proved to be</span></CodeLine>
<Link id="l03363" /><CodeLine lineNumber="3363"><span class="doxyHighlightComment">/// identical, the corresponding values in subranges must also be the</span></CodeLine>
<Link id="l03364" /><CodeLine lineNumber="3364"><span class="doxyHighlightComment">/// same. A redundant copy is removed because it&#39;s not needed, and not</span></CodeLine>
<Link id="l03365" /><CodeLine lineNumber="3365"><span class="doxyHighlightComment">/// because it copied an undefined value, so any liveness that originated</span></CodeLine>
<Link id="l03366" /><CodeLine lineNumber="3366"><span class="doxyHighlightComment">/// from that copy cannot disappear. When pruning a value that started</span></CodeLine>
<Link id="l03367" /><CodeLine lineNumber="3367"><span class="doxyHighlightComment">/// at the removed copy, the corresponding identical value must be</span></CodeLine>
<Link id="l03368" /><CodeLine lineNumber="3368"><span class="doxyHighlightComment">/// extended to replace it.</span></CodeLine>
<Link id="l03369" /><CodeLine lineNumber="3369" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a3730642a8860945b6ca5ca954a238592"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a3730642a8860945b6ca5ca954a238592">JoinVals::pruneSubRegValues</a>(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI, <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> &amp;ShrinkMask) &#123;</span></CodeLine>
<Link id="l03370" /><CodeLine lineNumber="3370"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Look for values being erased.</span></CodeLine>
<Link id="l03371" /><CodeLine lineNumber="3371"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> DidPrune = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03372" /><CodeLine lineNumber="3372"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = LR.<a href="/docs/api/classes/llvm/liverange/#a93450063916ca1ab1f11bf3304a6ad03">getNumValNums</a>(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l03373" /><CodeLine lineNumber="3373"><span class="doxyHighlight">    Val &amp;V = Vals&#91;i&#93;;</span></CodeLine>
<Link id="l03374" /><CodeLine lineNumber="3374"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We should trigger in all cases in which eraseInstrs() does something.</span></CodeLine>
<Link id="l03375" /><CodeLine lineNumber="3375"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// match what eraseInstrs() is doing, print a message so</span></CodeLine>
<Link id="l03376" /><CodeLine lineNumber="3376"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (V.Resolution != <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d">CR&#95;Erase</a> &amp;&amp;</span></CodeLine>
<Link id="l03377" /><CodeLine lineNumber="3377"><span class="doxyHighlight">        (V.Resolution != <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73">CR&#95;Keep</a> || !V.ErasableImplicitDef || !V.Pruned))</span></CodeLine>
<Link id="l03378" /><CodeLine lineNumber="3378"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03379" /><CodeLine lineNumber="3379"></CodeLine>
<Link id="l03380" /><CodeLine lineNumber="3380"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check subranges at the point where the copy will be removed.</span></CodeLine>
<Link id="l03381" /><CodeLine lineNumber="3381"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> Def = LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(i)-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>;</span></CodeLine>
<Link id="l03382" /><CodeLine lineNumber="3382"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> OtherDef;</span></CodeLine>
<Link id="l03383" /><CodeLine lineNumber="3383"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (V.Identical)</span></CodeLine>
<Link id="l03384" /><CodeLine lineNumber="3384"><span class="doxyHighlight">      OtherDef = V.OtherVNI-&gt;def;</span></CodeLine>
<Link id="l03385" /><CodeLine lineNumber="3385"></CodeLine>
<Link id="l03386" /><CodeLine lineNumber="3386"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Print message so mismatches with eraseInstrs() can be diagnosed.</span></CodeLine>
<Link id="l03387" /><CodeLine lineNumber="3387"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tExpecting instruction removal at &quot;</span><span class="doxyHighlight"> &lt;&lt; Def</span></CodeLine>
<Link id="l03388" /><CodeLine lineNumber="3388"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03389" /><CodeLine lineNumber="3389"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : LI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l03390" /><CodeLine lineNumber="3390"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/livequeryresult">LiveQueryResult</a> Q = S.Query(Def);</span></CodeLine>
<Link id="l03391" /><CodeLine lineNumber="3391"></CodeLine>
<Link id="l03392" /><CodeLine lineNumber="3392"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If a subrange starts at the copy then an undefined value has been</span></CodeLine>
<Link id="l03393" /><CodeLine lineNumber="3393"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// copied and we must remove that subrange value as well.</span></CodeLine>
<Link id="l03394" /><CodeLine lineNumber="3394"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;ValueOut = Q.<a href="/docs/api/classes/llvm/livequeryresult/#a001d69b0b75e2841cc109cbe8729ba87">valueOutOrDead</a>();</span></CodeLine>
<Link id="l03395" /><CodeLine lineNumber="3395"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValueOut != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> &amp;&amp;</span></CodeLine>
<Link id="l03396" /><CodeLine lineNumber="3396"><span class="doxyHighlight">          (Q.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>() == </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> ||</span></CodeLine>
<Link id="l03397" /><CodeLine lineNumber="3397"><span class="doxyHighlight">           (V.Identical &amp;&amp; V.Resolution == <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d">CR&#95;Erase</a> &amp;&amp; ValueOut-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> == Def))) &#123;</span></CodeLine>
<Link id="l03398" /><CodeLine lineNumber="3398"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tPrune sublane &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#a3e30e18d6f7ebd943eaf8ebc3a2b2930">PrintLaneMask</a>(S.LaneMask)</span></CodeLine>
<Link id="l03399" /><CodeLine lineNumber="3399"><span class="doxyHighlight">                          &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; at &quot;</span><span class="doxyHighlight"> &lt;&lt; Def &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03400" /><CodeLine lineNumber="3400"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;SlotIndex, 8&gt;</a> EndPoints;</span></CodeLine>
<Link id="l03401" /><CodeLine lineNumber="3401"><span class="doxyHighlight">        LIS-&gt;pruneValue(S, Def, &amp;EndPoints);</span></CodeLine>
<Link id="l03402" /><CodeLine lineNumber="3402"><span class="doxyHighlight">        DidPrune = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03403" /><CodeLine lineNumber="3403"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Mark value number as unused.</span></CodeLine>
<Link id="l03404" /><CodeLine lineNumber="3404"><span class="doxyHighlight">        ValueOut-&gt;<a href="/docs/api/classes/llvm/vninfo/#a81775e4a3dbcbc42d828c3e4becd9190">markUnused</a>();</span></CodeLine>
<Link id="l03405" /><CodeLine lineNumber="3405"></CodeLine>
<Link id="l03406" /><CodeLine lineNumber="3406"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (V.Identical &amp;&amp; S.Query(OtherDef).valueOutOrDead()) &#123;</span></CodeLine>
<Link id="l03407" /><CodeLine lineNumber="3407"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// If V is identical to V.OtherVNI (and S was live at OtherDef),</span></CodeLine>
<Link id="l03408" /><CodeLine lineNumber="3408"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// then we can&#39;t simply prune V from S. V needs to be replaced</span></CodeLine>
<Link id="l03409" /><CodeLine lineNumber="3409"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// with V.OtherVNI.</span></CodeLine>
<Link id="l03410" /><CodeLine lineNumber="3410"><span class="doxyHighlight">          LIS-&gt;extendToIndices(S, EndPoints);</span></CodeLine>
<Link id="l03411" /><CodeLine lineNumber="3411"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03412" /><CodeLine lineNumber="3412"></CodeLine>
<Link id="l03413" /><CodeLine lineNumber="3413"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We may need to eliminate the subrange if the copy introduced a live</span></CodeLine>
<Link id="l03414" /><CodeLine lineNumber="3414"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// out undef value.</span></CodeLine>
<Link id="l03415" /><CodeLine lineNumber="3415"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValueOut-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>())</span></CodeLine>
<Link id="l03416" /><CodeLine lineNumber="3416"><span class="doxyHighlight">          ShrinkMask |= S.LaneMask;</span></CodeLine>
<Link id="l03417" /><CodeLine lineNumber="3417"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03418" /><CodeLine lineNumber="3418"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03419" /><CodeLine lineNumber="3419"></CodeLine>
<Link id="l03420" /><CodeLine lineNumber="3420"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If a subrange ends at the copy, then a value was copied but only</span></CodeLine>
<Link id="l03421" /><CodeLine lineNumber="3421"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// partially used later. Shrink the subregister range appropriately.</span></CodeLine>
<Link id="l03422" /><CodeLine lineNumber="3422"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l03423" /><CodeLine lineNumber="3423"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Ultimately this calls shrinkToUses, so assuming ShrinkMask is</span></CodeLine>
<Link id="l03424" /><CodeLine lineNumber="3424"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// conservatively correct.</span></CodeLine>
<Link id="l03425" /><CodeLine lineNumber="3425"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((Q.<a href="/docs/api/classes/llvm/livequeryresult/#a527e4a21e13a8455c75eb0d811701066">valueIn</a>() != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> &amp;&amp; Q.<a href="/docs/api/classes/llvm/livequeryresult/#a8c9627b7e8bbfa4fbd02f6644907147f">valueOut</a>() == </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">) ||</span></CodeLine>
<Link id="l03426" /><CodeLine lineNumber="3426"><span class="doxyHighlight">          (V.Resolution == <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d">CR&#95;Erase</a> &amp;&amp; <a href="#a643bfbd7372690fe71cc63171a3219bf">isLiveThrough</a>(Q))) &#123;</span></CodeLine>
<Link id="l03427" /><CodeLine lineNumber="3427"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tDead uses at sublane &quot;</span></CodeLine>
<Link id="l03428" /><CodeLine lineNumber="3428"><span class="doxyHighlight">                          &lt;&lt; <a href="/docs/api/namespaces/llvm/#a3e30e18d6f7ebd943eaf8ebc3a2b2930">PrintLaneMask</a>(S.LaneMask) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; at &quot;</span><span class="doxyHighlight"> &lt;&lt; Def</span></CodeLine>
<Link id="l03429" /><CodeLine lineNumber="3429"><span class="doxyHighlight">                          &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03430" /><CodeLine lineNumber="3430"><span class="doxyHighlight">        ShrinkMask |= S.LaneMask;</span></CodeLine>
<Link id="l03431" /><CodeLine lineNumber="3431"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03432" /><CodeLine lineNumber="3432"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03433" /><CodeLine lineNumber="3433"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03434" /><CodeLine lineNumber="3434"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DidPrune)</span></CodeLine>
<Link id="l03435" /><CodeLine lineNumber="3435"><span class="doxyHighlight">    LI.<a href="/docs/api/classes/llvm/liveinterval/#a0aac3ef1eadaa206a70b767730ef3c5b">removeEmptySubRanges</a>();</span></CodeLine>
<Link id="l03436" /><CodeLine lineNumber="3436"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03437" /><CodeLine lineNumber="3437"></CodeLine>
<Link id="l03438" /><CodeLine lineNumber="3438"><span class="doxyHighlightComment">/// Check if any of the subranges of @p LI contain a definition at @p Def.</span></CodeLine>
<Link id="l03439" /><CodeLine lineNumber="3439" lineLink="#a557a8b6ef8191908ae0c534f76b9f782"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a557a8b6ef8191908ae0c534f76b9f782">isDefInSubRange</a>(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI, <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> Def) &#123;</span></CodeLine>
<Link id="l03440" /><CodeLine lineNumber="3440"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : LI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l03441" /><CodeLine lineNumber="3441"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI = SR.<a href="/docs/api/classes/llvm/liverange/#a6eb0e49d283729a5f8b99d4efa1be7c1">Query</a>(Def).<a href="/docs/api/classes/llvm/livequeryresult/#a001d69b0b75e2841cc109cbe8729ba87">valueOutOrDead</a>())</span></CodeLine>
<Link id="l03442" /><CodeLine lineNumber="3442"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a> == Def)</span></CodeLine>
<Link id="l03443" /><CodeLine lineNumber="3443"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03444" /><CodeLine lineNumber="3444"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03445" /><CodeLine lineNumber="3445"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03446" /><CodeLine lineNumber="3446"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03447" /><CodeLine lineNumber="3447"></CodeLine>
<Link id="l03448" /><CodeLine lineNumber="3448" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a1b3c2e77ef89dfcb6bc2129edc827264"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a1b3c2e77ef89dfcb6bc2129edc827264">JoinVals::pruneMainSegments</a>(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &amp;ShrinkMainRange) &#123;</span></CodeLine>
<Link id="l03449" /><CodeLine lineNumber="3449"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(&amp;</span><span class="doxyHighlightKeyword">static&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(LI) == &amp;LR);</span></CodeLine>
<Link id="l03450" /><CodeLine lineNumber="3450"></CodeLine>
<Link id="l03451" /><CodeLine lineNumber="3451"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = LR.<a href="/docs/api/classes/llvm/liverange/#a93450063916ca1ab1f11bf3304a6ad03">getNumValNums</a>(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l03452" /><CodeLine lineNumber="3452"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Vals&#91;i&#93;.Resolution != <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73">CR&#95;Keep</a>)</span></CodeLine>
<Link id="l03453" /><CodeLine lineNumber="3453"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03454" /><CodeLine lineNumber="3454"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI = LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(i);</span></CodeLine>
<Link id="l03455" /><CodeLine lineNumber="3455"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ab72366fd538f240cbb53dac39368cdfc">isUnused</a>() || VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae72fbcf51be7574c84817cde814df07e">isPHIDef</a>() || <a href="#a557a8b6ef8191908ae0c534f76b9f782">isDefInSubRange</a>(LI, VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>))</span></CodeLine>
<Link id="l03456" /><CodeLine lineNumber="3456"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03457" /><CodeLine lineNumber="3457"><span class="doxyHighlight">    Vals&#91;i&#93;.Pruned = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03458" /><CodeLine lineNumber="3458"><span class="doxyHighlight">    ShrinkMainRange = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03459" /><CodeLine lineNumber="3459"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03460" /><CodeLine lineNumber="3460"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03461" /><CodeLine lineNumber="3461"></CodeLine>
<Link id="l03462" /><CodeLine lineNumber="3462" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a8546f9a7fa0a18cfe46dc20582dcbed2"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a8546f9a7fa0a18cfe46dc20582dcbed2">JoinVals::removeImplicitDefs</a>() &#123;</span></CodeLine>
<Link id="l03463" /><CodeLine lineNumber="3463"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = LR.<a href="/docs/api/classes/llvm/liverange/#a93450063916ca1ab1f11bf3304a6ad03">getNumValNums</a>(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l03464" /><CodeLine lineNumber="3464"><span class="doxyHighlight">    Val &amp;V = Vals&#91;i&#93;;</span></CodeLine>
<Link id="l03465" /><CodeLine lineNumber="3465"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (V.Resolution != <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73">CR&#95;Keep</a> || !V.ErasableImplicitDef || !V.Pruned)</span></CodeLine>
<Link id="l03466" /><CodeLine lineNumber="3466"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03467" /><CodeLine lineNumber="3467"></CodeLine>
<Link id="l03468" /><CodeLine lineNumber="3468"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI = LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(i);</span></CodeLine>
<Link id="l03469" /><CodeLine lineNumber="3469"><span class="doxyHighlight">    VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#a81775e4a3dbcbc42d828c3e4becd9190">markUnused</a>();</span></CodeLine>
<Link id="l03470" /><CodeLine lineNumber="3470"><span class="doxyHighlight">    LR.<a href="/docs/api/classes/llvm/liverange/#a63176e601338dbe403676b86e78c7203">removeValNo</a>(VNI);</span></CodeLine>
<Link id="l03471" /><CodeLine lineNumber="3471"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03472" /><CodeLine lineNumber="3472"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03473" /><CodeLine lineNumber="3473"></CodeLine>
<Link id="l03474" /><CodeLine lineNumber="3474" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a1659a196eabbdd653b9a5d529ccfcb6e"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a1659a196eabbdd653b9a5d529ccfcb6e">JoinVals::eraseInstrs</a>(<a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineInstr &#42;&gt;</a> &amp;ErasedInstrs,</span></CodeLine>
<Link id="l03475" /><CodeLine lineNumber="3475"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;Register&gt;</a> &amp;ShrinkRegs,</span></CodeLine>
<Link id="l03476" /><CodeLine lineNumber="3476"><span class="doxyHighlight">                           <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &#42;LI) &#123;</span></CodeLine>
<Link id="l03477" /><CodeLine lineNumber="3477"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, e = LR.<a href="/docs/api/classes/llvm/liverange/#a93450063916ca1ab1f11bf3304a6ad03">getNumValNums</a>(); i != e; ++i) &#123;</span></CodeLine>
<Link id="l03478" /><CodeLine lineNumber="3478"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Get the def location before markUnused() below invalidates it.</span></CodeLine>
<Link id="l03479" /><CodeLine lineNumber="3479"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/vninfo">VNInfo</a> &#42;VNI = LR.<a href="/docs/api/classes/llvm/liverange/#a060100d6b75129bdef5516fac8f89a55">getValNumInfo</a>(i);</span></CodeLine>
<Link id="l03480" /><CodeLine lineNumber="3480"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> Def = VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#ae623a0f1ab59da851f2ebf1674d1fddb">def</a>;</span></CodeLine>
<Link id="l03481" /><CodeLine lineNumber="3481"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">switch</span><span class="doxyHighlight"> (Vals&#91;i&#93;.Resolution) &#123;</span></CodeLine>
<Link id="l03482" /><CodeLine lineNumber="3482"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73">CR&#95;Keep</a>: &#123;</span></CodeLine>
<Link id="l03483" /><CodeLine lineNumber="3483"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If an IMPLICIT&#95;DEF value is pruned, it doesn&#39;t serve a purpose any</span></CodeLine>
<Link id="l03484" /><CodeLine lineNumber="3484"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// longer. The IMPLICIT&#95;DEF instructions are only inserted by</span></CodeLine>
<Link id="l03485" /><CodeLine lineNumber="3485"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// PHIElimination to guarantee that all PHI predecessors have a value.</span></CodeLine>
<Link id="l03486" /><CodeLine lineNumber="3486"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Vals&#91;i&#93;.ErasableImplicitDef || !Vals&#91;i&#93;.Pruned)</span></CodeLine>
<Link id="l03487" /><CodeLine lineNumber="3487"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03488" /><CodeLine lineNumber="3488"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Remove value number i from LR.</span></CodeLine>
<Link id="l03489" /><CodeLine lineNumber="3489"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// For intervals with subranges, removing a segment from the main range</span></CodeLine>
<Link id="l03490" /><CodeLine lineNumber="3490"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// may require extending the previous segment: for each definition of</span></CodeLine>
<Link id="l03491" /><CodeLine lineNumber="3491"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// a subregister, there will be a corresponding def in the main range.</span></CodeLine>
<Link id="l03492" /><CodeLine lineNumber="3492"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// That def may fall in the middle of a segment from another subrange.</span></CodeLine>
<Link id="l03493" /><CodeLine lineNumber="3493"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// In such cases, removing this def from the main range must be</span></CodeLine>
<Link id="l03494" /><CodeLine lineNumber="3494"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// complemented by extending the main range to account for the liveness</span></CodeLine>
<Link id="l03495" /><CodeLine lineNumber="3495"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// of the other subrange.</span></CodeLine>
<Link id="l03496" /><CodeLine lineNumber="3496"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// The new end point of the main range segment to be extended.</span></CodeLine>
<Link id="l03497" /><CodeLine lineNumber="3497"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> NewEnd;</span></CodeLine>
<Link id="l03498" /><CodeLine lineNumber="3498"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LI != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l03499" /><CodeLine lineNumber="3499"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveRange::iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = LR.<a href="/docs/api/classes/llvm/liverange/#ae6eab1035db7ba328354fa739be090f0">FindSegmentContaining</a>(Def);</span></CodeLine>
<Link id="l03500" /><CodeLine lineNumber="3500"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> != LR.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>());</span></CodeLine>
<Link id="l03501" /><CodeLine lineNumber="3501"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Do not extend beyond the end of the segment being removed.</span></CodeLine>
<Link id="l03502" /><CodeLine lineNumber="3502"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// The segment may have been pruned in preparation for joining</span></CodeLine>
<Link id="l03503" /><CodeLine lineNumber="3503"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// live ranges.</span></CodeLine>
<Link id="l03504" /><CodeLine lineNumber="3504"><span class="doxyHighlight">        NewEnd = <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;end;</span></CodeLine>
<Link id="l03505" /><CodeLine lineNumber="3505"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03506" /><CodeLine lineNumber="3506"></CodeLine>
<Link id="l03507" /><CodeLine lineNumber="3507"><span class="doxyHighlight">      LR.<a href="/docs/api/classes/llvm/liverange/#a63176e601338dbe403676b86e78c7203">removeValNo</a>(VNI);</span></CodeLine>
<Link id="l03508" /><CodeLine lineNumber="3508"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Note that this VNInfo is reused and still referenced in NewVNInfo,</span></CodeLine>
<Link id="l03509" /><CodeLine lineNumber="3509"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// make it appear like an unused value number.</span></CodeLine>
<Link id="l03510" /><CodeLine lineNumber="3510"><span class="doxyHighlight">      VNI-&gt;<a href="/docs/api/classes/llvm/vninfo/#a81775e4a3dbcbc42d828c3e4becd9190">markUnused</a>();</span></CodeLine>
<Link id="l03511" /><CodeLine lineNumber="3511"></CodeLine>
<Link id="l03512" /><CodeLine lineNumber="3512"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LI != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight"> &amp;&amp; LI-&gt;<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l03513" /><CodeLine lineNumber="3513"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(</span><span class="doxyHighlightKeyword">static&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/liverange">LiveRange</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(LI) == &amp;LR);</span></CodeLine>
<Link id="l03514" /><CodeLine lineNumber="3514"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Determine the end point based on the subrange information:</span></CodeLine>
<Link id="l03515" /><CodeLine lineNumber="3515"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// minimum of (earliest def of next segment,</span></CodeLine>
<Link id="l03516" /><CodeLine lineNumber="3516"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//             latest end point of containing segment)</span></CodeLine>
<Link id="l03517" /><CodeLine lineNumber="3517"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> ED, LE;</span></CodeLine>
<Link id="l03518" /><CodeLine lineNumber="3518"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR : LI-&gt;<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l03519" /><CodeLine lineNumber="3519"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveRange::iterator</a> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = SR.<a href="/docs/api/classes/llvm/liverange/#afeb00b9049a2391c990df15692caef63">find</a>(Def);</span></CodeLine>
<Link id="l03520" /><CodeLine lineNumber="3520"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> == SR.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>())</span></CodeLine>
<Link id="l03521" /><CodeLine lineNumber="3521"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03522" /><CodeLine lineNumber="3522"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;start &gt; Def)</span></CodeLine>
<Link id="l03523" /><CodeLine lineNumber="3523"><span class="doxyHighlight">            ED = ED.<a href="/docs/api/classes/llvm/slotindex/#a5bcdd85778add4287db384472cde8acd">isValid</a>() ? std::min(ED, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;start) : <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;start;</span></CodeLine>
<Link id="l03524" /><CodeLine lineNumber="3524"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l03525" /><CodeLine lineNumber="3525"><span class="doxyHighlight">            LE = LE.isValid() ? std::max(LE, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;end) : <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>-&gt;end;</span></CodeLine>
<Link id="l03526" /><CodeLine lineNumber="3526"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03527" /><CodeLine lineNumber="3527"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LE.isValid())</span></CodeLine>
<Link id="l03528" /><CodeLine lineNumber="3528"><span class="doxyHighlight">          NewEnd = std::min(NewEnd, LE);</span></CodeLine>
<Link id="l03529" /><CodeLine lineNumber="3529"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ED.<a href="/docs/api/classes/llvm/slotindex/#a5bcdd85778add4287db384472cde8acd">isValid</a>())</span></CodeLine>
<Link id="l03530" /><CodeLine lineNumber="3530"><span class="doxyHighlight">          NewEnd = std::min(NewEnd, ED);</span></CodeLine>
<Link id="l03531" /><CodeLine lineNumber="3531"></CodeLine>
<Link id="l03532" /><CodeLine lineNumber="3532"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We only want to do the extension if there was a subrange that</span></CodeLine>
<Link id="l03533" /><CodeLine lineNumber="3533"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// was live across Def.</span></CodeLine>
<Link id="l03534" /><CodeLine lineNumber="3534"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LE.isValid()) &#123;</span></CodeLine>
<Link id="l03535" /><CodeLine lineNumber="3535"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/liverange/#a143c1fcb6066cb301f828ec4c18d79f4">LiveRange::iterator</a> S = LR.<a href="/docs/api/classes/llvm/liverange/#afeb00b9049a2391c990df15692caef63">find</a>(Def);</span></CodeLine>
<Link id="l03536" /><CodeLine lineNumber="3536"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (S != LR.<a href="/docs/api/classes/llvm/liverange/#a9a5e7c523f12f9f164b786769de1ca47">begin</a>())</span></CodeLine>
<Link id="l03537" /><CodeLine lineNumber="3537"><span class="doxyHighlight">            std::prev(S)-&gt;end = NewEnd;</span></CodeLine>
<Link id="l03538" /><CodeLine lineNumber="3538"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03539" /><CodeLine lineNumber="3539"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03540" /><CodeLine lineNumber="3540"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</span></CodeLine>
<Link id="l03541" /><CodeLine lineNumber="3541"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tremoved &quot;</span><span class="doxyHighlight"> &lt;&lt; i &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;@&#39;</span><span class="doxyHighlight"> &lt;&lt; Def &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;: &quot;</span><span class="doxyHighlight"> &lt;&lt; LR &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03542" /><CodeLine lineNumber="3542"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LI != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l03543" /><CodeLine lineNumber="3543"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\t  LHS = &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;LI &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03544" /><CodeLine lineNumber="3544"><span class="doxyHighlight">      &#125;);</span></CodeLine>
<Link id="l03545" /><CodeLine lineNumber="3545"><span class="doxyHighlight">      &#91;&#91;fallthrough&#93;&#93;;</span></CodeLine>
<Link id="l03546" /><CodeLine lineNumber="3546"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03547" /><CodeLine lineNumber="3547"></CodeLine>
<Link id="l03548" /><CodeLine lineNumber="3548"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">case</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d">CR&#95;Erase</a>: &#123;</span></CodeLine>
<Link id="l03549" /><CodeLine lineNumber="3549"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = Indexes-&gt;getInstructionFromIndex(Def);</span></CodeLine>
<Link id="l03550" /><CodeLine lineNumber="3550"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;No instruction to erase&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03551" /><CodeLine lineNumber="3551"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;isCopy()) &#123;</span></CodeLine>
<Link id="l03552" /><CodeLine lineNumber="3552"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;getOperand(1).getReg();</span></CodeLine>
<Link id="l03553" /><CodeLine lineNumber="3553"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>.isVirtual() &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> != CP.getSrcReg() &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> != CP.getDstReg())</span></CodeLine>
<Link id="l03554" /><CodeLine lineNumber="3554"><span class="doxyHighlight">          ShrinkRegs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l03555" /><CodeLine lineNumber="3555"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03556" /><CodeLine lineNumber="3556"><span class="doxyHighlight">      ErasedInstrs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l03557" /><CodeLine lineNumber="3557"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\terased:\\t&quot;</span><span class="doxyHighlight"> &lt;&lt; Def &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\t&#39;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l03558" /><CodeLine lineNumber="3558"><span class="doxyHighlight">      LIS-&gt;RemoveMachineInstrFromMaps(&#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l03559" /><CodeLine lineNumber="3559"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>-&gt;eraseFromParent();</span></CodeLine>
<Link id="l03560" /><CodeLine lineNumber="3560"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03561" /><CodeLine lineNumber="3561"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03562" /><CodeLine lineNumber="3562"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l03563" /><CodeLine lineNumber="3563"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03564" /><CodeLine lineNumber="3564"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03565" /><CodeLine lineNumber="3565"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03566" /><CodeLine lineNumber="3566"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03567" /><CodeLine lineNumber="3567"></CodeLine>
<Link id="l03568" /><CodeLine lineNumber="3568"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::joinSubRegRanges(<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;LRange, <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;RRange,</span></CodeLine>
<Link id="l03569" /><CodeLine lineNumber="3569"><span class="doxyHighlight">                                         <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> LaneMask,</span></CodeLine>
<Link id="l03570" /><CodeLine lineNumber="3570"><span class="doxyHighlight">                                         </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP) &#123;</span></CodeLine>
<Link id="l03571" /><CodeLine lineNumber="3571"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;VNInfo &#42;, 16&gt;</a> NewVNInfo;</span></CodeLine>
<Link id="l03572" /><CodeLine lineNumber="3572"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> RHSVals(RRange, CP.getSrcReg(), CP.getSrcIdx(), LaneMask, NewVNInfo,</span></CodeLine>
<Link id="l03573" /><CodeLine lineNumber="3573"><span class="doxyHighlight">                   CP, LIS, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03574" /><CodeLine lineNumber="3574"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals">JoinVals</a> LHSVals(LRange, CP.getDstReg(), CP.getDstIdx(), LaneMask, NewVNInfo,</span></CodeLine>
<Link id="l03575" /><CodeLine lineNumber="3575"><span class="doxyHighlight">                   CP, LIS, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03576" /><CodeLine lineNumber="3576"></CodeLine>
<Link id="l03577" /><CodeLine lineNumber="3577"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Compute NewVNInfo and resolve conflicts (see also joinVirtRegs())</span></CodeLine>
<Link id="l03578" /><CodeLine lineNumber="3578"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We should be able to resolve all conflicts here as we could successfully do</span></CodeLine>
<Link id="l03579" /><CodeLine lineNumber="3579"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// it on the mainrange already. There is however a problem when multiple</span></CodeLine>
<Link id="l03580" /><CodeLine lineNumber="3580"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ranges get mapped to the &quot;overflow&quot; lane mask bit which creates unexpected</span></CodeLine>
<Link id="l03581" /><CodeLine lineNumber="3581"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// interferences.</span></CodeLine>
<Link id="l03582" /><CodeLine lineNumber="3582"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LHSVals.mapValues(RHSVals) || !RHSVals.mapValues(LHSVals)) &#123;</span></CodeLine>
<Link id="l03583" /><CodeLine lineNumber="3583"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We already determined that it is legal to merge the intervals, so this</span></CodeLine>
<Link id="l03584" /><CodeLine lineNumber="3584"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// should never fail.</span></CodeLine>
<Link id="l03585" /><CodeLine lineNumber="3585"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</span><span class="doxyHighlightStringLiteral">&quot;&#42;&#42;&#42; Couldn&#39;t join subrange!\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03586" /><CodeLine lineNumber="3586"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03587" /><CodeLine lineNumber="3587"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LHSVals.resolveConflicts(RHSVals) ||</span></CodeLine>
<Link id="l03588" /><CodeLine lineNumber="3588"><span class="doxyHighlight">      !RHSVals.resolveConflicts(LHSVals)) &#123;</span></CodeLine>
<Link id="l03589" /><CodeLine lineNumber="3589"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We already determined that it is legal to merge the intervals, so this</span></CodeLine>
<Link id="l03590" /><CodeLine lineNumber="3590"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// should never fail.</span></CodeLine>
<Link id="l03591" /><CodeLine lineNumber="3591"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</span><span class="doxyHighlightStringLiteral">&quot;&#42;&#42;&#42; Couldn&#39;t join subrange!\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03592" /><CodeLine lineNumber="3592"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03593" /><CodeLine lineNumber="3593"></CodeLine>
<Link id="l03594" /><CodeLine lineNumber="3594"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The merging algorithm in LiveInterval::join() can&#39;t handle conflicting</span></CodeLine>
<Link id="l03595" /><CodeLine lineNumber="3595"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value mappings, so we need to remove any live ranges that overlap a</span></CodeLine>
<Link id="l03596" /><CodeLine lineNumber="3596"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CR&#95;Replace resolution. Collect a set of end points that can be used to</span></CodeLine>
<Link id="l03597" /><CodeLine lineNumber="3597"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// restore the live range after joining.</span></CodeLine>
<Link id="l03598" /><CodeLine lineNumber="3598"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;SlotIndex, 8&gt;</a> EndPoints;</span></CodeLine>
<Link id="l03599" /><CodeLine lineNumber="3599"><span class="doxyHighlight">  LHSVals.pruneValues(RHSVals, EndPoints, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03600" /><CodeLine lineNumber="3600"><span class="doxyHighlight">  RHSVals.pruneValues(LHSVals, EndPoints, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03601" /><CodeLine lineNumber="3601"></CodeLine>
<Link id="l03602" /><CodeLine lineNumber="3602"><span class="doxyHighlight">  LHSVals.removeImplicitDefs();</span></CodeLine>
<Link id="l03603" /><CodeLine lineNumber="3603"><span class="doxyHighlight">  RHSVals.removeImplicitDefs();</span></CodeLine>
<Link id="l03604" /><CodeLine lineNumber="3604"></CodeLine>
<Link id="l03605" /><CodeLine lineNumber="3605"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LRange.<a href="/docs/api/classes/llvm/liverange/#a84d7fba74d57269f494283490fd93439">verify</a>() &amp;&amp; RRange.<a href="/docs/api/classes/llvm/liverange/#a84d7fba74d57269f494283490fd93439">verify</a>());</span></CodeLine>
<Link id="l03606" /><CodeLine lineNumber="3606"></CodeLine>
<Link id="l03607" /><CodeLine lineNumber="3607"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Join RRange into LHS.</span></CodeLine>
<Link id="l03608" /><CodeLine lineNumber="3608"><span class="doxyHighlight">  LRange.<a href="/docs/api/classes/llvm/liverange/#a2b10543d5f749956dd408fd7ebb3c552">join</a>(RRange, LHSVals.getAssignments(), RHSVals.getAssignments(),</span></CodeLine>
<Link id="l03609" /><CodeLine lineNumber="3609"><span class="doxyHighlight">              NewVNInfo);</span></CodeLine>
<Link id="l03610" /><CodeLine lineNumber="3610"></CodeLine>
<Link id="l03611" /><CodeLine lineNumber="3611"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tjoined lanes: &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#a3e30e18d6f7ebd943eaf8ebc3a2b2930">PrintLaneMask</a>(LaneMask) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39; &#39;</span></CodeLine>
<Link id="l03612" /><CodeLine lineNumber="3612"><span class="doxyHighlight">                    &lt;&lt; LRange &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03613" /><CodeLine lineNumber="3613"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</span></CodeLine>
<Link id="l03614" /><CodeLine lineNumber="3614"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03615" /><CodeLine lineNumber="3615"></CodeLine>
<Link id="l03616" /><CodeLine lineNumber="3616"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Recompute the parts of the live range we had to remove because of</span></CodeLine>
<Link id="l03617" /><CodeLine lineNumber="3617"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CR&#95;Replace conflicts.</span></CodeLine>
<Link id="l03618" /><CodeLine lineNumber="3618"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</span></CodeLine>
<Link id="l03619" /><CodeLine lineNumber="3619"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\trestoring liveness to &quot;</span><span class="doxyHighlight"> &lt;&lt; EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; points: &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03620" /><CodeLine lineNumber="3620"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, n = EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>(); i != n; ++i) &#123;</span></CodeLine>
<Link id="l03621" /><CodeLine lineNumber="3621"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; EndPoints&#91;i&#93;;</span></CodeLine>
<Link id="l03622" /><CodeLine lineNumber="3622"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i != n - 1)</span></CodeLine>
<Link id="l03623" /><CodeLine lineNumber="3623"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;,&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03624" /><CodeLine lineNumber="3624"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03625" /><CodeLine lineNumber="3625"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;:  &quot;</span><span class="doxyHighlight"> &lt;&lt; LRange &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03626" /><CodeLine lineNumber="3626"><span class="doxyHighlight">  &#125;);</span></CodeLine>
<Link id="l03627" /><CodeLine lineNumber="3627"><span class="doxyHighlight">  LIS-&gt;extendToIndices(LRange, EndPoints);</span></CodeLine>
<Link id="l03628" /><CodeLine lineNumber="3628"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03629" /><CodeLine lineNumber="3629"></CodeLine>
<Link id="l03630" /><CodeLine lineNumber="3630"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::mergeSubRangeInto(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI,</span></CodeLine>
<Link id="l03631" /><CodeLine lineNumber="3631"><span class="doxyHighlight">                                          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;ToMerge,</span></CodeLine>
<Link id="l03632" /><CodeLine lineNumber="3632"><span class="doxyHighlight">                                          <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> LaneMask,</span></CodeLine>
<Link id="l03633" /><CodeLine lineNumber="3633"><span class="doxyHighlight">                                          <a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP,</span></CodeLine>
<Link id="l03634" /><CodeLine lineNumber="3634"><span class="doxyHighlight">                                          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ComposeSubRegIdx) &#123;</span></CodeLine>
<Link id="l03635" /><CodeLine lineNumber="3635"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8e612822d4ba7bb36c9c79582a567108">BumpPtrAllocator</a> &amp;<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a> = LIS-&gt;getVNInfoAllocator();</span></CodeLine>
<Link id="l03636" /><CodeLine lineNumber="3636"><span class="doxyHighlight">  LI.<a href="/docs/api/classes/llvm/liveinterval/#a967540f5e5799b56c6fbcee378d110eb">refineSubRanges</a>(</span></CodeLine>
<Link id="l03637" /><CodeLine lineNumber="3637"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, LaneMask,</span></CodeLine>
<Link id="l03638" /><CodeLine lineNumber="3638"><span class="doxyHighlight">      &#91;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">, &amp;<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, &amp;ToMerge, &amp;CP&#93;(<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;SR) &#123;</span></CodeLine>
<Link id="l03639" /><CodeLine lineNumber="3639"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SR.<a href="/docs/api/classes/llvm/liverange/#a66ff664a97cd3c30de7e873335a0c075">empty</a>()) &#123;</span></CodeLine>
<Link id="l03640" /><CodeLine lineNumber="3640"><span class="doxyHighlight">          SR.<a href="/docs/api/classes/llvm/liverange/#ae7eb95d6c78b269fe03ed9c78cf2c33f">assign</a>(ToMerge, <a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>);</span></CodeLine>
<Link id="l03641" /><CodeLine lineNumber="3641"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03642" /><CodeLine lineNumber="3642"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// joinSubRegRange() destroys the merged range, so we need a copy.</span></CodeLine>
<Link id="l03643" /><CodeLine lineNumber="3643"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/liverange">LiveRange</a> RangeCopy(ToMerge, <a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>);</span></CodeLine>
<Link id="l03644" /><CodeLine lineNumber="3644"><span class="doxyHighlight">          joinSubRegRanges(SR, RangeCopy, SR.<a href="/docs/api/classes/llvm/liveinterval/subrange/#a8dab9096ed829f13c573a282e5723f62">LaneMask</a>, CP);</span></CodeLine>
<Link id="l03645" /><CodeLine lineNumber="3645"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03646" /><CodeLine lineNumber="3646"><span class="doxyHighlight">      &#125;,</span></CodeLine>
<Link id="l03647" /><CodeLine lineNumber="3647"><span class="doxyHighlight">      &#42;LIS-&gt;getSlotIndexes(), &#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, ComposeSubRegIdx);</span></CodeLine>
<Link id="l03648" /><CodeLine lineNumber="3648"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03649" /><CodeLine lineNumber="3649"></CodeLine>
<Link id="l03650" /><CodeLine lineNumber="3650"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::isHighCostLiveInterval(<a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI) &#123;</span></CodeLine>
<Link id="l03651" /><CodeLine lineNumber="3651"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LI.<a href="/docs/api/classes/llvm/liverange/#a9eb4aa155c41e60dff42f4e741a0dcf0">valnos</a>.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() &lt; <a href="#a4b2129a58164949cdd06be96232abbd3">LargeIntervalSizeThreshold</a>)</span></CodeLine>
<Link id="l03652" /><CodeLine lineNumber="3652"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03653" /><CodeLine lineNumber="3653"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Counter = LargeLIVisitCounter&#91;LI.<a href="/docs/api/classes/llvm/liveinterval/#a14d46e70db7e417c8ed5bc66fb295185">reg</a>()&#93;;</span></CodeLine>
<Link id="l03654" /><CodeLine lineNumber="3654"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Counter &lt; <a href="#abb9db777c3bf00bfbc614a1f0539fb04">LargeIntervalFreqThreshold</a>) &#123;</span></CodeLine>
<Link id="l03655" /><CodeLine lineNumber="3655"><span class="doxyHighlight">    Counter++;</span></CodeLine>
<Link id="l03656" /><CodeLine lineNumber="3656"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03657" /><CodeLine lineNumber="3657"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03658" /><CodeLine lineNumber="3658"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03659" /><CodeLine lineNumber="3659"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03660" /><CodeLine lineNumber="3660"></CodeLine>
<Link id="l03661" /><CodeLine lineNumber="3661"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::joinVirtRegs(<a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP) &#123;</span></CodeLine>
<Link id="l03662" /><CodeLine lineNumber="3662"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;VNInfo &#42;, 16&gt;</a> NewVNInfo;</span></CodeLine>
<Link id="l03663" /><CodeLine lineNumber="3663"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> = LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l03664" /><CodeLine lineNumber="3664"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> = LIS-&gt;getInterval(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l03665" /><CodeLine lineNumber="3665"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> TrackSubRegLiveness = <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;shouldTrackSubRegLiveness(&#42;<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC());</span></CodeLine>
<Link id="l03666" /><CodeLine lineNumber="3666"><span class="doxyHighlight">  JoinVals RHSVals(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg(), <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx(), <a href="/docs/api/structs/llvm/lanebitmask/#a9082b6aa4021114645045d9c5628eb26">LaneBitmask::getNone</a>(),</span></CodeLine>
<Link id="l03667" /><CodeLine lineNumber="3667"><span class="doxyHighlight">                   NewVNInfo, CP, LIS, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, TrackSubRegLiveness);</span></CodeLine>
<Link id="l03668" /><CodeLine lineNumber="3668"><span class="doxyHighlight">  JoinVals LHSVals(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx(), <a href="/docs/api/structs/llvm/lanebitmask/#a9082b6aa4021114645045d9c5628eb26">LaneBitmask::getNone</a>(),</span></CodeLine>
<Link id="l03669" /><CodeLine lineNumber="3669"><span class="doxyHighlight">                   NewVNInfo, CP, LIS, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, TrackSubRegLiveness);</span></CodeLine>
<Link id="l03670" /><CodeLine lineNumber="3670"></CodeLine>
<Link id="l03671" /><CodeLine lineNumber="3671"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tRHS = &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a> &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n\\t\\tLHS = &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03672" /><CodeLine lineNumber="3672"></CodeLine>
<Link id="l03673" /><CodeLine lineNumber="3673"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (isHighCostLiveInterval(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>) || isHighCostLiveInterval(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>))</span></CodeLine>
<Link id="l03674" /><CodeLine lineNumber="3674"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03675" /><CodeLine lineNumber="3675"></CodeLine>
<Link id="l03676" /><CodeLine lineNumber="3676"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// First compute NewVNInfo and the simple value mappings.</span></CodeLine>
<Link id="l03677" /><CodeLine lineNumber="3677"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Detect impossible conflicts early.</span></CodeLine>
<Link id="l03678" /><CodeLine lineNumber="3678"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LHSVals.mapValues(RHSVals) || !RHSVals.mapValues(LHSVals))</span></CodeLine>
<Link id="l03679" /><CodeLine lineNumber="3679"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03680" /><CodeLine lineNumber="3680"></CodeLine>
<Link id="l03681" /><CodeLine lineNumber="3681"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Some conflicts can only be resolved after all values have been mapped.</span></CodeLine>
<Link id="l03682" /><CodeLine lineNumber="3682"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LHSVals.resolveConflicts(RHSVals) || !RHSVals.resolveConflicts(LHSVals))</span></CodeLine>
<Link id="l03683" /><CodeLine lineNumber="3683"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03684" /><CodeLine lineNumber="3684"></CodeLine>
<Link id="l03685" /><CodeLine lineNumber="3685"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// All clear, the live ranges can be merged.</span></CodeLine>
<Link id="l03686" /><CodeLine lineNumber="3686"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.hasSubRanges() || <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.hasSubRanges()) &#123;</span></CodeLine>
<Link id="l03687" /><CodeLine lineNumber="3687"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a8e612822d4ba7bb36c9c79582a567108">BumpPtrAllocator</a> &amp;<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a> = LIS-&gt;getVNInfoAllocator();</span></CodeLine>
<Link id="l03688" /><CodeLine lineNumber="3688"></CodeLine>
<Link id="l03689" /><CodeLine lineNumber="3689"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Transform lanemasks from the LHS to masks in the coalesced register and</span></CodeLine>
<Link id="l03690" /><CodeLine lineNumber="3690"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// create initial subranges if necessary.</span></CodeLine>
<Link id="l03691" /><CodeLine lineNumber="3691"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> DstIdx = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx();</span></CodeLine>
<Link id="l03692" /><CodeLine lineNumber="3692"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.hasSubRanges()) &#123;</span></CodeLine>
<Link id="l03693" /><CodeLine lineNumber="3693"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a> = DstIdx == 0 ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC()-&gt;getLaneMask()</span></CodeLine>
<Link id="l03694" /><CodeLine lineNumber="3694"><span class="doxyHighlight">                                     : <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(DstIdx);</span></CodeLine>
<Link id="l03695" /><CodeLine lineNumber="3695"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// LHS must support subregs or we wouldn&#39;t be in this codepath.</span></CodeLine>
<Link id="l03696" /><CodeLine lineNumber="3696"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a>.any());</span></CodeLine>
<Link id="l03697" /><CodeLine lineNumber="3697"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.createSubRangeFrom(<a href="/docs/api/files/lib/lib/codegen/regallocbasic-cpp/#ad5d00e1d77644d95847b9bf8da12b759">Allocator</a>, Mask, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</span></CodeLine>
<Link id="l03698" /><CodeLine lineNumber="3698"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstIdx != 0) &#123;</span></CodeLine>
<Link id="l03699" /><CodeLine lineNumber="3699"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Transform LHS lanemasks to new register class if necessary.</span></CodeLine>
<Link id="l03700" /><CodeLine lineNumber="3700"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;R : <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.subranges()) &#123;</span></CodeLine>
<Link id="l03701" /><CodeLine lineNumber="3701"><span class="doxyHighlight">        <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a> = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndexLaneMask(DstIdx, <a href="/docs/api/namespaces/llvm/riscvfencefield/#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.LaneMask);</span></CodeLine>
<Link id="l03702" /><CodeLine lineNumber="3702"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/riscvfencefield/#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.LaneMask = <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a>;</span></CodeLine>
<Link id="l03703" /><CodeLine lineNumber="3703"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03704" /><CodeLine lineNumber="3704"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03705" /><CodeLine lineNumber="3705"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\tLHST = &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg()) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39; &#39;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a></span></CodeLine>
<Link id="l03706" /><CodeLine lineNumber="3706"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03707" /><CodeLine lineNumber="3707"></CodeLine>
<Link id="l03708" /><CodeLine lineNumber="3708"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Determine lanemasks of RHS in the coalesced register and merge subranges.</span></CodeLine>
<Link id="l03709" /><CodeLine lineNumber="3709"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SrcIdx = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx();</span></CodeLine>
<Link id="l03710" /><CodeLine lineNumber="3710"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.hasSubRanges()) &#123;</span></CodeLine>
<Link id="l03711" /><CodeLine lineNumber="3711"><span class="doxyHighlight">      <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a> = SrcIdx == 0 ? <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC()-&gt;getLaneMask()</span></CodeLine>
<Link id="l03712" /><CodeLine lineNumber="3712"><span class="doxyHighlight">                                     : <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(SrcIdx);</span></CodeLine>
<Link id="l03713" /><CodeLine lineNumber="3713"><span class="doxyHighlight">      mergeSubRangeInto(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, Mask, CP, DstIdx);</span></CodeLine>
<Link id="l03714" /><CodeLine lineNumber="3714"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03715" /><CodeLine lineNumber="3715"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Pair up subranges and merge.</span></CodeLine>
<Link id="l03716" /><CodeLine lineNumber="3716"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;R : <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.subranges()) &#123;</span></CodeLine>
<Link id="l03717" /><CodeLine lineNumber="3717"><span class="doxyHighlight">        <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> <a href="/docs/api/namespaces/llvm/bitmaskenumdetail/#a4562904154aff9698a612bc7f6086a4c">Mask</a> = <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;composeSubRegIndexLaneMask(SrcIdx, <a href="/docs/api/namespaces/llvm/riscvfencefield/#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.LaneMask);</span></CodeLine>
<Link id="l03718" /><CodeLine lineNumber="3718"><span class="doxyHighlight">        mergeSubRangeInto(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, R, Mask, CP, DstIdx);</span></CodeLine>
<Link id="l03719" /><CodeLine lineNumber="3719"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03720" /><CodeLine lineNumber="3720"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03721" /><CodeLine lineNumber="3721"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\tJoined SubRanges &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03722" /><CodeLine lineNumber="3722"></CodeLine>
<Link id="l03723" /><CodeLine lineNumber="3723"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Pruning implicit defs from subranges may result in the main range</span></CodeLine>
<Link id="l03724" /><CodeLine lineNumber="3724"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// having stale segments.</span></CodeLine>
<Link id="l03725" /><CodeLine lineNumber="3725"><span class="doxyHighlight">    LHSVals.pruneMainSegments(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, ShrinkMainRange);</span></CodeLine>
<Link id="l03726" /><CodeLine lineNumber="3726"></CodeLine>
<Link id="l03727" /><CodeLine lineNumber="3727"><span class="doxyHighlight">    LHSVals.pruneSubRegValues(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, ShrinkMask);</span></CodeLine>
<Link id="l03728" /><CodeLine lineNumber="3728"><span class="doxyHighlight">    RHSVals.pruneSubRegValues(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, ShrinkMask);</span></CodeLine>
<Link id="l03729" /><CodeLine lineNumber="3729"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TrackSubRegLiveness &amp;&amp; !<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx() &amp;&amp; <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx()) &#123;</span></CodeLine>
<Link id="l03730" /><CodeLine lineNumber="3730"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.createSubRangeFrom(LIS-&gt;getVNInfoAllocator(),</span></CodeLine>
<Link id="l03731" /><CodeLine lineNumber="3731"><span class="doxyHighlight">                           <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getNewRC()-&gt;getLaneMask(), <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</span></CodeLine>
<Link id="l03732" /><CodeLine lineNumber="3732"><span class="doxyHighlight">    mergeSubRangeInto(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>-&gt;getSubRegIndexLaneMask(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx()), CP,</span></CodeLine>
<Link id="l03733" /><CodeLine lineNumber="3733"><span class="doxyHighlight">                      <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx());</span></CodeLine>
<Link id="l03734" /><CodeLine lineNumber="3734"><span class="doxyHighlight">    LHSVals.pruneMainSegments(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, ShrinkMainRange);</span></CodeLine>
<Link id="l03735" /><CodeLine lineNumber="3735"><span class="doxyHighlight">    LHSVals.pruneSubRegValues(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, ShrinkMask);</span></CodeLine>
<Link id="l03736" /><CodeLine lineNumber="3736"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03737" /><CodeLine lineNumber="3737"></CodeLine>
<Link id="l03738" /><CodeLine lineNumber="3738"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The merging algorithm in LiveInterval::join() can&#39;t handle conflicting</span></CodeLine>
<Link id="l03739" /><CodeLine lineNumber="3739"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value mappings, so we need to remove any live ranges that overlap a</span></CodeLine>
<Link id="l03740" /><CodeLine lineNumber="3740"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// CR&#95;Replace resolution. Collect a set of end points that can be used to</span></CodeLine>
<Link id="l03741" /><CodeLine lineNumber="3741"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// restore the live range after joining.</span></CodeLine>
<Link id="l03742" /><CodeLine lineNumber="3742"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;SlotIndex, 8&gt;</a> EndPoints;</span></CodeLine>
<Link id="l03743" /><CodeLine lineNumber="3743"><span class="doxyHighlight">  LHSVals.pruneValues(RHSVals, EndPoints, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03744" /><CodeLine lineNumber="3744"><span class="doxyHighlight">  RHSVals.pruneValues(LHSVals, EndPoints, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03745" /><CodeLine lineNumber="3745"></CodeLine>
<Link id="l03746" /><CodeLine lineNumber="3746"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Erase COPY and IMPLICIT&#95;DEF instructions. This may cause some external</span></CodeLine>
<Link id="l03747" /><CodeLine lineNumber="3747"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// registers to require trimming.</span></CodeLine>
<Link id="l03748" /><CodeLine lineNumber="3748"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Register, 8&gt;</a> ShrinkRegs;</span></CodeLine>
<Link id="l03749" /><CodeLine lineNumber="3749"><span class="doxyHighlight">  LHSVals.eraseInstrs(ErasedInstrs, ShrinkRegs, &amp;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>);</span></CodeLine>
<Link id="l03750" /><CodeLine lineNumber="3750"><span class="doxyHighlight">  RHSVals.eraseInstrs(ErasedInstrs, ShrinkRegs);</span></CodeLine>
<Link id="l03751" /><CodeLine lineNumber="3751"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!ShrinkRegs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</span></CodeLine>
<Link id="l03752" /><CodeLine lineNumber="3752"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(&amp;LIS-&gt;getInterval(ShrinkRegs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a0c8ffe664a36e30d49c84d0aded2fe08">pop&#95;back&#95;val</a>()));</span></CodeLine>
<Link id="l03753" /><CodeLine lineNumber="3753"></CodeLine>
<Link id="l03754" /><CodeLine lineNumber="3754"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Scan and mark undef any DBG&#95;VALUEs that would refer to a different value.</span></CodeLine>
<Link id="l03755" /><CodeLine lineNumber="3755"><span class="doxyHighlight">  checkMergingChangesDbgValues(CP, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, LHSVals, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, RHSVals);</span></CodeLine>
<Link id="l03756" /><CodeLine lineNumber="3756"></CodeLine>
<Link id="l03757" /><CodeLine lineNumber="3757"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the RHS covers any PHI locations that were tracked for debug-info, we</span></CodeLine>
<Link id="l03758" /><CodeLine lineNumber="3758"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// must update tracking information to reflect the join.</span></CodeLine>
<Link id="l03759" /><CodeLine lineNumber="3759"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> RegIt = RegToPHIIdx.find(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l03760" /><CodeLine lineNumber="3760"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RegIt != RegToPHIIdx.end()) &#123;</span></CodeLine>
<Link id="l03761" /><CodeLine lineNumber="3761"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Iterate over all the debug instruction numbers assigned this register.</span></CodeLine>
<Link id="l03762" /><CodeLine lineNumber="3762"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> InstID : RegIt-&gt;second) &#123;</span></CodeLine>
<Link id="l03763" /><CodeLine lineNumber="3763"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> PHIIt = PHIValToPos.find(InstID);</span></CodeLine>
<Link id="l03764" /><CodeLine lineNumber="3764"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PHIIt != PHIValToPos.end());</span></CodeLine>
<Link id="l03765" /><CodeLine lineNumber="3765"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> &amp;<a href="/docs/api/namespaces/llvm/si">SI</a> = PHIIt-&gt;second.SI;</span></CodeLine>
<Link id="l03766" /><CodeLine lineNumber="3766"></CodeLine>
<Link id="l03767" /><CodeLine lineNumber="3767"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Does the RHS cover the position of this PHI?</span></CodeLine>
<Link id="l03768" /><CodeLine lineNumber="3768"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LII = <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.find(<a href="/docs/api/namespaces/llvm/si">SI</a>);</span></CodeLine>
<Link id="l03769" /><CodeLine lineNumber="3769"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LII == <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.end() || LII-&gt;start &gt; <a href="/docs/api/namespaces/llvm/si">SI</a>)</span></CodeLine>
<Link id="l03770" /><CodeLine lineNumber="3770"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03771" /><CodeLine lineNumber="3771"></CodeLine>
<Link id="l03772" /><CodeLine lineNumber="3772"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Accept two kinds of subregister movement:</span></CodeLine>
<Link id="l03773" /><CodeLine lineNumber="3773"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//  &#42; When we merge from one register class into a larger register:</span></CodeLine>
<Link id="l03774" /><CodeLine lineNumber="3774"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//        %1:gr16 = some-inst</span></CodeLine>
<Link id="l03775" /><CodeLine lineNumber="3775"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//                -&gt;</span></CodeLine>
<Link id="l03776" /><CodeLine lineNumber="3776"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//        %2:gr32.sub&#95;16bit = some-inst</span></CodeLine>
<Link id="l03777" /><CodeLine lineNumber="3777"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//  &#42; When the PHI is already in a subregister, and the larger class</span></CodeLine>
<Link id="l03778" /><CodeLine lineNumber="3778"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//    is coalesced:</span></CodeLine>
<Link id="l03779" /><CodeLine lineNumber="3779"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//        %2:gr32.sub&#95;16bit = some-inst</span></CodeLine>
<Link id="l03780" /><CodeLine lineNumber="3780"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//        %3:gr32 = COPY %2</span></CodeLine>
<Link id="l03781" /><CodeLine lineNumber="3781"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//                -&gt;</span></CodeLine>
<Link id="l03782" /><CodeLine lineNumber="3782"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">//        %3:gr32.sub&#95;16bit = some-inst</span></CodeLine>
<Link id="l03783" /><CodeLine lineNumber="3783"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Test for subregister move:</span></CodeLine>
<Link id="l03784" /><CodeLine lineNumber="3784"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx() != 0 || <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstIdx() != 0)</span></CodeLine>
<Link id="l03785" /><CodeLine lineNumber="3785"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If we&#39;re moving between different subregisters, ignore this join.</span></CodeLine>
<Link id="l03786" /><CodeLine lineNumber="3786"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// The PHI will not get a location, dropping variable locations.</span></CodeLine>
<Link id="l03787" /><CodeLine lineNumber="3787"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PHIIt-&gt;second.SubReg &amp;&amp; PHIIt-&gt;second.SubReg != <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx())</span></CodeLine>
<Link id="l03788" /><CodeLine lineNumber="3788"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03789" /><CodeLine lineNumber="3789"></CodeLine>
<Link id="l03790" /><CodeLine lineNumber="3790"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Update our tracking of where the PHI is.</span></CodeLine>
<Link id="l03791" /><CodeLine lineNumber="3791"><span class="doxyHighlight">      PHIIt-&gt;second.Reg = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg();</span></CodeLine>
<Link id="l03792" /><CodeLine lineNumber="3792"></CodeLine>
<Link id="l03793" /><CodeLine lineNumber="3793"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If we merge into a sub-register of a larger class (test above),</span></CodeLine>
<Link id="l03794" /><CodeLine lineNumber="3794"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// update SubReg.</span></CodeLine>
<Link id="l03795" /><CodeLine lineNumber="3795"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx() != 0)</span></CodeLine>
<Link id="l03796" /><CodeLine lineNumber="3796"><span class="doxyHighlight">        PHIIt-&gt;second.SubReg = <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcIdx();</span></CodeLine>
<Link id="l03797" /><CodeLine lineNumber="3797"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03798" /><CodeLine lineNumber="3798"></CodeLine>
<Link id="l03799" /><CodeLine lineNumber="3799"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Rebuild the register index in RegToPHIIdx to account for PHIs tracking</span></CodeLine>
<Link id="l03800" /><CodeLine lineNumber="3800"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// different VRegs now. Copy old collection of debug instruction numbers and</span></CodeLine>
<Link id="l03801" /><CodeLine lineNumber="3801"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// erase the old one:</span></CodeLine>
<Link id="l03802" /><CodeLine lineNumber="3802"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> InstrNums = RegIt-&gt;second;</span></CodeLine>
<Link id="l03803" /><CodeLine lineNumber="3803"><span class="doxyHighlight">    RegToPHIIdx.erase(RegIt);</span></CodeLine>
<Link id="l03804" /><CodeLine lineNumber="3804"></CodeLine>
<Link id="l03805" /><CodeLine lineNumber="3805"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// There might already be PHIs being tracked in the destination VReg. Insert</span></CodeLine>
<Link id="l03806" /><CodeLine lineNumber="3806"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// into an existing tracking collection, or insert a new one.</span></CodeLine>
<Link id="l03807" /><CodeLine lineNumber="3807"><span class="doxyHighlight">    RegIt = RegToPHIIdx.find(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l03808" /><CodeLine lineNumber="3808"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (RegIt != RegToPHIIdx.end())</span></CodeLine>
<Link id="l03809" /><CodeLine lineNumber="3809"><span class="doxyHighlight">      RegIt-&gt;second.insert(RegIt-&gt;second.end(), InstrNums.begin(),</span></CodeLine>
<Link id="l03810" /><CodeLine lineNumber="3810"><span class="doxyHighlight">                           InstrNums.end());</span></CodeLine>
<Link id="l03811" /><CodeLine lineNumber="3811"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l03812" /><CodeLine lineNumber="3812"><span class="doxyHighlight">      RegToPHIIdx.insert(&#123;<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg(), InstrNums&#125;);</span></CodeLine>
<Link id="l03813" /><CodeLine lineNumber="3813"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03814" /><CodeLine lineNumber="3814"></CodeLine>
<Link id="l03815" /><CodeLine lineNumber="3815"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Join RHS into LHS.</span></CodeLine>
<Link id="l03816" /><CodeLine lineNumber="3816"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.join(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, LHSVals.getAssignments(), RHSVals.getAssignments(), NewVNInfo);</span></CodeLine>
<Link id="l03817" /><CodeLine lineNumber="3817"></CodeLine>
<Link id="l03818" /><CodeLine lineNumber="3818"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Kill flags are going to be wrong if the live ranges were overlapping.</span></CodeLine>
<Link id="l03819" /><CodeLine lineNumber="3819"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Eventually, we should simply clear all kill flags when computing live</span></CodeLine>
<Link id="l03820" /><CodeLine lineNumber="3820"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ranges. They are reinserted after register allocation.</span></CodeLine>
<Link id="l03821" /><CodeLine lineNumber="3821"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;clearKillFlags(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>.reg());</span></CodeLine>
<Link id="l03822" /><CodeLine lineNumber="3822"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;clearKillFlags(<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>.reg());</span></CodeLine>
<Link id="l03823" /><CodeLine lineNumber="3823"></CodeLine>
<Link id="l03824" /><CodeLine lineNumber="3824"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l03825" /><CodeLine lineNumber="3825"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Recompute the parts of the live range we had to remove because of</span></CodeLine>
<Link id="l03826" /><CodeLine lineNumber="3826"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// CR&#95;Replace conflicts.</span></CodeLine>
<Link id="l03827" /><CodeLine lineNumber="3827"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(&#123;</span></CodeLine>
<Link id="l03828" /><CodeLine lineNumber="3828"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\t\\trestoring liveness to &quot;</span><span class="doxyHighlight"> &lt;&lt; EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; points: &quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03829" /><CodeLine lineNumber="3829"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> i = 0, n = EndPoints.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>(); i != n; ++i) &#123;</span></CodeLine>
<Link id="l03830" /><CodeLine lineNumber="3830"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; EndPoints&#91;i&#93;;</span></CodeLine>
<Link id="l03831" /><CodeLine lineNumber="3831"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (i != n - 1)</span></CodeLine>
<Link id="l03832" /><CodeLine lineNumber="3832"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;,&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03833" /><CodeLine lineNumber="3833"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03834" /><CodeLine lineNumber="3834"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;:  &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a> &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03835" /><CodeLine lineNumber="3835"><span class="doxyHighlight">    &#125;);</span></CodeLine>
<Link id="l03836" /><CodeLine lineNumber="3836"><span class="doxyHighlight">    LIS-&gt;extendToIndices((<a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;)<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, EndPoints);</span></CodeLine>
<Link id="l03837" /><CodeLine lineNumber="3837"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03838" /><CodeLine lineNumber="3838"></CodeLine>
<Link id="l03839" /><CodeLine lineNumber="3839"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03840" /><CodeLine lineNumber="3840"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03841" /><CodeLine lineNumber="3841"></CodeLine>
<Link id="l03842" /><CodeLine lineNumber="3842"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::joinIntervals(<a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP) &#123;</span></CodeLine>
<Link id="l03843" /><CodeLine lineNumber="3843"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.isPhys() ? joinReservedPhysReg(CP) : joinVirtRegs(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>);</span></CodeLine>
<Link id="l03844" /><CodeLine lineNumber="3844"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03845" /><CodeLine lineNumber="3845"></CodeLine>
<Link id="l03846" /><CodeLine lineNumber="3846"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::buildVRegToDbgValueMap(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF) &#123;</span></CodeLine>
<Link id="l03847" /><CodeLine lineNumber="3847"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/slotindexes">SlotIndexes</a> &amp;Slots = &#42;LIS-&gt;getSlotIndexes();</span></CodeLine>
<Link id="l03848" /><CodeLine lineNumber="3848"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineInstr &#42;, 8&gt;</a> ToInsert;</span></CodeLine>
<Link id="l03849" /><CodeLine lineNumber="3849"></CodeLine>
<Link id="l03850" /><CodeLine lineNumber="3850"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// After collecting a block of DBG&#95;VALUEs into ToInsert, enter them into the</span></CodeLine>
<Link id="l03851" /><CodeLine lineNumber="3851"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// vreg =&gt; DbgValueLoc map.</span></CodeLine>
<Link id="l03852" /><CodeLine lineNumber="3852"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> CloseNewDVRange = &#91;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">, &amp;ToInsert&#93;(<a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> <a href="/docs/api/namespaces/llvm/pdb/#a5dbb1abfb6d3c14555304f9c56703234a9234cc57c43f272b55a94b0069fe62d1">Slot</a>) &#123;</span></CodeLine>
<Link id="l03853" /><CodeLine lineNumber="3853"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a> : ToInsert) &#123;</span></CodeLine>
<Link id="l03854" /><CodeLine lineNumber="3854"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>-&gt;debug&#95;operands()) &#123;</span></CodeLine>
<Link id="l03855" /><CodeLine lineNumber="3855"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.isReg() &amp;&amp; <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getReg().isVirtual())</span></CodeLine>
<Link id="l03856" /><CodeLine lineNumber="3856"><span class="doxyHighlight">          DbgVRegToValues&#91;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.getReg()&#93;.push&#95;back(&#123;<a href="/docs/api/namespaces/llvm/pdb/#a5dbb1abfb6d3c14555304f9c56703234a9234cc57c43f272b55a94b0069fe62d1">Slot</a>, <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>&#125;);</span></CodeLine>
<Link id="l03857" /><CodeLine lineNumber="3857"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03858" /><CodeLine lineNumber="3858"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03859" /><CodeLine lineNumber="3859"></CodeLine>
<Link id="l03860" /><CodeLine lineNumber="3860"><span class="doxyHighlight">    ToInsert.clear();</span></CodeLine>
<Link id="l03861" /><CodeLine lineNumber="3861"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l03862" /><CodeLine lineNumber="3862"></CodeLine>
<Link id="l03863" /><CodeLine lineNumber="3863"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Iterate over all instructions, collecting them into the ToInsert vector.</span></CodeLine>
<Link id="l03864" /><CodeLine lineNumber="3864"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Once a non-debug instruction is found, record the slot index of the</span></CodeLine>
<Link id="l03865" /><CodeLine lineNumber="3865"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// collected DBG&#95;VALUEs.</span></CodeLine>
<Link id="l03866" /><CodeLine lineNumber="3866"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : MF) &#123;</span></CodeLine>
<Link id="l03867" /><CodeLine lineNumber="3867"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> CurrentSlot = Slots.<a href="/docs/api/classes/llvm/slotindexes/#aaf0c07cc1cdb9c78c6dfdfdd5913420a">getMBBStartIdx</a>(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03868" /><CodeLine lineNumber="3868"></CodeLine>
<Link id="l03869" /><CodeLine lineNumber="3869"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l03870" /><CodeLine lineNumber="3870"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugValue()) &#123;</span></CodeLine>
<Link id="l03871" /><CodeLine lineNumber="3871"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a61d13d6824ec46c31260a4fd0997eda0">any&#95;of</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.debug&#95;operands(), &#91;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO) &#123;</span></CodeLine>
<Link id="l03872" /><CodeLine lineNumber="3872"><span class="doxyHighlight">              return MO.isReg() &amp;&amp; MO.getReg().isVirtual();</span></CodeLine>
<Link id="l03873" /><CodeLine lineNumber="3873"><span class="doxyHighlight">            &#125;))</span></CodeLine>
<Link id="l03874" /><CodeLine lineNumber="3874"><span class="doxyHighlight">          ToInsert.push&#95;back(&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l03875" /><CodeLine lineNumber="3875"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugOrPseudoInstr()) &#123;</span></CodeLine>
<Link id="l03876" /><CodeLine lineNumber="3876"><span class="doxyHighlight">        CurrentSlot = Slots.<a href="/docs/api/classes/llvm/slotindexes/#aa429e211fd041cb42d26e49dd5d95d75">getInstructionIndex</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l03877" /><CodeLine lineNumber="3877"><span class="doxyHighlight">        CloseNewDVRange(CurrentSlot);</span></CodeLine>
<Link id="l03878" /><CodeLine lineNumber="3878"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03879" /><CodeLine lineNumber="3879"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03880" /><CodeLine lineNumber="3880"></CodeLine>
<Link id="l03881" /><CodeLine lineNumber="3881"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Close range of DBG&#95;VALUEs at the end of blocks.</span></CodeLine>
<Link id="l03882" /><CodeLine lineNumber="3882"><span class="doxyHighlight">    CloseNewDVRange(Slots.<a href="/docs/api/classes/llvm/slotindexes/#a662867d9274595cdac0092afa45888be">getMBBEndIdx</a>(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>));</span></CodeLine>
<Link id="l03883" /><CodeLine lineNumber="3883"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03884" /><CodeLine lineNumber="3884"></CodeLine>
<Link id="l03885" /><CodeLine lineNumber="3885"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Sort all DBG&#95;VALUEs we&#39;ve seen by slot number.</span></CodeLine>
<Link id="l03886" /><CodeLine lineNumber="3886"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Pair : DbgVRegToValues)</span></CodeLine>
<Link id="l03887" /><CodeLine lineNumber="3887"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(Pair.second);</span></CodeLine>
<Link id="l03888" /><CodeLine lineNumber="3888"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03889" /><CodeLine lineNumber="3889"></CodeLine>
<Link id="l03890" /><CodeLine lineNumber="3890"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::checkMergingChangesDbgValues(<a href="/docs/api/classes/llvm/coalescerpair">CoalescerPair</a> &amp;CP,</span></CodeLine>
<Link id="l03891" /><CodeLine lineNumber="3891"><span class="doxyHighlight">                                                     <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</span></CodeLine>
<Link id="l03892" /><CodeLine lineNumber="3892"><span class="doxyHighlight">                                                     JoinVals &amp;LHSVals,</span></CodeLine>
<Link id="l03893" /><CodeLine lineNumber="3893"><span class="doxyHighlight">                                                     <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>,</span></CodeLine>
<Link id="l03894" /><CodeLine lineNumber="3894"><span class="doxyHighlight">                                                     JoinVals &amp;RHSVals) &#123;</span></CodeLine>
<Link id="l03895" /><CodeLine lineNumber="3895"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ScanForDstReg = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &#123;</span></CodeLine>
<Link id="l03896" /><CodeLine lineNumber="3896"><span class="doxyHighlight">    checkMergingChangesDbgValuesImpl(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, LHSVals);</span></CodeLine>
<Link id="l03897" /><CodeLine lineNumber="3897"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l03898" /><CodeLine lineNumber="3898"></CodeLine>
<Link id="l03899" /><CodeLine lineNumber="3899"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ScanForSrcReg = &#91;&amp;&#93;(<a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &#123;</span></CodeLine>
<Link id="l03900" /><CodeLine lineNumber="3900"><span class="doxyHighlight">    checkMergingChangesDbgValuesImpl(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>, <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>, RHSVals);</span></CodeLine>
<Link id="l03901" /><CodeLine lineNumber="3901"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l03902" /><CodeLine lineNumber="3902"></CodeLine>
<Link id="l03903" /><CodeLine lineNumber="3903"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Scan for unsound updates of both the source and destination register.</span></CodeLine>
<Link id="l03904" /><CodeLine lineNumber="3904"><span class="doxyHighlight">  ScanForSrcReg(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getSrcReg());</span></CodeLine>
<Link id="l03905" /><CodeLine lineNumber="3905"><span class="doxyHighlight">  ScanForDstReg(<a href="/docs/api/namespaces/llvm/hexagonisd/#ab37bf6c49bc26c43ddd958218f63ba00a2ee9b253b17d18db5307d47d1051e0ff">CP</a>.getDstReg());</span></CodeLine>
<Link id="l03906" /><CodeLine lineNumber="3906"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03907" /><CodeLine lineNumber="3907"></CodeLine>
<Link id="l03908" /><CodeLine lineNumber="3908"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::checkMergingChangesDbgValuesImpl(<a href="/docs/api/classes/llvm/register">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>,</span></CodeLine>
<Link id="l03909" /><CodeLine lineNumber="3909"><span class="doxyHighlight">                                                         <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;OtherLR,</span></CodeLine>
<Link id="l03910" /><CodeLine lineNumber="3910"><span class="doxyHighlight">                                                         <a href="/docs/api/classes/llvm/liverange">LiveRange</a> &amp;RegLR,</span></CodeLine>
<Link id="l03911" /><CodeLine lineNumber="3911"><span class="doxyHighlight">                                                         JoinVals &amp;RegVals) &#123;</span></CodeLine>
<Link id="l03912" /><CodeLine lineNumber="3912"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Are there any DBG&#95;VALUEs to examine?</span></CodeLine>
<Link id="l03913" /><CodeLine lineNumber="3913"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> VRegMapIt = DbgVRegToValues.find(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l03914" /><CodeLine lineNumber="3914"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VRegMapIt == DbgVRegToValues.end())</span></CodeLine>
<Link id="l03915" /><CodeLine lineNumber="3915"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03916" /><CodeLine lineNumber="3916"></CodeLine>
<Link id="l03917" /><CodeLine lineNumber="3917"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;DbgValueSet = VRegMapIt-&gt;second;</span></CodeLine>
<Link id="l03918" /><CodeLine lineNumber="3918"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DbgValueSetIt = DbgValueSet.begin();</span></CodeLine>
<Link id="l03919" /><CodeLine lineNumber="3919"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> SegmentIt = OtherLR.<a href="/docs/api/classes/llvm/liverange/#a9a5e7c523f12f9f164b786769de1ca47">begin</a>();</span></CodeLine>
<Link id="l03920" /><CodeLine lineNumber="3920"></CodeLine>
<Link id="l03921" /><CodeLine lineNumber="3921"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> LastUndefResult = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03922" /><CodeLine lineNumber="3922"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> LastUndefIdx;</span></CodeLine>
<Link id="l03923" /><CodeLine lineNumber="3923"></CodeLine>
<Link id="l03924" /><CodeLine lineNumber="3924"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the &quot;Other&quot; register is live at a slot Idx, test whether Reg can</span></CodeLine>
<Link id="l03925" /><CodeLine lineNumber="3925"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// safely be merged with it, or should be marked undef.</span></CodeLine>
<Link id="l03926" /><CodeLine lineNumber="3926"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ShouldUndef = &#91;&amp;RegVals, &amp;<a href="/docs/api/namespaces/llvm/armri/#a82ee67fc162fec9281be1b46631adcc2a450efd7bc999a24dcf0e793056da5958">RegLR</a>, &amp;LastUndefResult,</span></CodeLine>
<Link id="l03927" /><CodeLine lineNumber="3927"><span class="doxyHighlight">                      &amp;LastUndefIdx&#93;(<a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> Idx) -&gt; </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03928" /><CodeLine lineNumber="3928"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Our worst-case performance typically happens with asan, causing very</span></CodeLine>
<Link id="l03929" /><CodeLine lineNumber="3929"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// many DBG&#95;VALUEs of the same location. Cache a copy of the most recent</span></CodeLine>
<Link id="l03930" /><CodeLine lineNumber="3930"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// result for this edge-case.</span></CodeLine>
<Link id="l03931" /><CodeLine lineNumber="3931"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LastUndefIdx == Idx)</span></CodeLine>
<Link id="l03932" /><CodeLine lineNumber="3932"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> LastUndefResult;</span></CodeLine>
<Link id="l03933" /><CodeLine lineNumber="3933"></CodeLine>
<Link id="l03934" /><CodeLine lineNumber="3934"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the other range was live, and Reg&#39;s was not, the register coalescer</span></CodeLine>
<Link id="l03935" /><CodeLine lineNumber="3935"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// will not have tried to resolve any conflicts. We don&#39;t know whether</span></CodeLine>
<Link id="l03936" /><CodeLine lineNumber="3936"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the DBG&#95;VALUE will refer to the same value number, so it must be made</span></CodeLine>
<Link id="l03937" /><CodeLine lineNumber="3937"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// undef.</span></CodeLine>
<Link id="l03938" /><CodeLine lineNumber="3938"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> OtherIt = <a href="/docs/api/namespaces/llvm/armri/#a82ee67fc162fec9281be1b46631adcc2a450efd7bc999a24dcf0e793056da5958">RegLR</a>.find(Idx);</span></CodeLine>
<Link id="l03939" /><CodeLine lineNumber="3939"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherIt == <a href="/docs/api/namespaces/llvm/armri/#a82ee67fc162fec9281be1b46631adcc2a450efd7bc999a24dcf0e793056da5958">RegLR</a>.end())</span></CodeLine>
<Link id="l03940" /><CodeLine lineNumber="3940"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03941" /><CodeLine lineNumber="3941"></CodeLine>
<Link id="l03942" /><CodeLine lineNumber="3942"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Both the registers were live: examine the conflict resolution record for</span></CodeLine>
<Link id="l03943" /><CodeLine lineNumber="3943"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the value number Reg refers to. CR&#95;Keep meant that this value number</span></CodeLine>
<Link id="l03944" /><CodeLine lineNumber="3944"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// &quot;won&quot; and the merged register definitely refers to that value. CR&#95;Erase</span></CodeLine>
<Link id="l03945" /><CodeLine lineNumber="3945"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// means the value number was a redundant copy of the other value, which</span></CodeLine>
<Link id="l03946" /><CodeLine lineNumber="3946"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// was coalesced and Reg deleted. It&#39;s safe to refer to the other register</span></CodeLine>
<Link id="l03947" /><CodeLine lineNumber="3947"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// (which will be the source of the copy).</span></CodeLine>
<Link id="l03948" /><CodeLine lineNumber="3948"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Resolution = RegVals.getResolution(OtherIt-&gt;valno-&gt;id);</span></CodeLine>
<Link id="l03949" /><CodeLine lineNumber="3949"><span class="doxyHighlight">    LastUndefResult =</span></CodeLine>
<Link id="l03950" /><CodeLine lineNumber="3950"><span class="doxyHighlight">        Resolution != <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909cae68dda580bbff218085b3f189b9e7c73">JoinVals::CR&#95;Keep</a> &amp;&amp; Resolution != <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/joinvals/#a7caa969b35ea838dd4137cd213b8909ca8a7b9f2adcff0b230512d2547f5fd44d">JoinVals::CR&#95;Erase</a>;</span></CodeLine>
<Link id="l03951" /><CodeLine lineNumber="3951"><span class="doxyHighlight">    LastUndefIdx = Idx;</span></CodeLine>
<Link id="l03952" /><CodeLine lineNumber="3952"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> LastUndefResult;</span></CodeLine>
<Link id="l03953" /><CodeLine lineNumber="3953"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l03954" /><CodeLine lineNumber="3954"></CodeLine>
<Link id="l03955" /><CodeLine lineNumber="3955"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Iterate over both the live-range of the &quot;Other&quot; register, and the set of</span></CodeLine>
<Link id="l03956" /><CodeLine lineNumber="3956"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// DBG&#95;VALUEs for Reg at the same time. Advance whichever one has the lowest</span></CodeLine>
<Link id="l03957" /><CodeLine lineNumber="3957"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// slot index. This relies on the DbgValueSet being ordered.</span></CodeLine>
<Link id="l03958" /><CodeLine lineNumber="3958"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (DbgValueSetIt != DbgValueSet.end() &amp;&amp; SegmentIt != OtherLR.<a href="/docs/api/classes/llvm/liverange/#a757fd6afba0f531db70e78e057d147c6">end</a>()) &#123;</span></CodeLine>
<Link id="l03959" /><CodeLine lineNumber="3959"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DbgValueSetIt-&gt;first &lt; SegmentIt-&gt;end) &#123;</span></CodeLine>
<Link id="l03960" /><CodeLine lineNumber="3960"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// &quot;Other&quot; is live and there is a DBG&#95;VALUE of Reg: test if we should</span></CodeLine>
<Link id="l03961" /><CodeLine lineNumber="3961"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// set it undef.</span></CodeLine>
<Link id="l03962" /><CodeLine lineNumber="3962"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DbgValueSetIt-&gt;first &gt;= SegmentIt-&gt;start) &#123;</span></CodeLine>
<Link id="l03963" /><CodeLine lineNumber="3963"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> HasReg = DbgValueSetIt-&gt;second-&gt;hasDebugOperandForReg(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l03964" /><CodeLine lineNumber="3964"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ShouldUndefReg = ShouldUndef(DbgValueSetIt-&gt;first);</span></CodeLine>
<Link id="l03965" /><CodeLine lineNumber="3965"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (HasReg &amp;&amp; ShouldUndefReg) &#123;</span></CodeLine>
<Link id="l03966" /><CodeLine lineNumber="3966"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Mark undef, erase record of this DBG&#95;VALUE to avoid revisiting.</span></CodeLine>
<Link id="l03967" /><CodeLine lineNumber="3967"><span class="doxyHighlight">          DbgValueSetIt-&gt;second-&gt;setDebugValueUndef();</span></CodeLine>
<Link id="l03968" /><CodeLine lineNumber="3968"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03969" /><CodeLine lineNumber="3969"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03970" /><CodeLine lineNumber="3970"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03971" /><CodeLine lineNumber="3971"><span class="doxyHighlight">      ++DbgValueSetIt;</span></CodeLine>
<Link id="l03972" /><CodeLine lineNumber="3972"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03973" /><CodeLine lineNumber="3973"><span class="doxyHighlight">      ++SegmentIt;</span></CodeLine>
<Link id="l03974" /><CodeLine lineNumber="3974"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03975" /><CodeLine lineNumber="3975"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03976" /><CodeLine lineNumber="3976"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03977" /><CodeLine lineNumber="3977"></CodeLine>
<Link id="l03978" /><CodeLine lineNumber="3978"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l03979" /><CodeLine lineNumber="3979"></CodeLine>
<Link id="l03980" /><CodeLine lineNumber="3980"><span class="doxyHighlightComment">/// Information concerning MBB coalescing priority.</span></CodeLine>
<Link id="l03981" /><CodeLine lineNumber="3981" lineLink="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo"><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#ab70bf96dbc4f92c49f46eac4e433d3ed">MBBPriorityInfo</a> &#123;</span></CodeLine>
<Link id="l03982" /><CodeLine lineNumber="3982" lineLink="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a4a376d83d1a6024515746955db21739d"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a4a376d83d1a6024515746955db21739d">MBB</a>;</span></CodeLine>
<Link id="l03983" /><CodeLine lineNumber="3983" lineLink="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a14c318abdccc5e19786e20e936cab8c7"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a14c318abdccc5e19786e20e936cab8c7">Depth</a>;</span></CodeLine>
<Link id="l03984" /><CodeLine lineNumber="3984" lineLink="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a6275cdfa9397d920d591ddce7ec42fb1"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a6275cdfa9397d920d591ddce7ec42fb1">IsSplit</a>;</span></CodeLine>
<Link id="l03985" /><CodeLine lineNumber="3985"></CodeLine>
<Link id="l03986" /><CodeLine lineNumber="3986" lineLink="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#ab70bf96dbc4f92c49f46eac4e433d3ed"><span class="doxyHighlight">  <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#ab70bf96dbc4f92c49f46eac4e433d3ed">MBBPriorityInfo</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;mbb, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> depth, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> issplit)</span></CodeLine>
<Link id="l03987" /><CodeLine lineNumber="3987"><span class="doxyHighlight">      : <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a4a376d83d1a6024515746955db21739d">MBB</a>(mbb), <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a14c318abdccc5e19786e20e936cab8c7">Depth</a>(depth), <a href="/docs/api/structs/anonymous-namespace-registercoalescer-cpp-/mbbpriorityinfo/#a6275cdfa9397d920d591ddce7ec42fb1">IsSplit</a>(issplit) &#123;&#125;</span></CodeLine>
<Link id="l03988" /><CodeLine lineNumber="3988"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l03989" /><CodeLine lineNumber="3989"></CodeLine>
<Link id="l03990" /><CodeLine lineNumber="3990"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end anonymous namespace</span></CodeLine>
<Link id="l03991" /><CodeLine lineNumber="3991"></CodeLine>
<Link id="l03992" /><CodeLine lineNumber="3992"><span class="doxyHighlightComment">/// C-style comparator that sorts first based on the loop depth of the basic</span></CodeLine>
<Link id="l03993" /><CodeLine lineNumber="3993"><span class="doxyHighlightComment">/// block (the unsigned), and then on the MBB number.</span></CodeLine>
<Link id="l03994" /><CodeLine lineNumber="3994"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l03995" /><CodeLine lineNumber="3995"><span class="doxyHighlightComment">/// EnableGlobalCopies assumes that the primary sort key is loop depth.</span></CodeLine>
<Link id="l03996" /><CodeLine lineNumber="3996" lineLink="#a33f10720d78f213773cb15eacbf5c65a"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="#a33f10720d78f213773cb15eacbf5c65a">compareMBBPriority</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MBBPriorityInfo &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>,</span></CodeLine>
<Link id="l03997" /><CodeLine lineNumber="3997"><span class="doxyHighlight">                              </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MBBPriorityInfo &#42;<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>) &#123;</span></CodeLine>
<Link id="l03998" /><CodeLine lineNumber="3998"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Deeper loops first</span></CodeLine>
<Link id="l03999" /><CodeLine lineNumber="3999"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;Depth != <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;Depth)</span></CodeLine>
<Link id="l04000" /><CodeLine lineNumber="4000"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;Depth &gt; <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;Depth ? -1 : 1;</span></CodeLine>
<Link id="l04001" /><CodeLine lineNumber="4001"></CodeLine>
<Link id="l04002" /><CodeLine lineNumber="4002"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Try to unsplit critical edges next.</span></CodeLine>
<Link id="l04003" /><CodeLine lineNumber="4003"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;IsSplit != <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;IsSplit)</span></CodeLine>
<Link id="l04004" /><CodeLine lineNumber="4004"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;IsSplit ? -1 : 1;</span></CodeLine>
<Link id="l04005" /><CodeLine lineNumber="4005"></CodeLine>
<Link id="l04006" /><CodeLine lineNumber="4006"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Prefer blocks that are more connected in the CFG. This takes care of</span></CodeLine>
<Link id="l04007" /><CodeLine lineNumber="4007"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the most difficult copies first while intervals are short.</span></CodeLine>
<Link id="l04008" /><CodeLine lineNumber="4008"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/cl">cl</a> = <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;MBB-&gt;pred&#95;size() + <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;MBB-&gt;succ&#95;size();</span></CodeLine>
<Link id="l04009" /><CodeLine lineNumber="4009"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> cr = <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;MBB-&gt;pred&#95;size() + <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;MBB-&gt;succ&#95;size();</span></CodeLine>
<Link id="l04010" /><CodeLine lineNumber="4010"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/cl">cl</a> != cr)</span></CodeLine>
<Link id="l04011" /><CodeLine lineNumber="4011"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/cl">cl</a> &gt; cr ? -1 : 1;</span></CodeLine>
<Link id="l04012" /><CodeLine lineNumber="4012"></CodeLine>
<Link id="l04013" /><CodeLine lineNumber="4013"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// As a last resort, sort by block number.</span></CodeLine>
<Link id="l04014" /><CodeLine lineNumber="4014"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a9e1483f7215664a2315c53c3558d9a8d">LHS</a>-&gt;MBB-&gt;getNumber() &lt; <a href="/docs/api/files/lib/lib/target/lib/target/x86/x86partialreduction-cpp/#a87b8bfbbe9d8f7146d7f20a5fb42efd0">RHS</a>-&gt;MBB-&gt;getNumber() ? -1 : 1;</span></CodeLine>
<Link id="l04015" /><CodeLine lineNumber="4015"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04016" /><CodeLine lineNumber="4016"></CodeLine>
<Link id="l04017" /><CodeLine lineNumber="4017"><span class="doxyHighlightComment">/// \\returns true if the given copy uses or defines a local live range.</span></CodeLine>
<Link id="l04018" /><CodeLine lineNumber="4018" lineLink="#a272a95f31ec948e680a3c7dffd3c7f80"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a272a95f31ec948e680a3c7dffd3c7f80">isLocalCopy</a>(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;Copy, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveintervals">LiveIntervals</a> &#42;LIS) &#123;</span></CodeLine>
<Link id="l04019" /><CodeLine lineNumber="4019"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Copy-&gt;isCopy())</span></CodeLine>
<Link id="l04020" /><CodeLine lineNumber="4020"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04021" /><CodeLine lineNumber="4021"></CodeLine>
<Link id="l04022" /><CodeLine lineNumber="4022"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Copy-&gt;getOperand(1).isUndef())</span></CodeLine>
<Link id="l04023" /><CodeLine lineNumber="4023"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04024" /><CodeLine lineNumber="4024"></CodeLine>
<Link id="l04025" /><CodeLine lineNumber="4025"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> SrcReg = Copy-&gt;getOperand(1).getReg();</span></CodeLine>
<Link id="l04026" /><CodeLine lineNumber="4026"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> DstReg = Copy-&gt;getOperand(0).getReg();</span></CodeLine>
<Link id="l04027" /><CodeLine lineNumber="4027"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() || DstReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>())</span></CodeLine>
<Link id="l04028" /><CodeLine lineNumber="4028"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04029" /><CodeLine lineNumber="4029"></CodeLine>
<Link id="l04030" /><CodeLine lineNumber="4030"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> LIS-&gt;<a href="/docs/api/classes/llvm/liveintervals/#abc913cf0bab81b94548cd3c8eeb33117">intervalIsInOneMBB</a>(LIS-&gt;<a href="/docs/api/classes/llvm/liveintervals/#a8208eacaf02c9742c8ed7f09ec0837f3">getInterval</a>(SrcReg)) ||</span></CodeLine>
<Link id="l04031" /><CodeLine lineNumber="4031"><span class="doxyHighlight">         LIS-&gt;<a href="/docs/api/classes/llvm/liveintervals/#abc913cf0bab81b94548cd3c8eeb33117">intervalIsInOneMBB</a>(LIS-&gt;<a href="/docs/api/classes/llvm/liveintervals/#a8208eacaf02c9742c8ed7f09ec0837f3">getInterval</a>(DstReg));</span></CodeLine>
<Link id="l04032" /><CodeLine lineNumber="4032"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04033" /><CodeLine lineNumber="4033"></CodeLine>
<Link id="l04034" /><CodeLine lineNumber="4034"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::lateLiveIntervalUpdate() &#123;</span></CodeLine>
<Link id="l04035" /><CodeLine lineNumber="4035"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/register">Register</a> reg : ToBeUpdated) &#123;</span></CodeLine>
<Link id="l04036" /><CodeLine lineNumber="4036"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LIS-&gt;hasInterval(reg))</span></CodeLine>
<Link id="l04037" /><CodeLine lineNumber="4037"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04038" /><CodeLine lineNumber="4038"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI = LIS-&gt;getInterval(reg);</span></CodeLine>
<Link id="l04039" /><CodeLine lineNumber="4039"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregstackify-cpp/#ab4c68b8293672c79332578b06398c27a">shrinkToUses</a>(&amp;LI, &amp;DeadDefs);</span></CodeLine>
<Link id="l04040" /><CodeLine lineNumber="4040"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DeadDefs.empty())</span></CodeLine>
<Link id="l04041" /><CodeLine lineNumber="4041"><span class="doxyHighlight">      eliminateDeadDefs();</span></CodeLine>
<Link id="l04042" /><CodeLine lineNumber="4042"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04043" /><CodeLine lineNumber="4043"><span class="doxyHighlight">  ToBeUpdated.<a href="/docs/api/classes/llvm/machinebasicblock/#a2be0839c1c2ac22d7c65f8a175105959">clear</a>();</span></CodeLine>
<Link id="l04044" /><CodeLine lineNumber="4044"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04045" /><CodeLine lineNumber="4045"></CodeLine>
<Link id="l04046" /><CodeLine lineNumber="4046"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::copyCoalesceWorkList(</span></CodeLine>
<Link id="l04047" /><CodeLine lineNumber="4047"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/mutablearrayref">MutableArrayRef&lt;MachineInstr &#42;&gt;</a> CurrList) &#123;</span></CodeLine>
<Link id="l04048" /><CodeLine lineNumber="4048"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Progress = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04049" /><CodeLine lineNumber="4049"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;MachineInstr &#42;, 4&gt;</a> CurrentErasedInstrs;</span></CodeLine>
<Link id="l04050" /><CodeLine lineNumber="4050"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : CurrList) &#123;</span></CodeLine>
<Link id="l04051" /><CodeLine lineNumber="4051"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)</span></CodeLine>
<Link id="l04052" /><CodeLine lineNumber="4052"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04053" /><CodeLine lineNumber="4053"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Skip instruction pointers that have already been erased, for example by</span></CodeLine>
<Link id="l04054" /><CodeLine lineNumber="4054"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// dead code elimination.</span></CodeLine>
<Link id="l04055" /><CodeLine lineNumber="4055"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ErasedInstrs.count(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) || CurrentErasedInstrs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) &#123;</span></CodeLine>
<Link id="l04056" /><CodeLine lineNumber="4056"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04057" /><CodeLine lineNumber="4057"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04058" /><CodeLine lineNumber="4058"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04059" /><CodeLine lineNumber="4059"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Again = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04060" /><CodeLine lineNumber="4060"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> = joinCopy(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, Again, CurrentErasedInstrs);</span></CodeLine>
<Link id="l04061" /><CodeLine lineNumber="4061"><span class="doxyHighlight">    Progress |= <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a>;</span></CodeLine>
<Link id="l04062" /><CodeLine lineNumber="4062"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/lib/target/aarch64/disassembler/aarch64disassembler-cpp/#abdb086b34295fb7aa09493c62d798465">Success</a> || !Again)</span></CodeLine>
<Link id="l04063" /><CodeLine lineNumber="4063"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04064" /><CodeLine lineNumber="4064"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04065" /><CodeLine lineNumber="4065"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Clear instructions not recorded in &#96;ErasedInstrs&#96; but erased.</span></CodeLine>
<Link id="l04066" /><CodeLine lineNumber="4066"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!CurrentErasedInstrs.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#af8a50544090e81ac83601aff8f4b0142">empty</a>()) &#123;</span></CodeLine>
<Link id="l04067" /><CodeLine lineNumber="4067"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : CurrList) &#123;</span></CodeLine>
<Link id="l04068" /><CodeLine lineNumber="4068"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &amp;&amp; CurrentErasedInstrs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</span></CodeLine>
<Link id="l04069" /><CodeLine lineNumber="4069"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04070" /><CodeLine lineNumber="4070"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04071" /><CodeLine lineNumber="4071"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : WorkList) &#123;</span></CodeLine>
<Link id="l04072" /><CodeLine lineNumber="4072"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> &amp;&amp; CurrentErasedInstrs.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a1f475b0df44ebd7169e720fa1bf9169e">count</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</span></CodeLine>
<Link id="l04073" /><CodeLine lineNumber="4073"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04074" /><CodeLine lineNumber="4074"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04075" /><CodeLine lineNumber="4075"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04076" /><CodeLine lineNumber="4076"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Progress;</span></CodeLine>
<Link id="l04077" /><CodeLine lineNumber="4077"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04078" /><CodeLine lineNumber="4078"></CodeLine>
<Link id="l04079" /><CodeLine lineNumber="4079"><span class="doxyHighlightComment">/// Check if DstReg is a terminal node.</span></CodeLine>
<Link id="l04080" /><CodeLine lineNumber="4080"><span class="doxyHighlightComment">/// I.e., it does not have any affinity other than \\p Copy.</span></CodeLine>
<Link id="l04081" /><CodeLine lineNumber="4081" lineLink="#a68605e0cce17bf8b11fc0a3e9be11854"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="#a68605e0cce17bf8b11fc0a3e9be11854">isTerminalReg</a>(<a href="/docs/api/classes/llvm/register">Register</a> DstReg, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;Copy,</span></CodeLine>
<Link id="l04082" /><CodeLine lineNumber="4082"><span class="doxyHighlight">                          </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineregisterinfo">MachineRegisterInfo</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>) &#123;</span></CodeLine>
<Link id="l04083" /><CodeLine lineNumber="4083"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Copy.isCopyLike());</span></CodeLine>
<Link id="l04084" /><CodeLine lineNumber="4084"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check if the destination of this copy as any other affinity.</span></CodeLine>
<Link id="l04085" /><CodeLine lineNumber="4085"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;reg&#95;nodbg&#95;instructions(DstReg))</span></CodeLine>
<Link id="l04086" /><CodeLine lineNumber="4086"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> != &amp;Copy &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCopyLike())</span></CodeLine>
<Link id="l04087" /><CodeLine lineNumber="4087"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04088" /><CodeLine lineNumber="4088"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04089" /><CodeLine lineNumber="4089"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04090" /><CodeLine lineNumber="4090"></CodeLine>
<Link id="l04091" /><CodeLine lineNumber="4091"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> RegisterCoalescer::applyTerminalRule(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;Copy)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l04092" /><CodeLine lineNumber="4092"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/codeview/#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>.isCopyLike());</span></CodeLine>
<Link id="l04093" /><CodeLine lineNumber="4093"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aec45e8545effa6685109d97842d8572a">UseTerminalRule</a>)</span></CodeLine>
<Link id="l04094" /><CodeLine lineNumber="4094"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04095" /><CodeLine lineNumber="4095"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> SrcReg, DstReg;</span></CodeLine>
<Link id="l04096" /><CodeLine lineNumber="4096"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SrcSubReg = 0, DstSubReg = 0;</span></CodeLine>
<Link id="l04097" /><CodeLine lineNumber="4097"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aaeffdea43602557f6c520f6b9501a491">isMoveInstr</a>(&#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, &amp;Copy, SrcReg, DstReg, SrcSubReg, DstSubReg))</span></CodeLine>
<Link id="l04098" /><CodeLine lineNumber="4098"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04099" /><CodeLine lineNumber="4099"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check if the destination of this copy has any other affinity.</span></CodeLine>
<Link id="l04100" /><CodeLine lineNumber="4100"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DstReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() ||</span></CodeLine>
<Link id="l04101" /><CodeLine lineNumber="4101"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If SrcReg is a physical register, the copy won&#39;t be coalesced.</span></CodeLine>
<Link id="l04102" /><CodeLine lineNumber="4102"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Ignoring it may have other side effect (like missing</span></CodeLine>
<Link id="l04103" /><CodeLine lineNumber="4103"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// rematerialization). So keep it.</span></CodeLine>
<Link id="l04104" /><CodeLine lineNumber="4104"><span class="doxyHighlight">      SrcReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() || !<a href="#a68605e0cce17bf8b11fc0a3e9be11854">isTerminalReg</a>(DstReg, Copy, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</span></CodeLine>
<Link id="l04105" /><CodeLine lineNumber="4105"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04106" /><CodeLine lineNumber="4106"></CodeLine>
<Link id="l04107" /><CodeLine lineNumber="4107"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// DstReg is a terminal node. Check if it interferes with any other</span></CodeLine>
<Link id="l04108" /><CodeLine lineNumber="4108"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// copy involving SrcReg.</span></CodeLine>
<Link id="l04109" /><CodeLine lineNumber="4109"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;OrigBB = <a href="/docs/api/namespaces/llvm/codeview/#ad37302702bbcf0028581d2655698c27aa5fb63579fc981698f97d55bfecb213ea">Copy</a>.getParent();</span></CodeLine>
<Link id="l04110" /><CodeLine lineNumber="4110"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;DstLI = LIS-&gt;getInterval(DstReg);</span></CodeLine>
<Link id="l04111" /><CodeLine lineNumber="4111"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>-&gt;reg&#95;nodbg&#95;instructions(SrcReg)) &#123;</span></CodeLine>
<Link id="l04112" /><CodeLine lineNumber="4112"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Technically we should check if the weight of the new copy is</span></CodeLine>
<Link id="l04113" /><CodeLine lineNumber="4113"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// interesting compared to the other one and update the weight</span></CodeLine>
<Link id="l04114" /><CodeLine lineNumber="4114"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// of the copies accordingly. However, this would only work if</span></CodeLine>
<Link id="l04115" /><CodeLine lineNumber="4115"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// we would gather all the copies first then coalesce, whereas</span></CodeLine>
<Link id="l04116" /><CodeLine lineNumber="4116"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// right now we interleave both actions.</span></CodeLine>
<Link id="l04117" /><CodeLine lineNumber="4117"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// For now, just consider the copies that are in the same block.</span></CodeLine>
<Link id="l04118" /><CodeLine lineNumber="4118"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> == &amp;Copy || !<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCopyLike() || <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent() != OrigBB)</span></CodeLine>
<Link id="l04119" /><CodeLine lineNumber="4119"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04120" /><CodeLine lineNumber="4120"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/register">Register</a> OtherSrcReg, OtherReg;</span></CodeLine>
<Link id="l04121" /><CodeLine lineNumber="4121"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> OtherSrcSubReg = 0, OtherSubReg = 0;</span></CodeLine>
<Link id="l04122" /><CodeLine lineNumber="4122"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="#aaeffdea43602557f6c520f6b9501a491">isMoveInstr</a>(&#42;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a0f36ed1bc17fc1aa97fe291c439a0698">TRI</a>, &amp;Copy, OtherSrcReg, OtherReg, OtherSrcSubReg,</span></CodeLine>
<Link id="l04123" /><CodeLine lineNumber="4123"><span class="doxyHighlight">                     OtherSubReg))</span></CodeLine>
<Link id="l04124" /><CodeLine lineNumber="4124"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04125" /><CodeLine lineNumber="4125"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherReg == SrcReg)</span></CodeLine>
<Link id="l04126" /><CodeLine lineNumber="4126"><span class="doxyHighlight">      OtherReg = OtherSrcReg;</span></CodeLine>
<Link id="l04127" /><CodeLine lineNumber="4127"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check if OtherReg is a non-terminal.</span></CodeLine>
<Link id="l04128" /><CodeLine lineNumber="4128"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OtherReg.<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() || <a href="#a68605e0cce17bf8b11fc0a3e9be11854">isTerminalReg</a>(OtherReg, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#aacd2ab195054a3e6a74bfbb9d5d571c8">MRI</a>))</span></CodeLine>
<Link id="l04129" /><CodeLine lineNumber="4129"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04130" /><CodeLine lineNumber="4130"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Check that OtherReg interfere with DstReg.</span></CodeLine>
<Link id="l04131" /><CodeLine lineNumber="4131"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LIS-&gt;getInterval(OtherReg).overlaps(DstLI)) &#123;</span></CodeLine>
<Link id="l04132" /><CodeLine lineNumber="4132"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Apply terminal rule for: &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(DstReg)</span></CodeLine>
<Link id="l04133" /><CodeLine lineNumber="4133"><span class="doxyHighlight">                        &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04134" /><CodeLine lineNumber="4134"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04135" /><CodeLine lineNumber="4135"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04136" /><CodeLine lineNumber="4136"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04137" /><CodeLine lineNumber="4137"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04138" /><CodeLine lineNumber="4138"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04139" /><CodeLine lineNumber="4139"></CodeLine>
<Link id="l04140" /><CodeLine lineNumber="4140"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::copyCoalesceInMBB(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l04141" /><CodeLine lineNumber="4141"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#aedf6cb1135961f41f39dc58ca8576123">getName</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;:\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04142" /><CodeLine lineNumber="4142"></CodeLine>
<Link id="l04143" /><CodeLine lineNumber="4143"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Collect all copy-like instructions in MBB. Don&#39;t start coalescing anything</span></CodeLine>
<Link id="l04144" /><CodeLine lineNumber="4144"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// yet, it might invalidate the iterator.</span></CodeLine>
<Link id="l04145" /><CodeLine lineNumber="4145"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> PrevSize = WorkList.size();</span></CodeLine>
<Link id="l04146" /><CodeLine lineNumber="4146"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (JoinGlobalCopies) &#123;</span></CodeLine>
<Link id="l04147" /><CodeLine lineNumber="4147"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineInstr &#42;, 2&gt;</a> LocalTerminals;</span></CodeLine>
<Link id="l04148" /><CodeLine lineNumber="4148"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineInstr &#42;, 2&gt;</a> GlobalTerminals;</span></CodeLine>
<Link id="l04149" /><CodeLine lineNumber="4149"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Coalesce copies bottom-up to coalesce local defs before local uses. They</span></CodeLine>
<Link id="l04150" /><CodeLine lineNumber="4150"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// are not inherently easier to resolve, but slightly preferable until we</span></CodeLine>
<Link id="l04151" /><CodeLine lineNumber="4151"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// have local live range splitting. In particular this is required by</span></CodeLine>
<Link id="l04152" /><CodeLine lineNumber="4152"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// cmp+jmp macro fusion.</span></CodeLine>
<Link id="l04153" /><CodeLine lineNumber="4153"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l04154" /><CodeLine lineNumber="4154"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCopyLike())</span></CodeLine>
<Link id="l04155" /><CodeLine lineNumber="4155"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04156" /><CodeLine lineNumber="4156"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> ApplyTerminalRule = applyTerminalRule(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l04157" /><CodeLine lineNumber="4157"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a272a95f31ec948e680a3c7dffd3c7f80">isLocalCopy</a>(&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, LIS)) &#123;</span></CodeLine>
<Link id="l04158" /><CodeLine lineNumber="4158"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ApplyTerminalRule)</span></CodeLine>
<Link id="l04159" /><CodeLine lineNumber="4159"><span class="doxyHighlight">          LocalTerminals.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l04160" /><CodeLine lineNumber="4160"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04161" /><CodeLine lineNumber="4161"><span class="doxyHighlight">          LocalWorkList.push&#95;back(&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l04162" /><CodeLine lineNumber="4162"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l04163" /><CodeLine lineNumber="4163"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ApplyTerminalRule)</span></CodeLine>
<Link id="l04164" /><CodeLine lineNumber="4164"><span class="doxyHighlight">          GlobalTerminals.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l04165" /><CodeLine lineNumber="4165"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04166" /><CodeLine lineNumber="4166"><span class="doxyHighlight">          WorkList.push&#95;back(&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l04167" /><CodeLine lineNumber="4167"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04168" /><CodeLine lineNumber="4168"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04169" /><CodeLine lineNumber="4169"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Append the copies evicted by the terminal rule at the end of the list.</span></CodeLine>
<Link id="l04170" /><CodeLine lineNumber="4170"><span class="doxyHighlight">    LocalWorkList.<a href="/docs/api/classes/llvm/smallvectorimpl/#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(LocalTerminals.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), LocalTerminals.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>());</span></CodeLine>
<Link id="l04171" /><CodeLine lineNumber="4171"><span class="doxyHighlight">    WorkList.append(GlobalTerminals.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), GlobalTerminals.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>());</span></CodeLine>
<Link id="l04172" /><CodeLine lineNumber="4172"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l04173" /><CodeLine lineNumber="4173"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineInstr &#42;, 2&gt;</a> Terminals;</span></CodeLine>
<Link id="l04174" /><CodeLine lineNumber="4174"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;MII : &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>)</span></CodeLine>
<Link id="l04175" /><CodeLine lineNumber="4175"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MII.isCopyLike()) &#123;</span></CodeLine>
<Link id="l04176" /><CodeLine lineNumber="4176"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (applyTerminalRule(MII))</span></CodeLine>
<Link id="l04177" /><CodeLine lineNumber="4177"><span class="doxyHighlight">          Terminals.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&amp;MII);</span></CodeLine>
<Link id="l04178" /><CodeLine lineNumber="4178"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04179" /><CodeLine lineNumber="4179"><span class="doxyHighlight">          WorkList.push&#95;back(&amp;MII);</span></CodeLine>
<Link id="l04180" /><CodeLine lineNumber="4180"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04181" /><CodeLine lineNumber="4181"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Append the copies evicted by the terminal rule at the end of the list.</span></CodeLine>
<Link id="l04182" /><CodeLine lineNumber="4182"><span class="doxyHighlight">    WorkList.<a href="/docs/api/classes/llvm/smallvectorimpl/#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(Terminals.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), Terminals.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>());</span></CodeLine>
<Link id="l04183" /><CodeLine lineNumber="4183"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04184" /><CodeLine lineNumber="4184"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Try coalescing the collected copies immediately, and remove the nulls.</span></CodeLine>
<Link id="l04185" /><CodeLine lineNumber="4185"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This prevents the WorkList from getting too large since most copies are</span></CodeLine>
<Link id="l04186" /><CodeLine lineNumber="4186"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// joinable on the first attempt.</span></CodeLine>
<Link id="l04187" /><CodeLine lineNumber="4187"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/mutablearrayref">MutableArrayRef&lt;MachineInstr &#42;&gt;</a> CurrList(WorkList.begin() + PrevSize,</span></CodeLine>
<Link id="l04188" /><CodeLine lineNumber="4188"><span class="doxyHighlight">                                           WorkList.end());</span></CodeLine>
<Link id="l04189" /><CodeLine lineNumber="4189"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (copyCoalesceWorkList(CurrList))</span></CodeLine>
<Link id="l04190" /><CodeLine lineNumber="4190"><span class="doxyHighlight">    WorkList.erase(</span></CodeLine>
<Link id="l04191" /><CodeLine lineNumber="4191"><span class="doxyHighlight">        std::remove(WorkList.begin() + PrevSize, WorkList.end(), </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l04192" /><CodeLine lineNumber="4192"><span class="doxyHighlight">        WorkList.end());</span></CodeLine>
<Link id="l04193" /><CodeLine lineNumber="4193"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04194" /><CodeLine lineNumber="4194"></CodeLine>
<Link id="l04195" /><CodeLine lineNumber="4195"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::coalesceLocals() &#123;</span></CodeLine>
<Link id="l04196" /><CodeLine lineNumber="4196"><span class="doxyHighlight">  copyCoalesceWorkList(LocalWorkList);</span></CodeLine>
<Link id="l04197" /><CodeLine lineNumber="4197"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : LocalWorkList) &#123;</span></CodeLine>
<Link id="l04198" /><CodeLine lineNumber="4198"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)</span></CodeLine>
<Link id="l04199" /><CodeLine lineNumber="4199"><span class="doxyHighlight">      WorkList.push&#95;back(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l04200" /><CodeLine lineNumber="4200"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04201" /><CodeLine lineNumber="4201"><span class="doxyHighlight">  LocalWorkList.clear();</span></CodeLine>
<Link id="l04202" /><CodeLine lineNumber="4202"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04203" /><CodeLine lineNumber="4203"></CodeLine>
<Link id="l04204" /><CodeLine lineNumber="4204"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> RegisterCoalescer::joinAllIntervals() &#123;</span></CodeLine>
<Link id="l04205" /><CodeLine lineNumber="4205"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42; JOINING INTERVALS &#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04206" /><CodeLine lineNumber="4206"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(WorkList.empty() &amp;&amp; LocalWorkList.empty() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Old data still around.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04207" /><CodeLine lineNumber="4207"></CodeLine>
<Link id="l04208" /><CodeLine lineNumber="4208"><span class="doxyHighlight">  std::vector&lt;MBBPriorityInfo&gt; MBBs;</span></CodeLine>
<Link id="l04209" /><CodeLine lineNumber="4209"><span class="doxyHighlight">  MBBs.reserve(MF-&gt;size());</span></CodeLine>
<Link id="l04210" /><CodeLine lineNumber="4210"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : &#42;MF) &#123;</span></CodeLine>
<Link id="l04211" /><CodeLine lineNumber="4211"><span class="doxyHighlight">    MBBs.push&#95;back(MBBPriorityInfo(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/files/lib/lib/target/lib/target/hexagon/hexagonhardwareloops-cpp/#ada7c1594a393ede3ce32602d64d7ddb2">Loops</a>-&gt;getLoopDepth(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>),</span></CodeLine>
<Link id="l04212" /><CodeLine lineNumber="4212"><span class="doxyHighlight">                                   JoinSplitEdges &amp;&amp; <a href="#a30f590c564c38a3893fcd46927b5e482">isSplitEdge</a>(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>)));</span></CodeLine>
<Link id="l04213" /><CodeLine lineNumber="4213"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04214" /><CodeLine lineNumber="4214"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#add1eb5637dd671428b6f138ed3db6428">array&#95;pod&#95;sort</a>(MBBs.begin(), MBBs.end(), <a href="#a33f10720d78f213773cb15eacbf5c65a">compareMBBPriority</a>);</span></CodeLine>
<Link id="l04215" /><CodeLine lineNumber="4215"></CodeLine>
<Link id="l04216" /><CodeLine lineNumber="4216"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Coalesce intervals in MBB priority order.</span></CodeLine>
<Link id="l04217" /><CodeLine lineNumber="4217"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> CurrDepth = std::numeric&#95;limits&lt;unsigned&gt;::max();</span></CodeLine>
<Link id="l04218" /><CodeLine lineNumber="4218"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MBBPriorityInfo &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : MBBs) &#123;</span></CodeLine>
<Link id="l04219" /><CodeLine lineNumber="4219"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Try coalescing the collected local copies for deeper loops.</span></CodeLine>
<Link id="l04220" /><CodeLine lineNumber="4220"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (JoinGlobalCopies &amp;&amp; <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.Depth &lt; CurrDepth) &#123;</span></CodeLine>
<Link id="l04221" /><CodeLine lineNumber="4221"><span class="doxyHighlight">      coalesceLocals();</span></CodeLine>
<Link id="l04222" /><CodeLine lineNumber="4222"><span class="doxyHighlight">      CurrDepth = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.Depth;</span></CodeLine>
<Link id="l04223" /><CodeLine lineNumber="4223"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04224" /><CodeLine lineNumber="4224"><span class="doxyHighlight">    copyCoalesceInMBB(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.MBB);</span></CodeLine>
<Link id="l04225" /><CodeLine lineNumber="4225"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04226" /><CodeLine lineNumber="4226"><span class="doxyHighlight">  lateLiveIntervalUpdate();</span></CodeLine>
<Link id="l04227" /><CodeLine lineNumber="4227"><span class="doxyHighlight">  coalesceLocals();</span></CodeLine>
<Link id="l04228" /><CodeLine lineNumber="4228"></CodeLine>
<Link id="l04229" /><CodeLine lineNumber="4229"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Joining intervals can allow other intervals to be joined.  Iteratively join</span></CodeLine>
<Link id="l04230" /><CodeLine lineNumber="4230"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// until we make no progress.</span></CodeLine>
<Link id="l04231" /><CodeLine lineNumber="4231"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (copyCoalesceWorkList(WorkList))</span></CodeLine>
<Link id="l04232" /><CodeLine lineNumber="4232"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">/&#42; empty &#42;/</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04233" /><CodeLine lineNumber="4233"><span class="doxyHighlight">  lateLiveIntervalUpdate();</span></CodeLine>
<Link id="l04234" /><CodeLine lineNumber="4234"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04235" /><CodeLine lineNumber="4235"></CodeLine>
<Link id="l04236" /><CodeLine lineNumber="4236" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a55edcac6ac25614b341d7c34c5a2926c"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a55edcac6ac25614b341d7c34c5a2926c">RegisterCoalescer::releaseMemory</a>() &#123;</span></CodeLine>
<Link id="l04237" /><CodeLine lineNumber="4237"><span class="doxyHighlight">  ErasedInstrs.clear();</span></CodeLine>
<Link id="l04238" /><CodeLine lineNumber="4238"><span class="doxyHighlight">  WorkList.clear();</span></CodeLine>
<Link id="l04239" /><CodeLine lineNumber="4239"><span class="doxyHighlight">  DeadDefs.clear();</span></CodeLine>
<Link id="l04240" /><CodeLine lineNumber="4240"><span class="doxyHighlight">  InflateRegs.clear();</span></CodeLine>
<Link id="l04241" /><CodeLine lineNumber="4241"><span class="doxyHighlight">  LargeLIVisitCounter.clear();</span></CodeLine>
<Link id="l04242" /><CodeLine lineNumber="4242"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04243" /><CodeLine lineNumber="4243"></CodeLine>
<Link id="l04244" /><CodeLine lineNumber="4244" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#aa408ab9747b8ce0bd0a81465c10e8f29"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#aa408ab9747b8ce0bd0a81465c10e8f29">RegisterCoalescer::runOnMachineFunction</a>(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;fn) &#123;</span></CodeLine>
<Link id="l04245" /><CodeLine lineNumber="4245"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42; REGISTER COALESCER &#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;\\n&quot;</span></CodeLine>
<Link id="l04246" /><CodeLine lineNumber="4246"><span class="doxyHighlight">                    &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42;&#42; Function: &quot;</span><span class="doxyHighlight"> &lt;&lt; fn.<a href="/docs/api/classes/llvm/machinefunction/#a3d142c9e7c066059e15232c56dec9e2e">getName</a>() &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04247" /><CodeLine lineNumber="4247"></CodeLine>
<Link id="l04248" /><CodeLine lineNumber="4248"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Variables changed between a setjmp and a longjump can have undefined value</span></CodeLine>
<Link id="l04249" /><CodeLine lineNumber="4249"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// after the longjmp. This behaviour can be observed if such a variable is</span></CodeLine>
<Link id="l04250" /><CodeLine lineNumber="4250"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// spilled, so longjmp won&#39;t restore the value in the spill slot.</span></CodeLine>
<Link id="l04251" /><CodeLine lineNumber="4251"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// RegisterCoalescer should not run in functions with a setjmp to avoid</span></CodeLine>
<Link id="l04252" /><CodeLine lineNumber="4252"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// merging such undefined variables with predictable ones.</span></CodeLine>
<Link id="l04253" /><CodeLine lineNumber="4253"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l04254" /><CodeLine lineNumber="4254"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: Could specifically disable coalescing registers live across setjmp</span></CodeLine>
<Link id="l04255" /><CodeLine lineNumber="4255"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// calls</span></CodeLine>
<Link id="l04256" /><CodeLine lineNumber="4256"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (fn.<a href="/docs/api/classes/llvm/machinefunction/#a4b94e0ca517e149914aa0c34ee06c9fa">exposesReturnsTwice</a>()) &#123;</span></CodeLine>
<Link id="l04257" /><CodeLine lineNumber="4257"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l04258" /><CodeLine lineNumber="4258"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;&#42; Skipped as it exposes functions that returns twice.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04259" /><CodeLine lineNumber="4259"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04260" /><CodeLine lineNumber="4260"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04261" /><CodeLine lineNumber="4261"></CodeLine>
<Link id="l04262" /><CodeLine lineNumber="4262"><span class="doxyHighlight">  MF = &amp;fn;</span></CodeLine>
<Link id="l04263" /><CodeLine lineNumber="4263"><span class="doxyHighlight">  MRI = &amp;fn.<a href="/docs/api/classes/llvm/machinefunction/#a810234b6b3d223b7c74a4253fcc5ea5e">getRegInfo</a>();</span></CodeLine>
<Link id="l04264" /><CodeLine lineNumber="4264"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetsubtargetinfo">TargetSubtargetInfo</a> &amp;STI = fn.<a href="/docs/api/classes/llvm/machinefunction/#a3825368aca2bc1550d173660df4da6a6">getSubtarget</a>();</span></CodeLine>
<Link id="l04265" /><CodeLine lineNumber="4265"><span class="doxyHighlight">  TRI = STI.<a href="/docs/api/classes/llvm/targetsubtargetinfo/#a43c530c830206ecf5ad3359364634c75">getRegisterInfo</a>();</span></CodeLine>
<Link id="l04266" /><CodeLine lineNumber="4266"><span class="doxyHighlight">  TII = STI.<a href="/docs/api/classes/llvm/targetsubtargetinfo/#acd858ed72f11db9444617740c3622608">getInstrInfo</a>();</span></CodeLine>
<Link id="l04267" /><CodeLine lineNumber="4267"><span class="doxyHighlight">  LIS = &amp;<a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;LiveIntervalsWrapperPass&gt;</a>().getLIS();</span></CodeLine>
<Link id="l04268" /><CodeLine lineNumber="4268"><span class="doxyHighlight">  AA = &amp;<a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;AAResultsWrapperPass&gt;</a>().getAAResults();</span></CodeLine>
<Link id="l04269" /><CodeLine lineNumber="4269"><span class="doxyHighlight">  Loops = &amp;<a href="/docs/api/classes/llvm/pass/#a4863e5e463fb79955269fbf7fbf52b80">getAnalysis&lt;MachineLoopInfoWrapperPass&gt;</a>().getLI();</span></CodeLine>
<Link id="l04270" /><CodeLine lineNumber="4270"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#a233a6770a940d2da877cafd1263f9dc8">EnableGlobalCopies</a> == <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44aa5bd521ebe67ddf0e90f1a9e540a6d43">cl::BOU&#95;UNSET</a>)</span></CodeLine>
<Link id="l04271" /><CodeLine lineNumber="4271"><span class="doxyHighlight">    JoinGlobalCopies = STI.<a href="/docs/api/classes/llvm/targetsubtargetinfo/#a1322687bebc99c66aa3e9ed55b4e384d">enableJoinGlobalCopies</a>();</span></CodeLine>
<Link id="l04272" /><CodeLine lineNumber="4272"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l04273" /><CodeLine lineNumber="4273"><span class="doxyHighlight">    JoinGlobalCopies = (<a href="#a233a6770a940d2da877cafd1263f9dc8">EnableGlobalCopies</a> == <a href="/docs/api/namespaces/llvm/cl/#a9241f2e42b7587b123c885d7a659ad44ad7c4bd83c337c86d34f6c2d8eba1e736">cl::BOU&#95;TRUE</a>);</span></CodeLine>
<Link id="l04274" /><CodeLine lineNumber="4274"></CodeLine>
<Link id="l04275" /><CodeLine lineNumber="4275"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there are PHIs tracked by debug-info, they will need updating during</span></CodeLine>
<Link id="l04276" /><CodeLine lineNumber="4276"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// coalescing. Build an index of those PHIs to ease updating.</span></CodeLine>
<Link id="l04277" /><CodeLine lineNumber="4277"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/slotindexes">SlotIndexes</a> &#42;Slots = LIS-&gt;getSlotIndexes();</span></CodeLine>
<Link id="l04278" /><CodeLine lineNumber="4278"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;DebugPHI : MF-&gt;DebugPHIPositions) &#123;</span></CodeLine>
<Link id="l04279" /><CodeLine lineNumber="4279"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = DebugPHI.second.MBB;</span></CodeLine>
<Link id="l04280" /><CodeLine lineNumber="4280"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/register">Register</a> Reg = DebugPHI.second.Reg;</span></CodeLine>
<Link id="l04281" /><CodeLine lineNumber="4281"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a> = DebugPHI.second.SubReg;</span></CodeLine>
<Link id="l04282" /><CodeLine lineNumber="4282"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/slotindex">SlotIndex</a> <a href="/docs/api/namespaces/llvm/si">SI</a> = Slots-&gt;<a href="/docs/api/classes/llvm/slotindexes/#aaf0c07cc1cdb9c78c6dfdfdd5913420a">getMBBStartIdx</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l04283" /><CodeLine lineNumber="4283"><span class="doxyHighlight">    PHIValPos <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = &#123;<a href="/docs/api/namespaces/llvm/si">SI</a>, Reg, <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64advsimdscalarpass-cpp/#a92a6b0a9b7228d190b0a7d8ae3ef03c7">SubReg</a>&#125;;</span></CodeLine>
<Link id="l04284" /><CodeLine lineNumber="4284"><span class="doxyHighlight">    PHIValToPos.insert(std::make&#95;pair(DebugPHI.first, <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>));</span></CodeLine>
<Link id="l04285" /><CodeLine lineNumber="4285"><span class="doxyHighlight">    RegToPHIIdx&#91;Reg&#93;.push&#95;back(DebugPHI.first);</span></CodeLine>
<Link id="l04286" /><CodeLine lineNumber="4286"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04287" /><CodeLine lineNumber="4287"></CodeLine>
<Link id="l04288" /><CodeLine lineNumber="4288"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The MachineScheduler does not currently require JoinSplitEdges. This will</span></CodeLine>
<Link id="l04289" /><CodeLine lineNumber="4289"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// either be enabled unconditionally or replaced by a more general live range</span></CodeLine>
<Link id="l04290" /><CodeLine lineNumber="4290"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// splitting optimization.</span></CodeLine>
<Link id="l04291" /><CodeLine lineNumber="4291"><span class="doxyHighlight">  JoinSplitEdges = <a href="#ab3861763540aea165ffd7a63a0bc2f06">EnableJoinSplits</a>;</span></CodeLine>
<Link id="l04292" /><CodeLine lineNumber="4292"></CodeLine>
<Link id="l04293" /><CodeLine lineNumber="4293"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#aa8b58294e993b77e8215298b1ef440a6">VerifyCoalescing</a>)</span></CodeLine>
<Link id="l04294" /><CodeLine lineNumber="4294"><span class="doxyHighlight">    MF-&gt;verify(</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">, </span><span class="doxyHighlightStringLiteral">&quot;Before register coalescing&quot;</span><span class="doxyHighlight">, &amp;<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>());</span></CodeLine>
<Link id="l04295" /><CodeLine lineNumber="4295"></CodeLine>
<Link id="l04296" /><CodeLine lineNumber="4296"><span class="doxyHighlight">  DbgVRegToValues.clear();</span></CodeLine>
<Link id="l04297" /><CodeLine lineNumber="4297"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/webassembly/webassemblyregcoloring-cpp/#a363e3f71faf094bba68a16bb32f43cff">buildVRegToDbgValueMap</a>(fn);</span></CodeLine>
<Link id="l04298" /><CodeLine lineNumber="4298"></CodeLine>
<Link id="l04299" /><CodeLine lineNumber="4299"><span class="doxyHighlight">  RegClassInfo.runOnMachineFunction(fn);</span></CodeLine>
<Link id="l04300" /><CodeLine lineNumber="4300"></CodeLine>
<Link id="l04301" /><CodeLine lineNumber="4301"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Join (coalesce) intervals if requested.</span></CodeLine>
<Link id="l04302" /><CodeLine lineNumber="4302"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#ab8ef19815a62704144427de2c79d058e">EnableJoining</a>)</span></CodeLine>
<Link id="l04303" /><CodeLine lineNumber="4303"><span class="doxyHighlight">    joinAllIntervals();</span></CodeLine>
<Link id="l04304" /><CodeLine lineNumber="4304"></CodeLine>
<Link id="l04305" /><CodeLine lineNumber="4305"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// After deleting a lot of copies, register classes may be less constrained.</span></CodeLine>
<Link id="l04306" /><CodeLine lineNumber="4306"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Removing sub-register operands may allow GR32&#95;ABCD -&gt; GR32 and DPR&#95;VFP2 -&gt;</span></CodeLine>
<Link id="l04307" /><CodeLine lineNumber="4307"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// DPR inflation.</span></CodeLine>
<Link id="l04308" /><CodeLine lineNumber="4308"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#add1eb5637dd671428b6f138ed3db6428">array&#95;pod&#95;sort</a>(InflateRegs.begin(), InflateRegs.end());</span></CodeLine>
<Link id="l04309" /><CodeLine lineNumber="4309"><span class="doxyHighlight">  InflateRegs.erase(<a href="/docs/api/namespaces/llvm/#a48f85da577c6ce7d9aed90437dc0d07c">llvm::unique</a>(InflateRegs), InflateRegs.end());</span></CodeLine>
<Link id="l04310" /><CodeLine lineNumber="4310"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Trying to inflate &quot;</span><span class="doxyHighlight"> &lt;&lt; InflateRegs.size()</span></CodeLine>
<Link id="l04311" /><CodeLine lineNumber="4311"><span class="doxyHighlight">                    &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; regs.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04312" /><CodeLine lineNumber="4312"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/register">Register</a> Reg : InflateRegs) &#123;</span></CodeLine>
<Link id="l04313" /><CodeLine lineNumber="4313"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MRI-&gt;reg&#95;nodbg&#95;empty(Reg))</span></CodeLine>
<Link id="l04314" /><CodeLine lineNumber="4314"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04315" /><CodeLine lineNumber="4315"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MRI-&gt;recomputeRegClass(Reg)) &#123;</span></CodeLine>
<Link id="l04316" /><CodeLine lineNumber="4316"><span class="doxyHighlight">      <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a href="/docs/api/namespaces/llvm/#af085ea923a328b9fa6a1975f1a4ff987">printReg</a>(Reg) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; inflated to &quot;</span></CodeLine>
<Link id="l04317" /><CodeLine lineNumber="4317"><span class="doxyHighlight">                        &lt;&lt; TRI-&gt;getRegClassName(MRI-&gt;getRegClass(Reg)) &lt;&lt; </span><span class="doxyHighlightCharLiteral">&#39;\\n&#39;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04318" /><CodeLine lineNumber="4318"><span class="doxyHighlight">      ++NumInflated;</span></CodeLine>
<Link id="l04319" /><CodeLine lineNumber="4319"></CodeLine>
<Link id="l04320" /><CodeLine lineNumber="4320"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/liveinterval">LiveInterval</a> &amp;LI = LIS-&gt;getInterval(Reg);</span></CodeLine>
<Link id="l04321" /><CodeLine lineNumber="4321"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LI.<a href="/docs/api/classes/llvm/liveinterval/#a1c198291d6ee66150b76633cda8a1749">hasSubRanges</a>()) &#123;</span></CodeLine>
<Link id="l04322" /><CodeLine lineNumber="4322"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If the inflated register class does not support subregisters anymore</span></CodeLine>
<Link id="l04323" /><CodeLine lineNumber="4323"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// remove the subranges.</span></CodeLine>
<Link id="l04324" /><CodeLine lineNumber="4324"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!MRI-&gt;shouldTrackSubRegLiveness(Reg)) &#123;</span></CodeLine>
<Link id="l04325" /><CodeLine lineNumber="4325"><span class="doxyHighlight">          LI.<a href="/docs/api/classes/llvm/liveinterval/#afbdcbb3187e46987286c59c4963e21ae">clearSubRanges</a>();</span></CodeLine>
<Link id="l04326" /><CodeLine lineNumber="4326"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l04327" /><CodeLine lineNumber="4327"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l04328" /><CodeLine lineNumber="4328"><span class="doxyHighlight">          <a href="/docs/api/structs/llvm/lanebitmask">LaneBitmask</a> MaxMask = MRI-&gt;getMaxLaneMaskForVReg(Reg);</span></CodeLine>
<Link id="l04329" /><CodeLine lineNumber="4329"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// If subranges are still supported, then the same subregs</span></CodeLine>
<Link id="l04330" /><CodeLine lineNumber="4330"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// should still be supported.</span></CodeLine>
<Link id="l04331" /><CodeLine lineNumber="4331"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/liveinterval/subrange">LiveInterval::SubRange</a> &amp;S : LI.<a href="/docs/api/classes/llvm/liveinterval/#a9545a896d571165e9f43cf4b29a6d072">subranges</a>()) &#123;</span></CodeLine>
<Link id="l04332" /><CodeLine lineNumber="4332"><span class="doxyHighlight">            <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((S.LaneMask &amp; ~MaxMask).none());</span></CodeLine>
<Link id="l04333" /><CodeLine lineNumber="4333"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l04334" /><CodeLine lineNumber="4334"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l04335" /><CodeLine lineNumber="4335"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l04336" /><CodeLine lineNumber="4336"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04337" /><CodeLine lineNumber="4337"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04338" /><CodeLine lineNumber="4338"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04339" /><CodeLine lineNumber="4339"></CodeLine>
<Link id="l04340" /><CodeLine lineNumber="4340"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// After coalescing, update any PHIs that are being tracked by debug-info</span></CodeLine>
<Link id="l04341" /><CodeLine lineNumber="4341"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// with their new VReg locations.</span></CodeLine>
<Link id="l04342" /><CodeLine lineNumber="4342"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;p : MF-&gt;DebugPHIPositions) &#123;</span></CodeLine>
<Link id="l04343" /><CodeLine lineNumber="4343"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> it = PHIValToPos.find(p.first);</span></CodeLine>
<Link id="l04344" /><CodeLine lineNumber="4344"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(it != PHIValToPos.end());</span></CodeLine>
<Link id="l04345" /><CodeLine lineNumber="4345"><span class="doxyHighlight">    p.second.Reg = it-&gt;second.Reg;</span></CodeLine>
<Link id="l04346" /><CodeLine lineNumber="4346"><span class="doxyHighlight">    p.second.SubReg = it-&gt;second.SubReg;</span></CodeLine>
<Link id="l04347" /><CodeLine lineNumber="4347"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04348" /><CodeLine lineNumber="4348"></CodeLine>
<Link id="l04349" /><CodeLine lineNumber="4349"><span class="doxyHighlight">  PHIValToPos.clear();</span></CodeLine>
<Link id="l04350" /><CodeLine lineNumber="4350"><span class="doxyHighlight">  RegToPHIIdx.clear();</span></CodeLine>
<Link id="l04351" /><CodeLine lineNumber="4351"></CodeLine>
<Link id="l04352" /><CodeLine lineNumber="4352"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a03503773241005f01b090b9862aad304">dump</a>());</span></CodeLine>
<Link id="l04353" /><CodeLine lineNumber="4353"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#aa8b58294e993b77e8215298b1ef440a6">VerifyCoalescing</a>)</span></CodeLine>
<Link id="l04354" /><CodeLine lineNumber="4354"><span class="doxyHighlight">    MF-&gt;verify(</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">, </span><span class="doxyHighlightStringLiteral">&quot;After register coalescing&quot;</span><span class="doxyHighlight">, &amp;<a href="/docs/api/namespaces/llvm/#a9a7b5c68c90f85baaedaa854cc5002cc">errs</a>());</span></CodeLine>
<Link id="l04355" /><CodeLine lineNumber="4355"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04356" /><CodeLine lineNumber="4356"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04357" /><CodeLine lineNumber="4357"></CodeLine>
<Link id="l04358" /><CodeLine lineNumber="4358" lineLink="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a4ef281c7441a224dc5d5e31f795ff2e1"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-registercoalescer-cpp-/registercoalescer/#a4ef281c7441a224dc5d5e31f795ff2e1">RegisterCoalescer::print</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;O, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/module">Module</a> &#42;m)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l04359" /><CodeLine lineNumber="4359"><span class="doxyHighlight">  LIS-&gt;print(O);</span></CodeLine>
<Link id="l04360" /><CodeLine lineNumber="4360"><span class="doxyHighlight">&#125;</span></CodeLine>

</ProgramListing>


</DoxygenPage>
