---

# DO NOT EDIT!
# Automatically generated via docusaurus-plugin-doxygen by Doxygen.

slug: /api/files/lib/lib/codegen/lib/codegen/livedebugvalues/instrrefbasedimpl-cpp
custom_edit_url: null
keywords:
  - doxygen
  - reference
  - file

---

import Link from '@docusaurus/Link'

import CodeLine from '@xpack/docusaurus-plugin-doxygen/components/CodeLine'
import DoxygenPage from '@xpack/docusaurus-plugin-doxygen/components/DoxygenPage'
import IncludesList from '@xpack/docusaurus-plugin-doxygen/components/IncludesList'
import IncludesListItem from '@xpack/docusaurus-plugin-doxygen/components/IncludesListItem'
import MemberDefinition from '@xpack/docusaurus-plugin-doxygen/components/MemberDefinition'
import MembersIndex from '@xpack/docusaurus-plugin-doxygen/components/MembersIndex'
import MembersIndexItem from '@xpack/docusaurus-plugin-doxygen/components/MembersIndexItem'
import ProgramListing from '@xpack/docusaurus-plugin-doxygen/components/ProgramListing'
import SectionDefinition from '@xpack/docusaurus-plugin-doxygen/components/SectionDefinition'

import pluginConfig from '@site/docusaurus-plugin-doxygen-config.json'

# The `InstrRefBasedImpl.cpp` File Reference

<DoxygenPage pluginConfig={pluginConfig}>

This is a separate implementation of <a href="/docs/api/namespaces/livedebugvalues">LiveDebugValues</a>, see <a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/livedebugvalues-cpp">LiveDebugValues.cpp</a> and <a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/varlocbasedimpl-cpp">VarLocBasedImpl.cpp</a> for more information. <a href="#details">More...</a>

## Included Headers

<IncludesList>
<IncludesListItem
  filePath="llvm/ADT/DenseMap.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/densemap-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/PostOrderIterator.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/postorderiterator-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/STLExtras.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/stlextras-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallPtrSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallptrset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallSet.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallset-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/ADT/SmallVector.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/adt/smallvector-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/BinaryFormat/Dwarf.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/binaryformat/dwarf-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/LexicalScopes.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/lexicalscopes-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineBasicBlock.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machinebasicblock-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineDominators.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machinedominators-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineFrameInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineframeinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineFunction.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machinefunction-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineInstr.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstr-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineInstrBuilder.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstrbuilder-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineInstrBundle.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstrbundle-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineMemOperand.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machinememoperand-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/MachineOperand.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/machineoperand-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/PseudoSourceValue.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/pseudosourcevalue-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetFrameLowering.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetframelowering-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetInstrInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetinstrinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetLowering.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetlowering-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetPassConfig.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetpassconfig-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetRegisterInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetregisterinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/CodeGen/TargetSubtargetInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/codegen/targetsubtargetinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Config/llvm-config.h"
  permalink=""
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DebugInfoMetadata.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/debuginfometadata-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/DebugLoc.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/debugloc-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/IR/Function.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/ir/function-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/MC/MCRegisterInfo.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/mc/mcregisterinfo-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Casting.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/casting-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Compiler.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/Debug.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/debug-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/GenericIteratedDominanceFrontier.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/genericiterateddominancefrontier-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/TypeSize.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/typesize-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Support/raw_ostream.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/support/raw-ostream-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Target/TargetMachine.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/target/targetmachine-h"
  isLocal="true" />
<IncludesListItem
  filePath="llvm/Transforms/Utils/SSAUpdaterImpl.h"
  permalink="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/ssaupdaterimpl-h"
  isLocal="true" />
<IncludesListItem
  filePath="algorithm"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cassert"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="climits"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="cstdint"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="functional"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="queue"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="tuple"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="utility"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="vector"
  permalink=""
  isLocal="false" />
<IncludesListItem
  filePath="InstrRefBasedImpl.h"
  permalink="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/instrrefbasedimpl-h"
  isLocal="true" />
<IncludesListItem
  filePath="LiveDebugValues.h"
  permalink="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/livedebugvalues-h"
  isLocal="true" />
<IncludesListItem
  filePath="optional"
  permalink=""
  isLocal="false" />
</IncludesList>

## Namespaces Index

<MembersIndex>

<MembersIndexItem
  type="namespace"
  name={<><a href="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-">anonymous&#123;InstrRefBasedImpl.cpp&#125;</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="namespace"
  name={<><a href="/docs/api/namespaces/llvm">llvm</a></>}>
This is an optimization pass for GlobalISel generic memory operations. <a href="/docs/api/namespaces/llvm/#details">More...</a>
</MembersIndexItem>

</MembersIndex>

## Classes Index

<MembersIndex>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/transfertracker">TransferTracker</a></>}>
Tracker for converting machine value locations and variable values into variable locations (the output of <a href="/docs/api/namespaces/livedebugvalues">LiveDebugValues</a>), recorded as DBG&#95;VALUEs specifying block live-in locations and transfers within blocks. <a href="/docs/api/classes/transfertracker/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/transfertracker/transfer">Transfer</a></>}>
<a href="/docs/api/classes/llvm/record">Record</a> of all changes in variable locations at a block position. <a href="/docs/api/structs/transfertracker/transfer/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/transfertracker/resolveddbgvalue">ResolvedDbgValue</a></>}>
Stores the resolved operands (machine locations and constants) and qualifying meta-information needed to construct a concrete DBG&#95;VALUE-like instruction. <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="struct"
  name={<><a href="/docs/api/structs/transfertracker/usebeforedef">UseBeforeDef</a></>}>
<a href="/docs/api/classes/llvm/record">Record</a> of a use-before-def: created when a value that&#39;s live-in to the current block isn&#39;t available in any machine location, but it will be defined in this block. <a href="/docs/api/structs/transfertracker/usebeforedef/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/transfertracker/locationandquality">LocationAndQuality</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi">LDVSSAPhi</a></>}>
Represents an SSA PHI node for the SSA updater class. <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator">LDVSSABlockIterator</a></>}>
Thin wrapper around a block predecessor iterator. <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a></>}>
Thin wrapper around a block for SSA Updater interface. <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater">LDVSSAUpdater</a></>}>
Utility class for the <a href="/docs/api/classes/llvm/ssaupdater">SSAUpdater</a> interface: tracks blocks, PHIs and values while <a href="/docs/api/classes/llvm/ssaupdater">SSAUpdater</a> is exploring the CFG. <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4">SSAUpdaterTraits&lt;LDVSSAUpdater&gt;</a></>}>
Template specialization to give <a href="/docs/api/classes/llvm/ssaupdater">SSAUpdater</a> access to CFG and value information. <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#details">More...</a>
</MembersIndexItem>

<MembersIndexItem
  type="class"
  name={<><a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16">PHI_iterator&lt;LDVSSAUpdater &gt;::PHI_iterator</a></>}>
Iterator for PHI operands. <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#details">More...</a>
</MembersIndexItem>

</MembersIndex>

## Variables Index

<MembersIndex>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; bool &gt;</>}
  name={<><a href="#afba85f0d2bfd9c12500fa7c93a6e3f91">EmulateOldLDV</a></>}>
</MembersIndexItem>

<MembersIndexItem
  type={<><a href="/docs/api/classes/llvm/cl/opt">cl::opt</a>&lt; unsigned &gt;</>}
  name={<><a href="#ad6ba0b6b6e6515414554417edb06e073">StackWorkingSetLimit</a></>}>
</MembersIndexItem>

</MembersIndex>

## Defines Index

<MembersIndex>

<MembersIndexItem
  type="#define"
  name={<><a href="#ad78e062f62e0d6e453941fb4ca843e4d">DEBUG&#95;TYPE</a>&nbsp;&nbsp;&nbsp;&quot;livedebugvalues&quot;</>}>
</MembersIndexItem>

</MembersIndex>

## Description {#details}

This pass propagates variable locations between basic blocks, resolving control flow conflicts between them. The problem is SSA construction, where each debug instruction assigns the <em>value</em> that a variable has, and every instruction where the variable is in scope uses that variable. The resulting map of instruction-to-value is then translated into a register (or spill) location for each variable over each instruction.

The primary difference from normal SSA construction is that we cannot <em>create</em> PHI values that contain variable values. CodeGen has already completed, and we can&#39;t alter it just to make debug-info complete. Thus: we can identify function positions where we would like a PHI value for a variable, but must search the <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> to see whether such a PHI is available. If no such PHI exists, the variable location must be dropped.

To achieve this, we perform two kinds of analysis. First, we identify every value defined by every instruction (ignoring those that only move another value), then re-compute an SSA-form representation of the <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a>, using value propagation to eliminate any un-necessary PHI values. This gives us a map of every value computed in the function, and its location within the register file / stack.

Secondly, for each variable we perform the same analysis, where each debug instruction is considered a def, and every instruction where the variable is in lexical scope as a use. <a href="/docs/api/classes/llvm/value">Value</a> propagation is used again to eliminate any un-necessary PHIs. This gives us a map of each variable to the value it should have in a block.

Once both are complete, we have two maps for each block:
<ul>
<li>Variables to the values they should have,</li>
<li>Values to the register / spill slot they are located in. After which we can marry-up variable values with a location, and emit DBG&#95;VALUE instructions specifying those locations. Variable locations may be dropped in this process due to the desired variable value not being resident in any machine location, or because there is no PHI value in any location that accurately represents the desired value. The building of location lists for each block is left to DbgEntityHistoryCalculator.</li>
</ul>


This pass is kept efficient because the size of the first SSA problem is proportional to the working-set size of the function, which the compiler tries to keep small. (It&#39;s also proportional to the number of blocks). Additionally, we repeatedly perform the second SSA problem analysis with only the variables and blocks in a single lexical scope, exploiting their locality.

<Link id="details" />



### Terminology



A machine location is a register or spill slot, a value is something that&#39;s defined by an instruction or PHI node, while a variable value is the value assigned to a variable. A variable location is a machine location, that must contain the appropriate variable value. A value that is a PHI node is occasionally called an mphi.



The first SSA problem is the &quot;machine value location&quot; problem, because we&#39;re determining which machine locations contain which values. The &quot;locations&quot; are constant: what&#39;s unknown is what value they contain.



The second SSA problem (the one for variables) is the &quot;variable value
problem&quot;, because it&#39;s determining what values a variable has, rather than what location those values are placed in.



TODO: Overlapping fragments Entry values Add back DEBUG statements for debugging this Collect statistics

<SectionDefinition>

## Variables

### EmulateOldLDV {#afba85f0d2bfd9c12500fa7c93a6e3f91}

<MemberDefinition
  prototype={<>cl::opt&lt; bool &gt; EmulateOldLDV(&quot;emulate-old-livedebugvalues&quot;, cl::Hidden, cl::desc(&quot;Act like old LiveDebugValues did&quot;), cl::init(false))</>}
  labels = {["static"]}>

Definition at line <a href="#l00141">141</a> of file <a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/instrrefbasedimpl-cpp">InstrRefBasedImpl.cpp</a>.
</MemberDefinition>

### StackWorkingSetLimit {#ad6ba0b6b6e6515414554417edb06e073}

<MemberDefinition
  prototype={<>cl::opt&lt; unsigned &gt; StackWorkingSetLimit(&quot;livedebugvalues-max-stack-slots&quot;, cl::Hidden, cl::desc(&quot;livedebugvalues-stack-ws-limit&quot;), cl::init(250))</>}
  labels = {["static"]}>

Definition at line <a href="#l00155">155</a> of file <a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/instrrefbasedimpl-cpp">InstrRefBasedImpl.cpp</a>.
</MemberDefinition>

</SectionDefinition>

<SectionDefinition>

## Defines

### DEBUG&#95;TYPE {#ad78e062f62e0d6e453941fb4ca843e4d}

<MemberDefinition
  prototype={<>#define DEBUG&#95;TYPE&nbsp;&nbsp;&nbsp;&quot;livedebugvalues&quot;</>}>

Definition at line <a href="#l00137">137</a> of file <a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/instrrefbasedimpl-cpp">InstrRefBasedImpl.cpp</a>.
</MemberDefinition>

</SectionDefinition>

## File Listing

The file content with the documentation metadata removed is:

<ProgramListing>

<Link id="l00001" /><CodeLine lineNumber="1"><span class="doxyHighlightComment">//===- InstrRefBasedImpl.cpp - Tracking Debug Value MIs -------------------===//</span></CodeLine>
<Link id="l00002" /><CodeLine lineNumber="2"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00003" /><CodeLine lineNumber="3"><span class="doxyHighlightComment">// Part of the LLVM Project, under the Apache License v2.0 with LLVM Exceptions.</span></CodeLine>
<Link id="l00004" /><CodeLine lineNumber="4"><span class="doxyHighlightComment">// See https://llvm.org/LICENSE.txt for license information.</span></CodeLine>
<Link id="l00005" /><CodeLine lineNumber="5"><span class="doxyHighlightComment">// SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception</span></CodeLine>
<Link id="l00006" /><CodeLine lineNumber="6"><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l00007" /><CodeLine lineNumber="7"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00008" /><CodeLine lineNumber="8"><span class="doxyHighlightComment">/// \\file InstrRefBasedImpl.cpp</span></CodeLine>
<Link id="l00009" /><CodeLine lineNumber="9"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00010" /><CodeLine lineNumber="10"><span class="doxyHighlightComment">/// This is a separate implementation of LiveDebugValues, see</span></CodeLine>
<Link id="l00011" /><CodeLine lineNumber="11"><span class="doxyHighlightComment">/// LiveDebugValues.cpp and VarLocBasedImpl.cpp for more information.</span></CodeLine>
<Link id="l00012" /><CodeLine lineNumber="12"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00013" /><CodeLine lineNumber="13"><span class="doxyHighlightComment">/// This pass propagates variable locations between basic blocks, resolving</span></CodeLine>
<Link id="l00014" /><CodeLine lineNumber="14"><span class="doxyHighlightComment">/// control flow conflicts between them. The problem is SSA construction, where</span></CodeLine>
<Link id="l00015" /><CodeLine lineNumber="15"><span class="doxyHighlightComment">/// each debug instruction assigns the &#42;value&#42; that a variable has, and every</span></CodeLine>
<Link id="l00016" /><CodeLine lineNumber="16"><span class="doxyHighlightComment">/// instruction where the variable is in scope uses that variable. The resulting</span></CodeLine>
<Link id="l00017" /><CodeLine lineNumber="17"><span class="doxyHighlightComment">/// map of instruction-to-value is then translated into a register (or spill)</span></CodeLine>
<Link id="l00018" /><CodeLine lineNumber="18"><span class="doxyHighlightComment">/// location for each variable over each instruction.</span></CodeLine>
<Link id="l00019" /><CodeLine lineNumber="19"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00020" /><CodeLine lineNumber="20"><span class="doxyHighlightComment">/// The primary difference from normal SSA construction is that we cannot</span></CodeLine>
<Link id="l00021" /><CodeLine lineNumber="21"><span class="doxyHighlightComment">/// &#95;create&#95; PHI values that contain variable values. CodeGen has already</span></CodeLine>
<Link id="l00022" /><CodeLine lineNumber="22"><span class="doxyHighlightComment">/// completed, and we can&#39;t alter it just to make debug-info complete. Thus:</span></CodeLine>
<Link id="l00023" /><CodeLine lineNumber="23"><span class="doxyHighlightComment">/// we can identify function positions where we would like a PHI value for a</span></CodeLine>
<Link id="l00024" /><CodeLine lineNumber="24"><span class="doxyHighlightComment">/// variable, but must search the MachineFunction to see whether such a PHI is</span></CodeLine>
<Link id="l00025" /><CodeLine lineNumber="25"><span class="doxyHighlightComment">/// available. If no such PHI exists, the variable location must be dropped.</span></CodeLine>
<Link id="l00026" /><CodeLine lineNumber="26"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00027" /><CodeLine lineNumber="27"><span class="doxyHighlightComment">/// To achieve this, we perform two kinds of analysis. First, we identify</span></CodeLine>
<Link id="l00028" /><CodeLine lineNumber="28"><span class="doxyHighlightComment">/// every value defined by every instruction (ignoring those that only move</span></CodeLine>
<Link id="l00029" /><CodeLine lineNumber="29"><span class="doxyHighlightComment">/// another value), then re-compute an SSA-form representation of the</span></CodeLine>
<Link id="l00030" /><CodeLine lineNumber="30"><span class="doxyHighlightComment">/// MachineFunction, using value propagation to eliminate any un-necessary</span></CodeLine>
<Link id="l00031" /><CodeLine lineNumber="31"><span class="doxyHighlightComment">/// PHI values. This gives us a map of every value computed in the function,</span></CodeLine>
<Link id="l00032" /><CodeLine lineNumber="32"><span class="doxyHighlightComment">/// and its location within the register file / stack.</span></CodeLine>
<Link id="l00033" /><CodeLine lineNumber="33"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00034" /><CodeLine lineNumber="34"><span class="doxyHighlightComment">/// Secondly, for each variable we perform the same analysis, where each debug</span></CodeLine>
<Link id="l00035" /><CodeLine lineNumber="35"><span class="doxyHighlightComment">/// instruction is considered a def, and every instruction where the variable</span></CodeLine>
<Link id="l00036" /><CodeLine lineNumber="36"><span class="doxyHighlightComment">/// is in lexical scope as a use. Value propagation is used again to eliminate</span></CodeLine>
<Link id="l00037" /><CodeLine lineNumber="37"><span class="doxyHighlightComment">/// any un-necessary PHIs. This gives us a map of each variable to the value</span></CodeLine>
<Link id="l00038" /><CodeLine lineNumber="38"><span class="doxyHighlightComment">/// it should have in a block.</span></CodeLine>
<Link id="l00039" /><CodeLine lineNumber="39"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00040" /><CodeLine lineNumber="40"><span class="doxyHighlightComment">/// Once both are complete, we have two maps for each block:</span></CodeLine>
<Link id="l00041" /><CodeLine lineNumber="41"><span class="doxyHighlightComment">///  &#42; Variables to the values they should have,</span></CodeLine>
<Link id="l00042" /><CodeLine lineNumber="42"><span class="doxyHighlightComment">///  &#42; Values to the register / spill slot they are located in.</span></CodeLine>
<Link id="l00043" /><CodeLine lineNumber="43"><span class="doxyHighlightComment">/// After which we can marry-up variable values with a location, and emit</span></CodeLine>
<Link id="l00044" /><CodeLine lineNumber="44"><span class="doxyHighlightComment">/// DBG&#95;VALUE instructions specifying those locations. Variable locations may</span></CodeLine>
<Link id="l00045" /><CodeLine lineNumber="45"><span class="doxyHighlightComment">/// be dropped in this process due to the desired variable value not being</span></CodeLine>
<Link id="l00046" /><CodeLine lineNumber="46"><span class="doxyHighlightComment">/// resident in any machine location, or because there is no PHI value in any</span></CodeLine>
<Link id="l00047" /><CodeLine lineNumber="47"><span class="doxyHighlightComment">/// location that accurately represents the desired value.  The building of</span></CodeLine>
<Link id="l00048" /><CodeLine lineNumber="48"><span class="doxyHighlightComment">/// location lists for each block is left to DbgEntityHistoryCalculator.</span></CodeLine>
<Link id="l00049" /><CodeLine lineNumber="49"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00050" /><CodeLine lineNumber="50"><span class="doxyHighlightComment">/// This pass is kept efficient because the size of the first SSA problem</span></CodeLine>
<Link id="l00051" /><CodeLine lineNumber="51"><span class="doxyHighlightComment">/// is proportional to the working-set size of the function, which the compiler</span></CodeLine>
<Link id="l00052" /><CodeLine lineNumber="52"><span class="doxyHighlightComment">/// tries to keep small. (It&#39;s also proportional to the number of blocks).</span></CodeLine>
<Link id="l00053" /><CodeLine lineNumber="53"><span class="doxyHighlightComment">/// Additionally, we repeatedly perform the second SSA problem analysis with</span></CodeLine>
<Link id="l00054" /><CodeLine lineNumber="54"><span class="doxyHighlightComment">/// only the variables and blocks in a single lexical scope, exploiting their</span></CodeLine>
<Link id="l00055" /><CodeLine lineNumber="55"><span class="doxyHighlightComment">/// locality.</span></CodeLine>
<Link id="l00056" /><CodeLine lineNumber="56"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00057" /><CodeLine lineNumber="57"><span class="doxyHighlightComment">/// ### Terminology</span></CodeLine>
<Link id="l00058" /><CodeLine lineNumber="58"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00059" /><CodeLine lineNumber="59"><span class="doxyHighlightComment">/// A machine location is a register or spill slot, a value is something that&#39;s</span></CodeLine>
<Link id="l00060" /><CodeLine lineNumber="60"><span class="doxyHighlightComment">/// defined by an instruction or PHI node, while a variable value is the value</span></CodeLine>
<Link id="l00061" /><CodeLine lineNumber="61"><span class="doxyHighlightComment">/// assigned to a variable. A variable location is a machine location, that must</span></CodeLine>
<Link id="l00062" /><CodeLine lineNumber="62"><span class="doxyHighlightComment">/// contain the appropriate variable value. A value that is a PHI node is</span></CodeLine>
<Link id="l00063" /><CodeLine lineNumber="63"><span class="doxyHighlightComment">/// occasionally called an mphi.</span></CodeLine>
<Link id="l00064" /><CodeLine lineNumber="64"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00065" /><CodeLine lineNumber="65"><span class="doxyHighlightComment">/// The first SSA problem is the &quot;machine value location&quot; problem,</span></CodeLine>
<Link id="l00066" /><CodeLine lineNumber="66"><span class="doxyHighlightComment">/// because we&#39;re determining which machine locations contain which values.</span></CodeLine>
<Link id="l00067" /><CodeLine lineNumber="67"><span class="doxyHighlightComment">/// The &quot;locations&quot; are constant: what&#39;s unknown is what value they contain.</span></CodeLine>
<Link id="l00068" /><CodeLine lineNumber="68"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00069" /><CodeLine lineNumber="69"><span class="doxyHighlightComment">/// The second SSA problem (the one for variables) is the &quot;variable value</span></CodeLine>
<Link id="l00070" /><CodeLine lineNumber="70"><span class="doxyHighlightComment">/// problem&quot;, because it&#39;s determining what values a variable has, rather than</span></CodeLine>
<Link id="l00071" /><CodeLine lineNumber="71"><span class="doxyHighlightComment">/// what location those values are placed in.</span></CodeLine>
<Link id="l00072" /><CodeLine lineNumber="72"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00073" /><CodeLine lineNumber="73"><span class="doxyHighlightComment">/// TODO:</span></CodeLine>
<Link id="l00074" /><CodeLine lineNumber="74"><span class="doxyHighlightComment">///   Overlapping fragments</span></CodeLine>
<Link id="l00075" /><CodeLine lineNumber="75"><span class="doxyHighlightComment">///   Entry values</span></CodeLine>
<Link id="l00076" /><CodeLine lineNumber="76"><span class="doxyHighlightComment">///   Add back DEBUG statements for debugging this</span></CodeLine>
<Link id="l00077" /><CodeLine lineNumber="77"><span class="doxyHighlightComment">///   Collect statistics</span></CodeLine>
<Link id="l00078" /><CodeLine lineNumber="78"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00079" /><CodeLine lineNumber="79"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00080" /><CodeLine lineNumber="80"></CodeLine>
<Link id="l00081" /><CodeLine lineNumber="81"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/densemap-h">llvm/ADT/DenseMap.h</a>&quot;</span></CodeLine>
<Link id="l00082" /><CodeLine lineNumber="82"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/postorderiterator-h">llvm/ADT/PostOrderIterator.h</a>&quot;</span></CodeLine>
<Link id="l00083" /><CodeLine lineNumber="83"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/stlextras-h">llvm/ADT/STLExtras.h</a>&quot;</span></CodeLine>
<Link id="l00084" /><CodeLine lineNumber="84"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallptrset-h">llvm/ADT/SmallPtrSet.h</a>&quot;</span></CodeLine>
<Link id="l00085" /><CodeLine lineNumber="85"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallset-h">llvm/ADT/SmallSet.h</a>&quot;</span></CodeLine>
<Link id="l00086" /><CodeLine lineNumber="86"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/adt/smallvector-h">llvm/ADT/SmallVector.h</a>&quot;</span></CodeLine>
<Link id="l00087" /><CodeLine lineNumber="87"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/binaryformat/dwarf-h">llvm/BinaryFormat/Dwarf.h</a>&quot;</span></CodeLine>
<Link id="l00088" /><CodeLine lineNumber="88"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/lexicalscopes-h">llvm/CodeGen/LexicalScopes.h</a>&quot;</span></CodeLine>
<Link id="l00089" /><CodeLine lineNumber="89"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machinebasicblock-h">llvm/CodeGen/MachineBasicBlock.h</a>&quot;</span></CodeLine>
<Link id="l00090" /><CodeLine lineNumber="90"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machinedominators-h">llvm/CodeGen/MachineDominators.h</a>&quot;</span></CodeLine>
<Link id="l00091" /><CodeLine lineNumber="91"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineframeinfo-h">llvm/CodeGen/MachineFrameInfo.h</a>&quot;</span></CodeLine>
<Link id="l00092" /><CodeLine lineNumber="92"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machinefunction-h">llvm/CodeGen/MachineFunction.h</a>&quot;</span></CodeLine>
<Link id="l00093" /><CodeLine lineNumber="93"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstr-h">llvm/CodeGen/MachineInstr.h</a>&quot;</span></CodeLine>
<Link id="l00094" /><CodeLine lineNumber="94"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstrbuilder-h">llvm/CodeGen/MachineInstrBuilder.h</a>&quot;</span></CodeLine>
<Link id="l00095" /><CodeLine lineNumber="95"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineinstrbundle-h">llvm/CodeGen/MachineInstrBundle.h</a>&quot;</span></CodeLine>
<Link id="l00096" /><CodeLine lineNumber="96"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machinememoperand-h">llvm/CodeGen/MachineMemOperand.h</a>&quot;</span></CodeLine>
<Link id="l00097" /><CodeLine lineNumber="97"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/machineoperand-h">llvm/CodeGen/MachineOperand.h</a>&quot;</span></CodeLine>
<Link id="l00098" /><CodeLine lineNumber="98"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/pseudosourcevalue-h">llvm/CodeGen/PseudoSourceValue.h</a>&quot;</span></CodeLine>
<Link id="l00099" /><CodeLine lineNumber="99"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetframelowering-h">llvm/CodeGen/TargetFrameLowering.h</a>&quot;</span></CodeLine>
<Link id="l00100" /><CodeLine lineNumber="100"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetinstrinfo-h">llvm/CodeGen/TargetInstrInfo.h</a>&quot;</span></CodeLine>
<Link id="l00101" /><CodeLine lineNumber="101"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetlowering-h">llvm/CodeGen/TargetLowering.h</a>&quot;</span></CodeLine>
<Link id="l00102" /><CodeLine lineNumber="102"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetpassconfig-h">llvm/CodeGen/TargetPassConfig.h</a>&quot;</span></CodeLine>
<Link id="l00103" /><CodeLine lineNumber="103"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetregisterinfo-h">llvm/CodeGen/TargetRegisterInfo.h</a>&quot;</span></CodeLine>
<Link id="l00104" /><CodeLine lineNumber="104"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/codegen/targetsubtargetinfo-h">llvm/CodeGen/TargetSubtargetInfo.h</a>&quot;</span></CodeLine>
<Link id="l00105" /><CodeLine lineNumber="105"><span class="doxyHighlightPreprocessor">#include &quot;llvm/Config/llvm-config.h&quot;</span></CodeLine>
<Link id="l00106" /><CodeLine lineNumber="106"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/debuginfometadata-h">llvm/IR/DebugInfoMetadata.h</a>&quot;</span></CodeLine>
<Link id="l00107" /><CodeLine lineNumber="107"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/debugloc-h">llvm/IR/DebugLoc.h</a>&quot;</span></CodeLine>
<Link id="l00108" /><CodeLine lineNumber="108"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/ir/function-h">llvm/IR/Function.h</a>&quot;</span></CodeLine>
<Link id="l00109" /><CodeLine lineNumber="109"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/mc/mcregisterinfo-h">llvm/MC/MCRegisterInfo.h</a>&quot;</span></CodeLine>
<Link id="l00110" /><CodeLine lineNumber="110"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/casting-h">llvm/Support/Casting.h</a>&quot;</span></CodeLine>
<Link id="l00111" /><CodeLine lineNumber="111"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h">llvm/Support/Compiler.h</a>&quot;</span></CodeLine>
<Link id="l00112" /><CodeLine lineNumber="112"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h">llvm/Support/Debug.h</a>&quot;</span></CodeLine>
<Link id="l00113" /><CodeLine lineNumber="113"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/genericiterateddominancefrontier-h">llvm/Support/GenericIteratedDominanceFrontier.h</a>&quot;</span></CodeLine>
<Link id="l00114" /><CodeLine lineNumber="114"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/typesize-h">llvm/Support/TypeSize.h</a>&quot;</span></CodeLine>
<Link id="l00115" /><CodeLine lineNumber="115"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/support/raw-ostream-h">llvm/Support/raw&#95;ostream.h</a>&quot;</span></CodeLine>
<Link id="l00116" /><CodeLine lineNumber="116"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/target/targetmachine-h">llvm/Target/TargetMachine.h</a>&quot;</span></CodeLine>
<Link id="l00117" /><CodeLine lineNumber="117"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/include/include/llvm/include/llvm/transforms/include/llvm/transforms/utils/ssaupdaterimpl-h">llvm/Transforms/Utils/SSAUpdaterImpl.h</a>&quot;</span></CodeLine>
<Link id="l00118" /><CodeLine lineNumber="118"><span class="doxyHighlightPreprocessor">#include &lt;algorithm&gt;</span></CodeLine>
<Link id="l00119" /><CodeLine lineNumber="119"><span class="doxyHighlightPreprocessor">#include &lt;cassert&gt;</span></CodeLine>
<Link id="l00120" /><CodeLine lineNumber="120"><span class="doxyHighlightPreprocessor">#include &lt;climits&gt;</span></CodeLine>
<Link id="l00121" /><CodeLine lineNumber="121"><span class="doxyHighlightPreprocessor">#include &lt;cstdint&gt;</span></CodeLine>
<Link id="l00122" /><CodeLine lineNumber="122"><span class="doxyHighlightPreprocessor">#include &lt;functional&gt;</span></CodeLine>
<Link id="l00123" /><CodeLine lineNumber="123"><span class="doxyHighlightPreprocessor">#include &lt;queue&gt;</span></CodeLine>
<Link id="l00124" /><CodeLine lineNumber="124"><span class="doxyHighlightPreprocessor">#include &lt;tuple&gt;</span></CodeLine>
<Link id="l00125" /><CodeLine lineNumber="125"><span class="doxyHighlightPreprocessor">#include &lt;utility&gt;</span></CodeLine>
<Link id="l00126" /><CodeLine lineNumber="126"><span class="doxyHighlightPreprocessor">#include &lt;vector&gt;</span></CodeLine>
<Link id="l00127" /><CodeLine lineNumber="127"></CodeLine>
<Link id="l00128" /><CodeLine lineNumber="128"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/instrrefbasedimpl-h">InstrRefBasedImpl.h</a>&quot;</span></CodeLine>
<Link id="l00129" /><CodeLine lineNumber="129"><span class="doxyHighlightPreprocessor">#include &quot;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/livedebugvalues-h">LiveDebugValues.h</a>&quot;</span></CodeLine>
<Link id="l00130" /><CodeLine lineNumber="130"><span class="doxyHighlightPreprocessor">#include &lt;optional&gt;</span></CodeLine>
<Link id="l00131" /><CodeLine lineNumber="131"></CodeLine>
<Link id="l00132" /><CodeLine lineNumber="132"><span class="doxyHighlightKeyword">using namespace </span><span class="doxyHighlight"><a href="/docs/api/namespaces/llvm">llvm</a>;</span></CodeLine>
<Link id="l00133" /><CodeLine lineNumber="133"><span class="doxyHighlightKeyword">using namespace </span><span class="doxyHighlight"><a href="/docs/api/namespaces/livedebugvalues">LiveDebugValues</a>;</span></CodeLine>
<Link id="l00134" /><CodeLine lineNumber="134"></CodeLine>
<Link id="l00135" /><CodeLine lineNumber="135"><span class="doxyHighlightComment">// SSAUpdaterImple sets DEBUG&#95;TYPE, change it.</span></CodeLine>
<Link id="l00136" /><CodeLine lineNumber="136"><span class="doxyHighlightPreprocessor">#undef DEBUG&#95;TYPE</span></CodeLine>
<Link id="l00137" /><CodeLine lineNumber="137" lineLink="#ad78e062f62e0d6e453941fb4ca843e4d"><span class="doxyHighlightPreprocessor">#define DEBUG&#95;TYPE &quot;livedebugvalues&quot;</span></CodeLine>
<Link id="l00138" /><CodeLine lineNumber="138"></CodeLine>
<Link id="l00139" /><CodeLine lineNumber="139"><span class="doxyHighlightComment">// Act more like the VarLoc implementation, by propagating some locations too</span></CodeLine>
<Link id="l00140" /><CodeLine lineNumber="140"><span class="doxyHighlightComment">// far and ignoring some transfers.</span></CodeLine>
<Link id="l00141" /><CodeLine lineNumber="141" lineLink="#afba85f0d2bfd9c12500fa7c93a6e3f91"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;bool&gt;</a> <a href="#afba85f0d2bfd9c12500fa7c93a6e3f91">EmulateOldLDV</a>(</span><span class="doxyHighlightStringLiteral">&quot;emulate-old-livedebugvalues&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</span></CodeLine>
<Link id="l00142" /><CodeLine lineNumber="142"><span class="doxyHighlight">                                   <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;Act like old LiveDebugValues did&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00143" /><CodeLine lineNumber="143"><span class="doxyHighlight">                                   <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(</span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">));</span></CodeLine>
<Link id="l00144" /><CodeLine lineNumber="144"></CodeLine>
<Link id="l00145" /><CodeLine lineNumber="145"><span class="doxyHighlightComment">// Limit for the maximum number of stack slots we should track, past which we</span></CodeLine>
<Link id="l00146" /><CodeLine lineNumber="146"><span class="doxyHighlightComment">// will ignore any spills. InstrRefBasedLDV gathers detailed information on all</span></CodeLine>
<Link id="l00147" /><CodeLine lineNumber="147"><span class="doxyHighlightComment">// stack slots which leads to high memory consumption, and in some scenarios</span></CodeLine>
<Link id="l00148" /><CodeLine lineNumber="148"><span class="doxyHighlightComment">// (such as asan with very many locals) the working set of the function can be</span></CodeLine>
<Link id="l00149" /><CodeLine lineNumber="149"><span class="doxyHighlightComment">// very large, causing many spills. In these scenarios, it is very unlikely that</span></CodeLine>
<Link id="l00150" /><CodeLine lineNumber="150"><span class="doxyHighlightComment">// the developer has hundreds of variables live at the same time that they&#39;re</span></CodeLine>
<Link id="l00151" /><CodeLine lineNumber="151"><span class="doxyHighlightComment">// carefully thinking about -- instead, they probably autogenerated the code.</span></CodeLine>
<Link id="l00152" /><CodeLine lineNumber="152"><span class="doxyHighlightComment">// When this happens, gracefully stop tracking excess spill slots, rather than</span></CodeLine>
<Link id="l00153" /><CodeLine lineNumber="153"><span class="doxyHighlightComment">// consuming all the developer&#39;s memory.</span></CodeLine>
<Link id="l00154" /><CodeLine lineNumber="154"><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/cl/opt">cl::opt&lt;unsigned&gt;</a></span></CodeLine>
<Link id="l00155" /><CodeLine lineNumber="155" lineLink="#ad6ba0b6b6e6515414554417edb06e073"><span class="doxyHighlight">    <a href="#ad6ba0b6b6e6515414554417edb06e073">StackWorkingSetLimit</a>(</span><span class="doxyHighlightStringLiteral">&quot;livedebugvalues-max-stack-slots&quot;</span><span class="doxyHighlight">, <a href="/docs/api/namespaces/llvm/cl/#a68075925a54790e71ca790e1d4f21a40a263ac008d8d31f13ce460395fc4cf7e6">cl::Hidden</a>,</span></CodeLine>
<Link id="l00156" /><CodeLine lineNumber="156"><span class="doxyHighlight">                         <a href="/docs/api/structs/llvm/cl/desc">cl::desc</a>(</span><span class="doxyHighlightStringLiteral">&quot;livedebugvalues-stack-ws-limit&quot;</span><span class="doxyHighlight">),</span></CodeLine>
<Link id="l00157" /><CodeLine lineNumber="157"><span class="doxyHighlight">                         <a href="/docs/api/namespaces/llvm/cl/#ac12e6a8f3a1b511f0dee2ed6de0ae806">cl::init</a>(250));</span></CodeLine>
<Link id="l00158" /><CodeLine lineNumber="158"></CodeLine>
<Link id="l00159" /><CodeLine lineNumber="159"><span class="doxyHighlight"><a href="/docs/api/structs/livedebugvalues/dbgopid">DbgOpID</a> <a href="/docs/api/structs/livedebugvalues/dbgopid/#a91064aebe93d3d6b7776a90451f2a854">DbgOpID::UndefID</a> = <a href="/docs/api/structs/livedebugvalues/dbgopid">DbgOpID</a>(0xffffffff);</span></CodeLine>
<Link id="l00160" /><CodeLine lineNumber="160"></CodeLine>
<Link id="l00161" /><CodeLine lineNumber="161"><span class="doxyHighlightComment">/// Tracker for converting machine value locations and variable values into</span></CodeLine>
<Link id="l00162" /><CodeLine lineNumber="162"><span class="doxyHighlightComment">/// variable locations (the output of LiveDebugValues), recorded as DBG&#95;VALUEs</span></CodeLine>
<Link id="l00163" /><CodeLine lineNumber="163"><span class="doxyHighlightComment">/// specifying block live-in locations and transfers within blocks.</span></CodeLine>
<Link id="l00164" /><CodeLine lineNumber="164"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00165" /><CodeLine lineNumber="165"><span class="doxyHighlightComment">/// Operating on a per-block basis, this class takes a (pre-loaded) MLocTracker</span></CodeLine>
<Link id="l00166" /><CodeLine lineNumber="166"><span class="doxyHighlightComment">/// and must be initialized with the set of variable values that are live-in to</span></CodeLine>
<Link id="l00167" /><CodeLine lineNumber="167"><span class="doxyHighlightComment">/// the block. The caller then repeatedly calls process(). TransferTracker picks</span></CodeLine>
<Link id="l00168" /><CodeLine lineNumber="168"><span class="doxyHighlightComment">/// out variable locations for the live-in variable values (if there &#95;is&#95; a</span></CodeLine>
<Link id="l00169" /><CodeLine lineNumber="169"><span class="doxyHighlightComment">/// location) and creates the corresponding DBG&#95;VALUEs. Then, as the block is</span></CodeLine>
<Link id="l00170" /><CodeLine lineNumber="170"><span class="doxyHighlightComment">/// stepped through, transfers of values between machine locations are</span></CodeLine>
<Link id="l00171" /><CodeLine lineNumber="171"><span class="doxyHighlightComment">/// identified and if profitable, a DBG&#95;VALUE created.</span></CodeLine>
<Link id="l00172" /><CodeLine lineNumber="172"><span class="doxyHighlightComment">///</span></CodeLine>
<Link id="l00173" /><CodeLine lineNumber="173"><span class="doxyHighlightComment">/// This is where debug use-before-defs would be resolved: a variable with an</span></CodeLine>
<Link id="l00174" /><CodeLine lineNumber="174"><span class="doxyHighlightComment">/// unavailable value could materialize in the middle of a block, when the</span></CodeLine>
<Link id="l00175" /><CodeLine lineNumber="175"><span class="doxyHighlightComment">/// value becomes available. Or, we could detect clobbers and re-specify the</span></CodeLine>
<Link id="l00176" /><CodeLine lineNumber="176"><span class="doxyHighlightComment">/// variable in a backup location. (XXX these are unimplemented).</span></CodeLine>
<Link id="l00177" /><CodeLine lineNumber="177" lineLink="/docs/api/classes/transfertracker"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/transfertracker/#ab62a3902e9944a4a6da8a82cc72ea1c9">TransferTracker</a> &#123;</span></CodeLine>
<Link id="l00178" /><CodeLine lineNumber="178"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00179" /><CodeLine lineNumber="179" lineLink="/docs/api/classes/transfertracker/#aa1cef6664a3e135245b35927b6db11e5"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetinstrinfo">TargetInstrInfo</a> &#42;<a href="/docs/api/classes/transfertracker/#aa1cef6664a3e135245b35927b6db11e5">TII</a>;</span></CodeLine>
<Link id="l00180" /><CodeLine lineNumber="180" lineLink="/docs/api/classes/transfertracker/#a31452b4b5d9984ee5ed52db4b1a52d5e"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetlowering">TargetLowering</a> &#42;<a href="/docs/api/classes/transfertracker/#a31452b4b5d9984ee5ed52db4b1a52d5e">TLI</a>;</span></CodeLine>
<Link id="l00181" /><CodeLine lineNumber="181"><span class="doxyHighlightComment">  /// This machine location tracker is assumed to always contain the up-to-date</span></CodeLine>
<Link id="l00182" /><CodeLine lineNumber="182"><span class="doxyHighlightComment">  /// value mapping for all machine locations. TransferTracker only reads</span></CodeLine>
<Link id="l00183" /><CodeLine lineNumber="183"><span class="doxyHighlightComment">  /// information from it. (XXX make it const?)</span></CodeLine>
<Link id="l00184" /><CodeLine lineNumber="184" lineLink="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker">MLocTracker</a> &#42;<a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>;</span></CodeLine>
<Link id="l00185" /><CodeLine lineNumber="185" lineLink="/docs/api/classes/transfertracker/#a79f160cf45e05ebc07c2751e0bd4d944"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;<a href="/docs/api/classes/transfertracker/#a79f160cf45e05ebc07c2751e0bd4d944">MF</a>;</span></CodeLine>
<Link id="l00186" /><CodeLine lineNumber="186" lineLink="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/debugvariablemap">DebugVariableMap</a> &amp;<a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>;</span></CodeLine>
<Link id="l00187" /><CodeLine lineNumber="187" lineLink="/docs/api/classes/transfertracker/#af1088d1f2ac99145846bedd829c2a05e"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#af1088d1f2ac99145846bedd829c2a05e">ShouldEmitDebugEntryValues</a>;</span></CodeLine>
<Link id="l00188" /><CodeLine lineNumber="188"></CodeLine>
<Link id="l00189" /><CodeLine lineNumber="189"><span class="doxyHighlightComment">  /// Record of all changes in variable locations at a block position. Awkwardly</span></CodeLine>
<Link id="l00190" /><CodeLine lineNumber="190"><span class="doxyHighlightComment">  /// we allow inserting either before or after the point: MBB != nullptr</span></CodeLine>
<Link id="l00191" /><CodeLine lineNumber="191"><span class="doxyHighlightComment">  /// indicates it&#39;s before, otherwise after.</span></CodeLine>
<Link id="l00192" /><CodeLine lineNumber="192" lineLink="/docs/api/structs/transfertracker/transfer"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/transfertracker/transfer">Transfer</a> &#123;</span></CodeLine>
<Link id="l00193" /><CodeLine lineNumber="193" lineLink="/docs/api/structs/transfertracker/transfer/#ab78f8c81ffd3f747bc238579afba9299"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock/#ab6395548cae73865213e279ae461db54">MachineBasicBlock::instr&#95;iterator</a> <a href="/docs/api/structs/transfertracker/transfer/#ab78f8c81ffd3f747bc238579afba9299">Pos</a>; </span><span class="doxyHighlightComment">/// Position to insert DBG&#95;VALUes</span></CodeLine>
<Link id="l00194" /><CodeLine lineNumber="194" lineLink="/docs/api/structs/transfertracker/transfer/#a8f3fd2af02224f971a011c03f5110db3"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/structs/transfertracker/transfer/#a8f3fd2af02224f971a011c03f5110db3">MBB</a>; </span><span class="doxyHighlightComment">/// non-null if we should insert after.</span></CodeLine>
<Link id="l00195" /><CodeLine lineNumber="195"><span class="doxyHighlightComment">    /// Vector of DBG&#95;VALUEs to insert. Store with their DebugVariableID so that</span></CodeLine>
<Link id="l00196" /><CodeLine lineNumber="196"><span class="doxyHighlightComment">    /// they can be sorted into a stable order for emission at a later time.</span></CodeLine>
<Link id="l00197" /><CodeLine lineNumber="197" lineLink="/docs/api/structs/transfertracker/transfer/#a7b09ca783b633160f22f780c81a3feaf"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;DebugVariableID, MachineInstr &#42;&gt;</a>, 4&gt; <a href="/docs/api/structs/transfertracker/transfer/#a7b09ca783b633160f22f780c81a3feaf">Insts</a>;</span></CodeLine>
<Link id="l00198" /><CodeLine lineNumber="198"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00199" /><CodeLine lineNumber="199"></CodeLine>
<Link id="l00200" /><CodeLine lineNumber="200"><span class="doxyHighlightComment">  /// Stores the resolved operands (machine locations and constants) and</span></CodeLine>
<Link id="l00201" /><CodeLine lineNumber="201"><span class="doxyHighlightComment">  /// qualifying meta-information needed to construct a concrete DBG&#95;VALUE-like</span></CodeLine>
<Link id="l00202" /><CodeLine lineNumber="202"><span class="doxyHighlightComment">  /// instruction.</span></CodeLine>
<Link id="l00203" /><CodeLine lineNumber="203" lineLink="/docs/api/structs/transfertracker/resolveddbgvalue"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a73ba0d2dd65dbf02973218eb35f3f443">ResolvedDbgValue</a> &#123;</span></CodeLine>
<Link id="l00204" /><CodeLine lineNumber="204" lineLink="/docs/api/structs/transfertracker/resolveddbgvalue/#a1950d59e67278bcf2a7585a02de976a7"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ResolvedDbgOp&gt;</a> <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a1950d59e67278bcf2a7585a02de976a7">Ops</a>;</span></CodeLine>
<Link id="l00205" /><CodeLine lineNumber="205" lineLink="/docs/api/structs/transfertracker/resolveddbgvalue/#a4883f929e1d52849ed5911e1ffad6e8a"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a4883f929e1d52849ed5911e1ffad6e8a">Properties</a>;</span></CodeLine>
<Link id="l00206" /><CodeLine lineNumber="206"></CodeLine>
<Link id="l00207" /><CodeLine lineNumber="207" lineLink="/docs/api/structs/transfertracker/resolveddbgvalue/#a73ba0d2dd65dbf02973218eb35f3f443"><span class="doxyHighlight">    <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a73ba0d2dd65dbf02973218eb35f3f443">ResolvedDbgValue</a>(<a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;ResolvedDbgOp&gt;</a> &amp;<a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a1950d59e67278bcf2a7585a02de976a7">Ops</a>,</span></CodeLine>
<Link id="l00208" /><CodeLine lineNumber="208"><span class="doxyHighlight">                     <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a4883f929e1d52849ed5911e1ffad6e8a">Properties</a>)</span></CodeLine>
<Link id="l00209" /><CodeLine lineNumber="209"><span class="doxyHighlight">        : <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a1950d59e67278bcf2a7585a02de976a7">Ops</a>(<a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a1950d59e67278bcf2a7585a02de976a7">Ops</a>.begin(), <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a1950d59e67278bcf2a7585a02de976a7">Ops</a>.end()), <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a4883f929e1d52849ed5911e1ffad6e8a">Properties</a>(<a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a4883f929e1d52849ed5911e1ffad6e8a">Properties</a>) &#123;&#125;</span></CodeLine>
<Link id="l00210" /><CodeLine lineNumber="210"></CodeLine>
<Link id="l00211" /><CodeLine lineNumber="211"><span class="doxyHighlightComment">    /// Returns all the LocIdx values used in this struct, in the order in which</span></CodeLine>
<Link id="l00212" /><CodeLine lineNumber="212"><span class="doxyHighlightComment">    /// they appear as operands in the debug value; may contain duplicates.</span></CodeLine>
<Link id="l00213" /><CodeLine lineNumber="213" lineLink="/docs/api/structs/transfertracker/resolveddbgvalue/#a8b103990018b8ee3072ebbf858b53a69"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a8b103990018b8ee3072ebbf858b53a69">loc&#95;indices</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00214" /><CodeLine lineNumber="214"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a51c7cbd21e1104ee6841c18d7daa6edb">map&#95;range</a>(</span></CodeLine>
<Link id="l00215" /><CodeLine lineNumber="215"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a898e9304cf2baf908f4e9b8e32a5f6c3">make&#95;filter&#95;range</a>(</span></CodeLine>
<Link id="l00216" /><CodeLine lineNumber="216"><span class="doxyHighlight">              <a href="/docs/api/structs/transfertracker/resolveddbgvalue/#a1950d59e67278bcf2a7585a02de976a7">Ops</a>, &#91;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.IsConst; &#125;),</span></CodeLine>
<Link id="l00217" /><CodeLine lineNumber="217"><span class="doxyHighlight">          &#91;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.Loc; &#125;);</span></CodeLine>
<Link id="l00218" /><CodeLine lineNumber="218"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00219" /><CodeLine lineNumber="219"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00220" /><CodeLine lineNumber="220"></CodeLine>
<Link id="l00221" /><CodeLine lineNumber="221"><span class="doxyHighlightComment">  /// Collection of transfers (DBG&#95;VALUEs) to be inserted.</span></CodeLine>
<Link id="l00222" /><CodeLine lineNumber="222" lineLink="/docs/api/classes/transfertracker/#af06b11c084b9a4ff7e063e146d4131d3"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;Transfer, 32&gt;</a> <a href="/docs/api/classes/transfertracker/#af06b11c084b9a4ff7e063e146d4131d3">Transfers</a>;</span></CodeLine>
<Link id="l00223" /><CodeLine lineNumber="223"></CodeLine>
<Link id="l00224" /><CodeLine lineNumber="224"><span class="doxyHighlightComment">  /// Local cache of what-value-is-in-what-LocIdx. Used to identify differences</span></CodeLine>
<Link id="l00225" /><CodeLine lineNumber="225"><span class="doxyHighlightComment">  /// between TransferTrackers view of variable locations and MLocTrackers. For</span></CodeLine>
<Link id="l00226" /><CodeLine lineNumber="226"><span class="doxyHighlightComment">  /// example, MLocTracker observes all clobbers, but TransferTracker lazily</span></CodeLine>
<Link id="l00227" /><CodeLine lineNumber="227"><span class="doxyHighlightComment">  /// does not.</span></CodeLine>
<Link id="l00228" /><CodeLine lineNumber="228" lineLink="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ValueIDNum, 32&gt;</a> <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>;</span></CodeLine>
<Link id="l00229" /><CodeLine lineNumber="229"></CodeLine>
<Link id="l00230" /><CodeLine lineNumber="230"><span class="doxyHighlightComment">  /// Map from LocIdxes to which DebugVariables are based that location.</span></CodeLine>
<Link id="l00231" /><CodeLine lineNumber="231"><span class="doxyHighlightComment">  /// Mantained while stepping through the block. Not accurate if</span></CodeLine>
<Link id="l00232" /><CodeLine lineNumber="232"><span class="doxyHighlightComment">  /// VarLocs&#91;Idx&#93; != MTracker-&gt;LocIdxToIDNum&#91;Idx&#93;.</span></CodeLine>
<Link id="l00233" /><CodeLine lineNumber="233" lineLink="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;LocIdx, SmallSet&lt;DebugVariableID, 4&gt;</a>&gt; <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>;</span></CodeLine>
<Link id="l00234" /><CodeLine lineNumber="234"></CodeLine>
<Link id="l00235" /><CodeLine lineNumber="235"><span class="doxyHighlightComment">  /// Map from DebugVariable to it&#39;s current location and qualifying meta</span></CodeLine>
<Link id="l00236" /><CodeLine lineNumber="236"><span class="doxyHighlightComment">  /// information. To be used in conjunction with ActiveMLocs to construct</span></CodeLine>
<Link id="l00237" /><CodeLine lineNumber="237"><span class="doxyHighlightComment">  /// enough information for the DBG&#95;VALUEs for a particular LocIdx.</span></CodeLine>
<Link id="l00238" /><CodeLine lineNumber="238" lineLink="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;DebugVariableID, ResolvedDbgValue&gt;</a> <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>;</span></CodeLine>
<Link id="l00239" /><CodeLine lineNumber="239"></CodeLine>
<Link id="l00240" /><CodeLine lineNumber="240"><span class="doxyHighlightComment">  /// Temporary cache of DBG&#95;VALUEs to be entered into the Transfers collection.</span></CodeLine>
<Link id="l00241" /><CodeLine lineNumber="241" lineLink="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;DebugVariableID, MachineInstr &#42;&gt;</a>, 4&gt; <a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>;</span></CodeLine>
<Link id="l00242" /><CodeLine lineNumber="242"></CodeLine>
<Link id="l00243" /><CodeLine lineNumber="243"><span class="doxyHighlightComment">  /// Record of a use-before-def: created when a value that&#39;s live-in to the</span></CodeLine>
<Link id="l00244" /><CodeLine lineNumber="244"><span class="doxyHighlightComment">  /// current block isn&#39;t available in any machine location, but it will be</span></CodeLine>
<Link id="l00245" /><CodeLine lineNumber="245"><span class="doxyHighlightComment">  /// defined in this block.</span></CodeLine>
<Link id="l00246" /><CodeLine lineNumber="246" lineLink="/docs/api/structs/transfertracker/usebeforedef"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">struct </span><span class="doxyHighlight"><a href="/docs/api/structs/transfertracker/usebeforedef/#a36b9ea5387fdb74402bcacb3d6cd342c">UseBeforeDef</a> &#123;</span></CodeLine>
<Link id="l00247" /><CodeLine lineNumber="247"><span class="doxyHighlightComment">    /// Value of this variable, def&#39;d in block.</span></CodeLine>
<Link id="l00248" /><CodeLine lineNumber="248" lineLink="/docs/api/structs/transfertracker/usebeforedef/#a6b4cddff9a13c0b5b465ecab3fdc931e"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;DbgOp&gt;</a> <a href="/docs/api/structs/transfertracker/usebeforedef/#a6b4cddff9a13c0b5b465ecab3fdc931e">Values</a>;</span></CodeLine>
<Link id="l00249" /><CodeLine lineNumber="249"><span class="doxyHighlightComment">    /// Identity of this variable.</span></CodeLine>
<Link id="l00250" /><CodeLine lineNumber="250" lineLink="/docs/api/structs/transfertracker/usebeforedef/#a50c91294ada6dd3784568a79d0f29866"><span class="doxyHighlight">    <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/structs/transfertracker/usebeforedef/#a50c91294ada6dd3784568a79d0f29866">VarID</a>;</span></CodeLine>
<Link id="l00251" /><CodeLine lineNumber="251"><span class="doxyHighlightComment">    /// Additional variable properties.</span></CodeLine>
<Link id="l00252" /><CodeLine lineNumber="252" lineLink="/docs/api/structs/transfertracker/usebeforedef/#a4ea6a66deb8d30b11cceab65d5cda94e"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> <a href="/docs/api/structs/transfertracker/usebeforedef/#a4ea6a66deb8d30b11cceab65d5cda94e">Properties</a>;</span></CodeLine>
<Link id="l00253" /><CodeLine lineNumber="253" lineLink="/docs/api/structs/transfertracker/usebeforedef/#a36b9ea5387fdb74402bcacb3d6cd342c"><span class="doxyHighlight">    <a href="/docs/api/structs/transfertracker/usebeforedef/#a36b9ea5387fdb74402bcacb3d6cd342c">UseBeforeDef</a>(<a href="/docs/api/classes/llvm/arrayref">ArrayRef&lt;DbgOp&gt;</a> <a href="/docs/api/structs/transfertracker/usebeforedef/#a6b4cddff9a13c0b5b465ecab3fdc931e">Values</a>, <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/structs/transfertracker/usebeforedef/#a50c91294ada6dd3784568a79d0f29866">VarID</a>,</span></CodeLine>
<Link id="l00254" /><CodeLine lineNumber="254"><span class="doxyHighlight">                 </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> &amp;<a href="/docs/api/structs/transfertracker/usebeforedef/#a4ea6a66deb8d30b11cceab65d5cda94e">Properties</a>)</span></CodeLine>
<Link id="l00255" /><CodeLine lineNumber="255"><span class="doxyHighlight">        : <a href="/docs/api/structs/transfertracker/usebeforedef/#a6b4cddff9a13c0b5b465ecab3fdc931e">Values</a>(<a href="/docs/api/structs/transfertracker/usebeforedef/#a6b4cddff9a13c0b5b465ecab3fdc931e">Values</a>), <a href="/docs/api/structs/transfertracker/usebeforedef/#a50c91294ada6dd3784568a79d0f29866">VarID</a>(<a href="/docs/api/structs/transfertracker/usebeforedef/#a50c91294ada6dd3784568a79d0f29866">VarID</a>), <a href="/docs/api/structs/transfertracker/usebeforedef/#a4ea6a66deb8d30b11cceab65d5cda94e">Properties</a>(<a href="/docs/api/structs/transfertracker/usebeforedef/#a4ea6a66deb8d30b11cceab65d5cda94e">Properties</a>) &#123;&#125;</span></CodeLine>
<Link id="l00256" /><CodeLine lineNumber="256"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00257" /><CodeLine lineNumber="257"></CodeLine>
<Link id="l00258" /><CodeLine lineNumber="258"><span class="doxyHighlightComment">  /// Map from instruction index (within the block) to the set of UseBeforeDefs</span></CodeLine>
<Link id="l00259" /><CodeLine lineNumber="259"><span class="doxyHighlightComment">  /// that become defined at that instruction.</span></CodeLine>
<Link id="l00260" /><CodeLine lineNumber="260" lineLink="/docs/api/classes/transfertracker/#ae485598414179a9523e127ad2df4756c"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;unsigned, SmallVector&lt;UseBeforeDef, 1&gt;</a>&gt; <a href="/docs/api/classes/transfertracker/#ae485598414179a9523e127ad2df4756c">UseBeforeDefs</a>;</span></CodeLine>
<Link id="l00261" /><CodeLine lineNumber="261"></CodeLine>
<Link id="l00262" /><CodeLine lineNumber="262"><span class="doxyHighlightComment">  /// The set of variables that are in UseBeforeDefs and can become a location</span></CodeLine>
<Link id="l00263" /><CodeLine lineNumber="263"><span class="doxyHighlightComment">  /// once the relevant value is defined. An element being erased from this</span></CodeLine>
<Link id="l00264" /><CodeLine lineNumber="264"><span class="doxyHighlightComment">  /// collection prevents the use-before-def materializing.</span></CodeLine>
<Link id="l00265" /><CodeLine lineNumber="265" lineLink="/docs/api/classes/transfertracker/#a162a58b620ec34701775d8d3e953fb20"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;DebugVariableID&gt;</a> <a href="/docs/api/classes/transfertracker/#a162a58b620ec34701775d8d3e953fb20">UseBeforeDefVariables</a>;</span></CodeLine>
<Link id="l00266" /><CodeLine lineNumber="266"></CodeLine>
<Link id="l00267" /><CodeLine lineNumber="267" lineLink="/docs/api/classes/transfertracker/#abf13e97a9a5cff9aa06c88d1ac5172fb"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &amp;<a href="/docs/api/classes/transfertracker/#abf13e97a9a5cff9aa06c88d1ac5172fb">TRI</a>;</span></CodeLine>
<Link id="l00268" /><CodeLine lineNumber="268" lineLink="/docs/api/classes/transfertracker/#a1b1735405477716ee8dd95236d3257bf"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/bitvector">BitVector</a> &amp;<a href="/docs/api/classes/transfertracker/#a1b1735405477716ee8dd95236d3257bf">CalleeSavedRegs</a>;</span></CodeLine>
<Link id="l00269" /><CodeLine lineNumber="269"></CodeLine>
<Link id="l00270" /><CodeLine lineNumber="270" lineLink="/docs/api/classes/transfertracker/#ab62a3902e9944a4a6da8a82cc72ea1c9"><span class="doxyHighlight">  <a href="/docs/api/classes/transfertracker/#ab62a3902e9944a4a6da8a82cc72ea1c9">TransferTracker</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetinstrinfo">TargetInstrInfo</a> &#42;<a href="/docs/api/classes/transfertracker/#aa1cef6664a3e135245b35927b6db11e5">TII</a>, <a href="/docs/api/classes/livedebugvalues/mloctracker">MLocTracker</a> &#42;<a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>,</span></CodeLine>
<Link id="l00271" /><CodeLine lineNumber="271"><span class="doxyHighlight">                  <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;<a href="/docs/api/classes/transfertracker/#a79f160cf45e05ebc07c2751e0bd4d944">MF</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/debugvariablemap">DebugVariableMap</a> &amp;<a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>,</span></CodeLine>
<Link id="l00272" /><CodeLine lineNumber="272"><span class="doxyHighlight">                  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &amp;<a href="/docs/api/classes/transfertracker/#abf13e97a9a5cff9aa06c88d1ac5172fb">TRI</a>,</span></CodeLine>
<Link id="l00273" /><CodeLine lineNumber="273"><span class="doxyHighlight">                  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/bitvector">BitVector</a> &amp;<a href="/docs/api/classes/transfertracker/#a1b1735405477716ee8dd95236d3257bf">CalleeSavedRegs</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetpassconfig">TargetPassConfig</a> &amp;TPC)</span></CodeLine>
<Link id="l00274" /><CodeLine lineNumber="274"><span class="doxyHighlight">      : <a href="/docs/api/classes/transfertracker/#aa1cef6664a3e135245b35927b6db11e5">TII</a>(<a href="/docs/api/classes/transfertracker/#aa1cef6664a3e135245b35927b6db11e5">TII</a>), <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>(<a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>), <a href="/docs/api/classes/transfertracker/#a79f160cf45e05ebc07c2751e0bd4d944">MF</a>(<a href="/docs/api/classes/transfertracker/#a79f160cf45e05ebc07c2751e0bd4d944">MF</a>), <a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>(<a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>), <a href="/docs/api/classes/transfertracker/#abf13e97a9a5cff9aa06c88d1ac5172fb">TRI</a>(<a href="/docs/api/classes/transfertracker/#abf13e97a9a5cff9aa06c88d1ac5172fb">TRI</a>),</span></CodeLine>
<Link id="l00275" /><CodeLine lineNumber="275"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#a1b1735405477716ee8dd95236d3257bf">CalleeSavedRegs</a>(<a href="/docs/api/classes/transfertracker/#a1b1735405477716ee8dd95236d3257bf">CalleeSavedRegs</a>) &#123;</span></CodeLine>
<Link id="l00276" /><CodeLine lineNumber="276"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a31452b4b5d9984ee5ed52db4b1a52d5e">TLI</a> = <a href="/docs/api/classes/transfertracker/#a79f160cf45e05ebc07c2751e0bd4d944">MF</a>.getSubtarget().getTargetLowering();</span></CodeLine>
<Link id="l00277" /><CodeLine lineNumber="277"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;TM = TPC.<a href="/docs/api/classes/llvm/targetpassconfig/#aca23623f476d3929484bdad4a5ce54d8">getTM</a>&lt;<a href="/docs/api/classes/llvm/targetmachine">TargetMachine</a>&gt;();</span></CodeLine>
<Link id="l00278" /><CodeLine lineNumber="278"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#af1088d1f2ac99145846bedd829c2a05e">ShouldEmitDebugEntryValues</a> = TM.Options.ShouldEmitDebugEntryValues();</span></CodeLine>
<Link id="l00279" /><CodeLine lineNumber="279"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00280" /><CodeLine lineNumber="280"></CodeLine>
<Link id="l00281" /><CodeLine lineNumber="281" lineLink="/docs/api/classes/transfertracker/#ac546420f6cd906a9b17e41c43e720e98"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#ac546420f6cd906a9b17e41c43e720e98">isCalleeSaved</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> L)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00282" /><CodeLine lineNumber="282"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Reg = <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;LocIdxToLocID&#91;L&#93;;</span></CodeLine>
<Link id="l00283" /><CodeLine lineNumber="283"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Reg &gt;= <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;NumRegs)</span></CodeLine>
<Link id="l00284" /><CodeLine lineNumber="284"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00285" /><CodeLine lineNumber="285"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/mcregaliasiterator">MCRegAliasIterator</a> RAI(Reg, &amp;<a href="/docs/api/classes/transfertracker/#abf13e97a9a5cff9aa06c88d1ac5172fb">TRI</a>, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.<a href="/docs/api/classes/llvm/mcregaliasiterator/#ac336c049c12ead7be5b86e6d046f8ab0">isValid</a>(); ++RAI)</span></CodeLine>
<Link id="l00286" /><CodeLine lineNumber="286"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/transfertracker/#a1b1735405477716ee8dd95236d3257bf">CalleeSavedRegs</a>.test((&#42;RAI).id()))</span></CodeLine>
<Link id="l00287" /><CodeLine lineNumber="287"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00288" /><CodeLine lineNumber="288"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00289" /><CodeLine lineNumber="289"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00290" /><CodeLine lineNumber="290"></CodeLine>
<Link id="l00291" /><CodeLine lineNumber="291"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// An estimate of the expected lifespan of values at a machine location, with</span></CodeLine>
<Link id="l00292" /><CodeLine lineNumber="292"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// a greater value corresponding to a longer expected lifespan, i.e. spill</span></CodeLine>
<Link id="l00293" /><CodeLine lineNumber="293"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// slots generally live longer than callee-saved registers which generally</span></CodeLine>
<Link id="l00294" /><CodeLine lineNumber="294"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// live longer than non-callee-saved registers. The minimum value of 0</span></CodeLine>
<Link id="l00295" /><CodeLine lineNumber="295"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// corresponds to an illegal location that cannot have a &quot;lifespan&quot; at all.</span></CodeLine>
<Link id="l00296" /><CodeLine lineNumber="296" lineLink="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834d"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">enum class</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834d">LocationQuality</a> : </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">char</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00297" /><CodeLine lineNumber="297" lineLink="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da71f91e12ab77fda34a39063650e3b2e7"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da71f91e12ab77fda34a39063650e3b2e7">Illegal</a> = 0,</span></CodeLine>
<Link id="l00298" /><CodeLine lineNumber="298" lineLink="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4">Register</a>,</span></CodeLine>
<Link id="l00299" /><CodeLine lineNumber="299" lineLink="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da356463ee55aa35f2112197b17e3e18f4"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da356463ee55aa35f2112197b17e3e18f4">CalleeSavedRegister</a>,</span></CodeLine>
<Link id="l00300" /><CodeLine lineNumber="300" lineLink="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da927573a0209c7f5f0e934ebb6c90d3bf"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da927573a0209c7f5f0e934ebb6c90d3bf">SpillSlot</a>,</span></CodeLine>
<Link id="l00301" /><CodeLine lineNumber="301" lineLink="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da68ef004de6166492c1d668eb8efe09bd"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da68ef004de6166492c1d668eb8efe09bd">Best</a> = <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da927573a0209c7f5f0e934ebb6c90d3bf">SpillSlot</a></span></CodeLine>
<Link id="l00302" /><CodeLine lineNumber="302"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00303" /><CodeLine lineNumber="303"></CodeLine>
<Link id="l00304" /><CodeLine lineNumber="304" lineLink="/docs/api/classes/transfertracker/locationandquality"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/transfertracker/locationandquality/#af0b8f6f7382ed160594fea63e8341c5e">LocationAndQuality</a> &#123;</span></CodeLine>
<Link id="l00305" /><CodeLine lineNumber="305"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Location : 24;</span></CodeLine>
<Link id="l00306" /><CodeLine lineNumber="306"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Quality : 8;</span></CodeLine>
<Link id="l00307" /><CodeLine lineNumber="307"></CodeLine>
<Link id="l00308" /><CodeLine lineNumber="308"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l00309" /><CodeLine lineNumber="309" lineLink="/docs/api/classes/transfertracker/locationandquality/#af0b8f6f7382ed160594fea63e8341c5e"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/locationandquality/#af0b8f6f7382ed160594fea63e8341c5e">LocationAndQuality</a>() : Location(0), Quality(0) &#123;&#125;</span></CodeLine>
<Link id="l00310" /><CodeLine lineNumber="310" lineLink="/docs/api/classes/transfertracker/locationandquality/#a088495756a3cd53da4efab38c8050a53"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/locationandquality/#a088495756a3cd53da4efab38c8050a53">LocationAndQuality</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> L, <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834d">LocationQuality</a> Q)</span></CodeLine>
<Link id="l00311" /><CodeLine lineNumber="311"><span class="doxyHighlight">        : Location(L.asU64()), Quality(static&#95;cast&lt;unsigned&gt;(Q)) &#123;&#125;</span></CodeLine>
<Link id="l00312" /><CodeLine lineNumber="312" lineLink="/docs/api/classes/transfertracker/locationandquality/#aafbc8ed2fac417ad446be5834b07a1cc"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> <a href="/docs/api/classes/transfertracker/locationandquality/#aafbc8ed2fac417ad446be5834b07a1cc">getLoc</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00313" /><CodeLine lineNumber="313"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Quality)</span></CodeLine>
<Link id="l00314" /><CodeLine lineNumber="314"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/locidx/#a8567f7c20eae6b2f5beabaa440df1097">LocIdx::MakeIllegalLoc</a>();</span></CodeLine>
<Link id="l00315" /><CodeLine lineNumber="315"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a>(Location);</span></CodeLine>
<Link id="l00316" /><CodeLine lineNumber="316"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00317" /><CodeLine lineNumber="317" lineLink="/docs/api/classes/transfertracker/locationandquality/#a14fc47dd260079d24f239d40e88f0371"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834d">LocationQuality</a> <a href="/docs/api/classes/transfertracker/locationandquality/#a14fc47dd260079d24f239d40e88f0371">getQuality</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834d">LocationQuality</a>(Quality); &#125;</span></CodeLine>
<Link id="l00318" /><CodeLine lineNumber="318" lineLink="/docs/api/classes/transfertracker/locationandquality/#aeb178c08bc77adce5c52045faeca87b4"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/locationandquality/#aeb178c08bc77adce5c52045faeca87b4">isIllegal</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !Quality; &#125;</span></CodeLine>
<Link id="l00319" /><CodeLine lineNumber="319" lineLink="/docs/api/classes/transfertracker/locationandquality/#adc6ac95ebdfc8629136cea7fa61e3041"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/locationandquality/#adc6ac95ebdfc8629136cea7fa61e3041">isBest</a>()</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/locationandquality/#a14fc47dd260079d24f239d40e88f0371">getQuality</a>() == <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da68ef004de6166492c1d668eb8efe09bd">LocationQuality::Best</a>; &#125;</span></CodeLine>
<Link id="l00320" /><CodeLine lineNumber="320"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00321" /><CodeLine lineNumber="321"></CodeLine>
<Link id="l00322" /><CodeLine lineNumber="322" lineLink="/docs/api/classes/transfertracker/#afa24ee75e581d521a08c6731becbc964"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/transfertracker/#afa24ee75e581d521a08c6731becbc964">ValueLocPair</a> = std::pair&lt;ValueIDNum, LocationAndQuality&gt;;</span></CodeLine>
<Link id="l00323" /><CodeLine lineNumber="323"></CodeLine>
<Link id="l00324" /><CodeLine lineNumber="324" lineLink="/docs/api/classes/transfertracker/#affb90f774e59ab28e9d3a9d72ac8f8d0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">inline</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#affb90f774e59ab28e9d3a9d72ac8f8d0">ValueToLocSort</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#afa24ee75e581d521a08c6731becbc964">ValueLocPair</a> &amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>,</span></CodeLine>
<Link id="l00325" /><CodeLine lineNumber="325"><span class="doxyHighlight">                                    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#afa24ee75e581d521a08c6731becbc964">ValueLocPair</a> &amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>) &#123;</span></CodeLine>
<Link id="l00326" /><CodeLine lineNumber="326"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>.first &lt; <a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>.first;</span></CodeLine>
<Link id="l00327" /><CodeLine lineNumber="327"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l00328" /><CodeLine lineNumber="328"></CodeLine>
<Link id="l00329" /><CodeLine lineNumber="329"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Returns the LocationQuality for the location L iff the quality of L is</span></CodeLine>
<Link id="l00330" /><CodeLine lineNumber="330"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is strictly greater than the provided minimum quality.</span></CodeLine>
<Link id="l00331" /><CodeLine lineNumber="331"><span class="doxyHighlight">  std::optional&lt;LocationQuality&gt;</span></CodeLine>
<Link id="l00332" /><CodeLine lineNumber="332" lineLink="/docs/api/classes/transfertracker/#a79fb4ee603e9a1f3010aba7fb3da0f82"><span class="doxyHighlight">  <a href="/docs/api/classes/transfertracker/#a79fb4ee603e9a1f3010aba7fb3da0f82">getLocQualityIfBetter</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> L, <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834d">LocationQuality</a> Min)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00333" /><CodeLine lineNumber="333"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (L.isIllegal())</span></CodeLine>
<Link id="l00334" /><CodeLine lineNumber="334"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l00335" /><CodeLine lineNumber="335"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Min &gt;= <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da927573a0209c7f5f0e934ebb6c90d3bf">LocationQuality::SpillSlot</a>)</span></CodeLine>
<Link id="l00336" /><CodeLine lineNumber="336"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l00337" /><CodeLine lineNumber="337"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;isSpill(L))</span></CodeLine>
<Link id="l00338" /><CodeLine lineNumber="338"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da927573a0209c7f5f0e934ebb6c90d3bf">LocationQuality::SpillSlot</a>;</span></CodeLine>
<Link id="l00339" /><CodeLine lineNumber="339"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Min &gt;= <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da356463ee55aa35f2112197b17e3e18f4">LocationQuality::CalleeSavedRegister</a>)</span></CodeLine>
<Link id="l00340" /><CodeLine lineNumber="340"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l00341" /><CodeLine lineNumber="341"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/transfertracker/#ac546420f6cd906a9b17e41c43e720e98">isCalleeSaved</a>(L))</span></CodeLine>
<Link id="l00342" /><CodeLine lineNumber="342"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da356463ee55aa35f2112197b17e3e18f4">LocationQuality::CalleeSavedRegister</a>;</span></CodeLine>
<Link id="l00343" /><CodeLine lineNumber="343"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Min &gt;= <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4">LocationQuality::Register</a>)</span></CodeLine>
<Link id="l00344" /><CodeLine lineNumber="344"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l00345" /><CodeLine lineNumber="345"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4">LocationQuality::Register</a>;</span></CodeLine>
<Link id="l00346" /><CodeLine lineNumber="346"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00347" /><CodeLine lineNumber="347"></CodeLine>
<Link id="l00348" /><CodeLine lineNumber="348"><span class="doxyHighlightComment">  /// For a variable \\p Var with the live-in value \\p Value, attempts to resolve</span></CodeLine>
<Link id="l00349" /><CodeLine lineNumber="349"><span class="doxyHighlightComment">  /// the DbgValue to a concrete DBG&#95;VALUE, emitting that value and loading the</span></CodeLine>
<Link id="l00350" /><CodeLine lineNumber="350"><span class="doxyHighlightComment">  /// tracking information to track Var throughout the block.</span></CodeLine>
<Link id="l00351" /><CodeLine lineNumber="351"><span class="doxyHighlightComment">  /// \\p ValueToLoc is a map containing the best known location for every</span></CodeLine>
<Link id="l00352" /><CodeLine lineNumber="352"><span class="doxyHighlightComment">  ///    ValueIDNum that Value may use.</span></CodeLine>
<Link id="l00353" /><CodeLine lineNumber="353"><span class="doxyHighlightComment">  /// \\p MBB is the basic block that we are loading the live-in value for.</span></CodeLine>
<Link id="l00354" /><CodeLine lineNumber="354"><span class="doxyHighlightComment">  /// \\p DbgOpStore is the map containing the DbgOpID-&gt;DbgOp mapping needed to</span></CodeLine>
<Link id="l00355" /><CodeLine lineNumber="355"><span class="doxyHighlightComment">  ///    determine the values used by Value.</span></CodeLine>
<Link id="l00356" /><CodeLine lineNumber="356" lineLink="/docs/api/classes/transfertracker/#af64654b3c46ec3154963aed1dbb016d2"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#af64654b3c46ec3154963aed1dbb016d2">loadVarInloc</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/classes/livedebugvalues/dbgopidmap">DbgOpIDMap</a> &amp;DbgOpStore,</span></CodeLine>
<Link id="l00357" /><CodeLine lineNumber="357"><span class="doxyHighlight">                    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;ValueLocPair&gt;</a> &amp;ValueToLoc,</span></CodeLine>
<Link id="l00358" /><CodeLine lineNumber="358"><span class="doxyHighlight">                    <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, <a href="/docs/api/classes/livedebugvalues/dbgvalue">DbgValue</a> <a href="/docs/api/classes/llvm/value">Value</a>) &#123;</span></CodeLine>
<Link id="l00359" /><CodeLine lineNumber="359"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;DbgOp&gt;</a> DbgOps;</span></CodeLine>
<Link id="l00360" /><CodeLine lineNumber="360"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ResolvedDbgOp&gt;</a> ResolvedDbgOps;</span></CodeLine>
<Link id="l00361" /><CodeLine lineNumber="361"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsValueValid = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00362" /><CodeLine lineNumber="362"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LastUseBeforeDef = 0;</span></CodeLine>
<Link id="l00363" /><CodeLine lineNumber="363"></CodeLine>
<Link id="l00364" /><CodeLine lineNumber="364"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If every value used by the incoming DbgValue is available at block</span></CodeLine>
<Link id="l00365" /><CodeLine lineNumber="365"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// entry, ResolvedDbgOps will contain the machine locations/constants for</span></CodeLine>
<Link id="l00366" /><CodeLine lineNumber="366"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// those values and will be used to emit a debug location.</span></CodeLine>
<Link id="l00367" /><CodeLine lineNumber="367"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If one or more values are not yet available, but will all be defined in</span></CodeLine>
<Link id="l00368" /><CodeLine lineNumber="368"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// this block, then LastUseBeforeDef will track the instruction index in</span></CodeLine>
<Link id="l00369" /><CodeLine lineNumber="369"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// this BB at which the last of those values is defined, DbgOps will</span></CodeLine>
<Link id="l00370" /><CodeLine lineNumber="370"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// contain the values that we will emit when we reach that instruction.</span></CodeLine>
<Link id="l00371" /><CodeLine lineNumber="371"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If one or more values are undef or not available throughout this block,</span></CodeLine>
<Link id="l00372" /><CodeLine lineNumber="372"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// and we can&#39;t recover as an entry value, we set IsValueValid=false and</span></CodeLine>
<Link id="l00373" /><CodeLine lineNumber="373"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// skip this variable.</span></CodeLine>
<Link id="l00374" /><CodeLine lineNumber="374"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/structs/livedebugvalues/dbgopid">DbgOpID</a> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> : <a href="/docs/api/classes/llvm/value">Value</a>.getDbgOpIDs()) &#123;</span></CodeLine>
<Link id="l00375" /><CodeLine lineNumber="375"><span class="doxyHighlight">      <a href="/docs/api/structs/livedebugvalues/dbgop">DbgOp</a> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> = DbgOpStore.<a href="/docs/api/classes/livedebugvalues/dbgopidmap/#a0ff8cac5d6ff149c80d136de06314455">find</a>(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>);</span></CodeLine>
<Link id="l00376" /><CodeLine lineNumber="376"><span class="doxyHighlight">      DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>);</span></CodeLine>
<Link id="l00377" /><CodeLine lineNumber="377"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>.isUndef()) &#123;</span></CodeLine>
<Link id="l00378" /><CodeLine lineNumber="378"><span class="doxyHighlight">        IsValueValid = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00379" /><CodeLine lineNumber="379"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00380" /><CodeLine lineNumber="380"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00381" /><CodeLine lineNumber="381"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>.isConst()) &#123;</span></CodeLine>
<Link id="l00382" /><CodeLine lineNumber="382"><span class="doxyHighlight">        ResolvedDbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.MO);</span></CodeLine>
<Link id="l00383" /><CodeLine lineNumber="383"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00384" /><CodeLine lineNumber="384"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00385" /><CodeLine lineNumber="385"></CodeLine>
<Link id="l00386" /><CodeLine lineNumber="386"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Search for the desired ValueIDNum, to examine the best location found</span></CodeLine>
<Link id="l00387" /><CodeLine lineNumber="387"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// for it. Use an empty ValueLocPair to search for an entry in ValueToLoc.</span></CodeLine>
<Link id="l00388" /><CodeLine lineNumber="388"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> &amp;Num = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.ID;</span></CodeLine>
<Link id="l00389" /><CodeLine lineNumber="389"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#afa24ee75e581d521a08c6731becbc964">ValueLocPair</a> Probe(Num, <a href="/docs/api/classes/transfertracker/locationandquality">LocationAndQuality</a>());</span></CodeLine>
<Link id="l00390" /><CodeLine lineNumber="390"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ValuesPreferredLoc = std::lower&#95;bound(</span></CodeLine>
<Link id="l00391" /><CodeLine lineNumber="391"><span class="doxyHighlight">          ValueToLoc.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), ValueToLoc.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>(), Probe, <a href="/docs/api/classes/transfertracker/#affb90f774e59ab28e9d3a9d72ac8f8d0">ValueToLocSort</a>);</span></CodeLine>
<Link id="l00392" /><CodeLine lineNumber="392"></CodeLine>
<Link id="l00393" /><CodeLine lineNumber="393"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// There must be a legitimate entry found for Num.</span></CodeLine>
<Link id="l00394" /><CodeLine lineNumber="394"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ValuesPreferredLoc != ValueToLoc.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>() &amp;&amp;</span></CodeLine>
<Link id="l00395" /><CodeLine lineNumber="395"><span class="doxyHighlight">             ValuesPreferredLoc-&gt;first == Num);</span></CodeLine>
<Link id="l00396" /><CodeLine lineNumber="396"></CodeLine>
<Link id="l00397" /><CodeLine lineNumber="397"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValuesPreferredLoc-&gt;second.isIllegal()) &#123;</span></CodeLine>
<Link id="l00398" /><CodeLine lineNumber="398"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If it&#39;s a def that occurs in this block, register it as a</span></CodeLine>
<Link id="l00399" /><CodeLine lineNumber="399"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// use-before-def to be resolved as we step through the block.</span></CodeLine>
<Link id="l00400" /><CodeLine lineNumber="400"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Continue processing values so that we add any other UseBeforeDef</span></CodeLine>
<Link id="l00401" /><CodeLine lineNumber="401"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// entries needed for later.</span></CodeLine>
<Link id="l00402" /><CodeLine lineNumber="402"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#acd482282b8eb9755d8ac0e82ba23c20b">getBlock</a>() == (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight">)<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.getNumber() &amp;&amp; !Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a29e1496690d23acbdb69c5b882f5bf45">isPHI</a>()) &#123;</span></CodeLine>
<Link id="l00403" /><CodeLine lineNumber="403"><span class="doxyHighlight">          LastUseBeforeDef = std::max(LastUseBeforeDef,</span></CodeLine>
<Link id="l00404" /><CodeLine lineNumber="404"><span class="doxyHighlight">                                      </span><span class="doxyHighlightKeyword">static&#95;cast&lt;</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a3092d50fe696007741e04fca94bd8caf">getInst</a>()));</span></CodeLine>
<Link id="l00405" /><CodeLine lineNumber="405"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00406" /><CodeLine lineNumber="406"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l00407" /><CodeLine lineNumber="407"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#ac441348b2e73e12e1d8657de17b76568">recoverAsEntryValue</a>(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, <a href="/docs/api/classes/llvm/value">Value</a>.Properties, Num);</span></CodeLine>
<Link id="l00408" /><CodeLine lineNumber="408"><span class="doxyHighlight">        IsValueValid = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00409" /><CodeLine lineNumber="409"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00410" /><CodeLine lineNumber="410"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00411" /><CodeLine lineNumber="411"></CodeLine>
<Link id="l00412" /><CodeLine lineNumber="412"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Defer modifying ActiveVLocs until after we&#39;ve confirmed we have a</span></CodeLine>
<Link id="l00413" /><CodeLine lineNumber="413"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// live range.</span></CodeLine>
<Link id="l00414" /><CodeLine lineNumber="414"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> M = ValuesPreferredLoc-&gt;second.getLoc();</span></CodeLine>
<Link id="l00415" /><CodeLine lineNumber="415"><span class="doxyHighlight">      ResolvedDbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(M);</span></CodeLine>
<Link id="l00416" /><CodeLine lineNumber="416"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00417" /><CodeLine lineNumber="417"></CodeLine>
<Link id="l00418" /><CodeLine lineNumber="418"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we cannot produce a valid value for the LiveIn value within this</span></CodeLine>
<Link id="l00419" /><CodeLine lineNumber="419"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// block, skip this variable.</span></CodeLine>
<Link id="l00420" /><CodeLine lineNumber="420"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IsValueValid)</span></CodeLine>
<Link id="l00421" /><CodeLine lineNumber="421"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00422" /><CodeLine lineNumber="422"></CodeLine>
<Link id="l00423" /><CodeLine lineNumber="423"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Add UseBeforeDef entry for the last value to be defined in this block.</span></CodeLine>
<Link id="l00424" /><CodeLine lineNumber="424"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LastUseBeforeDef) &#123;</span></CodeLine>
<Link id="l00425" /><CodeLine lineNumber="425"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#a46747b1281d39a5af4e522209198e3f2">addUseBeforeDef</a>(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, <a href="/docs/api/classes/llvm/value">Value</a>.Properties, DbgOps, LastUseBeforeDef);</span></CodeLine>
<Link id="l00426" /><CodeLine lineNumber="426"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00427" /><CodeLine lineNumber="427"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00428" /><CodeLine lineNumber="428"></CodeLine>
<Link id="l00429" /><CodeLine lineNumber="429"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The LiveIn value is available at block entry, begin tracking and record</span></CodeLine>
<Link id="l00430" /><CodeLine lineNumber="430"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the transfer.</span></CodeLine>
<Link id="l00431" /><CodeLine lineNumber="431"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : ResolvedDbgOps)</span></CodeLine>
<Link id="l00432" /><CodeLine lineNumber="432"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.IsConst)</span></CodeLine>
<Link id="l00433" /><CodeLine lineNumber="433"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.Loc&#93;.insert(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00434" /><CodeLine lineNumber="434"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> NewValue = <a href="/docs/api/structs/transfertracker/resolveddbgvalue">ResolvedDbgValue</a>&#123;ResolvedDbgOps, <a href="/docs/api/classes/llvm/value">Value</a>.Properties&#125;;</span></CodeLine>
<Link id="l00435" /><CodeLine lineNumber="435"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Result = <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.insert(std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, NewValue));</span></CodeLine>
<Link id="l00436" /><CodeLine lineNumber="436"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Result.second)</span></CodeLine>
<Link id="l00437" /><CodeLine lineNumber="437"><span class="doxyHighlight">      Result.first-&gt;second = NewValue;</span></CodeLine>
<Link id="l00438" /><CodeLine lineNumber="438"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;&#91;Var, DILoc&#93; = <a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>.lookupDVID(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00439" /><CodeLine lineNumber="439"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>.push&#95;back(</span></CodeLine>
<Link id="l00440" /><CodeLine lineNumber="440"><span class="doxyHighlight">        std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, &amp;&#42;<a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;emitLoc(ResolvedDbgOps, Var, DILoc,</span></CodeLine>
<Link id="l00441" /><CodeLine lineNumber="441"><span class="doxyHighlight">                                                  <a href="/docs/api/classes/llvm/value">Value</a>.Properties)));</span></CodeLine>
<Link id="l00442" /><CodeLine lineNumber="442"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00443" /><CodeLine lineNumber="443"></CodeLine>
<Link id="l00444" /><CodeLine lineNumber="444"><span class="doxyHighlightComment">  /// Load object with live-in variable values. \\p mlocs contains the live-in</span></CodeLine>
<Link id="l00445" /><CodeLine lineNumber="445"><span class="doxyHighlightComment">  /// values in each machine location, while \\p vlocs the live-in variable</span></CodeLine>
<Link id="l00446" /><CodeLine lineNumber="446"><span class="doxyHighlightComment">  /// values. This method picks variable locations for the live-in variables,</span></CodeLine>
<Link id="l00447" /><CodeLine lineNumber="447"><span class="doxyHighlightComment">  /// creates DBG&#95;VALUEs and puts them in #Transfers, then prepares the other</span></CodeLine>
<Link id="l00448" /><CodeLine lineNumber="448"><span class="doxyHighlightComment">  /// object fields to track variable locations as we step through the block.</span></CodeLine>
<Link id="l00449" /><CodeLine lineNumber="449"><span class="doxyHighlightComment">  /// FIXME: could just examine mloctracker instead of passing in \\p mlocs?</span></CodeLine>
<Link id="l00450" /><CodeLine lineNumber="450"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span></CodeLine>
<Link id="l00451" /><CodeLine lineNumber="451" lineLink="/docs/api/classes/transfertracker/#a304b877a673788ae4edd0e8f5fa1d5d8"><span class="doxyHighlight">  <a href="/docs/api/classes/transfertracker/#a304b877a673788ae4edd0e8f5fa1d5d8">loadInlocs</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/namespaces/livedebugvalues/#a7697a3c717033a44ba7f9b272c1d5331">ValueTable</a> &amp;MLocs, <a href="/docs/api/classes/livedebugvalues/dbgopidmap">DbgOpIDMap</a> &amp;DbgOpStore,</span></CodeLine>
<Link id="l00452" /><CodeLine lineNumber="452"><span class="doxyHighlight">             </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl</a>&lt;std::pair&lt;DebugVariableID, DbgValue&gt;&gt; &amp;VLocs,</span></CodeLine>
<Link id="l00453" /><CodeLine lineNumber="453"><span class="doxyHighlight">             </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumLocs) &#123;</span></CodeLine>
<Link id="l00454" /><CodeLine lineNumber="454"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>.clear();</span></CodeLine>
<Link id="l00455" /><CodeLine lineNumber="455"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.clear();</span></CodeLine>
<Link id="l00456" /><CodeLine lineNumber="456"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>.clear();</span></CodeLine>
<Link id="l00457" /><CodeLine lineNumber="457"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>.reserve(NumLocs);</span></CodeLine>
<Link id="l00458" /><CodeLine lineNumber="458"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#ae485598414179a9523e127ad2df4756c">UseBeforeDefs</a>.clear();</span></CodeLine>
<Link id="l00459" /><CodeLine lineNumber="459"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a162a58b620ec34701775d8d3e953fb20">UseBeforeDefVariables</a>.clear();</span></CodeLine>
<Link id="l00460" /><CodeLine lineNumber="460"></CodeLine>
<Link id="l00461" /><CodeLine lineNumber="461"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Mapping of the preferred locations for each value. Collected into this</span></CodeLine>
<Link id="l00462" /><CodeLine lineNumber="462"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// vector then sorted for easy searching.</span></CodeLine>
<Link id="l00463" /><CodeLine lineNumber="463"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ValueLocPair, 16&gt;</a> ValueToLoc;</span></CodeLine>
<Link id="l00464" /><CodeLine lineNumber="464"></CodeLine>
<Link id="l00465" /><CodeLine lineNumber="465"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Initialized the preferred-location map with illegal locations, to be</span></CodeLine>
<Link id="l00466" /><CodeLine lineNumber="466"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// filled in later.</span></CodeLine>
<Link id="l00467" /><CodeLine lineNumber="467"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;VLoc : VLocs)</span></CodeLine>
<Link id="l00468" /><CodeLine lineNumber="468"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VLoc.second.Kind == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba953f120c5617d3f2b42df3fd424222ad">DbgValue::Def</a>)</span></CodeLine>
<Link id="l00469" /><CodeLine lineNumber="469"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/structs/livedebugvalues/dbgopid">DbgOpID</a> OpID : VLoc.second.getDbgOpIDs())</span></CodeLine>
<Link id="l00470" /><CodeLine lineNumber="470"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!OpID.ID.IsConst)</span></CodeLine>
<Link id="l00471" /><CodeLine lineNumber="471"><span class="doxyHighlight">            ValueToLoc.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</span></CodeLine>
<Link id="l00472" /><CodeLine lineNumber="472"><span class="doxyHighlight">                &#123;DbgOpStore.<a href="/docs/api/classes/livedebugvalues/dbgopidmap/#a0ff8cac5d6ff149c80d136de06314455">find</a>(OpID).<a href="/docs/api/structs/livedebugvalues/dbgop/#a17b174ad71c91584d987861d5e8e5d2d">ID</a>, <a href="/docs/api/classes/transfertracker/locationandquality">LocationAndQuality</a>()&#125;);</span></CodeLine>
<Link id="l00473" /><CodeLine lineNumber="473"></CodeLine>
<Link id="l00474" /><CodeLine lineNumber="474"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(ValueToLoc, <a href="/docs/api/classes/transfertracker/#affb90f774e59ab28e9d3a9d72ac8f8d0">ValueToLocSort</a>);</span></CodeLine>
<Link id="l00475" /><CodeLine lineNumber="475"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>.reserve(VLocs.size());</span></CodeLine>
<Link id="l00476" /><CodeLine lineNumber="476"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.reserve(VLocs.size());</span></CodeLine>
<Link id="l00477" /><CodeLine lineNumber="477"></CodeLine>
<Link id="l00478" /><CodeLine lineNumber="478"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Produce a map of value numbers to the current machine locs they live</span></CodeLine>
<Link id="l00479" /><CodeLine lineNumber="479"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// in. When emulating VarLocBasedImpl, there should only be one</span></CodeLine>
<Link id="l00480" /><CodeLine lineNumber="480"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// location; when not, we get to pick.</span></CodeLine>
<Link id="l00481" /><CodeLine lineNumber="481"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;locations()) &#123;</span></CodeLine>
<Link id="l00482" /><CodeLine lineNumber="482"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> Idx = Location.Idx;</span></CodeLine>
<Link id="l00483" /><CodeLine lineNumber="483"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> &amp;VNum = MLocs&#91;Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93;;</span></CodeLine>
<Link id="l00484" /><CodeLine lineNumber="484"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VNum == <a href="/docs/api/classes/livedebugvalues/valueidnum/#a98d44bec6b754ac8786ab97f219f06f1">ValueIDNum::EmptyValue</a>)</span></CodeLine>
<Link id="l00485" /><CodeLine lineNumber="485"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00486" /><CodeLine lineNumber="486"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>.push&#95;back(VNum);</span></CodeLine>
<Link id="l00487" /><CodeLine lineNumber="487"></CodeLine>
<Link id="l00488" /><CodeLine lineNumber="488"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Is there a variable that wants a location for this value? If not, skip.</span></CodeLine>
<Link id="l00489" /><CodeLine lineNumber="489"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#afa24ee75e581d521a08c6731becbc964">ValueLocPair</a> Probe(VNum, <a href="/docs/api/classes/transfertracker/locationandquality">LocationAndQuality</a>());</span></CodeLine>
<Link id="l00490" /><CodeLine lineNumber="490"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> VIt = std::lower&#95;bound(ValueToLoc.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), ValueToLoc.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>(), Probe,</span></CodeLine>
<Link id="l00491" /><CodeLine lineNumber="491"><span class="doxyHighlight">                                  <a href="/docs/api/classes/transfertracker/#affb90f774e59ab28e9d3a9d72ac8f8d0">ValueToLocSort</a>);</span></CodeLine>
<Link id="l00492" /><CodeLine lineNumber="492"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VIt == ValueToLoc.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>() || VIt-&gt;first != VNum)</span></CodeLine>
<Link id="l00493" /><CodeLine lineNumber="493"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00494" /><CodeLine lineNumber="494"></CodeLine>
<Link id="l00495" /><CodeLine lineNumber="495"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Previous = VIt-&gt;second;</span></CodeLine>
<Link id="l00496" /><CodeLine lineNumber="496"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If this is the first location with that value, pick it. Otherwise,</span></CodeLine>
<Link id="l00497" /><CodeLine lineNumber="497"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// consider whether it&#39;s a &quot;longer term&quot; location.</span></CodeLine>
<Link id="l00498" /><CodeLine lineNumber="498"><span class="doxyHighlight">      std::optional&lt;LocationQuality&gt; ReplacementQuality =</span></CodeLine>
<Link id="l00499" /><CodeLine lineNumber="499"><span class="doxyHighlight">          <a href="/docs/api/classes/transfertracker/#a79fb4ee603e9a1f3010aba7fb3da0f82">getLocQualityIfBetter</a>(Idx, Previous.getQuality());</span></CodeLine>
<Link id="l00500" /><CodeLine lineNumber="500"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ReplacementQuality)</span></CodeLine>
<Link id="l00501" /><CodeLine lineNumber="501"><span class="doxyHighlight">        Previous = <a href="/docs/api/classes/transfertracker/locationandquality">LocationAndQuality</a>(Idx, &#42;ReplacementQuality);</span></CodeLine>
<Link id="l00502" /><CodeLine lineNumber="502"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00503" /><CodeLine lineNumber="503"></CodeLine>
<Link id="l00504" /><CodeLine lineNumber="504"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Now map variables to their picked LocIdxes.</span></CodeLine>
<Link id="l00505" /><CodeLine lineNumber="505"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Var : VLocs) &#123;</span></CodeLine>
<Link id="l00506" /><CodeLine lineNumber="506"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#af64654b3c46ec3154963aed1dbb016d2">loadVarInloc</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, DbgOpStore, ValueToLoc, Var.first, Var.second);</span></CodeLine>
<Link id="l00507" /><CodeLine lineNumber="507"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00508" /><CodeLine lineNumber="508"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#acf872fb0e884bca493cc867aac36ed79">flushDbgValues</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.begin(), &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l00509" /><CodeLine lineNumber="509"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00510" /><CodeLine lineNumber="510"></CodeLine>
<Link id="l00511" /><CodeLine lineNumber="511"><span class="doxyHighlightComment">  /// Record that \\p Var has value \\p ID, a value that becomes available</span></CodeLine>
<Link id="l00512" /><CodeLine lineNumber="512"><span class="doxyHighlightComment">  /// later in the function.</span></CodeLine>
<Link id="l00513" /><CodeLine lineNumber="513" lineLink="/docs/api/classes/transfertracker/#a46747b1281d39a5af4e522209198e3f2"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#a46747b1281d39a5af4e522209198e3f2">addUseBeforeDef</a>(<a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>,</span></CodeLine>
<Link id="l00514" /><CodeLine lineNumber="514"><span class="doxyHighlight">                       </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> &amp;Properties,</span></CodeLine>
<Link id="l00515" /><CodeLine lineNumber="515"><span class="doxyHighlight">                       </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;DbgOp&gt;</a> &amp;DbgOps, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Inst) &#123;</span></CodeLine>
<Link id="l00516" /><CodeLine lineNumber="516"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#ae485598414179a9523e127ad2df4756c">UseBeforeDefs</a>&#91;Inst&#93;.emplace&#95;back(DbgOps, <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, Properties);</span></CodeLine>
<Link id="l00517" /><CodeLine lineNumber="517"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a162a58b620ec34701775d8d3e953fb20">UseBeforeDefVariables</a>.insert(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00518" /><CodeLine lineNumber="518"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00519" /><CodeLine lineNumber="519"></CodeLine>
<Link id="l00520" /><CodeLine lineNumber="520"><span class="doxyHighlightComment">  /// After the instruction at index \\p Inst and position \\p pos has been</span></CodeLine>
<Link id="l00521" /><CodeLine lineNumber="521"><span class="doxyHighlightComment">  /// processed, check whether it defines a variable value in a use-before-def.</span></CodeLine>
<Link id="l00522" /><CodeLine lineNumber="522"><span class="doxyHighlightComment">  /// If so, and the variable value hasn&#39;t changed since the start of the</span></CodeLine>
<Link id="l00523" /><CodeLine lineNumber="523"><span class="doxyHighlightComment">  /// block, create a DBG&#95;VALUE.</span></CodeLine>
<Link id="l00524" /><CodeLine lineNumber="524" lineLink="/docs/api/classes/transfertracker/#aa1129d2080e1308fd9bd27d20374ace5"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#aa1129d2080e1308fd9bd27d20374ace5">checkInstForNewValues</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Inst, <a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a> pos) &#123;</span></CodeLine>
<Link id="l00525" /><CodeLine lineNumber="525"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> MIt = <a href="/docs/api/classes/transfertracker/#ae485598414179a9523e127ad2df4756c">UseBeforeDefs</a>.find(Inst);</span></CodeLine>
<Link id="l00526" /><CodeLine lineNumber="526"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MIt == <a href="/docs/api/classes/transfertracker/#ae485598414179a9523e127ad2df4756c">UseBeforeDefs</a>.end())</span></CodeLine>
<Link id="l00527" /><CodeLine lineNumber="527"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00528" /><CodeLine lineNumber="528"></CodeLine>
<Link id="l00529" /><CodeLine lineNumber="529"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Map of values to the locations that store them for every value used by</span></CodeLine>
<Link id="l00530" /><CodeLine lineNumber="530"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the variables that may have become available.</span></CodeLine>
<Link id="l00531" /><CodeLine lineNumber="531"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smalldensemap">SmallDenseMap&lt;ValueIDNum, LocationAndQuality&gt;</a> ValueToLoc;</span></CodeLine>
<Link id="l00532" /><CodeLine lineNumber="532"></CodeLine>
<Link id="l00533" /><CodeLine lineNumber="533"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Populate ValueToLoc with illegal default mappings for every value used by</span></CodeLine>
<Link id="l00534" /><CodeLine lineNumber="534"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// any UseBeforeDef variables for this instruction.</span></CodeLine>
<Link id="l00535" /><CodeLine lineNumber="535"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/classes/llvm/use">Use</a> : MIt-&gt;second) &#123;</span></CodeLine>
<Link id="l00536" /><CodeLine lineNumber="536"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/transfertracker/#a162a58b620ec34701775d8d3e953fb20">UseBeforeDefVariables</a>.count(<a href="/docs/api/classes/llvm/use">Use</a>.VarID))</span></CodeLine>
<Link id="l00537" /><CodeLine lineNumber="537"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00538" /><CodeLine lineNumber="538"></CodeLine>
<Link id="l00539" /><CodeLine lineNumber="539"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/structs/livedebugvalues/dbgop">DbgOp</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/classes/llvm/use">Use</a>.Values) &#123;</span></CodeLine>
<Link id="l00540" /><CodeLine lineNumber="540"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.isUndef() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;UseBeforeDef erroneously created for a &quot;</span></CodeLine>
<Link id="l00541" /><CodeLine lineNumber="541"><span class="doxyHighlight">                                </span><span class="doxyHighlightStringLiteral">&quot;DbgValue with undef values.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00542" /><CodeLine lineNumber="542"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.IsConst)</span></CodeLine>
<Link id="l00543" /><CodeLine lineNumber="543"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00544" /><CodeLine lineNumber="544"></CodeLine>
<Link id="l00545" /><CodeLine lineNumber="545"><span class="doxyHighlight">        ValueToLoc.<a href="/docs/api/classes/llvm/densemapbase/#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(&#123;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.ID, <a href="/docs/api/classes/transfertracker/locationandquality">LocationAndQuality</a>()&#125;);</span></CodeLine>
<Link id="l00546" /><CodeLine lineNumber="546"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00547" /><CodeLine lineNumber="547"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00548" /><CodeLine lineNumber="548"></CodeLine>
<Link id="l00549" /><CodeLine lineNumber="549"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Exit early if we have no DbgValues to produce.</span></CodeLine>
<Link id="l00550" /><CodeLine lineNumber="550"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValueToLoc.<a href="/docs/api/classes/llvm/densemapbase/#a49c487a9395a6c384be8544cfb2cfccf">empty</a>())</span></CodeLine>
<Link id="l00551" /><CodeLine lineNumber="551"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00552" /><CodeLine lineNumber="552"></CodeLine>
<Link id="l00553" /><CodeLine lineNumber="553"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Determine the best location for each desired value.</span></CodeLine>
<Link id="l00554" /><CodeLine lineNumber="554"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;locations()) &#123;</span></CodeLine>
<Link id="l00555" /><CodeLine lineNumber="555"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> Idx = Location.Idx;</span></CodeLine>
<Link id="l00556" /><CodeLine lineNumber="556"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> &amp;LocValueID = Location.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a31d8fb0bf10235e84aae984909edee75">Value</a>;</span></CodeLine>
<Link id="l00557" /><CodeLine lineNumber="557"></CodeLine>
<Link id="l00558" /><CodeLine lineNumber="558"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Is there a variable that wants a location for this value? If not, skip.</span></CodeLine>
<Link id="l00559" /><CodeLine lineNumber="559"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> VIt = ValueToLoc.<a href="/docs/api/classes/llvm/densemapbase/#a0c047f127ed4380a6f383d70bec4eb94">find</a>(LocValueID);</span></CodeLine>
<Link id="l00560" /><CodeLine lineNumber="560"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VIt == ValueToLoc.<a href="/docs/api/classes/llvm/densemapbase/#a65520b9c67759099e313d0f4e7b5ff9e">end</a>())</span></CodeLine>
<Link id="l00561" /><CodeLine lineNumber="561"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00562" /><CodeLine lineNumber="562"></CodeLine>
<Link id="l00563" /><CodeLine lineNumber="563"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Previous = VIt-&gt;second;</span></CodeLine>
<Link id="l00564" /><CodeLine lineNumber="564"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If this is the first location with that value, pick it. Otherwise,</span></CodeLine>
<Link id="l00565" /><CodeLine lineNumber="565"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// consider whether it&#39;s a &quot;longer term&quot; location.</span></CodeLine>
<Link id="l00566" /><CodeLine lineNumber="566"><span class="doxyHighlight">      std::optional&lt;LocationQuality&gt; ReplacementQuality =</span></CodeLine>
<Link id="l00567" /><CodeLine lineNumber="567"><span class="doxyHighlight">          <a href="/docs/api/classes/transfertracker/#a79fb4ee603e9a1f3010aba7fb3da0f82">getLocQualityIfBetter</a>(Idx, Previous.getQuality());</span></CodeLine>
<Link id="l00568" /><CodeLine lineNumber="568"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ReplacementQuality)</span></CodeLine>
<Link id="l00569" /><CodeLine lineNumber="569"><span class="doxyHighlight">        Previous = <a href="/docs/api/classes/transfertracker/locationandquality">LocationAndQuality</a>(Idx, &#42;ReplacementQuality);</span></CodeLine>
<Link id="l00570" /><CodeLine lineNumber="570"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00571" /><CodeLine lineNumber="571"></CodeLine>
<Link id="l00572" /><CodeLine lineNumber="572"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Using the map of values to locations, produce a final set of values for</span></CodeLine>
<Link id="l00573" /><CodeLine lineNumber="573"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// this variable.</span></CodeLine>
<Link id="l00574" /><CodeLine lineNumber="574"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/classes/llvm/use">Use</a> : MIt-&gt;second) &#123;</span></CodeLine>
<Link id="l00575" /><CodeLine lineNumber="575"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/transfertracker/#a162a58b620ec34701775d8d3e953fb20">UseBeforeDefVariables</a>.count(<a href="/docs/api/classes/llvm/use">Use</a>.VarID))</span></CodeLine>
<Link id="l00576" /><CodeLine lineNumber="576"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00577" /><CodeLine lineNumber="577"></CodeLine>
<Link id="l00578" /><CodeLine lineNumber="578"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ResolvedDbgOp&gt;</a> DbgOps;</span></CodeLine>
<Link id="l00579" /><CodeLine lineNumber="579"></CodeLine>
<Link id="l00580" /><CodeLine lineNumber="580"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/structs/livedebugvalues/dbgop">DbgOp</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : <a href="/docs/api/classes/llvm/use">Use</a>.Values) &#123;</span></CodeLine>
<Link id="l00581" /><CodeLine lineNumber="581"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.IsConst) &#123;</span></CodeLine>
<Link id="l00582" /><CodeLine lineNumber="582"><span class="doxyHighlight">          DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.MO);</span></CodeLine>
<Link id="l00583" /><CodeLine lineNumber="583"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00584" /><CodeLine lineNumber="584"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l00585" /><CodeLine lineNumber="585"><span class="doxyHighlight">        <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> NewLoc = ValueToLoc.<a href="/docs/api/classes/llvm/densemapbase/#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.ID)-&gt;second.getLoc();</span></CodeLine>
<Link id="l00586" /><CodeLine lineNumber="586"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewLoc.<a href="/docs/api/classes/livedebugvalues/locidx/#a40076b99dca773c0cc6c994d8445c00a">isIllegal</a>())</span></CodeLine>
<Link id="l00587" /><CodeLine lineNumber="587"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00588" /><CodeLine lineNumber="588"><span class="doxyHighlight">        DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NewLoc);</span></CodeLine>
<Link id="l00589" /><CodeLine lineNumber="589"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00590" /><CodeLine lineNumber="590"></CodeLine>
<Link id="l00591" /><CodeLine lineNumber="591"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If at least one value used by this debug value is no longer available,</span></CodeLine>
<Link id="l00592" /><CodeLine lineNumber="592"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// i.e. one of the values was killed before we finished defining all of</span></CodeLine>
<Link id="l00593" /><CodeLine lineNumber="593"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// the values used by this variable, discard.</span></CodeLine>
<Link id="l00594" /><CodeLine lineNumber="594"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() != <a href="/docs/api/classes/llvm/use">Use</a>.Values.size())</span></CodeLine>
<Link id="l00595" /><CodeLine lineNumber="595"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00596" /><CodeLine lineNumber="596"></CodeLine>
<Link id="l00597" /><CodeLine lineNumber="597"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Otherwise, we&#39;re good to go.</span></CodeLine>
<Link id="l00598" /><CodeLine lineNumber="598"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;&#91;Var, DILoc&#93; = <a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>.lookupDVID(<a href="/docs/api/classes/llvm/use">Use</a>.VarID);</span></CodeLine>
<Link id="l00599" /><CodeLine lineNumber="599"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>.push&#95;back(std::make&#95;pair(</span></CodeLine>
<Link id="l00600" /><CodeLine lineNumber="600"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/use">Use</a>.VarID, <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;emitLoc(DbgOps, Var, DILoc, <a href="/docs/api/classes/llvm/use">Use</a>.Properties)));</span></CodeLine>
<Link id="l00601" /><CodeLine lineNumber="601"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00602" /><CodeLine lineNumber="602"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#acf872fb0e884bca493cc867aac36ed79">flushDbgValues</a>(pos, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00603" /><CodeLine lineNumber="603"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00604" /><CodeLine lineNumber="604"></CodeLine>
<Link id="l00605" /><CodeLine lineNumber="605"><span class="doxyHighlightComment">  /// Helper to move created DBG&#95;VALUEs into Transfers collection.</span></CodeLine>
<Link id="l00606" /><CodeLine lineNumber="606" lineLink="/docs/api/classes/transfertracker/#acf872fb0e884bca493cc867aac36ed79"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#acf872fb0e884bca493cc867aac36ed79">flushDbgValues</a>(<a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a> Pos, <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l00607" /><CodeLine lineNumber="607"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>.size() == 0)</span></CodeLine>
<Link id="l00608" /><CodeLine lineNumber="608"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00609" /><CodeLine lineNumber="609"></CodeLine>
<Link id="l00610" /><CodeLine lineNumber="610"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Pick out the instruction start position.</span></CodeLine>
<Link id="l00611" /><CodeLine lineNumber="611"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock/#ab6395548cae73865213e279ae461db54">MachineBasicBlock::instr&#95;iterator</a> BundleStart;</span></CodeLine>
<Link id="l00612" /><CodeLine lineNumber="612"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> &amp;&amp; Pos == <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;begin())</span></CodeLine>
<Link id="l00613" /><CodeLine lineNumber="613"><span class="doxyHighlight">      BundleStart = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;instr&#95;begin();</span></CodeLine>
<Link id="l00614" /><CodeLine lineNumber="614"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00615" /><CodeLine lineNumber="615"><span class="doxyHighlight">      BundleStart = <a href="/docs/api/namespaces/llvm/#a0b1a8d3b98bc35fd5cb5b04843beeea5">getBundleStart</a>(Pos-&gt;getIterator());</span></CodeLine>
<Link id="l00616" /><CodeLine lineNumber="616"></CodeLine>
<Link id="l00617" /><CodeLine lineNumber="617"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#af06b11c084b9a4ff7e063e146d4131d3">Transfers</a>.push&#95;back(&#123;BundleStart, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>&#125;);</span></CodeLine>
<Link id="l00618" /><CodeLine lineNumber="618"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>.clear();</span></CodeLine>
<Link id="l00619" /><CodeLine lineNumber="619"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00620" /><CodeLine lineNumber="620"></CodeLine>
<Link id="l00621" /><CodeLine lineNumber="621" lineLink="/docs/api/classes/transfertracker/#a930c119c5ebcb496e7665a4521f42b94"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#a930c119c5ebcb496e7665a4521f42b94">isEntryValueVariable</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/debugvariable">DebugVariable</a> &amp;Var,</span></CodeLine>
<Link id="l00622" /><CodeLine lineNumber="622"><span class="doxyHighlight">                            </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/diexpression">DIExpression</a> &#42;Expr)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00623" /><CodeLine lineNumber="623"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Var.<a href="/docs/api/classes/llvm/debugvariable/#af2ca096ab72c055f6c2c7e3ffbe5d6bf">getVariable</a>()-&gt;<a href="/docs/api/classes/llvm/dilocalvariable/#a45c267092569766aa684c6ba3bae9634">isParameter</a>())</span></CodeLine>
<Link id="l00624" /><CodeLine lineNumber="624"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00625" /><CodeLine lineNumber="625"></CodeLine>
<Link id="l00626" /><CodeLine lineNumber="626"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Var.<a href="/docs/api/classes/llvm/debugvariable/#a58e53986006a2e7d95385fe4e633fb2e">getInlinedAt</a>())</span></CodeLine>
<Link id="l00627" /><CodeLine lineNumber="627"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00628" /><CodeLine lineNumber="628"></CodeLine>
<Link id="l00629" /><CodeLine lineNumber="629"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Expr-&gt;<a href="/docs/api/classes/llvm/diexpression/#a1b59c8fe81267b338774bf6c542f90ee">getNumElements</a>() &gt; 0 &amp;&amp; !Expr-&gt;<a href="/docs/api/classes/llvm/diexpression/#a8facdaa3e5cf886085dbc81082bc8d41">isDeref</a>())</span></CodeLine>
<Link id="l00630" /><CodeLine lineNumber="630"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00631" /><CodeLine lineNumber="631"></CodeLine>
<Link id="l00632" /><CodeLine lineNumber="632"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00633" /><CodeLine lineNumber="633"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00634" /><CodeLine lineNumber="634"></CodeLine>
<Link id="l00635" /><CodeLine lineNumber="635" lineLink="/docs/api/classes/transfertracker/#ab76cea3708e144106a37446994e2482c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#ab76cea3708e144106a37446994e2482c">isEntryValueValue</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> &amp;Val)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00636" /><CodeLine lineNumber="636"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Must be in entry block (block number zero), and be a PHI / live-in value.</span></CodeLine>
<Link id="l00637" /><CodeLine lineNumber="637"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Val.<a href="/docs/api/classes/livedebugvalues/valueidnum/#acd482282b8eb9755d8ac0e82ba23c20b">getBlock</a>() || !Val.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a29e1496690d23acbdb69c5b882f5bf45">isPHI</a>())</span></CodeLine>
<Link id="l00638" /><CodeLine lineNumber="638"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00639" /><CodeLine lineNumber="639"></CodeLine>
<Link id="l00640" /><CodeLine lineNumber="640"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Entry values must enter in a register.</span></CodeLine>
<Link id="l00641" /><CodeLine lineNumber="641"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;isSpill(Val.<a href="/docs/api/classes/livedebugvalues/valueidnum/#af0ee865517c9747fa74f9eb3ed54578a">getLoc</a>()))</span></CodeLine>
<Link id="l00642" /><CodeLine lineNumber="642"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00643" /><CodeLine lineNumber="643"></CodeLine>
<Link id="l00644" /><CodeLine lineNumber="644"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4">Register</a> SP = <a href="/docs/api/classes/transfertracker/#a31452b4b5d9984ee5ed52db4b1a52d5e">TLI</a>-&gt;getStackPointerRegisterToSaveRestore();</span></CodeLine>
<Link id="l00645" /><CodeLine lineNumber="645"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4">Register</a> <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64iseldagtodag-cpp/#a2098a5fa6ada61b6c4a1f210ad84e4a1a4ebada6a2af2bcba53ded1d7b414f081">FP</a> = <a href="/docs/api/classes/transfertracker/#abf13e97a9a5cff9aa06c88d1ac5172fb">TRI</a>.getFrameRegister(<a href="/docs/api/classes/transfertracker/#a79f160cf45e05ebc07c2751e0bd4d944">MF</a>);</span></CodeLine>
<Link id="l00646" /><CodeLine lineNumber="646"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4">Register</a> Reg = <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;LocIdxToLocID&#91;Val.<a href="/docs/api/classes/livedebugvalues/valueidnum/#af0ee865517c9747fa74f9eb3ed54578a">getLoc</a>()&#93;;</span></CodeLine>
<Link id="l00647" /><CodeLine lineNumber="647"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Reg != SP &amp;&amp; Reg != <a href="/docs/api/files/lib/lib/target/lib/target/aarch64/aarch64iseldagtodag-cpp/#a2098a5fa6ada61b6c4a1f210ad84e4a1a4ebada6a2af2bcba53ded1d7b414f081">FP</a>;</span></CodeLine>
<Link id="l00648" /><CodeLine lineNumber="648"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00649" /><CodeLine lineNumber="649"></CodeLine>
<Link id="l00650" /><CodeLine lineNumber="650" lineLink="/docs/api/classes/transfertracker/#ac441348b2e73e12e1d8657de17b76568"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#ac441348b2e73e12e1d8657de17b76568">recoverAsEntryValue</a>(<a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>,</span></CodeLine>
<Link id="l00651" /><CodeLine lineNumber="651"><span class="doxyHighlight">                           </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> &amp;Prop,</span></CodeLine>
<Link id="l00652" /><CodeLine lineNumber="652"><span class="doxyHighlight">                           </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> &amp;Num) &#123;</span></CodeLine>
<Link id="l00653" /><CodeLine lineNumber="653"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Is this variable location a candidate to be an entry value. First,</span></CodeLine>
<Link id="l00654" /><CodeLine lineNumber="654"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// should we be trying this at all?</span></CodeLine>
<Link id="l00655" /><CodeLine lineNumber="655"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/transfertracker/#af1088d1f2ac99145846bedd829c2a05e">ShouldEmitDebugEntryValues</a>)</span></CodeLine>
<Link id="l00656" /><CodeLine lineNumber="656"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00657" /><CodeLine lineNumber="657"></CodeLine>
<Link id="l00658" /><CodeLine lineNumber="658"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/diexpression">DIExpression</a> &#42;DIExpr = Prop.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a87d598e34086fb45a3a64638bdc6097e">DIExpr</a>;</span></CodeLine>
<Link id="l00659" /><CodeLine lineNumber="659"></CodeLine>
<Link id="l00660" /><CodeLine lineNumber="660"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We don&#39;t currently emit entry values for DBG&#95;VALUE&#95;LISTs.</span></CodeLine>
<Link id="l00661" /><CodeLine lineNumber="661"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Prop.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#aebaf15eb5116df110c1de27c5c8901a2">IsVariadic</a>) &#123;</span></CodeLine>
<Link id="l00662" /><CodeLine lineNumber="662"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If this debug value can be converted to be non-variadic, then do so;</span></CodeLine>
<Link id="l00663" /><CodeLine lineNumber="663"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// otherwise give up.</span></CodeLine>
<Link id="l00664" /><CodeLine lineNumber="664"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> NonVariadicExpression =</span></CodeLine>
<Link id="l00665" /><CodeLine lineNumber="665"><span class="doxyHighlight">          <a href="/docs/api/classes/llvm/diexpression/#a854dc7a14b5443f6244301690474c7a0">DIExpression::convertToNonVariadicExpression</a>(DIExpr);</span></CodeLine>
<Link id="l00666" /><CodeLine lineNumber="666"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NonVariadicExpression)</span></CodeLine>
<Link id="l00667" /><CodeLine lineNumber="667"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00668" /><CodeLine lineNumber="668"><span class="doxyHighlight">      DIExpr = &#42;NonVariadicExpression;</span></CodeLine>
<Link id="l00669" /><CodeLine lineNumber="669"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00670" /><CodeLine lineNumber="670"></CodeLine>
<Link id="l00671" /><CodeLine lineNumber="671"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;&#91;Var, DILoc&#93; = <a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>.lookupDVID(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00672" /><CodeLine lineNumber="672"></CodeLine>
<Link id="l00673" /><CodeLine lineNumber="673"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Is the variable appropriate for entry values (i.e., is a parameter).</span></CodeLine>
<Link id="l00674" /><CodeLine lineNumber="674"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/transfertracker/#a930c119c5ebcb496e7665a4521f42b94">isEntryValueVariable</a>(Var, DIExpr))</span></CodeLine>
<Link id="l00675" /><CodeLine lineNumber="675"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00676" /><CodeLine lineNumber="676"></CodeLine>
<Link id="l00677" /><CodeLine lineNumber="677"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Is the value assigned to this variable still the entry value?</span></CodeLine>
<Link id="l00678" /><CodeLine lineNumber="678"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/classes/transfertracker/#ab76cea3708e144106a37446994e2482c">isEntryValueValue</a>(Num))</span></CodeLine>
<Link id="l00679" /><CodeLine lineNumber="679"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00680" /><CodeLine lineNumber="680"></CodeLine>
<Link id="l00681" /><CodeLine lineNumber="681"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Emit a variable location using an entry value expression.</span></CodeLine>
<Link id="l00682" /><CodeLine lineNumber="682"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/diexpression">DIExpression</a> &#42;<a href="/docs/api/classes/newexpr">NewExpr</a> =</span></CodeLine>
<Link id="l00683" /><CodeLine lineNumber="683"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/diexpression/#ab804b15bb92ff685d7c1464b2816d608">DIExpression::prepend</a>(DIExpr, <a href="/docs/api/classes/llvm/diexpression/#a6472489551b8960cc115a93d95eef9f6a732b32a9387e1f0a0b49cd59b96905ae">DIExpression::EntryValue</a>);</span></CodeLine>
<Link id="l00684" /><CodeLine lineNumber="684"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4">Register</a> Reg = <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;LocIdxToLocID&#91;Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#af0ee865517c9747fa74f9eb3ed54578a">getLoc</a>()&#93;;</span></CodeLine>
<Link id="l00685" /><CodeLine lineNumber="685"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> MO = <a href="/docs/api/classes/llvm/machineoperand/#af2c351dad09a71aa08e1d85c67ae6e53">MachineOperand::CreateReg</a>(Reg, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00686" /><CodeLine lineNumber="686"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>.push&#95;back(std::make&#95;pair(</span></CodeLine>
<Link id="l00687" /><CodeLine lineNumber="687"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, &amp;&#42;<a href="/docs/api/classes/transfertracker/#ab17b4ddf05538aab17dbb53a0f5f4329">emitMOLoc</a>(MO, Var, &#123;<a href="/docs/api/classes/newexpr">NewExpr</a>, Prop.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a7f88fbb422e5e0d5c0e227b3df0bd8a8">Indirect</a>, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">&#125;)));</span></CodeLine>
<Link id="l00688" /><CodeLine lineNumber="688"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00689" /><CodeLine lineNumber="689"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00690" /><CodeLine lineNumber="690"></CodeLine>
<Link id="l00691" /><CodeLine lineNumber="691"><span class="doxyHighlightComment">  /// Change a variable value after encountering a DBG&#95;VALUE inside a block.</span></CodeLine>
<Link id="l00692" /><CodeLine lineNumber="692" lineLink="/docs/api/classes/transfertracker/#ac1753e9184a776f25f017ac1022f2a13"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#ac1753e9184a776f25f017ac1022f2a13">redefVar</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l00693" /><CodeLine lineNumber="693"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/debugvariable">DebugVariable</a> Var(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugVariable(), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugExpression(),</span></CodeLine>
<Link id="l00694" /><CodeLine lineNumber="694"><span class="doxyHighlight">                      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc()-&gt;getInlinedAt());</span></CodeLine>
<Link id="l00695" /><CodeLine lineNumber="695"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> Properties(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l00696" /><CodeLine lineNumber="696"><span class="doxyHighlight">    <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a> = <a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>.getDVID(Var);</span></CodeLine>
<Link id="l00697" /><CodeLine lineNumber="697"></CodeLine>
<Link id="l00698" /><CodeLine lineNumber="698"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Ignore non-register locations, we don&#39;t transfer those.</span></CodeLine>
<Link id="l00699" /><CodeLine lineNumber="699"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isUndefDebugValue() ||</span></CodeLine>
<Link id="l00700" /><CodeLine lineNumber="700"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a0d10fe510ced2849a8074fe81e5d04ce">all&#95;of</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.debug&#95;operands(),</span></CodeLine>
<Link id="l00701" /><CodeLine lineNumber="701"><span class="doxyHighlight">               &#91;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO) &#123; return !MO.isReg(); &#125;)) &#123;</span></CodeLine>
<Link id="l00702" /><CodeLine lineNumber="702"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> It = <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.find(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00703" /><CodeLine lineNumber="703"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (It != <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.end()) &#123;</span></CodeLine>
<Link id="l00704" /><CodeLine lineNumber="704"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> <a href="/docs/api/namespaces/llvm/loc">Loc</a> : It-&gt;second.loc&#95;indices())</span></CodeLine>
<Link id="l00705" /><CodeLine lineNumber="705"><span class="doxyHighlight">          <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;<a href="/docs/api/namespaces/llvm/loc">Loc</a>&#93;.erase(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00706" /><CodeLine lineNumber="706"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.erase(It);</span></CodeLine>
<Link id="l00707" /><CodeLine lineNumber="707"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00708" /><CodeLine lineNumber="708"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Any use-before-defs no longer apply.</span></CodeLine>
<Link id="l00709" /><CodeLine lineNumber="709"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#a162a58b620ec34701775d8d3e953fb20">UseBeforeDefVariables</a>.erase(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00710" /><CodeLine lineNumber="710"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00711" /><CodeLine lineNumber="711"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00712" /><CodeLine lineNumber="712"></CodeLine>
<Link id="l00713" /><CodeLine lineNumber="713"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ResolvedDbgOp&gt;</a> NewLocs;</span></CodeLine>
<Link id="l00714" /><CodeLine lineNumber="714"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.debug&#95;operands()) &#123;</span></CodeLine>
<Link id="l00715" /><CodeLine lineNumber="715"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a4c9594c955fec80c73ddd964b5efd554">isReg</a>()) &#123;</span></CodeLine>
<Link id="l00716" /><CodeLine lineNumber="716"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Any undef regs have already been filtered out above.</span></CodeLine>
<Link id="l00717" /><CodeLine lineNumber="717"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#aa5d994f6e3b0b93e697c85ca2002834da0ba7583639a274c434bbe6ef797115a4">Register</a> Reg = MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</span></CodeLine>
<Link id="l00718" /><CodeLine lineNumber="718"><span class="doxyHighlight">        <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> NewLoc = <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;getRegMLoc(Reg);</span></CodeLine>
<Link id="l00719" /><CodeLine lineNumber="719"><span class="doxyHighlight">        NewLocs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(NewLoc);</span></CodeLine>
<Link id="l00720" /><CodeLine lineNumber="720"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00721" /><CodeLine lineNumber="721"><span class="doxyHighlight">        NewLocs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(MO);</span></CodeLine>
<Link id="l00722" /><CodeLine lineNumber="722"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00723" /><CodeLine lineNumber="723"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00724" /><CodeLine lineNumber="724"></CodeLine>
<Link id="l00725" /><CodeLine lineNumber="725"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#ac1753e9184a776f25f017ac1022f2a13">redefVar</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, Properties, NewLocs);</span></CodeLine>
<Link id="l00726" /><CodeLine lineNumber="726"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00727" /><CodeLine lineNumber="727"></CodeLine>
<Link id="l00728" /><CodeLine lineNumber="728"><span class="doxyHighlightComment">  /// Handle a change in variable location within a block. Terminate the</span></CodeLine>
<Link id="l00729" /><CodeLine lineNumber="729"><span class="doxyHighlightComment">  /// variables current location, and record the value it now refers to, so</span></CodeLine>
<Link id="l00730" /><CodeLine lineNumber="730"><span class="doxyHighlightComment">  /// that we can detect location transfers later on.</span></CodeLine>
<Link id="l00731" /><CodeLine lineNumber="731" lineLink="/docs/api/classes/transfertracker/#af3b3d27cd53936e3c52e01a34817d6be"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#af3b3d27cd53936e3c52e01a34817d6be">redefVar</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> &amp;Properties,</span></CodeLine>
<Link id="l00732" /><CodeLine lineNumber="732"><span class="doxyHighlight">                <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;ResolvedDbgOp&gt;</a> &amp;NewLocs) &#123;</span></CodeLine>
<Link id="l00733" /><CodeLine lineNumber="733"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/debugvariable">DebugVariable</a> Var(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugVariable(), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugExpression(),</span></CodeLine>
<Link id="l00734" /><CodeLine lineNumber="734"><span class="doxyHighlight">                      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc()-&gt;getInlinedAt());</span></CodeLine>
<Link id="l00735" /><CodeLine lineNumber="735"><span class="doxyHighlight">    <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a> = <a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>.getDVID(Var);</span></CodeLine>
<Link id="l00736" /><CodeLine lineNumber="736"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Any use-before-defs no longer apply.</span></CodeLine>
<Link id="l00737" /><CodeLine lineNumber="737"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a162a58b620ec34701775d8d3e953fb20">UseBeforeDefVariables</a>.erase(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00738" /><CodeLine lineNumber="738"></CodeLine>
<Link id="l00739" /><CodeLine lineNumber="739"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Erase any previous location.</span></CodeLine>
<Link id="l00740" /><CodeLine lineNumber="740"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> It = <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.find(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00741" /><CodeLine lineNumber="741"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (It != <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.end()) &#123;</span></CodeLine>
<Link id="l00742" /><CodeLine lineNumber="742"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> <a href="/docs/api/namespaces/llvm/loc">Loc</a> : It-&gt;second.loc&#95;indices())</span></CodeLine>
<Link id="l00743" /><CodeLine lineNumber="743"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;<a href="/docs/api/namespaces/llvm/loc">Loc</a>&#93;.erase(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00744" /><CodeLine lineNumber="744"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00745" /><CodeLine lineNumber="745"></CodeLine>
<Link id="l00746" /><CodeLine lineNumber="746"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If there &#95;is&#95; no new location, all we had to do was erase.</span></CodeLine>
<Link id="l00747" /><CodeLine lineNumber="747"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewLocs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l00748" /><CodeLine lineNumber="748"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (It != <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.end())</span></CodeLine>
<Link id="l00749" /><CodeLine lineNumber="749"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.erase(It);</span></CodeLine>
<Link id="l00750" /><CodeLine lineNumber="750"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00751" /><CodeLine lineNumber="751"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00752" /><CodeLine lineNumber="752"></CodeLine>
<Link id="l00753" /><CodeLine lineNumber="753"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;LocIdx, DebugVariableID&gt;</a>&gt; LostMLocs;</span></CodeLine>
<Link id="l00754" /><CodeLine lineNumber="754"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : NewLocs) &#123;</span></CodeLine>
<Link id="l00755" /><CodeLine lineNumber="755"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.IsConst)</span></CodeLine>
<Link id="l00756" /><CodeLine lineNumber="756"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00757" /><CodeLine lineNumber="757"></CodeLine>
<Link id="l00758" /><CodeLine lineNumber="758"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> NewLoc = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.Loc;</span></CodeLine>
<Link id="l00759" /><CodeLine lineNumber="759"></CodeLine>
<Link id="l00760" /><CodeLine lineNumber="760"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Check whether our local copy of values-by-location in #VarLocs is out</span></CodeLine>
<Link id="l00761" /><CodeLine lineNumber="761"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// of date. Wipe old tracking data for the location if it&#39;s been clobbered</span></CodeLine>
<Link id="l00762" /><CodeLine lineNumber="762"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// in the meantime.</span></CodeLine>
<Link id="l00763" /><CodeLine lineNumber="763"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;readMLoc(NewLoc) != <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;NewLoc.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93;) &#123;</span></CodeLine>
<Link id="l00764" /><CodeLine lineNumber="764"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;NewLoc&#93;) &#123;</span></CodeLine>
<Link id="l00765" /><CodeLine lineNumber="765"><span class="doxyHighlight">          </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LostVLocIt = <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.find(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>);</span></CodeLine>
<Link id="l00766" /><CodeLine lineNumber="766"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LostVLocIt != <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.end()) &#123;</span></CodeLine>
<Link id="l00767" /><CodeLine lineNumber="767"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> <a href="/docs/api/namespaces/llvm/loc">Loc</a> : LostVLocIt-&gt;second.loc&#95;indices()) &#123;</span></CodeLine>
<Link id="l00768" /><CodeLine lineNumber="768"><span class="doxyHighlight">              </span><span class="doxyHighlightComment">// Every active variable mapping for NewLoc will be cleared, no</span></CodeLine>
<Link id="l00769" /><CodeLine lineNumber="769"><span class="doxyHighlight">              </span><span class="doxyHighlightComment">// need to track individual variables.</span></CodeLine>
<Link id="l00770" /><CodeLine lineNumber="770"><span class="doxyHighlight">              </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/loc">Loc</a> == NewLoc)</span></CodeLine>
<Link id="l00771" /><CodeLine lineNumber="771"><span class="doxyHighlight">                </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00772" /><CodeLine lineNumber="772"><span class="doxyHighlight">              LostMLocs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>);</span></CodeLine>
<Link id="l00773" /><CodeLine lineNumber="773"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l00774" /><CodeLine lineNumber="774"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l00775" /><CodeLine lineNumber="775"><span class="doxyHighlight">          <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.erase(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>);</span></CodeLine>
<Link id="l00776" /><CodeLine lineNumber="776"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l00777" /><CodeLine lineNumber="777"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;LostMLoc : LostMLocs)</span></CodeLine>
<Link id="l00778" /><CodeLine lineNumber="778"><span class="doxyHighlight">          <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;LostMLoc.first&#93;.erase(LostMLoc.second);</span></CodeLine>
<Link id="l00779" /><CodeLine lineNumber="779"><span class="doxyHighlight">        LostMLocs.clear();</span></CodeLine>
<Link id="l00780" /><CodeLine lineNumber="780"><span class="doxyHighlight">        It = <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.find(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00781" /><CodeLine lineNumber="781"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;NewLoc.asU64()&#93;.clear();</span></CodeLine>
<Link id="l00782" /><CodeLine lineNumber="782"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;NewLoc.asU64()&#93; = <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;readMLoc(NewLoc);</span></CodeLine>
<Link id="l00783" /><CodeLine lineNumber="783"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00784" /><CodeLine lineNumber="784"></CodeLine>
<Link id="l00785" /><CodeLine lineNumber="785"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;NewLoc&#93;.insert(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00786" /><CodeLine lineNumber="786"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00787" /><CodeLine lineNumber="787"></CodeLine>
<Link id="l00788" /><CodeLine lineNumber="788"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (It == <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.end()) &#123;</span></CodeLine>
<Link id="l00789" /><CodeLine lineNumber="789"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.insert(</span></CodeLine>
<Link id="l00790" /><CodeLine lineNumber="790"><span class="doxyHighlight">          std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, <a href="/docs/api/structs/transfertracker/resolveddbgvalue">ResolvedDbgValue</a>(NewLocs, Properties)));</span></CodeLine>
<Link id="l00791" /><CodeLine lineNumber="791"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00792" /><CodeLine lineNumber="792"><span class="doxyHighlight">      It-&gt;second.Ops.assign(NewLocs);</span></CodeLine>
<Link id="l00793" /><CodeLine lineNumber="793"><span class="doxyHighlight">      It-&gt;second.Properties = Properties;</span></CodeLine>
<Link id="l00794" /><CodeLine lineNumber="794"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00795" /><CodeLine lineNumber="795"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00796" /><CodeLine lineNumber="796"></CodeLine>
<Link id="l00797" /><CodeLine lineNumber="797"><span class="doxyHighlightComment">  /// Account for a location \\p mloc being clobbered. Examine the variable</span></CodeLine>
<Link id="l00798" /><CodeLine lineNumber="798"><span class="doxyHighlightComment">  /// locations that will be terminated: and try to recover them by using</span></CodeLine>
<Link id="l00799" /><CodeLine lineNumber="799"><span class="doxyHighlightComment">  /// another location. Optionally, given \\p MakeUndef, emit a DBG&#95;VALUE to</span></CodeLine>
<Link id="l00800" /><CodeLine lineNumber="800"><span class="doxyHighlightComment">  /// explicitly terminate a location if it can&#39;t be recovered.</span></CodeLine>
<Link id="l00801" /><CodeLine lineNumber="801" lineLink="/docs/api/classes/transfertracker/#ac9ed6c9ebb7ede8539a8fe20bfeb36c2"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#ac9ed6c9ebb7ede8539a8fe20bfeb36c2">clobberMloc</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> MLoc, <a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a> Pos,</span></CodeLine>
<Link id="l00802" /><CodeLine lineNumber="802"><span class="doxyHighlight">                   </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> MakeUndef = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l00803" /><CodeLine lineNumber="803"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ActiveMLocIt = <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>.find(MLoc);</span></CodeLine>
<Link id="l00804" /><CodeLine lineNumber="804"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ActiveMLocIt == <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>.end())</span></CodeLine>
<Link id="l00805" /><CodeLine lineNumber="805"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00806" /><CodeLine lineNumber="806"></CodeLine>
<Link id="l00807" /><CodeLine lineNumber="807"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// What was the old variable value?</span></CodeLine>
<Link id="l00808" /><CodeLine lineNumber="808"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> OldValue = <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;MLoc.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93;;</span></CodeLine>
<Link id="l00809" /><CodeLine lineNumber="809"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#ac9ed6c9ebb7ede8539a8fe20bfeb36c2">clobberMloc</a>(MLoc, OldValue, Pos, MakeUndef);</span></CodeLine>
<Link id="l00810" /><CodeLine lineNumber="810"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00811" /><CodeLine lineNumber="811"><span class="doxyHighlightComment">  /// Overload that takes an explicit value \\p OldValue for when the value in</span></CodeLine>
<Link id="l00812" /><CodeLine lineNumber="812"><span class="doxyHighlightComment">  /// \\p MLoc has changed and the TransferTracker&#39;s locations have not been</span></CodeLine>
<Link id="l00813" /><CodeLine lineNumber="813"><span class="doxyHighlightComment">  /// updated yet.</span></CodeLine>
<Link id="l00814" /><CodeLine lineNumber="814" lineLink="/docs/api/classes/transfertracker/#aee68454c02cb09e9dc1213c607ee78b9"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#aee68454c02cb09e9dc1213c607ee78b9">clobberMloc</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> MLoc, <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> OldValue,</span></CodeLine>
<Link id="l00815" /><CodeLine lineNumber="815"><span class="doxyHighlight">                   <a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a> Pos, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> MakeUndef = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">) &#123;</span></CodeLine>
<Link id="l00816" /><CodeLine lineNumber="816"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ActiveMLocIt = <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>.find(MLoc);</span></CodeLine>
<Link id="l00817" /><CodeLine lineNumber="817"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ActiveMLocIt == <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>.end())</span></CodeLine>
<Link id="l00818" /><CodeLine lineNumber="818"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00819" /><CodeLine lineNumber="819"></CodeLine>
<Link id="l00820" /><CodeLine lineNumber="820"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;MLoc.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93; = <a href="/docs/api/classes/livedebugvalues/valueidnum/#a98d44bec6b754ac8786ab97f219f06f1">ValueIDNum::EmptyValue</a>;</span></CodeLine>
<Link id="l00821" /><CodeLine lineNumber="821"></CodeLine>
<Link id="l00822" /><CodeLine lineNumber="822"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Examine the remaining variable locations: if we can find the same value</span></CodeLine>
<Link id="l00823" /><CodeLine lineNumber="823"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// again, we can recover the location.</span></CodeLine>
<Link id="l00824" /><CodeLine lineNumber="824"><span class="doxyHighlight">    std::optional&lt;LocIdx&gt; NewLoc;</span></CodeLine>
<Link id="l00825" /><CodeLine lineNumber="825"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/loc">Loc</a> : <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;locations())</span></CodeLine>
<Link id="l00826" /><CodeLine lineNumber="826"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/loc">Loc</a>.Value == OldValue)</span></CodeLine>
<Link id="l00827" /><CodeLine lineNumber="827"><span class="doxyHighlight">        NewLoc = <a href="/docs/api/namespaces/llvm/loc">Loc</a>.Idx;</span></CodeLine>
<Link id="l00828" /><CodeLine lineNumber="828"></CodeLine>
<Link id="l00829" /><CodeLine lineNumber="829"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If there is no location, and we weren&#39;t asked to make the variable</span></CodeLine>
<Link id="l00830" /><CodeLine lineNumber="830"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// explicitly undef, then stop here.</span></CodeLine>
<Link id="l00831" /><CodeLine lineNumber="831"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewLoc &amp;&amp; !MakeUndef) &#123;</span></CodeLine>
<Link id="l00832" /><CodeLine lineNumber="832"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Try and recover a few more locations with entry values.</span></CodeLine>
<Link id="l00833" /><CodeLine lineNumber="833"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a> : ActiveMLocIt-&gt;second) &#123;</span></CodeLine>
<Link id="l00834" /><CodeLine lineNumber="834"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Prop = <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.find(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>)-&gt;second.Properties;</span></CodeLine>
<Link id="l00835" /><CodeLine lineNumber="835"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#ac441348b2e73e12e1d8657de17b76568">recoverAsEntryValue</a>(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, Prop, OldValue);</span></CodeLine>
<Link id="l00836" /><CodeLine lineNumber="836"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00837" /><CodeLine lineNumber="837"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#acf872fb0e884bca493cc867aac36ed79">flushDbgValues</a>(Pos, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00838" /><CodeLine lineNumber="838"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00839" /><CodeLine lineNumber="839"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00840" /><CodeLine lineNumber="840"></CodeLine>
<Link id="l00841" /><CodeLine lineNumber="841"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Examine all the variables based on this location.</span></CodeLine>
<Link id="l00842" /><CodeLine lineNumber="842"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/denseset">DenseSet&lt;DebugVariableID&gt;</a> NewMLocs;</span></CodeLine>
<Link id="l00843" /><CodeLine lineNumber="843"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If no new location has been found, every variable that depends on this</span></CodeLine>
<Link id="l00844" /><CodeLine lineNumber="844"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// MLoc is dead, so end their existing MLoc-&gt;Var mappings as well.</span></CodeLine>
<Link id="l00845" /><CodeLine lineNumber="845"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;LocIdx, DebugVariableID&gt;</a>&gt; LostMLocs;</span></CodeLine>
<Link id="l00846" /><CodeLine lineNumber="846"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a> : ActiveMLocIt-&gt;second) &#123;</span></CodeLine>
<Link id="l00847" /><CodeLine lineNumber="847"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ActiveVLocIt = <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.find(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00848" /><CodeLine lineNumber="848"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Re-state the variable location: if there&#39;s no replacement then NewLoc</span></CodeLine>
<Link id="l00849" /><CodeLine lineNumber="849"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// is std::nullopt and a $noreg DBG&#95;VALUE will be created. Otherwise, a</span></CodeLine>
<Link id="l00850" /><CodeLine lineNumber="850"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// DBG&#95;VALUE identifying the alternative location will be emitted.</span></CodeLine>
<Link id="l00851" /><CodeLine lineNumber="851"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> &amp;Properties = ActiveVLocIt-&gt;second.Properties;</span></CodeLine>
<Link id="l00852" /><CodeLine lineNumber="852"></CodeLine>
<Link id="l00853" /><CodeLine lineNumber="853"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Produce the new list of debug ops - an empty list if no new location</span></CodeLine>
<Link id="l00854" /><CodeLine lineNumber="854"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// was found, or the existing list with the substitution MLoc -&gt; NewLoc</span></CodeLine>
<Link id="l00855" /><CodeLine lineNumber="855"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// otherwise.</span></CodeLine>
<Link id="l00856" /><CodeLine lineNumber="856"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;ResolvedDbgOp&gt;</a> DbgOps;</span></CodeLine>
<Link id="l00857" /><CodeLine lineNumber="857"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewLoc) &#123;</span></CodeLine>
<Link id="l00858" /><CodeLine lineNumber="858"><span class="doxyHighlight">        <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> OldOp(MLoc);</span></CodeLine>
<Link id="l00859" /><CodeLine lineNumber="859"><span class="doxyHighlight">        <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> NewOp(&#42;NewLoc);</span></CodeLine>
<Link id="l00860" /><CodeLine lineNumber="860"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Insert illegal ops to overwrite afterwards.</span></CodeLine>
<Link id="l00861" /><CodeLine lineNumber="861"><span class="doxyHighlight">        DbgOps.<a href="/docs/api/classes/llvm/smallvectorimpl/#a94d23373106467003722f7d6c17b1528">insert</a>(DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), ActiveVLocIt-&gt;second.Ops.size(),</span></CodeLine>
<Link id="l00862" /><CodeLine lineNumber="862"><span class="doxyHighlight">                      <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a>(<a href="/docs/api/classes/livedebugvalues/locidx/#a8567f7c20eae6b2f5beabaa440df1097">LocIdx::MakeIllegalLoc</a>()));</span></CodeLine>
<Link id="l00863" /><CodeLine lineNumber="863"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#ac1c97b8c8035fa91c5275ffb54d41634">replace&#95;copy</a>(ActiveVLocIt-&gt;second.Ops, DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), OldOp, NewOp);</span></CodeLine>
<Link id="l00864" /><CodeLine lineNumber="864"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00865" /><CodeLine lineNumber="865"></CodeLine>
<Link id="l00866" /><CodeLine lineNumber="866"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;&#91;Var, DILoc&#93; = <a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>.lookupDVID(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00867" /><CodeLine lineNumber="867"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>.push&#95;back(std::make&#95;pair(</span></CodeLine>
<Link id="l00868" /><CodeLine lineNumber="868"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, &amp;&#42;<a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;emitLoc(DbgOps, Var, DILoc, Properties)));</span></CodeLine>
<Link id="l00869" /><CodeLine lineNumber="869"></CodeLine>
<Link id="l00870" /><CodeLine lineNumber="870"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Update machine locations &lt;=&gt; variable locations maps. Defer updating</span></CodeLine>
<Link id="l00871" /><CodeLine lineNumber="871"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// ActiveMLocs to avoid invalidating the ActiveMLocIt iterator.</span></CodeLine>
<Link id="l00872" /><CodeLine lineNumber="872"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewLoc) &#123;</span></CodeLine>
<Link id="l00873" /><CodeLine lineNumber="873"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> <a href="/docs/api/namespaces/llvm/loc">Loc</a> : ActiveVLocIt-&gt;second.loc&#95;indices()) &#123;</span></CodeLine>
<Link id="l00874" /><CodeLine lineNumber="874"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/loc">Loc</a> != MLoc)</span></CodeLine>
<Link id="l00875" /><CodeLine lineNumber="875"><span class="doxyHighlight">            LostMLocs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a396fcfee6914c76974b73c3d203da6a5">emplace&#95;back</a>(<a href="/docs/api/namespaces/llvm/loc">Loc</a>, <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00876" /><CodeLine lineNumber="876"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l00877" /><CodeLine lineNumber="877"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.erase(ActiveVLocIt);</span></CodeLine>
<Link id="l00878" /><CodeLine lineNumber="878"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00879" /><CodeLine lineNumber="879"><span class="doxyHighlight">        ActiveVLocIt-&gt;second.Ops = DbgOps;</span></CodeLine>
<Link id="l00880" /><CodeLine lineNumber="880"><span class="doxyHighlight">        NewMLocs.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00881" /><CodeLine lineNumber="881"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l00882" /><CodeLine lineNumber="882"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00883" /><CodeLine lineNumber="883"></CodeLine>
<Link id="l00884" /><CodeLine lineNumber="884"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Remove variables from ActiveMLocs if they no longer use any other MLocs</span></CodeLine>
<Link id="l00885" /><CodeLine lineNumber="885"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// due to being killed by this clobber.</span></CodeLine>
<Link id="l00886" /><CodeLine lineNumber="886"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;LocVarIt : LostMLocs) &#123;</span></CodeLine>
<Link id="l00887" /><CodeLine lineNumber="887"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LostMLocIt = <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>.find(LocVarIt.first);</span></CodeLine>
<Link id="l00888" /><CodeLine lineNumber="888"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LostMLocIt != <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>.end() &amp;&amp;</span></CodeLine>
<Link id="l00889" /><CodeLine lineNumber="889"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Variable was using this MLoc, but ActiveMLocs&#91;MLoc&#93; has no &quot;</span></CodeLine>
<Link id="l00890" /><CodeLine lineNumber="890"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;entries?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00891" /><CodeLine lineNumber="891"><span class="doxyHighlight">      LostMLocIt-&gt;second.erase(LocVarIt.second);</span></CodeLine>
<Link id="l00892" /><CodeLine lineNumber="892"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00893" /><CodeLine lineNumber="893"></CodeLine>
<Link id="l00894" /><CodeLine lineNumber="894"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We lazily track what locations have which values; if we&#39;ve found a new</span></CodeLine>
<Link id="l00895" /><CodeLine lineNumber="895"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// location for the clobbered value, remember it.</span></CodeLine>
<Link id="l00896" /><CodeLine lineNumber="896"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewLoc)</span></CodeLine>
<Link id="l00897" /><CodeLine lineNumber="897"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;NewLoc-&gt;asU64()&#93; = OldValue;</span></CodeLine>
<Link id="l00898" /><CodeLine lineNumber="898"></CodeLine>
<Link id="l00899" /><CodeLine lineNumber="899"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#acf872fb0e884bca493cc867aac36ed79">flushDbgValues</a>(Pos, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00900" /><CodeLine lineNumber="900"></CodeLine>
<Link id="l00901" /><CodeLine lineNumber="901"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Commit ActiveMLoc changes.</span></CodeLine>
<Link id="l00902" /><CodeLine lineNumber="902"><span class="doxyHighlight">    ActiveMLocIt-&gt;second.clear();</span></CodeLine>
<Link id="l00903" /><CodeLine lineNumber="903"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewMLocs.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a9a3c9d867ff6bde97841c2b7983f5c70">empty</a>())</span></CodeLine>
<Link id="l00904" /><CodeLine lineNumber="904"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a> : NewMLocs)</span></CodeLine>
<Link id="l00905" /><CodeLine lineNumber="905"><span class="doxyHighlight">        <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;&#42;NewLoc&#93;.insert(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00906" /><CodeLine lineNumber="906"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00907" /><CodeLine lineNumber="907"></CodeLine>
<Link id="l00908" /><CodeLine lineNumber="908"><span class="doxyHighlightComment">  /// Transfer variables based on \\p Src to be based on \\p Dst. This handles</span></CodeLine>
<Link id="l00909" /><CodeLine lineNumber="909"><span class="doxyHighlightComment">  /// both register copies as well as spills and restores. Creates DBG&#95;VALUEs</span></CodeLine>
<Link id="l00910" /><CodeLine lineNumber="910"><span class="doxyHighlightComment">  /// describing the movement.</span></CodeLine>
<Link id="l00911" /><CodeLine lineNumber="911" lineLink="/docs/api/classes/transfertracker/#a787205c8858064b56bad25b823faf3d0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/transfertracker/#a787205c8858064b56bad25b823faf3d0">transferMlocs</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> Src, <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> Dst, <a href="/docs/api/classes/llvm/machinebasicblock/#ae34c996b58df9b9ce6695a0c8b70c533">MachineBasicBlock::iterator</a> Pos) &#123;</span></CodeLine>
<Link id="l00912" /><CodeLine lineNumber="912"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Does Src still contain the value num we expect? If not, it&#39;s been</span></CodeLine>
<Link id="l00913" /><CodeLine lineNumber="913"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// clobbered in the meantime, and our variable locations are stale.</span></CodeLine>
<Link id="l00914" /><CodeLine lineNumber="914"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;Src.asU64()&#93; != <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;readMLoc(Src))</span></CodeLine>
<Link id="l00915" /><CodeLine lineNumber="915"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00916" /><CodeLine lineNumber="916"></CodeLine>
<Link id="l00917" /><CodeLine lineNumber="917"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// assert(ActiveMLocs&#91;Dst&#93;.size() == 0);</span></CodeLine>
<Link id="l00918" /><CodeLine lineNumber="918"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//^^^ Legitimate scenario on account of un-clobbered slot being assigned to?</span></CodeLine>
<Link id="l00919" /><CodeLine lineNumber="919"></CodeLine>
<Link id="l00920" /><CodeLine lineNumber="920"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Move set of active variables from one location to another.</span></CodeLine>
<Link id="l00921" /><CodeLine lineNumber="921"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> MovingVars = <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;Src&#93;;</span></CodeLine>
<Link id="l00922" /><CodeLine lineNumber="922"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;Dst&#93;.insert(MovingVars.begin(), MovingVars.end());</span></CodeLine>
<Link id="l00923" /><CodeLine lineNumber="923"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;Dst.asU64()&#93; = <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;Src.asU64()&#93;;</span></CodeLine>
<Link id="l00924" /><CodeLine lineNumber="924"></CodeLine>
<Link id="l00925" /><CodeLine lineNumber="925"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// For each variable based on Src; create a location at Dst.</span></CodeLine>
<Link id="l00926" /><CodeLine lineNumber="926"><span class="doxyHighlight">    <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> <a href="/docs/api/classes/llvm/srcop">SrcOp</a>(Src);</span></CodeLine>
<Link id="l00927" /><CodeLine lineNumber="927"><span class="doxyHighlight">    <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> <a href="/docs/api/classes/llvm/dstop">DstOp</a>(Dst);</span></CodeLine>
<Link id="l00928" /><CodeLine lineNumber="928"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a> : MovingVars) &#123;</span></CodeLine>
<Link id="l00929" /><CodeLine lineNumber="929"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ActiveVLocIt = <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.find(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00930" /><CodeLine lineNumber="930"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ActiveVLocIt != <a href="/docs/api/classes/transfertracker/#ae0a495620f7b1dd27811000f102d1d40">ActiveVLocs</a>.end());</span></CodeLine>
<Link id="l00931" /><CodeLine lineNumber="931"></CodeLine>
<Link id="l00932" /><CodeLine lineNumber="932"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Update all instances of Src in the variable&#39;s tracked values to Dst.</span></CodeLine>
<Link id="l00933" /><CodeLine lineNumber="933"><span class="doxyHighlight">      std::replace(ActiveVLocIt-&gt;second.Ops.begin(),</span></CodeLine>
<Link id="l00934" /><CodeLine lineNumber="934"><span class="doxyHighlight">                   ActiveVLocIt-&gt;second.Ops.end(), <a href="/docs/api/classes/llvm/srcop">SrcOp</a>, <a href="/docs/api/classes/llvm/dstop">DstOp</a>);</span></CodeLine>
<Link id="l00935" /><CodeLine lineNumber="935"></CodeLine>
<Link id="l00936" /><CodeLine lineNumber="936"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;&#91;Var, DILoc&#93; = <a href="/docs/api/classes/transfertracker/#a0a05f0bb5e94aa2300445044a7a1da02">DVMap</a>.lookupDVID(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l00937" /><CodeLine lineNumber="937"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> = <a href="/docs/api/classes/transfertracker/#a5ccc49e3b9263bbfcdeb391f17b84c2d">MTracker</a>-&gt;emitLoc(ActiveVLocIt-&gt;second.Ops, Var, DILoc,</span></CodeLine>
<Link id="l00938" /><CodeLine lineNumber="938"><span class="doxyHighlight">                                           ActiveVLocIt-&gt;second.Properties);</span></CodeLine>
<Link id="l00939" /><CodeLine lineNumber="939"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#a7ee7f28da62a849df2fdb7a96be072d1">PendingDbgValues</a>.push&#95;back(std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>));</span></CodeLine>
<Link id="l00940" /><CodeLine lineNumber="940"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l00941" /><CodeLine lineNumber="941"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#aacea713c5575395a3ce28a43c31f1df6">ActiveMLocs</a>&#91;Src&#93;.clear();</span></CodeLine>
<Link id="l00942" /><CodeLine lineNumber="942"><span class="doxyHighlight">    <a href="/docs/api/classes/transfertracker/#acf872fb0e884bca493cc867aac36ed79">flushDbgValues</a>(Pos, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l00943" /><CodeLine lineNumber="943"></CodeLine>
<Link id="l00944" /><CodeLine lineNumber="944"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// XXX XXX XXX &quot;pretend to be old LDV&quot; means dropping all tracking data</span></CodeLine>
<Link id="l00945" /><CodeLine lineNumber="945"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// about the old location.</span></CodeLine>
<Link id="l00946" /><CodeLine lineNumber="946"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#afba85f0d2bfd9c12500fa7c93a6e3f91">EmulateOldLDV</a>)</span></CodeLine>
<Link id="l00947" /><CodeLine lineNumber="947"><span class="doxyHighlight">      <a href="/docs/api/classes/transfertracker/#a498b0782412a1488e7cb5c22a635188d">VarLocs</a>&#91;Src.asU64()&#93; = <a href="/docs/api/classes/livedebugvalues/valueidnum/#a98d44bec6b754ac8786ab97f219f06f1">ValueIDNum::EmptyValue</a>;</span></CodeLine>
<Link id="l00948" /><CodeLine lineNumber="948"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00949" /><CodeLine lineNumber="949"></CodeLine>
<Link id="l00950" /><CodeLine lineNumber="950" lineLink="/docs/api/classes/transfertracker/#ab17b4ddf05538aab17dbb53a0f5f4329"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machineinstrbuilder">MachineInstrBuilder</a> <a href="/docs/api/classes/transfertracker/#ab17b4ddf05538aab17dbb53a0f5f4329">emitMOLoc</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO,</span></CodeLine>
<Link id="l00951" /><CodeLine lineNumber="951"><span class="doxyHighlight">                                </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/debugvariable">DebugVariable</a> &amp;Var,</span></CodeLine>
<Link id="l00952" /><CodeLine lineNumber="952"><span class="doxyHighlight">                                </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> &amp;Properties) &#123;</span></CodeLine>
<Link id="l00953" /><CodeLine lineNumber="953"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DILocation::get</a>(Var.<a href="/docs/api/classes/llvm/debugvariable/#af2ca096ab72c055f6c2c7e3ffbe5d6bf">getVariable</a>()-&gt;<a href="/docs/api/classes/llvm/mdnode/#ad2fecba192de6da1578bdcb78d524169">getContext</a>(), 0, 0,</span></CodeLine>
<Link id="l00954" /><CodeLine lineNumber="954"><span class="doxyHighlight">                                  Var.<a href="/docs/api/classes/llvm/debugvariable/#af2ca096ab72c055f6c2c7e3ffbe5d6bf">getVariable</a>()-&gt;<a href="/docs/api/classes/llvm/dilocalvariable/#a38229438b1c22802074b3181b0b80b85">getScope</a>(),</span></CodeLine>
<Link id="l00955" /><CodeLine lineNumber="955"><span class="doxyHighlight">                                  </span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/dilocation">DILocation</a> &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(Var.<a href="/docs/api/classes/llvm/debugvariable/#a58e53986006a2e7d95385fe4e633fb2e">getInlinedAt</a>()));</span></CodeLine>
<Link id="l00956" /><CodeLine lineNumber="956"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> MIB = <a href="/docs/api/namespaces/llvm/#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a href="/docs/api/classes/transfertracker/#a79f160cf45e05ebc07c2751e0bd4d944">MF</a>, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/classes/transfertracker/#aa1cef6664a3e135245b35927b6db11e5">TII</a>-&gt;get(TargetOpcode::DBG&#95;VALUE));</span></CodeLine>
<Link id="l00957" /><CodeLine lineNumber="957"><span class="doxyHighlight">    MIB.add(MO);</span></CodeLine>
<Link id="l00958" /><CodeLine lineNumber="958"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a7f88fbb422e5e0d5c0e227b3df0bd8a8">Indirect</a>)</span></CodeLine>
<Link id="l00959" /><CodeLine lineNumber="959"><span class="doxyHighlight">      MIB.addImm(0);</span></CodeLine>
<Link id="l00960" /><CodeLine lineNumber="960"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l00961" /><CodeLine lineNumber="961"><span class="doxyHighlight">      MIB.addReg(0);</span></CodeLine>
<Link id="l00962" /><CodeLine lineNumber="962"><span class="doxyHighlight">    MIB.addMetadata(Var.<a href="/docs/api/classes/llvm/debugvariable/#af2ca096ab72c055f6c2c7e3ffbe5d6bf">getVariable</a>());</span></CodeLine>
<Link id="l00963" /><CodeLine lineNumber="963"><span class="doxyHighlight">    MIB.addMetadata(Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a87d598e34086fb45a3a64638bdc6097e">DIExpr</a>);</span></CodeLine>
<Link id="l00964" /><CodeLine lineNumber="964"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> MIB;</span></CodeLine>
<Link id="l00965" /><CodeLine lineNumber="965"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00966" /><CodeLine lineNumber="966"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l00967" /><CodeLine lineNumber="967"></CodeLine>
<Link id="l00968" /><CodeLine lineNumber="968"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00969" /><CodeLine lineNumber="969"><span class="doxyHighlightComment">//            Implementation</span></CodeLine>
<Link id="l00970" /><CodeLine lineNumber="970"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l00971" /><CodeLine lineNumber="971"></CodeLine>
<Link id="l00972" /><CodeLine lineNumber="972"><span class="doxyHighlight"><a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> <a href="/docs/api/classes/livedebugvalues/valueidnum/#a98d44bec6b754ac8786ab97f219f06f1">ValueIDNum::EmptyValue</a> = &#123;UINT&#95;MAX, UINT&#95;MAX, UINT&#95;MAX&#125;;</span></CodeLine>
<Link id="l00973" /><CodeLine lineNumber="973"><span class="doxyHighlight"><a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> <a href="/docs/api/classes/livedebugvalues/valueidnum/#ac7728f00d503fabc8c1034d102af140e">ValueIDNum::TombstoneValue</a> = &#123;UINT&#95;MAX, UINT&#95;MAX, UINT&#95;MAX - 1&#125;;</span></CodeLine>
<Link id="l00974" /><CodeLine lineNumber="974"></CodeLine>
<Link id="l00975" /><CodeLine lineNumber="975"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l00976" /><CodeLine lineNumber="976" lineLink="/docs/api/structs/livedebugvalues/resolveddbgop/#ae0c00dfb25229694b92d71199bfaca22"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/resolveddbgop/#ae0c00dfb25229694b92d71199bfaca22">ResolvedDbgOp::dump</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker">MLocTracker</a> &#42;MTrack)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00977" /><CodeLine lineNumber="977"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/livedebugvalues/resolveddbgop/#a7eb56f89bef382b170cdc8f16022f0c1">IsConst</a>) &#123;</span></CodeLine>
<Link id="l00978" /><CodeLine lineNumber="978"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a href="/docs/api/structs/livedebugvalues/resolveddbgop/#a3ae6254930be379b5b2a92b5a5d311cc">MO</a>;</span></CodeLine>
<Link id="l00979" /><CodeLine lineNumber="979"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00980" /><CodeLine lineNumber="980"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; MTrack-&gt;<a href="/docs/api/classes/livedebugvalues/mloctracker/#afe9d19d27dd82ae73f86937cb41c3d8b">LocIdxToName</a>(<a href="/docs/api/structs/livedebugvalues/resolveddbgop/#a050e8d65a2c929b355298de9980ca144">Loc</a>);</span></CodeLine>
<Link id="l00981" /><CodeLine lineNumber="981"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00982" /><CodeLine lineNumber="982"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00983" /><CodeLine lineNumber="983" lineLink="/docs/api/structs/livedebugvalues/dbgop/#a645a31ec228d2d3f5ec064b726514cd2"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/dbgop/#a645a31ec228d2d3f5ec064b726514cd2">DbgOp::dump</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker">MLocTracker</a> &#42;MTrack)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00984" /><CodeLine lineNumber="984"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/structs/livedebugvalues/dbgop/#aa155f40c0f7c56ae215ee41a52d5f9ad">IsConst</a>) &#123;</span></CodeLine>
<Link id="l00985" /><CodeLine lineNumber="985"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a href="/docs/api/structs/livedebugvalues/dbgop/#aad8daff935ad1c509d14a73342911354">MO</a>;</span></CodeLine>
<Link id="l00986" /><CodeLine lineNumber="986"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/livedebugvalues/dbgop/#a4e137fe2e3773e0a6f40980d2e99083d">isUndef</a>()) &#123;</span></CodeLine>
<Link id="l00987" /><CodeLine lineNumber="987"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; MTrack-&gt;<a href="/docs/api/classes/livedebugvalues/mloctracker/#a70d5f445ba9f76ce9d0a11bc11e8e1a9">IDAsString</a>(<a href="/docs/api/structs/livedebugvalues/dbgop/#a17b174ad71c91584d987861d5e8e5d2d">ID</a>);</span></CodeLine>
<Link id="l00988" /><CodeLine lineNumber="988"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00989" /><CodeLine lineNumber="989"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00990" /><CodeLine lineNumber="990" lineLink="/docs/api/structs/livedebugvalues/dbgopid/#a743561a2288ede30c2992d98e1866505"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/dbgopid/#a743561a2288ede30c2992d98e1866505">DbgOpID::dump</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker">MLocTracker</a> &#42;MTrack, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgopidmap">DbgOpIDMap</a> &#42;OpStore)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00991" /><CodeLine lineNumber="991"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!OpStore) &#123;</span></CodeLine>
<Link id="l00992" /><CodeLine lineNumber="992"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;ID(&quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/structs/livedebugvalues/dbgopid/#a0e6661b8b23bbe5d428f8177ae17656b">asU32</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;)&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l00993" /><CodeLine lineNumber="993"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l00994" /><CodeLine lineNumber="994"><span class="doxyHighlight">    OpStore-&gt;<a href="/docs/api/classes/livedebugvalues/dbgopidmap/#a0ff8cac5d6ff149c80d136de06314455">find</a>(&#42;this).<a href="/docs/api/structs/livedebugvalues/dbgop/#a645a31ec228d2d3f5ec064b726514cd2">dump</a>(MTrack);</span></CodeLine>
<Link id="l00995" /><CodeLine lineNumber="995"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l00996" /><CodeLine lineNumber="996"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l00997" /><CodeLine lineNumber="997" lineLink="/docs/api/classes/livedebugvalues/dbgvalue/#a9959e337a4d3e325e795686118700112"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgvalue/#a9959e337a4d3e325e795686118700112">DbgValue::dump</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker">MLocTracker</a> &#42;MTrack,</span></CodeLine>
<Link id="l00998" /><CodeLine lineNumber="998"><span class="doxyHighlight">                    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgopidmap">DbgOpIDMap</a> &#42;OpStore)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l00999" /><CodeLine lineNumber="999"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bbaf26793ed3fb3ea880eb66562c90d1826">NoVal</a>) &#123;</span></CodeLine>
<Link id="l01000" /><CodeLine lineNumber="1000"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;NoVal(&quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/classes/livedebugvalues/dbgvalue/#a0867a91c94f59efa8118215449f8b1d6">BlockNo</a> &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;)&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01001" /><CodeLine lineNumber="1001"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">VPHI</a> || <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba953f120c5617d3f2b42df3fd424222ad">Def</a>) &#123;</span></CodeLine>
<Link id="l01002" /><CodeLine lineNumber="1002"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">VPHI</a>)</span></CodeLine>
<Link id="l01003" /><CodeLine lineNumber="1003"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;VPHI(&quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/classes/livedebugvalues/dbgvalue/#a0867a91c94f59efa8118215449f8b1d6">BlockNo</a> &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;,&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01004" /><CodeLine lineNumber="1004"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l01005" /><CodeLine lineNumber="1005"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Def(&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01006" /><CodeLine lineNumber="1006"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Idx = 0; Idx &lt; <a href="/docs/api/classes/livedebugvalues/dbgvalue/#a12c429bd06d73df15134959325cd6022">getDbgOpIDs</a>().size(); ++Idx) &#123;</span></CodeLine>
<Link id="l01007" /><CodeLine lineNumber="1007"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/dbgvalue/#aa70e8b6292c37300a3ea50fce69b2cdd">getDbgOpID</a>(Idx).<a href="/docs/api/structs/livedebugvalues/dbgopid/#a743561a2288ede30c2992d98e1866505">dump</a>(MTrack, OpStore);</span></CodeLine>
<Link id="l01008" /><CodeLine lineNumber="1008"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Idx != 0)</span></CodeLine>
<Link id="l01009" /><CodeLine lineNumber="1009"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;,&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01010" /><CodeLine lineNumber="1010"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01011" /><CodeLine lineNumber="1011"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;)&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01012" /><CodeLine lineNumber="1012"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01013" /><CodeLine lineNumber="1013"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a127bb33bfa67d26975c12bf33568af48">Properties</a>.Indirect)</span></CodeLine>
<Link id="l01014" /><CodeLine lineNumber="1014"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; indir&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01015" /><CodeLine lineNumber="1015"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a127bb33bfa67d26975c12bf33568af48">Properties</a>.DIExpr)</span></CodeLine>
<Link id="l01016" /><CodeLine lineNumber="1016"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; &quot;</span><span class="doxyHighlight"> &lt;&lt; &#42;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a127bb33bfa67d26975c12bf33568af48">Properties</a>.DIExpr;</span></CodeLine>
<Link id="l01017" /><CodeLine lineNumber="1017"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01018" /><CodeLine lineNumber="1018"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01019" /><CodeLine lineNumber="1019"></CodeLine>
<Link id="l01020" /><CodeLine lineNumber="1020" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#ae118b50388837cac4d807896b91f111e"><span class="doxyHighlight"><a href="/docs/api/classes/livedebugvalues/mloctracker/#ae118b50388837cac4d807896b91f111e">MLocTracker::MLocTracker</a>(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;<a href="/docs/api/classes/livedebugvalues/mloctracker/#ae1a29742ce2fd47f4b4769dfe5a44f9e">MF</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetinstrinfo">TargetInstrInfo</a> &amp;<a href="/docs/api/classes/livedebugvalues/mloctracker/#a7bcfe28f8a994ea7a5fff050f1c09fd2">TII</a>,</span></CodeLine>
<Link id="l01021" /><CodeLine lineNumber="1021"><span class="doxyHighlight">                         </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterinfo">TargetRegisterInfo</a> &amp;<a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>,</span></CodeLine>
<Link id="l01022" /><CodeLine lineNumber="1022"><span class="doxyHighlight">                         </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetlowering">TargetLowering</a> &amp;<a href="/docs/api/classes/livedebugvalues/mloctracker/#a2ceb7dab8f0063eec8dff6df6d2a3eda">TLI</a>)</span></CodeLine>
<Link id="l01023" /><CodeLine lineNumber="1023"><span class="doxyHighlight">    : <a href="/docs/api/classes/livedebugvalues/mloctracker/#ae1a29742ce2fd47f4b4769dfe5a44f9e">MF</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#ae1a29742ce2fd47f4b4769dfe5a44f9e">MF</a>), <a href="/docs/api/classes/livedebugvalues/mloctracker/#a7bcfe28f8a994ea7a5fff050f1c09fd2">TII</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#a7bcfe28f8a994ea7a5fff050f1c09fd2">TII</a>), <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>), <a href="/docs/api/classes/livedebugvalues/mloctracker/#a2ceb7dab8f0063eec8dff6df6d2a3eda">TLI</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#a2ceb7dab8f0063eec8dff6df6d2a3eda">TLI</a>),</span></CodeLine>
<Link id="l01024" /><CodeLine lineNumber="1024"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#a91fd5d450920e56cbde71ab8708fbab9">LocIdxToIDNum</a>(<a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a>::EmptyValue), <a href="/docs/api/classes/livedebugvalues/mloctracker/#a12a921bb359eb2ab39e43e4c4ba780f3">LocIdxToLocID</a>(0) &#123;</span></CodeLine>
<Link id="l01025" /><CodeLine lineNumber="1025"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3d106e52bda90530904b18edf24f2286">NumRegs</a> = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>.getNumRegs();</span></CodeLine>
<Link id="l01026" /><CodeLine lineNumber="1026"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a66a31574ce11e5d8dc78ed9a845305c2">reset</a>();</span></CodeLine>
<Link id="l01027" /><CodeLine lineNumber="1027"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a9b700e192036873e9756f231c9213a34">LocIDToLocIdx</a>.resize(<a href="/docs/api/classes/livedebugvalues/mloctracker/#a3d106e52bda90530904b18edf24f2286">NumRegs</a>, <a href="/docs/api/classes/livedebugvalues/locidx/#a8567f7c20eae6b2f5beabaa440df1097">LocIdx::MakeIllegalLoc</a>());</span></CodeLine>
<Link id="l01028" /><CodeLine lineNumber="1028"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#a3d106e52bda90530904b18edf24f2286">NumRegs</a> &lt; (1u &lt;&lt; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/instrrefbasedimpl-h/#a09551aadf1cfb2c7160bcd6314b9f748">NUM&#95;LOC&#95;BITS</a>)); </span><span class="doxyHighlightComment">// Detect bit packing failure</span></CodeLine>
<Link id="l01029" /><CodeLine lineNumber="1029"></CodeLine>
<Link id="l01030" /><CodeLine lineNumber="1030"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Always track SP. This avoids the implicit clobbering caused by regmasks</span></CodeLine>
<Link id="l01031" /><CodeLine lineNumber="1031"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// from affectings its values. (LiveDebugValues disbelieves calls and</span></CodeLine>
<Link id="l01032" /><CodeLine lineNumber="1032"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// regmasks that claim to clobber SP).</span></CodeLine>
<Link id="l01033" /><CodeLine lineNumber="1033"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> SP = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a2ceb7dab8f0063eec8dff6df6d2a3eda">TLI</a>.getStackPointerRegisterToSaveRestore();</span></CodeLine>
<Link id="l01034" /><CodeLine lineNumber="1034"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SP) &#123;</span></CodeLine>
<Link id="l01035" /><CodeLine lineNumber="1035"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a2a28f143303b39650c069b1ce0925287">getLocID</a>(SP);</span></CodeLine>
<Link id="l01036" /><CodeLine lineNumber="1036"><span class="doxyHighlight">    (void)<a href="/docs/api/classes/livedebugvalues/mloctracker/#a5c7000ce75181a4ad413b79566e11eea">lookupOrTrackRegister</a>(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>);</span></CodeLine>
<Link id="l01037" /><CodeLine lineNumber="1037"></CodeLine>
<Link id="l01038" /><CodeLine lineNumber="1038"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/mcregaliasiterator">MCRegAliasIterator</a> RAI(SP, &amp;<a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.<a href="/docs/api/classes/llvm/mcregaliasiterator/#ac336c049c12ead7be5b86e6d046f8ab0">isValid</a>(); ++RAI)</span></CodeLine>
<Link id="l01039" /><CodeLine lineNumber="1039"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#a2773f3976918a270bac316739f66ffd5">SPAliases</a>.insert(&#42;RAI);</span></CodeLine>
<Link id="l01040" /><CodeLine lineNumber="1040"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01041" /><CodeLine lineNumber="1041"></CodeLine>
<Link id="l01042" /><CodeLine lineNumber="1042"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Build some common stack positions -- full registers being spilt to the</span></CodeLine>
<Link id="l01043" /><CodeLine lineNumber="1043"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// stack.</span></CodeLine>
<Link id="l01044" /><CodeLine lineNumber="1044"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;8, 0&#125;, 0&#125;);</span></CodeLine>
<Link id="l01045" /><CodeLine lineNumber="1045"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;16, 0&#125;, 1&#125;);</span></CodeLine>
<Link id="l01046" /><CodeLine lineNumber="1046"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;32, 0&#125;, 2&#125;);</span></CodeLine>
<Link id="l01047" /><CodeLine lineNumber="1047"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;64, 0&#125;, 3&#125;);</span></CodeLine>
<Link id="l01048" /><CodeLine lineNumber="1048"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;128, 0&#125;, 4&#125;);</span></CodeLine>
<Link id="l01049" /><CodeLine lineNumber="1049"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;256, 0&#125;, 5&#125;);</span></CodeLine>
<Link id="l01050" /><CodeLine lineNumber="1050"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;512, 0&#125;, 6&#125;);</span></CodeLine>
<Link id="l01051" /><CodeLine lineNumber="1051"></CodeLine>
<Link id="l01052" /><CodeLine lineNumber="1052"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Traverse all the subregister idxes, and ensure there&#39;s an index for them.</span></CodeLine>
<Link id="l01053" /><CodeLine lineNumber="1053"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Duplicates are no problem: we&#39;re interested in their position in the</span></CodeLine>
<Link id="l01054" /><CodeLine lineNumber="1054"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// stack slot, we don&#39;t want to type the slot.</span></CodeLine>
<Link id="l01055" /><CodeLine lineNumber="1055"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>.getNumSubRegIndices(); ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l01056" /><CodeLine lineNumber="1056"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>.getSubRegIdxSize(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l01057" /><CodeLine lineNumber="1057"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Offs = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>.getSubRegIdxOffset(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l01058" /><CodeLine lineNumber="1058"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Idx = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.size();</span></CodeLine>
<Link id="l01059" /><CodeLine lineNumber="1059"></CodeLine>
<Link id="l01060" /><CodeLine lineNumber="1060"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Some subregs have -1, -2 and so forth fed into their fields, to mean</span></CodeLine>
<Link id="l01061" /><CodeLine lineNumber="1061"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// special backend things. Ignore those.</span></CodeLine>
<Link id="l01062" /><CodeLine lineNumber="1062"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &gt; 60000 || Offs &gt; 60000)</span></CodeLine>
<Link id="l01063" /><CodeLine lineNumber="1063"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01064" /><CodeLine lineNumber="1064"></CodeLine>
<Link id="l01065" /><CodeLine lineNumber="1065"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, Offs&#125;, Idx&#125;);</span></CodeLine>
<Link id="l01066" /><CodeLine lineNumber="1066"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01067" /><CodeLine lineNumber="1067"></CodeLine>
<Link id="l01068" /><CodeLine lineNumber="1068"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// There may also be strange register class sizes (think x86 fp80s).</span></CodeLine>
<Link id="l01069" /><CodeLine lineNumber="1069"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetregisterclass">TargetRegisterClass</a> &#42;RC : <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>.regclasses()) &#123;</span></CodeLine>
<Link id="l01070" /><CodeLine lineNumber="1070"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>.getRegSizeInBits(&#42;RC);</span></CodeLine>
<Link id="l01071" /><CodeLine lineNumber="1071"></CodeLine>
<Link id="l01072" /><CodeLine lineNumber="1072"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We might see special reserved values as sizes, and classes for other</span></CodeLine>
<Link id="l01073" /><CodeLine lineNumber="1073"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// stuff the machine tries to model. If it&#39;s more than 512 bits, then it</span></CodeLine>
<Link id="l01074" /><CodeLine lineNumber="1074"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// is very unlikely to be a register than can be spilt.</span></CodeLine>
<Link id="l01075" /><CodeLine lineNumber="1075"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &gt; 512)</span></CodeLine>
<Link id="l01076" /><CodeLine lineNumber="1076"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01077" /><CodeLine lineNumber="1077"></CodeLine>
<Link id="l01078" /><CodeLine lineNumber="1078"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Idx = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.size();</span></CodeLine>
<Link id="l01079" /><CodeLine lineNumber="1079"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.insert(&#123;&#123;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, 0&#125;, Idx&#125;);</span></CodeLine>
<Link id="l01080" /><CodeLine lineNumber="1080"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01081" /><CodeLine lineNumber="1081"></CodeLine>
<Link id="l01082" /><CodeLine lineNumber="1082"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Idx : <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>)</span></CodeLine>
<Link id="l01083" /><CodeLine lineNumber="1083"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/mloctracker/#a6fa795efcfec488fc9683b69b1f9a4d3">StackIdxesToPos</a>&#91;Idx.second&#93; = Idx.first;</span></CodeLine>
<Link id="l01084" /><CodeLine lineNumber="1084"></CodeLine>
<Link id="l01085" /><CodeLine lineNumber="1085"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#ab2d1c5bd4bf56e5b4124fa4088f5c5d9">NumSlotIdxes</a> = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a5afcbfb84f0bb09c726e9a777d9f01e7">StackSlotIdxes</a>.size();</span></CodeLine>
<Link id="l01086" /><CodeLine lineNumber="1086"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01087" /><CodeLine lineNumber="1087"></CodeLine>
<Link id="l01088" /><CodeLine lineNumber="1088" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#ae0c12fcc919645ec5ae40a9763d756ba"><span class="doxyHighlight"><a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> <a href="/docs/api/classes/livedebugvalues/mloctracker/#ae0c12fcc919645ec5ae40a9763d756ba">MLocTracker::trackRegister</a>(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>) &#123;</span></CodeLine>
<Link id="l01089" /><CodeLine lineNumber="1089"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> != 0);</span></CodeLine>
<Link id="l01090" /><CodeLine lineNumber="1090"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> NewIdx = <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#a91fd5d450920e56cbde71ab8708fbab9">LocIdxToIDNum</a>.size());</span></CodeLine>
<Link id="l01091" /><CodeLine lineNumber="1091"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a91fd5d450920e56cbde71ab8708fbab9">LocIdxToIDNum</a>.grow(NewIdx);</span></CodeLine>
<Link id="l01092" /><CodeLine lineNumber="1092"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a12a921bb359eb2ab39e43e4c4ba780f3">LocIdxToLocID</a>.grow(NewIdx);</span></CodeLine>
<Link id="l01093" /><CodeLine lineNumber="1093"></CodeLine>
<Link id="l01094" /><CodeLine lineNumber="1094"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Default: it&#39;s an mphi.</span></CodeLine>
<Link id="l01095" /><CodeLine lineNumber="1095"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> ValNum = &#123;<a href="/docs/api/classes/livedebugvalues/mloctracker/#a2017e35cd152cf2e3885ea8ed8e3d8f5">CurBB</a>, 0, NewIdx&#125;;</span></CodeLine>
<Link id="l01096" /><CodeLine lineNumber="1096"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Was this reg ever touched by a regmask?</span></CodeLine>
<Link id="l01097" /><CodeLine lineNumber="1097"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;MaskPair : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#ab115d98ec0127b8b019aae3e5e296efc">Masks</a>)) &#123;</span></CodeLine>
<Link id="l01098" /><CodeLine lineNumber="1098"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MaskPair.first-&gt;clobbersPhysReg(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>)) &#123;</span></CodeLine>
<Link id="l01099" /><CodeLine lineNumber="1099"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// There was an earlier def we skipped.</span></CodeLine>
<Link id="l01100" /><CodeLine lineNumber="1100"><span class="doxyHighlight">      ValNum = &#123;<a href="/docs/api/classes/livedebugvalues/mloctracker/#a2017e35cd152cf2e3885ea8ed8e3d8f5">CurBB</a>, MaskPair.second, NewIdx&#125;;</span></CodeLine>
<Link id="l01101" /><CodeLine lineNumber="1101"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01102" /><CodeLine lineNumber="1102"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01103" /><CodeLine lineNumber="1103"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01104" /><CodeLine lineNumber="1104"></CodeLine>
<Link id="l01105" /><CodeLine lineNumber="1105"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a91fd5d450920e56cbde71ab8708fbab9">LocIdxToIDNum</a>&#91;NewIdx&#93; = ValNum;</span></CodeLine>
<Link id="l01106" /><CodeLine lineNumber="1106"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#a12a921bb359eb2ab39e43e4c4ba780f3">LocIdxToLocID</a>&#91;NewIdx&#93; = <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>;</span></CodeLine>
<Link id="l01107" /><CodeLine lineNumber="1107"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> NewIdx;</span></CodeLine>
<Link id="l01108" /><CodeLine lineNumber="1108"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01109" /><CodeLine lineNumber="1109"></CodeLine>
<Link id="l01110" /><CodeLine lineNumber="1110" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#a73d25ebef02d1312bd901c694d7321ee"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker/#a73d25ebef02d1312bd901c694d7321ee">MLocTracker::writeRegMask</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &#42;MO, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker/#a2017e35cd152cf2e3885ea8ed8e3d8f5">CurBB</a>,</span></CodeLine>
<Link id="l01111" /><CodeLine lineNumber="1111"><span class="doxyHighlight">                               </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> InstID) &#123;</span></CodeLine>
<Link id="l01112" /><CodeLine lineNumber="1112"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Def any register we track have that isn&#39;t preserved. The regmask</span></CodeLine>
<Link id="l01113" /><CodeLine lineNumber="1113"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// terminates the liveness of a register, meaning its value can&#39;t be</span></CodeLine>
<Link id="l01114" /><CodeLine lineNumber="1114"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// relied upon -- we represent this by giving it a new value.</span></CodeLine>
<Link id="l01115" /><CodeLine lineNumber="1115"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : <a href="/docs/api/classes/livedebugvalues/mloctracker/#a217987fff459e088b64f179204e120f1">locations</a>()) &#123;</span></CodeLine>
<Link id="l01116" /><CodeLine lineNumber="1116"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a12a921bb359eb2ab39e43e4c4ba780f3">LocIdxToLocID</a>&#91;Location.Idx&#93;;</span></CodeLine>
<Link id="l01117" /><CodeLine lineNumber="1117"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Don&#39;t clobber SP, even if the mask says it&#39;s clobbered.</span></CodeLine>
<Link id="l01118" /><CodeLine lineNumber="1118"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> &lt; <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3d106e52bda90530904b18edf24f2286">NumRegs</a> &amp;&amp; !<a href="/docs/api/classes/livedebugvalues/mloctracker/#a2773f3976918a270bac316739f66ffd5">SPAliases</a>.count(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>) &amp;&amp; MO-&gt;<a href="/docs/api/classes/llvm/machineoperand/#ae4ecf5483b94e2bb72967b80cc2008d2">clobbersPhysReg</a>(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>))</span></CodeLine>
<Link id="l01119" /><CodeLine lineNumber="1119"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#ad4b28d7abd903bca80aebdd56d893e8b">defReg</a>(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>, <a href="/docs/api/classes/livedebugvalues/mloctracker/#a2017e35cd152cf2e3885ea8ed8e3d8f5">CurBB</a>, InstID);</span></CodeLine>
<Link id="l01120" /><CodeLine lineNumber="1120"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01121" /><CodeLine lineNumber="1121"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/mloctracker/#ab115d98ec0127b8b019aae3e5e296efc">Masks</a>.push&#95;back(std::make&#95;pair(MO, InstID));</span></CodeLine>
<Link id="l01122" /><CodeLine lineNumber="1122"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01123" /><CodeLine lineNumber="1123"></CodeLine>
<Link id="l01124" /><CodeLine lineNumber="1124" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#a0ec8c44bc2b0efa41c2a6583f9d75f21"><span class="doxyHighlight">std::optional&lt;SpillLocationNo&gt; <a href="/docs/api/classes/livedebugvalues/mloctracker/#a0ec8c44bc2b0efa41c2a6583f9d75f21">MLocTracker::getOrTrackSpillLoc</a>(<a href="/docs/api/structs/livedebugvalues/spillloc">SpillLoc</a> L) &#123;</span></CodeLine>
<Link id="l01125" /><CodeLine lineNumber="1125"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/spilllocationno">SpillLocationNo</a> SpillID(<a href="/docs/api/classes/livedebugvalues/mloctracker/#ab8795e147779aed8a5d0af6783babaa0">SpillLocs</a>.idFor(L));</span></CodeLine>
<Link id="l01126" /><CodeLine lineNumber="1126"></CodeLine>
<Link id="l01127" /><CodeLine lineNumber="1127"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SpillID.<a href="/docs/api/classes/livedebugvalues/spilllocationno/#a2e309fd3b79f17ba6213f7eb9d637329">id</a>() == 0) &#123;</span></CodeLine>
<Link id="l01128" /><CodeLine lineNumber="1128"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If there is no location, and we have reached the limit of how many stack</span></CodeLine>
<Link id="l01129" /><CodeLine lineNumber="1129"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// slots to track, then don&#39;t track this one.</span></CodeLine>
<Link id="l01130" /><CodeLine lineNumber="1130"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/mloctracker/#ab8795e147779aed8a5d0af6783babaa0">SpillLocs</a>.size() &gt;= <a href="#ad6ba0b6b6e6515414554417edb06e073">StackWorkingSetLimit</a>)</span></CodeLine>
<Link id="l01131" /><CodeLine lineNumber="1131"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l01132" /><CodeLine lineNumber="1132"></CodeLine>
<Link id="l01133" /><CodeLine lineNumber="1133"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Spill location is untracked: create record for this one, and all</span></CodeLine>
<Link id="l01134" /><CodeLine lineNumber="1134"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// subregister slots too.</span></CodeLine>
<Link id="l01135" /><CodeLine lineNumber="1135"><span class="doxyHighlight">    SpillID = <a href="/docs/api/classes/livedebugvalues/spilllocationno">SpillLocationNo</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#ab8795e147779aed8a5d0af6783babaa0">SpillLocs</a>.insert(L));</span></CodeLine>
<Link id="l01136" /><CodeLine lineNumber="1136"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> StackIdx = 0; StackIdx &lt; <a href="/docs/api/classes/livedebugvalues/mloctracker/#ab2d1c5bd4bf56e5b4124fa4088f5c5d9">NumSlotIdxes</a>; ++StackIdx) &#123;</span></CodeLine>
<Link id="l01137" /><CodeLine lineNumber="1137"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> L = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a1c44cbd0dca6d3e9736ce4f240af2e25">getSpillIDWithIdx</a>(SpillID, StackIdx);</span></CodeLine>
<Link id="l01138" /><CodeLine lineNumber="1138"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> Idx = <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#a91fd5d450920e56cbde71ab8708fbab9">LocIdxToIDNum</a>.size()); </span><span class="doxyHighlightComment">// New idx</span></CodeLine>
<Link id="l01139" /><CodeLine lineNumber="1139"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#a91fd5d450920e56cbde71ab8708fbab9">LocIdxToIDNum</a>.grow(Idx);</span></CodeLine>
<Link id="l01140" /><CodeLine lineNumber="1140"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#a12a921bb359eb2ab39e43e4c4ba780f3">LocIdxToLocID</a>.grow(Idx);</span></CodeLine>
<Link id="l01141" /><CodeLine lineNumber="1141"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#a9b700e192036873e9756f231c9213a34">LocIDToLocIdx</a>.push&#95;back(Idx);</span></CodeLine>
<Link id="l01142" /><CodeLine lineNumber="1142"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#a12a921bb359eb2ab39e43e4c4ba780f3">LocIdxToLocID</a>&#91;Idx&#93; = L;</span></CodeLine>
<Link id="l01143" /><CodeLine lineNumber="1143"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Initialize to PHI value; corresponds to the location&#39;s live-in value</span></CodeLine>
<Link id="l01144" /><CodeLine lineNumber="1144"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// during transfer function construction.</span></CodeLine>
<Link id="l01145" /><CodeLine lineNumber="1145"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#a91fd5d450920e56cbde71ab8708fbab9">LocIdxToIDNum</a>&#91;Idx&#93; = <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#a2017e35cd152cf2e3885ea8ed8e3d8f5">CurBB</a>, 0, Idx);</span></CodeLine>
<Link id="l01146" /><CodeLine lineNumber="1146"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01147" /><CodeLine lineNumber="1147"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01148" /><CodeLine lineNumber="1148"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SpillID;</span></CodeLine>
<Link id="l01149" /><CodeLine lineNumber="1149"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01150" /><CodeLine lineNumber="1150"></CodeLine>
<Link id="l01151" /><CodeLine lineNumber="1151" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#afe9d19d27dd82ae73f86937cb41c3d8b"><span class="doxyHighlight">std::string <a href="/docs/api/classes/livedebugvalues/mloctracker/#afe9d19d27dd82ae73f86937cb41c3d8b">MLocTracker::LocIdxToName</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> Idx)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01152" /><CodeLine lineNumber="1152"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a12a921bb359eb2ab39e43e4c4ba780f3">LocIdxToLocID</a>&#91;Idx&#93;;</span></CodeLine>
<Link id="l01153" /><CodeLine lineNumber="1153"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> &gt;= <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3d106e52bda90530904b18edf24f2286">NumRegs</a>) &#123;</span></CodeLine>
<Link id="l01154" /><CodeLine lineNumber="1154"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/mloctracker/#a758eab2c8cea4d5486874624dba188b4">StackSlotPos</a> Pos = <a href="/docs/api/classes/livedebugvalues/mloctracker/#af39200a4599a5fc61a89ca83ce64598a">locIDToSpillIdx</a>(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>);</span></CodeLine>
<Link id="l01155" /><CodeLine lineNumber="1155"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> -= <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3d106e52bda90530904b18edf24f2286">NumRegs</a>;</span></CodeLine>
<Link id="l01156" /><CodeLine lineNumber="1156"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Slot = <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> / <a href="/docs/api/classes/livedebugvalues/mloctracker/#ab2d1c5bd4bf56e5b4124fa4088f5c5d9">NumSlotIdxes</a>;</span></CodeLine>
<Link id="l01157" /><CodeLine lineNumber="1157"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/twine">Twine</a>(</span><span class="doxyHighlightStringLiteral">&quot;slot &quot;</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l01158" /><CodeLine lineNumber="1158"><span class="doxyHighlight">        .<a href="/docs/api/classes/llvm/twine/#a529bd775f25e1c6ea4a96b34a5d8bde6">concat</a>(<a href="/docs/api/classes/llvm/twine">Twine</a>(Slot).<a href="/docs/api/namespaces/llvm/#a52ff73f5c87e0fb78fbdca0465300c95">concat</a>(<a href="/docs/api/classes/llvm/twine">Twine</a>(</span><span class="doxyHighlightStringLiteral">&quot; sz &quot;</span><span class="doxyHighlight">).<a href="/docs/api/namespaces/llvm/#a52ff73f5c87e0fb78fbdca0465300c95">concat</a>(<a href="/docs/api/classes/llvm/twine">Twine</a>(Pos.first)</span></CodeLine>
<Link id="l01159" /><CodeLine lineNumber="1159"><span class="doxyHighlight">        .<a href="/docs/api/classes/llvm/twine/#a529bd775f25e1c6ea4a96b34a5d8bde6">concat</a>(<a href="/docs/api/classes/llvm/twine">Twine</a>(</span><span class="doxyHighlightStringLiteral">&quot; offs &quot;</span><span class="doxyHighlight">).<a href="/docs/api/namespaces/llvm/#a52ff73f5c87e0fb78fbdca0465300c95">concat</a>(<a href="/docs/api/classes/llvm/twine">Twine</a>(Pos.second))))))</span></CodeLine>
<Link id="l01160" /><CodeLine lineNumber="1160"><span class="doxyHighlight">        .<a href="/docs/api/classes/llvm/twine/#a4c1c1093a7749409c70838678514cc7c">str</a>();</span></CodeLine>
<Link id="l01161" /><CodeLine lineNumber="1161"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01162" /><CodeLine lineNumber="1162"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>.getRegAsmName(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>).str();</span></CodeLine>
<Link id="l01163" /><CodeLine lineNumber="1163"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01164" /><CodeLine lineNumber="1164"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01165" /><CodeLine lineNumber="1165"></CodeLine>
<Link id="l01166" /><CodeLine lineNumber="1166" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#a70d5f445ba9f76ce9d0a11bc11e8e1a9"><span class="doxyHighlight">std::string <a href="/docs/api/classes/livedebugvalues/mloctracker/#a70d5f445ba9f76ce9d0a11bc11e8e1a9">MLocTracker::IDAsString</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a> &amp;Num)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01167" /><CodeLine lineNumber="1167"><span class="doxyHighlight">  std::string DefName = <a href="/docs/api/classes/livedebugvalues/mloctracker/#afe9d19d27dd82ae73f86937cb41c3d8b">LocIdxToName</a>(Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#af0ee865517c9747fa74f9eb3ed54578a">getLoc</a>());</span></CodeLine>
<Link id="l01168" /><CodeLine lineNumber="1168"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a9313c0181a7f6ea6097163d55a4a7694">asString</a>(DefName);</span></CodeLine>
<Link id="l01169" /><CodeLine lineNumber="1169"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01170" /><CodeLine lineNumber="1170"></CodeLine>
<Link id="l01171" /><CodeLine lineNumber="1171"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l01172" /><CodeLine lineNumber="1172" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#ad60ba0b6dcb54a7fe37863ceb0165626"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker/#ad60ba0b6dcb54a7fe37863ceb0165626">MLocTracker::dump</a>() &#123;</span></CodeLine>
<Link id="l01173" /><CodeLine lineNumber="1173"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : <a href="/docs/api/classes/livedebugvalues/mloctracker/#a217987fff459e088b64f179204e120f1">locations</a>()) &#123;</span></CodeLine>
<Link id="l01174" /><CodeLine lineNumber="1174"><span class="doxyHighlight">    std::string MLocName = <a href="/docs/api/classes/livedebugvalues/mloctracker/#afe9d19d27dd82ae73f86937cb41c3d8b">LocIdxToName</a>(Location.Value.getLoc());</span></CodeLine>
<Link id="l01175" /><CodeLine lineNumber="1175"><span class="doxyHighlight">    std::string DefName = Location.Value.asString(MLocName);</span></CodeLine>
<Link id="l01176" /><CodeLine lineNumber="1176"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; <a href="/docs/api/classes/livedebugvalues/mloctracker/#afe9d19d27dd82ae73f86937cb41c3d8b">LocIdxToName</a>(Location.Idx) &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; --&gt; &quot;</span><span class="doxyHighlight"> &lt;&lt; DefName &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01177" /><CodeLine lineNumber="1177"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01178" /><CodeLine lineNumber="1178"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01179" /><CodeLine lineNumber="1179"></CodeLine>
<Link id="l01180" /><CodeLine lineNumber="1180" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#af0c9cdac0acbe1745277e6e9544aa575"><span class="doxyHighlight"><a href="/docs/api/files/include/include/llvm/include/llvm/support/compiler-h/#aa863693eef567397d9c292da5bf22d34">LLVM&#95;DUMP&#95;METHOD</a> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/mloctracker/#af0c9cdac0acbe1745277e6e9544aa575">MLocTracker::dump&#95;mloc&#95;map</a>() &#123;</span></CodeLine>
<Link id="l01181" /><CodeLine lineNumber="1181"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : <a href="/docs/api/classes/livedebugvalues/mloctracker/#a217987fff459e088b64f179204e120f1">locations</a>()) &#123;</span></CodeLine>
<Link id="l01182" /><CodeLine lineNumber="1182"><span class="doxyHighlight">    std::string foo = <a href="/docs/api/classes/livedebugvalues/mloctracker/#afe9d19d27dd82ae73f86937cb41c3d8b">LocIdxToName</a>(Location.Idx);</span></CodeLine>
<Link id="l01183" /><CodeLine lineNumber="1183"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Idx &quot;</span><span class="doxyHighlight"> &lt;&lt; Location.Idx.asU64() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; &quot;</span><span class="doxyHighlight"> &lt;&lt; foo &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01184" /><CodeLine lineNumber="1184"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01185" /><CodeLine lineNumber="1185"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01186" /><CodeLine lineNumber="1186"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01187" /><CodeLine lineNumber="1187"></CodeLine>
<Link id="l01188" /><CodeLine lineNumber="1188"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/machineinstrbuilder">MachineInstrBuilder</a></span></CodeLine>
<Link id="l01189" /><CodeLine lineNumber="1189" lineLink="/docs/api/classes/livedebugvalues/mloctracker/#a88fd52c520cef6a03af97c37c308ae78"><span class="doxyHighlight"><a href="/docs/api/classes/livedebugvalues/mloctracker/#a88fd52c520cef6a03af97c37c308ae78">MLocTracker::emitLoc</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;ResolvedDbgOp&gt;</a> &amp;DbgOps,</span></CodeLine>
<Link id="l01190" /><CodeLine lineNumber="1190"><span class="doxyHighlight">                     </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/debugvariable">DebugVariable</a> &amp;Var, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/dilocation">DILocation</a> &#42;DILoc,</span></CodeLine>
<Link id="l01191" /><CodeLine lineNumber="1191"><span class="doxyHighlight">                     </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/dbgvalueproperties">DbgValueProperties</a> &amp;Properties) &#123;</span></CodeLine>
<Link id="l01192" /><CodeLine lineNumber="1192"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a href="/docs/api/namespaces/llvm/dwarf-linker/#a463a58e257d5f6fb2c39eb9a2474fc24ac2e06fc138163b7095fa483616a0a47a">DebugLoc</a>(DILoc);</span></CodeLine>
<Link id="l01193" /><CodeLine lineNumber="1193"></CodeLine>
<Link id="l01194" /><CodeLine lineNumber="1194"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/mcinstrdesc">MCInstrDesc</a> &amp;<a href="/docs/api/namespaces/llvm/#a4de98a9acffcef5bb4b31862cb8c72ac">Desc</a> = Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#aebaf15eb5116df110c1de27c5c8901a2">IsVariadic</a></span></CodeLine>
<Link id="l01195" /><CodeLine lineNumber="1195"><span class="doxyHighlight">                                ? <a href="/docs/api/classes/livedebugvalues/mloctracker/#a7bcfe28f8a994ea7a5fff050f1c09fd2">TII</a>.get(TargetOpcode::DBG&#95;VALUE&#95;LIST)</span></CodeLine>
<Link id="l01196" /><CodeLine lineNumber="1196"><span class="doxyHighlight">                                : <a href="/docs/api/classes/livedebugvalues/mloctracker/#a7bcfe28f8a994ea7a5fff050f1c09fd2">TII</a>.get(TargetOpcode::DBG&#95;VALUE);</span></CodeLine>
<Link id="l01197" /><CodeLine lineNumber="1197"></CodeLine>
<Link id="l01198" /><CodeLine lineNumber="1198"><span class="doxyHighlightPreprocessor">#ifdef EXPENSIVE&#95;CHECKS</span></CodeLine>
<Link id="l01199" /><CodeLine lineNumber="1199"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/namespaces/llvm/#a0d10fe510ced2849a8074fe81e5d04ce">all&#95;of</a>(DbgOps,</span></CodeLine>
<Link id="l01200" /><CodeLine lineNumber="1200"><span class="doxyHighlight">                &#91;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>) &#123;</span></CodeLine>
<Link id="l01201" /><CodeLine lineNumber="1201"><span class="doxyHighlight">                  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.IsConst || !<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.Loc.isIllegal();</span></CodeLine>
<Link id="l01202" /><CodeLine lineNumber="1202"><span class="doxyHighlight">                &#125;) &amp;&amp;</span></CodeLine>
<Link id="l01203" /><CodeLine lineNumber="1203"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Did not expect illegal ops in DbgOps.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01204" /><CodeLine lineNumber="1204"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>((DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == 0 ||</span></CodeLine>
<Link id="l01205" /><CodeLine lineNumber="1205"><span class="doxyHighlight">          DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#ae1a6cd7bbbd214de5c1990def99b1c57">getLocationOpCount</a>()) &amp;&amp;</span></CodeLine>
<Link id="l01206" /><CodeLine lineNumber="1206"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Expected to have either one DbgOp per MI LocationOp, or none.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01207" /><CodeLine lineNumber="1207"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01208" /><CodeLine lineNumber="1208"></CodeLine>
<Link id="l01209" /><CodeLine lineNumber="1209"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> GetRegOp = &#91;&#93;(</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Reg) -&gt; <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &#123;</span></CodeLine>
<Link id="l01210" /><CodeLine lineNumber="1210"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand/#af2c351dad09a71aa08e1d85c67ae6e53">MachineOperand::CreateReg</a>(</span></CodeLine>
<Link id="l01211" /><CodeLine lineNumber="1211"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">/&#42; Reg &#42;/</span><span class="doxyHighlight"> Reg, </span><span class="doxyHighlightComment">/&#42; isDef &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightComment">/&#42; isImp &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l01212" /><CodeLine lineNumber="1212"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">/&#42; isKill &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightComment">/&#42; isDead &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l01213" /><CodeLine lineNumber="1213"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">/&#42; isUndef &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightComment">/&#42; isEarlyClobber &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">,</span></CodeLine>
<Link id="l01214" /><CodeLine lineNumber="1214"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">/&#42; SubReg &#42;/</span><span class="doxyHighlight"> 0, </span><span class="doxyHighlightComment">/&#42; isDebug &#42;/</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01215" /><CodeLine lineNumber="1215"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l01216" /><CodeLine lineNumber="1216"></CodeLine>
<Link id="l01217" /><CodeLine lineNumber="1217"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;MachineOperand&gt;</a> MOs;</span></CodeLine>
<Link id="l01218" /><CodeLine lineNumber="1218"></CodeLine>
<Link id="l01219" /><CodeLine lineNumber="1219"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> EmitUndef = &#91;&amp;&#93;() &#123;</span></CodeLine>
<Link id="l01220" /><CodeLine lineNumber="1220"><span class="doxyHighlight">    MOs.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l01221" /><CodeLine lineNumber="1221"><span class="doxyHighlight">    MOs.<a href="/docs/api/classes/llvm/smallvectorimpl/#a38c50aa8e3e9588f4f968c2e03a0cee0">assign</a>(Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#ae1a6cd7bbbd214de5c1990def99b1c57">getLocationOpCount</a>(), GetRegOp(0));</span></CodeLine>
<Link id="l01222" /><CodeLine lineNumber="1222"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#ae1a29742ce2fd47f4b4769dfe5a44f9e">MF</a>, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/namespaces/llvm/#a4de98a9acffcef5bb4b31862cb8c72ac">Desc</a>, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, MOs, Var.<a href="/docs/api/classes/llvm/debugvariable/#af2ca096ab72c055f6c2c7e3ffbe5d6bf">getVariable</a>(),</span></CodeLine>
<Link id="l01223" /><CodeLine lineNumber="1223"><span class="doxyHighlight">                   Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a87d598e34086fb45a3a64638bdc6097e">DIExpr</a>);</span></CodeLine>
<Link id="l01224" /><CodeLine lineNumber="1224"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l01225" /><CodeLine lineNumber="1225"></CodeLine>
<Link id="l01226" /><CodeLine lineNumber="1226"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Don&#39;t bother passing any real operands to BuildMI if any of them would be</span></CodeLine>
<Link id="l01227" /><CodeLine lineNumber="1227"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// $noreg.</span></CodeLine>
<Link id="l01228" /><CodeLine lineNumber="1228"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</span></CodeLine>
<Link id="l01229" /><CodeLine lineNumber="1229"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> EmitUndef();</span></CodeLine>
<Link id="l01230" /><CodeLine lineNumber="1230"></CodeLine>
<Link id="l01231" /><CodeLine lineNumber="1231"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Indirect = Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a7f88fbb422e5e0d5c0e227b3df0bd8a8">Indirect</a>;</span></CodeLine>
<Link id="l01232" /><CodeLine lineNumber="1232"></CodeLine>
<Link id="l01233" /><CodeLine lineNumber="1233"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/diexpression">DIExpression</a> &#42;Expr = Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a87d598e34086fb45a3a64638bdc6097e">DIExpr</a>;</span></CodeLine>
<Link id="l01234" /><CodeLine lineNumber="1234"></CodeLine>
<Link id="l01235" /><CodeLine lineNumber="1235"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#ae1a6cd7bbbd214de5c1990def99b1c57">getLocationOpCount</a>());</span></CodeLine>
<Link id="l01236" /><CodeLine lineNumber="1236"></CodeLine>
<Link id="l01237" /><CodeLine lineNumber="1237"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If all locations are valid, accumulate them into our list of</span></CodeLine>
<Link id="l01238" /><CodeLine lineNumber="1238"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// MachineOperands. For any spilled locations, either update the indirectness</span></CodeLine>
<Link id="l01239" /><CodeLine lineNumber="1239"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// register or apply the appropriate transformations in the DIExpression.</span></CodeLine>
<Link id="l01240" /><CodeLine lineNumber="1240"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">size&#95;t</span><span class="doxyHighlight"> Idx = 0; Idx &lt; Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#ae1a6cd7bbbd214de5c1990def99b1c57">getLocationOpCount</a>(); ++Idx) &#123;</span></CodeLine>
<Link id="l01241" /><CodeLine lineNumber="1241"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/resolveddbgop">ResolvedDbgOp</a> &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> = DbgOps&#91;Idx&#93;;</span></CodeLine>
<Link id="l01242" /><CodeLine lineNumber="1242"></CodeLine>
<Link id="l01243" /><CodeLine lineNumber="1243"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.IsConst) &#123;</span></CodeLine>
<Link id="l01244" /><CodeLine lineNumber="1244"><span class="doxyHighlight">      MOs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.MO);</span></CodeLine>
<Link id="l01245" /><CodeLine lineNumber="1245"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01246" /><CodeLine lineNumber="1246"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01247" /><CodeLine lineNumber="1247"></CodeLine>
<Link id="l01248" /><CodeLine lineNumber="1248"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> MLoc = <a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.Loc;</span></CodeLine>
<Link id="l01249" /><CodeLine lineNumber="1249"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LocID = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a12a921bb359eb2ab39e43e4c4ba780f3">LocIdxToLocID</a>&#91;MLoc&#93;;</span></CodeLine>
<Link id="l01250" /><CodeLine lineNumber="1250"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LocID &gt;= <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3d106e52bda90530904b18edf24f2286">NumRegs</a>) &#123;</span></CodeLine>
<Link id="l01251" /><CodeLine lineNumber="1251"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/spilllocationno">SpillLocationNo</a> SpillID = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a63cf4d79a939e187701ac667cb07f5d7">locIDToSpill</a>(LocID);</span></CodeLine>
<Link id="l01252" /><CodeLine lineNumber="1252"><span class="doxyHighlight">      <a href="/docs/api/classes/livedebugvalues/mloctracker/#a758eab2c8cea4d5486874624dba188b4">StackSlotPos</a> StackIdx = <a href="/docs/api/classes/livedebugvalues/mloctracker/#af39200a4599a5fc61a89ca83ce64598a">locIDToSpillIdx</a>(LocID);</span></CodeLine>
<Link id="l01253" /><CodeLine lineNumber="1253"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">short</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = StackIdx.second;</span></CodeLine>
<Link id="l01254" /><CodeLine lineNumber="1254"></CodeLine>
<Link id="l01255" /><CodeLine lineNumber="1255"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// TODO: support variables that are located in spill slots, with non-zero</span></CodeLine>
<Link id="l01256" /><CodeLine lineNumber="1256"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// offsets from the start of the spill slot. It would require some more</span></CodeLine>
<Link id="l01257" /><CodeLine lineNumber="1257"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// complex DIExpression calculations. This doesn&#39;t seem to be produced by</span></CodeLine>
<Link id="l01258" /><CodeLine lineNumber="1258"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// LLVM right now, so don&#39;t try and support it.</span></CodeLine>
<Link id="l01259" /><CodeLine lineNumber="1259"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Accept no-subregister slots and subregisters where the offset is zero.</span></CodeLine>
<Link id="l01260" /><CodeLine lineNumber="1260"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// The consumer should already have type information to work out how large</span></CodeLine>
<Link id="l01261" /><CodeLine lineNumber="1261"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// the variable is.</span></CodeLine>
<Link id="l01262" /><CodeLine lineNumber="1262"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> == 0) &#123;</span></CodeLine>
<Link id="l01263" /><CodeLine lineNumber="1263"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/spillloc">SpillLoc</a> &amp;Spill = <a href="/docs/api/classes/livedebugvalues/mloctracker/#ab8795e147779aed8a5d0af6783babaa0">SpillLocs</a>&#91;SpillID.<a href="/docs/api/classes/livedebugvalues/spilllocationno/#a2e309fd3b79f17ba6213f7eb9d637329">id</a>()&#93;;</span></CodeLine>
<Link id="l01264" /><CodeLine lineNumber="1264"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a> = Spill.SpillBase;</span></CodeLine>
<Link id="l01265" /><CodeLine lineNumber="1265"></CodeLine>
<Link id="l01266" /><CodeLine lineNumber="1266"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// There are several ways we can dereference things, and several inputs</span></CodeLine>
<Link id="l01267" /><CodeLine lineNumber="1267"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// to consider:</span></CodeLine>
<Link id="l01268" /><CodeLine lineNumber="1268"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// &#42; NRVO variables will appear with IsIndirect set, but should have</span></CodeLine>
<Link id="l01269" /><CodeLine lineNumber="1269"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//   nothing else in their DIExpressions,</span></CodeLine>
<Link id="l01270" /><CodeLine lineNumber="1270"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// &#42; Variables with DW&#95;OP&#95;stack&#95;value in their expr already need an</span></CodeLine>
<Link id="l01271" /><CodeLine lineNumber="1271"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//   explicit dereference of the stack location,</span></CodeLine>
<Link id="l01272" /><CodeLine lineNumber="1272"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// &#42; Values that don&#39;t match the variable size need DW&#95;OP&#95;deref&#95;size,</span></CodeLine>
<Link id="l01273" /><CodeLine lineNumber="1273"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// &#42; Everything else can just become a simple location expression.</span></CodeLine>
<Link id="l01274" /><CodeLine lineNumber="1274"></CodeLine>
<Link id="l01275" /><CodeLine lineNumber="1275"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We need to use deref&#95;size whenever there&#39;s a mismatch between the</span></CodeLine>
<Link id="l01276" /><CodeLine lineNumber="1276"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// size of value and the size of variable portion being read.</span></CodeLine>
<Link id="l01277" /><CodeLine lineNumber="1277"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Additionally, we should use it whenever dealing with stack&#95;value</span></CodeLine>
<Link id="l01278" /><CodeLine lineNumber="1278"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// fragments, to avoid the consumer having to determine the deref size</span></CodeLine>
<Link id="l01279" /><CodeLine lineNumber="1279"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// from DW&#95;OP&#95;piece.</span></CodeLine>
<Link id="l01280" /><CodeLine lineNumber="1280"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> UseDerefSize = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01281" /><CodeLine lineNumber="1281"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ValueSizeInBits = <a href="/docs/api/classes/livedebugvalues/mloctracker/#a00b889b10d5eaeb7be44d959e67263c6">getLocSizeInBits</a>(MLoc);</span></CodeLine>
<Link id="l01282" /><CodeLine lineNumber="1282"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> DerefSizeInBytes = ValueSizeInBits / 8;</span></CodeLine>
<Link id="l01283" /><CodeLine lineNumber="1283"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Fragment = Var.<a href="/docs/api/classes/llvm/debugvariable/#adcfb72c9275acde495226af4ad12e180">getFragment</a>()) &#123;</span></CodeLine>
<Link id="l01284" /><CodeLine lineNumber="1284"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> VariableSizeInBits = Fragment-&gt;SizeInBits;</span></CodeLine>
<Link id="l01285" /><CodeLine lineNumber="1285"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VariableSizeInBits != ValueSizeInBits || Expr-&gt;<a href="/docs/api/classes/llvm/diexpression/#a7926734793677673e68d8cff410552ec">isComplex</a>())</span></CodeLine>
<Link id="l01286" /><CodeLine lineNumber="1286"><span class="doxyHighlight">            UseDerefSize = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01287" /><CodeLine lineNumber="1287"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = Var.<a href="/docs/api/classes/llvm/debugvariable/#af2ca096ab72c055f6c2c7e3ffbe5d6bf">getVariable</a>()-&gt;<a href="/docs/api/classes/llvm/divariable/#a6b5977deeb9f99e156685e190de78403">getSizeInBits</a>()) &#123;</span></CodeLine>
<Link id="l01288" /><CodeLine lineNumber="1288"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&#42;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> != ValueSizeInBits) &#123;</span></CodeLine>
<Link id="l01289" /><CodeLine lineNumber="1289"><span class="doxyHighlight">            UseDerefSize = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01290" /><CodeLine lineNumber="1290"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l01291" /><CodeLine lineNumber="1291"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01292" /><CodeLine lineNumber="1292"></CodeLine>
<Link id="l01293" /><CodeLine lineNumber="1293"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// https://github.com/llvm/llvm-project/issues/64093</span></CodeLine>
<Link id="l01294" /><CodeLine lineNumber="1294"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// in particular #issuecomment-2531264124. We use variable locations</span></CodeLine>
<Link id="l01295" /><CodeLine lineNumber="1295"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// such as DBG&#95;VALUE $xmm0 as shorthand to refer to &quot;the low lane of</span></CodeLine>
<Link id="l01296" /><CodeLine lineNumber="1296"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// $xmm0&quot;, and this is reflected in how DWARF is interpreted too.</span></CodeLine>
<Link id="l01297" /><CodeLine lineNumber="1297"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// However InstrRefBasedLDV tries to be smart and interprets such a</span></CodeLine>
<Link id="l01298" /><CodeLine lineNumber="1298"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// DBG&#95;VALUE as a 128-bit reference. We then issue a DW&#95;OP&#95;deref&#95;size</span></CodeLine>
<Link id="l01299" /><CodeLine lineNumber="1299"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// of 128 bits to the stack, which isn&#39;t permitted by DWARF (it&#39;s</span></CodeLine>
<Link id="l01300" /><CodeLine lineNumber="1300"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// larger than a pointer).</span></CodeLine>
<Link id="l01301" /><CodeLine lineNumber="1301"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01302" /><CodeLine lineNumber="1302"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Solve this for now by not using DW&#95;OP&#95;deref&#95;size if it would be</span></CodeLine>
<Link id="l01303" /><CodeLine lineNumber="1303"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// illegal. Instead we&#39;ll use DW&#95;OP&#95;deref, and the consumer will load</span></CodeLine>
<Link id="l01304" /><CodeLine lineNumber="1304"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// the variable type from the stack, which should be correct.</span></CodeLine>
<Link id="l01305" /><CodeLine lineNumber="1305"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l01306" /><CodeLine lineNumber="1306"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// There&#39;s still a risk of imprecision when LLVM decides to use</span></CodeLine>
<Link id="l01307" /><CodeLine lineNumber="1307"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// smaller or larger value types than the source-variable type, which</span></CodeLine>
<Link id="l01308" /><CodeLine lineNumber="1308"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// manifests as too-little or too-much memory being read from the stack.</span></CodeLine>
<Link id="l01309" /><CodeLine lineNumber="1309"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// However we can&#39;t solve that without putting more type information in</span></CodeLine>
<Link id="l01310" /><CodeLine lineNumber="1310"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// debug-info.</span></CodeLine>
<Link id="l01311" /><CodeLine lineNumber="1311"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValueSizeInBits &gt; <a href="/docs/api/classes/livedebugvalues/mloctracker/#ae1a29742ce2fd47f4b4769dfe5a44f9e">MF</a>.getTarget().getPointerSizeInBits(0))</span></CodeLine>
<Link id="l01312" /><CodeLine lineNumber="1312"><span class="doxyHighlight">          UseDerefSize = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01313" /><CodeLine lineNumber="1313"></CodeLine>
<Link id="l01314" /><CodeLine lineNumber="1314"><span class="doxyHighlight">        <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;uint64&#95;t, 5&gt;</a> OffsetOps;</span></CodeLine>
<Link id="l01315" /><CodeLine lineNumber="1315"><span class="doxyHighlight">        <a href="/docs/api/classes/livedebugvalues/mloctracker/#a3870dfac7df420149911b3e81c6c155a">TRI</a>.getOffsetOpcodes(Spill.SpillOffset, OffsetOps);</span></CodeLine>
<Link id="l01316" /><CodeLine lineNumber="1316"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> StackValue = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01317" /><CodeLine lineNumber="1317"></CodeLine>
<Link id="l01318" /><CodeLine lineNumber="1318"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a7f88fbb422e5e0d5c0e227b3df0bd8a8">Indirect</a>) &#123;</span></CodeLine>
<Link id="l01319" /><CodeLine lineNumber="1319"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// This is something like an NRVO variable, where the pointer has been</span></CodeLine>
<Link id="l01320" /><CodeLine lineNumber="1320"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// spilt to the stack. It should end up being a memory location, with</span></CodeLine>
<Link id="l01321" /><CodeLine lineNumber="1321"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// the pointer to the variable loaded off the stack with a deref:</span></CodeLine>
<Link id="l01322" /><CodeLine lineNumber="1322"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!Expr-&gt;<a href="/docs/api/classes/llvm/diexpression/#a40cd3c3332ecc579f7a92924714d6d5c">isImplicit</a>());</span></CodeLine>
<Link id="l01323" /><CodeLine lineNumber="1323"><span class="doxyHighlight">          OffsetOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(dwarf::DW&#95;OP&#95;deref);</span></CodeLine>
<Link id="l01324" /><CodeLine lineNumber="1324"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (UseDerefSize &amp;&amp; Expr-&gt;<a href="/docs/api/classes/llvm/diexpression/#ac9a4fe1aa8e698aa8cd6a24751a80d91">isSingleLocationExpression</a>()) &#123;</span></CodeLine>
<Link id="l01325" /><CodeLine lineNumber="1325"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// TODO: Figure out how to handle deref size issues for variadic</span></CodeLine>
<Link id="l01326" /><CodeLine lineNumber="1326"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// values.</span></CodeLine>
<Link id="l01327" /><CodeLine lineNumber="1327"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// We&#39;re loading a value off the stack that&#39;s not the same size as the</span></CodeLine>
<Link id="l01328" /><CodeLine lineNumber="1328"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// variable. Add / subtract stack offset, explicitly deref with a</span></CodeLine>
<Link id="l01329" /><CodeLine lineNumber="1329"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// size, and add DW&#95;OP&#95;stack&#95;value if not already present.</span></CodeLine>
<Link id="l01330" /><CodeLine lineNumber="1330"><span class="doxyHighlight">          OffsetOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(dwarf::DW&#95;OP&#95;deref&#95;size);</span></CodeLine>
<Link id="l01331" /><CodeLine lineNumber="1331"><span class="doxyHighlight">          OffsetOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DerefSizeInBytes);</span></CodeLine>
<Link id="l01332" /><CodeLine lineNumber="1332"><span class="doxyHighlight">          StackValue = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01333" /><CodeLine lineNumber="1333"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Expr-&gt;<a href="/docs/api/classes/llvm/diexpression/#a7926734793677673e68d8cff410552ec">isComplex</a>() || Properties.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#aebaf15eb5116df110c1de27c5c8901a2">IsVariadic</a>) &#123;</span></CodeLine>
<Link id="l01334" /><CodeLine lineNumber="1334"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// A variable with no size ambiguity, but with extra elements in it&#39;s</span></CodeLine>
<Link id="l01335" /><CodeLine lineNumber="1335"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// expression. Manually dereference the stack location.</span></CodeLine>
<Link id="l01336" /><CodeLine lineNumber="1336"><span class="doxyHighlight">          OffsetOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(dwarf::DW&#95;OP&#95;deref);</span></CodeLine>
<Link id="l01337" /><CodeLine lineNumber="1337"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01338" /><CodeLine lineNumber="1338"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// A plain value that has been spilt to the stack, with no further</span></CodeLine>
<Link id="l01339" /><CodeLine lineNumber="1339"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// context. Request a location expression, marking the DBG&#95;VALUE as</span></CodeLine>
<Link id="l01340" /><CodeLine lineNumber="1340"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// IsIndirect.</span></CodeLine>
<Link id="l01341" /><CodeLine lineNumber="1341"><span class="doxyHighlight">          Indirect = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01342" /><CodeLine lineNumber="1342"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01343" /><CodeLine lineNumber="1343"></CodeLine>
<Link id="l01344" /><CodeLine lineNumber="1344"><span class="doxyHighlight">        Expr = <a href="/docs/api/classes/llvm/diexpression/#a5f48305fa7d23161515c94bca7c2beb6">DIExpression::appendOpsToArg</a>(Expr, OffsetOps, Idx, StackValue);</span></CodeLine>
<Link id="l01345" /><CodeLine lineNumber="1345"><span class="doxyHighlight">        MOs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(GetRegOp(<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>));</span></CodeLine>
<Link id="l01346" /><CodeLine lineNumber="1346"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01347" /><CodeLine lineNumber="1347"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// This is a stack location with a weird subregister offset: emit an</span></CodeLine>
<Link id="l01348" /><CodeLine lineNumber="1348"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// undef DBG&#95;VALUE instead.</span></CodeLine>
<Link id="l01349" /><CodeLine lineNumber="1349"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> EmitUndef();</span></CodeLine>
<Link id="l01350" /><CodeLine lineNumber="1350"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01351" /><CodeLine lineNumber="1351"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01352" /><CodeLine lineNumber="1352"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Non-empty, non-stack slot, must be a plain register.</span></CodeLine>
<Link id="l01353" /><CodeLine lineNumber="1353"><span class="doxyHighlight">      MOs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(GetRegOp(LocID));</span></CodeLine>
<Link id="l01354" /><CodeLine lineNumber="1354"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01355" /><CodeLine lineNumber="1355"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01356" /><CodeLine lineNumber="1356"></CodeLine>
<Link id="l01357" /><CodeLine lineNumber="1357"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a17e04afcf0c5efeb0eb6a9a45287b5e4">BuildMI</a>(<a href="/docs/api/classes/livedebugvalues/mloctracker/#ae1a29742ce2fd47f4b4769dfe5a44f9e">MF</a>, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>, <a href="/docs/api/namespaces/llvm/#a4de98a9acffcef5bb4b31862cb8c72ac">Desc</a>, Indirect, MOs, Var.<a href="/docs/api/classes/llvm/debugvariable/#af2ca096ab72c055f6c2c7e3ffbe5d6bf">getVariable</a>(), Expr);</span></CodeLine>
<Link id="l01358" /><CodeLine lineNumber="1358"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01359" /><CodeLine lineNumber="1359"></CodeLine>
<Link id="l01360" /><CodeLine lineNumber="1360"><span class="doxyHighlightComment">/// Default construct and initialize the pass.</span></CodeLine>
<Link id="l01361" /><CodeLine lineNumber="1361"><span class="doxyHighlight"><a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#a625f1469290a1b9bb1bc071a5392d3cb">InstrRefBasedLDV::InstrRefBasedLDV</a>() = </span><span class="doxyHighlightKeywordFlow">default</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01362" /><CodeLine lineNumber="1362"></CodeLine>
<Link id="l01363" /><CodeLine lineNumber="1363" lineLink="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ac8e3a7e9be90841c721e738db731abbf"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ac8e3a7e9be90841c721e738db731abbf">InstrRefBasedLDV::isCalleeSaved</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> L)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01364" /><CodeLine lineNumber="1364"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Reg = MTracker-&gt;LocIdxToLocID&#91;L&#93;;</span></CodeLine>
<Link id="l01365" /><CodeLine lineNumber="1365"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ad778dafd8a5d853569fe78079b6960b7">isCalleeSavedReg</a>(Reg);</span></CodeLine>
<Link id="l01366" /><CodeLine lineNumber="1366"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01367" /><CodeLine lineNumber="1367" lineLink="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ad778dafd8a5d853569fe78079b6960b7"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ad778dafd8a5d853569fe78079b6960b7">InstrRefBasedLDV::isCalleeSavedReg</a>(<a href="/docs/api/classes/llvm/register">Register</a> R)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l01368" /><CodeLine lineNumber="1368"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/mcregaliasiterator">MCRegAliasIterator</a> RAI(R, TRI, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.<a href="/docs/api/classes/llvm/mcregaliasiterator/#ac336c049c12ead7be5b86e6d046f8ab0">isValid</a>(); ++RAI)</span></CodeLine>
<Link id="l01369" /><CodeLine lineNumber="1369"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CalleeSavedRegs.test((&#42;RAI).id()))</span></CodeLine>
<Link id="l01370" /><CodeLine lineNumber="1370"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01371" /><CodeLine lineNumber="1371"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01372" /><CodeLine lineNumber="1372"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01373" /><CodeLine lineNumber="1373"></CodeLine>
<Link id="l01374" /><CodeLine lineNumber="1374"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l01375" /><CodeLine lineNumber="1375"><span class="doxyHighlightComment">//            Debug Range Extension Implementation</span></CodeLine>
<Link id="l01376" /><CodeLine lineNumber="1376"><span class="doxyHighlightComment">//===----------------------------------------------------------------------===//</span></CodeLine>
<Link id="l01377" /><CodeLine lineNumber="1377"></CodeLine>
<Link id="l01378" /><CodeLine lineNumber="1378"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l01379" /><CodeLine lineNumber="1379"><span class="doxyHighlightComment">// Something to restore in the future.</span></CodeLine>
<Link id="l01380" /><CodeLine lineNumber="1380"><span class="doxyHighlightComment">// void InstrRefBasedLDV::printVarLocInMBB(..)</span></CodeLine>
<Link id="l01381" /><CodeLine lineNumber="1381"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l01382" /><CodeLine lineNumber="1382"></CodeLine>
<Link id="l01383" /><CodeLine lineNumber="1383"><span class="doxyHighlight">std::optional&lt;SpillLocationNo&gt;</span></CodeLine>
<Link id="l01384" /><CodeLine lineNumber="1384"><span class="doxyHighlight">InstrRefBasedLDV::extractSpillBaseRegAndOffset(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l01385" /><CodeLine lineNumber="1385"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.hasOneMemOperand() &amp;&amp;</span></CodeLine>
<Link id="l01386" /><CodeLine lineNumber="1386"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Spill instruction does not have exactly one memory operand?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01387" /><CodeLine lineNumber="1387"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> MMOI = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.memoperands&#95;begin();</span></CodeLine>
<Link id="l01388" /><CodeLine lineNumber="1388"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/pseudosourcevalue">PseudoSourceValue</a> &#42;PVal = (&#42;MMOI)-&gt;getPseudoValue();</span></CodeLine>
<Link id="l01389" /><CodeLine lineNumber="1389"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(PVal-&gt;<a href="/docs/api/classes/llvm/pseudosourcevalue/#ab1969256cc373d72874932779a45b46c">kind</a>() == <a href="/docs/api/classes/llvm/pseudosourcevalue/#a9959ffdc41bc31cf2211b8824f79259eaf38d1857511c3f0404c95f65664b36ab">PseudoSourceValue::FixedStack</a> &amp;&amp;</span></CodeLine>
<Link id="l01390" /><CodeLine lineNumber="1390"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Inconsistent memory operand in spill instruction&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01391" /><CodeLine lineNumber="1391"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> FI = <a href="/docs/api/namespaces/llvm/#ac4fc845f5ed92de63cd4474f128f5fc5">cast&lt;FixedStackPseudoSourceValue&gt;</a>(PVal)-&gt;getFrameIndex();</span></CodeLine>
<Link id="l01392" /><CodeLine lineNumber="1392"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent();</span></CodeLine>
<Link id="l01393" /><CodeLine lineNumber="1393"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/register">Register</a> Reg;</span></CodeLine>
<Link id="l01394" /><CodeLine lineNumber="1394"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/stackoffset">StackOffset</a> <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = TFI-&gt;<a href="/docs/api/classes/llvm/targetframelowering/#af88a8f2328543f94aea3ba85d954fafa">getFrameIndexReference</a>(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;getParent(), FI, Reg);</span></CodeLine>
<Link id="l01395" /><CodeLine lineNumber="1395"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> MTracker-&gt;<a href="/docs/api/classes/livedebugvalues/mloctracker/#a0ec8c44bc2b0efa41c2a6583f9d75f21">getOrTrackSpillLoc</a>(&#123;Reg, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>&#125;);</span></CodeLine>
<Link id="l01396" /><CodeLine lineNumber="1396"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01397" /><CodeLine lineNumber="1397"></CodeLine>
<Link id="l01398" /><CodeLine lineNumber="1398"><span class="doxyHighlight">std::optional&lt;LocIdx&gt;</span></CodeLine>
<Link id="l01399" /><CodeLine lineNumber="1399" lineLink="/docs/api/classes/livedebugvalues/instrrefbasedldv/#a3c1165eb09769fbc90612ff41c1830b3"><span class="doxyHighlight"><a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#a3c1165eb09769fbc90612ff41c1830b3">InstrRefBasedLDV::findLocationForMemOperand</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l01400" /><CodeLine lineNumber="1400"><span class="doxyHighlight">  std::optional&lt;SpillLocationNo&gt; <a href="/docs/api/structs/livedebugvalues/spillloc">SpillLoc</a> = extractSpillBaseRegAndOffset(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l01401" /><CodeLine lineNumber="1401"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/structs/livedebugvalues/spillloc">SpillLoc</a>)</span></CodeLine>
<Link id="l01402" /><CodeLine lineNumber="1402"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l01403" /><CodeLine lineNumber="1403"></CodeLine>
<Link id="l01404" /><CodeLine lineNumber="1404"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Where in the stack slot is this value defined -- i.e., what size of value</span></CodeLine>
<Link id="l01405" /><CodeLine lineNumber="1405"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is this? An important question, because it could be loaded into a register</span></CodeLine>
<Link id="l01406" /><CodeLine lineNumber="1406"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// from the stack at some point. Happily the memory operand will tell us</span></CodeLine>
<Link id="l01407" /><CodeLine lineNumber="1407"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the size written to the stack.</span></CodeLine>
<Link id="l01408" /><CodeLine lineNumber="1408"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;MemOperand = &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.memoperands&#95;begin();</span></CodeLine>
<Link id="l01409" /><CodeLine lineNumber="1409"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/locationsize">LocationSize</a> SizeInBits = MemOperand-&gt;getSizeInBits();</span></CodeLine>
<Link id="l01410" /><CodeLine lineNumber="1410"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(SizeInBits.<a href="/docs/api/classes/llvm/locationsize/#a0b0401973fc9567440717a5d32a8eb8d">hasValue</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Expected to find a valid size!&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01411" /><CodeLine lineNumber="1411"></CodeLine>
<Link id="l01412" /><CodeLine lineNumber="1412"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Find that position in the stack indexes we&#39;re tracking.</span></CodeLine>
<Link id="l01413" /><CodeLine lineNumber="1413"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> IdxIt = MTracker-&gt;StackSlotIdxes.find(&#123;SizeInBits.<a href="/docs/api/classes/llvm/locationsize/#a935a116f6c8690449f4eddd56a99504b">getValue</a>(), 0&#125;);</span></CodeLine>
<Link id="l01414" /><CodeLine lineNumber="1414"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IdxIt == MTracker-&gt;StackSlotIdxes.end())</span></CodeLine>
<Link id="l01415" /><CodeLine lineNumber="1415"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// That index is not tracked. This is suprising, and unlikely to ever</span></CodeLine>
<Link id="l01416" /><CodeLine lineNumber="1416"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// occur, but the safe action is to indicate the variable is optimised out.</span></CodeLine>
<Link id="l01417" /><CodeLine lineNumber="1417"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l01418" /><CodeLine lineNumber="1418"></CodeLine>
<Link id="l01419" /><CodeLine lineNumber="1419"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getSpillIDWithIdx(&#42;<a href="/docs/api/structs/livedebugvalues/spillloc">SpillLoc</a>, IdxIt-&gt;second);</span></CodeLine>
<Link id="l01420" /><CodeLine lineNumber="1420"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> MTracker-&gt;getSpillMLoc(SpillID);</span></CodeLine>
<Link id="l01421" /><CodeLine lineNumber="1421"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01422" /><CodeLine lineNumber="1422"></CodeLine>
<Link id="l01423" /><CodeLine lineNumber="1423"><span class="doxyHighlightComment">/// End all previous ranges related to @MI and start a new range from @MI</span></CodeLine>
<Link id="l01424" /><CodeLine lineNumber="1424"><span class="doxyHighlightComment">/// if it is a DBG&#95;VALUE instr.</span></CodeLine>
<Link id="l01425" /><CodeLine lineNumber="1425"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::transferDebugValue(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l01426" /><CodeLine lineNumber="1426"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugValue())</span></CodeLine>
<Link id="l01427" /><CodeLine lineNumber="1427"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01428" /><CodeLine lineNumber="1428"></CodeLine>
<Link id="l01429" /><CodeLine lineNumber="1429"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugVariable()-&gt;isValidLocationForIntrinsic(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc()) &amp;&amp;</span></CodeLine>
<Link id="l01430" /><CodeLine lineNumber="1430"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Expected inlined-at fields to agree&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01431" /><CodeLine lineNumber="1431"></CodeLine>
<Link id="l01432" /><CodeLine lineNumber="1432"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there are no instructions in this lexical scope, do no location tracking</span></CodeLine>
<Link id="l01433" /><CodeLine lineNumber="1433"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// at all, this variable shouldn&#39;t get a legitimate location range.</span></CodeLine>
<Link id="l01434" /><CodeLine lineNumber="1434"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;Scope = LS.<a href="/docs/api/classes/llvm/lexicalscopes/#a3245044b58379359df4673c0ed9308b0">findLexicalScope</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc().get());</span></CodeLine>
<Link id="l01435" /><CodeLine lineNumber="1435"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Scope == </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l01436" /><CodeLine lineNumber="1436"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">; </span><span class="doxyHighlightComment">// handled it; by doing nothing</span></CodeLine>
<Link id="l01437" /><CodeLine lineNumber="1437"></CodeLine>
<Link id="l01438" /><CodeLine lineNumber="1438"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// MLocTracker needs to know that this register is read, even if it&#39;s only</span></CodeLine>
<Link id="l01439" /><CodeLine lineNumber="1439"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// read by a debug inst.</span></CodeLine>
<Link id="l01440" /><CodeLine lineNumber="1440"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.debug&#95;operands())</span></CodeLine>
<Link id="l01441" /><CodeLine lineNumber="1441"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.isReg() &amp;&amp; MO.getReg() != 0)</span></CodeLine>
<Link id="l01442" /><CodeLine lineNumber="1442"><span class="doxyHighlight">      (void)MTracker-&gt;<a href="/docs/api/classes/livedebugvalues/mloctracker/#acb5a8547e6be549b193c89c9202889df">readReg</a>(MO.getReg());</span></CodeLine>
<Link id="l01443" /><CodeLine lineNumber="1443"></CodeLine>
<Link id="l01444" /><CodeLine lineNumber="1444"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we&#39;re preparing for the second analysis (variables), the machine value</span></CodeLine>
<Link id="l01445" /><CodeLine lineNumber="1445"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// locations are already solved, and we report this DBG&#95;VALUE and the value</span></CodeLine>
<Link id="l01446" /><CodeLine lineNumber="1446"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// it refers to to VLocTracker.</span></CodeLine>
<Link id="l01447" /><CodeLine lineNumber="1447"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VTracker) &#123;</span></CodeLine>
<Link id="l01448" /><CodeLine lineNumber="1448"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;DbgOpID&gt;</a> DebugOps;</span></CodeLine>
<Link id="l01449" /><CodeLine lineNumber="1449"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Feed defVar the new variable location, or if this is a DBG&#95;VALUE $noreg,</span></CodeLine>
<Link id="l01450" /><CodeLine lineNumber="1450"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// feed defVar None.</span></CodeLine>
<Link id="l01451" /><CodeLine lineNumber="1451"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isUndefDebugValue()) &#123;</span></CodeLine>
<Link id="l01452" /><CodeLine lineNumber="1452"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineoperand">MachineOperand</a> &amp;MO : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.debug&#95;operands()) &#123;</span></CodeLine>
<Link id="l01453" /><CodeLine lineNumber="1453"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// There should be no undef registers here, as we&#39;ve screened for undef</span></CodeLine>
<Link id="l01454" /><CodeLine lineNumber="1454"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// debug values.</span></CodeLine>
<Link id="l01455" /><CodeLine lineNumber="1455"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.isReg()) &#123;</span></CodeLine>
<Link id="l01456" /><CodeLine lineNumber="1456"><span class="doxyHighlight">          DebugOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DbgOpStore.<a href="/docs/api/classes/livedebugvalues/dbgopidmap/#a31b80daf003f8250c14e14fbb5d9a283">insert</a>(MTracker-&gt;<a href="/docs/api/classes/livedebugvalues/mloctracker/#acb5a8547e6be549b193c89c9202889df">readReg</a>(MO.getReg())));</span></CodeLine>
<Link id="l01457" /><CodeLine lineNumber="1457"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.isImm() || MO.isFPImm() || MO.isCImm()) &#123;</span></CodeLine>
<Link id="l01458" /><CodeLine lineNumber="1458"><span class="doxyHighlight">          DebugOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DbgOpStore.<a href="/docs/api/classes/livedebugvalues/dbgopidmap/#a31b80daf003f8250c14e14fbb5d9a283">insert</a>(MO));</span></CodeLine>
<Link id="l01459" /><CodeLine lineNumber="1459"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01460" /><CodeLine lineNumber="1460"><span class="doxyHighlight">          <a href="/docs/api/files/include/include/llvm/include/llvm/support/errorhandling-h/#ace243f5c25697a1107cce46626b3dc94">llvm&#95;unreachable</a>(</span><span class="doxyHighlightStringLiteral">&quot;Unexpected debug operand type.&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01461" /><CodeLine lineNumber="1461"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01462" /><CodeLine lineNumber="1462"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01463" /><CodeLine lineNumber="1463"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01464" /><CodeLine lineNumber="1464"><span class="doxyHighlight">    VTracker-&gt;defVar(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, DbgValueProperties(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>), DebugOps);</span></CodeLine>
<Link id="l01465" /><CodeLine lineNumber="1465"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01466" /><CodeLine lineNumber="1466"></CodeLine>
<Link id="l01467" /><CodeLine lineNumber="1467"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If performing final tracking of transfers, report this variable definition</span></CodeLine>
<Link id="l01468" /><CodeLine lineNumber="1468"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to the TransferTracker too.</span></CodeLine>
<Link id="l01469" /><CodeLine lineNumber="1469"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TTracker)</span></CodeLine>
<Link id="l01470" /><CodeLine lineNumber="1470"><span class="doxyHighlight">    TTracker-&gt;redefVar(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l01471" /><CodeLine lineNumber="1471"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01472" /><CodeLine lineNumber="1472"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01473" /><CodeLine lineNumber="1473"></CodeLine>
<Link id="l01474" /><CodeLine lineNumber="1474"><span class="doxyHighlight">std::optional&lt;ValueIDNum&gt; InstrRefBasedLDV::getValueForInstrRef(</span></CodeLine>
<Link id="l01475" /><CodeLine lineNumber="1475"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> InstNo, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> OpNo, <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</span></CodeLine>
<Link id="l01476" /><CodeLine lineNumber="1476"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &#42;MLiveOuts, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &#42;MLiveIns) &#123;</span></CodeLine>
<Link id="l01477" /><CodeLine lineNumber="1477"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Various optimizations may have happened to the value during codegen,</span></CodeLine>
<Link id="l01478" /><CodeLine lineNumber="1478"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// recorded in the value substitution table. Apply any substitutions to</span></CodeLine>
<Link id="l01479" /><CodeLine lineNumber="1479"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the instruction / operand number in this DBG&#95;INSTR&#95;REF, and collect</span></CodeLine>
<Link id="l01480" /><CodeLine lineNumber="1480"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// any subregister extractions performed during optimization.</span></CodeLine>
<Link id="l01481" /><CodeLine lineNumber="1481"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineFunction &amp;MF = &#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;getParent();</span></CodeLine>
<Link id="l01482" /><CodeLine lineNumber="1482"></CodeLine>
<Link id="l01483" /><CodeLine lineNumber="1483"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Create dummy substitution with Src set, for lookup.</span></CodeLine>
<Link id="l01484" /><CodeLine lineNumber="1484"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> SoughtSub =</span></CodeLine>
<Link id="l01485" /><CodeLine lineNumber="1485"><span class="doxyHighlight">      MachineFunction::DebugSubstitution(&#123;InstNo, OpNo&#125;, &#123;0, 0&#125;, 0);</span></CodeLine>
<Link id="l01486" /><CodeLine lineNumber="1486"></CodeLine>
<Link id="l01487" /><CodeLine lineNumber="1487"><span class="doxyHighlight">  SmallVector&lt;unsigned, 4&gt; SeenSubregs;</span></CodeLine>
<Link id="l01488" /><CodeLine lineNumber="1488"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LowerBoundIt = <a href="/docs/api/namespaces/llvm/#aa81eb67f09ee4944eaeeddbc54c0c0de">llvm::lower&#95;bound</a>(MF.<a href="/docs/api/classes/llvm/machinefunction/#a27e242bef133e4b324f5b96791fc5c60">DebugValueSubstitutions</a>, SoughtSub);</span></CodeLine>
<Link id="l01489" /><CodeLine lineNumber="1489"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (LowerBoundIt != MF.<a href="/docs/api/classes/llvm/machinefunction/#a27e242bef133e4b324f5b96791fc5c60">DebugValueSubstitutions</a>.end() &amp;&amp;</span></CodeLine>
<Link id="l01490" /><CodeLine lineNumber="1490"><span class="doxyHighlight">         LowerBoundIt-&gt;Src == SoughtSub.Src) &#123;</span></CodeLine>
<Link id="l01491" /><CodeLine lineNumber="1491"><span class="doxyHighlight">    std::tie(InstNo, OpNo) = LowerBoundIt-&gt;Dest;</span></CodeLine>
<Link id="l01492" /><CodeLine lineNumber="1492"><span class="doxyHighlight">    SoughtSub.Src = LowerBoundIt-&gt;Dest;</span></CodeLine>
<Link id="l01493" /><CodeLine lineNumber="1493"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Subreg = LowerBoundIt-&gt;Subreg)</span></CodeLine>
<Link id="l01494" /><CodeLine lineNumber="1494"><span class="doxyHighlight">      SeenSubregs.push&#95;back(Subreg);</span></CodeLine>
<Link id="l01495" /><CodeLine lineNumber="1495"><span class="doxyHighlight">    LowerBoundIt = <a href="/docs/api/namespaces/llvm/#aa81eb67f09ee4944eaeeddbc54c0c0de">llvm::lower&#95;bound</a>(MF.<a href="/docs/api/classes/llvm/machinefunction/#a27e242bef133e4b324f5b96791fc5c60">DebugValueSubstitutions</a>, SoughtSub);</span></CodeLine>
<Link id="l01496" /><CodeLine lineNumber="1496"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01497" /><CodeLine lineNumber="1497"></CodeLine>
<Link id="l01498" /><CodeLine lineNumber="1498"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Default machine value number is &lt;None&gt; -- if no instruction defines</span></CodeLine>
<Link id="l01499" /><CodeLine lineNumber="1499"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the corresponding value, it must have been optimized out.</span></CodeLine>
<Link id="l01500" /><CodeLine lineNumber="1500"><span class="doxyHighlight">  std::optional&lt;ValueIDNum&gt; NewID;</span></CodeLine>
<Link id="l01501" /><CodeLine lineNumber="1501"></CodeLine>
<Link id="l01502" /><CodeLine lineNumber="1502"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Try to lookup the instruction number, and find the machine value number</span></CodeLine>
<Link id="l01503" /><CodeLine lineNumber="1503"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that it defines. It could be an instruction, or a PHI.</span></CodeLine>
<Link id="l01504" /><CodeLine lineNumber="1504"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> InstrIt = DebugInstrNumToInstr.find(InstNo);</span></CodeLine>
<Link id="l01505" /><CodeLine lineNumber="1505"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> PHIIt = <a href="/docs/api/namespaces/llvm/#aa81eb67f09ee4944eaeeddbc54c0c0de">llvm::lower&#95;bound</a>(DebugPHINumToValue, InstNo);</span></CodeLine>
<Link id="l01506" /><CodeLine lineNumber="1506"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InstrIt != DebugInstrNumToInstr.end()) &#123;</span></CodeLine>
<Link id="l01507" /><CodeLine lineNumber="1507"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineInstr &amp;TargetInstr = &#42;InstrIt-&gt;second.first;</span></CodeLine>
<Link id="l01508" /><CodeLine lineNumber="1508"><span class="doxyHighlight">    uint64&#95;t BlockNo = TargetInstr.<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>()-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>();</span></CodeLine>
<Link id="l01509" /><CodeLine lineNumber="1509"></CodeLine>
<Link id="l01510" /><CodeLine lineNumber="1510"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Pick out the designated operand. It might be a memory reference, if</span></CodeLine>
<Link id="l01511" /><CodeLine lineNumber="1511"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// a register def was folded into a stack store.</span></CodeLine>
<Link id="l01512" /><CodeLine lineNumber="1512"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OpNo == <a href="/docs/api/classes/llvm/machinefunction/#a8f72614046d13d67b12a1e9201744ea8">MachineFunction::DebugOperandMemNumber</a> &amp;&amp;</span></CodeLine>
<Link id="l01513" /><CodeLine lineNumber="1513"><span class="doxyHighlight">        TargetInstr.<a href="/docs/api/classes/llvm/machineinstr/#a999795324f5e7c578a97992d780080f1">hasOneMemOperand</a>()) &#123;</span></CodeLine>
<Link id="l01514" /><CodeLine lineNumber="1514"><span class="doxyHighlight">      std::optional&lt;LocIdx&gt; <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#a3c1165eb09769fbc90612ff41c1830b3">findLocationForMemOperand</a>(TargetInstr);</span></CodeLine>
<Link id="l01515" /><CodeLine lineNumber="1515"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (L)</span></CodeLine>
<Link id="l01516" /><CodeLine lineNumber="1516"><span class="doxyHighlight">        NewID = ValueIDNum(BlockNo, InstrIt-&gt;second.second, &#42;L);</span></CodeLine>
<Link id="l01517" /><CodeLine lineNumber="1517"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OpNo != <a href="/docs/api/classes/llvm/machinefunction/#a8f72614046d13d67b12a1e9201744ea8">MachineFunction::DebugOperandMemNumber</a>) &#123;</span></CodeLine>
<Link id="l01518" /><CodeLine lineNumber="1518"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Permit the debug-info to be completely wrong: identifying a nonexistant</span></CodeLine>
<Link id="l01519" /><CodeLine lineNumber="1519"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// operand, or one that is not a register definition, means something</span></CodeLine>
<Link id="l01520" /><CodeLine lineNumber="1520"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// unexpected happened during optimisation. Broken debug-info, however,</span></CodeLine>
<Link id="l01521" /><CodeLine lineNumber="1521"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// shouldn&#39;t crash the compiler -- instead leave the variable value as</span></CodeLine>
<Link id="l01522" /><CodeLine lineNumber="1522"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// None, which will make it appear &quot;optimised out&quot;.</span></CodeLine>
<Link id="l01523" /><CodeLine lineNumber="1523"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OpNo &lt; TargetInstr.<a href="/docs/api/classes/llvm/machineinstr/#a432824f0975bb863478bf4ef3a5df258">getNumOperands</a>()) &#123;</span></CodeLine>
<Link id="l01524" /><CodeLine lineNumber="1524"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineOperand &amp;MO = TargetInstr.<a href="/docs/api/classes/llvm/machineinstr/#ad67c9230577a0b640c52852c75c93939">getOperand</a>(OpNo);</span></CodeLine>
<Link id="l01525" /><CodeLine lineNumber="1525"></CodeLine>
<Link id="l01526" /><CodeLine lineNumber="1526"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#a75eb135014670ce946e78739cdc9b51b">isDef</a>() &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()) &#123;</span></CodeLine>
<Link id="l01527" /><CodeLine lineNumber="1527"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> LocID = MTracker-&gt;getLocID(MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>());</span></CodeLine>
<Link id="l01528" /><CodeLine lineNumber="1528"><span class="doxyHighlight">          LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = MTracker-&gt;LocIDToLocIdx&#91;LocID&#93;;</span></CodeLine>
<Link id="l01529" /><CodeLine lineNumber="1529"><span class="doxyHighlight">          NewID = ValueIDNum(BlockNo, InstrIt-&gt;second.second, L);</span></CodeLine>
<Link id="l01530" /><CodeLine lineNumber="1530"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01531" /><CodeLine lineNumber="1531"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01532" /><CodeLine lineNumber="1532"></CodeLine>
<Link id="l01533" /><CodeLine lineNumber="1533"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewID) &#123;</span></CodeLine>
<Link id="l01534" /><CodeLine lineNumber="1534"><span class="doxyHighlight">        <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l01535" /><CodeLine lineNumber="1535"><span class="doxyHighlight">            &#123; <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Seen instruction reference to illegal operand\\n&quot;</span><span class="doxyHighlight">; &#125;);</span></CodeLine>
<Link id="l01536" /><CodeLine lineNumber="1536"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01537" /><CodeLine lineNumber="1537"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01538" /><CodeLine lineNumber="1538"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// else: NewID is left as None.</span></CodeLine>
<Link id="l01539" /><CodeLine lineNumber="1539"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PHIIt != DebugPHINumToValue.end() &amp;&amp; PHIIt-&gt;InstrNum == InstNo) &#123;</span></CodeLine>
<Link id="l01540" /><CodeLine lineNumber="1540"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// It&#39;s actually a PHI value. Which value it is might not be obvious, use</span></CodeLine>
<Link id="l01541" /><CodeLine lineNumber="1541"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the resolver helper to find out.</span></CodeLine>
<Link id="l01542" /><CodeLine lineNumber="1542"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(MLiveOuts &amp;&amp; MLiveIns);</span></CodeLine>
<Link id="l01543" /><CodeLine lineNumber="1543"><span class="doxyHighlight">    NewID = resolveDbgPHIs(&#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent()-&gt;getParent(), &#42;MLiveOuts, &#42;MLiveIns,</span></CodeLine>
<Link id="l01544" /><CodeLine lineNumber="1544"><span class="doxyHighlight">                           <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, InstNo);</span></CodeLine>
<Link id="l01545" /><CodeLine lineNumber="1545"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01546" /><CodeLine lineNumber="1546"></CodeLine>
<Link id="l01547" /><CodeLine lineNumber="1547"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Apply any subregister extractions, in reverse. We might have seen code</span></CodeLine>
<Link id="l01548" /><CodeLine lineNumber="1548"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// like this:</span></CodeLine>
<Link id="l01549" /><CodeLine lineNumber="1549"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    CALL64 @foo, implicit-def $rax</span></CodeLine>
<Link id="l01550" /><CodeLine lineNumber="1550"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    %0:gr64 = COPY $rax</span></CodeLine>
<Link id="l01551" /><CodeLine lineNumber="1551"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    %1:gr32 = COPY %0.sub&#95;32bit</span></CodeLine>
<Link id="l01552" /><CodeLine lineNumber="1552"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    %2:gr16 = COPY %1.sub&#95;16bit</span></CodeLine>
<Link id="l01553" /><CodeLine lineNumber="1553"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    %3:gr8  = COPY %2.sub&#95;8bit</span></CodeLine>
<Link id="l01554" /><CodeLine lineNumber="1554"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// In which case each copy would have been recorded as a substitution with</span></CodeLine>
<Link id="l01555" /><CodeLine lineNumber="1555"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// a subregister qualifier. Apply those qualifiers now.</span></CodeLine>
<Link id="l01556" /><CodeLine lineNumber="1556"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewID &amp;&amp; !SeenSubregs.empty()) &#123;</span></CodeLine>
<Link id="l01557" /><CodeLine lineNumber="1557"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> = 0;</span></CodeLine>
<Link id="l01558" /><CodeLine lineNumber="1558"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = 0;</span></CodeLine>
<Link id="l01559" /><CodeLine lineNumber="1559"></CodeLine>
<Link id="l01560" /><CodeLine lineNumber="1560"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Look at each subregister that we passed through, and progressively</span></CodeLine>
<Link id="l01561" /><CodeLine lineNumber="1561"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// narrow in, accumulating any offsets that occur. Substitutions should</span></CodeLine>
<Link id="l01562" /><CodeLine lineNumber="1562"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// only ever be the same or narrower width than what they read from;</span></CodeLine>
<Link id="l01563" /><CodeLine lineNumber="1563"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// iterate in reverse order so that we go from wide to small.</span></CodeLine>
<Link id="l01564" /><CodeLine lineNumber="1564"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Subreg : <a href="/docs/api/namespaces/llvm/#a6b0ac1fa4f05de76413c5e0ca6334035">reverse</a>(SeenSubregs)) &#123;</span></CodeLine>
<Link id="l01565" /><CodeLine lineNumber="1565"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ThisSize = TRI-&gt;getSubRegIdxSize(Subreg);</span></CodeLine>
<Link id="l01566" /><CodeLine lineNumber="1566"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ThisOffset = TRI-&gt;getSubRegIdxOffset(Subreg);</span></CodeLine>
<Link id="l01567" /><CodeLine lineNumber="1567"><span class="doxyHighlight">      <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> += ThisOffset;</span></CodeLine>
<Link id="l01568" /><CodeLine lineNumber="1568"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = (<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> == 0) ? ThisSize : std::min(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, ThisSize);</span></CodeLine>
<Link id="l01569" /><CodeLine lineNumber="1569"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01570" /><CodeLine lineNumber="1570"></CodeLine>
<Link id="l01571" /><CodeLine lineNumber="1571"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If that worked, look for an appropriate subregister with the register</span></CodeLine>
<Link id="l01572" /><CodeLine lineNumber="1572"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// where the define happens. Don&#39;t look at values that were defined during</span></CodeLine>
<Link id="l01573" /><CodeLine lineNumber="1573"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// a stack write: we can&#39;t currently express register locations within</span></CodeLine>
<Link id="l01574" /><CodeLine lineNumber="1574"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// spills.</span></CodeLine>
<Link id="l01575" /><CodeLine lineNumber="1575"><span class="doxyHighlight">    LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = NewID-&gt;getLoc();</span></CodeLine>
<Link id="l01576" /><CodeLine lineNumber="1576"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewID &amp;&amp; !MTracker-&gt;isSpill(L)) &#123;</span></CodeLine>
<Link id="l01577" /><CodeLine lineNumber="1577"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Find the register class for the register where this def happened.</span></CodeLine>
<Link id="l01578" /><CodeLine lineNumber="1578"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// FIXME: no index for this?</span></CodeLine>
<Link id="l01579" /><CodeLine lineNumber="1579"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> = MTracker-&gt;LocIdxToLocID&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>&#93;;</span></CodeLine>
<Link id="l01580" /><CodeLine lineNumber="1580"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> TargetRegisterClass &#42;TRC = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01581" /><CodeLine lineNumber="1581"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;TRCI : TRI-&gt;regclasses())</span></CodeLine>
<Link id="l01582" /><CodeLine lineNumber="1582"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TRCI-&gt;contains(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01583" /><CodeLine lineNumber="1583"><span class="doxyHighlight">          TRC = TRCI;</span></CodeLine>
<Link id="l01584" /><CodeLine lineNumber="1584"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(TRC &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Couldn&#39;t find target register class?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01585" /><CodeLine lineNumber="1585"></CodeLine>
<Link id="l01586" /><CodeLine lineNumber="1586"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If the register we have isn&#39;t the right size or in the right place,</span></CodeLine>
<Link id="l01587" /><CodeLine lineNumber="1587"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Try to find a subregister inside it.</span></CodeLine>
<Link id="l01588" /><CodeLine lineNumber="1588"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> MainRegSize = TRI-&gt;getRegSizeInBits(&#42;TRC);</span></CodeLine>
<Link id="l01589" /><CodeLine lineNumber="1589"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> != MainRegSize || <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &#123;</span></CodeLine>
<Link id="l01590" /><CodeLine lineNumber="1590"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Enumerate all subregisters, searching.</span></CodeLine>
<Link id="l01591" /><CodeLine lineNumber="1591"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> NewReg = 0;</span></CodeLine>
<Link id="l01592" /><CodeLine lineNumber="1592"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aad72cfbb210808985a9dc19f4e5d8542">MCPhysReg</a> SR : TRI-&gt;subregs(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</span></CodeLine>
<Link id="l01593" /><CodeLine lineNumber="1593"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Subreg = TRI-&gt;getSubRegIndex(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, SR);</span></CodeLine>
<Link id="l01594" /><CodeLine lineNumber="1594"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubregSize = TRI-&gt;getSubRegIdxSize(Subreg);</span></CodeLine>
<Link id="l01595" /><CodeLine lineNumber="1595"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubregOffset = TRI-&gt;getSubRegIdxOffset(Subreg);</span></CodeLine>
<Link id="l01596" /><CodeLine lineNumber="1596"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SubregSize == <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> &amp;&amp; SubregOffset == <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) &#123;</span></CodeLine>
<Link id="l01597" /><CodeLine lineNumber="1597"><span class="doxyHighlight">            NewReg = SR;</span></CodeLine>
<Link id="l01598" /><CodeLine lineNumber="1598"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01599" /><CodeLine lineNumber="1599"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l01600" /><CodeLine lineNumber="1600"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01601" /><CodeLine lineNumber="1601"></CodeLine>
<Link id="l01602" /><CodeLine lineNumber="1602"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If we didn&#39;t find anything: there&#39;s no way to express our value.</span></CodeLine>
<Link id="l01603" /><CodeLine lineNumber="1603"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!NewReg) &#123;</span></CodeLine>
<Link id="l01604" /><CodeLine lineNumber="1604"><span class="doxyHighlight">          NewID = std::nullopt;</span></CodeLine>
<Link id="l01605" /><CodeLine lineNumber="1605"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01606" /><CodeLine lineNumber="1606"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Re-state the value as being defined within the subregister</span></CodeLine>
<Link id="l01607" /><CodeLine lineNumber="1607"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// that we found.</span></CodeLine>
<Link id="l01608" /><CodeLine lineNumber="1608"><span class="doxyHighlight">          LocIdx NewLoc = MTracker-&gt;lookupOrTrackRegister(NewReg);</span></CodeLine>
<Link id="l01609" /><CodeLine lineNumber="1609"><span class="doxyHighlight">          NewID = ValueIDNum(NewID-&gt;getBlock(), NewID-&gt;getInst(), NewLoc);</span></CodeLine>
<Link id="l01610" /><CodeLine lineNumber="1610"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l01611" /><CodeLine lineNumber="1611"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01612" /><CodeLine lineNumber="1612"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01613" /><CodeLine lineNumber="1613"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If we can&#39;t handle subregisters, unset the new value.</span></CodeLine>
<Link id="l01614" /><CodeLine lineNumber="1614"><span class="doxyHighlight">      NewID = std::nullopt;</span></CodeLine>
<Link id="l01615" /><CodeLine lineNumber="1615"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01616" /><CodeLine lineNumber="1616"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01617" /><CodeLine lineNumber="1617"></CodeLine>
<Link id="l01618" /><CodeLine lineNumber="1618"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> NewID;</span></CodeLine>
<Link id="l01619" /><CodeLine lineNumber="1619"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01620" /><CodeLine lineNumber="1620"></CodeLine>
<Link id="l01621" /><CodeLine lineNumber="1621"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::transferDebugInstrRef(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</span></CodeLine>
<Link id="l01622" /><CodeLine lineNumber="1622"><span class="doxyHighlight">                                             </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &#42;MLiveOuts,</span></CodeLine>
<Link id="l01623" /><CodeLine lineNumber="1623"><span class="doxyHighlight">                                             </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &#42;MLiveIns) &#123;</span></CodeLine>
<Link id="l01624" /><CodeLine lineNumber="1624"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugRef())</span></CodeLine>
<Link id="l01625" /><CodeLine lineNumber="1625"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01626" /><CodeLine lineNumber="1626"></CodeLine>
<Link id="l01627" /><CodeLine lineNumber="1627"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Only handle this instruction when we are building the variable value</span></CodeLine>
<Link id="l01628" /><CodeLine lineNumber="1628"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// transfer function.</span></CodeLine>
<Link id="l01629" /><CodeLine lineNumber="1629"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!VTracker &amp;&amp; !TTracker)</span></CodeLine>
<Link id="l01630" /><CodeLine lineNumber="1630"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01631" /><CodeLine lineNumber="1631"></CodeLine>
<Link id="l01632" /><CodeLine lineNumber="1632"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DILocalVariable &#42;Var = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugVariable();</span></CodeLine>
<Link id="l01633" /><CodeLine lineNumber="1633"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DIExpression &#42;Expr = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugExpression();</span></CodeLine>
<Link id="l01634" /><CodeLine lineNumber="1634"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DILocation &#42;<a href="/docs/api/namespaces/llvm/dwarf-linker/#a463a58e257d5f6fb2c39eb9a2474fc24ac2e06fc138163b7095fa483616a0a47a">DebugLoc</a> = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc();</span></CodeLine>
<Link id="l01635" /><CodeLine lineNumber="1635"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DILocation &#42;InlinedAt = <a href="/docs/api/namespaces/llvm/dwarf-linker/#a463a58e257d5f6fb2c39eb9a2474fc24ac2e06fc138163b7095fa483616a0a47a">DebugLoc</a>-&gt;getInlinedAt();</span></CodeLine>
<Link id="l01636" /><CodeLine lineNumber="1636"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Var-&gt;<a href="/docs/api/classes/llvm/dilocalvariable/#ac8c4cb4dde7067286d3e3ce80bf77224">isValidLocationForIntrinsic</a>(<a href="/docs/api/namespaces/llvm/dwarf-linker/#a463a58e257d5f6fb2c39eb9a2474fc24ac2e06fc138163b7095fa483616a0a47a">DebugLoc</a>) &amp;&amp;</span></CodeLine>
<Link id="l01637" /><CodeLine lineNumber="1637"><span class="doxyHighlight">         </span><span class="doxyHighlightStringLiteral">&quot;Expected inlined-at fields to agree&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01638" /><CodeLine lineNumber="1638"></CodeLine>
<Link id="l01639" /><CodeLine lineNumber="1639"><span class="doxyHighlight">  DebugVariable <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>(Var, Expr, InlinedAt);</span></CodeLine>
<Link id="l01640" /><CodeLine lineNumber="1640"></CodeLine>
<Link id="l01641" /><CodeLine lineNumber="1641"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/namespaces/llvm/jitlink/#adb322dc6826cf005531ccfdf666260fd">Scope</a> = LS.findLexicalScope(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc().get());</span></CodeLine>
<Link id="l01642" /><CodeLine lineNumber="1642"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Scope == </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">)</span></CodeLine>
<Link id="l01643" /><CodeLine lineNumber="1643"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">; </span><span class="doxyHighlightComment">// Handled by doing nothing. This variable is never in scope.</span></CodeLine>
<Link id="l01644" /><CodeLine lineNumber="1644"></CodeLine>
<Link id="l01645" /><CodeLine lineNumber="1645"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;DbgOpID&gt;</a> DbgOpIDs;</span></CodeLine>
<Link id="l01646" /><CodeLine lineNumber="1646"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineOperand &amp;MO : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.debug&#95;operands()) &#123;</span></CodeLine>
<Link id="l01647" /><CodeLine lineNumber="1647"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!MO.<a href="/docs/api/classes/llvm/machineoperand/#ad04e186512436ffdefdb16ed8aaea57a">isDbgInstrRef</a>()) &#123;</span></CodeLine>
<Link id="l01648" /><CodeLine lineNumber="1648"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!MO.<a href="/docs/api/classes/llvm/machineoperand/#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;DBG&#95;INSTR&#95;REF should not contain registers&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01649" /><CodeLine lineNumber="1649"><span class="doxyHighlight">      DbgOpID ConstOpID = DbgOpStore.insert(DbgOp(MO));</span></CodeLine>
<Link id="l01650" /><CodeLine lineNumber="1650"><span class="doxyHighlight">      DbgOpIDs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(ConstOpID);</span></CodeLine>
<Link id="l01651" /><CodeLine lineNumber="1651"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01652" /><CodeLine lineNumber="1652"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01653" /><CodeLine lineNumber="1653"></CodeLine>
<Link id="l01654" /><CodeLine lineNumber="1654"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> InstNo = MO.<a href="/docs/api/classes/llvm/machineoperand/#a3ac9865fa1ab348b64b4366cfe103f74">getInstrRefInstrIndex</a>();</span></CodeLine>
<Link id="l01655" /><CodeLine lineNumber="1655"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> OpNo = MO.<a href="/docs/api/classes/llvm/machineoperand/#a082167d36582dece9770d881292f5cf6">getInstrRefOpIndex</a>();</span></CodeLine>
<Link id="l01656" /><CodeLine lineNumber="1656"></CodeLine>
<Link id="l01657" /><CodeLine lineNumber="1657"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Default machine value number is &lt;None&gt; -- if no instruction defines</span></CodeLine>
<Link id="l01658" /><CodeLine lineNumber="1658"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the corresponding value, it must have been optimized out.</span></CodeLine>
<Link id="l01659" /><CodeLine lineNumber="1659"><span class="doxyHighlight">    std::optional&lt;ValueIDNum&gt; NewID =</span></CodeLine>
<Link id="l01660" /><CodeLine lineNumber="1660"><span class="doxyHighlight">        getValueForInstrRef(InstNo, OpNo, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, MLiveOuts, MLiveIns);</span></CodeLine>
<Link id="l01661" /><CodeLine lineNumber="1661"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We have a value number or std::nullopt. If the latter, then kill the</span></CodeLine>
<Link id="l01662" /><CodeLine lineNumber="1662"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// entire debug value.</span></CodeLine>
<Link id="l01663" /><CodeLine lineNumber="1663"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewID) &#123;</span></CodeLine>
<Link id="l01664" /><CodeLine lineNumber="1664"><span class="doxyHighlight">      DbgOpIDs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DbgOpStore.insert(&#42;NewID));</span></CodeLine>
<Link id="l01665" /><CodeLine lineNumber="1665"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01666" /><CodeLine lineNumber="1666"><span class="doxyHighlight">      DbgOpIDs.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l01667" /><CodeLine lineNumber="1667"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01668" /><CodeLine lineNumber="1668"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01669" /><CodeLine lineNumber="1669"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01670" /><CodeLine lineNumber="1670"></CodeLine>
<Link id="l01671" /><CodeLine lineNumber="1671"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We have a DbgOpID for every value or for none. Tell the variable value</span></CodeLine>
<Link id="l01672" /><CodeLine lineNumber="1672"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// tracker about it. The rest of this LiveDebugValues implementation acts</span></CodeLine>
<Link id="l01673" /><CodeLine lineNumber="1673"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// exactly the same for DBG&#95;INSTR&#95;REFs as DBG&#95;VALUEs (just, the former can</span></CodeLine>
<Link id="l01674" /><CodeLine lineNumber="1674"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// refer to values that aren&#39;t immediately available).</span></CodeLine>
<Link id="l01675" /><CodeLine lineNumber="1675"><span class="doxyHighlight">  DbgValueProperties Properties(Expr, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01676" /><CodeLine lineNumber="1676"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VTracker)</span></CodeLine>
<Link id="l01677" /><CodeLine lineNumber="1677"><span class="doxyHighlight">    VTracker-&gt;defVar(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, Properties, DbgOpIDs);</span></CodeLine>
<Link id="l01678" /><CodeLine lineNumber="1678"></CodeLine>
<Link id="l01679" /><CodeLine lineNumber="1679"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we&#39;re on the final pass through the function, decompose this INSTR&#95;REF</span></CodeLine>
<Link id="l01680" /><CodeLine lineNumber="1680"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// into a plain DBG&#95;VALUE.</span></CodeLine>
<Link id="l01681" /><CodeLine lineNumber="1681"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!TTracker)</span></CodeLine>
<Link id="l01682" /><CodeLine lineNumber="1682"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01683" /><CodeLine lineNumber="1683"></CodeLine>
<Link id="l01684" /><CodeLine lineNumber="1684"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Fetch the concrete DbgOps now, as we will need them later.</span></CodeLine>
<Link id="l01685" /><CodeLine lineNumber="1685"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;DbgOp&gt;</a> DbgOps;</span></CodeLine>
<Link id="l01686" /><CodeLine lineNumber="1686"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (DbgOpID OpID : DbgOpIDs) &#123;</span></CodeLine>
<Link id="l01687" /><CodeLine lineNumber="1687"><span class="doxyHighlight">    DbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DbgOpStore.find(OpID));</span></CodeLine>
<Link id="l01688" /><CodeLine lineNumber="1688"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01689" /><CodeLine lineNumber="1689"></CodeLine>
<Link id="l01690" /><CodeLine lineNumber="1690"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Pick a location for the machine value number, if such a location exists.</span></CodeLine>
<Link id="l01691" /><CodeLine lineNumber="1691"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// (This information could be stored in TransferTracker to make it faster).</span></CodeLine>
<Link id="l01692" /><CodeLine lineNumber="1692"><span class="doxyHighlight">  SmallDenseMap&lt;ValueIDNum, TransferTracker::LocationAndQuality&gt; FoundLocs;</span></CodeLine>
<Link id="l01693" /><CodeLine lineNumber="1693"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;ValueIDNum&gt;</a> ValuesToFind;</span></CodeLine>
<Link id="l01694" /><CodeLine lineNumber="1694"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Initialized the preferred-location map with illegal locations, to be</span></CodeLine>
<Link id="l01695" /><CodeLine lineNumber="1695"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// filled in later.</span></CodeLine>
<Link id="l01696" /><CodeLine lineNumber="1696"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DbgOp &amp;<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a> : DbgOps) &#123;</span></CodeLine>
<Link id="l01697" /><CodeLine lineNumber="1697"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.IsConst)</span></CodeLine>
<Link id="l01698" /><CodeLine lineNumber="1698"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FoundLocs.<a href="/docs/api/classes/llvm/densemapbase/#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(&#123;Op.ID, TransferTracker::LocationAndQuality()&#125;)</span></CodeLine>
<Link id="l01699" /><CodeLine lineNumber="1699"><span class="doxyHighlight">              .second)</span></CodeLine>
<Link id="l01700" /><CodeLine lineNumber="1700"><span class="doxyHighlight">        ValuesToFind.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/namespaces/llvm/#ab471937b9a227e70c7fe8bd9604014d6">Op</a>.ID);</span></CodeLine>
<Link id="l01701" /><CodeLine lineNumber="1701"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01702" /><CodeLine lineNumber="1702"></CodeLine>
<Link id="l01703" /><CodeLine lineNumber="1703"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : MTracker-&gt;locations()) &#123;</span></CodeLine>
<Link id="l01704" /><CodeLine lineNumber="1704"><span class="doxyHighlight">    LocIdx CurL = <a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx;</span></CodeLine>
<Link id="l01705" /><CodeLine lineNumber="1705"><span class="doxyHighlight">    ValueIDNum <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> = MTracker-&gt;readMLoc(CurL);</span></CodeLine>
<Link id="l01706" /><CodeLine lineNumber="1706"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ValueToFindIt = <a href="/docs/api/namespaces/llvm/#a086e9fbdb06276db7753101a08a63adf">find</a>(ValuesToFind, <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>);</span></CodeLine>
<Link id="l01707" /><CodeLine lineNumber="1707"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValueToFindIt == ValuesToFind.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>())</span></CodeLine>
<Link id="l01708" /><CodeLine lineNumber="1708"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01709" /><CodeLine lineNumber="1709"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Previous = FoundLocs.<a href="/docs/api/classes/llvm/densemapbase/#a0c047f127ed4380a6f383d70bec4eb94">find</a>(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>)-&gt;second;</span></CodeLine>
<Link id="l01710" /><CodeLine lineNumber="1710"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this is the first location with that value, pick it. Otherwise,</span></CodeLine>
<Link id="l01711" /><CodeLine lineNumber="1711"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// consider whether it&#39;s a &quot;longer term&quot; location.</span></CodeLine>
<Link id="l01712" /><CodeLine lineNumber="1712"><span class="doxyHighlight">    std::optional&lt;TransferTracker::LocationQuality&gt; ReplacementQuality =</span></CodeLine>
<Link id="l01713" /><CodeLine lineNumber="1713"><span class="doxyHighlight">        TTracker-&gt;getLocQualityIfBetter(CurL, Previous.getQuality());</span></CodeLine>
<Link id="l01714" /><CodeLine lineNumber="1714"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ReplacementQuality) &#123;</span></CodeLine>
<Link id="l01715" /><CodeLine lineNumber="1715"><span class="doxyHighlight">      Previous = TransferTracker::LocationAndQuality(CurL, &#42;ReplacementQuality);</span></CodeLine>
<Link id="l01716" /><CodeLine lineNumber="1716"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Previous.isBest()) &#123;</span></CodeLine>
<Link id="l01717" /><CodeLine lineNumber="1717"><span class="doxyHighlight">        ValuesToFind.<a href="/docs/api/classes/llvm/smallvectorimpl/#a563ffc2ff61c499b3be2e00100cb72fa">erase</a>(ValueToFindIt);</span></CodeLine>
<Link id="l01718" /><CodeLine lineNumber="1718"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValuesToFind.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</span></CodeLine>
<Link id="l01719" /><CodeLine lineNumber="1719"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01720" /><CodeLine lineNumber="1720"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01721" /><CodeLine lineNumber="1721"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01722" /><CodeLine lineNumber="1722"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01723" /><CodeLine lineNumber="1723"></CodeLine>
<Link id="l01724" /><CodeLine lineNumber="1724"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;ResolvedDbgOp&gt;</a> NewLocs;</span></CodeLine>
<Link id="l01725" /><CodeLine lineNumber="1725"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DbgOp &amp;DbgOp : DbgOps) &#123;</span></CodeLine>
<Link id="l01726" /><CodeLine lineNumber="1726"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DbgOp.IsConst) &#123;</span></CodeLine>
<Link id="l01727" /><CodeLine lineNumber="1727"><span class="doxyHighlight">      NewLocs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DbgOp.MO);</span></CodeLine>
<Link id="l01728" /><CodeLine lineNumber="1728"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01729" /><CodeLine lineNumber="1729"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01730" /><CodeLine lineNumber="1730"><span class="doxyHighlight">    LocIdx FoundLoc = FoundLocs.<a href="/docs/api/classes/llvm/densemapbase/#a0c047f127ed4380a6f383d70bec4eb94">find</a>(DbgOp.ID)-&gt;second.getLoc();</span></CodeLine>
<Link id="l01731" /><CodeLine lineNumber="1731"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FoundLoc.<a href="/docs/api/classes/livedebugvalues/locidx/#a40076b99dca773c0cc6c994d8445c00a">isIllegal</a>()) &#123;</span></CodeLine>
<Link id="l01732" /><CodeLine lineNumber="1732"><span class="doxyHighlight">      NewLocs.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l01733" /><CodeLine lineNumber="1733"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01734" /><CodeLine lineNumber="1734"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01735" /><CodeLine lineNumber="1735"><span class="doxyHighlight">    NewLocs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(FoundLoc);</span></CodeLine>
<Link id="l01736" /><CodeLine lineNumber="1736"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01737" /><CodeLine lineNumber="1737"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Tell transfer tracker that the variable value has changed.</span></CodeLine>
<Link id="l01738" /><CodeLine lineNumber="1738"><span class="doxyHighlight">  TTracker-&gt;redefVar(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, Properties, NewLocs);</span></CodeLine>
<Link id="l01739" /><CodeLine lineNumber="1739"></CodeLine>
<Link id="l01740" /><CodeLine lineNumber="1740"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there were values with no location, but all such values are defined in</span></CodeLine>
<Link id="l01741" /><CodeLine lineNumber="1741"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// later instructions in this block, this is a block-local use-before-def.</span></CodeLine>
<Link id="l01742" /><CodeLine lineNumber="1742"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DbgOps.empty() &amp;&amp; NewLocs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l01743" /><CodeLine lineNumber="1743"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> IsValidUseBeforeDef = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01744" /><CodeLine lineNumber="1744"><span class="doxyHighlight">    uint64&#95;t LastUseBeforeDef = 0;</span></CodeLine>
<Link id="l01745" /><CodeLine lineNumber="1745"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ValueLoc : FoundLocs) &#123;</span></CodeLine>
<Link id="l01746" /><CodeLine lineNumber="1746"><span class="doxyHighlight">      ValueIDNum NewID = ValueLoc.first;</span></CodeLine>
<Link id="l01747" /><CodeLine lineNumber="1747"><span class="doxyHighlight">      LocIdx FoundLoc = ValueLoc.second.getLoc();</span></CodeLine>
<Link id="l01748" /><CodeLine lineNumber="1748"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!FoundLoc.<a href="/docs/api/classes/livedebugvalues/locidx/#a40076b99dca773c0cc6c994d8445c00a">isIllegal</a>())</span></CodeLine>
<Link id="l01749" /><CodeLine lineNumber="1749"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01750" /><CodeLine lineNumber="1750"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If we have an value with no location that is not defined in this block,</span></CodeLine>
<Link id="l01751" /><CodeLine lineNumber="1751"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// then it has no location in this block, leaving this value undefined.</span></CodeLine>
<Link id="l01752" /><CodeLine lineNumber="1752"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewID.<a href="/docs/api/classes/livedebugvalues/valueidnum/#acd482282b8eb9755d8ac0e82ba23c20b">getBlock</a>() != CurBB || NewID.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a3092d50fe696007741e04fca94bd8caf">getInst</a>() &lt;= CurInst) &#123;</span></CodeLine>
<Link id="l01753" /><CodeLine lineNumber="1753"><span class="doxyHighlight">        IsValidUseBeforeDef = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01754" /><CodeLine lineNumber="1754"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01755" /><CodeLine lineNumber="1755"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01756" /><CodeLine lineNumber="1756"><span class="doxyHighlight">      LastUseBeforeDef = std::max(LastUseBeforeDef, NewID.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a3092d50fe696007741e04fca94bd8caf">getInst</a>());</span></CodeLine>
<Link id="l01757" /><CodeLine lineNumber="1757"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01758" /><CodeLine lineNumber="1758"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IsValidUseBeforeDef) &#123;</span></CodeLine>
<Link id="l01759" /><CodeLine lineNumber="1759"><span class="doxyHighlight">      <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> VID = DVMap.insertDVID(V, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc().get());</span></CodeLine>
<Link id="l01760" /><CodeLine lineNumber="1760"><span class="doxyHighlight">      TTracker-&gt;addUseBeforeDef(VID, &#123;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugExpression(), </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">&#125;,</span></CodeLine>
<Link id="l01761" /><CodeLine lineNumber="1761"><span class="doxyHighlight">                                DbgOps, LastUseBeforeDef);</span></CodeLine>
<Link id="l01762" /><CodeLine lineNumber="1762"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01763" /><CodeLine lineNumber="1763"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01764" /><CodeLine lineNumber="1764"></CodeLine>
<Link id="l01765" /><CodeLine lineNumber="1765"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Produce a DBG&#95;VALUE representing what this DBG&#95;INSTR&#95;REF meant.</span></CodeLine>
<Link id="l01766" /><CodeLine lineNumber="1766"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This DBG&#95;VALUE is potentially a $noreg / undefined location, if</span></CodeLine>
<Link id="l01767" /><CodeLine lineNumber="1767"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// FoundLoc is illegal.</span></CodeLine>
<Link id="l01768" /><CodeLine lineNumber="1768"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// (XXX -- could morph the DBG&#95;INSTR&#95;REF in the future).</span></CodeLine>
<Link id="l01769" /><CodeLine lineNumber="1769"><span class="doxyHighlight">  MachineInstr &#42;DbgMI =</span></CodeLine>
<Link id="l01770" /><CodeLine lineNumber="1770"><span class="doxyHighlight">      MTracker-&gt;emitLoc(NewLocs, V, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc().get(), Properties);</span></CodeLine>
<Link id="l01771" /><CodeLine lineNumber="1771"><span class="doxyHighlight">  <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> = DVMap.getDVID(V);</span></CodeLine>
<Link id="l01772" /><CodeLine lineNumber="1772"></CodeLine>
<Link id="l01773" /><CodeLine lineNumber="1773"><span class="doxyHighlight">  TTracker-&gt;PendingDbgValues.push&#95;back(std::make&#95;pair(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>, DbgMI));</span></CodeLine>
<Link id="l01774" /><CodeLine lineNumber="1774"><span class="doxyHighlight">  TTracker-&gt;flushDbgValues(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator(), </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01775" /><CodeLine lineNumber="1775"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01776" /><CodeLine lineNumber="1776"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01777" /><CodeLine lineNumber="1777"></CodeLine>
<Link id="l01778" /><CodeLine lineNumber="1778"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::transferDebugPHI(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l01779" /><CodeLine lineNumber="1779"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugPHI())</span></CodeLine>
<Link id="l01780" /><CodeLine lineNumber="1780"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01781" /><CodeLine lineNumber="1781"></CodeLine>
<Link id="l01782" /><CodeLine lineNumber="1782"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Analyse these only when solving the machine value location problem.</span></CodeLine>
<Link id="l01783" /><CodeLine lineNumber="1783"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VTracker || TTracker)</span></CodeLine>
<Link id="l01784" /><CodeLine lineNumber="1784"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01785" /><CodeLine lineNumber="1785"></CodeLine>
<Link id="l01786" /><CodeLine lineNumber="1786"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// First operand is the value location, either a stack slot or register.</span></CodeLine>
<Link id="l01787" /><CodeLine lineNumber="1787"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Second is the debug instruction number of the original PHI.</span></CodeLine>
<Link id="l01788" /><CodeLine lineNumber="1788"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineOperand &amp;MO = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0);</span></CodeLine>
<Link id="l01789" /><CodeLine lineNumber="1789"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> InstrNum = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(1).getImm();</span></CodeLine>
<Link id="l01790" /><CodeLine lineNumber="1790"></CodeLine>
<Link id="l01791" /><CodeLine lineNumber="1791"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> EmitBadPHI = &#91;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">, &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, InstrNum&#93;() -&gt; </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01792" /><CodeLine lineNumber="1792"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Helper lambda to do any accounting when we fail to find a location for</span></CodeLine>
<Link id="l01793" /><CodeLine lineNumber="1793"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// a DBG&#95;PHI. This can happen if DBG&#95;PHIs are malformed, or refer to a</span></CodeLine>
<Link id="l01794" /><CodeLine lineNumber="1794"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// dead stack slot, for example.</span></CodeLine>
<Link id="l01795" /><CodeLine lineNumber="1795"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Record a DebugPHIRecord with an empty value + location.</span></CodeLine>
<Link id="l01796" /><CodeLine lineNumber="1796"><span class="doxyHighlight">    DebugPHINumToValue.push&#95;back(</span></CodeLine>
<Link id="l01797" /><CodeLine lineNumber="1797"><span class="doxyHighlight">        &#123;InstrNum, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent(), std::nullopt, std::nullopt&#125;);</span></CodeLine>
<Link id="l01798" /><CodeLine lineNumber="1798"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01799" /><CodeLine lineNumber="1799"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l01800" /><CodeLine lineNumber="1800"></CodeLine>
<Link id="l01801" /><CodeLine lineNumber="1801"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>()) &#123;</span></CodeLine>
<Link id="l01802" /><CodeLine lineNumber="1802"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The value is whatever&#39;s currently in the register. Read and record it,</span></CodeLine>
<Link id="l01803" /><CodeLine lineNumber="1803"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// to be analysed later.</span></CodeLine>
<Link id="l01804" /><CodeLine lineNumber="1804"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> = MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</span></CodeLine>
<Link id="l01805" /><CodeLine lineNumber="1805"><span class="doxyHighlight">    ValueIDNum Num = MTracker-&gt;readReg(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l01806" /><CodeLine lineNumber="1806"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> PHIRec = DebugPHIRecord(</span></CodeLine>
<Link id="l01807" /><CodeLine lineNumber="1807"><span class="doxyHighlight">        &#123;InstrNum, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent(), Num, MTracker-&gt;lookupOrTrackRegister(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)&#125;);</span></CodeLine>
<Link id="l01808" /><CodeLine lineNumber="1808"><span class="doxyHighlight">    DebugPHINumToValue.push&#95;back(PHIRec);</span></CodeLine>
<Link id="l01809" /><CodeLine lineNumber="1809"></CodeLine>
<Link id="l01810" /><CodeLine lineNumber="1810"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Ensure this register is tracked.</span></CodeLine>
<Link id="l01811" /><CodeLine lineNumber="1811"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MCRegAliasIterator RAI(MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), TRI, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.isValid(); ++RAI)</span></CodeLine>
<Link id="l01812" /><CodeLine lineNumber="1812"><span class="doxyHighlight">      MTracker-&gt;lookupOrTrackRegister(&#42;RAI);</span></CodeLine>
<Link id="l01813" /><CodeLine lineNumber="1813"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#ad7213433bd60dc33020246384dc18b9b">isFI</a>()) &#123;</span></CodeLine>
<Link id="l01814" /><CodeLine lineNumber="1814"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The value is whatever&#39;s in this stack slot.</span></CodeLine>
<Link id="l01815" /><CodeLine lineNumber="1815"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> FI = MO.<a href="/docs/api/classes/llvm/machineoperand/#aaa68daaf8d7b773d012887c92c2023ce">getIndex</a>();</span></CodeLine>
<Link id="l01816" /><CodeLine lineNumber="1816"></CodeLine>
<Link id="l01817" /><CodeLine lineNumber="1817"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the stack slot is dead, then this was optimized away.</span></CodeLine>
<Link id="l01818" /><CodeLine lineNumber="1818"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// FIXME: stack slot colouring should account for slots that get merged.</span></CodeLine>
<Link id="l01819" /><CodeLine lineNumber="1819"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MFI-&gt;isDeadObjectIndex(FI))</span></CodeLine>
<Link id="l01820" /><CodeLine lineNumber="1820"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> EmitBadPHI();</span></CodeLine>
<Link id="l01821" /><CodeLine lineNumber="1821"></CodeLine>
<Link id="l01822" /><CodeLine lineNumber="1822"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Identify this spill slot, ensure it&#39;s tracked.</span></CodeLine>
<Link id="l01823" /><CodeLine lineNumber="1823"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>;</span></CodeLine>
<Link id="l01824" /><CodeLine lineNumber="1824"><span class="doxyHighlight">    StackOffset Offs = TFI-&gt;getFrameIndexReference(&#42;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getMF(), FI, <a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>);</span></CodeLine>
<Link id="l01825" /><CodeLine lineNumber="1825"><span class="doxyHighlight">    SpillLoc SL = &#123;<a href="/docs/api/namespaces/llvm/sampleprof/#a702f69807459cc25db5754a5f179d3fcaf6fbeb8fa9f451468611536b00878d41">Base</a>, Offs&#125;;</span></CodeLine>
<Link id="l01826" /><CodeLine lineNumber="1826"><span class="doxyHighlight">    std::optional&lt;SpillLocationNo&gt; SpillNo = MTracker-&gt;getOrTrackSpillLoc(SL);</span></CodeLine>
<Link id="l01827" /><CodeLine lineNumber="1827"></CodeLine>
<Link id="l01828" /><CodeLine lineNumber="1828"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We might be able to find a value, but have chosen not to, to avoid</span></CodeLine>
<Link id="l01829" /><CodeLine lineNumber="1829"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// tracking too much stack information.</span></CodeLine>
<Link id="l01830" /><CodeLine lineNumber="1830"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!SpillNo)</span></CodeLine>
<Link id="l01831" /><CodeLine lineNumber="1831"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> EmitBadPHI();</span></CodeLine>
<Link id="l01832" /><CodeLine lineNumber="1832"></CodeLine>
<Link id="l01833" /><CodeLine lineNumber="1833"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Any stack location DBG&#95;PHI should have an associate bit-size.</span></CodeLine>
<Link id="l01834" /><CodeLine lineNumber="1834"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getNumOperands() == 3 &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Stack DBG&#95;PHI with no size?&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01835" /><CodeLine lineNumber="1835"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> slotBitSize = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(2).getImm();</span></CodeLine>
<Link id="l01836" /><CodeLine lineNumber="1836"></CodeLine>
<Link id="l01837" /><CodeLine lineNumber="1837"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getLocID(&#42;SpillNo, &#123;slotBitSize, 0&#125;);</span></CodeLine>
<Link id="l01838" /><CodeLine lineNumber="1838"><span class="doxyHighlight">    LocIdx SpillLoc = MTracker-&gt;getSpillMLoc(SpillID);</span></CodeLine>
<Link id="l01839" /><CodeLine lineNumber="1839"><span class="doxyHighlight">    ValueIDNum <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = MTracker-&gt;readMLoc(SpillLoc);</span></CodeLine>
<Link id="l01840" /><CodeLine lineNumber="1840"></CodeLine>
<Link id="l01841" /><CodeLine lineNumber="1841"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Record this DBG&#95;PHI for later analysis.</span></CodeLine>
<Link id="l01842" /><CodeLine lineNumber="1842"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DbgPHI = DebugPHIRecord(&#123;InstrNum, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getParent(), <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>, SpillLoc&#125;);</span></CodeLine>
<Link id="l01843" /><CodeLine lineNumber="1843"><span class="doxyHighlight">    DebugPHINumToValue.push&#95;back(DbgPHI);</span></CodeLine>
<Link id="l01844" /><CodeLine lineNumber="1844"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01845" /><CodeLine lineNumber="1845"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Else: if the operand is neither a legal register or a stack slot, then</span></CodeLine>
<Link id="l01846" /><CodeLine lineNumber="1846"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// we&#39;re being fed illegal debug-info. Record an empty PHI, so that any</span></CodeLine>
<Link id="l01847" /><CodeLine lineNumber="1847"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// debug users trying to read this number will be put off trying to</span></CodeLine>
<Link id="l01848" /><CodeLine lineNumber="1848"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// interpret the value.</span></CodeLine>
<Link id="l01849" /><CodeLine lineNumber="1849"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span></CodeLine>
<Link id="l01850" /><CodeLine lineNumber="1850"><span class="doxyHighlight">        &#123; <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Seen DBG&#95;PHI with unrecognised operand format\\n&quot;</span><span class="doxyHighlight">; &#125;);</span></CodeLine>
<Link id="l01851" /><CodeLine lineNumber="1851"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> EmitBadPHI();</span></CodeLine>
<Link id="l01852" /><CodeLine lineNumber="1852"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01853" /><CodeLine lineNumber="1853"></CodeLine>
<Link id="l01854" /><CodeLine lineNumber="1854"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01855" /><CodeLine lineNumber="1855"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01856" /><CodeLine lineNumber="1856"></CodeLine>
<Link id="l01857" /><CodeLine lineNumber="1857"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::transferRegisterDef(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l01858" /><CodeLine lineNumber="1858"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Meta Instructions do not affect the debug liveness of any register they</span></CodeLine>
<Link id="l01859" /><CodeLine lineNumber="1859"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// define.</span></CodeLine>
<Link id="l01860" /><CodeLine lineNumber="1860"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isImplicitDef()) &#123;</span></CodeLine>
<Link id="l01861" /><CodeLine lineNumber="1861"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Except when there&#39;s an implicit def, and the location it&#39;s defining has</span></CodeLine>
<Link id="l01862" /><CodeLine lineNumber="1862"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// no value number. The whole point of an implicit def is to announce that</span></CodeLine>
<Link id="l01863" /><CodeLine lineNumber="1863"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the register is live, without be specific about it&#39;s value. So define</span></CodeLine>
<Link id="l01864" /><CodeLine lineNumber="1864"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// a value if there isn&#39;t one already.</span></CodeLine>
<Link id="l01865" /><CodeLine lineNumber="1865"><span class="doxyHighlight">    ValueIDNum Num = MTracker-&gt;readReg(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg());</span></CodeLine>
<Link id="l01866" /><CodeLine lineNumber="1866"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Has a legitimate value -&gt; ignore the implicit def.</span></CodeLine>
<Link id="l01867" /><CodeLine lineNumber="1867"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#af0ee865517c9747fa74f9eb3ed54578a">getLoc</a>() != 0)</span></CodeLine>
<Link id="l01868" /><CodeLine lineNumber="1868"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01869" /><CodeLine lineNumber="1869"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Otherwise, def it here.</span></CodeLine>
<Link id="l01870" /><CodeLine lineNumber="1870"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isMetaInstruction())</span></CodeLine>
<Link id="l01871" /><CodeLine lineNumber="1871"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01872" /><CodeLine lineNumber="1872"></CodeLine>
<Link id="l01873" /><CodeLine lineNumber="1873"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We always ignore SP defines on call instructions, they don&#39;t actually</span></CodeLine>
<Link id="l01874" /><CodeLine lineNumber="1874"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// change the value of the stack pointer... except for win32&#39;s &#95;chkstk. This</span></CodeLine>
<Link id="l01875" /><CodeLine lineNumber="1875"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// is rare: filter quickly for the common case (no stack adjustments, not a</span></CodeLine>
<Link id="l01876" /><CodeLine lineNumber="1876"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// call, etc). If it is a call that modifies SP, recognise the SP register</span></CodeLine>
<Link id="l01877" /><CodeLine lineNumber="1877"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// defs.</span></CodeLine>
<Link id="l01878" /><CodeLine lineNumber="1878"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> CallChangesSP = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01879" /><CodeLine lineNumber="1879"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AdjustsStackInCalls &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCall() &amp;&amp; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).isSymbol() &amp;&amp;</span></CodeLine>
<Link id="l01880" /><CodeLine lineNumber="1880"><span class="doxyHighlight">      !strcmp(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getSymbolName(), StackProbeSymbolName.data()))</span></CodeLine>
<Link id="l01881" /><CodeLine lineNumber="1881"><span class="doxyHighlight">    CallChangesSP = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01882" /><CodeLine lineNumber="1882"></CodeLine>
<Link id="l01883" /><CodeLine lineNumber="1883"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Test whether we should ignore a def of this register due to it being part</span></CodeLine>
<Link id="l01884" /><CodeLine lineNumber="1884"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// of the stack pointer.</span></CodeLine>
<Link id="l01885" /><CodeLine lineNumber="1885"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> IgnoreSPAlias = &#91;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">, &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, CallChangesSP&#93;(<a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> <a href="/docs/api/namespaces/llvm/riscvfencefield/#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>) -&gt; </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l01886" /><CodeLine lineNumber="1886"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CallChangesSP)</span></CodeLine>
<Link id="l01887" /><CodeLine lineNumber="1887"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01888" /><CodeLine lineNumber="1888"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isCall() &amp;&amp; MTracker-&gt;SPAliases.count(R);</span></CodeLine>
<Link id="l01889" /><CodeLine lineNumber="1889"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l01890" /><CodeLine lineNumber="1890"></CodeLine>
<Link id="l01891" /><CodeLine lineNumber="1891"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Find the regs killed by MI, and find regmasks of preserved regs.</span></CodeLine>
<Link id="l01892" /><CodeLine lineNumber="1892"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Max out the number of statically allocated elements in &#96;DeadRegs&#96;, as this</span></CodeLine>
<Link id="l01893" /><CodeLine lineNumber="1893"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// prevents fallback to std::set::count() operations.</span></CodeLine>
<Link id="l01894" /><CodeLine lineNumber="1894"><span class="doxyHighlight">  SmallSet&lt;uint32&#95;t, 32&gt; DeadRegs;</span></CodeLine>
<Link id="l01895" /><CodeLine lineNumber="1895"><span class="doxyHighlight">  SmallVector&lt;const uint32&#95;t &#42;, 4&gt; RegMasks;</span></CodeLine>
<Link id="l01896" /><CodeLine lineNumber="1896"><span class="doxyHighlight">  SmallVector&lt;const MachineOperand &#42;, 4&gt; RegMaskPtrs;</span></CodeLine>
<Link id="l01897" /><CodeLine lineNumber="1897"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineOperand &amp;MO : <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.operands()) &#123;</span></CodeLine>
<Link id="l01898" /><CodeLine lineNumber="1898"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Determine whether the operand is a register def.</span></CodeLine>
<Link id="l01899" /><CodeLine lineNumber="1899"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a4c9594c955fec80c73ddd964b5efd554">isReg</a>() &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#a75eb135014670ce946e78739cdc9b51b">isDef</a>() &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>() &amp;&amp; MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>().<a href="/docs/api/classes/llvm/register/#affdbf5b92ed7e01352e2f39466efbe21">isPhysical</a>() &amp;&amp;</span></CodeLine>
<Link id="l01900" /><CodeLine lineNumber="1900"><span class="doxyHighlight">        !IgnoreSPAlias(MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>())) &#123;</span></CodeLine>
<Link id="l01901" /><CodeLine lineNumber="1901"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Remove ranges of all aliased registers.</span></CodeLine>
<Link id="l01902" /><CodeLine lineNumber="1902"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MCRegAliasIterator RAI(MO.<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>(), TRI, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.isValid(); ++RAI)</span></CodeLine>
<Link id="l01903" /><CodeLine lineNumber="1903"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// FIXME: Can we break out of this loop early if no insertion occurs?</span></CodeLine>
<Link id="l01904" /><CodeLine lineNumber="1904"><span class="doxyHighlight">        DeadRegs.<a href="/docs/api/classes/llvm/smallset/#afcadfef2cf37c3e6dbdbc9cd7bea50a0">insert</a>((&#42;RAI).id());</span></CodeLine>
<Link id="l01905" /><CodeLine lineNumber="1905"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO.<a href="/docs/api/classes/llvm/machineoperand/#a55fdcb2a9df9a69067eed1bc17a0b927">isRegMask</a>()) &#123;</span></CodeLine>
<Link id="l01906" /><CodeLine lineNumber="1906"><span class="doxyHighlight">      RegMasks.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(MO.<a href="/docs/api/classes/llvm/machineoperand/#ae6876d59aeec5bc210b359fbdcf6c1ad">getRegMask</a>());</span></CodeLine>
<Link id="l01907" /><CodeLine lineNumber="1907"><span class="doxyHighlight">      RegMaskPtrs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&amp;MO);</span></CodeLine>
<Link id="l01908" /><CodeLine lineNumber="1908"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01909" /><CodeLine lineNumber="1909"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01910" /><CodeLine lineNumber="1910"></CodeLine>
<Link id="l01911" /><CodeLine lineNumber="1911"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Tell MLocTracker about all definitions, of regmasks and otherwise.</span></CodeLine>
<Link id="l01912" /><CodeLine lineNumber="1912"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (uint32&#95;t DeadReg : DeadRegs)</span></CodeLine>
<Link id="l01913" /><CodeLine lineNumber="1913"><span class="doxyHighlight">    MTracker-&gt;defReg(DeadReg, CurBB, CurInst);</span></CodeLine>
<Link id="l01914" /><CodeLine lineNumber="1914"></CodeLine>
<Link id="l01915" /><CodeLine lineNumber="1915"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;MO : RegMaskPtrs)</span></CodeLine>
<Link id="l01916" /><CodeLine lineNumber="1916"><span class="doxyHighlight">    MTracker-&gt;writeRegMask(MO, CurBB, CurInst);</span></CodeLine>
<Link id="l01917" /><CodeLine lineNumber="1917"></CodeLine>
<Link id="l01918" /><CodeLine lineNumber="1918"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If this instruction writes to a spill slot, def that slot.</span></CodeLine>
<Link id="l01919" /><CodeLine lineNumber="1919"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#abe3764a9e5e3a3929c0cef3d6dceaedf">hasFoldedStackStore</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) &#123;</span></CodeLine>
<Link id="l01920" /><CodeLine lineNumber="1920"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (std::optional&lt;SpillLocationNo&gt; SpillNo =</span></CodeLine>
<Link id="l01921" /><CodeLine lineNumber="1921"><span class="doxyHighlight">            extractSpillBaseRegAndOffset(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) &#123;</span></CodeLine>
<Link id="l01922" /><CodeLine lineNumber="1922"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; MTracker-&gt;NumSlotIdxes; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l01923" /><CodeLine lineNumber="1923"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getSpillIDWithIdx(&#42;SpillNo, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l01924" /><CodeLine lineNumber="1924"><span class="doxyHighlight">        LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = MTracker-&gt;getSpillMLoc(SpillID);</span></CodeLine>
<Link id="l01925" /><CodeLine lineNumber="1925"><span class="doxyHighlight">        MTracker-&gt;setMLoc(L, ValueIDNum(CurBB, CurInst, L));</span></CodeLine>
<Link id="l01926" /><CodeLine lineNumber="1926"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01927" /><CodeLine lineNumber="1927"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01928" /><CodeLine lineNumber="1928"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01929" /><CodeLine lineNumber="1929"></CodeLine>
<Link id="l01930" /><CodeLine lineNumber="1930"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!TTracker)</span></CodeLine>
<Link id="l01931" /><CodeLine lineNumber="1931"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01932" /><CodeLine lineNumber="1932"></CodeLine>
<Link id="l01933" /><CodeLine lineNumber="1933"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// When committing variable values to locations: tell transfer tracker that</span></CodeLine>
<Link id="l01934" /><CodeLine lineNumber="1934"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// we&#39;ve clobbered things. It may be able to recover the variable from a</span></CodeLine>
<Link id="l01935" /><CodeLine lineNumber="1935"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// different location.</span></CodeLine>
<Link id="l01936" /><CodeLine lineNumber="1936"></CodeLine>
<Link id="l01937" /><CodeLine lineNumber="1937"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Inform TTracker about any direct clobbers.</span></CodeLine>
<Link id="l01938" /><CodeLine lineNumber="1938"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (uint32&#95;t DeadReg : DeadRegs) &#123;</span></CodeLine>
<Link id="l01939" /><CodeLine lineNumber="1939"><span class="doxyHighlight">    LocIdx Loc = MTracker-&gt;lookupOrTrackRegister(DeadReg);</span></CodeLine>
<Link id="l01940" /><CodeLine lineNumber="1940"><span class="doxyHighlight">    TTracker-&gt;clobberMloc(Loc, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator(), </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01941" /><CodeLine lineNumber="1941"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01942" /><CodeLine lineNumber="1942"></CodeLine>
<Link id="l01943" /><CodeLine lineNumber="1943"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Look for any clobbers performed by a register mask. Only test locations</span></CodeLine>
<Link id="l01944" /><CodeLine lineNumber="1944"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that are actually being tracked.</span></CodeLine>
<Link id="l01945" /><CodeLine lineNumber="1945"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!RegMaskPtrs.empty()) &#123;</span></CodeLine>
<Link id="l01946" /><CodeLine lineNumber="1946"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> L : MTracker-&gt;locations()) &#123;</span></CodeLine>
<Link id="l01947" /><CodeLine lineNumber="1947"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Stack locations can&#39;t be clobbered by regmasks.</span></CodeLine>
<Link id="l01948" /><CodeLine lineNumber="1948"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MTracker-&gt;isSpill(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>.Idx))</span></CodeLine>
<Link id="l01949" /><CodeLine lineNumber="1949"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01950" /><CodeLine lineNumber="1950"></CodeLine>
<Link id="l01951" /><CodeLine lineNumber="1951"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> = MTracker-&gt;LocIdxToLocID&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>.Idx&#93;;</span></CodeLine>
<Link id="l01952" /><CodeLine lineNumber="1952"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (IgnoreSPAlias(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01953" /><CodeLine lineNumber="1953"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01954" /><CodeLine lineNumber="1954"></CodeLine>
<Link id="l01955" /><CodeLine lineNumber="1955"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;MO : RegMaskPtrs)</span></CodeLine>
<Link id="l01956" /><CodeLine lineNumber="1956"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MO-&gt;<a href="/docs/api/classes/llvm/machineoperand/#ae4ecf5483b94e2bb72967b80cc2008d2">clobbersPhysReg</a>(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>))</span></CodeLine>
<Link id="l01957" /><CodeLine lineNumber="1957"><span class="doxyHighlight">          TTracker-&gt;clobberMloc(<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>.Idx, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator(), </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01958" /><CodeLine lineNumber="1958"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01959" /><CodeLine lineNumber="1959"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01960" /><CodeLine lineNumber="1960"></CodeLine>
<Link id="l01961" /><CodeLine lineNumber="1961"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Tell TTracker about any folded stack store.</span></CodeLine>
<Link id="l01962" /><CodeLine lineNumber="1962"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#abe3764a9e5e3a3929c0cef3d6dceaedf">hasFoldedStackStore</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) &#123;</span></CodeLine>
<Link id="l01963" /><CodeLine lineNumber="1963"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (std::optional&lt;SpillLocationNo&gt; SpillNo =</span></CodeLine>
<Link id="l01964" /><CodeLine lineNumber="1964"><span class="doxyHighlight">            extractSpillBaseRegAndOffset(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>)) &#123;</span></CodeLine>
<Link id="l01965" /><CodeLine lineNumber="1965"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; MTracker-&gt;NumSlotIdxes; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l01966" /><CodeLine lineNumber="1966"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getSpillIDWithIdx(&#42;SpillNo, <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l01967" /><CodeLine lineNumber="1967"><span class="doxyHighlight">        LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = MTracker-&gt;getSpillMLoc(SpillID);</span></CodeLine>
<Link id="l01968" /><CodeLine lineNumber="1968"><span class="doxyHighlight">        TTracker-&gt;clobberMloc(L, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator(), </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l01969" /><CodeLine lineNumber="1969"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l01970" /><CodeLine lineNumber="1970"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l01971" /><CodeLine lineNumber="1971"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l01972" /><CodeLine lineNumber="1972"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l01973" /><CodeLine lineNumber="1973"></CodeLine>
<Link id="l01974" /><CodeLine lineNumber="1974"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::performCopy(<a href="/docs/api/classes/llvm/register">Register</a> SrcRegNum, <a href="/docs/api/classes/llvm/register">Register</a> DstRegNum) &#123;</span></CodeLine>
<Link id="l01975" /><CodeLine lineNumber="1975"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// In all circumstances, re-def all aliases. It&#39;s definitely a new value now.</span></CodeLine>
<Link id="l01976" /><CodeLine lineNumber="1976"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MCRegAliasIterator RAI(DstRegNum, TRI, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.isValid(); ++RAI)</span></CodeLine>
<Link id="l01977" /><CodeLine lineNumber="1977"><span class="doxyHighlight">    MTracker-&gt;defReg(&#42;RAI, CurBB, CurInst);</span></CodeLine>
<Link id="l01978" /><CodeLine lineNumber="1978"></CodeLine>
<Link id="l01979" /><CodeLine lineNumber="1979"><span class="doxyHighlight">  ValueIDNum SrcValue = MTracker-&gt;readReg(SrcRegNum);</span></CodeLine>
<Link id="l01980" /><CodeLine lineNumber="1980"><span class="doxyHighlight">  MTracker-&gt;setReg(DstRegNum, SrcValue);</span></CodeLine>
<Link id="l01981" /><CodeLine lineNumber="1981"></CodeLine>
<Link id="l01982" /><CodeLine lineNumber="1982"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Copy subregisters from one location to another.</span></CodeLine>
<Link id="l01983" /><CodeLine lineNumber="1983"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MCSubRegIndexIterator SRI(SrcRegNum, TRI); SRI.isValid(); ++SRI) &#123;</span></CodeLine>
<Link id="l01984" /><CodeLine lineNumber="1984"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SrcSubReg = SRI.getSubReg();</span></CodeLine>
<Link id="l01985" /><CodeLine lineNumber="1985"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubRegIdx = SRI.getSubRegIndex();</span></CodeLine>
<Link id="l01986" /><CodeLine lineNumber="1986"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> DstSubReg = TRI-&gt;getSubReg(DstRegNum, SubRegIdx);</span></CodeLine>
<Link id="l01987" /><CodeLine lineNumber="1987"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DstSubReg)</span></CodeLine>
<Link id="l01988" /><CodeLine lineNumber="1988"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l01989" /><CodeLine lineNumber="1989"></CodeLine>
<Link id="l01990" /><CodeLine lineNumber="1990"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Do copy. There are two matching subregisters, the source value should</span></CodeLine>
<Link id="l01991" /><CodeLine lineNumber="1991"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// have been def&#39;d when the super-reg was, the latter might not be tracked</span></CodeLine>
<Link id="l01992" /><CodeLine lineNumber="1992"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// yet.</span></CodeLine>
<Link id="l01993" /><CodeLine lineNumber="1993"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This will force SrcSubReg to be tracked, if it isn&#39;t yet. Will read</span></CodeLine>
<Link id="l01994" /><CodeLine lineNumber="1994"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// mphi values if it wasn&#39;t tracked.</span></CodeLine>
<Link id="l01995" /><CodeLine lineNumber="1995"><span class="doxyHighlight">    LocIdx SrcL = MTracker-&gt;lookupOrTrackRegister(SrcSubReg);</span></CodeLine>
<Link id="l01996" /><CodeLine lineNumber="1996"><span class="doxyHighlight">    LocIdx DstL = MTracker-&gt;lookupOrTrackRegister(DstSubReg);</span></CodeLine>
<Link id="l01997" /><CodeLine lineNumber="1997"><span class="doxyHighlight">    (void)SrcL;</span></CodeLine>
<Link id="l01998" /><CodeLine lineNumber="1998"><span class="doxyHighlight">    (void)DstL;</span></CodeLine>
<Link id="l01999" /><CodeLine lineNumber="1999"><span class="doxyHighlight">    ValueIDNum CpyValue = MTracker-&gt;readReg(SrcSubReg);</span></CodeLine>
<Link id="l02000" /><CodeLine lineNumber="2000"></CodeLine>
<Link id="l02001" /><CodeLine lineNumber="2001"><span class="doxyHighlight">    MTracker-&gt;setReg(DstSubReg, CpyValue);</span></CodeLine>
<Link id="l02002" /><CodeLine lineNumber="2002"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02003" /><CodeLine lineNumber="2003"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02004" /><CodeLine lineNumber="2004"></CodeLine>
<Link id="l02005" /><CodeLine lineNumber="2005"><span class="doxyHighlight">std::optional&lt;SpillLocationNo&gt;</span></CodeLine>
<Link id="l02006" /><CodeLine lineNumber="2006"><span class="doxyHighlight">InstrRefBasedLDV::isSpillInstruction(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</span></CodeLine>
<Link id="l02007" /><CodeLine lineNumber="2007"><span class="doxyHighlight">                                     <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &#42;MF) &#123;</span></CodeLine>
<Link id="l02008" /><CodeLine lineNumber="2008"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: Handle multiple stores folded into one.</span></CodeLine>
<Link id="l02009" /><CodeLine lineNumber="2009"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.hasOneMemOperand())</span></CodeLine>
<Link id="l02010" /><CodeLine lineNumber="2010"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l02011" /><CodeLine lineNumber="2011"></CodeLine>
<Link id="l02012" /><CodeLine lineNumber="2012"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Reject any memory operand that&#39;s aliased -- we can&#39;t guarantee its value.</span></CodeLine>
<Link id="l02013" /><CodeLine lineNumber="2013"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> MMOI = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.memoperands&#95;begin();</span></CodeLine>
<Link id="l02014" /><CodeLine lineNumber="2014"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> PseudoSourceValue &#42;PVal = (&#42;MMOI)-&gt;getPseudoValue();</span></CodeLine>
<Link id="l02015" /><CodeLine lineNumber="2015"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PVal-&gt;<a href="/docs/api/classes/llvm/pseudosourcevalue/#a72fec4522e4d7a71936f0b491d1fbafe">isAliased</a>(MFI))</span></CodeLine>
<Link id="l02016" /><CodeLine lineNumber="2016"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l02017" /><CodeLine lineNumber="2017"></CodeLine>
<Link id="l02018" /><CodeLine lineNumber="2018"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getSpillSize(TII) &amp;&amp; !<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getFoldedSpillSize(TII))</span></CodeLine>
<Link id="l02019" /><CodeLine lineNumber="2019"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt; </span><span class="doxyHighlightComment">// This is not a spill instruction, since no valid size</span></CodeLine>
<Link id="l02020" /><CodeLine lineNumber="2020"><span class="doxyHighlight">                         </span><span class="doxyHighlightComment">// was returned from either function.</span></CodeLine>
<Link id="l02021" /><CodeLine lineNumber="2021"></CodeLine>
<Link id="l02022" /><CodeLine lineNumber="2022"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> extractSpillBaseRegAndOffset(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l02023" /><CodeLine lineNumber="2023"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02024" /><CodeLine lineNumber="2024"></CodeLine>
<Link id="l02025" /><CodeLine lineNumber="2025"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::isLocationSpill(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</span></CodeLine>
<Link id="l02026" /><CodeLine lineNumber="2026"><span class="doxyHighlight">                                       <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &#42;MF, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &#123;</span></CodeLine>
<Link id="l02027" /><CodeLine lineNumber="2027"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!isSpillInstruction(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, MF))</span></CodeLine>
<Link id="l02028" /><CodeLine lineNumber="2028"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02029" /><CodeLine lineNumber="2029"></CodeLine>
<Link id="l02030" /><CodeLine lineNumber="2030"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> FI;</span></CodeLine>
<Link id="l02031" /><CodeLine lineNumber="2031"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> = TII-&gt;isStoreToStackSlotPostFE(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FI);</span></CodeLine>
<Link id="l02032" /><CodeLine lineNumber="2032"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> != 0;</span></CodeLine>
<Link id="l02033" /><CodeLine lineNumber="2033"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02034" /><CodeLine lineNumber="2034"></CodeLine>
<Link id="l02035" /><CodeLine lineNumber="2035"><span class="doxyHighlight">std::optional&lt;SpillLocationNo&gt;</span></CodeLine>
<Link id="l02036" /><CodeLine lineNumber="2036"><span class="doxyHighlight">InstrRefBasedLDV::isRestoreInstruction(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</span></CodeLine>
<Link id="l02037" /><CodeLine lineNumber="2037"><span class="doxyHighlight">                                       <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &#42;MF, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>) &#123;</span></CodeLine>
<Link id="l02038" /><CodeLine lineNumber="2038"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.hasOneMemOperand())</span></CodeLine>
<Link id="l02039" /><CodeLine lineNumber="2039"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l02040" /><CodeLine lineNumber="2040"></CodeLine>
<Link id="l02041" /><CodeLine lineNumber="2041"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// FIXME: Handle folded restore instructions with more than one memory</span></CodeLine>
<Link id="l02042" /><CodeLine lineNumber="2042"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// operand.</span></CodeLine>
<Link id="l02043" /><CodeLine lineNumber="2043"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getRestoreSize(TII)) &#123;</span></CodeLine>
<Link id="l02044" /><CodeLine lineNumber="2044"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a> = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getOperand(0).getReg();</span></CodeLine>
<Link id="l02045" /><CodeLine lineNumber="2045"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> extractSpillBaseRegAndOffset(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l02046" /><CodeLine lineNumber="2046"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02047" /><CodeLine lineNumber="2047"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l02048" /><CodeLine lineNumber="2048"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02049" /><CodeLine lineNumber="2049"></CodeLine>
<Link id="l02050" /><CodeLine lineNumber="2050"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::transferSpillOrRestoreInst(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l02051" /><CodeLine lineNumber="2051"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// XXX -- it&#39;s too difficult to implement VarLocBasedImpl&#39;s  stack location</span></CodeLine>
<Link id="l02052" /><CodeLine lineNumber="2052"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// limitations under the new model. Therefore, when comparing them, compare</span></CodeLine>
<Link id="l02053" /><CodeLine lineNumber="2053"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// versions that don&#39;t attempt spills or restores at all.</span></CodeLine>
<Link id="l02054" /><CodeLine lineNumber="2054"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#afba85f0d2bfd9c12500fa7c93a6e3f91">EmulateOldLDV</a>)</span></CodeLine>
<Link id="l02055" /><CodeLine lineNumber="2055"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02056" /><CodeLine lineNumber="2056"></CodeLine>
<Link id="l02057" /><CodeLine lineNumber="2057"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Strictly limit ourselves to plain loads and stores, not all instructions</span></CodeLine>
<Link id="l02058" /><CodeLine lineNumber="2058"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that can access the stack.</span></CodeLine>
<Link id="l02059" /><CodeLine lineNumber="2059"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> DummyFI = -1;</span></CodeLine>
<Link id="l02060" /><CodeLine lineNumber="2060"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!TII-&gt;isStoreToStackSlotPostFE(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, DummyFI) &amp;&amp;</span></CodeLine>
<Link id="l02061" /><CodeLine lineNumber="2061"><span class="doxyHighlight">      !TII-&gt;isLoadFromStackSlotPostFE(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, DummyFI))</span></CodeLine>
<Link id="l02062" /><CodeLine lineNumber="2062"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02063" /><CodeLine lineNumber="2063"></CodeLine>
<Link id="l02064" /><CodeLine lineNumber="2064"><span class="doxyHighlight">  MachineFunction &#42;MF = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getMF();</span></CodeLine>
<Link id="l02065" /><CodeLine lineNumber="2065"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>;</span></CodeLine>
<Link id="l02066" /><CodeLine lineNumber="2066"></CodeLine>
<Link id="l02067" /><CodeLine lineNumber="2067"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Examining instruction: &quot;</span><span class="doxyHighlight">; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.<a href="/docs/api/classes/llvm/pass/#a1a60731eeff800b39fca7280a5a167ae">dump</a>(););</span></CodeLine>
<Link id="l02068" /><CodeLine lineNumber="2068"></CodeLine>
<Link id="l02069" /><CodeLine lineNumber="2069"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Strictly limit ourselves to plain loads and stores, not all instructions</span></CodeLine>
<Link id="l02070" /><CodeLine lineNumber="2070"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that can access the stack.</span></CodeLine>
<Link id="l02071" /><CodeLine lineNumber="2071"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> FIDummy;</span></CodeLine>
<Link id="l02072" /><CodeLine lineNumber="2072"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!TII-&gt;isStoreToStackSlotPostFE(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FIDummy) &amp;&amp;</span></CodeLine>
<Link id="l02073" /><CodeLine lineNumber="2073"><span class="doxyHighlight">      !TII-&gt;isLoadFromStackSlotPostFE(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, FIDummy))</span></CodeLine>
<Link id="l02074" /><CodeLine lineNumber="2074"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02075" /><CodeLine lineNumber="2075"></CodeLine>
<Link id="l02076" /><CodeLine lineNumber="2076"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// First, if there are any DBG&#95;VALUEs pointing at a spill slot that is</span></CodeLine>
<Link id="l02077" /><CodeLine lineNumber="2077"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// written to, terminate that variable location. The value in memory</span></CodeLine>
<Link id="l02078" /><CodeLine lineNumber="2078"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// will have changed. DbgEntityHistoryCalculator doesn&#39;t try to detect this.</span></CodeLine>
<Link id="l02079" /><CodeLine lineNumber="2079"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (std::optional&lt;SpillLocationNo&gt; Loc = isSpillInstruction(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, MF)) &#123;</span></CodeLine>
<Link id="l02080" /><CodeLine lineNumber="2080"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Un-set this location and clobber, so that earlier locations don&#39;t</span></CodeLine>
<Link id="l02081" /><CodeLine lineNumber="2081"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// continue past this store.</span></CodeLine>
<Link id="l02082" /><CodeLine lineNumber="2082"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SlotIdx = 0; SlotIdx &lt; MTracker-&gt;NumSlotIdxes; ++SlotIdx) &#123;</span></CodeLine>
<Link id="l02083" /><CodeLine lineNumber="2083"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getSpillIDWithIdx(&#42;Loc, SlotIdx);</span></CodeLine>
<Link id="l02084" /><CodeLine lineNumber="2084"><span class="doxyHighlight">      std::optional&lt;LocIdx&gt; MLoc = MTracker-&gt;getSpillMLoc(SpillID);</span></CodeLine>
<Link id="l02085" /><CodeLine lineNumber="2085"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!MLoc)</span></CodeLine>
<Link id="l02086" /><CodeLine lineNumber="2086"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02087" /><CodeLine lineNumber="2087"></CodeLine>
<Link id="l02088" /><CodeLine lineNumber="2088"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We need to over-write the stack slot with something (here, a def at</span></CodeLine>
<Link id="l02089" /><CodeLine lineNumber="2089"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// this instruction) to ensure no values are preserved in this stack slot</span></CodeLine>
<Link id="l02090" /><CodeLine lineNumber="2090"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// after the spill. It also prevents TTracker from trying to recover the</span></CodeLine>
<Link id="l02091" /><CodeLine lineNumber="2091"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// location and re-installing it in the same place.</span></CodeLine>
<Link id="l02092" /><CodeLine lineNumber="2092"><span class="doxyHighlight">      ValueIDNum <a href="/docs/api/namespaces/llvm/rdf/#a10793004faece2bb74d3363b5f6ce96f">Def</a>(CurBB, CurInst, &#42;MLoc);</span></CodeLine>
<Link id="l02093" /><CodeLine lineNumber="2093"><span class="doxyHighlight">      MTracker-&gt;setMLoc(&#42;MLoc, Def);</span></CodeLine>
<Link id="l02094" /><CodeLine lineNumber="2094"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TTracker)</span></CodeLine>
<Link id="l02095" /><CodeLine lineNumber="2095"><span class="doxyHighlight">        TTracker-&gt;clobberMloc(&#42;MLoc, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator());</span></CodeLine>
<Link id="l02096" /><CodeLine lineNumber="2096"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02097" /><CodeLine lineNumber="2097"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02098" /><CodeLine lineNumber="2098"></CodeLine>
<Link id="l02099" /><CodeLine lineNumber="2099"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Try to recognise spill and restore instructions that may transfer a value.</span></CodeLine>
<Link id="l02100" /><CodeLine lineNumber="2100"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (isLocationSpill(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, MF, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</span></CodeLine>
<Link id="l02101" /><CodeLine lineNumber="2101"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// isLocationSpill returning true should guarantee we can extract a</span></CodeLine>
<Link id="l02102" /><CodeLine lineNumber="2102"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// location.</span></CodeLine>
<Link id="l02103" /><CodeLine lineNumber="2103"><span class="doxyHighlight">    SpillLocationNo Loc = &#42;extractSpillBaseRegAndOffset(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l02104" /><CodeLine lineNumber="2104"></CodeLine>
<Link id="l02105" /><CodeLine lineNumber="2105"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DoTransfer = &#91;&amp;&#93;(<a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> SrcReg, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID) &#123;</span></CodeLine>
<Link id="l02106" /><CodeLine lineNumber="2106"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ReadValue = MTracker-&gt;readReg(SrcReg);</span></CodeLine>
<Link id="l02107" /><CodeLine lineNumber="2107"><span class="doxyHighlight">      LocIdx DstLoc = MTracker-&gt;getSpillMLoc(SpillID);</span></CodeLine>
<Link id="l02108" /><CodeLine lineNumber="2108"><span class="doxyHighlight">      MTracker-&gt;setMLoc(DstLoc, ReadValue);</span></CodeLine>
<Link id="l02109" /><CodeLine lineNumber="2109"></CodeLine>
<Link id="l02110" /><CodeLine lineNumber="2110"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TTracker) &#123;</span></CodeLine>
<Link id="l02111" /><CodeLine lineNumber="2111"><span class="doxyHighlight">        LocIdx SrcLoc = MTracker-&gt;getRegMLoc(SrcReg);</span></CodeLine>
<Link id="l02112" /><CodeLine lineNumber="2112"><span class="doxyHighlight">        TTracker-&gt;transferMlocs(SrcLoc, DstLoc, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator());</span></CodeLine>
<Link id="l02113" /><CodeLine lineNumber="2113"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02114" /><CodeLine lineNumber="2114"><span class="doxyHighlight">    &#125;;</span></CodeLine>
<Link id="l02115" /><CodeLine lineNumber="2115"></CodeLine>
<Link id="l02116" /><CodeLine lineNumber="2116"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Then, transfer subreg bits.</span></CodeLine>
<Link id="l02117" /><CodeLine lineNumber="2117"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aad72cfbb210808985a9dc19f4e5d8542">MCPhysReg</a> SR : TRI-&gt;subregs(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</span></CodeLine>
<Link id="l02118" /><CodeLine lineNumber="2118"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Ensure this reg is tracked,</span></CodeLine>
<Link id="l02119" /><CodeLine lineNumber="2119"><span class="doxyHighlight">      (void)MTracker-&gt;lookupOrTrackRegister(SR);</span></CodeLine>
<Link id="l02120" /><CodeLine lineNumber="2120"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SubregIdx = TRI-&gt;getSubRegIndex(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, SR);</span></CodeLine>
<Link id="l02121" /><CodeLine lineNumber="2121"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getLocID(Loc, SubregIdx);</span></CodeLine>
<Link id="l02122" /><CodeLine lineNumber="2122"><span class="doxyHighlight">      DoTransfer(SR, SpillID);</span></CodeLine>
<Link id="l02123" /><CodeLine lineNumber="2123"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02124" /><CodeLine lineNumber="2124"></CodeLine>
<Link id="l02125" /><CodeLine lineNumber="2125"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Directly lookup size of main source reg, and transfer.</span></CodeLine>
<Link id="l02126" /><CodeLine lineNumber="2126"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = TRI-&gt;getRegSizeInBits(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, &#42;MRI);</span></CodeLine>
<Link id="l02127" /><CodeLine lineNumber="2127"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getLocID(Loc, &#123;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, 0&#125;);</span></CodeLine>
<Link id="l02128" /><CodeLine lineNumber="2128"><span class="doxyHighlight">    DoTransfer(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, SpillID);</span></CodeLine>
<Link id="l02129" /><CodeLine lineNumber="2129"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02130" /><CodeLine lineNumber="2130"><span class="doxyHighlight">    std::optional&lt;SpillLocationNo&gt; Loc = isRestoreInstruction(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, MF, <a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>);</span></CodeLine>
<Link id="l02131" /><CodeLine lineNumber="2131"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Loc)</span></CodeLine>
<Link id="l02132" /><CodeLine lineNumber="2132"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02133" /><CodeLine lineNumber="2133"></CodeLine>
<Link id="l02134" /><CodeLine lineNumber="2134"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Assumption: we&#39;re reading from the base of the stack slot, not some</span></CodeLine>
<Link id="l02135" /><CodeLine lineNumber="2135"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// offset into it. It seems very unlikely LLVM would ever generate</span></CodeLine>
<Link id="l02136" /><CodeLine lineNumber="2136"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// restores where this wasn&#39;t true. This then becomes a question of what</span></CodeLine>
<Link id="l02137" /><CodeLine lineNumber="2137"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// subregisters in the destination register line up with positions in the</span></CodeLine>
<Link id="l02138" /><CodeLine lineNumber="2138"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// stack slot.</span></CodeLine>
<Link id="l02139" /><CodeLine lineNumber="2139"></CodeLine>
<Link id="l02140" /><CodeLine lineNumber="2140"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Def all registers that alias the destination.</span></CodeLine>
<Link id="l02141" /><CodeLine lineNumber="2141"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MCRegAliasIterator RAI(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, TRI, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.isValid(); ++RAI)</span></CodeLine>
<Link id="l02142" /><CodeLine lineNumber="2142"><span class="doxyHighlight">      MTracker-&gt;defReg(&#42;RAI, CurBB, CurInst);</span></CodeLine>
<Link id="l02143" /><CodeLine lineNumber="2143"></CodeLine>
<Link id="l02144" /><CodeLine lineNumber="2144"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Now find subregisters within the destination register, and load values</span></CodeLine>
<Link id="l02145" /><CodeLine lineNumber="2145"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// from stack slot positions.</span></CodeLine>
<Link id="l02146" /><CodeLine lineNumber="2146"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DoTransfer = &#91;&amp;&#93;(<a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> DestReg, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID) &#123;</span></CodeLine>
<Link id="l02147" /><CodeLine lineNumber="2147"><span class="doxyHighlight">      LocIdx SrcIdx = MTracker-&gt;getSpillMLoc(SpillID);</span></CodeLine>
<Link id="l02148" /><CodeLine lineNumber="2148"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ReadValue = MTracker-&gt;readMLoc(SrcIdx);</span></CodeLine>
<Link id="l02149" /><CodeLine lineNumber="2149"><span class="doxyHighlight">      MTracker-&gt;setReg(DestReg, ReadValue);</span></CodeLine>
<Link id="l02150" /><CodeLine lineNumber="2150"><span class="doxyHighlight">    &#125;;</span></CodeLine>
<Link id="l02151" /><CodeLine lineNumber="2151"></CodeLine>
<Link id="l02152" /><CodeLine lineNumber="2152"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#aad72cfbb210808985a9dc19f4e5d8542">MCPhysReg</a> SR : TRI-&gt;subregs(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>)) &#123;</span></CodeLine>
<Link id="l02153" /><CodeLine lineNumber="2153"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Subreg = TRI-&gt;getSubRegIndex(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, SR);</span></CodeLine>
<Link id="l02154" /><CodeLine lineNumber="2154"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getLocID(&#42;Loc, Subreg);</span></CodeLine>
<Link id="l02155" /><CodeLine lineNumber="2155"><span class="doxyHighlight">      DoTransfer(SR, SpillID);</span></CodeLine>
<Link id="l02156" /><CodeLine lineNumber="2156"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02157" /><CodeLine lineNumber="2157"></CodeLine>
<Link id="l02158" /><CodeLine lineNumber="2158"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Directly look up this registers slot idx by size, and transfer.</span></CodeLine>
<Link id="l02159" /><CodeLine lineNumber="2159"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = TRI-&gt;getRegSizeInBits(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, &#42;MRI);</span></CodeLine>
<Link id="l02160" /><CodeLine lineNumber="2160"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getLocID(&#42;Loc, &#123;<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, 0&#125;);</span></CodeLine>
<Link id="l02161" /><CodeLine lineNumber="2161"><span class="doxyHighlight">    DoTransfer(<a href="/docs/api/files/lib/lib/codegen/machinesink-cpp/#a359e1ff26f6d466d927a61aae45b05c3">Reg</a>, SpillID);</span></CodeLine>
<Link id="l02162" /><CodeLine lineNumber="2162"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02163" /><CodeLine lineNumber="2163"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02164" /><CodeLine lineNumber="2164"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02165" /><CodeLine lineNumber="2165"></CodeLine>
<Link id="l02166" /><CodeLine lineNumber="2166"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::transferRegisterCopy(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l02167" /><CodeLine lineNumber="2167"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DestSrc = TII-&gt;isCopyLikeInstr(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l02168" /><CodeLine lineNumber="2168"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DestSrc)</span></CodeLine>
<Link id="l02169" /><CodeLine lineNumber="2169"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02170" /><CodeLine lineNumber="2170"></CodeLine>
<Link id="l02171" /><CodeLine lineNumber="2171"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineOperand &#42;DestRegOp = DestSrc-&gt;Destination;</span></CodeLine>
<Link id="l02172" /><CodeLine lineNumber="2172"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineOperand &#42;SrcRegOp = DestSrc-&gt;Source;</span></CodeLine>
<Link id="l02173" /><CodeLine lineNumber="2173"></CodeLine>
<Link id="l02174" /><CodeLine lineNumber="2174"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> SrcReg = SrcRegOp-&gt;<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</span></CodeLine>
<Link id="l02175" /><CodeLine lineNumber="2175"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> DestReg = DestRegOp-&gt;<a href="/docs/api/classes/llvm/machineoperand/#ac0035d7c1c860501c877c20e6e93297b">getReg</a>();</span></CodeLine>
<Link id="l02176" /><CodeLine lineNumber="2176"></CodeLine>
<Link id="l02177" /><CodeLine lineNumber="2177"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Ignore identity copies. Yep, these make it as far as LiveDebugValues.</span></CodeLine>
<Link id="l02178" /><CodeLine lineNumber="2178"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SrcReg == DestReg)</span></CodeLine>
<Link id="l02179" /><CodeLine lineNumber="2179"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02180" /><CodeLine lineNumber="2180"></CodeLine>
<Link id="l02181" /><CodeLine lineNumber="2181"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For emulating VarLocBasedImpl:</span></CodeLine>
<Link id="l02182" /><CodeLine lineNumber="2182"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We want to recognize instructions where destination register is callee</span></CodeLine>
<Link id="l02183" /><CodeLine lineNumber="2183"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// saved register. If register that could be clobbered by the call is</span></CodeLine>
<Link id="l02184" /><CodeLine lineNumber="2184"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// included, there would be a great chance that it is going to be clobbered</span></CodeLine>
<Link id="l02185" /><CodeLine lineNumber="2185"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// soon. It is more likely that previous register, which is callee saved, is</span></CodeLine>
<Link id="l02186" /><CodeLine lineNumber="2186"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// going to stay unclobbered longer, even if it is killed.</span></CodeLine>
<Link id="l02187" /><CodeLine lineNumber="2187"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//</span></CodeLine>
<Link id="l02188" /><CodeLine lineNumber="2188"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For InstrRefBasedImpl, we can track multiple locations per value, so</span></CodeLine>
<Link id="l02189" /><CodeLine lineNumber="2189"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// ignore this condition.</span></CodeLine>
<Link id="l02190" /><CodeLine lineNumber="2190"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#afba85f0d2bfd9c12500fa7c93a6e3f91">EmulateOldLDV</a> &amp;&amp; !<a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ad778dafd8a5d853569fe78079b6960b7">isCalleeSavedReg</a>(DestReg))</span></CodeLine>
<Link id="l02191" /><CodeLine lineNumber="2191"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02192" /><CodeLine lineNumber="2192"></CodeLine>
<Link id="l02193" /><CodeLine lineNumber="2193"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// InstrRefBasedImpl only followed killing copies.</span></CodeLine>
<Link id="l02194" /><CodeLine lineNumber="2194"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#afba85f0d2bfd9c12500fa7c93a6e3f91">EmulateOldLDV</a> &amp;&amp; !SrcRegOp-&gt;<a href="/docs/api/classes/llvm/machineoperand/#a4046212ebc647b17e811837ae4ea3afd">isKill</a>())</span></CodeLine>
<Link id="l02195" /><CodeLine lineNumber="2195"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02196" /><CodeLine lineNumber="2196"></CodeLine>
<Link id="l02197" /><CodeLine lineNumber="2197"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Before we update MTracker, remember which values were present in each of</span></CodeLine>
<Link id="l02198" /><CodeLine lineNumber="2198"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the locations about to be overwritten, so that we can recover any</span></CodeLine>
<Link id="l02199" /><CodeLine lineNumber="2199"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// potentially clobbered variables.</span></CodeLine>
<Link id="l02200" /><CodeLine lineNumber="2200"><span class="doxyHighlight">  DenseMap&lt;LocIdx, ValueIDNum&gt; ClobberedLocs;</span></CodeLine>
<Link id="l02201" /><CodeLine lineNumber="2201"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TTracker) &#123;</span></CodeLine>
<Link id="l02202" /><CodeLine lineNumber="2202"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MCRegAliasIterator RAI(DestReg, TRI, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.isValid(); ++RAI) &#123;</span></CodeLine>
<Link id="l02203" /><CodeLine lineNumber="2203"><span class="doxyHighlight">      LocIdx ClobberedLoc = MTracker-&gt;getRegMLoc(&#42;RAI);</span></CodeLine>
<Link id="l02204" /><CodeLine lineNumber="2204"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> MLocIt = TTracker-&gt;ActiveMLocs.find(ClobberedLoc);</span></CodeLine>
<Link id="l02205" /><CodeLine lineNumber="2205"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If ActiveMLocs isn&#39;t tracking this location or there are no variables</span></CodeLine>
<Link id="l02206" /><CodeLine lineNumber="2206"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// using it, don&#39;t bother remembering.</span></CodeLine>
<Link id="l02207" /><CodeLine lineNumber="2207"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MLocIt == TTracker-&gt;ActiveMLocs.end() || MLocIt-&gt;second.empty())</span></CodeLine>
<Link id="l02208" /><CodeLine lineNumber="2208"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02209" /><CodeLine lineNumber="2209"><span class="doxyHighlight">      ValueIDNum <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> = MTracker-&gt;readReg(&#42;RAI);</span></CodeLine>
<Link id="l02210" /><CodeLine lineNumber="2210"><span class="doxyHighlight">      ClobberedLocs&#91;ClobberedLoc&#93; = <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a>;</span></CodeLine>
<Link id="l02211" /><CodeLine lineNumber="2211"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02212" /><CodeLine lineNumber="2212"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02213" /><CodeLine lineNumber="2213"></CodeLine>
<Link id="l02214" /><CodeLine lineNumber="2214"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Copy MTracker info, including subregs if available.</span></CodeLine>
<Link id="l02215" /><CodeLine lineNumber="2215"><span class="doxyHighlight">  InstrRefBasedLDV::performCopy(SrcReg, DestReg);</span></CodeLine>
<Link id="l02216" /><CodeLine lineNumber="2216"></CodeLine>
<Link id="l02217" /><CodeLine lineNumber="2217"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The copy might have clobbered variables based on the destination register.</span></CodeLine>
<Link id="l02218" /><CodeLine lineNumber="2218"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Tell TTracker about it, passing the old ValueIDNum to search for</span></CodeLine>
<Link id="l02219" /><CodeLine lineNumber="2219"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// alternative locations (or else terminating those variables).</span></CodeLine>
<Link id="l02220" /><CodeLine lineNumber="2220"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TTracker) &#123;</span></CodeLine>
<Link id="l02221" /><CodeLine lineNumber="2221"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LocVal : ClobberedLocs) &#123;</span></CodeLine>
<Link id="l02222" /><CodeLine lineNumber="2222"><span class="doxyHighlight">      TTracker-&gt;clobberMloc(LocVal.first, LocVal.second, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator(), </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02223" /><CodeLine lineNumber="2223"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02224" /><CodeLine lineNumber="2224"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02225" /><CodeLine lineNumber="2225"></CodeLine>
<Link id="l02226" /><CodeLine lineNumber="2226"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Only produce a transfer of DBG&#95;VALUE within a block where old LDV</span></CodeLine>
<Link id="l02227" /><CodeLine lineNumber="2227"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// would have. We might make use of the additional value tracking in some</span></CodeLine>
<Link id="l02228" /><CodeLine lineNumber="2228"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// other way, later.</span></CodeLine>
<Link id="l02229" /><CodeLine lineNumber="2229"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TTracker &amp;&amp; <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ad778dafd8a5d853569fe78079b6960b7">isCalleeSavedReg</a>(DestReg) &amp;&amp; SrcRegOp-&gt;<a href="/docs/api/classes/llvm/machineoperand/#a4046212ebc647b17e811837ae4ea3afd">isKill</a>())</span></CodeLine>
<Link id="l02230" /><CodeLine lineNumber="2230"><span class="doxyHighlight">    TTracker-&gt;transferMlocs(MTracker-&gt;getRegMLoc(SrcReg),</span></CodeLine>
<Link id="l02231" /><CodeLine lineNumber="2231"><span class="doxyHighlight">                            MTracker-&gt;getRegMLoc(DestReg), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator());</span></CodeLine>
<Link id="l02232" /><CodeLine lineNumber="2232"></CodeLine>
<Link id="l02233" /><CodeLine lineNumber="2233"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// VarLocBasedImpl would quit tracking the old location after copying.</span></CodeLine>
<Link id="l02234" /><CodeLine lineNumber="2234"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="#afba85f0d2bfd9c12500fa7c93a6e3f91">EmulateOldLDV</a> &amp;&amp; SrcReg != DestReg)</span></CodeLine>
<Link id="l02235" /><CodeLine lineNumber="2235"><span class="doxyHighlight">    MTracker-&gt;defReg(SrcReg, CurBB, CurInst);</span></CodeLine>
<Link id="l02236" /><CodeLine lineNumber="2236"></CodeLine>
<Link id="l02237" /><CodeLine lineNumber="2237"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02238" /><CodeLine lineNumber="2238"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02239" /><CodeLine lineNumber="2239"></CodeLine>
<Link id="l02240" /><CodeLine lineNumber="2240"><span class="doxyHighlightComment">/// Accumulate a mapping between each DILocalVariable fragment and other</span></CodeLine>
<Link id="l02241" /><CodeLine lineNumber="2241"><span class="doxyHighlightComment">/// fragments of that DILocalVariable which overlap. This reduces work during</span></CodeLine>
<Link id="l02242" /><CodeLine lineNumber="2242"><span class="doxyHighlightComment">/// the data-flow stage from &quot;Find any overlapping fragments&quot; to &quot;Check if the</span></CodeLine>
<Link id="l02243" /><CodeLine lineNumber="2243"><span class="doxyHighlightComment">/// known-to-overlap fragments are present&quot;.</span></CodeLine>
<Link id="l02244" /><CodeLine lineNumber="2244"><span class="doxyHighlightComment">/// \\param MI A previously unprocessed debug instruction to analyze for</span></CodeLine>
<Link id="l02245" /><CodeLine lineNumber="2245"><span class="doxyHighlightComment">///           fragment usage.</span></CodeLine>
<Link id="l02246" /><CodeLine lineNumber="2246"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::accumulateFragmentMap(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) &#123;</span></CodeLine>
<Link id="l02247" /><CodeLine lineNumber="2247"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugValueLike());</span></CodeLine>
<Link id="l02248" /><CodeLine lineNumber="2248"><span class="doxyHighlight">  DebugVariable MIVar(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugVariable(), <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugExpression(),</span></CodeLine>
<Link id="l02249" /><CodeLine lineNumber="2249"><span class="doxyHighlight">                      <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc()-&gt;getInlinedAt());</span></CodeLine>
<Link id="l02250" /><CodeLine lineNumber="2250"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#a8126e881577442cc33511b29b08a0d32">FragmentInfo</a> ThisFragment = MIVar.getFragmentOrDefault();</span></CodeLine>
<Link id="l02251" /><CodeLine lineNumber="2251"></CodeLine>
<Link id="l02252" /><CodeLine lineNumber="2252"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If this is the first sighting of this variable, then we are guaranteed</span></CodeLine>
<Link id="l02253" /><CodeLine lineNumber="2253"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// there are currently no overlapping fragments either. Initialize the set</span></CodeLine>
<Link id="l02254" /><CodeLine lineNumber="2254"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// of seen fragments, record no overlaps for the current one, and return.</span></CodeLine>
<Link id="l02255" /><CodeLine lineNumber="2255"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#91;SeenIt, <a href="/docs/api/namespaces/llvm/logicalview/#a9696bc411b0a7022c2cc78bff5173cefa157d034f9c98a305eb73776582550027">Inserted</a>&#93; = SeenFragments.try&#95;emplace(MIVar.getVariable());</span></CodeLine>
<Link id="l02256" /><CodeLine lineNumber="2256"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Inserted) &#123;</span></CodeLine>
<Link id="l02257" /><CodeLine lineNumber="2257"><span class="doxyHighlight">    SeenIt-&gt;second.insert(ThisFragment);</span></CodeLine>
<Link id="l02258" /><CodeLine lineNumber="2258"></CodeLine>
<Link id="l02259" /><CodeLine lineNumber="2259"><span class="doxyHighlight">    OverlapFragments.insert(&#123;&#123;MIVar.getVariable(), ThisFragment&#125;, &#123;&#125;&#125;);</span></CodeLine>
<Link id="l02260" /><CodeLine lineNumber="2260"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02261" /><CodeLine lineNumber="2261"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02262" /><CodeLine lineNumber="2262"></CodeLine>
<Link id="l02263" /><CodeLine lineNumber="2263"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If this particular Variable/Fragment pair already exists in the overlap</span></CodeLine>
<Link id="l02264" /><CodeLine lineNumber="2264"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// map, it has already been accounted for.</span></CodeLine>
<Link id="l02265" /><CodeLine lineNumber="2265"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> IsInOLapMap =</span></CodeLine>
<Link id="l02266" /><CodeLine lineNumber="2266"><span class="doxyHighlight">      OverlapFragments.insert(&#123;&#123;MIVar.getVariable(), ThisFragment&#125;, &#123;&#125;&#125;);</span></CodeLine>
<Link id="l02267" /><CodeLine lineNumber="2267"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!IsInOLapMap.second)</span></CodeLine>
<Link id="l02268" /><CodeLine lineNumber="2268"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02269" /><CodeLine lineNumber="2269"></CodeLine>
<Link id="l02270" /><CodeLine lineNumber="2270"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;ThisFragmentsOverlaps = IsInOLapMap.first-&gt;second;</span></CodeLine>
<Link id="l02271" /><CodeLine lineNumber="2271"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;AllSeenFragments = SeenIt-&gt;second;</span></CodeLine>
<Link id="l02272" /><CodeLine lineNumber="2272"></CodeLine>
<Link id="l02273" /><CodeLine lineNumber="2273"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Otherwise, examine all other seen fragments for this variable, with &quot;this&quot;</span></CodeLine>
<Link id="l02274" /><CodeLine lineNumber="2274"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// fragment being a previously unseen fragment. Record any pair of</span></CodeLine>
<Link id="l02275" /><CodeLine lineNumber="2275"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// overlapping fragments.</span></CodeLine>
<Link id="l02276" /><CodeLine lineNumber="2276"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;ASeenFragment : AllSeenFragments) &#123;</span></CodeLine>
<Link id="l02277" /><CodeLine lineNumber="2277"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Does this previously seen fragment overlap?</span></CodeLine>
<Link id="l02278" /><CodeLine lineNumber="2278"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/diexpression/#a46d29699ee79b3a3d7359278f6bab01c">DIExpression::fragmentsOverlap</a>(ThisFragment, ASeenFragment)) &#123;</span></CodeLine>
<Link id="l02279" /><CodeLine lineNumber="2279"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Yes: Mark the current fragment as being overlapped.</span></CodeLine>
<Link id="l02280" /><CodeLine lineNumber="2280"><span class="doxyHighlight">      ThisFragmentsOverlaps.push&#95;back(ASeenFragment);</span></CodeLine>
<Link id="l02281" /><CodeLine lineNumber="2281"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Mark the previously seen fragment as being overlapped by the current</span></CodeLine>
<Link id="l02282" /><CodeLine lineNumber="2282"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// one.</span></CodeLine>
<Link id="l02283" /><CodeLine lineNumber="2283"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ASeenFragmentsOverlaps =</span></CodeLine>
<Link id="l02284" /><CodeLine lineNumber="2284"><span class="doxyHighlight">          OverlapFragments.find(&#123;MIVar.getVariable(), ASeenFragment&#125;);</span></CodeLine>
<Link id="l02285" /><CodeLine lineNumber="2285"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ASeenFragmentsOverlaps != OverlapFragments.end() &amp;&amp;</span></CodeLine>
<Link id="l02286" /><CodeLine lineNumber="2286"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Previously seen var fragment has no vector of overlaps&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02287" /><CodeLine lineNumber="2287"><span class="doxyHighlight">      ASeenFragmentsOverlaps-&gt;second.push&#95;back(ThisFragment);</span></CodeLine>
<Link id="l02288" /><CodeLine lineNumber="2288"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02289" /><CodeLine lineNumber="2289"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02290" /><CodeLine lineNumber="2290"></CodeLine>
<Link id="l02291" /><CodeLine lineNumber="2291"><span class="doxyHighlight">  AllSeenFragments.insert(ThisFragment);</span></CodeLine>
<Link id="l02292" /><CodeLine lineNumber="2292"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02293" /><CodeLine lineNumber="2293"></CodeLine>
<Link id="l02294" /><CodeLine lineNumber="2294"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::process(<a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>,</span></CodeLine>
<Link id="l02295" /><CodeLine lineNumber="2295"><span class="doxyHighlight">                               </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &#42;MLiveOuts,</span></CodeLine>
<Link id="l02296" /><CodeLine lineNumber="2296"><span class="doxyHighlight">                               </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &#42;MLiveIns) &#123;</span></CodeLine>
<Link id="l02297" /><CodeLine lineNumber="2297"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Try to interpret an MI as a debug or transfer instruction. Only if it&#39;s</span></CodeLine>
<Link id="l02298" /><CodeLine lineNumber="2298"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// none of these should we interpret it&#39;s register defs as new value</span></CodeLine>
<Link id="l02299" /><CodeLine lineNumber="2299"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// definitions.</span></CodeLine>
<Link id="l02300" /><CodeLine lineNumber="2300"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (transferDebugValue(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</span></CodeLine>
<Link id="l02301" /><CodeLine lineNumber="2301"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02302" /><CodeLine lineNumber="2302"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (transferDebugInstrRef(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, MLiveOuts, MLiveIns))</span></CodeLine>
<Link id="l02303" /><CodeLine lineNumber="2303"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02304" /><CodeLine lineNumber="2304"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (transferDebugPHI(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</span></CodeLine>
<Link id="l02305" /><CodeLine lineNumber="2305"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02306" /><CodeLine lineNumber="2306"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (transferRegisterCopy(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</span></CodeLine>
<Link id="l02307" /><CodeLine lineNumber="2307"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02308" /><CodeLine lineNumber="2308"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (transferSpillOrRestoreInst(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>))</span></CodeLine>
<Link id="l02309" /><CodeLine lineNumber="2309"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02310" /><CodeLine lineNumber="2310"><span class="doxyHighlight">  transferRegisterDef(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l02311" /><CodeLine lineNumber="2311"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02312" /><CodeLine lineNumber="2312"></CodeLine>
<Link id="l02313" /><CodeLine lineNumber="2313"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::produceMLocTransferFunction(</span></CodeLine>
<Link id="l02314" /><CodeLine lineNumber="2314"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;MLocTransferMap&gt;</a> &amp;MLocTransfer,</span></CodeLine>
<Link id="l02315" /><CodeLine lineNumber="2315"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>) &#123;</span></CodeLine>
<Link id="l02316" /><CodeLine lineNumber="2316"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Because we try to optimize around register mask operands by ignoring regs</span></CodeLine>
<Link id="l02317" /><CodeLine lineNumber="2317"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that aren&#39;t currently tracked, we set up something ugly for later: RegMask</span></CodeLine>
<Link id="l02318" /><CodeLine lineNumber="2318"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// operands that are seen earlier than the first use of a register, still need</span></CodeLine>
<Link id="l02319" /><CodeLine lineNumber="2319"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to clobber that register in the transfer function. But this information</span></CodeLine>
<Link id="l02320" /><CodeLine lineNumber="2320"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// isn&#39;t actively recorded. Instead, we track each RegMask used in each block,</span></CodeLine>
<Link id="l02321" /><CodeLine lineNumber="2321"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// and accumulated the clobbered but untracked registers in each block into</span></CodeLine>
<Link id="l02322" /><CodeLine lineNumber="2322"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the following bitvector. Later, if new values are tracked, we can add</span></CodeLine>
<Link id="l02323" /><CodeLine lineNumber="2323"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// appropriate clobbers.</span></CodeLine>
<Link id="l02324" /><CodeLine lineNumber="2324"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;BitVector, 32&gt;</a> BlockMasks;</span></CodeLine>
<Link id="l02325" /><CodeLine lineNumber="2325"><span class="doxyHighlight">  BlockMasks.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>);</span></CodeLine>
<Link id="l02326" /><CodeLine lineNumber="2326"></CodeLine>
<Link id="l02327" /><CodeLine lineNumber="2327"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Reserve one bit per register for the masks described above.</span></CodeLine>
<Link id="l02328" /><CodeLine lineNumber="2328"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> BVWords = <a href="/docs/api/classes/llvm/machineoperand/#a9fd1f4d5c1460886c4aa983a2027d944">MachineOperand::getRegMaskSize</a>(TRI-&gt;getNumRegs());</span></CodeLine>
<Link id="l02329" /><CodeLine lineNumber="2329"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;BV : BlockMasks)</span></CodeLine>
<Link id="l02330" /><CodeLine lineNumber="2330"><span class="doxyHighlight">    BV.resize(TRI-&gt;getNumRegs(), </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02331" /><CodeLine lineNumber="2331"></CodeLine>
<Link id="l02332" /><CodeLine lineNumber="2332"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Step through all instructions and inhale the transfer function.</span></CodeLine>
<Link id="l02333" /><CodeLine lineNumber="2333"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : MF) &#123;</span></CodeLine>
<Link id="l02334" /><CodeLine lineNumber="2334"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Object fields that are read by trackers to know where we are in the</span></CodeLine>
<Link id="l02335" /><CodeLine lineNumber="2335"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// function.</span></CodeLine>
<Link id="l02336" /><CodeLine lineNumber="2336"><span class="doxyHighlight">    CurBB = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>();</span></CodeLine>
<Link id="l02337" /><CodeLine lineNumber="2337"><span class="doxyHighlight">    CurInst = 1;</span></CodeLine>
<Link id="l02338" /><CodeLine lineNumber="2338"></CodeLine>
<Link id="l02339" /><CodeLine lineNumber="2339"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Set all machine locations to a PHI value. For transfer function</span></CodeLine>
<Link id="l02340" /><CodeLine lineNumber="2340"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// production only, this signifies the live-in value to the block.</span></CodeLine>
<Link id="l02341" /><CodeLine lineNumber="2341"><span class="doxyHighlight">    MTracker-&gt;reset();</span></CodeLine>
<Link id="l02342" /><CodeLine lineNumber="2342"><span class="doxyHighlight">    MTracker-&gt;setMPhis(CurBB);</span></CodeLine>
<Link id="l02343" /><CodeLine lineNumber="2343"></CodeLine>
<Link id="l02344" /><CodeLine lineNumber="2344"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Step through each instruction in this block.</span></CodeLine>
<Link id="l02345" /><CodeLine lineNumber="2345"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l02346" /><CodeLine lineNumber="2346"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Pass in an empty unique&#95;ptr for the value tables when accumulating the</span></CodeLine>
<Link id="l02347" /><CodeLine lineNumber="2347"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// machine transfer function.</span></CodeLine>
<Link id="l02348" /><CodeLine lineNumber="2348"><span class="doxyHighlight">      process(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02349" /><CodeLine lineNumber="2349"></CodeLine>
<Link id="l02350" /><CodeLine lineNumber="2350"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Also accumulate fragment map.</span></CodeLine>
<Link id="l02351" /><CodeLine lineNumber="2351"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.isDebugValueLike())</span></CodeLine>
<Link id="l02352" /><CodeLine lineNumber="2352"><span class="doxyHighlight">        accumulateFragmentMap(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>);</span></CodeLine>
<Link id="l02353" /><CodeLine lineNumber="2353"></CodeLine>
<Link id="l02354" /><CodeLine lineNumber="2354"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Create a map from the instruction number (if present) to the</span></CodeLine>
<Link id="l02355" /><CodeLine lineNumber="2355"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// MachineInstr and its position.</span></CodeLine>
<Link id="l02356" /><CodeLine lineNumber="2356"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (uint64&#95;t InstrNo = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.peekDebugInstrNum()) &#123;</span></CodeLine>
<Link id="l02357" /><CodeLine lineNumber="2357"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> InstrAndPos = std::make&#95;pair(&amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, CurInst);</span></CodeLine>
<Link id="l02358" /><CodeLine lineNumber="2358"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> InsertResult =</span></CodeLine>
<Link id="l02359" /><CodeLine lineNumber="2359"><span class="doxyHighlight">            DebugInstrNumToInstr.insert(std::make&#95;pair(InstrNo, InstrAndPos));</span></CodeLine>
<Link id="l02360" /><CodeLine lineNumber="2360"></CodeLine>
<Link id="l02361" /><CodeLine lineNumber="2361"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// There should never be duplicate instruction numbers.</span></CodeLine>
<Link id="l02362" /><CodeLine lineNumber="2362"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(InsertResult.second);</span></CodeLine>
<Link id="l02363" /><CodeLine lineNumber="2363"><span class="doxyHighlight">        (void)InsertResult;</span></CodeLine>
<Link id="l02364" /><CodeLine lineNumber="2364"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02365" /><CodeLine lineNumber="2365"></CodeLine>
<Link id="l02366" /><CodeLine lineNumber="2366"><span class="doxyHighlight">      ++CurInst;</span></CodeLine>
<Link id="l02367" /><CodeLine lineNumber="2367"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02368" /><CodeLine lineNumber="2368"></CodeLine>
<Link id="l02369" /><CodeLine lineNumber="2369"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Produce the transfer function, a map of machine location to new value. If</span></CodeLine>
<Link id="l02370" /><CodeLine lineNumber="2370"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// any machine location has the live-in phi value from the start of the</span></CodeLine>
<Link id="l02371" /><CodeLine lineNumber="2371"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// block, it&#39;s live-through and doesn&#39;t need recording in the transfer</span></CodeLine>
<Link id="l02372" /><CodeLine lineNumber="2372"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// function.</span></CodeLine>
<Link id="l02373" /><CodeLine lineNumber="2373"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : MTracker-&gt;locations()) &#123;</span></CodeLine>
<Link id="l02374" /><CodeLine lineNumber="2374"><span class="doxyHighlight">      LocIdx Idx = <a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx;</span></CodeLine>
<Link id="l02375" /><CodeLine lineNumber="2375"><span class="doxyHighlight">      ValueIDNum &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> = <a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Value;</span></CodeLine>
<Link id="l02376" /><CodeLine lineNumber="2376"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.isPHI() &amp;&amp; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.getLoc() == Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>())</span></CodeLine>
<Link id="l02377" /><CodeLine lineNumber="2377"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02378" /><CodeLine lineNumber="2378"></CodeLine>
<Link id="l02379" /><CodeLine lineNumber="2379"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Insert-or-update.</span></CodeLine>
<Link id="l02380" /><CodeLine lineNumber="2380"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;TransferMap = MLocTransfer&#91;CurBB&#93;;</span></CodeLine>
<Link id="l02381" /><CodeLine lineNumber="2381"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = TransferMap.insert(std::make&#95;pair(Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>(), <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>));</span></CodeLine>
<Link id="l02382" /><CodeLine lineNumber="2382"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.second)</span></CodeLine>
<Link id="l02383" /><CodeLine lineNumber="2383"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.first-&gt;second = <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>;</span></CodeLine>
<Link id="l02384" /><CodeLine lineNumber="2384"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02385" /><CodeLine lineNumber="2385"></CodeLine>
<Link id="l02386" /><CodeLine lineNumber="2386"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Accumulate any bitmask operands into the clobbered reg mask for this</span></CodeLine>
<Link id="l02387" /><CodeLine lineNumber="2387"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// block.</span></CodeLine>
<Link id="l02388" /><CodeLine lineNumber="2388"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : MTracker-&gt;Masks) &#123;</span></CodeLine>
<Link id="l02389" /><CodeLine lineNumber="2389"><span class="doxyHighlight">      BlockMasks&#91;CurBB&#93;.clearBitsNotInMask(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first-&gt;getRegMask(), BVWords);</span></CodeLine>
<Link id="l02390" /><CodeLine lineNumber="2390"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02391" /><CodeLine lineNumber="2391"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02392" /><CodeLine lineNumber="2392"></CodeLine>
<Link id="l02393" /><CodeLine lineNumber="2393"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Compute a bitvector of all the registers that are tracked in this block.</span></CodeLine>
<Link id="l02394" /><CodeLine lineNumber="2394"><span class="doxyHighlight">  BitVector UsedRegs(TRI-&gt;getNumRegs());</span></CodeLine>
<Link id="l02395" /><CodeLine lineNumber="2395"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : MTracker-&gt;locations()) &#123;</span></CodeLine>
<Link id="l02396" /><CodeLine lineNumber="2396"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> = MTracker-&gt;LocIdxToLocID&#91;<a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx&#93;;</span></CodeLine>
<Link id="l02397" /><CodeLine lineNumber="2397"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Ignore stack slots, and aliases of the stack pointer.</span></CodeLine>
<Link id="l02398" /><CodeLine lineNumber="2398"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> &gt;= TRI-&gt;getNumRegs() || MTracker-&gt;SPAliases.count(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>))</span></CodeLine>
<Link id="l02399" /><CodeLine lineNumber="2399"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02400" /><CodeLine lineNumber="2400"><span class="doxyHighlight">    UsedRegs.set(<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>);</span></CodeLine>
<Link id="l02401" /><CodeLine lineNumber="2401"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02402" /><CodeLine lineNumber="2402"></CodeLine>
<Link id="l02403" /><CodeLine lineNumber="2403"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Check that any regmask-clobber of a register that gets tracked, is not</span></CodeLine>
<Link id="l02404" /><CodeLine lineNumber="2404"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// live-through in the transfer function. It needs to be clobbered at the</span></CodeLine>
<Link id="l02405" /><CodeLine lineNumber="2405"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// very least.</span></CodeLine>
<Link id="l02406" /><CodeLine lineNumber="2406"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l02407" /><CodeLine lineNumber="2407"><span class="doxyHighlight">    BitVector &amp;BV = BlockMasks&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</span></CodeLine>
<Link id="l02408" /><CodeLine lineNumber="2408"><span class="doxyHighlight">    BV.<a href="/docs/api/classes/llvm/bitvector/#a927a42e9ba460032b09028af4e9eb57a">flip</a>();</span></CodeLine>
<Link id="l02409" /><CodeLine lineNumber="2409"><span class="doxyHighlight">    BV &amp;= UsedRegs;</span></CodeLine>
<Link id="l02410" /><CodeLine lineNumber="2410"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This produces all the bits that we clobber, but also use. Check that</span></CodeLine>
<Link id="l02411" /><CodeLine lineNumber="2411"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// they&#39;re all clobbered or at least set in the designated transfer</span></CodeLine>
<Link id="l02412" /><CodeLine lineNumber="2412"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// elem.</span></CodeLine>
<Link id="l02413" /><CodeLine lineNumber="2413"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Bit : BV.<a href="/docs/api/classes/llvm/bitvector/#aa56c07cdb4f03ddef7dfdf460811d36e">set&#95;bits</a>()) &#123;</span></CodeLine>
<Link id="l02414" /><CodeLine lineNumber="2414"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a> = MTracker-&gt;getLocID(Bit);</span></CodeLine>
<Link id="l02415" /><CodeLine lineNumber="2415"><span class="doxyHighlight">      LocIdx Idx = MTracker-&gt;LocIDToLocIdx&#91;<a href="/docs/api/namespaces/llvm/callingconv/#abdf8cf606905c10634e831390981b0ed">ID</a>&#93;;</span></CodeLine>
<Link id="l02416" /><CodeLine lineNumber="2416"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;TransferMap = MLocTransfer&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</span></CodeLine>
<Link id="l02417" /><CodeLine lineNumber="2417"></CodeLine>
<Link id="l02418" /><CodeLine lineNumber="2418"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Install a value representing the fact that this location is effectively</span></CodeLine>
<Link id="l02419" /><CodeLine lineNumber="2419"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// written to in this block. As there&#39;s no reserved value, instead use</span></CodeLine>
<Link id="l02420" /><CodeLine lineNumber="2420"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// a value number that is never generated. Pick the value number for the</span></CodeLine>
<Link id="l02421" /><CodeLine lineNumber="2421"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// first instruction in the block, def&#39;ing this location, which we know</span></CodeLine>
<Link id="l02422" /><CodeLine lineNumber="2422"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// this block never used anyway.</span></CodeLine>
<Link id="l02423" /><CodeLine lineNumber="2423"><span class="doxyHighlight">      ValueIDNum NotGeneratedNum = ValueIDNum(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, 1, Idx);</span></CodeLine>
<Link id="l02424" /><CodeLine lineNumber="2424"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> =</span></CodeLine>
<Link id="l02425" /><CodeLine lineNumber="2425"><span class="doxyHighlight">        TransferMap.insert(std::make&#95;pair(Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>(), NotGeneratedNum));</span></CodeLine>
<Link id="l02426" /><CodeLine lineNumber="2426"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.second) &#123;</span></CodeLine>
<Link id="l02427" /><CodeLine lineNumber="2427"><span class="doxyHighlight">        ValueIDNum &amp;ValueID = <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>.first-&gt;second;</span></CodeLine>
<Link id="l02428" /><CodeLine lineNumber="2428"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ValueID.<a href="/docs/api/classes/livedebugvalues/valueidnum/#acd482282b8eb9755d8ac0e82ba23c20b">getBlock</a>() == <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &amp;&amp; ValueID.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a29e1496690d23acbdb69c5b882f5bf45">isPHI</a>())</span></CodeLine>
<Link id="l02429" /><CodeLine lineNumber="2429"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// It was left as live-through. Set it to clobbered.</span></CodeLine>
<Link id="l02430" /><CodeLine lineNumber="2430"><span class="doxyHighlight">          ValueID = NotGeneratedNum;</span></CodeLine>
<Link id="l02431" /><CodeLine lineNumber="2431"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02432" /><CodeLine lineNumber="2432"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02433" /><CodeLine lineNumber="2433"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02434" /><CodeLine lineNumber="2434"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02435" /><CodeLine lineNumber="2435"></CodeLine>
<Link id="l02436" /><CodeLine lineNumber="2436"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::mlocJoin(</span></CodeLine>
<Link id="l02437" /><CodeLine lineNumber="2437"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const MachineBasicBlock &#42;, 16&gt;</a> &amp;Visited,</span></CodeLine>
<Link id="l02438" /><CodeLine lineNumber="2438"><span class="doxyHighlight">    <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;OutLocs, <a href="/docs/api/namespaces/livedebugvalues/#a7697a3c717033a44ba7f9b272c1d5331">ValueTable</a> &amp;InLocs) &#123;</span></CodeLine>
<Link id="l02439" /><CodeLine lineNumber="2439"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;join MBB: &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02440" /><CodeLine lineNumber="2440"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02441" /><CodeLine lineNumber="2441"></CodeLine>
<Link id="l02442" /><CodeLine lineNumber="2442"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Handle value-propagation when control flow merges on entry to a block. For</span></CodeLine>
<Link id="l02443" /><CodeLine lineNumber="2443"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// any location without a PHI already placed, the location has the same value</span></CodeLine>
<Link id="l02444" /><CodeLine lineNumber="2444"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// as its predecessors. If a PHI is placed, test to see whether it&#39;s now a</span></CodeLine>
<Link id="l02445" /><CodeLine lineNumber="2445"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// redundant PHI that we can eliminate.</span></CodeLine>
<Link id="l02446" /><CodeLine lineNumber="2446"></CodeLine>
<Link id="l02447" /><CodeLine lineNumber="2447"><span class="doxyHighlight">  SmallVector&lt;const MachineBasicBlock &#42;, 8&gt; BlockOrders(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#addd80df79ba902914c7d8a52e3896b79">predecessors</a>());</span></CodeLine>
<Link id="l02448" /><CodeLine lineNumber="2448"></CodeLine>
<Link id="l02449" /><CodeLine lineNumber="2449"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Visit predecessors in RPOT order.</span></CodeLine>
<Link id="l02450" /><CodeLine lineNumber="2450"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = &#91;&amp;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>) &#123;</span></CodeLine>
<Link id="l02451" /><CodeLine lineNumber="2451"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> BBToOrder.find(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>)-&gt;second &lt; BBToOrder.find(<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>)-&gt;second;</span></CodeLine>
<Link id="l02452" /><CodeLine lineNumber="2452"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l02453" /><CodeLine lineNumber="2453"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(BlockOrders, Cmp);</span></CodeLine>
<Link id="l02454" /><CodeLine lineNumber="2454"></CodeLine>
<Link id="l02455" /><CodeLine lineNumber="2455"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Skip entry block.</span></CodeLine>
<Link id="l02456" /><CodeLine lineNumber="2456"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BlockOrders.size() == 0) &#123;</span></CodeLine>
<Link id="l02457" /><CodeLine lineNumber="2457"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// FIXME: We don&#39;t use assert here to prevent instr-ref-unreachable.mir</span></CodeLine>
<Link id="l02458" /><CodeLine lineNumber="2458"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// failing.</span></CodeLine>
<Link id="l02459" /><CodeLine lineNumber="2459"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(</span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a9103c1c7b60d793b0efd41c741286508">isEntryBlock</a>()) <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>()</span></CodeLine>
<Link id="l02460" /><CodeLine lineNumber="2460"><span class="doxyHighlight">               &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Found not reachable block &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#ad2a8da74fd4e4c892018c56c977addee">getFullName</a>()</span></CodeLine>
<Link id="l02461" /><CodeLine lineNumber="2461"><span class="doxyHighlight">               &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; from entry which may lead out of &quot;</span></CodeLine>
<Link id="l02462" /><CodeLine lineNumber="2462"><span class="doxyHighlight">                  </span><span class="doxyHighlightStringLiteral">&quot;bound access to VarLocs\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02463" /><CodeLine lineNumber="2463"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02464" /><CodeLine lineNumber="2464"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02465" /><CodeLine lineNumber="2465"></CodeLine>
<Link id="l02466" /><CodeLine lineNumber="2466"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Step through all machine locations, look at each predecessor and test</span></CodeLine>
<Link id="l02467" /><CodeLine lineNumber="2467"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// whether we can eliminate redundant PHIs.</span></CodeLine>
<Link id="l02468" /><CodeLine lineNumber="2468"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : MTracker-&gt;locations()) &#123;</span></CodeLine>
<Link id="l02469" /><CodeLine lineNumber="2469"><span class="doxyHighlight">    LocIdx Idx = <a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx;</span></CodeLine>
<Link id="l02470" /><CodeLine lineNumber="2470"></CodeLine>
<Link id="l02471" /><CodeLine lineNumber="2471"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Pick out the first predecessors live-out value for this location. It&#39;s</span></CodeLine>
<Link id="l02472" /><CodeLine lineNumber="2472"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// guaranteed to not be a backedge, as we order by RPO.</span></CodeLine>
<Link id="l02473" /><CodeLine lineNumber="2473"><span class="doxyHighlight">    ValueIDNum FirstVal = OutLocs&#91;&#42;BlockOrders&#91;0&#93;&#93;&#91;Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93;;</span></CodeLine>
<Link id="l02474" /><CodeLine lineNumber="2474"></CodeLine>
<Link id="l02475" /><CodeLine lineNumber="2475"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If we&#39;ve already eliminated a PHI here, do no further checking, just</span></CodeLine>
<Link id="l02476" /><CodeLine lineNumber="2476"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// propagate the first live-in value into this block.</span></CodeLine>
<Link id="l02477" /><CodeLine lineNumber="2477"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InLocs&#91;Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93; != ValueIDNum(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>(), 0, Idx)) &#123;</span></CodeLine>
<Link id="l02478" /><CodeLine lineNumber="2478"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (InLocs&#91;Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93; != FirstVal) &#123;</span></CodeLine>
<Link id="l02479" /><CodeLine lineNumber="2479"><span class="doxyHighlight">        InLocs&#91;Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93; = FirstVal;</span></CodeLine>
<Link id="l02480" /><CodeLine lineNumber="2480"><span class="doxyHighlight">        <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> |= </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02481" /><CodeLine lineNumber="2481"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02482" /><CodeLine lineNumber="2482"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02483" /><CodeLine lineNumber="2483"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02484" /><CodeLine lineNumber="2484"></CodeLine>
<Link id="l02485" /><CodeLine lineNumber="2485"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We&#39;re now examining a PHI to see whether it&#39;s un-necessary. Loop around</span></CodeLine>
<Link id="l02486" /><CodeLine lineNumber="2486"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the other live-in values and test whether they&#39;re all the same.</span></CodeLine>
<Link id="l02487" /><CodeLine lineNumber="2487"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Disagree = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02488" /><CodeLine lineNumber="2488"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; BlockOrders.size(); ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l02489" /><CodeLine lineNumber="2489"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineBasicBlock &#42;PredMBB = BlockOrders&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</span></CodeLine>
<Link id="l02490" /><CodeLine lineNumber="2490"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> ValueIDNum &amp;PredLiveOut = OutLocs&#91;&#42;PredMBB&#93;&#91;Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93;;</span></CodeLine>
<Link id="l02491" /><CodeLine lineNumber="2491"></CodeLine>
<Link id="l02492" /><CodeLine lineNumber="2492"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Incoming values agree, continue trying to eliminate this PHI.</span></CodeLine>
<Link id="l02493" /><CodeLine lineNumber="2493"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FirstVal == PredLiveOut)</span></CodeLine>
<Link id="l02494" /><CodeLine lineNumber="2494"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02495" /><CodeLine lineNumber="2495"></CodeLine>
<Link id="l02496" /><CodeLine lineNumber="2496"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We can also accept a PHI value that feeds back into itself.</span></CodeLine>
<Link id="l02497" /><CodeLine lineNumber="2497"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (PredLiveOut == ValueIDNum(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>(), 0, Idx))</span></CodeLine>
<Link id="l02498" /><CodeLine lineNumber="2498"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02499" /><CodeLine lineNumber="2499"></CodeLine>
<Link id="l02500" /><CodeLine lineNumber="2500"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Live-out of a predecessor disagrees with the first predecessor.</span></CodeLine>
<Link id="l02501" /><CodeLine lineNumber="2501"><span class="doxyHighlight">      Disagree = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02502" /><CodeLine lineNumber="2502"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02503" /><CodeLine lineNumber="2503"></CodeLine>
<Link id="l02504" /><CodeLine lineNumber="2504"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// No disagreement? No PHI. Otherwise, leave the PHI in live-ins.</span></CodeLine>
<Link id="l02505" /><CodeLine lineNumber="2505"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Disagree) &#123;</span></CodeLine>
<Link id="l02506" /><CodeLine lineNumber="2506"><span class="doxyHighlight">      InLocs&#91;Idx.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93; = FirstVal;</span></CodeLine>
<Link id="l02507" /><CodeLine lineNumber="2507"><span class="doxyHighlight">      <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> |= </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02508" /><CodeLine lineNumber="2508"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02509" /><CodeLine lineNumber="2509"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02510" /><CodeLine lineNumber="2510"></CodeLine>
<Link id="l02511" /><CodeLine lineNumber="2511"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// TODO: Reimplement NumInserted and NumRemoved.</span></CodeLine>
<Link id="l02512" /><CodeLine lineNumber="2512"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</span></CodeLine>
<Link id="l02513" /><CodeLine lineNumber="2513"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02514" /><CodeLine lineNumber="2514"></CodeLine>
<Link id="l02515" /><CodeLine lineNumber="2515"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::findStackIndexInterference(</span></CodeLine>
<Link id="l02516" /><CodeLine lineNumber="2516"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;unsigned&gt;</a> &amp;Slots) &#123;</span></CodeLine>
<Link id="l02517" /><CodeLine lineNumber="2517"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We could spend a bit of time finding the exact, minimal, set of stack</span></CodeLine>
<Link id="l02518" /><CodeLine lineNumber="2518"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// indexes that interfere with each other, much like reg units. Or, we can</span></CodeLine>
<Link id="l02519" /><CodeLine lineNumber="2519"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// rely on the fact that:</span></CodeLine>
<Link id="l02520" /><CodeLine lineNumber="2520"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; The smallest / lowest index will interfere with everything at zero</span></CodeLine>
<Link id="l02521" /><CodeLine lineNumber="2521"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    offset, which will be the largest set of registers,</span></CodeLine>
<Link id="l02522" /><CodeLine lineNumber="2522"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; Most indexes with non-zero offset will end up being interference units</span></CodeLine>
<Link id="l02523" /><CodeLine lineNumber="2523"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    anyway.</span></CodeLine>
<Link id="l02524" /><CodeLine lineNumber="2524"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// So just pick those out and return them.</span></CodeLine>
<Link id="l02525" /><CodeLine lineNumber="2525"></CodeLine>
<Link id="l02526" /><CodeLine lineNumber="2526"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We can rely on a single-byte stack index existing already, because we</span></CodeLine>
<Link id="l02527" /><CodeLine lineNumber="2527"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// initialize them in MLocTracker.</span></CodeLine>
<Link id="l02528" /><CodeLine lineNumber="2528"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> It = MTracker-&gt;StackSlotIdxes.find(&#123;8, 0&#125;);</span></CodeLine>
<Link id="l02529" /><CodeLine lineNumber="2529"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It != MTracker-&gt;StackSlotIdxes.end());</span></CodeLine>
<Link id="l02530" /><CodeLine lineNumber="2530"><span class="doxyHighlight">  Slots.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(It-&gt;second);</span></CodeLine>
<Link id="l02531" /><CodeLine lineNumber="2531"></CodeLine>
<Link id="l02532" /><CodeLine lineNumber="2532"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Find anything that has a non-zero offset and add that too.</span></CodeLine>
<Link id="l02533" /><CodeLine lineNumber="2533"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Pair : MTracker-&gt;StackSlotIdxes) &#123;</span></CodeLine>
<Link id="l02534" /><CodeLine lineNumber="2534"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Is offset zero? If so, ignore.</span></CodeLine>
<Link id="l02535" /><CodeLine lineNumber="2535"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Pair.first.second)</span></CodeLine>
<Link id="l02536" /><CodeLine lineNumber="2536"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02537" /><CodeLine lineNumber="2537"><span class="doxyHighlight">    Slots.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(Pair.second);</span></CodeLine>
<Link id="l02538" /><CodeLine lineNumber="2538"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02539" /><CodeLine lineNumber="2539"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02540" /><CodeLine lineNumber="2540"></CodeLine>
<Link id="l02541" /><CodeLine lineNumber="2541"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::placeMLocPHIs(</span></CodeLine>
<Link id="l02542" /><CodeLine lineNumber="2542"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF, <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineBasicBlock &#42;&gt;</a> &amp;AllBlocks,</span></CodeLine>
<Link id="l02543" /><CodeLine lineNumber="2543"><span class="doxyHighlight">    <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MInLocs, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;MLocTransferMap&gt;</a> &amp;MLocTransfer) &#123;</span></CodeLine>
<Link id="l02544" /><CodeLine lineNumber="2544"><span class="doxyHighlight">  SmallVector&lt;unsigned, 4&gt; StackUnits;</span></CodeLine>
<Link id="l02545" /><CodeLine lineNumber="2545"><span class="doxyHighlight">  findStackIndexInterference(StackUnits);</span></CodeLine>
<Link id="l02546" /><CodeLine lineNumber="2546"></CodeLine>
<Link id="l02547" /><CodeLine lineNumber="2547"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// To avoid repeatedly running the PHI placement algorithm, leverage the</span></CodeLine>
<Link id="l02548" /><CodeLine lineNumber="2548"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// fact that a def of register MUST also def its register units. Find the</span></CodeLine>
<Link id="l02549" /><CodeLine lineNumber="2549"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// units for registers, place PHIs for them, and then replicate them for</span></CodeLine>
<Link id="l02550" /><CodeLine lineNumber="2550"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// aliasing registers. Some inputs that are never def&#39;d (DBG&#95;PHIs of</span></CodeLine>
<Link id="l02551" /><CodeLine lineNumber="2551"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// arguments) don&#39;t lead to register units being tracked, just place PHIs for</span></CodeLine>
<Link id="l02552" /><CodeLine lineNumber="2552"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// those registers directly. Stack slots have their own form of &quot;unit&quot;,</span></CodeLine>
<Link id="l02553" /><CodeLine lineNumber="2553"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// store them to one side.</span></CodeLine>
<Link id="l02554" /><CodeLine lineNumber="2554"><span class="doxyHighlight">  SmallSet&lt;Register, 32&gt; RegUnitsToPHIUp;</span></CodeLine>
<Link id="l02555" /><CodeLine lineNumber="2555"><span class="doxyHighlight">  SmallSet&lt;LocIdx, 32&gt; NormalLocsToPHI;</span></CodeLine>
<Link id="l02556" /><CodeLine lineNumber="2556"><span class="doxyHighlight">  SmallSet&lt;SpillLocationNo, 32&gt; StackSlots;</span></CodeLine>
<Link id="l02557" /><CodeLine lineNumber="2557"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : MTracker-&gt;locations()) &#123;</span></CodeLine>
<Link id="l02558" /><CodeLine lineNumber="2558"><span class="doxyHighlight">    LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = <a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx;</span></CodeLine>
<Link id="l02559" /><CodeLine lineNumber="2559"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MTracker-&gt;isSpill(L)) &#123;</span></CodeLine>
<Link id="l02560" /><CodeLine lineNumber="2560"><span class="doxyHighlight">      StackSlots.<a href="/docs/api/classes/llvm/smallset/#afcadfef2cf37c3e6dbdbc9cd7bea50a0">insert</a>(MTracker-&gt;locIDToSpill(MTracker-&gt;LocIdxToLocID&#91;L&#93;));</span></CodeLine>
<Link id="l02561" /><CodeLine lineNumber="2561"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02562" /><CodeLine lineNumber="2562"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02563" /><CodeLine lineNumber="2563"></CodeLine>
<Link id="l02564" /><CodeLine lineNumber="2564"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> <a href="/docs/api/namespaces/llvm/riscvfencefield/#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a> = MTracker-&gt;LocIdxToLocID&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>&#93;;</span></CodeLine>
<Link id="l02565" /><CodeLine lineNumber="2565"><span class="doxyHighlight">    SmallSet&lt;Register, 8&gt; FoundRegUnits;</span></CodeLine>
<Link id="l02566" /><CodeLine lineNumber="2566"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> AnyIllegal = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02567" /><CodeLine lineNumber="2567"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a8adc81fee7f9e66260dd2b626660c9c9">MCRegUnit</a> Unit : TRI-&gt;regunits(<a href="/docs/api/namespaces/llvm/riscvfencefield/#a147be9e9780c1e33363ea572d4c7b25fa1835091d83e0e052cd1a32c99b2be731">R</a>.asMCReg())) &#123;</span></CodeLine>
<Link id="l02568" /><CodeLine lineNumber="2568"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MCRegUnitRootIterator URoot(Unit, TRI); URoot.isValid(); ++URoot) &#123;</span></CodeLine>
<Link id="l02569" /><CodeLine lineNumber="2569"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!MTracker-&gt;isRegisterTracked(&#42;URoot)) &#123;</span></CodeLine>
<Link id="l02570" /><CodeLine lineNumber="2570"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Not all roots were loaded into the tracking map: this register</span></CodeLine>
<Link id="l02571" /><CodeLine lineNumber="2571"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// isn&#39;t actually def&#39;d anywhere, we only read from it. Generate PHIs</span></CodeLine>
<Link id="l02572" /><CodeLine lineNumber="2572"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// for this reg, but don&#39;t iterate units.</span></CodeLine>
<Link id="l02573" /><CodeLine lineNumber="2573"><span class="doxyHighlight">          AnyIllegal = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02574" /><CodeLine lineNumber="2574"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02575" /><CodeLine lineNumber="2575"><span class="doxyHighlight">          FoundRegUnits.<a href="/docs/api/classes/llvm/smallset/#afcadfef2cf37c3e6dbdbc9cd7bea50a0">insert</a>(&#42;URoot);</span></CodeLine>
<Link id="l02576" /><CodeLine lineNumber="2576"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02577" /><CodeLine lineNumber="2577"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02578" /><CodeLine lineNumber="2578"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02579" /><CodeLine lineNumber="2579"></CodeLine>
<Link id="l02580" /><CodeLine lineNumber="2580"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AnyIllegal) &#123;</span></CodeLine>
<Link id="l02581" /><CodeLine lineNumber="2581"><span class="doxyHighlight">      NormalLocsToPHI.<a href="/docs/api/classes/llvm/smallset/#afcadfef2cf37c3e6dbdbc9cd7bea50a0">insert</a>(L);</span></CodeLine>
<Link id="l02582" /><CodeLine lineNumber="2582"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02583" /><CodeLine lineNumber="2583"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02584" /><CodeLine lineNumber="2584"></CodeLine>
<Link id="l02585" /><CodeLine lineNumber="2585"><span class="doxyHighlight">    RegUnitsToPHIUp.<a href="/docs/api/classes/llvm/smallset/#afcadfef2cf37c3e6dbdbc9cd7bea50a0">insert</a>(FoundRegUnits.<a href="/docs/api/classes/llvm/smallset/#a0d7ad8e1022557e52ac17dddf1f5db2f">begin</a>(), FoundRegUnits.<a href="/docs/api/classes/llvm/smallset/#ac51f13177f0eb63f139dde87ef60a149">end</a>());</span></CodeLine>
<Link id="l02586" /><CodeLine lineNumber="2586"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02587" /><CodeLine lineNumber="2587"></CodeLine>
<Link id="l02588" /><CodeLine lineNumber="2588"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Lambda to fetch PHIs for a given location, and write into the PHIBlocks</span></CodeLine>
<Link id="l02589" /><CodeLine lineNumber="2589"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// collection.</span></CodeLine>
<Link id="l02590" /><CodeLine lineNumber="2590"><span class="doxyHighlight">  SmallVector&lt;MachineBasicBlock &#42;, 32&gt; PHIBlocks;</span></CodeLine>
<Link id="l02591" /><CodeLine lineNumber="2591"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> CollectPHIsForLoc = &#91;&amp;&#93;(LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>) &#123;</span></CodeLine>
<Link id="l02592" /><CodeLine lineNumber="2592"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Collect the set of defs.</span></CodeLine>
<Link id="l02593" /><CodeLine lineNumber="2593"><span class="doxyHighlight">    SmallPtrSet&lt;MachineBasicBlock &#42;, 32&gt; DefBlocks;</span></CodeLine>
<Link id="l02594" /><CodeLine lineNumber="2594"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; OrderToBB.size(); ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l02595" /><CodeLine lineNumber="2595"><span class="doxyHighlight">      MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = OrderToBB&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</span></CodeLine>
<Link id="l02596" /><CodeLine lineNumber="2596"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;TransferFunc = MLocTransfer&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>()&#93;;</span></CodeLine>
<Link id="l02597" /><CodeLine lineNumber="2597"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TransferFunc.contains(L))</span></CodeLine>
<Link id="l02598" /><CodeLine lineNumber="2598"><span class="doxyHighlight">        DefBlocks.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l02599" /><CodeLine lineNumber="2599"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02600" /><CodeLine lineNumber="2600"></CodeLine>
<Link id="l02601" /><CodeLine lineNumber="2601"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// The entry block defs the location too: it&#39;s the live-in / argument value.</span></CodeLine>
<Link id="l02602" /><CodeLine lineNumber="2602"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Only insert if there are other defs though; everything is trivially live</span></CodeLine>
<Link id="l02603" /><CodeLine lineNumber="2603"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// through otherwise.</span></CodeLine>
<Link id="l02604" /><CodeLine lineNumber="2604"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DefBlocks.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#af8a50544090e81ac83601aff8f4b0142">empty</a>())</span></CodeLine>
<Link id="l02605" /><CodeLine lineNumber="2605"><span class="doxyHighlight">      DefBlocks.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(&amp;&#42;MF.<a href="/docs/api/classes/llvm/machinefunction/#ab0789854909cf47f640a85fa2bac29c7">begin</a>());</span></CodeLine>
<Link id="l02606" /><CodeLine lineNumber="2606"></CodeLine>
<Link id="l02607" /><CodeLine lineNumber="2607"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Ask the SSA construction algorithm where we should put PHIs. Clear</span></CodeLine>
<Link id="l02608" /><CodeLine lineNumber="2608"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// anything that might have been hanging around from earlier.</span></CodeLine>
<Link id="l02609" /><CodeLine lineNumber="2609"><span class="doxyHighlight">    PHIBlocks.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l02610" /><CodeLine lineNumber="2610"><span class="doxyHighlight">    BlockPHIPlacement(AllBlocks, DefBlocks, PHIBlocks);</span></CodeLine>
<Link id="l02611" /><CodeLine lineNumber="2611"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l02612" /><CodeLine lineNumber="2612"></CodeLine>
<Link id="l02613" /><CodeLine lineNumber="2613"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> InstallPHIsAtLoc = &#91;&amp;PHIBlocks, &amp;MInLocs&#93;(LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>) &#123;</span></CodeLine>
<Link id="l02614" /><CodeLine lineNumber="2614"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : PHIBlocks)</span></CodeLine>
<Link id="l02615" /><CodeLine lineNumber="2615"><span class="doxyHighlight">      MInLocs&#91;&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>.asU64()&#93; = ValueIDNum(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>(), 0, L);</span></CodeLine>
<Link id="l02616" /><CodeLine lineNumber="2616"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l02617" /><CodeLine lineNumber="2617"></CodeLine>
<Link id="l02618" /><CodeLine lineNumber="2618"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For locations with no reg units, just place PHIs.</span></CodeLine>
<Link id="l02619" /><CodeLine lineNumber="2619"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (LocIdx L : NormalLocsToPHI) &#123;</span></CodeLine>
<Link id="l02620" /><CodeLine lineNumber="2620"><span class="doxyHighlight">    CollectPHIsForLoc(L);</span></CodeLine>
<Link id="l02621" /><CodeLine lineNumber="2621"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Install those PHI values into the live-in value array.</span></CodeLine>
<Link id="l02622" /><CodeLine lineNumber="2622"><span class="doxyHighlight">    InstallPHIsAtLoc(L);</span></CodeLine>
<Link id="l02623" /><CodeLine lineNumber="2623"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02624" /><CodeLine lineNumber="2624"></CodeLine>
<Link id="l02625" /><CodeLine lineNumber="2625"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For stack slots, calculate PHIs for the equivalent of the units, then</span></CodeLine>
<Link id="l02626" /><CodeLine lineNumber="2626"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// install for each index.</span></CodeLine>
<Link id="l02627" /><CodeLine lineNumber="2627"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (SpillLocationNo Slot : StackSlots) &#123;</span></CodeLine>
<Link id="l02628" /><CodeLine lineNumber="2628"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Idx : StackUnits) &#123;</span></CodeLine>
<Link id="l02629" /><CodeLine lineNumber="2629"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> SpillID = MTracker-&gt;getSpillIDWithIdx(Slot, Idx);</span></CodeLine>
<Link id="l02630" /><CodeLine lineNumber="2630"><span class="doxyHighlight">      LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = MTracker-&gt;getSpillMLoc(SpillID);</span></CodeLine>
<Link id="l02631" /><CodeLine lineNumber="2631"><span class="doxyHighlight">      CollectPHIsForLoc(L);</span></CodeLine>
<Link id="l02632" /><CodeLine lineNumber="2632"><span class="doxyHighlight">      InstallPHIsAtLoc(L);</span></CodeLine>
<Link id="l02633" /><CodeLine lineNumber="2633"></CodeLine>
<Link id="l02634" /><CodeLine lineNumber="2634"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Find anything that aliases this stack index, install PHIs for it too.</span></CodeLine>
<Link id="l02635" /><CodeLine lineNumber="2635"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>;</span></CodeLine>
<Link id="l02636" /><CodeLine lineNumber="2636"><span class="doxyHighlight">      std::tie(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>, <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a>) = MTracker-&gt;StackIdxesToPos&#91;Idx&#93;;</span></CodeLine>
<Link id="l02637" /><CodeLine lineNumber="2637"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Pair : MTracker-&gt;StackSlotIdxes) &#123;</span></CodeLine>
<Link id="l02638" /><CodeLine lineNumber="2638"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ThisSize, ThisOffset;</span></CodeLine>
<Link id="l02639" /><CodeLine lineNumber="2639"><span class="doxyHighlight">        std::tie(ThisSize, ThisOffset) = Pair.first;</span></CodeLine>
<Link id="l02640" /><CodeLine lineNumber="2640"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ThisSize + ThisOffset &lt;= <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> || <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> + <a href="/docs/api/namespaces/llvm/#a05f5b9a11bdcc5feba62899f95dcf878a3134224cba2545bc57954d3b072aebb4">Offset</a> &lt;= ThisOffset)</span></CodeLine>
<Link id="l02641" /><CodeLine lineNumber="2641"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02642" /><CodeLine lineNumber="2642"></CodeLine>
<Link id="l02643" /><CodeLine lineNumber="2643"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ThisID = MTracker-&gt;getSpillIDWithIdx(Slot, Pair.second);</span></CodeLine>
<Link id="l02644" /><CodeLine lineNumber="2644"><span class="doxyHighlight">        LocIdx ThisL = MTracker-&gt;getSpillMLoc(ThisID);</span></CodeLine>
<Link id="l02645" /><CodeLine lineNumber="2645"><span class="doxyHighlight">        InstallPHIsAtLoc(ThisL);</span></CodeLine>
<Link id="l02646" /><CodeLine lineNumber="2646"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02647" /><CodeLine lineNumber="2647"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02648" /><CodeLine lineNumber="2648"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02649" /><CodeLine lineNumber="2649"></CodeLine>
<Link id="l02650" /><CodeLine lineNumber="2650"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// For reg units, place PHIs, and then place them for any aliasing registers.</span></CodeLine>
<Link id="l02651" /><CodeLine lineNumber="2651"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/transforms/lib/transforms/utils/mem2reg-cpp/#a6fde3eb6ca09ddf2fd76432176d817bb">Register</a> R : RegUnitsToPHIUp) &#123;</span></CodeLine>
<Link id="l02652" /><CodeLine lineNumber="2652"><span class="doxyHighlight">    LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = MTracker-&gt;lookupOrTrackRegister(R);</span></CodeLine>
<Link id="l02653" /><CodeLine lineNumber="2653"><span class="doxyHighlight">    CollectPHIsForLoc(L);</span></CodeLine>
<Link id="l02654" /><CodeLine lineNumber="2654"></CodeLine>
<Link id="l02655" /><CodeLine lineNumber="2655"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Install those PHI values into the live-in value array.</span></CodeLine>
<Link id="l02656" /><CodeLine lineNumber="2656"><span class="doxyHighlight">    InstallPHIsAtLoc(L);</span></CodeLine>
<Link id="l02657" /><CodeLine lineNumber="2657"></CodeLine>
<Link id="l02658" /><CodeLine lineNumber="2658"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Now find aliases and install PHIs for those.</span></CodeLine>
<Link id="l02659" /><CodeLine lineNumber="2659"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MCRegAliasIterator RAI(R, TRI, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">); RAI.isValid(); ++RAI) &#123;</span></CodeLine>
<Link id="l02660" /><CodeLine lineNumber="2660"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Super-registers that are &quot;above&quot; the largest register read/written by</span></CodeLine>
<Link id="l02661" /><CodeLine lineNumber="2661"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// the function will alias, but will not be tracked.</span></CodeLine>
<Link id="l02662" /><CodeLine lineNumber="2662"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!MTracker-&gt;isRegisterTracked(&#42;RAI))</span></CodeLine>
<Link id="l02663" /><CodeLine lineNumber="2663"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02664" /><CodeLine lineNumber="2664"></CodeLine>
<Link id="l02665" /><CodeLine lineNumber="2665"><span class="doxyHighlight">      LocIdx AliasLoc = MTracker-&gt;lookupOrTrackRegister(&#42;RAI);</span></CodeLine>
<Link id="l02666" /><CodeLine lineNumber="2666"><span class="doxyHighlight">      InstallPHIsAtLoc(AliasLoc);</span></CodeLine>
<Link id="l02667" /><CodeLine lineNumber="2667"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02668" /><CodeLine lineNumber="2668"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02669" /><CodeLine lineNumber="2669"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02670" /><CodeLine lineNumber="2670"></CodeLine>
<Link id="l02671" /><CodeLine lineNumber="2671"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::buildMLocValueMap(</span></CodeLine>
<Link id="l02672" /><CodeLine lineNumber="2672"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF, <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MInLocs, <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MOutLocs,</span></CodeLine>
<Link id="l02673" /><CodeLine lineNumber="2673"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;MLocTransferMap&gt;</a> &amp;MLocTransfer) &#123;</span></CodeLine>
<Link id="l02674" /><CodeLine lineNumber="2674"><span class="doxyHighlight">  std::priority&#95;queue&lt;unsigned int, std::vector&lt;unsigned int&gt;,</span></CodeLine>
<Link id="l02675" /><CodeLine lineNumber="2675"><span class="doxyHighlight">                      std::greater&lt;unsigned int&gt;&gt;</span></CodeLine>
<Link id="l02676" /><CodeLine lineNumber="2676"><span class="doxyHighlight">      Worklist, Pending;</span></CodeLine>
<Link id="l02677" /><CodeLine lineNumber="2677"></CodeLine>
<Link id="l02678" /><CodeLine lineNumber="2678"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We track what is on the current and pending worklist to avoid inserting</span></CodeLine>
<Link id="l02679" /><CodeLine lineNumber="2679"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the same thing twice. We could avoid this with a custom priority queue,</span></CodeLine>
<Link id="l02680" /><CodeLine lineNumber="2680"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// but this is probably not worth it.</span></CodeLine>
<Link id="l02681" /><CodeLine lineNumber="2681"><span class="doxyHighlight">  SmallPtrSet&lt;MachineBasicBlock &#42;, 16&gt; OnPending, OnWorklist;</span></CodeLine>
<Link id="l02682" /><CodeLine lineNumber="2682"></CodeLine>
<Link id="l02683" /><CodeLine lineNumber="2683"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Initialize worklist with every block to be visited. Also produce list of</span></CodeLine>
<Link id="l02684" /><CodeLine lineNumber="2684"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// all blocks.</span></CodeLine>
<Link id="l02685" /><CodeLine lineNumber="2685"><span class="doxyHighlight">  SmallPtrSet&lt;MachineBasicBlock &#42;, 32&gt; AllBlocks;</span></CodeLine>
<Link id="l02686" /><CodeLine lineNumber="2686"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; BBToOrder.size(); ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l02687" /><CodeLine lineNumber="2687"><span class="doxyHighlight">    Worklist.push(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>);</span></CodeLine>
<Link id="l02688" /><CodeLine lineNumber="2688"><span class="doxyHighlight">    OnWorklist.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(OrderToBB&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;);</span></CodeLine>
<Link id="l02689" /><CodeLine lineNumber="2689"><span class="doxyHighlight">    AllBlocks.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(OrderToBB&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;);</span></CodeLine>
<Link id="l02690" /><CodeLine lineNumber="2690"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02691" /><CodeLine lineNumber="2691"></CodeLine>
<Link id="l02692" /><CodeLine lineNumber="2692"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Initialize entry block to PHIs. These represent arguments.</span></CodeLine>
<Link id="l02693" /><CodeLine lineNumber="2693"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : MTracker-&gt;locations())</span></CodeLine>
<Link id="l02694" /><CodeLine lineNumber="2694"><span class="doxyHighlight">    MInLocs.<a href="/docs/api/structs/livedebugvalues/funcvaluetable/#a7ca1cd1a50ea30bcf4e2909692f95685">tableForEntryMBB</a>()&#91;<a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx.asU64()&#93; =</span></CodeLine>
<Link id="l02695" /><CodeLine lineNumber="2695"><span class="doxyHighlight">        ValueIDNum(0, 0, <a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx);</span></CodeLine>
<Link id="l02696" /><CodeLine lineNumber="2696"></CodeLine>
<Link id="l02697" /><CodeLine lineNumber="2697"><span class="doxyHighlight">  MTracker-&gt;reset();</span></CodeLine>
<Link id="l02698" /><CodeLine lineNumber="2698"></CodeLine>
<Link id="l02699" /><CodeLine lineNumber="2699"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Start by placing PHIs, using the usual SSA constructor algorithm. Consider</span></CodeLine>
<Link id="l02700" /><CodeLine lineNumber="2700"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// any machine-location that isn&#39;t live-through a block to be def&#39;d in that</span></CodeLine>
<Link id="l02701" /><CodeLine lineNumber="2701"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// block.</span></CodeLine>
<Link id="l02702" /><CodeLine lineNumber="2702"><span class="doxyHighlight">  placeMLocPHIs(MF, AllBlocks, MInLocs, MLocTransfer);</span></CodeLine>
<Link id="l02703" /><CodeLine lineNumber="2703"></CodeLine>
<Link id="l02704" /><CodeLine lineNumber="2704"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Propagate values to eliminate redundant PHIs. At the same time, this</span></CodeLine>
<Link id="l02705" /><CodeLine lineNumber="2705"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// produces the table of Block x Location =&gt; Value for the entry to each</span></CodeLine>
<Link id="l02706" /><CodeLine lineNumber="2706"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// block.</span></CodeLine>
<Link id="l02707" /><CodeLine lineNumber="2707"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The kind of PHIs we can eliminate are, for example, where one path in a</span></CodeLine>
<Link id="l02708" /><CodeLine lineNumber="2708"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// conditional spills and restores a register, and the register still has</span></CodeLine>
<Link id="l02709" /><CodeLine lineNumber="2709"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the same value once control flow joins, unbeknowns to the PHI placement</span></CodeLine>
<Link id="l02710" /><CodeLine lineNumber="2710"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// code. Propagating values allows us to identify such un-necessary PHIs and</span></CodeLine>
<Link id="l02711" /><CodeLine lineNumber="2711"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// remove them.</span></CodeLine>
<Link id="l02712" /><CodeLine lineNumber="2712"><span class="doxyHighlight">  SmallPtrSet&lt;const MachineBasicBlock &#42;, 16&gt; Visited;</span></CodeLine>
<Link id="l02713" /><CodeLine lineNumber="2713"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!Worklist.empty() || !Pending.empty()) &#123;</span></CodeLine>
<Link id="l02714" /><CodeLine lineNumber="2714"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Vector for storing the evaluated block transfer function.</span></CodeLine>
<Link id="l02715" /><CodeLine lineNumber="2715"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;std::pair&lt;LocIdx, ValueIDNum&gt;</a>, 32&gt; ToRemap;</span></CodeLine>
<Link id="l02716" /><CodeLine lineNumber="2716"></CodeLine>
<Link id="l02717" /><CodeLine lineNumber="2717"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!Worklist.empty()) &#123;</span></CodeLine>
<Link id="l02718" /><CodeLine lineNumber="2718"><span class="doxyHighlight">      MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = OrderToBB&#91;Worklist.top()&#93;;</span></CodeLine>
<Link id="l02719" /><CodeLine lineNumber="2719"><span class="doxyHighlight">      CurBB = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>();</span></CodeLine>
<Link id="l02720" /><CodeLine lineNumber="2720"><span class="doxyHighlight">      Worklist.pop();</span></CodeLine>
<Link id="l02721" /><CodeLine lineNumber="2721"></CodeLine>
<Link id="l02722" /><CodeLine lineNumber="2722"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Join the values in all predecessor blocks.</span></CodeLine>
<Link id="l02723" /><CodeLine lineNumber="2723"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InLocsChanged;</span></CodeLine>
<Link id="l02724" /><CodeLine lineNumber="2724"><span class="doxyHighlight">      InLocsChanged = mlocJoin(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, Visited, MOutLocs, MInLocs&#91;&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;);</span></CodeLine>
<Link id="l02725" /><CodeLine lineNumber="2725"><span class="doxyHighlight">      InLocsChanged |= Visited.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>).second;</span></CodeLine>
<Link id="l02726" /><CodeLine lineNumber="2726"></CodeLine>
<Link id="l02727" /><CodeLine lineNumber="2727"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Don&#39;t examine transfer function if we&#39;ve visited this loc at least</span></CodeLine>
<Link id="l02728" /><CodeLine lineNumber="2728"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// once, and inlocs haven&#39;t changed.</span></CodeLine>
<Link id="l02729" /><CodeLine lineNumber="2729"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!InLocsChanged)</span></CodeLine>
<Link id="l02730" /><CodeLine lineNumber="2730"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02731" /><CodeLine lineNumber="2731"></CodeLine>
<Link id="l02732" /><CodeLine lineNumber="2732"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Load the current set of live-ins into MLocTracker.</span></CodeLine>
<Link id="l02733" /><CodeLine lineNumber="2733"><span class="doxyHighlight">      MTracker-&gt;loadFromArray(MInLocs&#91;&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;, CurBB);</span></CodeLine>
<Link id="l02734" /><CodeLine lineNumber="2734"></CodeLine>
<Link id="l02735" /><CodeLine lineNumber="2735"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Each element of the transfer function can be a new def, or a read of</span></CodeLine>
<Link id="l02736" /><CodeLine lineNumber="2736"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// a live-in value. Evaluate each element, and store to &quot;ToRemap&quot;.</span></CodeLine>
<Link id="l02737" /><CodeLine lineNumber="2737"><span class="doxyHighlight">      ToRemap.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l02738" /><CodeLine lineNumber="2738"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : MLocTransfer&#91;CurBB&#93;) &#123;</span></CodeLine>
<Link id="l02739" /><CodeLine lineNumber="2739"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second.getBlock() == CurBB &amp;&amp; <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second.isPHI()) &#123;</span></CodeLine>
<Link id="l02740" /><CodeLine lineNumber="2740"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// This is a movement of whatever was live in. Read it.</span></CodeLine>
<Link id="l02741" /><CodeLine lineNumber="2741"><span class="doxyHighlight">          ValueIDNum NewID = MTracker-&gt;readMLoc(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second.getLoc());</span></CodeLine>
<Link id="l02742" /><CodeLine lineNumber="2742"><span class="doxyHighlight">          ToRemap.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(std::make&#95;pair(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first, NewID));</span></CodeLine>
<Link id="l02743" /><CodeLine lineNumber="2743"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02744" /><CodeLine lineNumber="2744"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// It&#39;s a def. Just set it.</span></CodeLine>
<Link id="l02745" /><CodeLine lineNumber="2745"><span class="doxyHighlight">          <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second.getBlock() == CurBB);</span></CodeLine>
<Link id="l02746" /><CodeLine lineNumber="2746"><span class="doxyHighlight">          ToRemap.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(std::make&#95;pair(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first, <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second));</span></CodeLine>
<Link id="l02747" /><CodeLine lineNumber="2747"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02748" /><CodeLine lineNumber="2748"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02749" /><CodeLine lineNumber="2749"></CodeLine>
<Link id="l02750" /><CodeLine lineNumber="2750"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Commit the transfer function changes into mloc tracker, which</span></CodeLine>
<Link id="l02751" /><CodeLine lineNumber="2751"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// transforms the contents of the MLocTracker into the live-outs.</span></CodeLine>
<Link id="l02752" /><CodeLine lineNumber="2752"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : ToRemap)</span></CodeLine>
<Link id="l02753" /><CodeLine lineNumber="2753"><span class="doxyHighlight">        MTracker-&gt;setMLoc(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first, <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second);</span></CodeLine>
<Link id="l02754" /><CodeLine lineNumber="2754"></CodeLine>
<Link id="l02755" /><CodeLine lineNumber="2755"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Now copy out-locs from mloc tracker into out-loc vector, checking</span></CodeLine>
<Link id="l02756" /><CodeLine lineNumber="2756"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// whether changes have occurred. These changes can have come from both</span></CodeLine>
<Link id="l02757" /><CodeLine lineNumber="2757"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// the transfer function, and mlocJoin.</span></CodeLine>
<Link id="l02758" /><CodeLine lineNumber="2758"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> OLChanged = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02759" /><CodeLine lineNumber="2759"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> Location : MTracker-&gt;locations()) &#123;</span></CodeLine>
<Link id="l02760" /><CodeLine lineNumber="2760"><span class="doxyHighlight">        OLChanged |= MOutLocs&#91;&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;&#91;<a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx.asU64()&#93; != <a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Value;</span></CodeLine>
<Link id="l02761" /><CodeLine lineNumber="2761"><span class="doxyHighlight">        MOutLocs&#91;&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;&#91;<a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Idx.asU64()&#93; = <a href="/docs/api/namespaces/anonymous-x86discriminatememops-cpp-/#aa0e9eb09c84a691bb23afcad7d960e03">Location</a>.Value;</span></CodeLine>
<Link id="l02762" /><CodeLine lineNumber="2762"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02763" /><CodeLine lineNumber="2763"></CodeLine>
<Link id="l02764" /><CodeLine lineNumber="2764"><span class="doxyHighlight">      MTracker-&gt;reset();</span></CodeLine>
<Link id="l02765" /><CodeLine lineNumber="2765"></CodeLine>
<Link id="l02766" /><CodeLine lineNumber="2766"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// No need to examine successors again if out-locs didn&#39;t change.</span></CodeLine>
<Link id="l02767" /><CodeLine lineNumber="2767"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!OLChanged)</span></CodeLine>
<Link id="l02768" /><CodeLine lineNumber="2768"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02769" /><CodeLine lineNumber="2769"></CodeLine>
<Link id="l02770" /><CodeLine lineNumber="2770"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// All successors should be visited: put any back-edges on the pending</span></CodeLine>
<Link id="l02771" /><CodeLine lineNumber="2771"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// list for the next pass-through, and any other successors to be</span></CodeLine>
<Link id="l02772" /><CodeLine lineNumber="2772"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// visited this pass, if they&#39;re not going to be already.</span></CodeLine>
<Link id="l02773" /><CodeLine lineNumber="2773"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;s : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#ad88ff1529541fb4e243cc8ed90b11131">successors</a>()) &#123;</span></CodeLine>
<Link id="l02774" /><CodeLine lineNumber="2774"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Does branching to this successor represent a back-edge?</span></CodeLine>
<Link id="l02775" /><CodeLine lineNumber="2775"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BBToOrder&#91;s&#93; &gt; BBToOrder&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;) &#123;</span></CodeLine>
<Link id="l02776" /><CodeLine lineNumber="2776"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// No: visit it during this dataflow iteration.</span></CodeLine>
<Link id="l02777" /><CodeLine lineNumber="2777"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OnWorklist.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(s).second)</span></CodeLine>
<Link id="l02778" /><CodeLine lineNumber="2778"><span class="doxyHighlight">            Worklist.push(BBToOrder&#91;s&#93;);</span></CodeLine>
<Link id="l02779" /><CodeLine lineNumber="2779"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02780" /><CodeLine lineNumber="2780"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Yes: visit it on the next iteration.</span></CodeLine>
<Link id="l02781" /><CodeLine lineNumber="2781"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OnPending.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(s).second)</span></CodeLine>
<Link id="l02782" /><CodeLine lineNumber="2782"><span class="doxyHighlight">            Pending.push(BBToOrder&#91;s&#93;);</span></CodeLine>
<Link id="l02783" /><CodeLine lineNumber="2783"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l02784" /><CodeLine lineNumber="2784"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02785" /><CodeLine lineNumber="2785"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02786" /><CodeLine lineNumber="2786"></CodeLine>
<Link id="l02787" /><CodeLine lineNumber="2787"><span class="doxyHighlight">    Worklist.swap(Pending);</span></CodeLine>
<Link id="l02788" /><CodeLine lineNumber="2788"><span class="doxyHighlight">    <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(OnPending, OnWorklist);</span></CodeLine>
<Link id="l02789" /><CodeLine lineNumber="2789"><span class="doxyHighlight">    OnPending.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</span></CodeLine>
<Link id="l02790" /><CodeLine lineNumber="2790"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// At this point, pending must be empty, since it was just the empty</span></CodeLine>
<Link id="l02791" /><CodeLine lineNumber="2791"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// worklist</span></CodeLine>
<Link id="l02792" /><CodeLine lineNumber="2792"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Pending.empty() &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Pending should be empty&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02793" /><CodeLine lineNumber="2793"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02794" /><CodeLine lineNumber="2794"></CodeLine>
<Link id="l02795" /><CodeLine lineNumber="2795"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Once all the live-ins don&#39;t change on mlocJoin(), we&#39;ve eliminated all</span></CodeLine>
<Link id="l02796" /><CodeLine lineNumber="2796"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// redundant PHIs.</span></CodeLine>
<Link id="l02797" /><CodeLine lineNumber="2797"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02798" /><CodeLine lineNumber="2798"></CodeLine>
<Link id="l02799" /><CodeLine lineNumber="2799"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::BlockPHIPlacement(</span></CodeLine>
<Link id="l02800" /><CodeLine lineNumber="2800"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineBasicBlock &#42;&gt;</a> &amp;AllBlocks,</span></CodeLine>
<Link id="l02801" /><CodeLine lineNumber="2801"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineBasicBlock &#42;&gt;</a> &amp;DefBlocks,</span></CodeLine>
<Link id="l02802" /><CodeLine lineNumber="2802"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;MachineBasicBlock &#42;&gt;</a> &amp;PHIBlocks) &#123;</span></CodeLine>
<Link id="l02803" /><CodeLine lineNumber="2803"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Apply IDF calculator to the designated set of location defs, storing</span></CodeLine>
<Link id="l02804" /><CodeLine lineNumber="2804"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// required PHIs into PHIBlocks. Uses the dominator tree stored in the</span></CodeLine>
<Link id="l02805" /><CodeLine lineNumber="2805"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// InstrRefBasedLDV object.</span></CodeLine>
<Link id="l02806" /><CodeLine lineNumber="2806"><span class="doxyHighlight">  IDFCalculatorBase&lt;MachineBasicBlock, false&gt; IDF(&#42;DomTree);</span></CodeLine>
<Link id="l02807" /><CodeLine lineNumber="2807"></CodeLine>
<Link id="l02808" /><CodeLine lineNumber="2808"><span class="doxyHighlight">  IDF.setLiveInBlocks(AllBlocks);</span></CodeLine>
<Link id="l02809" /><CodeLine lineNumber="2809"><span class="doxyHighlight">  IDF.setDefiningBlocks(DefBlocks);</span></CodeLine>
<Link id="l02810" /><CodeLine lineNumber="2810"><span class="doxyHighlight">  IDF.calculate(PHIBlocks);</span></CodeLine>
<Link id="l02811" /><CodeLine lineNumber="2811"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02812" /><CodeLine lineNumber="2812"></CodeLine>
<Link id="l02813" /><CodeLine lineNumber="2813"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::pickVPHILoc(</span></CodeLine>
<Link id="l02814" /><CodeLine lineNumber="2814"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;DbgOpID&gt;</a> &amp;OutValues, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>,</span></CodeLine>
<Link id="l02815" /><CodeLine lineNumber="2815"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LiveIdxT &amp;LiveOuts, <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MOutLocs,</span></CodeLine>
<Link id="l02816" /><CodeLine lineNumber="2816"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const MachineBasicBlock &#42;&gt;</a> &amp;BlockOrders) &#123;</span></CodeLine>
<Link id="l02817" /><CodeLine lineNumber="2817"></CodeLine>
<Link id="l02818" /><CodeLine lineNumber="2818"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// No predecessors means no PHIs.</span></CodeLine>
<Link id="l02819" /><CodeLine lineNumber="2819"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BlockOrders.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</span></CodeLine>
<Link id="l02820" /><CodeLine lineNumber="2820"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02821" /><CodeLine lineNumber="2821"></CodeLine>
<Link id="l02822" /><CodeLine lineNumber="2822"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// All the location operands that do not already agree need to be joined,</span></CodeLine>
<Link id="l02823" /><CodeLine lineNumber="2823"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// track the indices of each such location operand here.</span></CodeLine>
<Link id="l02824" /><CodeLine lineNumber="2824"><span class="doxyHighlight">  SmallDenseSet&lt;unsigned&gt; LocOpsToJoin;</span></CodeLine>
<Link id="l02825" /><CodeLine lineNumber="2825"></CodeLine>
<Link id="l02826" /><CodeLine lineNumber="2826"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> FirstValueIt = LiveOuts.find(BlockOrders&#91;0&#93;);</span></CodeLine>
<Link id="l02827" /><CodeLine lineNumber="2827"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FirstValueIt == LiveOuts.end())</span></CodeLine>
<Link id="l02828" /><CodeLine lineNumber="2828"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02829" /><CodeLine lineNumber="2829"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DbgValue &amp;FirstValue = &#42;FirstValueIt-&gt;second;</span></CodeLine>
<Link id="l02830" /><CodeLine lineNumber="2830"></CodeLine>
<Link id="l02831" /><CodeLine lineNumber="2831"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> p : BlockOrders) &#123;</span></CodeLine>
<Link id="l02832" /><CodeLine lineNumber="2832"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> OutValIt = LiveOuts.find(p);</span></CodeLine>
<Link id="l02833" /><CodeLine lineNumber="2833"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OutValIt == LiveOuts.end())</span></CodeLine>
<Link id="l02834" /><CodeLine lineNumber="2834"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If we have a predecessor not in scope, we&#39;ll never find a PHI position.</span></CodeLine>
<Link id="l02835" /><CodeLine lineNumber="2835"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02836" /><CodeLine lineNumber="2836"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DbgValue &amp;OutVal = &#42;OutValIt-&gt;second;</span></CodeLine>
<Link id="l02837" /><CodeLine lineNumber="2837"></CodeLine>
<Link id="l02838" /><CodeLine lineNumber="2838"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// No-values cannot have locations we can join on.</span></CodeLine>
<Link id="l02839" /><CodeLine lineNumber="2839"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bbaf26793ed3fb3ea880eb66562c90d1826">DbgValue::NoVal</a>)</span></CodeLine>
<Link id="l02840" /><CodeLine lineNumber="2840"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02841" /><CodeLine lineNumber="2841"></CodeLine>
<Link id="l02842" /><CodeLine lineNumber="2842"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// For unjoined VPHIs where we don&#39;t know the location, we definitely</span></CodeLine>
<Link id="l02843" /><CodeLine lineNumber="2843"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// can&#39;t find a join loc unless the VPHI is a backedge.</span></CodeLine>
<Link id="l02844" /><CodeLine lineNumber="2844"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#aa11be25d68038f30cb3e3cbe1e28839b">isUnjoinedPHI</a>() &amp;&amp; OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a0867a91c94f59efa8118215449f8b1d6">BlockNo</a> != <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>())</span></CodeLine>
<Link id="l02845" /><CodeLine lineNumber="2845"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02846" /><CodeLine lineNumber="2846"></CodeLine>
<Link id="l02847" /><CodeLine lineNumber="2847"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!FirstValue.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a127bb33bfa67d26975c12bf33568af48">Properties</a>.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#aa487b5a6fe6c9f4fac7f809c488f3029">isJoinable</a>(OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a127bb33bfa67d26975c12bf33568af48">Properties</a>))</span></CodeLine>
<Link id="l02848" /><CodeLine lineNumber="2848"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02849" /><CodeLine lineNumber="2849"></CodeLine>
<Link id="l02850" /><CodeLine lineNumber="2850"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Idx = 0; Idx &lt; FirstValue.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#add403fcd8074cf38d737756d931a013f">getLocationOpCount</a>(); ++Idx) &#123;</span></CodeLine>
<Link id="l02851" /><CodeLine lineNumber="2851"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// An unjoined PHI has no defined locations, and so a shared location must</span></CodeLine>
<Link id="l02852" /><CodeLine lineNumber="2852"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// be found for every operand.</span></CodeLine>
<Link id="l02853" /><CodeLine lineNumber="2853"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#aa11be25d68038f30cb3e3cbe1e28839b">isUnjoinedPHI</a>()) &#123;</span></CodeLine>
<Link id="l02854" /><CodeLine lineNumber="2854"><span class="doxyHighlight">        LocOpsToJoin.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(Idx);</span></CodeLine>
<Link id="l02855" /><CodeLine lineNumber="2855"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02856" /><CodeLine lineNumber="2856"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02857" /><CodeLine lineNumber="2857"><span class="doxyHighlight">      DbgOpID FirstValOp = FirstValue.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#aa70e8b6292c37300a3ea50fce69b2cdd">getDbgOpID</a>(Idx);</span></CodeLine>
<Link id="l02858" /><CodeLine lineNumber="2858"><span class="doxyHighlight">      DbgOpID OutValOp = OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#aa70e8b6292c37300a3ea50fce69b2cdd">getDbgOpID</a>(Idx);</span></CodeLine>
<Link id="l02859" /><CodeLine lineNumber="2859"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FirstValOp != OutValOp) &#123;</span></CodeLine>
<Link id="l02860" /><CodeLine lineNumber="2860"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We can never join constant ops - the ops must either both be equal</span></CodeLine>
<Link id="l02861" /><CodeLine lineNumber="2861"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// constant ops or non-const ops.</span></CodeLine>
<Link id="l02862" /><CodeLine lineNumber="2862"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (FirstValOp.<a href="/docs/api/structs/livedebugvalues/dbgopid/#aa91469b374d4e14c8e445dc79420c850">isConst</a>() || OutValOp.<a href="/docs/api/structs/livedebugvalues/dbgopid/#aa91469b374d4e14c8e445dc79420c850">isConst</a>())</span></CodeLine>
<Link id="l02863" /><CodeLine lineNumber="2863"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02864" /><CodeLine lineNumber="2864"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">else</span></CodeLine>
<Link id="l02865" /><CodeLine lineNumber="2865"><span class="doxyHighlight">          LocOpsToJoin.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(Idx);</span></CodeLine>
<Link id="l02866" /><CodeLine lineNumber="2866"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02867" /><CodeLine lineNumber="2867"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02868" /><CodeLine lineNumber="2868"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02869" /><CodeLine lineNumber="2869"></CodeLine>
<Link id="l02870" /><CodeLine lineNumber="2870"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;DbgOpID&gt;</a> NewDbgOps;</span></CodeLine>
<Link id="l02871" /><CodeLine lineNumber="2871"></CodeLine>
<Link id="l02872" /><CodeLine lineNumber="2872"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Idx = 0; Idx &lt; FirstValue.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#add403fcd8074cf38d737756d931a013f">getLocationOpCount</a>(); ++Idx) &#123;</span></CodeLine>
<Link id="l02873" /><CodeLine lineNumber="2873"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If this op doesn&#39;t need to be joined because the values agree, use that</span></CodeLine>
<Link id="l02874" /><CodeLine lineNumber="2874"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// already-agreed value.</span></CodeLine>
<Link id="l02875" /><CodeLine lineNumber="2875"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LocOpsToJoin.<a href="/docs/api/classes/llvm/detail/densesetimpl/#ad409c2de8502b94c8a0b1193307c63b6">contains</a>(Idx)) &#123;</span></CodeLine>
<Link id="l02876" /><CodeLine lineNumber="2876"><span class="doxyHighlight">      NewDbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(FirstValue.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#aa70e8b6292c37300a3ea50fce69b2cdd">getDbgOpID</a>(Idx));</span></CodeLine>
<Link id="l02877" /><CodeLine lineNumber="2877"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02878" /><CodeLine lineNumber="2878"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02879" /><CodeLine lineNumber="2879"></CodeLine>
<Link id="l02880" /><CodeLine lineNumber="2880"><span class="doxyHighlight">    std::optional&lt;ValueIDNum&gt; JoinedOpLoc =</span></CodeLine>
<Link id="l02881" /><CodeLine lineNumber="2881"><span class="doxyHighlight">        pickOperandPHILoc(Idx, <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, LiveOuts, MOutLocs, BlockOrders);</span></CodeLine>
<Link id="l02882" /><CodeLine lineNumber="2882"></CodeLine>
<Link id="l02883" /><CodeLine lineNumber="2883"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!JoinedOpLoc)</span></CodeLine>
<Link id="l02884" /><CodeLine lineNumber="2884"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02885" /><CodeLine lineNumber="2885"></CodeLine>
<Link id="l02886" /><CodeLine lineNumber="2886"><span class="doxyHighlight">    NewDbgOps.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(DbgOpStore.insert(&#42;JoinedOpLoc));</span></CodeLine>
<Link id="l02887" /><CodeLine lineNumber="2887"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02888" /><CodeLine lineNumber="2888"></CodeLine>
<Link id="l02889" /><CodeLine lineNumber="2889"><span class="doxyHighlight">  OutValues.<a href="/docs/api/classes/llvm/smallvectorimpl/#a7efd1f0c1206d95e4fe01a9b49a57b82">append</a>(NewDbgOps);</span></CodeLine>
<Link id="l02890" /><CodeLine lineNumber="2890"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02891" /><CodeLine lineNumber="2891"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02892" /><CodeLine lineNumber="2892"></CodeLine>
<Link id="l02893" /><CodeLine lineNumber="2893"><span class="doxyHighlight">std::optional&lt;ValueIDNum&gt; InstrRefBasedLDV::pickOperandPHILoc(</span></CodeLine>
<Link id="l02894" /><CodeLine lineNumber="2894"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> DbgOpIdx, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> LiveIdxT &amp;LiveOuts,</span></CodeLine>
<Link id="l02895" /><CodeLine lineNumber="2895"><span class="doxyHighlight">    <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MOutLocs,</span></CodeLine>
<Link id="l02896" /><CodeLine lineNumber="2896"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;const MachineBasicBlock &#42;&gt;</a> &amp;BlockOrders) &#123;</span></CodeLine>
<Link id="l02897" /><CodeLine lineNumber="2897"></CodeLine>
<Link id="l02898" /><CodeLine lineNumber="2898"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Collect a set of locations from predecessor where its live-out value can</span></CodeLine>
<Link id="l02899" /><CodeLine lineNumber="2899"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// be found.</span></CodeLine>
<Link id="l02900" /><CodeLine lineNumber="2900"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;SmallVector&lt;LocIdx, 4&gt;</a>, 8&gt; Locs;</span></CodeLine>
<Link id="l02901" /><CodeLine lineNumber="2901"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumLocs = MTracker-&gt;getNumLocs();</span></CodeLine>
<Link id="l02902" /><CodeLine lineNumber="2902"></CodeLine>
<Link id="l02903" /><CodeLine lineNumber="2903"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> p : BlockOrders) &#123;</span></CodeLine>
<Link id="l02904" /><CodeLine lineNumber="2904"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> OutValIt = LiveOuts.find(p);</span></CodeLine>
<Link id="l02905" /><CodeLine lineNumber="2905"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutValIt != LiveOuts.end());</span></CodeLine>
<Link id="l02906" /><CodeLine lineNumber="2906"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DbgValue &amp;OutVal = &#42;OutValIt-&gt;second;</span></CodeLine>
<Link id="l02907" /><CodeLine lineNumber="2907"><span class="doxyHighlight">    DbgOpID OutValOpID = OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#aa70e8b6292c37300a3ea50fce69b2cdd">getDbgOpID</a>(DbgOpIdx);</span></CodeLine>
<Link id="l02908" /><CodeLine lineNumber="2908"><span class="doxyHighlight">    DbgOp OutValOp = DbgOpStore.find(OutValOpID);</span></CodeLine>
<Link id="l02909" /><CodeLine lineNumber="2909"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(!OutValOp.<a href="/docs/api/structs/livedebugvalues/dbgop/#aa155f40c0f7c56ae215ee41a52d5f9ad">IsConst</a>);</span></CodeLine>
<Link id="l02910" /><CodeLine lineNumber="2910"></CodeLine>
<Link id="l02911" /><CodeLine lineNumber="2911"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Create new empty vector of locations.</span></CodeLine>
<Link id="l02912" /><CodeLine lineNumber="2912"><span class="doxyHighlight">    Locs.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(Locs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() + 1);</span></CodeLine>
<Link id="l02913" /><CodeLine lineNumber="2913"></CodeLine>
<Link id="l02914" /><CodeLine lineNumber="2914"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the live-in value is a def, find the locations where that value is</span></CodeLine>
<Link id="l02915" /><CodeLine lineNumber="2915"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// present. Do the same for VPHIs where we know the VPHI value.</span></CodeLine>
<Link id="l02916" /><CodeLine lineNumber="2916"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba953f120c5617d3f2b42df3fd424222ad">DbgValue::Def</a> ||</span></CodeLine>
<Link id="l02917" /><CodeLine lineNumber="2917"><span class="doxyHighlight">        (OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">DbgValue::VPHI</a> &amp;&amp; OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a0867a91c94f59efa8118215449f8b1d6">BlockNo</a> != <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>() &amp;&amp;</span></CodeLine>
<Link id="l02918" /><CodeLine lineNumber="2918"><span class="doxyHighlight">         !OutValOp.<a href="/docs/api/structs/livedebugvalues/dbgop/#a4e137fe2e3773e0a6f40980d2e99083d">isUndef</a>())) &#123;</span></CodeLine>
<Link id="l02919" /><CodeLine lineNumber="2919"><span class="doxyHighlight">      ValueIDNum ValToLookFor = OutValOp.<a href="/docs/api/structs/livedebugvalues/dbgop/#a17b174ad71c91584d987861d5e8e5d2d">ID</a>;</span></CodeLine>
<Link id="l02920" /><CodeLine lineNumber="2920"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Search the live-outs of the predecessor for the specified value.</span></CodeLine>
<Link id="l02921" /><CodeLine lineNumber="2921"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumLocs; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l02922" /><CodeLine lineNumber="2922"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MOutLocs&#91;&#42;p&#93;&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; == ValToLookFor)</span></CodeLine>
<Link id="l02923" /><CodeLine lineNumber="2923"><span class="doxyHighlight">          Locs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>().push&#95;back(LocIdx(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</span></CodeLine>
<Link id="l02924" /><CodeLine lineNumber="2924"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02925" /><CodeLine lineNumber="2925"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l02926" /><CodeLine lineNumber="2926"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(OutVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">DbgValue::VPHI</a>);</span></CodeLine>
<Link id="l02927" /><CodeLine lineNumber="2927"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Otherwise: this is a VPHI on a backedge feeding back into itself, i.e.</span></CodeLine>
<Link id="l02928" /><CodeLine lineNumber="2928"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// a value that&#39;s live-through the whole loop. (It has to be a backedge,</span></CodeLine>
<Link id="l02929" /><CodeLine lineNumber="2929"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// because a block can&#39;t dominate itself). We can accept as a PHI location</span></CodeLine>
<Link id="l02930" /><CodeLine lineNumber="2930"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// any location where the other predecessors agree, &#95;and&#95; the machine</span></CodeLine>
<Link id="l02931" /><CodeLine lineNumber="2931"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// locations feed back into themselves. Therefore, add all self-looping</span></CodeLine>
<Link id="l02932" /><CodeLine lineNumber="2932"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// machine-value PHI locations.</span></CodeLine>
<Link id="l02933" /><CodeLine lineNumber="2933"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumLocs; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l02934" /><CodeLine lineNumber="2934"><span class="doxyHighlight">        ValueIDNum MPHI(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>(), 0, LocIdx(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</span></CodeLine>
<Link id="l02935" /><CodeLine lineNumber="2935"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MOutLocs&#91;&#42;p&#93;&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; == MPHI)</span></CodeLine>
<Link id="l02936" /><CodeLine lineNumber="2936"><span class="doxyHighlight">          Locs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>().push&#95;back(LocIdx(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>));</span></CodeLine>
<Link id="l02937" /><CodeLine lineNumber="2937"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l02938" /><CodeLine lineNumber="2938"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02939" /><CodeLine lineNumber="2939"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02940" /><CodeLine lineNumber="2940"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We should have found locations for all predecessors, or returned.</span></CodeLine>
<Link id="l02941" /><CodeLine lineNumber="2941"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Locs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == BlockOrders.size());</span></CodeLine>
<Link id="l02942" /><CodeLine lineNumber="2942"></CodeLine>
<Link id="l02943" /><CodeLine lineNumber="2943"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Starting with the first set of locations, take the intersection with</span></CodeLine>
<Link id="l02944" /><CodeLine lineNumber="2944"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// subsequent sets.</span></CodeLine>
<Link id="l02945" /><CodeLine lineNumber="2945"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;LocIdx, 4&gt;</a> CandidateLocs = Locs&#91;0&#93;;</span></CodeLine>
<Link id="l02946" /><CodeLine lineNumber="2946"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 1; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; Locs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>(); ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l02947" /><CodeLine lineNumber="2947"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;LocVec = Locs&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</span></CodeLine>
<Link id="l02948" /><CodeLine lineNumber="2948"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;LocIdx, 4&gt;</a> NewCandidates;</span></CodeLine>
<Link id="l02949" /><CodeLine lineNumber="2949"><span class="doxyHighlight">    std::set&#95;intersection(CandidateLocs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>(), CandidateLocs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a075e34e98605d0e7c289763a104869ac">end</a>(),</span></CodeLine>
<Link id="l02950" /><CodeLine lineNumber="2950"><span class="doxyHighlight">                          LocVec.begin(), LocVec.end(), std::inserter(NewCandidates, NewCandidates.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>()));</span></CodeLine>
<Link id="l02951" /><CodeLine lineNumber="2951"><span class="doxyHighlight">    CandidateLocs = std::move(NewCandidates);</span></CodeLine>
<Link id="l02952" /><CodeLine lineNumber="2952"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l02953" /><CodeLine lineNumber="2953"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CandidateLocs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>())</span></CodeLine>
<Link id="l02954" /><CodeLine lineNumber="2954"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l02955" /><CodeLine lineNumber="2955"></CodeLine>
<Link id="l02956" /><CodeLine lineNumber="2956"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We now have a set of LocIdxes that contain the right output value in</span></CodeLine>
<Link id="l02957" /><CodeLine lineNumber="2957"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// each of the predecessors. Pick the lowest; if there&#39;s a register loc,</span></CodeLine>
<Link id="l02958" /><CodeLine lineNumber="2958"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that&#39;ll be it.</span></CodeLine>
<Link id="l02959" /><CodeLine lineNumber="2959"><span class="doxyHighlight">  LocIdx <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a> = &#42;CandidateLocs.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a8a045d250952c0867382a9840ee18fdf">begin</a>();</span></CodeLine>
<Link id="l02960" /><CodeLine lineNumber="2960"></CodeLine>
<Link id="l02961" /><CodeLine lineNumber="2961"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Return a PHI-value-number for the found location.</span></CodeLine>
<Link id="l02962" /><CodeLine lineNumber="2962"><span class="doxyHighlight">  ValueIDNum PHIVal = &#123;(unsigned)<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>(), 0, <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ead20caec3b48a1eef164cb4ca81ba2587">L</a>&#125;;</span></CodeLine>
<Link id="l02963" /><CodeLine lineNumber="2963"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> PHIVal;</span></CodeLine>
<Link id="l02964" /><CodeLine lineNumber="2964"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l02965" /><CodeLine lineNumber="2965"></CodeLine>
<Link id="l02966" /><CodeLine lineNumber="2966"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::vlocJoin(</span></CodeLine>
<Link id="l02967" /><CodeLine lineNumber="2967"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, LiveIdxT &amp;VLOCOutLocs,</span></CodeLine>
<Link id="l02968" /><CodeLine lineNumber="2968"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallptrset">SmallPtrSet&lt;const MachineBasicBlock &#42;, 8&gt;</a> &amp;BlocksToExplore,</span></CodeLine>
<Link id="l02969" /><CodeLine lineNumber="2969"><span class="doxyHighlight">    <a href="/docs/api/classes/livedebugvalues/dbgvalue">DbgValue</a> &amp;LiveIn) &#123;</span></CodeLine>
<Link id="l02970" /><CodeLine lineNumber="2970"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;join MBB: &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l02971" /><CodeLine lineNumber="2971"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02972" /><CodeLine lineNumber="2972"></CodeLine>
<Link id="l02973" /><CodeLine lineNumber="2973"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Order predecessors by RPOT order, for exploring them in that order.</span></CodeLine>
<Link id="l02974" /><CodeLine lineNumber="2974"><span class="doxyHighlight">  SmallVector&lt;MachineBasicBlock &#42;, 8&gt; BlockOrders(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#addd80df79ba902914c7d8a52e3896b79">predecessors</a>());</span></CodeLine>
<Link id="l02975" /><CodeLine lineNumber="2975"></CodeLine>
<Link id="l02976" /><CodeLine lineNumber="2976"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/x86/#a86730e94ae6fdf0fe3145b2acc88dea8ac9b4c62f6dc1bc5caf3c768b687cbf7e">Cmp</a> = &#91;&amp;&#93;(MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>) &#123;</span></CodeLine>
<Link id="l02977" /><CodeLine lineNumber="2977"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> BBToOrder&#91;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>&#93; &lt; BBToOrder&#91;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>&#93;;</span></CodeLine>
<Link id="l02978" /><CodeLine lineNumber="2978"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l02979" /><CodeLine lineNumber="2979"></CodeLine>
<Link id="l02980" /><CodeLine lineNumber="2980"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(BlockOrders, Cmp);</span></CodeLine>
<Link id="l02981" /><CodeLine lineNumber="2981"></CodeLine>
<Link id="l02982" /><CodeLine lineNumber="2982"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> CurBlockRPONum = BBToOrder&#91;&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;;</span></CodeLine>
<Link id="l02983" /><CodeLine lineNumber="2983"></CodeLine>
<Link id="l02984" /><CodeLine lineNumber="2984"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Collect all the incoming DbgValues for this variable, from predecessor</span></CodeLine>
<Link id="l02985" /><CodeLine lineNumber="2985"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// live-out values.</span></CodeLine>
<Link id="l02986" /><CodeLine lineNumber="2986"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;InValueT, 8&gt;</a> Values;</span></CodeLine>
<Link id="l02987" /><CodeLine lineNumber="2987"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Bail = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02988" /><CodeLine lineNumber="2988"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> BackEdgesStart = 0;</span></CodeLine>
<Link id="l02989" /><CodeLine lineNumber="2989"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;p : BlockOrders) &#123;</span></CodeLine>
<Link id="l02990" /><CodeLine lineNumber="2990"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If the predecessor isn&#39;t in scope / to be explored, we&#39;ll never be</span></CodeLine>
<Link id="l02991" /><CodeLine lineNumber="2991"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// able to join any locations.</span></CodeLine>
<Link id="l02992" /><CodeLine lineNumber="2992"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!BlocksToExplore.<a href="/docs/api/classes/llvm/smallptrsetimpl/#af74676a3c7447be34bd2c1da76ec0c48">contains</a>(p)) &#123;</span></CodeLine>
<Link id="l02993" /><CodeLine lineNumber="2993"><span class="doxyHighlight">      Bail = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02994" /><CodeLine lineNumber="2994"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">break</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l02995" /><CodeLine lineNumber="2995"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l02996" /><CodeLine lineNumber="2996"></CodeLine>
<Link id="l02997" /><CodeLine lineNumber="2997"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// All Live-outs will have been initialized.</span></CodeLine>
<Link id="l02998" /><CodeLine lineNumber="2998"><span class="doxyHighlight">    DbgValue &amp;OutLoc = &#42;VLOCOutLocs.find(p)-&gt;second;</span></CodeLine>
<Link id="l02999" /><CodeLine lineNumber="2999"></CodeLine>
<Link id="l03000" /><CodeLine lineNumber="3000"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Keep track of where back-edges begin in the Values vector. Relies on</span></CodeLine>
<Link id="l03001" /><CodeLine lineNumber="3001"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// BlockOrders being sorted by RPO.</span></CodeLine>
<Link id="l03002" /><CodeLine lineNumber="3002"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> ThisBBRPONum = BBToOrder&#91;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea83878c91171338902e0fe0fb97a8c47a">p</a>&#93;;</span></CodeLine>
<Link id="l03003" /><CodeLine lineNumber="3003"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ThisBBRPONum &lt; CurBlockRPONum)</span></CodeLine>
<Link id="l03004" /><CodeLine lineNumber="3004"><span class="doxyHighlight">      ++BackEdgesStart;</span></CodeLine>
<Link id="l03005" /><CodeLine lineNumber="3005"></CodeLine>
<Link id="l03006" /><CodeLine lineNumber="3006"><span class="doxyHighlight">    Values.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(std::make&#95;pair(p, &amp;OutLoc));</span></CodeLine>
<Link id="l03007" /><CodeLine lineNumber="3007"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03008" /><CodeLine lineNumber="3008"></CodeLine>
<Link id="l03009" /><CodeLine lineNumber="3009"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there were no values, or one of the predecessors couldn&#39;t have a</span></CodeLine>
<Link id="l03010" /><CodeLine lineNumber="3010"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value, then give up immediately. It&#39;s not safe to produce a live-in</span></CodeLine>
<Link id="l03011" /><CodeLine lineNumber="3011"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value. Leave as whatever it was before.</span></CodeLine>
<Link id="l03012" /><CodeLine lineNumber="3012"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Bail || Values.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>() == 0)</span></CodeLine>
<Link id="l03013" /><CodeLine lineNumber="3013"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03014" /><CodeLine lineNumber="3014"></CodeLine>
<Link id="l03015" /><CodeLine lineNumber="3015"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// All (non-entry) blocks have at least one non-backedge predecessor.</span></CodeLine>
<Link id="l03016" /><CodeLine lineNumber="3016"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Pick the variable value from the first of these, to compare against</span></CodeLine>
<Link id="l03017" /><CodeLine lineNumber="3017"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// all others.</span></CodeLine>
<Link id="l03018" /><CodeLine lineNumber="3018"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DbgValue &amp;FirstVal = &#42;Values&#91;0&#93;.second;</span></CodeLine>
<Link id="l03019" /><CodeLine lineNumber="3019"></CodeLine>
<Link id="l03020" /><CodeLine lineNumber="3020"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If the old live-in value is not a PHI then either a) no PHI is needed</span></CodeLine>
<Link id="l03021" /><CodeLine lineNumber="3021"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// here, or b) we eliminated the PHI that was here. If so, we can just</span></CodeLine>
<Link id="l03022" /><CodeLine lineNumber="3022"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// propagate in the first parent&#39;s incoming value.</span></CodeLine>
<Link id="l03023" /><CodeLine lineNumber="3023"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LiveIn.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> != <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">DbgValue::VPHI</a> || LiveIn.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a0867a91c94f59efa8118215449f8b1d6">BlockNo</a> != <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>()) &#123;</span></CodeLine>
<Link id="l03024" /><CodeLine lineNumber="3024"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = LiveIn != FirstVal;</span></CodeLine>
<Link id="l03025" /><CodeLine lineNumber="3025"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>)</span></CodeLine>
<Link id="l03026" /><CodeLine lineNumber="3026"><span class="doxyHighlight">      LiveIn = FirstVal;</span></CodeLine>
<Link id="l03027" /><CodeLine lineNumber="3027"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</span></CodeLine>
<Link id="l03028" /><CodeLine lineNumber="3028"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03029" /><CodeLine lineNumber="3029"></CodeLine>
<Link id="l03030" /><CodeLine lineNumber="3030"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Scan for variable values that can never be resolved: if they have</span></CodeLine>
<Link id="l03031" /><CodeLine lineNumber="3031"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// different DIExpressions, different indirectness, or are mixed constants /</span></CodeLine>
<Link id="l03032" /><CodeLine lineNumber="3032"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// non-constants.</span></CodeLine>
<Link id="l03033" /><CodeLine lineNumber="3033"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;V : Values) &#123;</span></CodeLine>
<Link id="l03034" /><CodeLine lineNumber="3034"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.second-&gt;Properties.isJoinable(FirstVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a127bb33bfa67d26975c12bf33568af48">Properties</a>))</span></CodeLine>
<Link id="l03035" /><CodeLine lineNumber="3035"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03036" /><CodeLine lineNumber="3036"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.second-&gt;Kind == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bbaf26793ed3fb3ea880eb66562c90d1826">DbgValue::NoVal</a>)</span></CodeLine>
<Link id="l03037" /><CodeLine lineNumber="3037"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03038" /><CodeLine lineNumber="3038"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.second-&gt;hasJoinableLocOps(FirstVal))</span></CodeLine>
<Link id="l03039" /><CodeLine lineNumber="3039"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03040" /><CodeLine lineNumber="3040"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03041" /><CodeLine lineNumber="3041"></CodeLine>
<Link id="l03042" /><CodeLine lineNumber="3042"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Try to eliminate this PHI. Do the incoming values all agree?</span></CodeLine>
<Link id="l03043" /><CodeLine lineNumber="3043"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> Disagree = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03044" /><CodeLine lineNumber="3044"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;V : Values) &#123;</span></CodeLine>
<Link id="l03045" /><CodeLine lineNumber="3045"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&#42;<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.second == FirstVal)</span></CodeLine>
<Link id="l03046" /><CodeLine lineNumber="3046"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">; </span><span class="doxyHighlightComment">// No disagreement.</span></CodeLine>
<Link id="l03047" /><CodeLine lineNumber="3047"></CodeLine>
<Link id="l03048" /><CodeLine lineNumber="3048"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If both values are not equal but have equal non-empty IDs then they refer</span></CodeLine>
<Link id="l03049" /><CodeLine lineNumber="3049"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// to the same value from different sources (e.g. one is VPHI and the other</span></CodeLine>
<Link id="l03050" /><CodeLine lineNumber="3050"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// is Def), which does not cause disagreement.</span></CodeLine>
<Link id="l03051" /><CodeLine lineNumber="3051"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.second-&gt;hasIdenticalValidLocOps(FirstVal))</span></CodeLine>
<Link id="l03052" /><CodeLine lineNumber="3052"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03053" /><CodeLine lineNumber="3053"></CodeLine>
<Link id="l03054" /><CodeLine lineNumber="3054"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Eliminate if a backedge feeds a VPHI back into itself.</span></CodeLine>
<Link id="l03055" /><CodeLine lineNumber="3055"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.second-&gt;Kind == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">DbgValue::VPHI</a> &amp;&amp;</span></CodeLine>
<Link id="l03056" /><CodeLine lineNumber="3056"><span class="doxyHighlight">        <a href="/docs/api/namespaces/llvm/m68k/#ab3a288f2953d8eca3e363959fc2cf38ea5206560a306a2e085a437fd258eb57ce">V</a>.second-&gt;BlockNo == <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>() &amp;&amp;</span></CodeLine>
<Link id="l03057" /><CodeLine lineNumber="3057"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Is this a backedge?</span></CodeLine>
<Link id="l03058" /><CodeLine lineNumber="3058"><span class="doxyHighlight">        std::distance(Values.begin(), &amp;V) &gt;= BackEdgesStart)</span></CodeLine>
<Link id="l03059" /><CodeLine lineNumber="3059"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03060" /><CodeLine lineNumber="3060"></CodeLine>
<Link id="l03061" /><CodeLine lineNumber="3061"><span class="doxyHighlight">    Disagree = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03062" /><CodeLine lineNumber="3062"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03063" /><CodeLine lineNumber="3063"></CodeLine>
<Link id="l03064" /><CodeLine lineNumber="3064"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// No disagreement -&gt; live-through value.</span></CodeLine>
<Link id="l03065" /><CodeLine lineNumber="3065"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Disagree) &#123;</span></CodeLine>
<Link id="l03066" /><CodeLine lineNumber="3066"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = LiveIn != FirstVal;</span></CodeLine>
<Link id="l03067" /><CodeLine lineNumber="3067"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>)</span></CodeLine>
<Link id="l03068" /><CodeLine lineNumber="3068"><span class="doxyHighlight">      LiveIn = FirstVal;</span></CodeLine>
<Link id="l03069" /><CodeLine lineNumber="3069"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</span></CodeLine>
<Link id="l03070" /><CodeLine lineNumber="3070"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03071" /><CodeLine lineNumber="3071"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Otherwise use a VPHI.</span></CodeLine>
<Link id="l03072" /><CodeLine lineNumber="3072"><span class="doxyHighlight">    DbgValue VPHI(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>(), FirstVal.<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a127bb33bfa67d26975c12bf33568af48">Properties</a>, <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">DbgValue::VPHI</a>);</span></CodeLine>
<Link id="l03073" /><CodeLine lineNumber="3073"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = LiveIn != VPHI;</span></CodeLine>
<Link id="l03074" /><CodeLine lineNumber="3074"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>)</span></CodeLine>
<Link id="l03075" /><CodeLine lineNumber="3075"><span class="doxyHighlight">      LiveIn = VPHI;</span></CodeLine>
<Link id="l03076" /><CodeLine lineNumber="3076"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</span></CodeLine>
<Link id="l03077" /><CodeLine lineNumber="3077"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03078" /><CodeLine lineNumber="3078"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03079" /><CodeLine lineNumber="3079"></CodeLine>
<Link id="l03080" /><CodeLine lineNumber="3080"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::getBlocksForScope(</span></CodeLine>
<Link id="l03081" /><CodeLine lineNumber="3081"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/dilocation">DILocation</a> &#42;DILoc,</span></CodeLine>
<Link id="l03082" /><CodeLine lineNumber="3082"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;const MachineBasicBlock &#42;&gt;</a> &amp;BlocksToExplore,</span></CodeLine>
<Link id="l03083" /><CodeLine lineNumber="3083"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineBasicBlock &#42;&gt;</a> &amp;AssignBlocks) &#123;</span></CodeLine>
<Link id="l03084" /><CodeLine lineNumber="3084"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Get the set of &quot;normal&quot; in-lexical-scope blocks.</span></CodeLine>
<Link id="l03085" /><CodeLine lineNumber="3085"><span class="doxyHighlight">  LS.getMachineBasicBlocks(DILoc, BlocksToExplore);</span></CodeLine>
<Link id="l03086" /><CodeLine lineNumber="3086"></CodeLine>
<Link id="l03087" /><CodeLine lineNumber="3087"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// VarLoc LiveDebugValues tracks variable locations that are defined in</span></CodeLine>
<Link id="l03088" /><CodeLine lineNumber="3088"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// blocks not in scope. This is something we could legitimately ignore, but</span></CodeLine>
<Link id="l03089" /><CodeLine lineNumber="3089"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// lets allow it for now for the sake of coverage.</span></CodeLine>
<Link id="l03090" /><CodeLine lineNumber="3090"><span class="doxyHighlight">  BlocksToExplore.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(AssignBlocks.<a href="/docs/api/classes/llvm/smallptrsetimpl/#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>(), AssignBlocks.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a7004354fbee1c8cd74ed9001915e1db5">end</a>());</span></CodeLine>
<Link id="l03091" /><CodeLine lineNumber="3091"></CodeLine>
<Link id="l03092" /><CodeLine lineNumber="3092"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Storage for artificial blocks we intend to add to BlocksToExplore.</span></CodeLine>
<Link id="l03093" /><CodeLine lineNumber="3093"><span class="doxyHighlight">  DenseSet&lt;const MachineBasicBlock &#42;&gt; ToAdd;</span></CodeLine>
<Link id="l03094" /><CodeLine lineNumber="3094"></CodeLine>
<Link id="l03095" /><CodeLine lineNumber="3095"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// To avoid needlessly dropping large volumes of variable locations, propagate</span></CodeLine>
<Link id="l03096" /><CodeLine lineNumber="3096"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// variables through aritifical blocks, i.e. those that don&#39;t have any</span></CodeLine>
<Link id="l03097" /><CodeLine lineNumber="3097"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instructions in scope at all. To accurately replicate VarLoc</span></CodeLine>
<Link id="l03098" /><CodeLine lineNumber="3098"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// LiveDebugValues, this means exploring all artificial successors too.</span></CodeLine>
<Link id="l03099" /><CodeLine lineNumber="3099"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Perform a depth-first-search to enumerate those blocks.</span></CodeLine>
<Link id="l03100" /><CodeLine lineNumber="3100"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : BlocksToExplore) &#123;</span></CodeLine>
<Link id="l03101" /><CodeLine lineNumber="3101"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Depth-first-search state: each node is a block and which successor</span></CodeLine>
<Link id="l03102" /><CodeLine lineNumber="3102"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// we&#39;re currently exploring.</span></CodeLine>
<Link id="l03103" /><CodeLine lineNumber="3103"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector</a>&lt;std::pair&lt;</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineBasicBlock &#42;,</span></CodeLine>
<Link id="l03104" /><CodeLine lineNumber="3104"><span class="doxyHighlight">                          <a href="/docs/api/classes/llvm/machinebasicblock/#a3f43e04d827b07cf1d5366554d03f748">MachineBasicBlock::const&#95;succ&#95;iterator</a>&gt;,</span></CodeLine>
<Link id="l03105" /><CodeLine lineNumber="3105"><span class="doxyHighlight">                8&gt;</span></CodeLine>
<Link id="l03106" /><CodeLine lineNumber="3106"><span class="doxyHighlight">        DFS;</span></CodeLine>
<Link id="l03107" /><CodeLine lineNumber="3107"></CodeLine>
<Link id="l03108" /><CodeLine lineNumber="3108"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Find any artificial successors not already tracked.</span></CodeLine>
<Link id="l03109" /><CodeLine lineNumber="3109"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;succ : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#ad88ff1529541fb4e243cc8ed90b11131">successors</a>()) &#123;</span></CodeLine>
<Link id="l03110" /><CodeLine lineNumber="3110"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BlocksToExplore.count(succ))</span></CodeLine>
<Link id="l03111" /><CodeLine lineNumber="3111"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03112" /><CodeLine lineNumber="3112"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!ArtificialBlocks.count(succ))</span></CodeLine>
<Link id="l03113" /><CodeLine lineNumber="3113"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03114" /><CodeLine lineNumber="3114"><span class="doxyHighlight">      ToAdd.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(succ);</span></CodeLine>
<Link id="l03115" /><CodeLine lineNumber="3115"><span class="doxyHighlight">      DFS.push&#95;back(&#123;succ, succ-&gt;succ&#95;begin()&#125;);</span></CodeLine>
<Link id="l03116" /><CodeLine lineNumber="3116"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03117" /><CodeLine lineNumber="3117"></CodeLine>
<Link id="l03118" /><CodeLine lineNumber="3118"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Search all those blocks, depth first.</span></CodeLine>
<Link id="l03119" /><CodeLine lineNumber="3119"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!DFS.empty()) &#123;</span></CodeLine>
<Link id="l03120" /><CodeLine lineNumber="3120"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineBasicBlock &#42;CurBB = DFS.back().first;</span></CodeLine>
<Link id="l03121" /><CodeLine lineNumber="3121"><span class="doxyHighlight">      <a href="/docs/api/classes/llvm/machinebasicblock/#a3f43e04d827b07cf1d5366554d03f748">MachineBasicBlock::const&#95;succ&#95;iterator</a> &amp;CurSucc = DFS.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>().second;</span></CodeLine>
<Link id="l03122" /><CodeLine lineNumber="3122"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Walk back if we&#39;ve explored this blocks successors to the end.</span></CodeLine>
<Link id="l03123" /><CodeLine lineNumber="3123"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (CurSucc == CurBB-&gt;succ&#95;end()) &#123;</span></CodeLine>
<Link id="l03124" /><CodeLine lineNumber="3124"><span class="doxyHighlight">        DFS.pop&#95;back();</span></CodeLine>
<Link id="l03125" /><CodeLine lineNumber="3125"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03126" /><CodeLine lineNumber="3126"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03127" /><CodeLine lineNumber="3127"></CodeLine>
<Link id="l03128" /><CodeLine lineNumber="3128"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If the current successor is artificial and unexplored, descend into</span></CodeLine>
<Link id="l03129" /><CodeLine lineNumber="3129"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// it.</span></CodeLine>
<Link id="l03130" /><CodeLine lineNumber="3130"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!ToAdd.<a href="/docs/api/classes/llvm/detail/densesetimpl/#afe504aa31a6a354cec13f5b32d0b1d9d">count</a>(&#42;CurSucc) &amp;&amp; ArtificialBlocks.count(&#42;CurSucc)) &#123;</span></CodeLine>
<Link id="l03131" /><CodeLine lineNumber="3131"><span class="doxyHighlight">        ToAdd.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a1b0f3ebdced8fce4b22c6a63b25d9525">insert</a>(&#42;CurSucc);</span></CodeLine>
<Link id="l03132" /><CodeLine lineNumber="3132"><span class="doxyHighlight">        DFS.push&#95;back(&#123;&#42;CurSucc, (&#42;CurSucc)-&gt;succ&#95;begin()&#125;);</span></CodeLine>
<Link id="l03133" /><CodeLine lineNumber="3133"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03134" /><CodeLine lineNumber="3134"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03135" /><CodeLine lineNumber="3135"></CodeLine>
<Link id="l03136" /><CodeLine lineNumber="3136"><span class="doxyHighlight">      ++CurSucc;</span></CodeLine>
<Link id="l03137" /><CodeLine lineNumber="3137"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03138" /><CodeLine lineNumber="3138"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l03139" /><CodeLine lineNumber="3139"></CodeLine>
<Link id="l03140" /><CodeLine lineNumber="3140"><span class="doxyHighlight">  BlocksToExplore.insert(ToAdd.<a href="/docs/api/classes/llvm/detail/densesetimpl/#ad7dc7318244359268414719e0959346e">begin</a>(), ToAdd.<a href="/docs/api/classes/llvm/detail/densesetimpl/#a8cd802dcaed35e1f28ea3cbe4af4eff5">end</a>());</span></CodeLine>
<Link id="l03141" /><CodeLine lineNumber="3141"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03142" /><CodeLine lineNumber="3142"></CodeLine>
<Link id="l03143" /><CodeLine lineNumber="3143"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::buildVLocValueMap(</span></CodeLine>
<Link id="l03144" /><CodeLine lineNumber="3144"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/dilocation">DILocation</a> &#42;DILoc,</span></CodeLine>
<Link id="l03145" /><CodeLine lineNumber="3145"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallset">SmallSet&lt;DebugVariableID, 4&gt;</a> &amp;VarsWeCareAbout,</span></CodeLine>
<Link id="l03146" /><CodeLine lineNumber="3146"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineBasicBlock &#42;&gt;</a> &amp;AssignBlocks, LiveInsT &amp;Output,</span></CodeLine>
<Link id="l03147" /><CodeLine lineNumber="3147"><span class="doxyHighlight">    <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MOutLocs, <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MInLocs,</span></CodeLine>
<Link id="l03148" /><CodeLine lineNumber="3148"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;VLocTracker&gt;</a> &amp;AllTheVLocs) &#123;</span></CodeLine>
<Link id="l03149" /><CodeLine lineNumber="3149"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This method is much like buildMLocValueMap: but focuses on a single</span></CodeLine>
<Link id="l03150" /><CodeLine lineNumber="3150"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// LexicalScope at a time. Pick out a set of blocks and variables that are</span></CodeLine>
<Link id="l03151" /><CodeLine lineNumber="3151"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to have their value assignments solved, then run our dataflow algorithm</span></CodeLine>
<Link id="l03152" /><CodeLine lineNumber="3152"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// until a fixedpoint is reached.</span></CodeLine>
<Link id="l03153" /><CodeLine lineNumber="3153"><span class="doxyHighlight">  std::priority&#95;queue&lt;unsigned int, std::vector&lt;unsigned int&gt;,</span></CodeLine>
<Link id="l03154" /><CodeLine lineNumber="3154"><span class="doxyHighlight">                      std::greater&lt;unsigned int&gt;&gt;</span></CodeLine>
<Link id="l03155" /><CodeLine lineNumber="3155"><span class="doxyHighlight">      Worklist, Pending;</span></CodeLine>
<Link id="l03156" /><CodeLine lineNumber="3156"><span class="doxyHighlight">  SmallPtrSet&lt;MachineBasicBlock &#42;, 16&gt; OnWorklist, OnPending;</span></CodeLine>
<Link id="l03157" /><CodeLine lineNumber="3157"></CodeLine>
<Link id="l03158" /><CodeLine lineNumber="3158"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The set of blocks we&#39;ll be examining.</span></CodeLine>
<Link id="l03159" /><CodeLine lineNumber="3159"><span class="doxyHighlight">  SmallPtrSet&lt;const MachineBasicBlock &#42;, 8&gt; BlocksToExplore;</span></CodeLine>
<Link id="l03160" /><CodeLine lineNumber="3160"></CodeLine>
<Link id="l03161" /><CodeLine lineNumber="3161"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// The order in which to examine them (RPO).</span></CodeLine>
<Link id="l03162" /><CodeLine lineNumber="3162"><span class="doxyHighlight">  SmallVector&lt;MachineBasicBlock &#42;, 16&gt; BlockOrders;</span></CodeLine>
<Link id="l03163" /><CodeLine lineNumber="3163"><span class="doxyHighlight">  SmallVector&lt;unsigned, 32&gt; BlockOrderNums;</span></CodeLine>
<Link id="l03164" /><CodeLine lineNumber="3164"></CodeLine>
<Link id="l03165" /><CodeLine lineNumber="3165"><span class="doxyHighlight">  getBlocksForScope(DILoc, BlocksToExplore, AssignBlocks);</span></CodeLine>
<Link id="l03166" /><CodeLine lineNumber="3166"></CodeLine>
<Link id="l03167" /><CodeLine lineNumber="3167"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Single block scope: not interesting! No propagation at all. Note that</span></CodeLine>
<Link id="l03168" /><CodeLine lineNumber="3168"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// this could probably go above ArtificialBlocks without damage, but</span></CodeLine>
<Link id="l03169" /><CodeLine lineNumber="3169"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that then produces output differences from original-live-debug-values,</span></CodeLine>
<Link id="l03170" /><CodeLine lineNumber="3170"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// which propagates from a single block into many artificial ones.</span></CodeLine>
<Link id="l03171" /><CodeLine lineNumber="3171"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BlocksToExplore.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a0e1c3175b0ac22fe3853651c28e1ecb8">size</a>() == 1)</span></CodeLine>
<Link id="l03172" /><CodeLine lineNumber="3172"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03173" /><CodeLine lineNumber="3173"></CodeLine>
<Link id="l03174" /><CodeLine lineNumber="3174"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Convert a const set to a non-const set. LexicalScopes</span></CodeLine>
<Link id="l03175" /><CodeLine lineNumber="3175"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// getMachineBasicBlocks returns const MBB pointers, IDF wants mutable ones.</span></CodeLine>
<Link id="l03176" /><CodeLine lineNumber="3176"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// (Neither of them mutate anything).</span></CodeLine>
<Link id="l03177" /><CodeLine lineNumber="3177"><span class="doxyHighlight">  SmallPtrSet&lt;MachineBasicBlock &#42;, 8&gt; MutBlocksToExplore;</span></CodeLine>
<Link id="l03178" /><CodeLine lineNumber="3178"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : BlocksToExplore)</span></CodeLine>
<Link id="l03179" /><CodeLine lineNumber="3179"><span class="doxyHighlight">    MutBlocksToExplore.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(</span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight">MachineBasicBlock &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>));</span></CodeLine>
<Link id="l03180" /><CodeLine lineNumber="3180"></CodeLine>
<Link id="l03181" /><CodeLine lineNumber="3181"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Picks out relevants blocks RPO order and sort them. Sort their</span></CodeLine>
<Link id="l03182" /><CodeLine lineNumber="3182"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// order-numbers and map back to MBB pointers later, to avoid repeated</span></CodeLine>
<Link id="l03183" /><CodeLine lineNumber="3183"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// DenseMap queries during comparisons.</span></CodeLine>
<Link id="l03184" /><CodeLine lineNumber="3184"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : BlocksToExplore)</span></CodeLine>
<Link id="l03185" /><CodeLine lineNumber="3185"><span class="doxyHighlight">    BlockOrderNums.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(BBToOrder&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;);</span></CodeLine>
<Link id="l03186" /><CodeLine lineNumber="3186"></CodeLine>
<Link id="l03187" /><CodeLine lineNumber="3187"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(BlockOrderNums);</span></CodeLine>
<Link id="l03188" /><CodeLine lineNumber="3188"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> : BlockOrderNums)</span></CodeLine>
<Link id="l03189" /><CodeLine lineNumber="3189"><span class="doxyHighlight">    BlockOrders.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(OrderToBB&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;);</span></CodeLine>
<Link id="l03190" /><CodeLine lineNumber="3190"><span class="doxyHighlight">  BlockOrderNums.clear();</span></CodeLine>
<Link id="l03191" /><CodeLine lineNumber="3191"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumBlocks = BlockOrders.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#a1c479a8c434377c2b8cb056bdfdfc201">size</a>();</span></CodeLine>
<Link id="l03192" /><CodeLine lineNumber="3192"></CodeLine>
<Link id="l03193" /><CodeLine lineNumber="3193"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Allocate some vectors for storing the live ins and live outs. Large.</span></CodeLine>
<Link id="l03194" /><CodeLine lineNumber="3194"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;DbgValue, 32&gt;</a> LiveIns, LiveOuts;</span></CodeLine>
<Link id="l03195" /><CodeLine lineNumber="3195"><span class="doxyHighlight">  LiveIns.<a href="/docs/api/classes/llvm/smallvectorimpl/#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(NumBlocks);</span></CodeLine>
<Link id="l03196" /><CodeLine lineNumber="3196"><span class="doxyHighlight">  LiveOuts.<a href="/docs/api/classes/llvm/smallvectorimpl/#a499ea32ca1b8d16cedfe01d1e5b08f29">reserve</a>(NumBlocks);</span></CodeLine>
<Link id="l03197" /><CodeLine lineNumber="3197"></CodeLine>
<Link id="l03198" /><CodeLine lineNumber="3198"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Initialize all values to start as NoVals. This signifies &quot;it&#39;s live</span></CodeLine>
<Link id="l03199" /><CodeLine lineNumber="3199"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// through, but we don&#39;t know what it is&quot;.</span></CodeLine>
<Link id="l03200" /><CodeLine lineNumber="3200"><span class="doxyHighlight">  DbgValueProperties EmptyProperties(EmptyExpr, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">, </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03201" /><CodeLine lineNumber="3201"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumBlocks; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l03202" /><CodeLine lineNumber="3202"><span class="doxyHighlight">    DbgValue EmptyDbgValue(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, EmptyProperties, <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bbaf26793ed3fb3ea880eb66562c90d1826">DbgValue::NoVal</a>);</span></CodeLine>
<Link id="l03203" /><CodeLine lineNumber="3203"><span class="doxyHighlight">    LiveIns.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(EmptyDbgValue);</span></CodeLine>
<Link id="l03204" /><CodeLine lineNumber="3204"><span class="doxyHighlight">    LiveOuts.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(EmptyDbgValue);</span></CodeLine>
<Link id="l03205" /><CodeLine lineNumber="3205"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03206" /><CodeLine lineNumber="3206"></CodeLine>
<Link id="l03207" /><CodeLine lineNumber="3207"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Produce by-MBB indexes of live-in/live-outs, to ease lookup within</span></CodeLine>
<Link id="l03208" /><CodeLine lineNumber="3208"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// vlocJoin.</span></CodeLine>
<Link id="l03209" /><CodeLine lineNumber="3209"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#abba7c6095e3e9ebb63a516620332773c">LiveIdxT</a> LiveOutIdx, LiveInIdx;</span></CodeLine>
<Link id="l03210" /><CodeLine lineNumber="3210"><span class="doxyHighlight">  LiveOutIdx.reserve(NumBlocks);</span></CodeLine>
<Link id="l03211" /><CodeLine lineNumber="3211"><span class="doxyHighlight">  LiveInIdx.reserve(NumBlocks);</span></CodeLine>
<Link id="l03212" /><CodeLine lineNumber="3212"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumBlocks; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l03213" /><CodeLine lineNumber="3213"><span class="doxyHighlight">    LiveOutIdx&#91;BlockOrders&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;&#93; = &amp;LiveOuts&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</span></CodeLine>
<Link id="l03214" /><CodeLine lineNumber="3214"><span class="doxyHighlight">    LiveInIdx&#91;BlockOrders&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;&#93; = &amp;LiveIns&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</span></CodeLine>
<Link id="l03215" /><CodeLine lineNumber="3215"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03216" /><CodeLine lineNumber="3216"></CodeLine>
<Link id="l03217" /><CodeLine lineNumber="3217"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Loop over each variable and place PHIs for it, then propagate values</span></CodeLine>
<Link id="l03218" /><CodeLine lineNumber="3218"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// between blocks. This keeps the locality of working on one lexical scope at</span></CodeLine>
<Link id="l03219" /><CodeLine lineNumber="3219"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// at time, but avoids re-processing variable values because some other</span></CodeLine>
<Link id="l03220" /><CodeLine lineNumber="3220"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// variable has been assigned.</span></CodeLine>
<Link id="l03221" /><CodeLine lineNumber="3221"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a> : VarsWeCareAbout) &#123;</span></CodeLine>
<Link id="l03222" /><CodeLine lineNumber="3222"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Re-initialize live-ins and live-outs, to clear the remains of previous</span></CodeLine>
<Link id="l03223" /><CodeLine lineNumber="3223"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// variables live-ins / live-outs.</span></CodeLine>
<Link id="l03224" /><CodeLine lineNumber="3224"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; NumBlocks; ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l03225" /><CodeLine lineNumber="3225"><span class="doxyHighlight">      DbgValue EmptyDbgValue(<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>, EmptyProperties, <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bbaf26793ed3fb3ea880eb66562c90d1826">DbgValue::NoVal</a>);</span></CodeLine>
<Link id="l03226" /><CodeLine lineNumber="3226"><span class="doxyHighlight">      LiveIns&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; = EmptyDbgValue;</span></CodeLine>
<Link id="l03227" /><CodeLine lineNumber="3227"><span class="doxyHighlight">      LiveOuts&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93; = EmptyDbgValue;</span></CodeLine>
<Link id="l03228" /><CodeLine lineNumber="3228"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03229" /><CodeLine lineNumber="3229"></CodeLine>
<Link id="l03230" /><CodeLine lineNumber="3230"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Place PHIs for variable values, using the LLVM IDF calculator.</span></CodeLine>
<Link id="l03231" /><CodeLine lineNumber="3231"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Collect the set of blocks where variables are def&#39;d.</span></CodeLine>
<Link id="l03232" /><CodeLine lineNumber="3232"><span class="doxyHighlight">    SmallPtrSet&lt;MachineBasicBlock &#42;, 32&gt; DefBlocks;</span></CodeLine>
<Link id="l03233" /><CodeLine lineNumber="3233"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> MachineBasicBlock &#42;ExpMBB : BlocksToExplore) &#123;</span></CodeLine>
<Link id="l03234" /><CodeLine lineNumber="3234"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;TransferFunc = AllTheVLocs&#91;ExpMBB-&gt;getNumber()&#93;.Vars;</span></CodeLine>
<Link id="l03235" /><CodeLine lineNumber="3235"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TransferFunc.contains(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>))</span></CodeLine>
<Link id="l03236" /><CodeLine lineNumber="3236"><span class="doxyHighlight">        DefBlocks.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(</span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight">MachineBasicBlock &#42;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(ExpMBB));</span></CodeLine>
<Link id="l03237" /><CodeLine lineNumber="3237"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03238" /><CodeLine lineNumber="3238"></CodeLine>
<Link id="l03239" /><CodeLine lineNumber="3239"><span class="doxyHighlight">    SmallVector&lt;MachineBasicBlock &#42;, 32&gt; PHIBlocks;</span></CodeLine>
<Link id="l03240" /><CodeLine lineNumber="3240"></CodeLine>
<Link id="l03241" /><CodeLine lineNumber="3241"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Request the set of PHIs we should insert for this variable. If there&#39;s</span></CodeLine>
<Link id="l03242" /><CodeLine lineNumber="3242"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// only one value definition, things are very simple.</span></CodeLine>
<Link id="l03243" /><CodeLine lineNumber="3243"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DefBlocks.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a0e1c3175b0ac22fe3853651c28e1ecb8">size</a>() == 1) &#123;</span></CodeLine>
<Link id="l03244" /><CodeLine lineNumber="3244"><span class="doxyHighlight">      placePHIsForSingleVarDefinition(MutBlocksToExplore, &#42;DefBlocks.<a href="/docs/api/classes/llvm/smallptrsetimpl/#abf73a826b5d6f739eb4af48ddf14c5b4">begin</a>(),</span></CodeLine>
<Link id="l03245" /><CodeLine lineNumber="3245"><span class="doxyHighlight">                                      AllTheVLocs, <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, Output);</span></CodeLine>
<Link id="l03246" /><CodeLine lineNumber="3246"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03247" /><CodeLine lineNumber="3247"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03248" /><CodeLine lineNumber="3248"></CodeLine>
<Link id="l03249" /><CodeLine lineNumber="3249"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Otherwise: we need to place PHIs through SSA and propagate values.</span></CodeLine>
<Link id="l03250" /><CodeLine lineNumber="3250"><span class="doxyHighlight">    BlockPHIPlacement(MutBlocksToExplore, DefBlocks, PHIBlocks);</span></CodeLine>
<Link id="l03251" /><CodeLine lineNumber="3251"></CodeLine>
<Link id="l03252" /><CodeLine lineNumber="3252"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Insert PHIs into the per-block live-in tables for this variable.</span></CodeLine>
<Link id="l03253" /><CodeLine lineNumber="3253"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MachineBasicBlock &#42;PHIMBB : PHIBlocks) &#123;</span></CodeLine>
<Link id="l03254" /><CodeLine lineNumber="3254"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> BlockNo = PHIMBB-&gt;getNumber();</span></CodeLine>
<Link id="l03255" /><CodeLine lineNumber="3255"><span class="doxyHighlight">      DbgValue &#42;LiveIn = LiveInIdx&#91;PHIMBB&#93;;</span></CodeLine>
<Link id="l03256" /><CodeLine lineNumber="3256"><span class="doxyHighlight">      &#42;LiveIn = DbgValue(BlockNo, EmptyProperties, <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">DbgValue::VPHI</a>);</span></CodeLine>
<Link id="l03257" /><CodeLine lineNumber="3257"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03258" /><CodeLine lineNumber="3258"></CodeLine>
<Link id="l03259" /><CodeLine lineNumber="3259"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : BlockOrders) &#123;</span></CodeLine>
<Link id="l03260" /><CodeLine lineNumber="3260"><span class="doxyHighlight">      Worklist.push(BBToOrder&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;);</span></CodeLine>
<Link id="l03261" /><CodeLine lineNumber="3261"><span class="doxyHighlight">      OnWorklist.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03262" /><CodeLine lineNumber="3262"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03263" /><CodeLine lineNumber="3263"></CodeLine>
<Link id="l03264" /><CodeLine lineNumber="3264"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Iterate over all the blocks we selected, propagating the variables value.</span></CodeLine>
<Link id="l03265" /><CodeLine lineNumber="3265"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// This loop does two things:</span></CodeLine>
<Link id="l03266" /><CodeLine lineNumber="3266"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//  &#42; Eliminates un-necessary VPHIs in vlocJoin,</span></CodeLine>
<Link id="l03267" /><CodeLine lineNumber="3267"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//  &#42; Evaluates the blocks transfer function (i.e. variable assignments) and</span></CodeLine>
<Link id="l03268" /><CodeLine lineNumber="3268"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">//    stores the result to the blocks live-outs.</span></CodeLine>
<Link id="l03269" /><CodeLine lineNumber="3269"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Always evaluate the transfer function on the first iteration, and when</span></CodeLine>
<Link id="l03270" /><CodeLine lineNumber="3270"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the live-ins change thereafter.</span></CodeLine>
<Link id="l03271" /><CodeLine lineNumber="3271"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> FirstTrip = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03272" /><CodeLine lineNumber="3272"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!Worklist.empty() || !Pending.empty()) &#123;</span></CodeLine>
<Link id="l03273" /><CodeLine lineNumber="3273"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!Worklist.empty()) &#123;</span></CodeLine>
<Link id="l03274" /><CodeLine lineNumber="3274"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = OrderToBB&#91;Worklist.top()&#93;;</span></CodeLine>
<Link id="l03275" /><CodeLine lineNumber="3275"><span class="doxyHighlight">        CurBB = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>();</span></CodeLine>
<Link id="l03276" /><CodeLine lineNumber="3276"><span class="doxyHighlight">        Worklist.pop();</span></CodeLine>
<Link id="l03277" /><CodeLine lineNumber="3277"></CodeLine>
<Link id="l03278" /><CodeLine lineNumber="3278"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LiveInsIt = LiveInIdx.find(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03279" /><CodeLine lineNumber="3279"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(LiveInsIt != LiveInIdx.end());</span></CodeLine>
<Link id="l03280" /><CodeLine lineNumber="3280"><span class="doxyHighlight">        DbgValue &#42;LiveIn = LiveInsIt-&gt;second;</span></CodeLine>
<Link id="l03281" /><CodeLine lineNumber="3281"></CodeLine>
<Link id="l03282" /><CodeLine lineNumber="3282"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Join values from predecessors. Updates LiveInIdx, and writes output</span></CodeLine>
<Link id="l03283" /><CodeLine lineNumber="3283"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// into JoinedInLocs.</span></CodeLine>
<Link id="l03284" /><CodeLine lineNumber="3284"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InLocsChanged =</span></CodeLine>
<Link id="l03285" /><CodeLine lineNumber="3285"><span class="doxyHighlight">            vlocJoin(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, LiveOutIdx, BlocksToExplore, &#42;LiveIn);</span></CodeLine>
<Link id="l03286" /><CodeLine lineNumber="3286"></CodeLine>
<Link id="l03287" /><CodeLine lineNumber="3287"><span class="doxyHighlight">        SmallVector&lt;const MachineBasicBlock &#42;, 8&gt; Preds(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#addd80df79ba902914c7d8a52e3896b79">predecessors</a>());</span></CodeLine>
<Link id="l03288" /><CodeLine lineNumber="3288"></CodeLine>
<Link id="l03289" /><CodeLine lineNumber="3289"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If this block&#39;s live-in value is a VPHI, try to pick a machine-value</span></CodeLine>
<Link id="l03290" /><CodeLine lineNumber="3290"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// for it. This makes the machine-value available and propagated</span></CodeLine>
<Link id="l03291" /><CodeLine lineNumber="3291"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// through all blocks by the time value propagation finishes. We can&#39;t</span></CodeLine>
<Link id="l03292" /><CodeLine lineNumber="3292"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// do this any earlier as it needs to read the block live-outs.</span></CodeLine>
<Link id="l03293" /><CodeLine lineNumber="3293"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">DbgValue::VPHI</a> &amp;&amp; LiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a0867a91c94f59efa8118215449f8b1d6">BlockNo</a> == (</span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight">)CurBB) &#123;</span></CodeLine>
<Link id="l03294" /><CodeLine lineNumber="3294"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// There&#39;s a small possibility that on a preceeding path, a VPHI is</span></CodeLine>
<Link id="l03295" /><CodeLine lineNumber="3295"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// eliminated and transitions from VPHI-with-location to</span></CodeLine>
<Link id="l03296" /><CodeLine lineNumber="3296"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// live-through-value. As a result, the selected location of any VPHI</span></CodeLine>
<Link id="l03297" /><CodeLine lineNumber="3297"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// might change, so we need to re-compute it on each iteration.</span></CodeLine>
<Link id="l03298" /><CodeLine lineNumber="3298"><span class="doxyHighlight">          <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;DbgOpID&gt;</a> JoinedOps;</span></CodeLine>
<Link id="l03299" /><CodeLine lineNumber="3299"></CodeLine>
<Link id="l03300" /><CodeLine lineNumber="3300"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (pickVPHILoc(JoinedOps, &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, LiveOutIdx, MOutLocs, Preds)) &#123;</span></CodeLine>
<Link id="l03301" /><CodeLine lineNumber="3301"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> NewLocPicked = !<a href="/docs/api/namespaces/llvm/#ae04157f1cd3b64e93ebd44f8f65e395c">equal</a>(LiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a12c429bd06d73df15134959325cd6022">getDbgOpIDs</a>(), JoinedOps);</span></CodeLine>
<Link id="l03302" /><CodeLine lineNumber="3302"><span class="doxyHighlight">            InLocsChanged |= NewLocPicked;</span></CodeLine>
<Link id="l03303" /><CodeLine lineNumber="3303"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (NewLocPicked)</span></CodeLine>
<Link id="l03304" /><CodeLine lineNumber="3304"><span class="doxyHighlight">              LiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a7230438e78079233a5d7b3bc1d4f14b2">setDbgOpIDs</a>(JoinedOps);</span></CodeLine>
<Link id="l03305" /><CodeLine lineNumber="3305"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l03306" /><CodeLine lineNumber="3306"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03307" /><CodeLine lineNumber="3307"></CodeLine>
<Link id="l03308" /><CodeLine lineNumber="3308"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!InLocsChanged &amp;&amp; !FirstTrip)</span></CodeLine>
<Link id="l03309" /><CodeLine lineNumber="3309"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03310" /><CodeLine lineNumber="3310"></CodeLine>
<Link id="l03311" /><CodeLine lineNumber="3311"><span class="doxyHighlight">        DbgValue &#42;LiveOut = LiveOutIdx&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;;</span></CodeLine>
<Link id="l03312" /><CodeLine lineNumber="3312"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> OLChanged = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03313" /><CodeLine lineNumber="3313"></CodeLine>
<Link id="l03314" /><CodeLine lineNumber="3314"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Do transfer function.</span></CodeLine>
<Link id="l03315" /><CodeLine lineNumber="3315"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;VTracker = AllTheVLocs&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>()&#93;;</span></CodeLine>
<Link id="l03316" /><CodeLine lineNumber="3316"><span class="doxyHighlight">        </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> TransferIt = VTracker.Vars.find(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l03317" /><CodeLine lineNumber="3317"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TransferIt != VTracker.Vars.end()) &#123;</span></CodeLine>
<Link id="l03318" /><CodeLine lineNumber="3318"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Erase on empty transfer (DBG&#95;VALUE $noreg).</span></CodeLine>
<Link id="l03319" /><CodeLine lineNumber="3319"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (TransferIt-&gt;second.Kind == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba7c46001b3585fc4e42328dbe7123b5d4">DbgValue::Undef</a>) &#123;</span></CodeLine>
<Link id="l03320" /><CodeLine lineNumber="3320"><span class="doxyHighlight">            DbgValue NewVal(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>(), EmptyProperties, <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bbaf26793ed3fb3ea880eb66562c90d1826">DbgValue::NoVal</a>);</span></CodeLine>
<Link id="l03321" /><CodeLine lineNumber="3321"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&#42;LiveOut != NewVal) &#123;</span></CodeLine>
<Link id="l03322" /><CodeLine lineNumber="3322"><span class="doxyHighlight">              &#42;LiveOut = NewVal;</span></CodeLine>
<Link id="l03323" /><CodeLine lineNumber="3323"><span class="doxyHighlight">              OLChanged = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03324" /><CodeLine lineNumber="3324"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l03325" /><CodeLine lineNumber="3325"><span class="doxyHighlight">          &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03326" /><CodeLine lineNumber="3326"><span class="doxyHighlight">            </span><span class="doxyHighlightComment">// Insert new variable value; or overwrite.</span></CodeLine>
<Link id="l03327" /><CodeLine lineNumber="3327"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&#42;LiveOut != TransferIt-&gt;second) &#123;</span></CodeLine>
<Link id="l03328" /><CodeLine lineNumber="3328"><span class="doxyHighlight">              &#42;LiveOut = TransferIt-&gt;second;</span></CodeLine>
<Link id="l03329" /><CodeLine lineNumber="3329"><span class="doxyHighlight">              OLChanged = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03330" /><CodeLine lineNumber="3330"><span class="doxyHighlight">            &#125;</span></CodeLine>
<Link id="l03331" /><CodeLine lineNumber="3331"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l03332" /><CodeLine lineNumber="3332"><span class="doxyHighlight">        &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03333" /><CodeLine lineNumber="3333"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Just copy live-ins to live-outs, for anything not transferred.</span></CodeLine>
<Link id="l03334" /><CodeLine lineNumber="3334"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (&#42;LiveOut != &#42;LiveIn) &#123;</span></CodeLine>
<Link id="l03335" /><CodeLine lineNumber="3335"><span class="doxyHighlight">            &#42;LiveOut = &#42;LiveIn;</span></CodeLine>
<Link id="l03336" /><CodeLine lineNumber="3336"><span class="doxyHighlight">            OLChanged = </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03337" /><CodeLine lineNumber="3337"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l03338" /><CodeLine lineNumber="3338"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03339" /><CodeLine lineNumber="3339"></CodeLine>
<Link id="l03340" /><CodeLine lineNumber="3340"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// If no live-out value changed, there&#39;s no need to explore further.</span></CodeLine>
<Link id="l03341" /><CodeLine lineNumber="3341"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!OLChanged)</span></CodeLine>
<Link id="l03342" /><CodeLine lineNumber="3342"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03343" /><CodeLine lineNumber="3343"></CodeLine>
<Link id="l03344" /><CodeLine lineNumber="3344"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We should visit all successors. Ensure we&#39;ll visit any non-backedge</span></CodeLine>
<Link id="l03345" /><CodeLine lineNumber="3345"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// successors during this dataflow iteration; book backedge successors</span></CodeLine>
<Link id="l03346" /><CodeLine lineNumber="3346"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// to be visited next time around.</span></CodeLine>
<Link id="l03347" /><CodeLine lineNumber="3347"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;s : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#ad88ff1529541fb4e243cc8ed90b11131">successors</a>()) &#123;</span></CodeLine>
<Link id="l03348" /><CodeLine lineNumber="3348"><span class="doxyHighlight">          </span><span class="doxyHighlightComment">// Ignore out of scope / not-to-be-explored successors.</span></CodeLine>
<Link id="l03349" /><CodeLine lineNumber="3349"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LiveInIdx.contains(s))</span></CodeLine>
<Link id="l03350" /><CodeLine lineNumber="3350"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03351" /><CodeLine lineNumber="3351"></CodeLine>
<Link id="l03352" /><CodeLine lineNumber="3352"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BBToOrder&#91;s&#93; &gt; BBToOrder&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;) &#123;</span></CodeLine>
<Link id="l03353" /><CodeLine lineNumber="3353"><span class="doxyHighlight">            </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OnWorklist.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(s).second)</span></CodeLine>
<Link id="l03354" /><CodeLine lineNumber="3354"><span class="doxyHighlight">              Worklist.push(BBToOrder&#91;s&#93;);</span></CodeLine>
<Link id="l03355" /><CodeLine lineNumber="3355"><span class="doxyHighlight">          &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (OnPending.<a href="/docs/api/classes/llvm/smallptrsetimpl/#a9d834ae3da8c62c2b668dada51335eb0">insert</a>(s).second &amp;&amp; (FirstTrip || OLChanged)) &#123;</span></CodeLine>
<Link id="l03356" /><CodeLine lineNumber="3356"><span class="doxyHighlight">            Pending.push(BBToOrder&#91;s&#93;);</span></CodeLine>
<Link id="l03357" /><CodeLine lineNumber="3357"><span class="doxyHighlight">          &#125;</span></CodeLine>
<Link id="l03358" /><CodeLine lineNumber="3358"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03359" /><CodeLine lineNumber="3359"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03360" /><CodeLine lineNumber="3360"><span class="doxyHighlight">      Worklist.swap(Pending);</span></CodeLine>
<Link id="l03361" /><CodeLine lineNumber="3361"><span class="doxyHighlight">      <a href="/docs/api/namespaces/std/#ab8424022895aee3e366fb9a32f2883cb">std::swap</a>(OnWorklist, OnPending);</span></CodeLine>
<Link id="l03362" /><CodeLine lineNumber="3362"><span class="doxyHighlight">      OnPending.<a href="/docs/api/classes/llvm/smallptrsetimplbase/#a16413f1a88d8baca228d0a1b4cc0bfc6">clear</a>();</span></CodeLine>
<Link id="l03363" /><CodeLine lineNumber="3363"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Pending.empty());</span></CodeLine>
<Link id="l03364" /><CodeLine lineNumber="3364"><span class="doxyHighlight">      FirstTrip = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03365" /><CodeLine lineNumber="3365"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03366" /><CodeLine lineNumber="3366"></CodeLine>
<Link id="l03367" /><CodeLine lineNumber="3367"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Save live-ins to output vector. Ignore any that are still marked as being</span></CodeLine>
<Link id="l03368" /><CodeLine lineNumber="3368"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// VPHIs with no location -- those are variables that we know the value of,</span></CodeLine>
<Link id="l03369" /><CodeLine lineNumber="3369"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// but are not actually available in the register file.</span></CodeLine>
<Link id="l03370" /><CodeLine lineNumber="3370"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : BlockOrders) &#123;</span></CodeLine>
<Link id="l03371" /><CodeLine lineNumber="3371"><span class="doxyHighlight">      DbgValue &#42;BlockLiveIn = LiveInIdx&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;;</span></CodeLine>
<Link id="l03372" /><CodeLine lineNumber="3372"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BlockLiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bbaf26793ed3fb3ea880eb66562c90d1826">DbgValue::NoVal</a>)</span></CodeLine>
<Link id="l03373" /><CodeLine lineNumber="3373"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03374" /><CodeLine lineNumber="3374"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BlockLiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#aa11be25d68038f30cb3e3cbe1e28839b">isUnjoinedPHI</a>())</span></CodeLine>
<Link id="l03375" /><CodeLine lineNumber="3375"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03376" /><CodeLine lineNumber="3376"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BlockLiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba520dc455d7fa69d828e881474255e2ed">DbgValue::VPHI</a>)</span></CodeLine>
<Link id="l03377" /><CodeLine lineNumber="3377"><span class="doxyHighlight">        BlockLiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#ad5057e38ab74080fe88552c870519a84">Kind</a> = <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba953f120c5617d3f2b42df3fd424222ad">DbgValue::Def</a>;</span></CodeLine>
<Link id="l03378" /><CodeLine lineNumber="3378"><span class="doxyHighlight">      &#91;&#91;maybe&#95;unused&#93;&#93; </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;&#91;Var, DILoc&#93; = DVMap.lookupDVID(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l03379" /><CodeLine lineNumber="3379"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(BlockLiveIn-&gt;<a href="/docs/api/classes/livedebugvalues/dbgvalue/#a127bb33bfa67d26975c12bf33568af48">Properties</a>.<a href="/docs/api/classes/livedebugvalues/dbgvalueproperties/#a87d598e34086fb45a3a64638bdc6097e">DIExpr</a>-&gt;<a href="/docs/api/classes/llvm/diexpression/#a7cc5f1632a4c520497898439c17dc026">getFragmentInfo</a>() ==</span></CodeLine>
<Link id="l03380" /><CodeLine lineNumber="3380"><span class="doxyHighlight">                 Var.getFragment() &amp;&amp;</span></CodeLine>
<Link id="l03381" /><CodeLine lineNumber="3381"><span class="doxyHighlight">             </span><span class="doxyHighlightStringLiteral">&quot;Fragment info missing during value prop&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03382" /><CodeLine lineNumber="3382"><span class="doxyHighlight">      Output&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>()&#93;.push&#95;back(std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, &#42;BlockLiveIn));</span></CodeLine>
<Link id="l03383" /><CodeLine lineNumber="3383"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03384" /><CodeLine lineNumber="3384"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightComment">// Per-variable loop.</span></CodeLine>
<Link id="l03385" /><CodeLine lineNumber="3385"></CodeLine>
<Link id="l03386" /><CodeLine lineNumber="3386"><span class="doxyHighlight">  BlockOrders.clear();</span></CodeLine>
<Link id="l03387" /><CodeLine lineNumber="3387"><span class="doxyHighlight">  BlocksToExplore.clear();</span></CodeLine>
<Link id="l03388" /><CodeLine lineNumber="3388"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03389" /><CodeLine lineNumber="3389"></CodeLine>
<Link id="l03390" /><CodeLine lineNumber="3390"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::placePHIsForSingleVarDefinition(</span></CodeLine>
<Link id="l03391" /><CodeLine lineNumber="3391"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/smallptrsetimpl">SmallPtrSetImpl&lt;MachineBasicBlock &#42;&gt;</a> &amp;InScopeBlocks,</span></CodeLine>
<Link id="l03392" /><CodeLine lineNumber="3392"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;AssignMBB, <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;VLocTracker&gt;</a> &amp;AllTheVLocs,</span></CodeLine>
<Link id="l03393" /><CodeLine lineNumber="3393"><span class="doxyHighlight">    <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, LiveInsT &amp;Output) &#123;</span></CodeLine>
<Link id="l03394" /><CodeLine lineNumber="3394"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there is a single definition of the variable, then working out it&#39;s</span></CodeLine>
<Link id="l03395" /><CodeLine lineNumber="3395"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value everywhere is very simple: it&#39;s every block dominated by the</span></CodeLine>
<Link id="l03396" /><CodeLine lineNumber="3396"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// definition. At the dominance frontier, the usual algorithm would:</span></CodeLine>
<Link id="l03397" /><CodeLine lineNumber="3397"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; Place PHIs,</span></CodeLine>
<Link id="l03398" /><CodeLine lineNumber="3398"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; Propagate values into them,</span></CodeLine>
<Link id="l03399" /><CodeLine lineNumber="3399"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; Find there&#39;s no incoming variable value from the other incoming branches</span></CodeLine>
<Link id="l03400" /><CodeLine lineNumber="3400"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    of the dominance frontier,</span></CodeLine>
<Link id="l03401" /><CodeLine lineNumber="3401"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; Specify there&#39;s no variable value in blocks past the frontier.</span></CodeLine>
<Link id="l03402" /><CodeLine lineNumber="3402"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This is a common case, hence it&#39;s worth special-casing it.</span></CodeLine>
<Link id="l03403" /><CodeLine lineNumber="3403"></CodeLine>
<Link id="l03404" /><CodeLine lineNumber="3404"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Pick out the variables value from the block transfer function.</span></CodeLine>
<Link id="l03405" /><CodeLine lineNumber="3405"><span class="doxyHighlight">  VLocTracker &amp;VLocs = AllTheVLocs&#91;AssignMBB-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>()&#93;;</span></CodeLine>
<Link id="l03406" /><CodeLine lineNumber="3406"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> ValueIt = VLocs.<a href="/docs/api/classes/livedebugvalues/vloctracker/#a74b0a01b154dab18a9a6b54fd737bcff">Vars</a>.find(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l03407" /><CodeLine lineNumber="3407"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DbgValue &amp;<a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a> = ValueIt-&gt;second;</span></CodeLine>
<Link id="l03408" /><CodeLine lineNumber="3408"></CodeLine>
<Link id="l03409" /><CodeLine lineNumber="3409"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If it&#39;s an explicit assignment of &quot;undef&quot;, that means there is no location</span></CodeLine>
<Link id="l03410" /><CodeLine lineNumber="3410"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// anyway, anywhere.</span></CodeLine>
<Link id="l03411" /><CodeLine lineNumber="3411"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a>.Kind == <a href="/docs/api/classes/livedebugvalues/dbgvalue/#ac144ecd93e2625852097b3cab8a9d9bba7c46001b3585fc4e42328dbe7123b5d4">DbgValue::Undef</a>)</span></CodeLine>
<Link id="l03412" /><CodeLine lineNumber="3412"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03413" /><CodeLine lineNumber="3413"></CodeLine>
<Link id="l03414" /><CodeLine lineNumber="3414"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Assign the variable value to entry to each dominated block that&#39;s in scope.</span></CodeLine>
<Link id="l03415" /><CodeLine lineNumber="3415"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Skip the definition block -- it&#39;s assigned the variable value in the middle</span></CodeLine>
<Link id="l03416" /><CodeLine lineNumber="3416"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// of the block somewhere.</span></CodeLine>
<Link id="l03417" /><CodeLine lineNumber="3417"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;ScopeBlock : InScopeBlocks) &#123;</span></CodeLine>
<Link id="l03418" /><CodeLine lineNumber="3418"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DomTree-&gt;properlyDominates(AssignMBB, ScopeBlock))</span></CodeLine>
<Link id="l03419" /><CodeLine lineNumber="3419"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03420" /><CodeLine lineNumber="3420"></CodeLine>
<Link id="l03421" /><CodeLine lineNumber="3421"><span class="doxyHighlight">    Output&#91;ScopeBlock-&gt;getNumber()&#93;.push&#95;back(&#123;<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>, <a href="/docs/api/namespaces/llvm/#a066e2a31a13d6520e52ae1944f194662">Value</a>&#125;);</span></CodeLine>
<Link id="l03422" /><CodeLine lineNumber="3422"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03423" /><CodeLine lineNumber="3423"></CodeLine>
<Link id="l03424" /><CodeLine lineNumber="3424"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// All blocks that aren&#39;t dominated have no live-in value, thus no variable</span></CodeLine>
<Link id="l03425" /><CodeLine lineNumber="3425"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value will be given to them.</span></CodeLine>
<Link id="l03426" /><CodeLine lineNumber="3426"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03427" /><CodeLine lineNumber="3427"></CodeLine>
<Link id="l03428" /><CodeLine lineNumber="3428"><span class="doxyHighlightPreprocessor">#if !defined(NDEBUG) || defined(LLVM&#95;ENABLE&#95;DUMP)</span></CodeLine>
<Link id="l03429" /><CodeLine lineNumber="3429" lineLink="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ae270bdce77ec139bf18564e50664dab8"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#ae270bdce77ec139bf18564e50664dab8">InstrRefBasedLDV::dump&#95;mloc&#95;transfer</a>(</span></CodeLine>
<Link id="l03430" /><CodeLine lineNumber="3430"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#abc9d9007b0d77bc0954612b88df15142">MLocTransferMap</a> &amp;mloc&#95;transfer)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l03431" /><CodeLine lineNumber="3431"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : mloc&#95;transfer) &#123;</span></CodeLine>
<Link id="l03432" /><CodeLine lineNumber="3432"><span class="doxyHighlight">    std::string foo = MTracker-&gt;LocIdxToName(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.first);</span></CodeLine>
<Link id="l03433" /><CodeLine lineNumber="3433"><span class="doxyHighlight">    std::string bar = MTracker-&gt;IDAsString(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.second);</span></CodeLine>
<Link id="l03434" /><CodeLine lineNumber="3434"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Loc &quot;</span><span class="doxyHighlight"> &lt;&lt; foo &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; --&gt; &quot;</span><span class="doxyHighlight"> &lt;&lt; bar &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\n&quot;</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03435" /><CodeLine lineNumber="3435"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03436" /><CodeLine lineNumber="3436"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03437" /><CodeLine lineNumber="3437"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l03438" /><CodeLine lineNumber="3438"></CodeLine>
<Link id="l03439" /><CodeLine lineNumber="3439"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::initialSetup(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF) &#123;</span></CodeLine>
<Link id="l03440" /><CodeLine lineNumber="3440"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Build some useful data structures.</span></CodeLine>
<Link id="l03441" /><CodeLine lineNumber="3441"></CodeLine>
<Link id="l03442" /><CodeLine lineNumber="3442"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/llvmcontext">LLVMContext</a> &amp;Context = MF.<a href="/docs/api/classes/llvm/machinefunction/#a977ddce262de45c645be23d951066351">getFunction</a>().<a href="/docs/api/classes/llvm/function/#a9fffac2512fe651f0d5e37e27f5bd51c">getContext</a>();</span></CodeLine>
<Link id="l03443" /><CodeLine lineNumber="3443"><span class="doxyHighlight">  EmptyExpr = <a href="/docs/api/classes/llvm/mdnode/#a7d10a7b9b7f40b04d27ed97c38ea1950">DIExpression::get</a>(Context, &#123;&#125;);</span></CodeLine>
<Link id="l03444" /><CodeLine lineNumber="3444"></CodeLine>
<Link id="l03445" /><CodeLine lineNumber="3445"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> hasNonArtificialLocation = &#91;&#93;(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>) -&gt; </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03446" /><CodeLine lineNumber="3446"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/debugloc">DebugLoc</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a> = <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getDebugLoc())</span></CodeLine>
<Link id="l03447" /><CodeLine lineNumber="3447"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#ad467c4ab9119043f9b7750ab986be61a">DL</a>.getLine() != 0;</span></CodeLine>
<Link id="l03448" /><CodeLine lineNumber="3448"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03449" /><CodeLine lineNumber="3449"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l03450" /><CodeLine lineNumber="3450"></CodeLine>
<Link id="l03451" /><CodeLine lineNumber="3451"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Collect a set of all the artificial blocks. Collect the size too, ilist</span></CodeLine>
<Link id="l03452" /><CodeLine lineNumber="3452"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// size calls are O(n).</span></CodeLine>
<Link id="l03453" /><CodeLine lineNumber="3453"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a> = 0;</span></CodeLine>
<Link id="l03454" /><CodeLine lineNumber="3454"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : MF) &#123;</span></CodeLine>
<Link id="l03455" /><CodeLine lineNumber="3455"><span class="doxyHighlight">    ++<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>;</span></CodeLine>
<Link id="l03456" /><CodeLine lineNumber="3456"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/namespaces/llvm/#a7dc3069afa2ce5ea62ac2eb183e51c00">none&#95;of</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a40bf8f9579717d3f9be7640f1c6d678b">instrs</a>(), hasNonArtificialLocation))</span></CodeLine>
<Link id="l03457" /><CodeLine lineNumber="3457"><span class="doxyHighlight">      ArtificialBlocks.insert(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03458" /><CodeLine lineNumber="3458"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03459" /><CodeLine lineNumber="3459"></CodeLine>
<Link id="l03460" /><CodeLine lineNumber="3460"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Compute mappings of block &lt;=&gt; RPO order.</span></CodeLine>
<Link id="l03461" /><CodeLine lineNumber="3461"><span class="doxyHighlight">  ReversePostOrderTraversal&lt;MachineFunction &#42;&gt; RPOT(&amp;MF);</span></CodeLine>
<Link id="l03462" /><CodeLine lineNumber="3462"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> RPONumber = 0;</span></CodeLine>
<Link id="l03463" /><CodeLine lineNumber="3463"><span class="doxyHighlight">  OrderToBB.reserve(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</span></CodeLine>
<Link id="l03464" /><CodeLine lineNumber="3464"><span class="doxyHighlight">  BBToOrder.reserve(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</span></CodeLine>
<Link id="l03465" /><CodeLine lineNumber="3465"><span class="doxyHighlight">  BBNumToRPO.reserve(<a href="/docs/api/files/lib/lib/analysis/inlineorder-cpp/#a7ee6f0cb51c3b9056199e9a0001fe8c3a6f6cb72d544962fa333e2e34ce64f719">Size</a>);</span></CodeLine>
<Link id="l03466" /><CodeLine lineNumber="3466"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> processMBB = &#91;&amp;&#93;(MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l03467" /><CodeLine lineNumber="3467"><span class="doxyHighlight">    OrderToBB.push&#95;back(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03468" /><CodeLine lineNumber="3468"><span class="doxyHighlight">    BBToOrder&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93; = RPONumber;</span></CodeLine>
<Link id="l03469" /><CodeLine lineNumber="3469"><span class="doxyHighlight">    BBNumToRPO&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>()&#93; = RPONumber;</span></CodeLine>
<Link id="l03470" /><CodeLine lineNumber="3470"><span class="doxyHighlight">    ++RPONumber;</span></CodeLine>
<Link id="l03471" /><CodeLine lineNumber="3471"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l03472" /><CodeLine lineNumber="3472"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : RPOT)</span></CodeLine>
<Link id="l03473" /><CodeLine lineNumber="3473"><span class="doxyHighlight">    processMBB(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03474" /><CodeLine lineNumber="3474"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MachineBasicBlock &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : MF)</span></CodeLine>
<Link id="l03475" /><CodeLine lineNumber="3475"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!BBToOrder.contains(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>))</span></CodeLine>
<Link id="l03476" /><CodeLine lineNumber="3476"><span class="doxyHighlight">      processMBB(&amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03477" /><CodeLine lineNumber="3477"></CodeLine>
<Link id="l03478" /><CodeLine lineNumber="3478"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Order value substitutions by their &quot;source&quot; operand pair, for quick lookup.</span></CodeLine>
<Link id="l03479" /><CodeLine lineNumber="3479"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(MF.DebugValueSubstitutions);</span></CodeLine>
<Link id="l03480" /><CodeLine lineNumber="3480"></CodeLine>
<Link id="l03481" /><CodeLine lineNumber="3481"><span class="doxyHighlightPreprocessor">#ifdef EXPENSIVE&#95;CHECKS</span></CodeLine>
<Link id="l03482" /><CodeLine lineNumber="3482"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// As an expensive check, test whether there are any duplicate substitution</span></CodeLine>
<Link id="l03483" /><CodeLine lineNumber="3483"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// sources in the collection.</span></CodeLine>
<Link id="l03484" /><CodeLine lineNumber="3484"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MF.DebugValueSubstitutions.size() &gt; 2) &#123;</span></CodeLine>
<Link id="l03485" /><CodeLine lineNumber="3485"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> It = MF.DebugValueSubstitutions.begin();</span></CodeLine>
<Link id="l03486" /><CodeLine lineNumber="3486"><span class="doxyHighlight">         It != std::prev(MF.DebugValueSubstitutions.end()); ++It) &#123;</span></CodeLine>
<Link id="l03487" /><CodeLine lineNumber="3487"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(It-&gt;Src != std::next(It)-&gt;Src &amp;&amp; </span><span class="doxyHighlightStringLiteral">&quot;Duplicate variable location &quot;</span></CodeLine>
<Link id="l03488" /><CodeLine lineNumber="3488"><span class="doxyHighlight">                                              </span><span class="doxyHighlightStringLiteral">&quot;substitution seen&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03489" /><CodeLine lineNumber="3489"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03490" /><CodeLine lineNumber="3490"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03491" /><CodeLine lineNumber="3491"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l03492" /><CodeLine lineNumber="3492"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03493" /><CodeLine lineNumber="3493"></CodeLine>
<Link id="l03494" /><CodeLine lineNumber="3494"><span class="doxyHighlightComment">// Produce an &quot;ejection map&quot; for blocks, i.e., what&#39;s the highest-numbered</span></CodeLine>
<Link id="l03495" /><CodeLine lineNumber="3495"><span class="doxyHighlightComment">// lexical scope it&#39;s used in. When exploring in DFS order and we pass that</span></CodeLine>
<Link id="l03496" /><CodeLine lineNumber="3496"><span class="doxyHighlightComment">// scope, the block can be processed and any tracking information freed.</span></CodeLine>
<Link id="l03497" /><CodeLine lineNumber="3497"><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> InstrRefBasedLDV::makeDepthFirstEjectionMap(</span></CodeLine>
<Link id="l03498" /><CodeLine lineNumber="3498"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;unsigned&gt;</a> &amp;EjectionMap,</span></CodeLine>
<Link id="l03499" /><CodeLine lineNumber="3499"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> ScopeToDILocT &amp;ScopeToDILocation,</span></CodeLine>
<Link id="l03500" /><CodeLine lineNumber="3500"><span class="doxyHighlight">    ScopeToAssignBlocksT &amp;ScopeToAssignBlocks) &#123;</span></CodeLine>
<Link id="l03501" /><CodeLine lineNumber="3501"><span class="doxyHighlight">  SmallPtrSet&lt;const MachineBasicBlock &#42;, 8&gt; BlocksToExplore;</span></CodeLine>
<Link id="l03502" /><CodeLine lineNumber="3502"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;std::pair&lt;LexicalScope &#42;, ssize&#95;t&gt;</a>, 4&gt; WorkStack;</span></CodeLine>
<Link id="l03503" /><CodeLine lineNumber="3503"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;TopScope = LS.getCurrentFunctionScope();</span></CodeLine>
<Link id="l03504" /><CodeLine lineNumber="3504"></CodeLine>
<Link id="l03505" /><CodeLine lineNumber="3505"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Unlike lexical scope explorers, we explore in reverse order, to find the</span></CodeLine>
<Link id="l03506" /><CodeLine lineNumber="3506"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// &quot;last&quot; lexical scope used for each block early.</span></CodeLine>
<Link id="l03507" /><CodeLine lineNumber="3507"><span class="doxyHighlight">  WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&#123;TopScope, TopScope-&gt;getChildren().size() - 1&#125;);</span></CodeLine>
<Link id="l03508" /><CodeLine lineNumber="3508"></CodeLine>
<Link id="l03509" /><CodeLine lineNumber="3509"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l03510" /><CodeLine lineNumber="3510"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;ScopePosition = WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>();</span></CodeLine>
<Link id="l03511" /><CodeLine lineNumber="3511"><span class="doxyHighlight">    LexicalScope &#42;WS = ScopePosition.first;</span></CodeLine>
<Link id="l03512" /><CodeLine lineNumber="3512"><span class="doxyHighlight">    ssize&#95;t ChildNum = ScopePosition.second--;</span></CodeLine>
<Link id="l03513" /><CodeLine lineNumber="3513"></CodeLine>
<Link id="l03514" /><CodeLine lineNumber="3514"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> SmallVectorImpl&lt;LexicalScope &#42;&gt; &amp;<a href="/docs/api/namespaces/llvm/logicalview/#a93d1317dbbd98cf3bdce4d7cb31e81d1a64e4aca4297806247f62a7b5f8cbd3df">Children</a> = WS-&gt;<a href="/docs/api/classes/llvm/lexicalscope/#a1e1fdb87c9819b28634bea00da2b6ca1">getChildren</a>();</span></CodeLine>
<Link id="l03515" /><CodeLine lineNumber="3515"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ChildNum &gt;= 0) &#123;</span></CodeLine>
<Link id="l03516" /><CodeLine lineNumber="3516"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// If ChildNum is positive, there are remaining children to explore.</span></CodeLine>
<Link id="l03517" /><CodeLine lineNumber="3517"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Push the child and its children-count onto the stack.</span></CodeLine>
<Link id="l03518" /><CodeLine lineNumber="3518"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;ChildScope = <a href="/docs/api/namespaces/llvm/logicalview/#a93d1317dbbd98cf3bdce4d7cb31e81d1a64e4aca4297806247f62a7b5f8cbd3df">Children</a>&#91;ChildNum&#93;;</span></CodeLine>
<Link id="l03519" /><CodeLine lineNumber="3519"><span class="doxyHighlight">      WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(</span></CodeLine>
<Link id="l03520" /><CodeLine lineNumber="3520"><span class="doxyHighlight">          std::make&#95;pair(ChildScope, ChildScope-&gt;getChildren().size() - 1));</span></CodeLine>
<Link id="l03521" /><CodeLine lineNumber="3521"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03522" /><CodeLine lineNumber="3522"><span class="doxyHighlight">      WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#ad97688dfe9cd802e2a0691cbe620218a">pop&#95;back</a>();</span></CodeLine>
<Link id="l03523" /><CodeLine lineNumber="3523"></CodeLine>
<Link id="l03524" /><CodeLine lineNumber="3524"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We&#39;ve explored all children and any later blocks: examine all blocks</span></CodeLine>
<Link id="l03525" /><CodeLine lineNumber="3525"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// in our scope. If they haven&#39;t yet had an ejection number set, then</span></CodeLine>
<Link id="l03526" /><CodeLine lineNumber="3526"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// this scope will be the last to use that block.</span></CodeLine>
<Link id="l03527" /><CodeLine lineNumber="3527"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DILocationIt = ScopeToDILocation.find(WS);</span></CodeLine>
<Link id="l03528" /><CodeLine lineNumber="3528"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DILocationIt != ScopeToDILocation.end()) &#123;</span></CodeLine>
<Link id="l03529" /><CodeLine lineNumber="3529"><span class="doxyHighlight">        getBlocksForScope(DILocationIt-&gt;second, BlocksToExplore,</span></CodeLine>
<Link id="l03530" /><CodeLine lineNumber="3530"><span class="doxyHighlight">                          ScopeToAssignBlocks.find(WS)-&gt;second);</span></CodeLine>
<Link id="l03531" /><CodeLine lineNumber="3531"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : BlocksToExplore) &#123;</span></CodeLine>
<Link id="l03532" /><CodeLine lineNumber="3532"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> BBNum = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>();</span></CodeLine>
<Link id="l03533" /><CodeLine lineNumber="3533"><span class="doxyHighlight">          </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (EjectionMap&#91;BBNum&#93; == 0)</span></CodeLine>
<Link id="l03534" /><CodeLine lineNumber="3534"><span class="doxyHighlight">            EjectionMap&#91;BBNum&#93; = WS-&gt;<a href="/docs/api/classes/llvm/lexicalscope/#a6cd93562d70581c0111c3642edc3bc83">getDFSOut</a>();</span></CodeLine>
<Link id="l03535" /><CodeLine lineNumber="3535"><span class="doxyHighlight">        &#125;</span></CodeLine>
<Link id="l03536" /><CodeLine lineNumber="3536"></CodeLine>
<Link id="l03537" /><CodeLine lineNumber="3537"><span class="doxyHighlight">        BlocksToExplore.clear();</span></CodeLine>
<Link id="l03538" /><CodeLine lineNumber="3538"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l03539" /><CodeLine lineNumber="3539"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03540" /><CodeLine lineNumber="3540"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03541" /><CodeLine lineNumber="3541"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03542" /><CodeLine lineNumber="3542"></CodeLine>
<Link id="l03543" /><CodeLine lineNumber="3543"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::depthFirstVLocAndEmit(</span></CodeLine>
<Link id="l03544" /><CodeLine lineNumber="3544"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> ScopeToDILocT &amp;ScopeToDILocation,</span></CodeLine>
<Link id="l03545" /><CodeLine lineNumber="3545"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> ScopeToVarsT &amp;ScopeToVars, ScopeToAssignBlocksT &amp;ScopeToAssignBlocks,</span></CodeLine>
<Link id="l03546" /><CodeLine lineNumber="3546"><span class="doxyHighlight">    LiveInsT &amp;Output, <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MOutLocs, <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MInLocs,</span></CodeLine>
<Link id="l03547" /><CodeLine lineNumber="3547"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;VLocTracker&gt;</a> &amp;AllTheVLocs, <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF,</span></CodeLine>
<Link id="l03548" /><CodeLine lineNumber="3548"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/targetpassconfig">TargetPassConfig</a> &amp;TPC) &#123;</span></CodeLine>
<Link id="l03549" /><CodeLine lineNumber="3549"><span class="doxyHighlight">  TTracker =</span></CodeLine>
<Link id="l03550" /><CodeLine lineNumber="3550"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> TransferTracker(TII, MTracker, MF, DVMap, &#42;TRI, CalleeSavedRegs, TPC);</span></CodeLine>
<Link id="l03551" /><CodeLine lineNumber="3551"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumLocs = MTracker-&gt;getNumLocs();</span></CodeLine>
<Link id="l03552" /><CodeLine lineNumber="3552"><span class="doxyHighlight">  VTracker = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03553" /><CodeLine lineNumber="3553"></CodeLine>
<Link id="l03554" /><CodeLine lineNumber="3554"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// No scopes? No variable locations.</span></CodeLine>
<Link id="l03555" /><CodeLine lineNumber="3555"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!LS.getCurrentFunctionScope())</span></CodeLine>
<Link id="l03556" /><CodeLine lineNumber="3556"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03557" /><CodeLine lineNumber="3557"></CodeLine>
<Link id="l03558" /><CodeLine lineNumber="3558"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Build map from block number to the last scope that uses the block.</span></CodeLine>
<Link id="l03559" /><CodeLine lineNumber="3559"><span class="doxyHighlight">  SmallVector&lt;unsigned, 16&gt; EjectionMap;</span></CodeLine>
<Link id="l03560" /><CodeLine lineNumber="3560"><span class="doxyHighlight">  EjectionMap.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>, 0);</span></CodeLine>
<Link id="l03561" /><CodeLine lineNumber="3561"><span class="doxyHighlight">  makeDepthFirstEjectionMap(EjectionMap, ScopeToDILocation,</span></CodeLine>
<Link id="l03562" /><CodeLine lineNumber="3562"><span class="doxyHighlight">                            ScopeToAssignBlocks);</span></CodeLine>
<Link id="l03563" /><CodeLine lineNumber="3563"></CodeLine>
<Link id="l03564" /><CodeLine lineNumber="3564"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Helper lambda for ejecting a block -- if nothing is going to use the block,</span></CodeLine>
<Link id="l03565" /><CodeLine lineNumber="3565"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// we can translate the variable location information into DBG&#95;VALUEs and then</span></CodeLine>
<Link id="l03566" /><CodeLine lineNumber="3566"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// free all of InstrRefBasedLDV&#39;s data structures.</span></CodeLine>
<Link id="l03567" /><CodeLine lineNumber="3567"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> EjectBlock = &#91;&amp;&#93;(MachineBasicBlock &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) -&gt; </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03568" /><CodeLine lineNumber="3568"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> BBNum = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>();</span></CodeLine>
<Link id="l03569" /><CodeLine lineNumber="3569"><span class="doxyHighlight">    AllTheVLocs&#91;BBNum&#93;.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l03570" /><CodeLine lineNumber="3570"></CodeLine>
<Link id="l03571" /><CodeLine lineNumber="3571"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Prime the transfer-tracker, and then step through all the block</span></CodeLine>
<Link id="l03572" /><CodeLine lineNumber="3572"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// instructions, installing transfers.</span></CodeLine>
<Link id="l03573" /><CodeLine lineNumber="3573"><span class="doxyHighlight">    MTracker-&gt;reset();</span></CodeLine>
<Link id="l03574" /><CodeLine lineNumber="3574"><span class="doxyHighlight">    MTracker-&gt;loadFromArray(MInLocs&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;, BBNum);</span></CodeLine>
<Link id="l03575" /><CodeLine lineNumber="3575"><span class="doxyHighlight">    TTracker-&gt;loadInlocs(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>, MInLocs&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;, DbgOpStore, Output&#91;BBNum&#93;, NumLocs);</span></CodeLine>
<Link id="l03576" /><CodeLine lineNumber="3576"></CodeLine>
<Link id="l03577" /><CodeLine lineNumber="3577"><span class="doxyHighlight">    CurBB = BBNum;</span></CodeLine>
<Link id="l03578" /><CodeLine lineNumber="3578"><span class="doxyHighlight">    CurInst = 1;</span></CodeLine>
<Link id="l03579" /><CodeLine lineNumber="3579"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l03580" /><CodeLine lineNumber="3580"><span class="doxyHighlight">      process(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, &amp;MOutLocs, &amp;MInLocs);</span></CodeLine>
<Link id="l03581" /><CodeLine lineNumber="3581"><span class="doxyHighlight">      TTracker-&gt;checkInstForNewValues(CurInst, <a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>.getIterator());</span></CodeLine>
<Link id="l03582" /><CodeLine lineNumber="3582"><span class="doxyHighlight">      ++CurInst;</span></CodeLine>
<Link id="l03583" /><CodeLine lineNumber="3583"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03584" /><CodeLine lineNumber="3584"></CodeLine>
<Link id="l03585" /><CodeLine lineNumber="3585"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Free machine-location tables for this block.</span></CodeLine>
<Link id="l03586" /><CodeLine lineNumber="3586"><span class="doxyHighlight">    MInLocs.<a href="/docs/api/structs/livedebugvalues/funcvaluetable/#a0e4dbf8c08bcf39b06f1fa457c8b1d5d">ejectTableForBlock</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03587" /><CodeLine lineNumber="3587"><span class="doxyHighlight">    MOutLocs.<a href="/docs/api/structs/livedebugvalues/funcvaluetable/#a0e4dbf8c08bcf39b06f1fa457c8b1d5d">ejectTableForBlock</a>(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03588" /><CodeLine lineNumber="3588"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We don&#39;t need live-in variable values for this block either.</span></CodeLine>
<Link id="l03589" /><CodeLine lineNumber="3589"><span class="doxyHighlight">    Output&#91;BBNum&#93;.clear();</span></CodeLine>
<Link id="l03590" /><CodeLine lineNumber="3590"><span class="doxyHighlight">    AllTheVLocs&#91;BBNum&#93;.<a href="/docs/api/classes/llvm/smallvectorimpl/#aac0ea55010b7b1a301e65a0baea057aa">clear</a>();</span></CodeLine>
<Link id="l03591" /><CodeLine lineNumber="3591"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l03592" /><CodeLine lineNumber="3592"></CodeLine>
<Link id="l03593" /><CodeLine lineNumber="3593"><span class="doxyHighlight">  SmallPtrSet&lt;const MachineBasicBlock &#42;, 8&gt; BlocksToExplore;</span></CodeLine>
<Link id="l03594" /><CodeLine lineNumber="3594"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;std::pair&lt;LexicalScope &#42;, ssize&#95;t&gt;</a>, 4&gt; WorkStack;</span></CodeLine>
<Link id="l03595" /><CodeLine lineNumber="3595"><span class="doxyHighlight">  WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(&#123;LS.getCurrentFunctionScope(), 0&#125;);</span></CodeLine>
<Link id="l03596" /><CodeLine lineNumber="3596"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> HighestDFSIn = 0;</span></CodeLine>
<Link id="l03597" /><CodeLine lineNumber="3597"></CodeLine>
<Link id="l03598" /><CodeLine lineNumber="3598"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Proceed to explore in depth first order.</span></CodeLine>
<Link id="l03599" /><CodeLine lineNumber="3599"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">while</span><span class="doxyHighlight"> (!WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#ad9a3c7bc26b130377bbafc170b5f88a2">empty</a>()) &#123;</span></CodeLine>
<Link id="l03600" /><CodeLine lineNumber="3600"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;ScopePosition = WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatecommon/#acd9e771a3296c6b24146955754620557">back</a>();</span></CodeLine>
<Link id="l03601" /><CodeLine lineNumber="3601"><span class="doxyHighlight">    LexicalScope &#42;WS = ScopePosition.first;</span></CodeLine>
<Link id="l03602" /><CodeLine lineNumber="3602"><span class="doxyHighlight">    ssize&#95;t ChildNum = ScopePosition.second++;</span></CodeLine>
<Link id="l03603" /><CodeLine lineNumber="3603"></CodeLine>
<Link id="l03604" /><CodeLine lineNumber="3604"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We obesrve scopes with children twice here, once descending in, once</span></CodeLine>
<Link id="l03605" /><CodeLine lineNumber="3605"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// ascending out of the scope nest. Use HighestDFSIn as a ratchet to ensure</span></CodeLine>
<Link id="l03606" /><CodeLine lineNumber="3606"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// we don&#39;t process a scope twice. Additionally, ignore scopes that don&#39;t</span></CodeLine>
<Link id="l03607" /><CodeLine lineNumber="3607"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// have a DILocation -- by proxy, this means we never tracked any variable</span></CodeLine>
<Link id="l03608" /><CodeLine lineNumber="3608"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// assignments in that scope.</span></CodeLine>
<Link id="l03609" /><CodeLine lineNumber="3609"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DILocIt = ScopeToDILocation.find(WS);</span></CodeLine>
<Link id="l03610" /><CodeLine lineNumber="3610"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (HighestDFSIn &lt;= WS-&gt;getDFSIn() &amp;&amp; DILocIt != ScopeToDILocation.end()) &#123;</span></CodeLine>
<Link id="l03611" /><CodeLine lineNumber="3611"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DILocation &#42;DILoc = DILocIt-&gt;second;</span></CodeLine>
<Link id="l03612" /><CodeLine lineNumber="3612"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;VarsWeCareAbout = ScopeToVars.find(WS)-&gt;second;</span></CodeLine>
<Link id="l03613" /><CodeLine lineNumber="3613"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;BlocksInScope = ScopeToAssignBlocks.find(WS)-&gt;second;</span></CodeLine>
<Link id="l03614" /><CodeLine lineNumber="3614"></CodeLine>
<Link id="l03615" /><CodeLine lineNumber="3615"><span class="doxyHighlight">      buildVLocValueMap(DILoc, VarsWeCareAbout, BlocksInScope, Output, MOutLocs,</span></CodeLine>
<Link id="l03616" /><CodeLine lineNumber="3616"><span class="doxyHighlight">                        MInLocs, AllTheVLocs);</span></CodeLine>
<Link id="l03617" /><CodeLine lineNumber="3617"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03618" /><CodeLine lineNumber="3618"></CodeLine>
<Link id="l03619" /><CodeLine lineNumber="3619"><span class="doxyHighlight">    HighestDFSIn = std::max(HighestDFSIn, WS-&gt;<a href="/docs/api/classes/llvm/lexicalscope/#a15011e35c6917966641150d76521b2d7">getDFSIn</a>());</span></CodeLine>
<Link id="l03620" /><CodeLine lineNumber="3620"></CodeLine>
<Link id="l03621" /><CodeLine lineNumber="3621"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Descend into any scope nests.</span></CodeLine>
<Link id="l03622" /><CodeLine lineNumber="3622"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> SmallVectorImpl&lt;LexicalScope &#42;&gt; &amp;<a href="/docs/api/namespaces/llvm/logicalview/#a93d1317dbbd98cf3bdce4d7cb31e81d1a64e4aca4297806247f62a7b5f8cbd3df">Children</a> = WS-&gt;<a href="/docs/api/classes/llvm/lexicalscope/#a1e1fdb87c9819b28634bea00da2b6ca1">getChildren</a>();</span></CodeLine>
<Link id="l03623" /><CodeLine lineNumber="3623"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ChildNum &lt; (ssize&#95;t)<a href="/docs/api/namespaces/llvm/logicalview/#a93d1317dbbd98cf3bdce4d7cb31e81d1a64e4aca4297806247f62a7b5f8cbd3df">Children</a>.size()) &#123;</span></CodeLine>
<Link id="l03624" /><CodeLine lineNumber="3624"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// There are children to explore -- push onto stack and continue.</span></CodeLine>
<Link id="l03625" /><CodeLine lineNumber="3625"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;ChildScope = <a href="/docs/api/namespaces/llvm/logicalview/#a93d1317dbbd98cf3bdce4d7cb31e81d1a64e4aca4297806247f62a7b5f8cbd3df">Children</a>&#91;ChildNum&#93;;</span></CodeLine>
<Link id="l03626" /><CodeLine lineNumber="3626"><span class="doxyHighlight">      WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(std::make&#95;pair(ChildScope, 0));</span></CodeLine>
<Link id="l03627" /><CodeLine lineNumber="3627"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03628" /><CodeLine lineNumber="3628"><span class="doxyHighlight">      WorkStack.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#ad97688dfe9cd802e2a0691cbe620218a">pop&#95;back</a>();</span></CodeLine>
<Link id="l03629" /><CodeLine lineNumber="3629"></CodeLine>
<Link id="l03630" /><CodeLine lineNumber="3630"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// We&#39;ve explored a leaf, or have explored all the children of a scope.</span></CodeLine>
<Link id="l03631" /><CodeLine lineNumber="3631"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Try to eject any blocks where this is the last scope it&#39;s relevant to.</span></CodeLine>
<Link id="l03632" /><CodeLine lineNumber="3632"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DILocationIt = ScopeToDILocation.find(WS);</span></CodeLine>
<Link id="l03633" /><CodeLine lineNumber="3633"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (DILocationIt == ScopeToDILocation.end())</span></CodeLine>
<Link id="l03634" /><CodeLine lineNumber="3634"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03635" /><CodeLine lineNumber="3635"></CodeLine>
<Link id="l03636" /><CodeLine lineNumber="3636"><span class="doxyHighlight">      getBlocksForScope(DILocationIt-&gt;second, BlocksToExplore,</span></CodeLine>
<Link id="l03637" /><CodeLine lineNumber="3637"><span class="doxyHighlight">                        ScopeToAssignBlocks.find(WS)-&gt;second);</span></CodeLine>
<Link id="l03638" /><CodeLine lineNumber="3638"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : BlocksToExplore)</span></CodeLine>
<Link id="l03639" /><CodeLine lineNumber="3639"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (WS-&gt;<a href="/docs/api/classes/llvm/lexicalscope/#a6cd93562d70581c0111c3642edc3bc83">getDFSOut</a>() == EjectionMap&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>()&#93;)</span></CodeLine>
<Link id="l03640" /><CodeLine lineNumber="3640"><span class="doxyHighlight">          EjectBlock(</span><span class="doxyHighlightKeyword">const&#95;cast&lt;</span><span class="doxyHighlight">MachineBasicBlock &amp;</span><span class="doxyHighlightKeyword">&gt;</span><span class="doxyHighlight">(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>));</span></CodeLine>
<Link id="l03641" /><CodeLine lineNumber="3641"></CodeLine>
<Link id="l03642" /><CodeLine lineNumber="3642"><span class="doxyHighlight">      BlocksToExplore.clear();</span></CodeLine>
<Link id="l03643" /><CodeLine lineNumber="3643"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03644" /><CodeLine lineNumber="3644"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03645" /><CodeLine lineNumber="3645"></CodeLine>
<Link id="l03646" /><CodeLine lineNumber="3646"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Some artificial blocks may not have been ejected, meaning they&#39;re not</span></CodeLine>
<Link id="l03647" /><CodeLine lineNumber="3647"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// connected to an actual legitimate scope. This can technically happen</span></CodeLine>
<Link id="l03648" /><CodeLine lineNumber="3648"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// with things like the entry block. In theory, we shouldn&#39;t need to do</span></CodeLine>
<Link id="l03649" /><CodeLine lineNumber="3649"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// anything for such out-of-scope blocks, but for the sake of being similar</span></CodeLine>
<Link id="l03650" /><CodeLine lineNumber="3650"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// to VarLocBasedLDV, eject these too.</span></CodeLine>
<Link id="l03651" /><CodeLine lineNumber="3651"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : ArtificialBlocks)</span></CodeLine>
<Link id="l03652" /><CodeLine lineNumber="3652"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (MInLocs.<a href="/docs/api/structs/livedebugvalues/funcvaluetable/#ab43dc398515864865e6d9bff5964d3c9">hasTableFor</a>(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>))</span></CodeLine>
<Link id="l03653" /><CodeLine lineNumber="3653"><span class="doxyHighlight">      EjectBlock(&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>);</span></CodeLine>
<Link id="l03654" /><CodeLine lineNumber="3654"></CodeLine>
<Link id="l03655" /><CodeLine lineNumber="3655"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> emitTransfers();</span></CodeLine>
<Link id="l03656" /><CodeLine lineNumber="3656"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03657" /><CodeLine lineNumber="3657"></CodeLine>
<Link id="l03658" /><CodeLine lineNumber="3658"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::emitTransfers() &#123;</span></CodeLine>
<Link id="l03659" /><CodeLine lineNumber="3659"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Go through all the transfers recorded in the TransferTracker -- this is</span></CodeLine>
<Link id="l03660" /><CodeLine lineNumber="3660"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// both the live-ins to a block, and any movements of values that happen</span></CodeLine>
<Link id="l03661" /><CodeLine lineNumber="3661"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// in the middle.</span></CodeLine>
<Link id="l03662" /><CodeLine lineNumber="3662"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a> : TTracker-&gt;Transfers) &#123;</span></CodeLine>
<Link id="l03663" /><CodeLine lineNumber="3663"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// We have to insert DBG&#95;VALUEs in a consistent order, otherwise they</span></CodeLine>
<Link id="l03664" /><CodeLine lineNumber="3664"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// appear in DWARF in different orders. Use the order that they appear</span></CodeLine>
<Link id="l03665" /><CodeLine lineNumber="3665"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// when walking through each block / each instruction, stored in</span></CodeLine>
<Link id="l03666" /><CodeLine lineNumber="3666"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// DVMap.</span></CodeLine>
<Link id="l03667" /><CodeLine lineNumber="3667"><span class="doxyHighlight">    <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.Insts, llvm::less&#95;first());</span></CodeLine>
<Link id="l03668" /><CodeLine lineNumber="3668"></CodeLine>
<Link id="l03669" /><CodeLine lineNumber="3669"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Insert either before or after the designated point...</span></CodeLine>
<Link id="l03670" /><CodeLine lineNumber="3670"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.MBB) &#123;</span></CodeLine>
<Link id="l03671" /><CodeLine lineNumber="3671"><span class="doxyHighlight">      MachineBasicBlock &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.MBB;</span></CodeLine>
<Link id="l03672" /><CodeLine lineNumber="3672"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Pair : <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.Insts)</span></CodeLine>
<Link id="l03673" /><CodeLine lineNumber="3673"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3435a2381e60e842e915f85c931b7dde">insert</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.Pos, Pair.second);</span></CodeLine>
<Link id="l03674" /><CodeLine lineNumber="3674"><span class="doxyHighlight">    &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03675" /><CodeLine lineNumber="3675"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Terminators, like tail calls, can clobber things. Don&#39;t try and place</span></CodeLine>
<Link id="l03676" /><CodeLine lineNumber="3676"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// transfers after them.</span></CodeLine>
<Link id="l03677" /><CodeLine lineNumber="3677"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.Pos-&gt;isTerminator())</span></CodeLine>
<Link id="l03678" /><CodeLine lineNumber="3678"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03679" /><CodeLine lineNumber="3679"></CodeLine>
<Link id="l03680" /><CodeLine lineNumber="3680"><span class="doxyHighlight">      MachineBasicBlock &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.Pos-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#acf6442108e21e7e5379feb8962de65b7">getParent</a>();</span></CodeLine>
<Link id="l03681" /><CodeLine lineNumber="3681"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;Pair : <a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.Insts)</span></CodeLine>
<Link id="l03682" /><CodeLine lineNumber="3682"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#aec460b7ed48d97ed84ae2466b498763f">insertAfterBundle</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>.Pos, Pair.second);</span></CodeLine>
<Link id="l03683" /><CodeLine lineNumber="3683"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03684" /><CodeLine lineNumber="3684"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03685" /><CodeLine lineNumber="3685"></CodeLine>
<Link id="l03686" /><CodeLine lineNumber="3686"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> TTracker-&gt;Transfers.size() != 0;</span></CodeLine>
<Link id="l03687" /><CodeLine lineNumber="3687"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03688" /><CodeLine lineNumber="3688"></CodeLine>
<Link id="l03689" /><CodeLine lineNumber="3689"><span class="doxyHighlightComment">/// Calculate the liveness information for the given machine function and</span></CodeLine>
<Link id="l03690" /><CodeLine lineNumber="3690"><span class="doxyHighlightComment">/// extend ranges across basic blocks.</span></CodeLine>
<Link id="l03691" /><CodeLine lineNumber="3691"><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> InstrRefBasedLDV::ExtendRanges(<a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF,</span></CodeLine>
<Link id="l03692" /><CodeLine lineNumber="3692"><span class="doxyHighlight">                                    <a href="/docs/api/classes/llvm/machinedominatortree">MachineDominatorTree</a> &#42;DomTree,</span></CodeLine>
<Link id="l03693" /><CodeLine lineNumber="3693"><span class="doxyHighlight">                                    <a href="/docs/api/classes/llvm/targetpassconfig">TargetPassConfig</a> &#42;TPC,</span></CodeLine>
<Link id="l03694" /><CodeLine lineNumber="3694"><span class="doxyHighlight">                                    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/livedebugvalues-cpp/#a489e25cdb88a2edf7da9ab3095a23b43">InputBBLimit</a>,</span></CodeLine>
<Link id="l03695" /><CodeLine lineNumber="3695"><span class="doxyHighlight">                                    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> InputDbgValLimit) &#123;</span></CodeLine>
<Link id="l03696" /><CodeLine lineNumber="3696"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// No subprogram means this function contains no debuginfo.</span></CodeLine>
<Link id="l03697" /><CodeLine lineNumber="3697"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!MF.<a href="/docs/api/classes/llvm/machinefunction/#a977ddce262de45c645be23d951066351">getFunction</a>().<a href="/docs/api/classes/llvm/function/#a4d834f9897d15e3a6349063b5d637cd8">getSubprogram</a>())</span></CodeLine>
<Link id="l03698" /><CodeLine lineNumber="3698"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03699" /><CodeLine lineNumber="3699"></CodeLine>
<Link id="l03700" /><CodeLine lineNumber="3700"><span class="doxyHighlight">  <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;\\nDebug Range Extension\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03701" /><CodeLine lineNumber="3701"><span class="doxyHighlight">  this-&gt;TPC = TPC;</span></CodeLine>
<Link id="l03702" /><CodeLine lineNumber="3702"></CodeLine>
<Link id="l03703" /><CodeLine lineNumber="3703"><span class="doxyHighlight">  this-&gt;DomTree = DomTree;</span></CodeLine>
<Link id="l03704" /><CodeLine lineNumber="3704"><span class="doxyHighlight">  TRI = MF.<a href="/docs/api/classes/llvm/machinefunction/#a3825368aca2bc1550d173660df4da6a6">getSubtarget</a>().<a href="/docs/api/classes/llvm/targetsubtargetinfo/#a43c530c830206ecf5ad3359364634c75">getRegisterInfo</a>();</span></CodeLine>
<Link id="l03705" /><CodeLine lineNumber="3705"><span class="doxyHighlight">  MRI = &amp;MF.<a href="/docs/api/classes/llvm/machinefunction/#a810234b6b3d223b7c74a4253fcc5ea5e">getRegInfo</a>();</span></CodeLine>
<Link id="l03706" /><CodeLine lineNumber="3706"><span class="doxyHighlight">  TII = MF.<a href="/docs/api/classes/llvm/machinefunction/#a3825368aca2bc1550d173660df4da6a6">getSubtarget</a>().<a href="/docs/api/classes/llvm/targetsubtargetinfo/#acd858ed72f11db9444617740c3622608">getInstrInfo</a>();</span></CodeLine>
<Link id="l03707" /><CodeLine lineNumber="3707"><span class="doxyHighlight">  TFI = MF.<a href="/docs/api/classes/llvm/machinefunction/#a3825368aca2bc1550d173660df4da6a6">getSubtarget</a>().<a href="/docs/api/classes/llvm/targetsubtargetinfo/#ac83b44e69c9f9f4f9d60be2d72f4a5df">getFrameLowering</a>();</span></CodeLine>
<Link id="l03708" /><CodeLine lineNumber="3708"><span class="doxyHighlight">  TFI-&gt;<a href="/docs/api/classes/llvm/targetframelowering/#a647fbf2c5d5bb2fe4f4b5b9af7e0ab00">getCalleeSaves</a>(MF, CalleeSavedRegs);</span></CodeLine>
<Link id="l03709" /><CodeLine lineNumber="3709"><span class="doxyHighlight">  MFI = &amp;MF.<a href="/docs/api/classes/llvm/machinefunction/#a54f334a9c8ca6d105eae383ae87e4524">getFrameInfo</a>();</span></CodeLine>
<Link id="l03710" /><CodeLine lineNumber="3710"><span class="doxyHighlight">  LS.initialize(MF);</span></CodeLine>
<Link id="l03711" /><CodeLine lineNumber="3711"></CodeLine>
<Link id="l03712" /><CodeLine lineNumber="3712"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;STI = MF.<a href="/docs/api/classes/llvm/machinefunction/#a3825368aca2bc1550d173660df4da6a6">getSubtarget</a>();</span></CodeLine>
<Link id="l03713" /><CodeLine lineNumber="3713"><span class="doxyHighlight">  AdjustsStackInCalls = MFI-&gt;adjustsStack() &amp;&amp;</span></CodeLine>
<Link id="l03714" /><CodeLine lineNumber="3714"><span class="doxyHighlight">                        STI.<a href="/docs/api/classes/llvm/targetsubtargetinfo/#ac83b44e69c9f9f4f9d60be2d72f4a5df">getFrameLowering</a>()-&gt;<a href="/docs/api/classes/llvm/targetframelowering/#a52171334abe255afc89c23b8c688bf49">stackProbeFunctionModifiesSP</a>();</span></CodeLine>
<Link id="l03715" /><CodeLine lineNumber="3715"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AdjustsStackInCalls)</span></CodeLine>
<Link id="l03716" /><CodeLine lineNumber="3716"><span class="doxyHighlight">    StackProbeSymbolName = STI.getTargetLowering()-&gt;getStackProbeSymbolName(MF);</span></CodeLine>
<Link id="l03717" /><CodeLine lineNumber="3717"></CodeLine>
<Link id="l03718" /><CodeLine lineNumber="3718"><span class="doxyHighlight">  MTracker =</span></CodeLine>
<Link id="l03719" /><CodeLine lineNumber="3719"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> MLocTracker(MF, &#42;TII, &#42;TRI, &#42;MF.<a href="/docs/api/classes/llvm/machinefunction/#a3825368aca2bc1550d173660df4da6a6">getSubtarget</a>().<a href="/docs/api/classes/llvm/targetsubtargetinfo/#ade3f0d8b35d67c43df9425bb730a9a7c">getTargetLowering</a>());</span></CodeLine>
<Link id="l03720" /><CodeLine lineNumber="3720"><span class="doxyHighlight">  VTracker = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03721" /><CodeLine lineNumber="3721"><span class="doxyHighlight">  TTracker = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03722" /><CodeLine lineNumber="3722"></CodeLine>
<Link id="l03723" /><CodeLine lineNumber="3723"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;MLocTransferMap, 32&gt;</a> MLocTransfer;</span></CodeLine>
<Link id="l03724" /><CodeLine lineNumber="3724"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;VLocTracker, 8&gt;</a> vlocs;</span></CodeLine>
<Link id="l03725" /><CodeLine lineNumber="3725"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#a4fcc5fc74d98f09bd495e93cec779cbc">LiveInsT</a> SavedLiveIns;</span></CodeLine>
<Link id="l03726" /><CodeLine lineNumber="3726"></CodeLine>
<Link id="l03727" /><CodeLine lineNumber="3727"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a> = -1;</span></CodeLine>
<Link id="l03728" /><CodeLine lineNumber="3728"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : MF)</span></CodeLine>
<Link id="l03729" /><CodeLine lineNumber="3729"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a> = std::max(<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>.<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>(), <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>);</span></CodeLine>
<Link id="l03730" /><CodeLine lineNumber="3730"><span class="doxyHighlight">  <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a> &gt;= 0);</span></CodeLine>
<Link id="l03731" /><CodeLine lineNumber="3731"><span class="doxyHighlight">  ++<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>;</span></CodeLine>
<Link id="l03732" /><CodeLine lineNumber="3732"></CodeLine>
<Link id="l03733" /><CodeLine lineNumber="3733"><span class="doxyHighlight">  initialSetup(MF);</span></CodeLine>
<Link id="l03734" /><CodeLine lineNumber="3734"></CodeLine>
<Link id="l03735" /><CodeLine lineNumber="3735"><span class="doxyHighlight">  MLocTransfer.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>);</span></CodeLine>
<Link id="l03736" /><CodeLine lineNumber="3736"><span class="doxyHighlight">  vlocs.<a href="/docs/api/classes/llvm/smallvectorimpl/#ad0b3d8447f88377b62d9c019f3c4e118">resize</a>(<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>, VLocTracker(DVMap, OverlapFragments, EmptyExpr));</span></CodeLine>
<Link id="l03737" /><CodeLine lineNumber="3737"><span class="doxyHighlight">  SavedLiveIns.resize(<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>);</span></CodeLine>
<Link id="l03738" /><CodeLine lineNumber="3738"></CodeLine>
<Link id="l03739" /><CodeLine lineNumber="3739"><span class="doxyHighlight">  produceMLocTransferFunction(MF, MLocTransfer, <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>);</span></CodeLine>
<Link id="l03740" /><CodeLine lineNumber="3740"></CodeLine>
<Link id="l03741" /><CodeLine lineNumber="3741"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Allocate and initialize two array-of-arrays for the live-in and live-out</span></CodeLine>
<Link id="l03742" /><CodeLine lineNumber="3742"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// machine values. The outer dimension is the block number; while the inner</span></CodeLine>
<Link id="l03743" /><CodeLine lineNumber="3743"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// dimension is a LocIdx from MLocTracker.</span></CodeLine>
<Link id="l03744" /><CodeLine lineNumber="3744"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumLocs = MTracker-&gt;getNumLocs();</span></CodeLine>
<Link id="l03745" /><CodeLine lineNumber="3745"><span class="doxyHighlight">  FuncValueTable MOutLocs(<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>, NumLocs);</span></CodeLine>
<Link id="l03746" /><CodeLine lineNumber="3746"><span class="doxyHighlight">  FuncValueTable MInLocs(<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>, NumLocs);</span></CodeLine>
<Link id="l03747" /><CodeLine lineNumber="3747"></CodeLine>
<Link id="l03748" /><CodeLine lineNumber="3748"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Solve the machine value dataflow problem using the MLocTransfer function,</span></CodeLine>
<Link id="l03749" /><CodeLine lineNumber="3749"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// storing the computed live-ins / live-outs into the array-of-arrays. We use</span></CodeLine>
<Link id="l03750" /><CodeLine lineNumber="3750"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// both live-ins and live-outs for decision making in the variable value</span></CodeLine>
<Link id="l03751" /><CodeLine lineNumber="3751"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// dataflow problem.</span></CodeLine>
<Link id="l03752" /><CodeLine lineNumber="3752"><span class="doxyHighlight">  buildMLocValueMap(MF, MInLocs, MOutLocs, MLocTransfer);</span></CodeLine>
<Link id="l03753" /><CodeLine lineNumber="3753"></CodeLine>
<Link id="l03754" /><CodeLine lineNumber="3754"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Patch up debug phi numbers, turning unknown block-live-in values into</span></CodeLine>
<Link id="l03755" /><CodeLine lineNumber="3755"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// either live-through machine values, or PHIs.</span></CodeLine>
<Link id="l03756" /><CodeLine lineNumber="3756"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;DBG&#95;PHI : DebugPHINumToValue) &#123;</span></CodeLine>
<Link id="l03757" /><CodeLine lineNumber="3757"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Identify unresolved block-live-ins.</span></CodeLine>
<Link id="l03758" /><CodeLine lineNumber="3758"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DBG&#95;PHI.ValueRead)</span></CodeLine>
<Link id="l03759" /><CodeLine lineNumber="3759"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03760" /><CodeLine lineNumber="3760"></CodeLine>
<Link id="l03761" /><CodeLine lineNumber="3761"><span class="doxyHighlight">    ValueIDNum &amp;Num = &#42;DBG&#95;PHI.ValueRead;</span></CodeLine>
<Link id="l03762" /><CodeLine lineNumber="3762"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#a29e1496690d23acbdb69c5b882f5bf45">isPHI</a>())</span></CodeLine>
<Link id="l03763" /><CodeLine lineNumber="3763"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">continue</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03764" /><CodeLine lineNumber="3764"></CodeLine>
<Link id="l03765" /><CodeLine lineNumber="3765"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> BlockNo = Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#acd482282b8eb9755d8ac0e82ba23c20b">getBlock</a>();</span></CodeLine>
<Link id="l03766" /><CodeLine lineNumber="3766"><span class="doxyHighlight">    LocIdx LocNo = Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#af0ee865517c9747fa74f9eb3ed54578a">getLoc</a>();</span></CodeLine>
<Link id="l03767" /><CodeLine lineNumber="3767"><span class="doxyHighlight">    ValueIDNum ResolvedValue = MInLocs&#91;BlockNo&#93;&#91;LocNo.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93;;</span></CodeLine>
<Link id="l03768" /><CodeLine lineNumber="3768"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// If there is no resolved value for this live-in then it is not directly</span></CodeLine>
<Link id="l03769" /><CodeLine lineNumber="3769"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// reachable from the entry block -- model it as a PHI on entry to this</span></CodeLine>
<Link id="l03770" /><CodeLine lineNumber="3770"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// block, which means we leave the ValueIDNum unchanged.</span></CodeLine>
<Link id="l03771" /><CodeLine lineNumber="3771"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (ResolvedValue != <a href="/docs/api/classes/livedebugvalues/valueidnum/#a98d44bec6b754ac8786ab97f219f06f1">ValueIDNum::EmptyValue</a>)</span></CodeLine>
<Link id="l03772" /><CodeLine lineNumber="3772"><span class="doxyHighlight">      Num = ResolvedValue;</span></CodeLine>
<Link id="l03773" /><CodeLine lineNumber="3773"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03774" /><CodeLine lineNumber="3774"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Later, we&#39;ll be looking up ranges of instruction numbers.</span></CodeLine>
<Link id="l03775" /><CodeLine lineNumber="3775"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(DebugPHINumToValue);</span></CodeLine>
<Link id="l03776" /><CodeLine lineNumber="3776"></CodeLine>
<Link id="l03777" /><CodeLine lineNumber="3777"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Walk back through each block / instruction, collecting DBG&#95;VALUE</span></CodeLine>
<Link id="l03778" /><CodeLine lineNumber="3778"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// instructions and recording what machine value their operands refer to.</span></CodeLine>
<Link id="l03779" /><CodeLine lineNumber="3779"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (MachineBasicBlock &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> : OrderToBB) &#123;</span></CodeLine>
<Link id="l03780" /><CodeLine lineNumber="3780"><span class="doxyHighlight">    CurBB = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>();</span></CodeLine>
<Link id="l03781" /><CodeLine lineNumber="3781"><span class="doxyHighlight">    VTracker = &amp;vlocs&#91;CurBB&#93;;</span></CodeLine>
<Link id="l03782" /><CodeLine lineNumber="3782"><span class="doxyHighlight">    VTracker-&gt;MBB = <a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>;</span></CodeLine>
<Link id="l03783" /><CodeLine lineNumber="3783"><span class="doxyHighlight">    MTracker-&gt;loadFromArray(MInLocs&#91;&#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>&#93;, CurBB);</span></CodeLine>
<Link id="l03784" /><CodeLine lineNumber="3784"><span class="doxyHighlight">    CurInst = 1;</span></CodeLine>
<Link id="l03785" /><CodeLine lineNumber="3785"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a> : &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>) &#123;</span></CodeLine>
<Link id="l03786" /><CodeLine lineNumber="3786"><span class="doxyHighlight">      process(<a href="/docs/api/files/lib/lib/codegen/lib/codegen/globalisel/irtranslator-cpp/#abe44dfdea65b4f7e11e0a608ab708b76">MI</a>, &amp;MOutLocs, &amp;MInLocs);</span></CodeLine>
<Link id="l03787" /><CodeLine lineNumber="3787"><span class="doxyHighlight">      ++CurInst;</span></CodeLine>
<Link id="l03788" /><CodeLine lineNumber="3788"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03789" /><CodeLine lineNumber="3789"><span class="doxyHighlight">    MTracker-&gt;reset();</span></CodeLine>
<Link id="l03790" /><CodeLine lineNumber="3790"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03791" /><CodeLine lineNumber="3791"></CodeLine>
<Link id="l03792" /><CodeLine lineNumber="3792"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Map from one LexicalScope to all the variables in that scope.</span></CodeLine>
<Link id="l03793" /><CodeLine lineNumber="3793"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#aa55b289a4e7786074f4f3372425763cd">ScopeToVarsT</a> ScopeToVars;</span></CodeLine>
<Link id="l03794" /><CodeLine lineNumber="3794"></CodeLine>
<Link id="l03795" /><CodeLine lineNumber="3795"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Map from One lexical scope to all blocks where assignments happen for</span></CodeLine>
<Link id="l03796" /><CodeLine lineNumber="3796"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that scope.</span></CodeLine>
<Link id="l03797" /><CodeLine lineNumber="3797"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#a68274d2602df99b0792e3474e37b3775">ScopeToAssignBlocksT</a> ScopeToAssignBlocks;</span></CodeLine>
<Link id="l03798" /><CodeLine lineNumber="3798"></CodeLine>
<Link id="l03799" /><CodeLine lineNumber="3799"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Store map of DILocations that describes scopes.</span></CodeLine>
<Link id="l03800" /><CodeLine lineNumber="3800"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv/#a2233b318fa41cb9167e82f952f4b6df6">ScopeToDILocT</a> ScopeToDILocation;</span></CodeLine>
<Link id="l03801" /><CodeLine lineNumber="3801"></CodeLine>
<Link id="l03802" /><CodeLine lineNumber="3802"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// To mirror old LiveDebugValues, enumerate variables in RPOT order. Otherwise</span></CodeLine>
<Link id="l03803" /><CodeLine lineNumber="3803"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the order is unimportant, it just has to be stable.</span></CodeLine>
<Link id="l03804" /><CodeLine lineNumber="3804"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> VarAssignCount = 0;</span></CodeLine>
<Link id="l03805" /><CodeLine lineNumber="3805"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">int</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> = 0; <a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a> &lt; OrderToBB.size(); ++<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>) &#123;</span></CodeLine>
<Link id="l03806" /><CodeLine lineNumber="3806"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a> = OrderToBB&#91;<a href="/docs/api/files/lib/lib/support/md5-cpp/#ac0eafdc9ee161b71e7af98af736952fd">I</a>&#93;;</span></CodeLine>
<Link id="l03807" /><CodeLine lineNumber="3807"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;VTracker = &amp;vlocs&#91;<a href="/docs/api/files/lib/lib/target/lib/target/arm/armslshardening-cpp/#a5958512eae2979bd2eb383977996a600">MBB</a>-&gt;<a href="/docs/api/classes/llvm/machinebasicblock/#a3aa22d521bd6a7e6b9f35545dc7b0f1e">getNumber</a>()&#93;;</span></CodeLine>
<Link id="l03808" /><CodeLine lineNumber="3808"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Collect each variable with a DBG&#95;VALUE in this block.</span></CodeLine>
<Link id="l03809" /><CodeLine lineNumber="3809"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;idx : VTracker-&gt;Vars) &#123;</span></CodeLine>
<Link id="l03810" /><CodeLine lineNumber="3810"><span class="doxyHighlight">      <a href="/docs/api/namespaces/livedebugvalues/#a2ad7532d3e36d429cab7c3ade85c5f77">DebugVariableID</a> <a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a> = idx.first;</span></CodeLine>
<Link id="l03811" /><CodeLine lineNumber="3811"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DILocation &#42;ScopeLoc = VTracker-&gt;Scopes&#91;<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>&#93;;</span></CodeLine>
<Link id="l03812" /><CodeLine lineNumber="3812"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(ScopeLoc != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03813" /><CodeLine lineNumber="3813"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#42;<a href="/docs/api/namespaces/llvm/jitlink/#adb322dc6826cf005531ccfdf666260fd">Scope</a> = LS.findLexicalScope(ScopeLoc);</span></CodeLine>
<Link id="l03814" /><CodeLine lineNumber="3814"></CodeLine>
<Link id="l03815" /><CodeLine lineNumber="3815"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// No insts in scope -&gt; shouldn&#39;t have been recorded.</span></CodeLine>
<Link id="l03816" /><CodeLine lineNumber="3816"><span class="doxyHighlight">      <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/silowercontrolflow-cpp/#a4868c5d81c5ccc98c47aeab6244346a0">assert</a>(Scope != </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03817" /><CodeLine lineNumber="3817"></CodeLine>
<Link id="l03818" /><CodeLine lineNumber="3818"><span class="doxyHighlight">      ScopeToVars&#91;<a href="/docs/api/namespaces/llvm/jitlink/#adb322dc6826cf005531ccfdf666260fd">Scope</a>&#93;.insert(<a href="/docs/api/namespaces/llvm/#a07ea053ea2cdbee8e68ebd607c26dc8a">VarID</a>);</span></CodeLine>
<Link id="l03819" /><CodeLine lineNumber="3819"><span class="doxyHighlight">      ScopeToAssignBlocks&#91;<a href="/docs/api/namespaces/llvm/jitlink/#adb322dc6826cf005531ccfdf666260fd">Scope</a>&#93;.insert(VTracker-&gt;MBB);</span></CodeLine>
<Link id="l03820" /><CodeLine lineNumber="3820"><span class="doxyHighlight">      ScopeToDILocation&#91;<a href="/docs/api/namespaces/llvm/jitlink/#adb322dc6826cf005531ccfdf666260fd">Scope</a>&#93; = ScopeLoc;</span></CodeLine>
<Link id="l03821" /><CodeLine lineNumber="3821"><span class="doxyHighlight">      ++VarAssignCount;</span></CodeLine>
<Link id="l03822" /><CodeLine lineNumber="3822"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l03823" /><CodeLine lineNumber="3823"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03824" /><CodeLine lineNumber="3824"></CodeLine>
<Link id="l03825" /><CodeLine lineNumber="3825"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = </span><span class="doxyHighlightKeyword">false</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03826" /><CodeLine lineNumber="3826"></CodeLine>
<Link id="l03827" /><CodeLine lineNumber="3827"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If we have an extremely large number of variable assignments and blocks,</span></CodeLine>
<Link id="l03828" /><CodeLine lineNumber="3828"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// bail out at this point. We&#39;ve burnt some time doing analysis already,</span></CodeLine>
<Link id="l03829" /><CodeLine lineNumber="3829"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// however we should cut our losses.</span></CodeLine>
<Link id="l03830" /><CodeLine lineNumber="3830"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> ((</span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight">)<a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a> &gt; <a href="/docs/api/files/lib/lib/codegen/lib/codegen/livedebugvalues/livedebugvalues-cpp/#a489e25cdb88a2edf7da9ab3095a23b43">InputBBLimit</a> &amp;&amp;</span></CodeLine>
<Link id="l03831" /><CodeLine lineNumber="3831"><span class="doxyHighlight">      VarAssignCount &gt; InputDbgValLimit) &#123;</span></CodeLine>
<Link id="l03832" /><CodeLine lineNumber="3832"><span class="doxyHighlight">    <a href="/docs/api/files/include/include/llvm/include/llvm/support/debug-h/#a196897517069dda1bdb549e24468f7d7">LLVM&#95;DEBUG</a>(<a href="/docs/api/namespaces/llvm/#a7c46c742c31be54870e2038048e6b391">dbgs</a>() &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;Disabling InstrRefBasedLDV: &quot;</span><span class="doxyHighlight"> &lt;&lt; MF.getName()</span></CodeLine>
<Link id="l03833" /><CodeLine lineNumber="3833"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; has &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a> &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; basic blocks and &quot;</span></CodeLine>
<Link id="l03834" /><CodeLine lineNumber="3834"><span class="doxyHighlight">                      &lt;&lt; VarAssignCount</span></CodeLine>
<Link id="l03835" /><CodeLine lineNumber="3835"><span class="doxyHighlight">                      &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot; variable assignments, exceeding limits.\\n&quot;</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03836" /><CodeLine lineNumber="3836"><span class="doxyHighlight">  &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l03837" /><CodeLine lineNumber="3837"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Optionally, solve the variable value problem and emit to blocks by using</span></CodeLine>
<Link id="l03838" /><CodeLine lineNumber="3838"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// a lexical-scope-depth search. It should be functionally identical to</span></CodeLine>
<Link id="l03839" /><CodeLine lineNumber="3839"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// the &quot;else&quot; block of this condition.</span></CodeLine>
<Link id="l03840" /><CodeLine lineNumber="3840"><span class="doxyHighlight">    <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a> = depthFirstVLocAndEmit(</span></CodeLine>
<Link id="l03841" /><CodeLine lineNumber="3841"><span class="doxyHighlight">        <a href="/docs/api/files/lib/lib/codegen/assignmenttrackinganalysis-cpp/#af0952d00328de72e269c7f157a015e1c">MaxNumBlocks</a>, ScopeToDILocation, ScopeToVars, ScopeToAssignBlocks,</span></CodeLine>
<Link id="l03842" /><CodeLine lineNumber="3842"><span class="doxyHighlight">        SavedLiveIns, MOutLocs, MInLocs, vlocs, MF, &#42;TPC);</span></CodeLine>
<Link id="l03843" /><CodeLine lineNumber="3843"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03844" /><CodeLine lineNumber="3844"></CodeLine>
<Link id="l03845" /><CodeLine lineNumber="3845"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">delete</span><span class="doxyHighlight"> MTracker;</span></CodeLine>
<Link id="l03846" /><CodeLine lineNumber="3846"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">delete</span><span class="doxyHighlight"> TTracker;</span></CodeLine>
<Link id="l03847" /><CodeLine lineNumber="3847"><span class="doxyHighlight">  MTracker = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03848" /><CodeLine lineNumber="3848"><span class="doxyHighlight">  VTracker = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03849" /><CodeLine lineNumber="3849"><span class="doxyHighlight">  TTracker = </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03850" /><CodeLine lineNumber="3850"></CodeLine>
<Link id="l03851" /><CodeLine lineNumber="3851"><span class="doxyHighlight">  ArtificialBlocks.clear();</span></CodeLine>
<Link id="l03852" /><CodeLine lineNumber="3852"><span class="doxyHighlight">  OrderToBB.clear();</span></CodeLine>
<Link id="l03853" /><CodeLine lineNumber="3853"><span class="doxyHighlight">  BBToOrder.clear();</span></CodeLine>
<Link id="l03854" /><CodeLine lineNumber="3854"><span class="doxyHighlight">  BBNumToRPO.clear();</span></CodeLine>
<Link id="l03855" /><CodeLine lineNumber="3855"><span class="doxyHighlight">  DebugInstrNumToInstr.clear();</span></CodeLine>
<Link id="l03856" /><CodeLine lineNumber="3856"><span class="doxyHighlight">  DebugPHINumToValue.clear();</span></CodeLine>
<Link id="l03857" /><CodeLine lineNumber="3857"><span class="doxyHighlight">  OverlapFragments.clear();</span></CodeLine>
<Link id="l03858" /><CodeLine lineNumber="3858"><span class="doxyHighlight">  SeenFragments.clear();</span></CodeLine>
<Link id="l03859" /><CodeLine lineNumber="3859"><span class="doxyHighlight">  SeenDbgPHIs.clear();</span></CodeLine>
<Link id="l03860" /><CodeLine lineNumber="3860"><span class="doxyHighlight">  DbgOpStore.clear();</span></CodeLine>
<Link id="l03861" /><CodeLine lineNumber="3861"><span class="doxyHighlight">  DVMap.clear();</span></CodeLine>
<Link id="l03862" /><CodeLine lineNumber="3862"></CodeLine>
<Link id="l03863" /><CodeLine lineNumber="3863"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/groups/arcopt/#gaa57b1a4e6a1c79233913139635169cf1">Changed</a>;</span></CodeLine>
<Link id="l03864" /><CodeLine lineNumber="3864"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03865" /><CodeLine lineNumber="3865"></CodeLine>
<Link id="l03866" /><CodeLine lineNumber="3866" lineLink="/docs/api/namespaces/llvm/#a3838b33559305fa08382a0be06217008"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/sharedlivedebugvalues/ldvimpl">LDVImpl</a> &#42;<a href="/docs/api/namespaces/llvm/#a3838b33559305fa08382a0be06217008">llvm::makeInstrRefBasedLiveDebugValues</a>() &#123;</span></CodeLine>
<Link id="l03867" /><CodeLine lineNumber="3867"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/instrrefbasedldv">InstrRefBasedLDV</a>();</span></CodeLine>
<Link id="l03868" /><CodeLine lineNumber="3868"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03869" /><CodeLine lineNumber="3869"></CodeLine>
<Link id="l03870" /><CodeLine lineNumber="3870" lineLink="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l03871" /><CodeLine lineNumber="3871"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a>;</span></CodeLine>
<Link id="l03872" /><CodeLine lineNumber="3872"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater">LDVSSAUpdater</a>;</span></CodeLine>
<Link id="l03873" /><CodeLine lineNumber="3873"></CodeLine>
<Link id="l03874" /><CodeLine lineNumber="3874"><span class="doxyHighlightComment">// Pick a type to identify incoming block values as we construct SSA. We</span></CodeLine>
<Link id="l03875" /><CodeLine lineNumber="3875"><span class="doxyHighlightComment">// can&#39;t use anything more robust than an integer unfortunately, as SSAUpdater</span></CodeLine>
<Link id="l03876" /><CodeLine lineNumber="3876"><span class="doxyHighlightComment">// expects to zero-initialize the type.</span></CodeLine>
<Link id="l03877" /><CodeLine lineNumber="3877" lineLink="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-/#a8c63effba4b56132c365c02a07251561"><span class="doxyHighlightKeyword">typedef</span><span class="doxyHighlight"> uint64&#95;t <a href="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-/#a8c63effba4b56132c365c02a07251561">BlockValueNum</a>;</span></CodeLine>
<Link id="l03878" /><CodeLine lineNumber="3878"></CodeLine>
<Link id="l03879" /><CodeLine lineNumber="3879"><span class="doxyHighlightComment">/// Represents an SSA PHI node for the SSA updater class. Contains the block</span></CodeLine>
<Link id="l03880" /><CodeLine lineNumber="3880"><span class="doxyHighlightComment">/// this PHI is in, the value number it would have, and the expected incoming</span></CodeLine>
<Link id="l03881" /><CodeLine lineNumber="3881"><span class="doxyHighlightComment">/// values from parent blocks.</span></CodeLine>
<Link id="l03882" /><CodeLine lineNumber="3882" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#acc62028e5727852a5a0ca16fe155518e">LDVSSAPhi</a> &#123;</span></CodeLine>
<Link id="l03883" /><CodeLine lineNumber="3883"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l03884" /><CodeLine lineNumber="3884" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#ad0465847f732ea1597dd09f78b03eca7"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;std::pair&lt;LDVSSABlock &#42;, BlockValueNum&gt;</a>, 4&gt; <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#ad0465847f732ea1597dd09f78b03eca7">IncomingValues</a>;</span></CodeLine>
<Link id="l03885" /><CodeLine lineNumber="3885" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#af0fa90a8f202bd36e2fe7fee6b03869d"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a> &#42;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#af0fa90a8f202bd36e2fe7fee6b03869d">ParentBlock</a>;</span></CodeLine>
<Link id="l03886" /><CodeLine lineNumber="3886" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#a1b4c4f7702d50f17fb71b1e2dbc07509"><span class="doxyHighlight">  <a href="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-/#a8c63effba4b56132c365c02a07251561">BlockValueNum</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#a1b4c4f7702d50f17fb71b1e2dbc07509">PHIValNum</a>;</span></CodeLine>
<Link id="l03887" /><CodeLine lineNumber="3887" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#acc62028e5727852a5a0ca16fe155518e"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#acc62028e5727852a5a0ca16fe155518e">LDVSSAPhi</a>(<a href="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-/#a8c63effba4b56132c365c02a07251561">BlockValueNum</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#a1b4c4f7702d50f17fb71b1e2dbc07509">PHIValNum</a>, <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a> &#42;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#af0fa90a8f202bd36e2fe7fee6b03869d">ParentBlock</a>)</span></CodeLine>
<Link id="l03888" /><CodeLine lineNumber="3888"><span class="doxyHighlight">      : <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#af0fa90a8f202bd36e2fe7fee6b03869d">ParentBlock</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#af0fa90a8f202bd36e2fe7fee6b03869d">ParentBlock</a>), <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#a1b4c4f7702d50f17fb71b1e2dbc07509">PHIValNum</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#a1b4c4f7702d50f17fb71b1e2dbc07509">PHIValNum</a>) &#123;&#125;</span></CodeLine>
<Link id="l03889" /><CodeLine lineNumber="3889"></CodeLine>
<Link id="l03890" /><CodeLine lineNumber="3890" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#af8abac7f4b7f3156874dae57c3a33cd2"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a> &#42;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#af8abac7f4b7f3156874dae57c3a33cd2">getParent</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi/#af0fa90a8f202bd36e2fe7fee6b03869d">ParentBlock</a>; &#125;</span></CodeLine>
<Link id="l03891" /><CodeLine lineNumber="3891"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l03892" /><CodeLine lineNumber="3892"></CodeLine>
<Link id="l03893" /><CodeLine lineNumber="3893"><span class="doxyHighlightComment">/// Thin wrapper around a block predecessor iterator. Only difference from a</span></CodeLine>
<Link id="l03894" /><CodeLine lineNumber="3894"><span class="doxyHighlightComment">/// normal block iterator is that it dereferences to an LDVSSABlock.</span></CodeLine>
<Link id="l03895" /><CodeLine lineNumber="3895" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a1cb3323fa2b3b2abb6bd3fcf128ee7a2">LDVSSABlockIterator</a> &#123;</span></CodeLine>
<Link id="l03896" /><CodeLine lineNumber="3896"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l03897" /><CodeLine lineNumber="3897" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock/#aa3e6549a5c552971ce60013e2e7c6154">MachineBasicBlock::pred&#95;iterator</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b">PredIt</a>;</span></CodeLine>
<Link id="l03898" /><CodeLine lineNumber="3898" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a2fd5939940a95797c33957bff1f24e1f"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater">LDVSSAUpdater</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a2fd5939940a95797c33957bff1f24e1f">Updater</a>;</span></CodeLine>
<Link id="l03899" /><CodeLine lineNumber="3899"></CodeLine>
<Link id="l03900" /><CodeLine lineNumber="3900" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a1cb3323fa2b3b2abb6bd3fcf128ee7a2"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a1cb3323fa2b3b2abb6bd3fcf128ee7a2">LDVSSABlockIterator</a>(<a href="/docs/api/classes/llvm/machinebasicblock/#aa3e6549a5c552971ce60013e2e7c6154">MachineBasicBlock::pred&#95;iterator</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b">PredIt</a>,</span></CodeLine>
<Link id="l03901" /><CodeLine lineNumber="3901"><span class="doxyHighlight">                      <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater">LDVSSAUpdater</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a2fd5939940a95797c33957bff1f24e1f">Updater</a>)</span></CodeLine>
<Link id="l03902" /><CodeLine lineNumber="3902"><span class="doxyHighlight">      : <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b">PredIt</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b">PredIt</a>), <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a2fd5939940a95797c33957bff1f24e1f">Updater</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a2fd5939940a95797c33957bff1f24e1f">Updater</a>) &#123;&#125;</span></CodeLine>
<Link id="l03903" /><CodeLine lineNumber="3903"></CodeLine>
<Link id="l03904" /><CodeLine lineNumber="3904" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a7842f5deb6d697238863b6cd4ccc8aa5"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a7842f5deb6d697238863b6cd4ccc8aa5">operator!=</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a1cb3323fa2b3b2abb6bd3fcf128ee7a2">LDVSSABlockIterator</a> &amp;OtherIt)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123;</span></CodeLine>
<Link id="l03905" /><CodeLine lineNumber="3905"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> OtherIt.<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b">PredIt</a> != <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b">PredIt</a>;</span></CodeLine>
<Link id="l03906" /><CodeLine lineNumber="3906"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03907" /><CodeLine lineNumber="3907"></CodeLine>
<Link id="l03908" /><CodeLine lineNumber="3908" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a69d4b9194c4510cf2c2d5286061d0bac"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a1cb3323fa2b3b2abb6bd3fcf128ee7a2">LDVSSABlockIterator</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a69d4b9194c4510cf2c2d5286061d0bac">operator++</a>() &#123;</span></CodeLine>
<Link id="l03909" /><CodeLine lineNumber="3909"><span class="doxyHighlight">    ++<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b">PredIt</a>;</span></CodeLine>
<Link id="l03910" /><CodeLine lineNumber="3910"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#42;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l03911" /><CodeLine lineNumber="3911"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03912" /><CodeLine lineNumber="3912"></CodeLine>
<Link id="l03913" /><CodeLine lineNumber="3913"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a> &#42;<a href="/docs/api/namespaces/llvm/#a2366b4a30c90d2207626fb717dfb778d">operator&#42;</a>();</span></CodeLine>
<Link id="l03914" /><CodeLine lineNumber="3914"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l03915" /><CodeLine lineNumber="3915"></CodeLine>
<Link id="l03916" /><CodeLine lineNumber="3916"><span class="doxyHighlightComment">/// Thin wrapper around a block for SSA Updater interface. Necessary because</span></CodeLine>
<Link id="l03917" /><CodeLine lineNumber="3917"><span class="doxyHighlightComment">/// we need to track the PHI value(s) that we may have observed as necessary</span></CodeLine>
<Link id="l03918" /><CodeLine lineNumber="3918"><span class="doxyHighlightComment">/// in this block.</span></CodeLine>
<Link id="l03919" /><CodeLine lineNumber="3919" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a170ab3942820bda10dcbbb825da88fce">LDVSSABlock</a> &#123;</span></CodeLine>
<Link id="l03920" /><CodeLine lineNumber="3920"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l03921" /><CodeLine lineNumber="3921" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a52b402bdc44acc7380d60d09a59b71b0"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a52b402bdc44acc7380d60d09a59b71b0">BB</a>;</span></CodeLine>
<Link id="l03922" /><CodeLine lineNumber="3922" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a7ac29b7dc686f19c84e5efe7b9012c81"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater">LDVSSAUpdater</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a7ac29b7dc686f19c84e5efe7b9012c81">Updater</a>;</span></CodeLine>
<Link id="l03923" /><CodeLine lineNumber="3923" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#abcf4c8e73a87f414924b17cd8e1cd9af"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#abcf4c8e73a87f414924b17cd8e1cd9af">PHIListT</a> = <a href="/docs/api/classes/llvm/smallvector">SmallVector&lt;LDVSSAPhi, 1&gt;</a>;</span></CodeLine>
<Link id="l03924" /><CodeLine lineNumber="3924"><span class="doxyHighlightComment">  /// List of PHIs in this block. There should only ever be one.</span></CodeLine>
<Link id="l03925" /><CodeLine lineNumber="3925" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a3f9aa68ac8f9e8aecab33ec2bd5551be"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#abcf4c8e73a87f414924b17cd8e1cd9af">PHIListT</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a3f9aa68ac8f9e8aecab33ec2bd5551be">PHIList</a>;</span></CodeLine>
<Link id="l03926" /><CodeLine lineNumber="3926"></CodeLine>
<Link id="l03927" /><CodeLine lineNumber="3927" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a170ab3942820bda10dcbbb825da88fce"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a170ab3942820bda10dcbbb825da88fce">LDVSSABlock</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a52b402bdc44acc7380d60d09a59b71b0">BB</a>, <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater">LDVSSAUpdater</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a7ac29b7dc686f19c84e5efe7b9012c81">Updater</a>)</span></CodeLine>
<Link id="l03928" /><CodeLine lineNumber="3928"><span class="doxyHighlight">      : <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a52b402bdc44acc7380d60d09a59b71b0">BB</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a52b402bdc44acc7380d60d09a59b71b0">BB</a>), <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a7ac29b7dc686f19c84e5efe7b9012c81">Updater</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a7ac29b7dc686f19c84e5efe7b9012c81">Updater</a>) &#123;&#125;</span></CodeLine>
<Link id="l03929" /><CodeLine lineNumber="3929"></CodeLine>
<Link id="l03930" /><CodeLine lineNumber="3930" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a285fb198bbe35cc1fa6c27ef4dbc5e42"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator">LDVSSABlockIterator</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a285fb198bbe35cc1fa6c27ef4dbc5e42">succ&#95;begin</a>() &#123;</span></CodeLine>
<Link id="l03931" /><CodeLine lineNumber="3931"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator">LDVSSABlockIterator</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a52b402bdc44acc7380d60d09a59b71b0">BB</a>.succ&#95;begin(), <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a7ac29b7dc686f19c84e5efe7b9012c81">Updater</a>);</span></CodeLine>
<Link id="l03932" /><CodeLine lineNumber="3932"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03933" /><CodeLine lineNumber="3933"></CodeLine>
<Link id="l03934" /><CodeLine lineNumber="3934" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a5e0d53b8490bf09534b1efd1659461e2"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator">LDVSSABlockIterator</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a5e0d53b8490bf09534b1efd1659461e2">succ&#95;end</a>() &#123;</span></CodeLine>
<Link id="l03935" /><CodeLine lineNumber="3935"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator">LDVSSABlockIterator</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a52b402bdc44acc7380d60d09a59b71b0">BB</a>.succ&#95;end(), <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a7ac29b7dc686f19c84e5efe7b9012c81">Updater</a>);</span></CodeLine>
<Link id="l03936" /><CodeLine lineNumber="3936"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03937" /><CodeLine lineNumber="3937"></CodeLine>
<Link id="l03938" /><CodeLine lineNumber="3938"><span class="doxyHighlightComment">  /// SSAUpdater has requested a PHI: create that within this block record.</span></CodeLine>
<Link id="l03939" /><CodeLine lineNumber="3939" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#aa96d9dec40a4511895bdf897fbbb3801"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi">LDVSSAPhi</a> &#42;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#aa96d9dec40a4511895bdf897fbbb3801">newPHI</a>(<a href="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-/#a8c63effba4b56132c365c02a07251561">BlockValueNum</a> <a href="/docs/api/classes/llvm/value">Value</a>) &#123;</span></CodeLine>
<Link id="l03940" /><CodeLine lineNumber="3940"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a3f9aa68ac8f9e8aecab33ec2bd5551be">PHIList</a>.emplace&#95;back(<a href="/docs/api/classes/llvm/value">Value</a>, </span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03941" /><CodeLine lineNumber="3941"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a3f9aa68ac8f9e8aecab33ec2bd5551be">PHIList</a>.back();</span></CodeLine>
<Link id="l03942" /><CodeLine lineNumber="3942"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03943" /><CodeLine lineNumber="3943"></CodeLine>
<Link id="l03944" /><CodeLine lineNumber="3944"><span class="doxyHighlightComment">  /// SSAUpdater wishes to know what PHIs already exist in this block.</span></CodeLine>
<Link id="l03945" /><CodeLine lineNumber="3945" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a280774b93e812679c3a35c1aa6c86b23"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#abcf4c8e73a87f414924b17cd8e1cd9af">PHIListT</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a280774b93e812679c3a35c1aa6c86b23">phis</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a3f9aa68ac8f9e8aecab33ec2bd5551be">PHIList</a>; &#125;</span></CodeLine>
<Link id="l03946" /><CodeLine lineNumber="3946"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l03947" /><CodeLine lineNumber="3947"></CodeLine>
<Link id="l03948" /><CodeLine lineNumber="3948"><span class="doxyHighlightComment">/// Utility class for the SSAUpdater interface: tracks blocks, PHIs and values</span></CodeLine>
<Link id="l03949" /><CodeLine lineNumber="3949"><span class="doxyHighlightComment">/// while SSAUpdater is exploring the CFG. It&#39;s passed as a handle / baton to</span></CodeLine>
<Link id="l03950" /><CodeLine lineNumber="3950"><span class="doxyHighlightComment">// SSAUpdaterTraits&lt;LDVSSAUpdater&gt;.</span></CodeLine>
<Link id="l03951" /><CodeLine lineNumber="3951" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater"><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#aeeef57536617f4a175b045bf015a8bdb">LDVSSAUpdater</a> &#123;</span></CodeLine>
<Link id="l03952" /><CodeLine lineNumber="3952"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l03953" /><CodeLine lineNumber="3953"><span class="doxyHighlightComment">  /// Map of value numbers to PHI records.</span></CodeLine>
<Link id="l03954" /><CodeLine lineNumber="3954" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a4593aef60bd2c6a29b6e3d80d386158a"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;BlockValueNum, LDVSSAPhi &#42;&gt;</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a4593aef60bd2c6a29b6e3d80d386158a">PHIs</a>;</span></CodeLine>
<Link id="l03955" /><CodeLine lineNumber="3955"><span class="doxyHighlightComment">  /// Map of which blocks generate Undef values -- blocks that are not</span></CodeLine>
<Link id="l03956" /><CodeLine lineNumber="3956"><span class="doxyHighlightComment">  /// dominated by any Def.</span></CodeLine>
<Link id="l03957" /><CodeLine lineNumber="3957" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a90ff4d8f56e2494a870c2fb739e5dea1"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;MachineBasicBlock &#42;, BlockValueNum&gt;</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a90ff4d8f56e2494a870c2fb739e5dea1">PoisonMap</a>;</span></CodeLine>
<Link id="l03958" /><CodeLine lineNumber="3958"><span class="doxyHighlightComment">  /// Map of machine blocks to our own records of them.</span></CodeLine>
<Link id="l03959" /><CodeLine lineNumber="3959" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a64a1f9d35131c0434a59bdbce8cfa74b"><span class="doxyHighlight">  <a href="/docs/api/classes/llvm/densemap">DenseMap&lt;MachineBasicBlock &#42;, LDVSSABlock &#42;&gt;</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a64a1f9d35131c0434a59bdbce8cfa74b">BlockMap</a>;</span></CodeLine>
<Link id="l03960" /><CodeLine lineNumber="3960"><span class="doxyHighlightComment">  /// Machine location where any PHI must occur.</span></CodeLine>
<Link id="l03961" /><CodeLine lineNumber="3961" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a5617610cefec0e080cafb643b3f2a19e"><span class="doxyHighlight">  <a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a5617610cefec0e080cafb643b3f2a19e">Loc</a>;</span></CodeLine>
<Link id="l03962" /><CodeLine lineNumber="3962"><span class="doxyHighlightComment">  /// Table of live-in machine value numbers for blocks / locations.</span></CodeLine>
<Link id="l03963" /><CodeLine lineNumber="3963" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a690763e8c1022c6482c95d63a457404b"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a690763e8c1022c6482c95d63a457404b">MLiveIns</a>;</span></CodeLine>
<Link id="l03964" /><CodeLine lineNumber="3964"></CodeLine>
<Link id="l03965" /><CodeLine lineNumber="3965" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#aeeef57536617f4a175b045bf015a8bdb"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#aeeef57536617f4a175b045bf015a8bdb">LDVSSAUpdater</a>(<a href="/docs/api/classes/livedebugvalues/locidx">LocIdx</a> L, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a690763e8c1022c6482c95d63a457404b">MLiveIns</a>)</span></CodeLine>
<Link id="l03966" /><CodeLine lineNumber="3966"><span class="doxyHighlight">      : <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a5617610cefec0e080cafb643b3f2a19e">Loc</a>(L), <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a690763e8c1022c6482c95d63a457404b">MLiveIns</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a690763e8c1022c6482c95d63a457404b">MLiveIns</a>) &#123;&#125;</span></CodeLine>
<Link id="l03967" /><CodeLine lineNumber="3967"></CodeLine>
<Link id="l03968" /><CodeLine lineNumber="3968" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a9d6542e763c848192704ad2a7adb9910"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a9d6542e763c848192704ad2a7adb9910">reset</a>() &#123;</span></CodeLine>
<Link id="l03969" /><CodeLine lineNumber="3969"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> : <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a64a1f9d35131c0434a59bdbce8cfa74b">BlockMap</a>)</span></CodeLine>
<Link id="l03970" /><CodeLine lineNumber="3970"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">delete</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>.second;</span></CodeLine>
<Link id="l03971" /><CodeLine lineNumber="3971"></CodeLine>
<Link id="l03972" /><CodeLine lineNumber="3972"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a4593aef60bd2c6a29b6e3d80d386158a">PHIs</a>.clear();</span></CodeLine>
<Link id="l03973" /><CodeLine lineNumber="3973"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a90ff4d8f56e2494a870c2fb739e5dea1">PoisonMap</a>.clear();</span></CodeLine>
<Link id="l03974" /><CodeLine lineNumber="3974"><span class="doxyHighlight">    <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a64a1f9d35131c0434a59bdbce8cfa74b">BlockMap</a>.clear();</span></CodeLine>
<Link id="l03975" /><CodeLine lineNumber="3975"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03976" /><CodeLine lineNumber="3976"></CodeLine>
<Link id="l03977" /><CodeLine lineNumber="3977" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a8e0fdd8232c2647bb86992a593c42cc6"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a8e0fdd8232c2647bb86992a593c42cc6">~LDVSSAUpdater</a>() &#123; <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a9d6542e763c848192704ad2a7adb9910">reset</a>(); &#125;</span></CodeLine>
<Link id="l03978" /><CodeLine lineNumber="3978"></CodeLine>
<Link id="l03979" /><CodeLine lineNumber="3979"><span class="doxyHighlightComment">  /// For a given MBB, create a wrapper block for it. Stores it in the</span></CodeLine>
<Link id="l03980" /><CodeLine lineNumber="3980"><span class="doxyHighlightComment">  /// LDVSSAUpdater block map.</span></CodeLine>
<Link id="l03981" /><CodeLine lineNumber="3981" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a8594a94db7702a43b08bf55a9bce60fe"><span class="doxyHighlight">  <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a> &#42;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a8594a94db7702a43b08bf55a9bce60fe">getSSALDVBlock</a>(<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;BB) &#123;</span></CodeLine>
<Link id="l03982" /><CodeLine lineNumber="3982"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &#91;It, Inserted&#93; = <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a64a1f9d35131c0434a59bdbce8cfa74b">BlockMap</a>.try&#95;emplace(BB);</span></CodeLine>
<Link id="l03983" /><CodeLine lineNumber="3983"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Inserted)</span></CodeLine>
<Link id="l03984" /><CodeLine lineNumber="3984"><span class="doxyHighlight">      It-&gt;second = </span><span class="doxyHighlightKeyword">new</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a>(&#42;BB, &#42;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l03985" /><CodeLine lineNumber="3985"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> It-&gt;second;</span></CodeLine>
<Link id="l03986" /><CodeLine lineNumber="3986"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03987" /><CodeLine lineNumber="3987"></CodeLine>
<Link id="l03988" /><CodeLine lineNumber="3988"><span class="doxyHighlightComment">  /// Find the live-in value number for the given block. Looks up the value at</span></CodeLine>
<Link id="l03989" /><CodeLine lineNumber="3989"><span class="doxyHighlightComment">  /// the PHI location on entry.</span></CodeLine>
<Link id="l03990" /><CodeLine lineNumber="3990" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#aebd31ac5da9b05da0496de42fdb1f191"><span class="doxyHighlight">  <a href="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-/#a8c63effba4b56132c365c02a07251561">BlockValueNum</a> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#aebd31ac5da9b05da0496de42fdb1f191">getValue</a>(<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a> &#42;LDVBB) &#123;</span></CodeLine>
<Link id="l03991" /><CodeLine lineNumber="3991"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a690763e8c1022c6482c95d63a457404b">MLiveIns</a>&#91;LDVBB-&gt;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock/#a52b402bdc44acc7380d60d09a59b71b0">BB</a>&#93;&#91;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaupdater/#a5617610cefec0e080cafb643b3f2a19e">Loc</a>.asU64()&#93;.asU64();</span></CodeLine>
<Link id="l03992" /><CodeLine lineNumber="3992"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l03993" /><CodeLine lineNumber="3993"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l03994" /><CodeLine lineNumber="3994"></CodeLine>
<Link id="l03995" /><CodeLine lineNumber="3995" lineLink="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a279dffdd489fe0fb2f1559453621b70c"><span class="doxyHighlight"><a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablock">LDVSSABlock</a> &#42;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a279dffdd489fe0fb2f1559453621b70c">LDVSSABlockIterator::operator&#42;</a>() &#123;</span></CodeLine>
<Link id="l03996" /><CodeLine lineNumber="3996"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a2fd5939940a95797c33957bff1f24e1f">Updater</a>.getSSALDVBlock(&#42;<a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssablockiterator/#a31af0a5cb9b734578738655611d5eb9b">PredIt</a>);</span></CodeLine>
<Link id="l03997" /><CodeLine lineNumber="3997"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l03998" /><CodeLine lineNumber="3998"></CodeLine>
<Link id="l03999" /><CodeLine lineNumber="3999"><span class="doxyHighlightPreprocessor">#ifndef NDEBUG</span></CodeLine>
<Link id="l04000" /><CodeLine lineNumber="4000"></CodeLine>
<Link id="l04001" /><CodeLine lineNumber="4001" lineLink="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-/#ae4e827155ec83031396ab9007538d268"><span class="doxyHighlight"><a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;<a href="/docs/api/namespaces/llvm/#ab89f1db02887aa569176f0e29622eb47">operator&lt;&lt;</a>(<a href="/docs/api/classes/llvm/raw-ostream">raw&#95;ostream</a> &amp;out, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/anonymous-namespace-instrrefbasedimpl-cpp-/ldvssaphi">LDVSSAPhi</a> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>) &#123;</span></CodeLine>
<Link id="l04002" /><CodeLine lineNumber="4002"><span class="doxyHighlight">  out &lt;&lt; </span><span class="doxyHighlightStringLiteral">&quot;SSALDVPHI &quot;</span><span class="doxyHighlight"> &lt;&lt; <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>.PHIValNum;</span></CodeLine>
<Link id="l04003" /><CodeLine lineNumber="4003"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> out;</span></CodeLine>
<Link id="l04004" /><CodeLine lineNumber="4004"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04005" /><CodeLine lineNumber="4005"></CodeLine>
<Link id="l04006" /><CodeLine lineNumber="4006"><span class="doxyHighlightPreprocessor">#endif</span></CodeLine>
<Link id="l04007" /><CodeLine lineNumber="4007"></CodeLine>
<Link id="l04008" /><CodeLine lineNumber="4008"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// namespace</span></CodeLine>
<Link id="l04009" /><CodeLine lineNumber="4009"></CodeLine>
<Link id="l04010" /><CodeLine lineNumber="4010"><span class="doxyHighlightKeyword">namespace </span><span class="doxyHighlight">llvm &#123;</span></CodeLine>
<Link id="l04011" /><CodeLine lineNumber="4011"></CodeLine>
<Link id="l04012" /><CodeLine lineNumber="4012"><span class="doxyHighlightComment">/// Template specialization to give SSAUpdater access to CFG and value</span></CodeLine>
<Link id="l04013" /><CodeLine lineNumber="4013"><span class="doxyHighlightComment">/// information. SSAUpdater calls methods in these traits, passing in the</span></CodeLine>
<Link id="l04014" /><CodeLine lineNumber="4014"><span class="doxyHighlightComment">/// LDVSSAUpdater object, to learn about blocks and the values they define.</span></CodeLine>
<Link id="l04015" /><CodeLine lineNumber="4015"><span class="doxyHighlightComment">/// It also provides methods to create PHI nodes and track them.</span></CodeLine>
<Link id="l04016" /><CodeLine lineNumber="4016" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4"><span class="doxyHighlightKeyword">template</span><span class="doxyHighlight"> &lt;&gt; </span><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/ssaupdatertraits">SSAUpdaterTraits</a>&lt;LDVSSAUpdater&gt; &#123;</span></CodeLine>
<Link id="l04017" /><CodeLine lineNumber="4017"><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l04018" /><CodeLine lineNumber="4018" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a7604fac2103840a396b49e95b9ba546e"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a7604fac2103840a396b49e95b9ba546e">BlkT</a> = LDVSSABlock;</span></CodeLine>
<Link id="l04019" /><CodeLine lineNumber="4019" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#aed1981dd0e865bb20cebfa9cbfb6568c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#aed1981dd0e865bb20cebfa9cbfb6568c">ValT</a> = BlockValueNum;</span></CodeLine>
<Link id="l04020" /><CodeLine lineNumber="4020" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a897a36c61777b2428a0bd38d79f70a38"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a897a36c61777b2428a0bd38d79f70a38">PhiT</a> = LDVSSAPhi;</span></CodeLine>
<Link id="l04021" /><CodeLine lineNumber="4021" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a00dee8613a6bcca61ed2158fadf9ef3c"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">using </span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a00dee8613a6bcca61ed2158fadf9ef3c">BlkSucc&#95;iterator</a> = LDVSSABlockIterator;</span></CodeLine>
<Link id="l04022" /><CodeLine lineNumber="4022"></CodeLine>
<Link id="l04023" /><CodeLine lineNumber="4023"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Methods to access block successors -- dereferencing to our wrapper class.</span></CodeLine>
<Link id="l04024" /><CodeLine lineNumber="4024" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#aff0300fb8cbdf8778eeb19d4d5440660"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a00dee8613a6bcca61ed2158fadf9ef3c">BlkSucc&#95;iterator</a> <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#aff0300fb8cbdf8778eeb19d4d5440660">BlkSucc&#95;begin</a>(<a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a7604fac2103840a396b49e95b9ba546e">BlkT</a> &#42;BB) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> BB-&gt;succ&#95;begin(); &#125;</span></CodeLine>
<Link id="l04025" /><CodeLine lineNumber="4025" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a5a9c3fa37350ad4b187055d61b48ff16"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a00dee8613a6bcca61ed2158fadf9ef3c">BlkSucc&#95;iterator</a> <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a5a9c3fa37350ad4b187055d61b48ff16">BlkSucc&#95;end</a>(<a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a7604fac2103840a396b49e95b9ba546e">BlkT</a> &#42;BB) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> BB-&gt;succ&#95;end(); &#125;</span></CodeLine>
<Link id="l04026" /><CodeLine lineNumber="4026"></CodeLine>
<Link id="l04027" /><CodeLine lineNumber="4027"><span class="doxyHighlightComment">  /// Iterator for PHI operands.</span></CodeLine>
<Link id="l04028" /><CodeLine lineNumber="4028" lineLink="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">class </span><span class="doxyHighlight"><a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#ad271e7b369ba8db92f87cffe8cd8fea1">PHI&#95;iterator</a> &#123;</span></CodeLine>
<Link id="l04029" /><CodeLine lineNumber="4029"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">private</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l04030" /><CodeLine lineNumber="4030"><span class="doxyHighlight">    LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>;</span></CodeLine>
<Link id="l04031" /><CodeLine lineNumber="4031"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> Idx;</span></CodeLine>
<Link id="l04032" /><CodeLine lineNumber="4032"></CodeLine>
<Link id="l04033" /><CodeLine lineNumber="4033"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">public</span><span class="doxyHighlight">:</span></CodeLine>
<Link id="l04034" /><CodeLine lineNumber="4034" lineLink="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#ad271e7b369ba8db92f87cffe8cd8fea1"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">explicit</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#ad271e7b369ba8db92f87cffe8cd8fea1">PHI&#95;iterator</a>(LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>) </span><span class="doxyHighlightComment">// begin iterator</span></CodeLine>
<Link id="l04035" /><CodeLine lineNumber="4035"><span class="doxyHighlight">        : <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>), Idx(0) &#123;&#125;</span></CodeLine>
<Link id="l04036" /><CodeLine lineNumber="4036" lineLink="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#a634b9aa909970c15fecc431125905432"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#a634b9aa909970c15fecc431125905432">PHI&#95;iterator</a>(LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>, </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight">) </span><span class="doxyHighlightComment">// end iterator</span></CodeLine>
<Link id="l04037" /><CodeLine lineNumber="4037"><span class="doxyHighlight">        : <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>(<a href="/docs/api/files/lib/lib/option/option-cpp/#a04665169063c8ca1f2ea96c27fc7c2b2">P</a>), Idx(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;IncomingValues.<a href="/docs/api/namespaces/llvm/#a10f3d955592ae2bc745f57e5b48ae115">size</a>()) &#123;&#125;</span></CodeLine>
<Link id="l04038" /><CodeLine lineNumber="4038"></CodeLine>
<Link id="l04039" /><CodeLine lineNumber="4039" lineLink="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#af29144e7383a8e3e4890d9bf04c9b64a"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#ad271e7b369ba8db92f87cffe8cd8fea1">PHI&#95;iterator</a> &amp;<a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#af29144e7383a8e3e4890d9bf04c9b64a">operator++</a>() &#123;</span></CodeLine>
<Link id="l04040" /><CodeLine lineNumber="4040"><span class="doxyHighlight">      Idx++;</span></CodeLine>
<Link id="l04041" /><CodeLine lineNumber="4041"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#42;</span><span class="doxyHighlightKeyword">this</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04042" /><CodeLine lineNumber="4042"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04043" /><CodeLine lineNumber="4043" lineLink="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#afee958da1eec7b6b56701847fefde452"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#afee958da1eec7b6b56701847fefde452">operator==</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#ad271e7b369ba8db92f87cffe8cd8fea1">PHI&#95;iterator</a> &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Idx == <a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>.Idx; &#125;</span></CodeLine>
<Link id="l04044" /><CodeLine lineNumber="4044" lineLink="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#acbbbcc887540e8d1c4a7f03ef18d0233"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordType">bool</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#acbbbcc887540e8d1c4a7f03ef18d0233">operator!=</a>(</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#ad271e7b369ba8db92f87cffe8cd8fea1">PHI&#95;iterator</a> &amp;<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>)</span><span class="doxyHighlightKeyword"> const </span><span class="doxyHighlight">&#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> !<a href="/docs/api/namespaces/llvm/#a4d812a2dd18aa186c164447e20e348e7">operator==</a>(<a href="/docs/api/files/lib/lib/tablegen/tablegenbackendskeleton-cpp/#ab60f28d7a141ac46ccc200176a1bca8b">X</a>); &#125;</span></CodeLine>
<Link id="l04045" /><CodeLine lineNumber="4045"></CodeLine>
<Link id="l04046" /><CodeLine lineNumber="4046" lineLink="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#a3984406f0b556b64055a90c1a3615b6f"><span class="doxyHighlight">    BlockValueNum <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#a3984406f0b556b64055a90c1a3615b6f">getIncomingValue</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;IncomingValues&#91;Idx&#93;.second; &#125;</span></CodeLine>
<Link id="l04047" /><CodeLine lineNumber="4047"></CodeLine>
<Link id="l04048" /><CodeLine lineNumber="4048" lineLink="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#a7074ef580f3e744bb47bb99595ddd4df"><span class="doxyHighlight">    LDVSSABlock &#42;<a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16/#a7074ef580f3e744bb47bb99595ddd4df">getIncomingBlock</a>() &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;IncomingValues&#91;Idx&#93;.first; &#125;</span></CodeLine>
<Link id="l04049" /><CodeLine lineNumber="4049"><span class="doxyHighlight">  &#125;;</span></CodeLine>
<Link id="l04050" /><CodeLine lineNumber="4050"></CodeLine>
<Link id="l04051" /><CodeLine lineNumber="4051" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a77330dfa97bc91b53a5e9e1d6f75cab1"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">inline</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16">PHI&#95;iterator</a> <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a77330dfa97bc91b53a5e9e1d6f75cab1">PHI&#95;begin</a>(<a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a897a36c61777b2428a0bd38d79f70a38">PhiT</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16">PHI&#95;iterator</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>); &#125;</span></CodeLine>
<Link id="l04052" /><CodeLine lineNumber="4052"></CodeLine>
<Link id="l04053" /><CodeLine lineNumber="4053" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#af172763cc276913cd13e89b5b2bcbc69"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">inline</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16">PHI&#95;iterator</a> <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#af172763cc276913cd13e89b5b2bcbc69">PHI&#95;end</a>(<a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a897a36c61777b2428a0bd38d79f70a38">PhiT</a> &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>) &#123;</span></CodeLine>
<Link id="l04054" /><CodeLine lineNumber="4054"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits/phi-iterator-6378c5910886d7a8595c30cf77f6df16">PHI&#95;iterator</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, </span><span class="doxyHighlightKeyword">true</span><span class="doxyHighlight">);</span></CodeLine>
<Link id="l04055" /><CodeLine lineNumber="4055"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04056" /><CodeLine lineNumber="4056"></CodeLine>
<Link id="l04057" /><CodeLine lineNumber="4057"><span class="doxyHighlightComment">  /// FindPredecessorBlocks - Put the predecessors of BB into the Preds</span></CodeLine>
<Link id="l04058" /><CodeLine lineNumber="4058"><span class="doxyHighlightComment">  /// vector.</span></CodeLine>
<Link id="l04059" /><CodeLine lineNumber="4059" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#ac031b6154536f289d3c8962a2d9efd48"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#ac031b6154536f289d3c8962a2d9efd48">FindPredecessorBlocks</a>(LDVSSABlock &#42;BB,</span></CodeLine>
<Link id="l04060" /><CodeLine lineNumber="4060"><span class="doxyHighlight">                                    <a href="/docs/api/classes/llvm/smallvectorimpl">SmallVectorImpl&lt;LDVSSABlock &#42;&gt;</a> &#42;Preds) &#123;</span></CodeLine>
<Link id="l04061" /><CodeLine lineNumber="4061"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (<a href="/docs/api/classes/llvm/machinebasicblock">MachineBasicBlock</a> &#42;Pred : BB-&gt;BB.predecessors())</span></CodeLine>
<Link id="l04062" /><CodeLine lineNumber="4062"><span class="doxyHighlight">      Preds-&gt;<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(BB-&gt;Updater.getSSALDVBlock(Pred));</span></CodeLine>
<Link id="l04063" /><CodeLine lineNumber="4063"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04064" /><CodeLine lineNumber="4064"></CodeLine>
<Link id="l04065" /><CodeLine lineNumber="4065"><span class="doxyHighlightComment">  /// GetPoisonVal - Normally creates an IMPLICIT&#95;DEF instruction with a new</span></CodeLine>
<Link id="l04066" /><CodeLine lineNumber="4066"><span class="doxyHighlightComment">  /// register. For LiveDebugValues, represents a block identified as not having</span></CodeLine>
<Link id="l04067" /><CodeLine lineNumber="4067"><span class="doxyHighlightComment">  /// any DBG&#95;PHI predecessors.</span></CodeLine>
<Link id="l04068" /><CodeLine lineNumber="4068" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a33333fff376eea6f32493439a84c72d0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> BlockValueNum <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a33333fff376eea6f32493439a84c72d0">GetPoisonVal</a>(LDVSSABlock &#42;BB, LDVSSAUpdater &#42;Updater) &#123;</span></CodeLine>
<Link id="l04069" /><CodeLine lineNumber="4069"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Create a value number for this block -- it needs to be unique and in the</span></CodeLine>
<Link id="l04070" /><CodeLine lineNumber="4070"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// &quot;poison&quot; collection, so that we know it&#39;s not real. Use a number</span></CodeLine>
<Link id="l04071" /><CodeLine lineNumber="4071"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// representing a PHI into this block.</span></CodeLine>
<Link id="l04072" /><CodeLine lineNumber="4072"><span class="doxyHighlight">    BlockValueNum Num = <a href="/docs/api/classes/livedebugvalues/valueidnum">ValueIDNum</a>(BB-&gt;BB.getNumber(), 0, Updater-&gt;Loc).<a href="/docs/api/classes/livedebugvalues/valueidnum/#ab797179b6d9bdda6c2f182fbb8011704">asU64</a>();</span></CodeLine>
<Link id="l04073" /><CodeLine lineNumber="4073"><span class="doxyHighlight">    Updater-&gt;PoisonMap&#91;&amp;BB-&gt;BB&#93; = Num;</span></CodeLine>
<Link id="l04074" /><CodeLine lineNumber="4074"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Num;</span></CodeLine>
<Link id="l04075" /><CodeLine lineNumber="4075"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04076" /><CodeLine lineNumber="4076"></CodeLine>
<Link id="l04077" /><CodeLine lineNumber="4077"><span class="doxyHighlightComment">  /// CreateEmptyPHI - Create a (representation of a) PHI in the given block.</span></CodeLine>
<Link id="l04078" /><CodeLine lineNumber="4078"><span class="doxyHighlightComment">  /// SSAUpdater will populate it with information about incoming values. The</span></CodeLine>
<Link id="l04079" /><CodeLine lineNumber="4079"><span class="doxyHighlightComment">  /// value number of this PHI is whatever the  machine value number problem</span></CodeLine>
<Link id="l04080" /><CodeLine lineNumber="4080"><span class="doxyHighlightComment">  /// solution determined it to be. This includes non-phi values if SSAUpdater</span></CodeLine>
<Link id="l04081" /><CodeLine lineNumber="4081"><span class="doxyHighlightComment">  /// tries to create a PHI where the incoming values are identical.</span></CodeLine>
<Link id="l04082" /><CodeLine lineNumber="4082" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a1ba7a4f9025c38ba1d2d612e49551dcb"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> BlockValueNum <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a1ba7a4f9025c38ba1d2d612e49551dcb">CreateEmptyPHI</a>(LDVSSABlock &#42;BB, </span><span class="doxyHighlightKeywordType">unsigned</span><span class="doxyHighlight"> NumPreds,</span></CodeLine>
<Link id="l04083" /><CodeLine lineNumber="4083"><span class="doxyHighlight">                                   LDVSSAUpdater &#42;Updater) &#123;</span></CodeLine>
<Link id="l04084" /><CodeLine lineNumber="4084"><span class="doxyHighlight">    BlockValueNum PHIValNum = Updater-&gt;getValue(BB);</span></CodeLine>
<Link id="l04085" /><CodeLine lineNumber="4085"><span class="doxyHighlight">    LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = BB-&gt;newPHI(PHIValNum);</span></CodeLine>
<Link id="l04086" /><CodeLine lineNumber="4086"><span class="doxyHighlight">    Updater-&gt;PHIs&#91;PHIValNum&#93; = <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>;</span></CodeLine>
<Link id="l04087" /><CodeLine lineNumber="4087"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> PHIValNum;</span></CodeLine>
<Link id="l04088" /><CodeLine lineNumber="4088"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04089" /><CodeLine lineNumber="4089"></CodeLine>
<Link id="l04090" /><CodeLine lineNumber="4090"><span class="doxyHighlightComment">  /// AddPHIOperand - Add the specified value as an operand of the PHI for</span></CodeLine>
<Link id="l04091" /><CodeLine lineNumber="4091"><span class="doxyHighlightComment">  /// the specified predecessor block.</span></CodeLine>
<Link id="l04092" /><CodeLine lineNumber="4092" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a84a697406586a81c7ece9b9818929ab6"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeywordType">void</span><span class="doxyHighlight"> <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#a84a697406586a81c7ece9b9818929ab6">AddPHIOperand</a>(LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>, BlockValueNum Val, LDVSSABlock &#42;Pred) &#123;</span></CodeLine>
<Link id="l04093" /><CodeLine lineNumber="4093"><span class="doxyHighlight">    <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;IncomingValues.push&#95;back(std::make&#95;pair(Pred, Val));</span></CodeLine>
<Link id="l04094" /><CodeLine lineNumber="4094"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04095" /><CodeLine lineNumber="4095"></CodeLine>
<Link id="l04096" /><CodeLine lineNumber="4096"><span class="doxyHighlightComment">  /// ValueIsPHI - Check if the instruction that defines the specified value</span></CodeLine>
<Link id="l04097" /><CodeLine lineNumber="4097"><span class="doxyHighlightComment">  /// is a PHI instruction.</span></CodeLine>
<Link id="l04098" /><CodeLine lineNumber="4098" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#afeb156ea118a9cafd6b686d2cd469ae6"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> LDVSSAPhi &#42;<a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#afeb156ea118a9cafd6b686d2cd469ae6">ValueIsPHI</a>(BlockValueNum Val, LDVSSAUpdater &#42;Updater) &#123;</span></CodeLine>
<Link id="l04099" /><CodeLine lineNumber="4099"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> Updater-&gt;PHIs.lookup(Val);</span></CodeLine>
<Link id="l04100" /><CodeLine lineNumber="4100"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04101" /><CodeLine lineNumber="4101"></CodeLine>
<Link id="l04102" /><CodeLine lineNumber="4102"><span class="doxyHighlightComment">  /// ValueIsNewPHI - Like ValueIsPHI but also check if the PHI has no source</span></CodeLine>
<Link id="l04103" /><CodeLine lineNumber="4103"><span class="doxyHighlightComment">  /// operands, i.e., it was just added.</span></CodeLine>
<Link id="l04104" /><CodeLine lineNumber="4104" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#ac74aed32bcd3712e2746bbf208229c2e"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> LDVSSAPhi &#42;<a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#ac74aed32bcd3712e2746bbf208229c2e">ValueIsNewPHI</a>(BlockValueNum Val, LDVSSAUpdater &#42;Updater) &#123;</span></CodeLine>
<Link id="l04105" /><CodeLine lineNumber="4105"><span class="doxyHighlight">    LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> = <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#afeb156ea118a9cafd6b686d2cd469ae6">ValueIsPHI</a>(Val, Updater);</span></CodeLine>
<Link id="l04106" /><CodeLine lineNumber="4106"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> &amp;&amp; <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;IncomingValues.size() == 0)</span></CodeLine>
<Link id="l04107" /><CodeLine lineNumber="4107"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>;</span></CodeLine>
<Link id="l04108" /><CodeLine lineNumber="4108"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">nullptr</span><span class="doxyHighlight">;</span></CodeLine>
<Link id="l04109" /><CodeLine lineNumber="4109"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04110" /><CodeLine lineNumber="4110"></CodeLine>
<Link id="l04111" /><CodeLine lineNumber="4111"><span class="doxyHighlightComment">  /// GetPHIValue - For the specified PHI instruction, return the value</span></CodeLine>
<Link id="l04112" /><CodeLine lineNumber="4112"><span class="doxyHighlightComment">  /// that it defines.</span></CodeLine>
<Link id="l04113" /><CodeLine lineNumber="4113" lineLink="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#ac588486afd7ad9e56feeeaf30a2db1c0"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">static</span><span class="doxyHighlight"> BlockValueNum <a href="/docs/api/classes/llvm/ssaupdatertraits-36e5fa5b110a1852d0627da33930e4d4/#ac588486afd7ad9e56feeeaf30a2db1c0">GetPHIValue</a>(LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>) &#123; </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;PHIValNum; &#125;</span></CodeLine>
<Link id="l04114" /><CodeLine lineNumber="4114"><span class="doxyHighlight">&#125;;</span></CodeLine>
<Link id="l04115" /><CodeLine lineNumber="4115"></CodeLine>
<Link id="l04116" /><CodeLine lineNumber="4116"><span class="doxyHighlight">&#125; </span><span class="doxyHighlightComment">// end namespace llvm</span></CodeLine>
<Link id="l04117" /><CodeLine lineNumber="4117"></CodeLine>
<Link id="l04118" /><CodeLine lineNumber="4118"><span class="doxyHighlight">std::optional&lt;ValueIDNum&gt; InstrRefBasedLDV::resolveDbgPHIs(</span></CodeLine>
<Link id="l04119" /><CodeLine lineNumber="4119"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MLiveOuts,</span></CodeLine>
<Link id="l04120" /><CodeLine lineNumber="4120"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MLiveIns, <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;Here, uint64&#95;t InstrNum) &#123;</span></CodeLine>
<Link id="l04121" /><CodeLine lineNumber="4121"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// This function will be called twice per DBG&#95;INSTR&#95;REF, and might end up</span></CodeLine>
<Link id="l04122" /><CodeLine lineNumber="4122"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// computing lots of SSA information: memoize it.</span></CodeLine>
<Link id="l04123" /><CodeLine lineNumber="4123"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> SeenDbgPHIIt = SeenDbgPHIs.find(std::make&#95;pair(&amp;Here, InstrNum));</span></CodeLine>
<Link id="l04124" /><CodeLine lineNumber="4124"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (SeenDbgPHIIt != SeenDbgPHIs.end())</span></CodeLine>
<Link id="l04125" /><CodeLine lineNumber="4125"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> SeenDbgPHIIt-&gt;second;</span></CodeLine>
<Link id="l04126" /><CodeLine lineNumber="4126"></CodeLine>
<Link id="l04127" /><CodeLine lineNumber="4127"><span class="doxyHighlight">  std::optional&lt;ValueIDNum&gt; <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> =</span></CodeLine>
<Link id="l04128" /><CodeLine lineNumber="4128"><span class="doxyHighlight">      resolveDbgPHIsImpl(MF, MLiveOuts, MLiveIns, Here, InstrNum);</span></CodeLine>
<Link id="l04129" /><CodeLine lineNumber="4129"><span class="doxyHighlight">  SeenDbgPHIs.insert(&#123;std::make&#95;pair(&amp;Here, InstrNum), <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>&#125;);</span></CodeLine>
<Link id="l04130" /><CodeLine lineNumber="4130"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</span></CodeLine>
<Link id="l04131" /><CodeLine lineNumber="4131"><span class="doxyHighlight">&#125;</span></CodeLine>
<Link id="l04132" /><CodeLine lineNumber="4132"></CodeLine>
<Link id="l04133" /><CodeLine lineNumber="4133"><span class="doxyHighlight">std::optional&lt;ValueIDNum&gt; InstrRefBasedLDV::resolveDbgPHIsImpl(</span></CodeLine>
<Link id="l04134" /><CodeLine lineNumber="4134"><span class="doxyHighlight">    <a href="/docs/api/classes/llvm/machinefunction">MachineFunction</a> &amp;MF, </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MLiveOuts,</span></CodeLine>
<Link id="l04135" /><CodeLine lineNumber="4135"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/structs/livedebugvalues/funcvaluetable">FuncValueTable</a> &amp;MLiveIns, <a href="/docs/api/classes/llvm/machineinstr">MachineInstr</a> &amp;Here, uint64&#95;t InstrNum) &#123;</span></CodeLine>
<Link id="l04136" /><CodeLine lineNumber="4136"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Pick out records of DBG&#95;PHI instructions that have been observed. If there</span></CodeLine>
<Link id="l04137" /><CodeLine lineNumber="4137"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// are none, then we cannot compute a value number.</span></CodeLine>
<Link id="l04138" /><CodeLine lineNumber="4138"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> RangePair = std::equal&#95;range(DebugPHINumToValue.begin(),</span></CodeLine>
<Link id="l04139" /><CodeLine lineNumber="4139"><span class="doxyHighlight">                                    DebugPHINumToValue.end(), InstrNum);</span></CodeLine>
<Link id="l04140" /><CodeLine lineNumber="4140"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> LowerIt = RangePair.first;</span></CodeLine>
<Link id="l04141" /><CodeLine lineNumber="4141"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> UpperIt = RangePair.second;</span></CodeLine>
<Link id="l04142" /><CodeLine lineNumber="4142"></CodeLine>
<Link id="l04143" /><CodeLine lineNumber="4143"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// No DBG&#95;PHI means there can be no location.</span></CodeLine>
<Link id="l04144" /><CodeLine lineNumber="4144"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (LowerIt == UpperIt)</span></CodeLine>
<Link id="l04145" /><CodeLine lineNumber="4145"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l04146" /><CodeLine lineNumber="4146"></CodeLine>
<Link id="l04147" /><CodeLine lineNumber="4147"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If any DBG&#95;PHIs referred to a location we didn&#39;t understand, don&#39;t try to</span></CodeLine>
<Link id="l04148" /><CodeLine lineNumber="4148"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// compute a value. There might be scenarios where we could recover a value</span></CodeLine>
<Link id="l04149" /><CodeLine lineNumber="4149"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// for some range of DBG&#95;INSTR&#95;REFs, but at this point we can have high</span></CodeLine>
<Link id="l04150" /><CodeLine lineNumber="4150"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// confidence that we&#39;ve seen a bug.</span></CodeLine>
<Link id="l04151" /><CodeLine lineNumber="4151"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> DBGPHIRange = <a href="/docs/api/namespaces/llvm/#a341215803e83773a3e97860dc291f121">make&#95;range</a>(LowerIt, UpperIt);</span></CodeLine>
<Link id="l04152" /><CodeLine lineNumber="4152"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> DebugPHIRecord &amp;DBG&#95;PHI : DBGPHIRange)</span></CodeLine>
<Link id="l04153" /><CodeLine lineNumber="4153"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (!DBG&#95;PHI.ValueRead)</span></CodeLine>
<Link id="l04154" /><CodeLine lineNumber="4154"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l04155" /><CodeLine lineNumber="4155"></CodeLine>
<Link id="l04156" /><CodeLine lineNumber="4156"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// If there&#39;s only one DBG&#95;PHI, then that is our value number.</span></CodeLine>
<Link id="l04157" /><CodeLine lineNumber="4157"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (std::distance(LowerIt, UpperIt) == 1)</span></CodeLine>
<Link id="l04158" /><CodeLine lineNumber="4158"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> &#42;LowerIt-&gt;ValueRead;</span></CodeLine>
<Link id="l04159" /><CodeLine lineNumber="4159"></CodeLine>
<Link id="l04160" /><CodeLine lineNumber="4160"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Pick out the location (physreg, slot) where any PHIs must occur. It&#39;s</span></CodeLine>
<Link id="l04161" /><CodeLine lineNumber="4161"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// technically possible for us to merge values in different registers in each</span></CodeLine>
<Link id="l04162" /><CodeLine lineNumber="4162"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// block, but highly unlikely that LLVM will generate such code after register</span></CodeLine>
<Link id="l04163" /><CodeLine lineNumber="4163"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// allocation.</span></CodeLine>
<Link id="l04164" /><CodeLine lineNumber="4164"><span class="doxyHighlight">  LocIdx Loc = &#42;LowerIt-&gt;ReadLoc;</span></CodeLine>
<Link id="l04165" /><CodeLine lineNumber="4165"></CodeLine>
<Link id="l04166" /><CodeLine lineNumber="4166"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We have several DBG&#95;PHIs, and a use position (the Here inst). All each</span></CodeLine>
<Link id="l04167" /><CodeLine lineNumber="4167"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// DBG&#95;PHI does is identify a value at a program position. We can treat each</span></CodeLine>
<Link id="l04168" /><CodeLine lineNumber="4168"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// DBG&#95;PHI like it&#39;s a Def of a value, and the use position is a Use of a</span></CodeLine>
<Link id="l04169" /><CodeLine lineNumber="4169"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// value, just like SSA. We use the bulk-standard LLVM SSA updater class to</span></CodeLine>
<Link id="l04170" /><CodeLine lineNumber="4170"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// determine which Def is used at the Use, and any PHIs that happen along</span></CodeLine>
<Link id="l04171" /><CodeLine lineNumber="4171"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// the way.</span></CodeLine>
<Link id="l04172" /><CodeLine lineNumber="4172"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Adapted LLVM SSA Updater:</span></CodeLine>
<Link id="l04173" /><CodeLine lineNumber="4173"><span class="doxyHighlight">  LDVSSAUpdater Updater(Loc, MLiveIns);</span></CodeLine>
<Link id="l04174" /><CodeLine lineNumber="4174"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Map of which Def or PHI is the current value in each block.</span></CodeLine>
<Link id="l04175" /><CodeLine lineNumber="4175"><span class="doxyHighlight">  DenseMap&lt;LDVSSABlock &#42;, BlockValueNum&gt; AvailableValues;</span></CodeLine>
<Link id="l04176" /><CodeLine lineNumber="4176"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Set of PHIs that we have created along the way.</span></CodeLine>
<Link id="l04177" /><CodeLine lineNumber="4177"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;LDVSSAPhi &#42;, 8&gt;</a> CreatedPHIs;</span></CodeLine>
<Link id="l04178" /><CodeLine lineNumber="4178"></CodeLine>
<Link id="l04179" /><CodeLine lineNumber="4179"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Each existing DBG&#95;PHI is a Def&#39;d value under this model. Record these Defs</span></CodeLine>
<Link id="l04180" /><CodeLine lineNumber="4180"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// for the SSAUpdater.</span></CodeLine>
<Link id="l04181" /><CodeLine lineNumber="4181"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;DBG&#95;PHI : DBGPHIRange) &#123;</span></CodeLine>
<Link id="l04182" /><CodeLine lineNumber="4182"><span class="doxyHighlight">    LDVSSABlock &#42;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> = Updater.getSSALDVBlock(DBG&#95;PHI.MBB);</span></CodeLine>
<Link id="l04183" /><CodeLine lineNumber="4183"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> ValueIDNum &amp;Num = &#42;DBG&#95;PHI.ValueRead;</span></CodeLine>
<Link id="l04184" /><CodeLine lineNumber="4184"><span class="doxyHighlight">    AvailableValues.<a href="/docs/api/classes/llvm/densemapbase/#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>, Num.<a href="/docs/api/classes/livedebugvalues/valueidnum/#ab797179b6d9bdda6c2f182fbb8011704">asU64</a>()));</span></CodeLine>
<Link id="l04185" /><CodeLine lineNumber="4185"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04186" /><CodeLine lineNumber="4186"></CodeLine>
<Link id="l04187" /><CodeLine lineNumber="4187"><span class="doxyHighlight">  LDVSSABlock &#42;HereBlock = Updater.getSSALDVBlock(Here.<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>());</span></CodeLine>
<Link id="l04188" /><CodeLine lineNumber="4188"><span class="doxyHighlight">  </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;AvailIt = AvailableValues.<a href="/docs/api/classes/llvm/densemapbase/#a0c047f127ed4380a6f383d70bec4eb94">find</a>(HereBlock);</span></CodeLine>
<Link id="l04189" /><CodeLine lineNumber="4189"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (AvailIt != AvailableValues.<a href="/docs/api/classes/llvm/densemapbase/#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) &#123;</span></CodeLine>
<Link id="l04190" /><CodeLine lineNumber="4190"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Actually, we already know what the value is -- the Use is in the same</span></CodeLine>
<Link id="l04191" /><CodeLine lineNumber="4191"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// block as the Def.</span></CodeLine>
<Link id="l04192" /><CodeLine lineNumber="4192"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/classes/livedebugvalues/valueidnum/#a7b9139c86fb99f4651b4830fe1f93742">ValueIDNum::fromU64</a>(AvailIt-&gt;second);</span></CodeLine>
<Link id="l04193" /><CodeLine lineNumber="4193"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04194" /><CodeLine lineNumber="4194"></CodeLine>
<Link id="l04195" /><CodeLine lineNumber="4195"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Otherwise, we must use the SSA Updater. It will identify the value number</span></CodeLine>
<Link id="l04196" /><CodeLine lineNumber="4196"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// that we are to use, and the PHIs that must happen along the way.</span></CodeLine>
<Link id="l04197" /><CodeLine lineNumber="4197"><span class="doxyHighlight">  SSAUpdaterImpl&lt;LDVSSAUpdater&gt; Impl(&amp;Updater, &amp;AvailableValues, &amp;CreatedPHIs);</span></CodeLine>
<Link id="l04198" /><CodeLine lineNumber="4198"><span class="doxyHighlight">  <a href="/docs/api/namespaces/anonymous-instrrefbasedimpl-cpp-/#a8c63effba4b56132c365c02a07251561">BlockValueNum</a> ResultInt = Impl.GetValue(Updater.getSSALDVBlock(Here.<a href="/docs/api/classes/llvm/machineinstr/#a1e855100f407ca4be098d0050be403b0">getParent</a>()));</span></CodeLine>
<Link id="l04199" /><CodeLine lineNumber="4199"><span class="doxyHighlight">  ValueIDNum <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a> = <a href="/docs/api/classes/livedebugvalues/valueidnum/#a7b9139c86fb99f4651b4830fe1f93742">ValueIDNum::fromU64</a>(ResultInt);</span></CodeLine>
<Link id="l04200" /><CodeLine lineNumber="4200"></CodeLine>
<Link id="l04201" /><CodeLine lineNumber="4201"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// We have the number for a PHI, or possibly live-through value, to be used</span></CodeLine>
<Link id="l04202" /><CodeLine lineNumber="4202"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// at this Use. There are a number of things we have to check about it though:</span></CodeLine>
<Link id="l04203" /><CodeLine lineNumber="4203"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; Does any PHI use an &#39;Undef&#39; (like an IMPLICIT&#95;DEF) value? If so, this</span></CodeLine>
<Link id="l04204" /><CodeLine lineNumber="4204"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    Use was not completely dominated by DBG&#95;PHIs and we should abort.</span></CodeLine>
<Link id="l04205" /><CodeLine lineNumber="4205"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; Are the Defs or PHIs clobbered in a block? SSAUpdater isn&#39;t aware that</span></CodeLine>
<Link id="l04206" /><CodeLine lineNumber="4206"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    we&#39;ve left SSA form. Validate that the inputs to each PHI are the</span></CodeLine>
<Link id="l04207" /><CodeLine lineNumber="4207"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    expected values.</span></CodeLine>
<Link id="l04208" /><CodeLine lineNumber="4208"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//  &#42; Is a PHI we&#39;ve created actually a merging of values, or are all the</span></CodeLine>
<Link id="l04209" /><CodeLine lineNumber="4209"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    predecessor values the same, leading to a non-PHI machine value number?</span></CodeLine>
<Link id="l04210" /><CodeLine lineNumber="4210"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    (SSAUpdater doesn&#39;t know that either). Remap validated PHIs into the</span></CodeLine>
<Link id="l04211" /><CodeLine lineNumber="4211"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">//    the ValidatedValues collection below to sort this out.</span></CodeLine>
<Link id="l04212" /><CodeLine lineNumber="4212"><span class="doxyHighlight">  DenseMap&lt;LDVSSABlock &#42;, ValueIDNum&gt; ValidatedValues;</span></CodeLine>
<Link id="l04213" /><CodeLine lineNumber="4213"></CodeLine>
<Link id="l04214" /><CodeLine lineNumber="4214"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Define all the input DBG&#95;PHI values in ValidatedValues.</span></CodeLine>
<Link id="l04215" /><CodeLine lineNumber="4215"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;DBG&#95;PHI : DBGPHIRange) &#123;</span></CodeLine>
<Link id="l04216" /><CodeLine lineNumber="4216"><span class="doxyHighlight">    LDVSSABlock &#42;<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a> = Updater.getSSALDVBlock(DBG&#95;PHI.MBB);</span></CodeLine>
<Link id="l04217" /><CodeLine lineNumber="4217"><span class="doxyHighlight">    </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> ValueIDNum &amp;Num = &#42;DBG&#95;PHI.ValueRead;</span></CodeLine>
<Link id="l04218" /><CodeLine lineNumber="4218"><span class="doxyHighlight">    ValidatedValues.<a href="/docs/api/classes/llvm/densemapbase/#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(std::make&#95;pair(<a href="/docs/api/namespaces/llvm/#a0e00fad9c34de40b1e31f3aa6f8e024cae1e4c8c9ccd9fc39c391da4bcd093fb2">Block</a>, Num));</span></CodeLine>
<Link id="l04219" /><CodeLine lineNumber="4219"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04220" /><CodeLine lineNumber="4220"></CodeLine>
<Link id="l04221" /><CodeLine lineNumber="4221"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// Sort PHIs to validate into RPO-order.</span></CodeLine>
<Link id="l04222" /><CodeLine lineNumber="4222"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a8fc529c79977cdd01e187986f960a07f">SmallVector&lt;LDVSSAPhi &#42;, 8&gt;</a> SortedPHIs;</span></CodeLine>
<Link id="l04223" /><CodeLine lineNumber="4223"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : CreatedPHIs)</span></CodeLine>
<Link id="l04224" /><CodeLine lineNumber="4224"><span class="doxyHighlight">    SortedPHIs.<a href="/docs/api/classes/llvm/smallvectortemplatebase/#af42bfbc067df27c19ee2fc859df58799">push&#95;back</a>(<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>);</span></CodeLine>
<Link id="l04225" /><CodeLine lineNumber="4225"></CodeLine>
<Link id="l04226" /><CodeLine lineNumber="4226"><span class="doxyHighlight">  <a href="/docs/api/namespaces/llvm/#a74cdbd1e4f731e7d7cd83461b8b1de0b">llvm::sort</a>(SortedPHIs, &#91;&amp;&#93;(LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>, LDVSSAPhi &#42;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>) &#123;</span></CodeLine>
<Link id="l04227" /><CodeLine lineNumber="4227"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> BBToOrder&#91;&amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#a2e38c85003a042421cde1647632d0b72">A</a>-&gt;getParent()-&gt;BB&#93; &lt; BBToOrder&#91;&amp;<a href="/docs/api/files/lib/lib/ir/builtingcs-cpp/#ae76959fe811ba090de4cba69ac00f1da">B</a>-&gt;getParent()-&gt;BB&#93;;</span></CodeLine>
<Link id="l04228" /><CodeLine lineNumber="4228"><span class="doxyHighlight">  &#125;);</span></CodeLine>
<Link id="l04229" /><CodeLine lineNumber="4229"></CodeLine>
<Link id="l04230" /><CodeLine lineNumber="4230"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a> : SortedPHIs) &#123;</span></CodeLine>
<Link id="l04231" /><CodeLine lineNumber="4231"><span class="doxyHighlight">    ValueIDNum ThisBlockValueNum = MLiveIns&#91;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;ParentBlock-&gt;BB&#93;&#91;Loc.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93;;</span></CodeLine>
<Link id="l04232" /><CodeLine lineNumber="4232"></CodeLine>
<Link id="l04233" /><CodeLine lineNumber="4233"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Are all these things actually defined?</span></CodeLine>
<Link id="l04234" /><CodeLine lineNumber="4234"><span class="doxyHighlight">    </span><span class="doxyHighlightKeywordFlow">for</span><span class="doxyHighlight"> (</span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> &amp;PHIIt : <a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;IncomingValues) &#123;</span></CodeLine>
<Link id="l04235" /><CodeLine lineNumber="4235"><span class="doxyHighlight">      </span><span class="doxyHighlightComment">// Any undef input means DBG&#95;PHIs didn&#39;t dominate the use point.</span></CodeLine>
<Link id="l04236" /><CodeLine lineNumber="4236"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (Updater.PoisonMap.contains(&amp;PHIIt.first-&gt;BB))</span></CodeLine>
<Link id="l04237" /><CodeLine lineNumber="4237"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l04238" /><CodeLine lineNumber="4238"></CodeLine>
<Link id="l04239" /><CodeLine lineNumber="4239"><span class="doxyHighlight">      ValueIDNum ValueToCheck;</span></CodeLine>
<Link id="l04240" /><CodeLine lineNumber="4240"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">const</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/livedebugvalues/#a7697a3c717033a44ba7f9b272c1d5331">ValueTable</a> &amp;BlockLiveOuts = MLiveOuts&#91;PHIIt.first-&gt;BB&#93;;</span></CodeLine>
<Link id="l04241" /><CodeLine lineNumber="4241"></CodeLine>
<Link id="l04242" /><CodeLine lineNumber="4242"><span class="doxyHighlight">      </span><span class="doxyHighlightKeyword">auto</span><span class="doxyHighlight"> VVal = ValidatedValues.<a href="/docs/api/classes/llvm/densemapbase/#a0c047f127ed4380a6f383d70bec4eb94">find</a>(PHIIt.first);</span></CodeLine>
<Link id="l04243" /><CodeLine lineNumber="4243"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (VVal == ValidatedValues.<a href="/docs/api/classes/llvm/densemapbase/#a65520b9c67759099e313d0f4e7b5ff9e">end</a>()) &#123;</span></CodeLine>
<Link id="l04244" /><CodeLine lineNumber="4244"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// We cross a loop, and this is a backedge. LLVMs tail duplication</span></CodeLine>
<Link id="l04245" /><CodeLine lineNumber="4245"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// happens so late that DBG&#95;PHI instructions should not be able to</span></CodeLine>
<Link id="l04246" /><CodeLine lineNumber="4246"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// migrate into loops -- meaning we can only be live-through this</span></CodeLine>
<Link id="l04247" /><CodeLine lineNumber="4247"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// loop.</span></CodeLine>
<Link id="l04248" /><CodeLine lineNumber="4248"><span class="doxyHighlight">        ValueToCheck = ThisBlockValueNum;</span></CodeLine>
<Link id="l04249" /><CodeLine lineNumber="4249"><span class="doxyHighlight">      &#125; </span><span class="doxyHighlightKeywordFlow">else</span><span class="doxyHighlight"> &#123;</span></CodeLine>
<Link id="l04250" /><CodeLine lineNumber="4250"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// Does the block have as a live-out, in the location we&#39;re examining,</span></CodeLine>
<Link id="l04251" /><CodeLine lineNumber="4251"><span class="doxyHighlight">        </span><span class="doxyHighlightComment">// the value that we expect? If not, it&#39;s been moved or clobbered.</span></CodeLine>
<Link id="l04252" /><CodeLine lineNumber="4252"><span class="doxyHighlight">        ValueToCheck = VVal-&gt;second;</span></CodeLine>
<Link id="l04253" /><CodeLine lineNumber="4253"><span class="doxyHighlight">      &#125;</span></CodeLine>
<Link id="l04254" /><CodeLine lineNumber="4254"></CodeLine>
<Link id="l04255" /><CodeLine lineNumber="4255"><span class="doxyHighlight">      </span><span class="doxyHighlightKeywordFlow">if</span><span class="doxyHighlight"> (BlockLiveOuts&#91;Loc.<a href="/docs/api/classes/livedebugvalues/locidx/#a76c83b1cb30fe85e09f35ad1103fe75b">asU64</a>()&#93; != ValueToCheck)</span></CodeLine>
<Link id="l04256" /><CodeLine lineNumber="4256"><span class="doxyHighlight">        </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> std::nullopt;</span></CodeLine>
<Link id="l04257" /><CodeLine lineNumber="4257"><span class="doxyHighlight">    &#125;</span></CodeLine>
<Link id="l04258" /><CodeLine lineNumber="4258"></CodeLine>
<Link id="l04259" /><CodeLine lineNumber="4259"><span class="doxyHighlight">    </span><span class="doxyHighlightComment">// Record this value as validated.</span></CodeLine>
<Link id="l04260" /><CodeLine lineNumber="4260"><span class="doxyHighlight">    ValidatedValues.<a href="/docs/api/classes/llvm/densemapbase/#adb33f3ede2f5bfc9b3ee658aaf648492">insert</a>(&#123;<a href="/docs/api/files/lib/lib/target/lib/target/amdgpu/amdgpurewriteundefforphi-cpp/#a2e83cb1bc3f5e8986cbd14575755a134">PHI</a>-&gt;ParentBlock, ThisBlockValueNum&#125;);</span></CodeLine>
<Link id="l04261" /><CodeLine lineNumber="4261"><span class="doxyHighlight">  &#125;</span></CodeLine>
<Link id="l04262" /><CodeLine lineNumber="4262"></CodeLine>
<Link id="l04263" /><CodeLine lineNumber="4263"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// All the PHIs are valid: we can return what the SSAUpdater said our value</span></CodeLine>
<Link id="l04264" /><CodeLine lineNumber="4264"><span class="doxyHighlight">  </span><span class="doxyHighlightComment">// number was.</span></CodeLine>
<Link id="l04265" /><CodeLine lineNumber="4265"><span class="doxyHighlight">  </span><span class="doxyHighlightKeywordFlow">return</span><span class="doxyHighlight"> <a href="/docs/api/namespaces/llvm/ms-demangle/#afb795990ffc0cb7321e7d1eacc246324a8eea62084ca7e541d918e823422bd82e">Result</a>;</span></CodeLine>
<Link id="l04266" /><CodeLine lineNumber="4266"><span class="doxyHighlight">&#125;</span></CodeLine>

</ProgramListing>


</DoxygenPage>
